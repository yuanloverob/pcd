{
  "cve_id": "CVE-2023-26154",
  "cve_desc": "Versions of the package pubnub before 7.4.0; all versions of the package com.pubnub:pubnub; versions of the package pubnub before 6.19.0; all versions of the package github.com/pubnub/go; versions of the package github.com/pubnub/go/v7 before 7.2.0; versions of the package pubnub before 7.3.0; versions of the package pubnub/pubnub before 6.1.0; versions of the package pubnub before 5.3.0; versions of the package pubnub before 0.4.0; versions of the package pubnub/c-core before 4.5.0; versions of the package com.pubnub:pubnub-kotlin before 7.7.0; versions of the package pubnub/swift before 6.2.0; versions of the package pubnub before 5.2.0; versions of the package pubnub before 4.3.0 are vulnerable to Insufficient Entropy via the getKey function, due to inefficient implementation of the AES-256-CBC cryptographic algorithm. The provided encrypt function is less secure when hex encoding and trimming are applied, leaving half of the bits in the key always the same for every encoded message or file.\r\r**Note:**\r\rIn order to exploit this vulnerability, the attacker needs to invest resources in preparing the attack and brute-force the encryption.",
  "repo": "pubnub/javascript",
  "patch_hash": "fb6cd0417cbb4ba87ea2d5d86a9c94774447e119",
  "patch_info": {
    "commit_hash": "fb6cd0417cbb4ba87ea2d5d86a9c94774447e119",
    "repo": "pubnub/javascript",
    "commit_url": "https://github.com/pubnub/javascript/commit/fb6cd0417cbb4ba87ea2d5d86a9c94774447e119",
    "files": [
      ".pubnub.yml",
      "CHANGELOG.md",
      "LICENSE",
      "README.md",
      "dist/web/pubnub.js",
      "dist/web/pubnub.min.js",
      "lib/core/components/base64_codec.js",
      "lib/core/components/config.js",
      "lib/core/components/subscription_manager.js",
      "lib/core/endpoints/fetch_messages.js",
      "lib/core/endpoints/file_upload/download_file.js",
      "lib/core/endpoints/file_upload/publish_file.js",
      "lib/core/endpoints/file_upload/send_file.js",
      "lib/core/endpoints/history/get_history.js",
      "lib/core/endpoints/publish.js",
      "lib/core/pubnub-common.js",
      "lib/core/utils.js",
      "lib/crypto/modules/NodeCryptoModule/ICryptor.js",
      "lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js",
      "lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/legacyCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js",
      "lib/crypto/modules/WebCryptoModule/ICryptor.js",
      "lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js",
      "lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js",
      "lib/crypto/modules/WebCryptoModule/legacyCryptor.js",
      "lib/crypto/modules/WebCryptoModule/webCryptoModule.js",
      "lib/crypto/modules/node.js",
      "lib/crypto/modules/web.js",
      "lib/file/modules/node.js",
      "lib/node/index.js",
      "lib/web/index.js",
      "package.json",
      "src/core/components/base64_codec.ts",
      "src/core/components/config.js",
      "src/core/components/cryptography/index.js",
      "src/core/components/subscription_manager.js",
      "src/core/endpoints/fetch_messages.js",
      "src/core/endpoints/file_upload/download_file.js",
      "src/core/endpoints/file_upload/publish_file.js",
      "src/core/endpoints/file_upload/send_file.js",
      "src/core/endpoints/history/get_history.js",
      "src/core/endpoints/publish.js",
      "src/core/pubnub-common.js",
      "src/core/utils.js",
      "src/crypto/modules/NodeCryptoModule/ICryptor.ts",
      "src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/legacyCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts",
      "src/crypto/modules/WebCryptoModule/ICryptor.ts",
      "src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts",
      "src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts",
      "src/crypto/modules/WebCryptoModule/legacyCryptor.ts",
      "src/crypto/modules/WebCryptoModule/webCryptoModule.ts",
      "src/crypto/modules/node.js",
      "src/crypto/modules/web.js",
      "src/file/modules/node.js",
      "src/node/index.ts",
      "src/web/index.js",
      "test/contract/steps/cryptoModule/cryptoModule.ts",
      "test/contract/utils.ts",
      "test/contract/world.ts",
      "tsconfig.json"
    ],
    "message": "feat/CryptoModule (#339)\n\n* ref: decoupling cryptor module\n\n* cryptoModule\n\n* lint\n\n* rever cryptors in config\n\n* lint fixes\n\n* CryptoModule for web and node\n\n* step definitions for contract tests\n\n* lib files\n\n* fix:es-lint\n\n* let vs const\n\n* and some more ts not wanting me to specific about trivials\n\n* access modfiers\n\n* refactor-1\n\n* lint, cleanup test\n\n* refactor - 2\n\n* code cleanup in stream encryption with new cryptor\n\n* fix: lint issue.\n\n* refactor: eliminate ts-ignores by defining file reated types\n\n* * integration of crypto module * refactoring cryptoModule\n\n* lib and dist\n\n* support for setCipherKey\n\n* fix: setCipherKey()\n\n* lib and dist files\n\n* fix: staticIV support\n\n* lib and dist\n\n* refactor: cryptoModule, * added support for PubNub.CryptoModule factory\n\n* fix: types\n\n* dist and libs\n\n* fix: test- customEncrypt function\n\n* fix: legacy crypto init, tests\n\n* refactor: typecheck on incoming data for aescbc cryptor\n\n* code cleanup, * fix: broken file cryptography operations on web\n\n* lib and dist directories\n\n* refactor: crypto initialiser apis default value initialisation\n\n* LICENSE\n\n* reverted last commit 11351ec\n\n* update LICENSE\n\n* PubNub SDK v7.4.0 release.\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>",
    "before_after_code_files": [
      "dist/web/pubnub.js||dist/web/pubnub.js",
      "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
      "lib/core/components/base64_codec.js||lib/core/components/base64_codec.js",
      "lib/core/components/config.js||lib/core/components/config.js",
      "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js",
      "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js",
      "lib/core/endpoints/file_upload/download_file.js||lib/core/endpoints/file_upload/download_file.js",
      "lib/core/endpoints/file_upload/publish_file.js||lib/core/endpoints/file_upload/publish_file.js",
      "lib/core/endpoints/file_upload/send_file.js||lib/core/endpoints/file_upload/send_file.js",
      "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js",
      "lib/core/endpoints/publish.js||lib/core/endpoints/publish.js",
      "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
      "lib/core/utils.js||lib/core/utils.js",
      "lib/crypto/modules/NodeCryptoModule/ICryptor.js||lib/crypto/modules/NodeCryptoModule/ICryptor.js",
      "lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js||lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js||lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js",
      "lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js||lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/legacyCryptor.js||lib/crypto/modules/NodeCryptoModule/legacyCryptor.js",
      "lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js||lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js",
      "lib/crypto/modules/WebCryptoModule/ICryptor.js||lib/crypto/modules/WebCryptoModule/ICryptor.js",
      "lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js||lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js",
      "lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js||lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js",
      "lib/crypto/modules/WebCryptoModule/legacyCryptor.js||lib/crypto/modules/WebCryptoModule/legacyCryptor.js",
      "lib/crypto/modules/WebCryptoModule/webCryptoModule.js||lib/crypto/modules/WebCryptoModule/webCryptoModule.js",
      "lib/crypto/modules/node.js||lib/crypto/modules/node.js",
      "lib/crypto/modules/web.js||lib/crypto/modules/web.js",
      "lib/file/modules/node.js||lib/file/modules/node.js",
      "lib/node/index.js||lib/node/index.js",
      "lib/web/index.js||lib/web/index.js",
      "src/core/components/base64_codec.ts||src/core/components/base64_codec.ts",
      "src/core/components/config.js||src/core/components/config.js",
      "src/core/components/cryptography/index.js||src/core/components/cryptography/index.js",
      "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js",
      "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js",
      "src/core/endpoints/file_upload/download_file.js||src/core/endpoints/file_upload/download_file.js",
      "src/core/endpoints/file_upload/publish_file.js||src/core/endpoints/file_upload/publish_file.js",
      "src/core/endpoints/file_upload/send_file.js||src/core/endpoints/file_upload/send_file.js",
      "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js",
      "src/core/endpoints/publish.js||src/core/endpoints/publish.js",
      "src/core/pubnub-common.js||src/core/pubnub-common.js",
      "src/core/utils.js||src/core/utils.js",
      "src/crypto/modules/NodeCryptoModule/ICryptor.ts||src/crypto/modules/NodeCryptoModule/ICryptor.ts",
      "src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts||src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts||src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/legacyCryptor.ts||src/crypto/modules/NodeCryptoModule/legacyCryptor.ts",
      "src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts||src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts",
      "src/crypto/modules/WebCryptoModule/ICryptor.ts||src/crypto/modules/WebCryptoModule/ICryptor.ts",
      "src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts||src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts",
      "src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts||src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts",
      "src/crypto/modules/WebCryptoModule/legacyCryptor.ts||src/crypto/modules/WebCryptoModule/legacyCryptor.ts",
      "src/crypto/modules/WebCryptoModule/webCryptoModule.ts||src/crypto/modules/WebCryptoModule/webCryptoModule.ts",
      "src/crypto/modules/node.js||src/crypto/modules/node.js",
      "src/crypto/modules/web.js||src/crypto/modules/web.js",
      "src/file/modules/node.js||src/file/modules/node.js",
      "src/node/index.ts||src/node/index.ts",
      "src/web/index.js||src/web/index.js",
      "test/contract/steps/cryptoModule/cryptoModule.ts||test/contract/steps/cryptoModule/cryptoModule.ts",
      "test/contract/utils.ts||test/contract/utils.ts",
      "test/contract/world.ts||test/contract/world.ts"
    ]
  },
  "patch_diff": {
    "dist/web/pubnub.js||dist/web/pubnub.js": [
      "File: dist/web/pubnub.js -> dist/web/pubnub.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "636:             this.sdkFamily = setup.sdkFamily;",
      "637:             this.partnerId = setup.partnerId;",
      "638:             this.setAuthKey(setup.authKey);",
      "640:             this.setFilterExpression(setup.filterExpression);",
      "641:             if (typeof setup.origin !== 'string' && !Array.isArray(setup.origin) && setup.origin !== undefined) {",
      "642:                 throw new Error('Origin must be either undefined, a string or a list of strings.');",
      "",
      "[Removed Lines]",
      "639:             this.setCipherKey(setup.cipherKey);",
      "",
      "[Added Lines]",
      "639:             this.cryptoModule = setup.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "695:                 }",
      "696:                 this.setUUID(setup.uuid);",
      "697:             }",
      "698:         }",
      "700:         default_1.prototype.getAuthKey = function () {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "698:             this.setCipherKey(setup.cipherKey, setup);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "704:             this.authKey = val;",
      "705:             return this;",
      "706:         };",
      "708:             this.cipherKey = val;",
      "709:             return this;",
      "710:         };",
      "711:         default_1.prototype.getUUID = function () {",
      "",
      "[Removed Lines]",
      "707:         default_1.prototype.setCipherKey = function (val) {",
      "",
      "[Added Lines]",
      "708:         default_1.prototype.setCipherKey = function (val, setup, modules) {",
      "709:             var _a;",
      "711:             if (this.cipherKey) {",
      "712:                 this.cryptoModule =",
      "713:                     (_a = setup.cryptoModule) !== null && _a !== void 0 ? _a : setup.initCryptoModule({ cipherKey: this.cipherKey, useRandomIVs: this.useRandomIVs });",
      "714:                 if (modules)",
      "715:                     modules.cryptoModule = this.cryptoModule;",
      "716:             }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "783:             return this;",
      "784:         };",
      "785:         default_1.prototype.getVersion = function () {",
      "787:         };",
      "788:         default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
      "789:             this._PNSDKSuffix[name] = suffix;",
      "",
      "[Removed Lines]",
      "786:             return '7.3.3';",
      "",
      "[Added Lines]",
      "794:             return '7.4.0';",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "841:         }",
      "842:         return data;",
      "843:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "852:     function encode$1(input) {",
      "853:         var base64 = '';",
      "854:         var encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';",
      "855:         var bytes = new Uint8Array(input);",
      "856:         var byteLength = bytes.byteLength;",
      "857:         var byteRemainder = byteLength % 3;",
      "858:         var mainLength = byteLength - byteRemainder;",
      "859:         var a, b, c, d;",
      "860:         var chunk;",
      "862:         for (var i = 0; i < mainLength; i = i + 3) {",
      "864:             chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];",
      "866:             a = (chunk & 16515072) >> 18; // 16515072 = (2^6 - 1) << 18",
      "867:             b = (chunk & 258048) >> 12; // 258048   = (2^6 - 1) << 12",
      "868:             c = (chunk & 4032) >> 6; // 4032     = (2^6 - 1) << 6",
      "869:             d = chunk & 63; // 63       = 2^6 - 1",
      "871:             base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];",
      "872:         }",
      "874:         if (byteRemainder == 1) {",
      "875:             chunk = bytes[mainLength];",
      "876:             a = (chunk & 252) >> 2; // 252 = (2^6 - 1) << 2",
      "878:             b = (chunk & 3) << 4; // 3   = 2^2 - 1",
      "879:             base64 += encodings[a] + encodings[b] + '==';",
      "880:         }",
      "881:         else if (byteRemainder == 2) {",
      "882:             chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];",
      "883:             a = (chunk & 64512) >> 10; // 64512 = (2^6 - 1) << 10",
      "884:             b = (chunk & 1008) >> 4; // 1008  = (2^6 - 1) << 4",
      "886:             c = (chunk & 15) << 2; // 15    = 2^4 - 1",
      "887:             base64 += encodings[a] + encodings[b] + encodings[c] + '=';",
      "888:         }",
      "889:         return base64;",
      "890:     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "1764:         });",
      "1765:         return { promise: promise, reject: failureResolve, fulfill: successResolve };",
      "1766:     }",
      "1767:     var utils$5 = {",
      "1768:         signPamFromParams: signPamFromParams,",
      "1769:         endsWith: endsWith,",
      "1770:         createPromise: createPromise,",
      "1771:         encodeString: encodeString,",
      "1772:     };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1814:     function stringToArrayBuffer(str) {",
      "1815:         var buf = new ArrayBuffer(str.length * 2);",
      "1816:         var bufView = new Uint16Array(buf);",
      "1817:         for (var i = 0, strLen = str.length; i < strLen; i++) {",
      "1818:             bufView[i] = str.charCodeAt(i);",
      "1819:         }",
      "1820:         return buf;",
      "1821:     }",
      "1827:         stringToArrayBuffer: stringToArrayBuffer,",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "1796:     var default_1$7 = /** @class */ (function () {",
      "1797:         function default_1(_a) {",
      "1799:             this._listenerManager = listenerManager;",
      "1800:             this._config = config;",
      "1801:             this._leaveEndpoint = leaveEndpoint;",
      "",
      "[Removed Lines]",
      "1798:             var subscribeEndpoint = _a.subscribeEndpoint, leaveEndpoint = _a.leaveEndpoint, heartbeatEndpoint = _a.heartbeatEndpoint, setStateEndpoint = _a.setStateEndpoint, timeEndpoint = _a.timeEndpoint, getFileUrl = _a.getFileUrl, config = _a.config, crypto = _a.crypto, listenerManager = _a.listenerManager;",
      "",
      "[Added Lines]",
      "1854:             var subscribeEndpoint = _a.subscribeEndpoint, leaveEndpoint = _a.leaveEndpoint, heartbeatEndpoint = _a.heartbeatEndpoint, setStateEndpoint = _a.setStateEndpoint, timeEndpoint = _a.timeEndpoint, getFileUrl = _a.getFileUrl, config = _a.config, crypto = _a.crypto, listenerManager = _a.listenerManager, cryptoModule = _a.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "1804:             this._subscribeEndpoint = subscribeEndpoint;",
      "1805:             this._getFileUrl = getFileUrl;",
      "1806:             this._crypto = crypto;",
      "1807:             this._channels = {};",
      "1808:             this._presenceChannels = {};",
      "1809:             this._heartbeatChannels = {};",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1863:             this._cryptoModule = cryptoModule;",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "1819:             this._isOnline = true;",
      "1820:             this._reconnectionManager = new default_1$9({ timeEndpoint: timeEndpoint });",
      "1821:             this._dedupingManager = new default_1$8({ config: config });",
      "1822:         }",
      "1823:         default_1.prototype.adaptStateChange = function (args, callback) {",
      "1824:             var _this = this;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1879:             if (this._cryptoModule)",
      "1880:                 this._decoder = new TextDecoder();",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "2286:                     announce.timetoken = publishMetaData.publishTimetoken;",
      "2287:                     announce.publisher = message.issuingClientId;",
      "2288:                     var msgPayload = message.payload;",
      "2292:                             msgPayload = decryptedPayload;",
      "2293:                         }",
      "2294:                     }",
      "",
      "[Removed Lines]",
      "2289:                     if (_this._config.cipherKey) {",
      "2290:                         var decryptedPayload = _this._crypto.decrypt(message.payload);",
      "2291:                         if (typeof decryptedPayload === 'object' && decryptedPayload !== null) {",
      "",
      "[Added Lines]",
      "2348:                     if (_this._cryptoModule) {",
      "2349:                         var decryptedPayload = void 0;",
      "2350:                         try {",
      "2351:                             var decryptedData = _this._cryptoModule.decrypt(message.payload);",
      "2352:                             decryptedPayload =",
      "2353:                                 decryptedData instanceof ArrayBuffer ? JSON.parse(_this._decoder.decode(decryptedData)) : decryptedData;",
      "2354:                         }",
      "2355:                         catch (e) {",
      "2356:                             decryptedPayload = null;",
      "2357:                             if (console && console.log) {",
      "2358:                                 console.log('decryption error', e.message);",
      "2359:                             }",
      "2360:                         }",
      "2361:                         if (decryptedPayload !== null) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "2322:                     if (message.userMetadata) {",
      "2323:                         announce.userMetadata = message.userMetadata;",
      "2324:                     }",
      "2327:                     }",
      "2328:                     else {",
      "2329:                         announce.message = message.payload;",
      "",
      "[Removed Lines]",
      "2325:                     if (_this._config.cipherKey) {",
      "2326:                         announce.message = _this._crypto.decrypt(message.payload);",
      "",
      "[Added Lines]",
      "2395:                     if (_this._cryptoModule) {",
      "2396:                         var decryptedPayload = void 0;",
      "2397:                         try {",
      "2398:                             var decryptedData = _this._cryptoModule.decrypt(message.payload);",
      "2399:                             decryptedPayload =",
      "2400:                                 decryptedData instanceof ArrayBuffer ? JSON.parse(_this._decoder.decode(decryptedData)) : decryptedData;",
      "2401:                         }",
      "2402:                         catch (e) {",
      "2403:                             decryptedPayload = null;",
      "2405:                             if (console && console.log) {",
      "2406:                                 console.log('decryption error', e.message); //eslint-disable-line",
      "2407:                             }",
      "2408:                         }",
      "2409:                         if (decryptedPayload != null) {",
      "2410:                             announce.message = decryptedPayload;",
      "2411:                         }",
      "2412:                         else {",
      "2413:                             announce.message = message.payload;",
      "2414:                         }",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "4622:     };",
      "4627:         var stringifiedPayload = JSON.stringify(payload);",
      "4630:             stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "4631:         }",
      "4632:         return stringifiedPayload || '';",
      "",
      "[Removed Lines]",
      "4625:     var preparePayload = function (_a, payload) {",
      "4626:         var crypto = _a.crypto, config = _a.config;",
      "4628:         if (config.cipherKey) {",
      "4629:             stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "",
      "[Added Lines]",
      "4713:     var preparePayload = function (modules, payload) {",
      "4715:         if (modules.cryptoModule) {",
      "4716:             var encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "4717:             stringifiedPayload = typeof encrypted === 'string' ? encrypted : encode$1(encrypted);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "4682:     var sendFile = function (_a) {",
      "4683:         var _this = this;",
      "4685:         return function (_a) {",
      "4686:             var channel = _a.channel, input = _a.file, message = _a.message, cipherKey = _a.cipherKey, meta = _a.meta, ttl = _a.ttl, storeInHistory = _a.storeInHistory;",
      "4687:             return __awaiter(_this, void 0, void 0, function () {",
      "4691:                         case 0:",
      "4692:                             if (!channel) {",
      "4693:                                 throw new PubNubError('Validation failed, check status for details', createValidationError(\"channel can't be empty\"));",
      "",
      "[Removed Lines]",
      "4684:         var generateUploadUrl = _a.generateUploadUrl, publishFile = _a.publishFile, _b = _a.modules, PubNubFile = _b.PubNubFile, config = _b.config, cryptography = _b.cryptography, networking = _b.networking;",
      "4688:                 var file, _b, _c, url, formFields, _d, id, name, formFieldsWithMimeType, result, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, e_1, errorBody, reason, retries, wasSuccessful, publishResult;",
      "4689:                 return __generator(this, function (_s) {",
      "4690:                     switch (_s.label) {",
      "",
      "[Added Lines]",
      "4772:         var generateUploadUrl = _a.generateUploadUrl, publishFile = _a.publishFile, _b = _a.modules, PubNubFile = _b.PubNubFile, config = _b.config, cryptography = _b.cryptography, cryptoModule = _b.cryptoModule, networking = _b.networking;",
      "4776:                 var file, _b, _c, url, formFields, _d, id, name, _e, formFieldsWithMimeType, result, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, e_1, errorBody, reason, retries, wasSuccessful, publishResult;",
      "4777:                 return __generator(this, function (_t) {",
      "4778:                     switch (_t.label) {",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "4698:                             file = PubNubFile.create(input);",
      "4699:                             return [4 /*yield*/, generateUploadUrl({ channel: channel, name: file.name })];",
      "4700:                         case 1:",
      "4704:                         case 2:",
      "4708:                             formFieldsWithMimeType = formFields;",
      "4709:                             if (file.mimeType) {",
      "4710:                                 formFieldsWithMimeType = formFields.map(function (entry) {",
      "",
      "[Removed Lines]",
      "4701:                             _b = _s.sent(), _c = _b.file_upload_request, url = _c.url, formFields = _c.form_fields, _d = _b.data, id = _d.id, name = _d.name;",
      "4702:                             if (!(PubNubFile.supportsEncryptFile && (cipherKey !== null && cipherKey !== void 0 ? cipherKey : config.cipherKey))) return [3 /*break*/, 3];",
      "4703:                             return [4 /*yield*/, cryptography.encryptFile(cipherKey !== null && cipherKey !== void 0 ? cipherKey : config.cipherKey, file, PubNubFile)];",
      "4705:                             file = _s.sent();",
      "4706:                             _s.label = 3;",
      "4707:                         case 3:",
      "",
      "[Added Lines]",
      "4789:                             _b = _t.sent(), _c = _b.file_upload_request, url = _c.url, formFields = _c.form_fields, _d = _b.data, id = _d.id, name = _d.name;",
      "4790:                             if (!(PubNubFile.supportsEncryptFile && (cipherKey || cryptoModule))) return [3 /*break*/, 6];",
      "4791:                             if (!(cipherKey == null)) return [3 /*break*/, 3];",
      "4792:                             return [4 /*yield*/, cryptoModule.encryptFile(file, PubNubFile)];",
      "4794:                             _e = _t.sent();",
      "4795:                             return [3 /*break*/, 5];",
      "4796:                         case 3: return [4 /*yield*/, cryptography.encryptFile(cipherKey, file, PubNubFile)];",
      "4797:                         case 4:",
      "4798:                             _e = _t.sent();",
      "4799:                             _t.label = 5;",
      "4800:                         case 5:",
      "4801:                             file = _e;",
      "4802:                             _t.label = 6;",
      "4803:                         case 6:",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "4713:                                     return entry;",
      "4714:                                 });",
      "4715:                             }",
      "4727:                         case 7:",
      "4733:                         case 9:",
      "4736:                         case 10:",
      "4742:                         case 12:",
      "4745:                         case 13:",
      "4751:                         case 15:",
      "4756:                         case 18:",
      "4758:                             if (e_1.response && typeof e_1.response.text === 'string') {",
      "4759:                                 errorBody = e_1.response.text;",
      "4760:                                 reason = /<Message>(.*)<\\/Message>/gi.exec(errorBody);",
      "",
      "[Removed Lines]",
      "4716:                             _s.label = 4;",
      "4717:                         case 4:",
      "4718:                             _s.trys.push([4, 18, , 19]);",
      "4719:                             if (!(PubNubFile.supportsFileUri && input.uri)) return [3 /*break*/, 7];",
      "4720:                             _f = (_e = networking).POSTFILE;",
      "4721:                             _g = [url, formFieldsWithMimeType];",
      "4722:                             return [4 /*yield*/, file.toFileUri()];",
      "4723:                         case 5: return [4 /*yield*/, _f.apply(_e, _g.concat([_s.sent()]))];",
      "4724:                         case 6:",
      "4725:                             result = _s.sent();",
      "4726:                             return [3 /*break*/, 17];",
      "4728:                             if (!PubNubFile.supportsFile) return [3 /*break*/, 10];",
      "4729:                             _j = (_h = networking).POSTFILE;",
      "4730:                             _k = [url, formFieldsWithMimeType];",
      "4731:                             return [4 /*yield*/, file.toFile()];",
      "4732:                         case 8: return [4 /*yield*/, _j.apply(_h, _k.concat([_s.sent()]))];",
      "4734:                             result = _s.sent();",
      "4735:                             return [3 /*break*/, 17];",
      "4737:                             if (!PubNubFile.supportsBuffer) return [3 /*break*/, 13];",
      "4738:                             _m = (_l = networking).POSTFILE;",
      "4739:                             _o = [url, formFieldsWithMimeType];",
      "4740:                             return [4 /*yield*/, file.toBuffer()];",
      "4741:                         case 11: return [4 /*yield*/, _m.apply(_l, _o.concat([_s.sent()]))];",
      "4743:                             result = _s.sent();",
      "4744:                             return [3 /*break*/, 17];",
      "4746:                             if (!PubNubFile.supportsBlob) return [3 /*break*/, 16];",
      "4747:                             _q = (_p = networking).POSTFILE;",
      "4748:                             _r = [url, formFieldsWithMimeType];",
      "4749:                             return [4 /*yield*/, file.toBlob()];",
      "4750:                         case 14: return [4 /*yield*/, _q.apply(_p, _r.concat([_s.sent()]))];",
      "4752:                             result = _s.sent();",
      "4753:                             return [3 /*break*/, 17];",
      "4754:                         case 16: throw new Error('Unsupported environment');",
      "4755:                         case 17: return [3 /*break*/, 19];",
      "4757:                             e_1 = _s.sent();",
      "",
      "[Added Lines]",
      "4812:                             _t.label = 7;",
      "4814:                             _t.trys.push([7, 21, , 22]);",
      "4815:                             if (!(PubNubFile.supportsFileUri && input.uri)) return [3 /*break*/, 10];",
      "4816:                             _g = (_f = networking).POSTFILE;",
      "4817:                             _h = [url, formFieldsWithMimeType];",
      "4818:                             return [4 /*yield*/, file.toFileUri()];",
      "4819:                         case 8: return [4 /*yield*/, _g.apply(_f, _h.concat([_t.sent()]))];",
      "4821:                             result = _t.sent();",
      "4822:                             return [3 /*break*/, 20];",
      "4824:                             if (!PubNubFile.supportsFile) return [3 /*break*/, 13];",
      "4825:                             _k = (_j = networking).POSTFILE;",
      "4826:                             _l = [url, formFieldsWithMimeType];",
      "4827:                             return [4 /*yield*/, file.toFile()];",
      "4828:                         case 11: return [4 /*yield*/, _k.apply(_j, _l.concat([_t.sent()]))];",
      "4830:                             result = _t.sent();",
      "4831:                             return [3 /*break*/, 20];",
      "4833:                             if (!PubNubFile.supportsBuffer) return [3 /*break*/, 16];",
      "4834:                             _o = (_m = networking).POSTFILE;",
      "4835:                             _p = [url, formFieldsWithMimeType];",
      "4836:                             return [4 /*yield*/, file.toBuffer()];",
      "4837:                         case 14: return [4 /*yield*/, _o.apply(_m, _p.concat([_t.sent()]))];",
      "4839:                             result = _t.sent();",
      "4840:                             return [3 /*break*/, 20];",
      "4841:                         case 16:",
      "4842:                             if (!PubNubFile.supportsBlob) return [3 /*break*/, 19];",
      "4843:                             _r = (_q = networking).POSTFILE;",
      "4844:                             _s = [url, formFieldsWithMimeType];",
      "4845:                             return [4 /*yield*/, file.toBlob()];",
      "4846:                         case 17: return [4 /*yield*/, _r.apply(_q, _s.concat([_t.sent()]))];",
      "4848:                             result = _t.sent();",
      "4849:                             return [3 /*break*/, 20];",
      "4850:                         case 19: throw new Error('Unsupported environment');",
      "4851:                         case 20: return [3 /*break*/, 22];",
      "4852:                         case 21:",
      "4853:                             e_1 = _t.sent();",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "4763:                             else {",
      "4764:                                 throw new PubNubError('Upload to bucket failed.', e_1);",
      "4765:                             }",
      "4767:                             if (result.status !== 204) {",
      "4768:                                 throw new PubNubError('Upload to bucket was unsuccessful', result);",
      "4769:                             }",
      "4770:                             retries = config.fileUploadPublishRetryLimit;",
      "4771:                             wasSuccessful = false;",
      "4772:                             publishResult = { timetoken: '0' };",
      "4776:                             return [4 /*yield*/, publishFile({",
      "4777:                                     channel: channel,",
      "4778:                                     message: message,",
      "",
      "[Removed Lines]",
      "4766:                         case 19:",
      "4773:                             _s.label = 20;",
      "4774:                         case 20:",
      "4775:                             _s.trys.push([20, 22, , 23]);",
      "",
      "[Added Lines]",
      "4862:                         case 22:",
      "4869:                             _t.label = 23;",
      "4870:                         case 23:",
      "4871:                             _t.trys.push([23, 25, , 26]);",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "4782:                                     storeInHistory: storeInHistory,",
      "4783:                                     ttl: ttl,",
      "4784:                                 })];",
      "4788:                             wasSuccessful = true;",
      "4792:                             retries -= 1;",
      "4798:                             if (!wasSuccessful) {",
      "4799:                                 throw new PubNubError('Publish failed. You may want to execute that operation manually using pubnub.publishFile', {",
      "4800:                                     channel: channel,",
      "",
      "[Removed Lines]",
      "4785:                         case 21:",
      "4787:                             publishResult = _s.sent();",
      "4789:                             return [3 /*break*/, 23];",
      "4790:                         case 22:",
      "4791:                             _s.sent();",
      "4793:                             return [3 /*break*/, 23];",
      "4794:                         case 23:",
      "4795:                             if (!wasSuccessful && retries > 0) return [3 /*break*/, 20];",
      "4796:                             _s.label = 24;",
      "4797:                         case 24:",
      "",
      "[Added Lines]",
      "4881:                         case 24:",
      "4883:                             publishResult = _t.sent();",
      "4885:                             return [3 /*break*/, 26];",
      "4886:                         case 25:",
      "4887:                             _t.sent();",
      "4889:                             return [3 /*break*/, 26];",
      "4890:                         case 26:",
      "4891:                             if (!wasSuccessful && retries > 0) return [3 /*break*/, 23];",
      "4892:                             _t.label = 27;",
      "4893:                         case 27:",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "4889:         forceBuffered: function () { return true; },",
      "4890:         prepareParams: function () { return ({}); },",
      "4891:         handleResponse: function (_a, res, params) {",
      "4893:             return __awaiter(void 0, void 0, void 0, function () {",
      "4896:                 return __generator(this, function (_e) {",
      "4897:                     switch (_e.label) {",
      "4898:                         case 0:",
      "4899:                             body = res.response.body;",
      "4902:                         case 1:",
      "4906:                                 data: body,",
      "4907:                                 name: (_d = res.response.name) !== null && _d !== void 0 ? _d : params.name,",
      "4908:                                 mimeType: res.response.type,",
      "",
      "[Removed Lines]",
      "4892:             var PubNubFile = _a.PubNubFile, config = _a.config, cryptography = _a.cryptography;",
      "4894:                 var body;",
      "4895:                 var _b, _c, _d;",
      "4900:                             if (!(PubNubFile.supportsEncryptFile && ((_b = params.cipherKey) !== null && _b !== void 0 ? _b : config.cipherKey))) return [3 /*break*/, 2];",
      "4901:                             return [4 /*yield*/, cryptography.decrypt((_c = params.cipherKey) !== null && _c !== void 0 ? _c : config.cipherKey, body)];",
      "4903:                             body = _e.sent();",
      "4904:                             _e.label = 2;",
      "4905:                         case 2: return [2 /*return*/, PubNubFile.create({",
      "",
      "[Added Lines]",
      "4988:             var PubNubFile = _a.PubNubFile, config = _a.config, cryptography = _a.cryptography, cryptoModule = _a.cryptoModule;",
      "4990:                 var body, _b;",
      "4991:                 var _c, _d;",
      "4996:                             if (!(PubNubFile.supportsEncryptFile && (params.cipherKey || cryptoModule))) return [3 /*break*/, 5];",
      "4997:                             if (!(params.cipherKey == null)) return [3 /*break*/, 2];",
      "4998:                             return [4 /*yield*/, cryptoModule.decryptFile(PubNubFile.create({ data: body, name: params.name }), PubNubFile)];",
      "5000:                             _b = (_e.sent()).data;",
      "5001:                             return [3 /*break*/, 4];",
      "5002:                         case 2: return [4 /*yield*/, cryptography.decrypt((_c = params.cipherKey) !== null && _c !== void 0 ? _c : config.cipherKey, body)];",
      "5003:                         case 3:",
      "5004:                             _b = _e.sent();",
      "5005:                             _e.label = 4;",
      "5006:                         case 4:",
      "5007:                             body = _b;",
      "5008:                             _e.label = 5;",
      "5009:                         case 5: return [2 /*return*/, PubNubFile.create({",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "5998:     function prepareMessagePayload$1(modules, messagePayload) {",
      "6000:         var stringifiedPayload = JSON.stringify(messagePayload);",
      "6003:             stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "6004:         }",
      "6006:     }",
      "6007:     function getOperation$7() {",
      "6008:         return OPERATIONS.PNPublishOperation;",
      "",
      "[Removed Lines]",
      "5999:         var crypto = modules.crypto, config = modules.config;",
      "6001:         if (config.cipherKey) {",
      "6002:             stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "6005:         return stringifiedPayload;",
      "",
      "[Added Lines]",
      "6104:         if (modules.cryptoModule) {",
      "6105:             var encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "6106:             stringifiedPayload = typeof encrypted === 'string' ? encrypted : encode$1(encrypted);",
      "6109:         return stringifiedPayload || '';",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "6137:     function __processMessage$1(modules, message) {",
      "6140:             return message;",
      "6141:         try {",
      "6143:         }",
      "6144:         catch (e) {",
      "6145:             return message;",
      "6146:         }",
      "6147:     }",
      "",
      "[Removed Lines]",
      "6138:         var config = modules.config, crypto = modules.crypto;",
      "6139:         if (!config.cipherKey)",
      "6142:             return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "6242:         if (!modules.cryptoModule)",
      "6245:             var decryptedData = modules.cryptoModule.decrypt(message);",
      "6246:             var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "6247:             return decryptedPayload;",
      "6250:             if (console && console.log)",
      "6251:                 console.log('decryption error', e.message);",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "6333:     function __processMessage(modules, message) {",
      "6336:             return message;",
      "6337:         try {",
      "6339:         }",
      "6340:         catch (e) {",
      "6341:             return message;",
      "6342:         }",
      "6343:     }",
      "",
      "[Removed Lines]",
      "6334:         var config = modules.config, crypto = modules.crypto;",
      "6335:         if (!config.cipherKey)",
      "6338:             return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "6441:         if (!modules.cryptoModule)",
      "6444:             var decryptedData = modules.cryptoModule.decrypt(message);",
      "6445:             var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "6446:             return decryptedPayload;",
      "6449:             if (console && console.log)",
      "6450:                 console.log('decryption error', e.message);",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "7375:                 maximumSamplesCount: 60000,",
      "7376:             });",
      "7377:             this._telemetryManager = telemetryManager;",
      "7378:             var modules = {",
      "7379:                 config: config,",
      "7380:                 networking: networking,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7488:             var cryptoModule = this._config.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "7383:                 tokenManager: tokenManager,",
      "7384:                 telemetryManager: telemetryManager,",
      "7385:                 PubNubFile: setup.PubNubFile,",
      "7386:             };",
      "7387:             this.File = setup.PubNubFile;",
      "7390:             var timeEndpoint = endpointCreator.bind(this, modules, timeEndpointConfig);",
      "7391:             var leaveEndpoint = endpointCreator.bind(this, modules, presenceLeaveEndpointConfig);",
      "7392:             var heartbeatEndpoint = endpointCreator.bind(this, modules, presenceHeartbeatEndpointConfig);",
      "",
      "[Removed Lines]",
      "7388:             this.encryptFile = function (key, file) { return cryptography.encryptFile(key, file, _this.File); };",
      "7389:             this.decryptFile = function (key, file) { return cryptography.decryptFile(key, file, _this.File); };",
      "",
      "[Added Lines]",
      "7497:                 cryptoModule: cryptoModule,",
      "7500:             this.encryptFile = function (key, file) {",
      "7501:                 if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "7502:                     file = key;",
      "7503:                     return modules.cryptoModule.encryptFile(file, this.File);",
      "7504:                 }",
      "7505:                 return cryptography.encryptFile(key, file, this.File);",
      "7506:             };",
      "7507:             this.decryptFile = function (key, file) {",
      "7508:                 if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "7509:                     file = key;",
      "7510:                     return modules.cryptoModule.decryptFile(file, this.File);",
      "7511:                 }",
      "7512:                 return cryptography.decryptFile(key, file, this.File);",
      "7513:             };",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "7417:                     config: modules.config,",
      "7418:                     listenerManager: listenerManager,",
      "7419:                     getFileUrl: function (params) { return getFileUrlFunction(modules, params); },",
      "7420:                 });",
      "7421:                 this.subscribe = subscriptionManager_1.adaptSubscribeChange.bind(subscriptionManager_1);",
      "7422:                 this.unsubscribe = subscriptionManager_1.adaptUnsubscribeChange.bind(subscriptionManager_1);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7544:                     cryptoModule: modules.cryptoModule,",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "7706:             this.stop = this.destroy; // --------",
      "7712:             this.getAuthKey = modules.config.getAuthKey.bind(modules.config);",
      "7713:             this.setAuthKey = modules.config.setAuthKey.bind(modules.config);",
      "7715:             this.getUUID = modules.config.getUUID.bind(modules.config);",
      "7716:             this.setUUID = modules.config.setUUID.bind(modules.config);",
      "7717:             this.getUserId = modules.config.getUserId.bind(modules.config);",
      "7718:             this.setUserId = modules.config.setUserId.bind(modules.config);",
      "7719:             this.getFilterExpression = modules.config.getFilterExpression.bind(modules.config);",
      "7720:             this.setFilterExpression = modules.config.setFilterExpression.bind(modules.config);",
      "7721:             this.setHeartbeatInterval = modules.config.setHeartbeatInterval.bind(modules.config);",
      "7722:             if (networking.hasModule('proxy')) {",
      "7723:                 this.setProxy = function (proxy) {",
      "",
      "[Removed Lines]",
      "7709:             this.encrypt = crypto.encrypt.bind(crypto);",
      "7710:             this.decrypt = crypto.decrypt.bind(crypto);",
      "7714:             this.setCipherKey = modules.config.setCipherKey.bind(modules.config);",
      "",
      "[Added Lines]",
      "7834:             this.encrypt = function (data, key) {",
      "7835:                 if (typeof key === 'undefined' && modules.cryptoModule) {",
      "7836:                     var encrypted = modules.cryptoModule.encrypt(data);",
      "7837:                     return typeof encrypted === 'string' ? encrypted : encode$1(encrypted);",
      "7838:                 }",
      "7839:                 else {",
      "7840:                     return crypto.encrypt(data, key);",
      "7841:                 }",
      "7842:             };",
      "7843:             this.decrypt = function (data, key) {",
      "7844:                 if (typeof key === 'undefined' && cryptoModule) {",
      "7845:                     var decrypted = modules.cryptoModule.decrypt(data);",
      "7846:                     return decrypted instanceof ArrayBuffer ? encode$1(decrypted) : decrypted;",
      "7847:                 }",
      "7848:                 else {",
      "7849:                     return crypto.decrypt(data, key);",
      "7850:                 }",
      "7851:             };",
      "7862:             this.setCipherKey = function (key) { return modules.config.setCipherKey(key, setup, modules); };",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "12534:                 var bKey, abPlaindata, abCipherdata;",
      "12535:                 return __generator(this, function (_a) {",
      "12536:                     switch (_a.label) {",
      "12538:                         case 1:",
      "12539:                             bKey = _a.sent();",
      "12541:                         case 2:",
      "12542:                             abPlaindata = _a.sent();",
      "12543:                             return [4 /*yield*/, this.encryptArrayBuffer(bKey, abPlaindata)];",
      "",
      "[Removed Lines]",
      "12537:                         case 0: return [4 /*yield*/, this.getKey(key)];",
      "12540:                             return [4 /*yield*/, file.toArrayBuffer()];",
      "",
      "[Added Lines]",
      "12679:                         case 0:",
      "12680:                             if (file.data.byteLength <= 0)",
      "12681:                                 throw new Error('encryption error. empty content');",
      "12682:                             return [4 /*yield*/, this.getKey(key)];",
      "12685:                             return [4 /*yield*/, file.data.arrayBuffer()];",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "12560:                         case 0: return [4 /*yield*/, this.getKey(key)];",
      "12561:                         case 1:",
      "12562:                             bKey = _a.sent();",
      "12564:                         case 2:",
      "12565:                             abCipherdata = _a.sent();",
      "12566:                             return [4 /*yield*/, this.decryptArrayBuffer(bKey, abCipherdata)];",
      "",
      "[Removed Lines]",
      "12563:                             return [4 /*yield*/, file.toArrayBuffer()];",
      "",
      "[Added Lines]",
      "12708:                             return [4 /*yield*/, file.data.arrayBuffer()];",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "12576:         };",
      "12577:         WebCryptography.prototype.getKey = function (key) {",
      "12578:             return __awaiter(this, void 0, void 0, function () {",
      "12580:                 return __generator(this, function (_a) {",
      "12581:                     switch (_a.label) {",
      "12585:                         case 1:",
      "12588:                             return [2 /*return*/, crypto.subtle.importKey('raw', abKey, 'AES-CBC', true, ['encrypt', 'decrypt'])];",
      "12589:                     }",
      "12590:                 });",
      "",
      "[Removed Lines]",
      "12579:                 var bKey, abHash, abKey;",
      "12582:                         case 0:",
      "12583:                             bKey = Buffer.from(key);",
      "12584:                             return [4 /*yield*/, crypto.subtle.digest('SHA-256', bKey.buffer)];",
      "12586:                             abHash = _a.sent();",
      "12587:                             abKey = Buffer.from(Buffer.from(abHash).toString('hex').slice(0, 32), 'utf8').buffer;",
      "",
      "[Added Lines]",
      "12724:                 var digest, hashHex, abKey;",
      "12727:                         case 0: return [4 /*yield*/, crypto.subtle.digest('SHA-256', WebCryptography.encoder.encode(key))];",
      "12729:                             digest = _a.sent();",
      "12730:                             hashHex = Array.from(new Uint8Array(digest))",
      "12731:                                 .map(function (b) { return b.toString(16).padStart(2, '0'); })",
      "12732:                                 .join('');",
      "12733:                             abKey = WebCryptography.encoder.encode(hashHex.slice(0, 32)).buffer;",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "12607:         };",
      "12608:         WebCryptography.prototype.decryptArrayBuffer = function (key, ciphertext) {",
      "12609:             return __awaiter(this, void 0, void 0, function () {",
      "12611:                 return __generator(this, function (_a) {",
      "12614:                 });",
      "12615:             });",
      "12616:         };",
      "",
      "[Removed Lines]",
      "12610:                 var abIv;",
      "12612:                     abIv = ciphertext.slice(0, 16);",
      "12613:                     return [2 /*return*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, ciphertext.slice(16))];",
      "",
      "[Added Lines]",
      "12756:                 var abIv, data;",
      "12758:                     switch (_a.label) {",
      "12759:                         case 0:",
      "12760:                             abIv = ciphertext.slice(0, 16);",
      "12761:                             if (ciphertext.slice(WebCryptography.IV_LENGTH).byteLength <= 0)",
      "12762:                                 throw new Error('decryption error: empty content');",
      "12763:                             return [4 /*yield*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, ciphertext.slice(WebCryptography.IV_LENGTH))];",
      "12764:                         case 1:",
      "12765:                             data = _a.sent();",
      "12766:                             return [2 /*return*/, data];",
      "12767:                     }",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "12621:                     switch (_a.label) {",
      "12622:                         case 0:",
      "12623:                             abIv = crypto.getRandomValues(new Uint8Array(16));",
      "12625:                             return [4 /*yield*/, crypto.subtle.encrypt({ name: 'AES-CBC', iv: abIv }, key, abPlaintext)];",
      "12626:                         case 1:",
      "12627:                             abPayload = _a.sent();",
      "12628:                             ciphertext = concatArrayBuffer(abIv.buffer, abPayload);",
      "12630:                     }",
      "12631:                 });",
      "12632:             });",
      "",
      "[Removed Lines]",
      "12624:                             abPlaintext = Buffer.from(plaintext).buffer;",
      "12629:                             return [2 /*return*/, Buffer.from(ciphertext).toString('utf8')];",
      "",
      "[Added Lines]",
      "12778:                             abPlaintext = WebCryptography.encoder.encode(plaintext).buffer;",
      "12783:                             return [2 /*return*/, WebCryptography.decoder.decode(ciphertext)];",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "12637:                 return __generator(this, function (_a) {",
      "12638:                     switch (_a.label) {",
      "12639:                         case 0:",
      "12641:                             abIv = abCiphertext.slice(0, 16);",
      "12642:                             abPayload = abCiphertext.slice(16);",
      "12643:                             return [4 /*yield*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, abPayload)];",
      "12644:                         case 1:",
      "12645:                             abPlaintext = _a.sent();",
      "12647:                     }",
      "12648:                 });",
      "12649:             });",
      "12650:         };",
      "12651:         WebCryptography.IV_LENGTH = 16;",
      "12652:         return WebCryptography;",
      "12653:     }());",
      "",
      "[Removed Lines]",
      "12640:                             abCiphertext = Buffer.from(ciphertext);",
      "12646:                             return [2 /*return*/, Buffer.from(abPlaintext).toString('utf8')];",
      "",
      "[Added Lines]",
      "12794:                             abCiphertext = WebCryptography.encoder.encode(ciphertext).buffer;",
      "12800:                             return [2 /*return*/, WebCryptography.decoder.decode(abPlaintext)];",
      "12806:         WebCryptography.encoder = new TextEncoder();",
      "12807:         WebCryptography.decoder = new TextDecoder();",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "12764:         _a.supportsFileUri = false,",
      "12765:         _a);",
      "12768:     function sendBeacon(url) {",
      "12769:         if (navigator && navigator.sendBeacon) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "12923:     var LegacyCryptor = /** @class */ (function () {",
      "12924:         function LegacyCryptor(config) {",
      "12925:             this.config = config;",
      "12926:             this.cryptor = new default_1$a({ config: config });",
      "12927:             this.fileCryptor = new WebCryptography();",
      "12928:         }",
      "12929:         Object.defineProperty(LegacyCryptor.prototype, \"identifier\", {",
      "12930:             get: function () {",
      "12931:                 return '';",
      "12932:             },",
      "12933:             enumerable: false,",
      "12934:             configurable: true",
      "12935:         });",
      "12936:         LegacyCryptor.prototype.encrypt = function (data) {",
      "12937:             var stringData = typeof data === 'string' ? data : new TextDecoder().decode(data);",
      "12938:             return {",
      "12939:                 data: this.cryptor.encrypt(stringData),",
      "12940:                 metadata: null,",
      "12941:             };",
      "12942:         };",
      "12943:         LegacyCryptor.prototype.decrypt = function (encryptedData) {",
      "12944:             var data = typeof encryptedData.data === 'string' ? encryptedData.data : encode$1(encryptedData.data);",
      "12945:             return this.cryptor.decrypt(data);",
      "12946:         };",
      "12947:         LegacyCryptor.prototype.encryptFile = function (file, File) {",
      "12948:             var _a;",
      "12949:             return __awaiter(this, void 0, void 0, function () {",
      "12950:                 return __generator(this, function (_b) {",
      "12953:                     return [2 /*return*/, this.fileCryptor.encryptFile((_a = this.config) === null || _a === void 0 ? void 0 : _a.cipherKey, file, File)];",
      "12954:                 });",
      "12955:             });",
      "12956:         };",
      "12957:         LegacyCryptor.prototype.decryptFile = function (file, File) {",
      "12958:             return __awaiter(this, void 0, void 0, function () {",
      "12959:                 return __generator(this, function (_a) {",
      "12962:                     return [2 /*return*/, this.fileCryptor.decryptFile(this.config.cipherKey, file, File)];",
      "12963:                 });",
      "12964:             });",
      "12965:         };",
      "12966:         return LegacyCryptor;",
      "12967:     }());",
      "12969:     var AesCbcCryptor = /** @class */ (function () {",
      "12970:         function AesCbcCryptor(configuration) {",
      "12971:             this.cipherKey = configuration.cipherKey;",
      "12972:             this.CryptoJS = hmacSha256;",
      "12973:             this.encryptedKey = this.CryptoJS.SHA256(this.cipherKey);",
      "12974:         }",
      "12975:         Object.defineProperty(AesCbcCryptor.prototype, \"algo\", {",
      "12976:             get: function () {",
      "12977:                 return 'AES-CBC';",
      "12978:             },",
      "12979:             enumerable: false,",
      "12980:             configurable: true",
      "12981:         });",
      "12982:         Object.defineProperty(AesCbcCryptor.prototype, \"identifier\", {",
      "12983:             get: function () {",
      "12984:                 return 'ACRH';",
      "12985:             },",
      "12986:             enumerable: false,",
      "12987:             configurable: true",
      "12988:         });",
      "12989:         AesCbcCryptor.prototype.getIv = function () {",
      "12990:             return crypto.getRandomValues(new Uint8Array(AesCbcCryptor.BLOCK_SIZE));",
      "12991:         };",
      "12992:         AesCbcCryptor.prototype.getKey = function () {",
      "12993:             return __awaiter(this, void 0, void 0, function () {",
      "12994:                 var bKey, abHash;",
      "12995:                 return __generator(this, function (_a) {",
      "12996:                     switch (_a.label) {",
      "12997:                         case 0:",
      "12998:                             bKey = AesCbcCryptor.encoder.encode(this.cipherKey);",
      "12999:                             return [4 /*yield*/, crypto.subtle.digest('SHA-256', bKey.buffer)];",
      "13000:                         case 1:",
      "13001:                             abHash = _a.sent();",
      "13002:                             return [2 /*return*/, crypto.subtle.importKey('raw', abHash, this.algo, true, ['encrypt', 'decrypt'])];",
      "13003:                     }",
      "13004:                 });",
      "13005:             });",
      "13006:         };",
      "13007:         AesCbcCryptor.prototype.encrypt = function (data) {",
      "13008:             var stringData = typeof data === 'string' ? data : AesCbcCryptor.decoder.decode(data);",
      "13009:             if (stringData.length === 0)",
      "13010:                 throw new Error('encryption error. empty content');",
      "13011:             var abIv = this.getIv();",
      "13012:             return {",
      "13013:                 metadata: abIv,",
      "13014:                 data: decode$1(this.CryptoJS.AES.encrypt(data, this.encryptedKey, {",
      "13015:                     iv: this.bufferToWordArray(abIv),",
      "13016:                     mode: this.CryptoJS.mode.CBC,",
      "13017:                 }).ciphertext.toString(this.CryptoJS.enc.Base64)),",
      "13018:             };",
      "13019:         };",
      "13020:         AesCbcCryptor.prototype.decrypt = function (encryptedData) {",
      "13021:             var iv = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.metadata));",
      "13022:             var data = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.data));",
      "13023:             return AesCbcCryptor.encoder.encode(this.CryptoJS.AES.decrypt({ ciphertext: data }, this.encryptedKey, {",
      "13024:                 iv: iv,",
      "13025:                 mode: this.CryptoJS.mode.CBC,",
      "13026:             }).toString(this.CryptoJS.enc.Utf8)).buffer;",
      "13027:         };",
      "13028:         AesCbcCryptor.prototype.encryptFileData = function (data) {",
      "13029:             return __awaiter(this, void 0, void 0, function () {",
      "13030:                 var key, iv;",
      "13031:                 var _a;",
      "13032:                 return __generator(this, function (_b) {",
      "13033:                     switch (_b.label) {",
      "13034:                         case 0: return [4 /*yield*/, this.getKey()];",
      "13035:                         case 1:",
      "13036:                             key = _b.sent();",
      "13037:                             iv = this.getIv();",
      "13038:                             _a = {};",
      "13039:                             return [4 /*yield*/, crypto.subtle.encrypt({ name: this.algo, iv: iv }, key, data)];",
      "13040:                         case 2: return [2 /*return*/, (_a.data = _b.sent(),",
      "13041:                                 _a.metadata = iv,",
      "13042:                                 _a)];",
      "13043:                     }",
      "13044:                 });",
      "13045:             });",
      "13046:         };",
      "13047:         AesCbcCryptor.prototype.decryptFileData = function (encryptedData) {",
      "13048:             return __awaiter(this, void 0, void 0, function () {",
      "13049:                 var key;",
      "13050:                 return __generator(this, function (_a) {",
      "13051:                     switch (_a.label) {",
      "13052:                         case 0: return [4 /*yield*/, this.getKey()];",
      "13053:                         case 1:",
      "13054:                             key = _a.sent();",
      "13055:                             return [2 /*return*/, crypto.subtle.decrypt({ name: this.algo, iv: encryptedData.metadata }, key, encryptedData.data)];",
      "13056:                     }",
      "13057:                 });",
      "13058:             });",
      "13059:         };",
      "13060:         AesCbcCryptor.prototype.bufferToWordArray = function (b) {",
      "13061:             var wa = [];",
      "13062:             var i;",
      "13063:             for (i = 0; i < b.length; i += 1) {",
      "13064:                 wa[(i / 4) | 0] |= b[i] << (24 - 8 * i);",
      "13065:             }",
      "13066:             return this.CryptoJS.lib.WordArray.create(wa, b.length);",
      "13067:         };",
      "13068:         AesCbcCryptor.BLOCK_SIZE = 16;",
      "13069:         AesCbcCryptor.encoder = new TextEncoder();",
      "13070:         AesCbcCryptor.decoder = new TextDecoder();",
      "13071:         return AesCbcCryptor;",
      "13072:     }());",
      "13074:     var CryptoModule = /** @class */ (function () {",
      "13075:         function CryptoModule(cryptoModuleConfiguration) {",
      "13076:             var _a;",
      "13077:             this.defaultCryptor = cryptoModuleConfiguration.default;",
      "13078:             this.cryptors = (_a = cryptoModuleConfiguration.cryptors) !== null && _a !== void 0 ? _a : [];",
      "13079:         }",
      "13082:         CryptoModule.legacyCryptoModule = function (config) {",
      "13083:             var _a;",
      "13084:             return new this({",
      "13085:                 default: new LegacyCryptor({",
      "13086:                     cipherKey: config.cipherKey,",
      "13087:                     useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "13088:                 }),",
      "13089:                 cryptors: [new AesCbcCryptor({ cipherKey: config.cipherKey })],",
      "13090:             });",
      "13091:         };",
      "13092:         CryptoModule.aesCbcCryptoModule = function (config) {",
      "13093:             var _a;",
      "13094:             return new this({",
      "13095:                 default: new AesCbcCryptor({ cipherKey: config.cipherKey }),",
      "13096:                 cryptors: [",
      "13097:                     new LegacyCryptor({",
      "13098:                         cipherKey: config.cipherKey,",
      "13099:                         useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "13100:                     }),",
      "13101:                 ],",
      "13102:             });",
      "13103:         };",
      "13104:         CryptoModule.withDefaultCryptor = function (defaultCryptor) {",
      "13105:             return new this({ default: defaultCryptor });",
      "13106:         };",
      "13107:         CryptoModule.prototype.getAllCryptors = function () {",
      "13108:             return __spreadArray([this.defaultCryptor], __read(this.cryptors), false);",
      "13109:         };",
      "13110:         CryptoModule.prototype.encrypt = function (data) {",
      "13111:             var encrypted = this.defaultCryptor.encrypt(data);",
      "13112:             if (!encrypted.metadata)",
      "13113:                 return encrypted.data;",
      "13114:             var headerData = this.getHeaderData(encrypted);",
      "13115:             return this.concatArrayBuffer(headerData, encrypted.data);",
      "13116:         };",
      "13117:         CryptoModule.prototype.decrypt = function (data) {",
      "13118:             var encryptedData = typeof data === 'string' ? decode$1(data) : data;",
      "13119:             var header = CryptorHeader.tryParse(encryptedData);",
      "13120:             var cryptor = this.getCryptor(header);",
      "13121:             var metadata = header.length > 0",
      "13122:                 ? encryptedData.slice(header.length - header.metadataLength, header.length)",
      "13123:                 : null;",
      "13124:             if (encryptedData.slice(header.length).byteLength <= 0)",
      "13125:                 throw new Error('decryption error. empty content');",
      "13126:             return cryptor.decrypt({",
      "13127:                 data: encryptedData.slice(header.length),",
      "13128:                 metadata: metadata,",
      "13129:             });",
      "13130:         };",
      "13131:         CryptoModule.prototype.encryptFile = function (file, File) {",
      "13132:             return __awaiter(this, void 0, void 0, function () {",
      "13133:                 var fileData, encrypted;",
      "13134:                 return __generator(this, function (_a) {",
      "13135:                     switch (_a.label) {",
      "13136:                         case 0:",
      "13137:                             if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "13138:                                 return [2 /*return*/, this.defaultCryptor.encryptFile(file, File)];",
      "13139:                             fileData = this.getFileData(file.data);",
      "13140:                             return [4 /*yield*/, this.defaultCryptor.encryptFileData(fileData)];",
      "13141:                         case 1:",
      "13142:                             encrypted = _a.sent();",
      "13143:                             return [2 /*return*/, File.create({",
      "13144:                                     name: file.name,",
      "13145:                                     mimeType: 'application/octet-stream',",
      "13146:                                     data: this.concatArrayBuffer(this.getHeaderData(encrypted), encrypted.data),",
      "13147:                                 })];",
      "13148:                     }",
      "13149:                 });",
      "13150:             });",
      "13151:         };",
      "13152:         CryptoModule.prototype.decryptFile = function (file, File) {",
      "13153:             return __awaiter(this, void 0, void 0, function () {",
      "13154:                 var data, header, cryptor, fileData, metadata, _a, _b;",
      "13155:                 var _c;",
      "13156:                 return __generator(this, function (_d) {",
      "13157:                     switch (_d.label) {",
      "13158:                         case 0: return [4 /*yield*/, file.data.arrayBuffer()];",
      "13159:                         case 1:",
      "13160:                             data = _d.sent();",
      "13161:                             header = CryptorHeader.tryParse(data);",
      "13162:                             cryptor = this.getCryptor(header);",
      "13163:                             if ((cryptor === null || cryptor === void 0 ? void 0 : cryptor.identifier) === CryptoModule.LEGACY_IDENTIFIER) {",
      "13164:                                 return [2 /*return*/, cryptor.decryptFile(file, File)];",
      "13165:                             }",
      "13166:                             fileData = this.getFileData(data);",
      "13167:                             metadata = fileData.slice(header.length - header.metadataLength, header.length);",
      "13168:                             _b = (_a = File).create;",
      "13169:                             _c = {",
      "13170:                                 name: file.name",
      "13171:                             };",
      "13172:                             return [4 /*yield*/, this.defaultCryptor.decryptFileData({",
      "13173:                                     data: data.slice(header.length),",
      "13174:                                     metadata: metadata,",
      "13175:                                 })];",
      "13176:                         case 2: return [2 /*return*/, _b.apply(_a, [(_c.data = _d.sent(),",
      "13177:                                     _c)])];",
      "13178:                     }",
      "13179:                 });",
      "13180:             });",
      "13181:         };",
      "13182:         CryptoModule.prototype.getCryptor = function (header) {",
      "13183:             if (header === '') {",
      "13184:                 var cryptor = this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "13185:                 if (cryptor)",
      "13186:                     return cryptor;",
      "13187:                 throw new Error('unknown cryptor error');",
      "13188:             }",
      "13189:             else if (header instanceof CryptorHeaderV1) {",
      "13190:                 return this.getCryptorFromId(header.identifier);",
      "13191:             }",
      "13192:         };",
      "13193:         CryptoModule.prototype.getCryptorFromId = function (id) {",
      "13194:             var cryptor = this.getAllCryptors().find(function (c) { return id === c.identifier; });",
      "13195:             if (cryptor) {",
      "13196:                 return cryptor;",
      "13197:             }",
      "13198:             throw Error('unknown cryptor error');",
      "13199:         };",
      "13200:         CryptoModule.prototype.concatArrayBuffer = function (ab1, ab2) {",
      "13201:             var tmp = new Uint8Array(ab1.byteLength + ab2.byteLength);",
      "13202:             tmp.set(new Uint8Array(ab1), 0);",
      "13203:             tmp.set(new Uint8Array(ab2), ab1.byteLength);",
      "13204:             return tmp.buffer;",
      "13205:         };",
      "13206:         CryptoModule.prototype.getHeaderData = function (encrypted) {",
      "13207:             if (!encrypted.metadata)",
      "13208:                 return;",
      "13209:             var header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "13210:             var headerData = new Uint8Array(header.length);",
      "13211:             var pos = 0;",
      "13212:             headerData.set(header.data, pos);",
      "13213:             pos += header.length - encrypted.metadata.byteLength;",
      "13214:             headerData.set(new Uint8Array(encrypted.metadata), pos);",
      "13215:             return headerData.buffer;",
      "13216:         };",
      "13217:         CryptoModule.prototype.getFileData = function (input) {",
      "13218:             if (input instanceof ArrayBuffer) {",
      "13219:                 return input;",
      "13220:             }",
      "13221:             if (typeof input === 'string') {",
      "13222:                 return CryptoModule.encoder.encode(input);",
      "13223:             }",
      "13224:             throw new Error('Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer');",
      "13225:         };",
      "13226:         CryptoModule.LEGACY_IDENTIFIER = '';",
      "13227:         CryptoModule.encoder = new TextEncoder();",
      "13228:         CryptoModule.decoder = new TextDecoder();",
      "13229:         return CryptoModule;",
      "13230:     }());",
      "13232:     var CryptorHeader = /** @class */ (function () {",
      "13233:         function CryptorHeader() {",
      "13234:         }",
      "13235:         CryptorHeader.from = function (id, metadata) {",
      "13236:             if (id === CryptorHeader.LEGACY_IDENTIFIER)",
      "13237:                 return;",
      "13238:             return new CryptorHeaderV1(id, metadata.byteLength);",
      "13239:         };",
      "13240:         CryptorHeader.tryParse = function (data) {",
      "13241:             var encryptedData = new Uint8Array(data);",
      "13242:             var sentinel = '';",
      "13243:             var version = null;",
      "13244:             if (encryptedData.byteLength >= 4) {",
      "13245:                 sentinel = encryptedData.slice(0, 4);",
      "13246:                 if (this.decoder.decode(sentinel) !== CryptorHeader.SENTINEL)",
      "13247:                     return '';",
      "13248:             }",
      "13249:             if (encryptedData.byteLength >= 5) {",
      "13250:                 version = encryptedData[4];",
      "13251:             }",
      "13252:             else {",
      "13253:                 throw new Error('decryption error. invalid header version');",
      "13254:             }",
      "13255:             if (version > CryptorHeader.MAX_VERSION)",
      "13256:                 throw new Error('unknown cryptor error');",
      "13257:             var identifier = '';",
      "13258:             var pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "13259:             if (encryptedData.byteLength >= pos) {",
      "13260:                 identifier = encryptedData.slice(5, pos);",
      "13261:             }",
      "13262:             else {",
      "13263:                 throw new Error('decryption error. invalid crypto identifier');",
      "13264:             }",
      "13265:             var metadataLength = null;",
      "13266:             if (encryptedData.byteLength >= pos + 1) {",
      "13267:                 metadataLength = encryptedData[pos];",
      "13268:             }",
      "13269:             else {",
      "13270:                 throw new Error('decryption error. invalid metadata length');",
      "13271:             }",
      "13272:             pos += 1;",
      "13273:             if (metadataLength === 255 && encryptedData.byteLength >= pos + 2) {",
      "13274:                 metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "13275:                 pos += 2;",
      "13276:             }",
      "13277:             return new CryptorHeaderV1(this.decoder.decode(identifier), metadataLength);",
      "13278:         };",
      "13279:         CryptorHeader.SENTINEL = 'PNED';",
      "13280:         CryptorHeader.LEGACY_IDENTIFIER = '';",
      "13281:         CryptorHeader.IDENTIFIER_LENGTH = 4;",
      "13282:         CryptorHeader.VERSION = 1;",
      "13283:         CryptorHeader.MAX_VERSION = 1;",
      "13284:         CryptorHeader.decoder = new TextDecoder();",
      "13285:         return CryptorHeader;",
      "13286:     }());",
      "13288:     var CryptorHeaderV1 = /** @class */ (function () {",
      "13289:         function CryptorHeaderV1(id, metadataLength) {",
      "13290:             this._identifier = id;",
      "13291:             this._metadataLength = metadataLength;",
      "13292:         }",
      "13293:         Object.defineProperty(CryptorHeaderV1.prototype, \"identifier\", {",
      "13294:             get: function () {",
      "13295:                 return this._identifier;",
      "13296:             },",
      "13297:             set: function (value) {",
      "13298:                 this._identifier = value;",
      "13299:             },",
      "13300:             enumerable: false,",
      "13301:             configurable: true",
      "13302:         });",
      "13303:         Object.defineProperty(CryptorHeaderV1.prototype, \"metadataLength\", {",
      "13304:             get: function () {",
      "13305:                 return this._metadataLength;",
      "13306:             },",
      "13307:             set: function (value) {",
      "13308:                 this._metadataLength = value;",
      "13309:             },",
      "13310:             enumerable: false,",
      "13311:             configurable: true",
      "13312:         });",
      "13313:         Object.defineProperty(CryptorHeaderV1.prototype, \"version\", {",
      "13314:             get: function () {",
      "13315:                 return CryptorHeader.VERSION;",
      "13316:             },",
      "13317:             enumerable: false,",
      "13318:             configurable: true",
      "13319:         });",
      "13320:         Object.defineProperty(CryptorHeaderV1.prototype, \"length\", {",
      "13321:             get: function () {",
      "13322:                 return (CryptorHeader.SENTINEL.length +",
      "13323:                     1 +",
      "13324:                     CryptorHeader.IDENTIFIER_LENGTH +",
      "13325:                     (this.metadataLength < 255 ? 1 : 3) +",
      "13326:                     this.metadataLength);",
      "13327:             },",
      "13328:             enumerable: false,",
      "13329:             configurable: true",
      "13330:         });",
      "13331:         Object.defineProperty(CryptorHeaderV1.prototype, \"data\", {",
      "13332:             get: function () {",
      "13333:                 var pos = 0;",
      "13334:                 var header = new Uint8Array(this.length);",
      "13335:                 var encoder = new TextEncoder();",
      "13336:                 header.set(encoder.encode(CryptorHeader.SENTINEL));",
      "13337:                 pos += CryptorHeader.SENTINEL.length;",
      "13338:                 header[pos] = this.version;",
      "13339:                 pos++;",
      "13340:                 if (this.identifier)",
      "13341:                     header.set(encoder.encode(this.identifier), pos);",
      "13342:                 pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "13343:                 var metadataLength = this.metadataLength;",
      "13344:                 if (metadataLength < 255) {",
      "13345:                     header[pos] = metadataLength;",
      "13346:                 }",
      "13347:                 else {",
      "13348:                     header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "13349:                 }",
      "13350:                 return header;",
      "13351:             },",
      "13352:             enumerable: false,",
      "13353:             configurable: true",
      "13354:         });",
      "13355:         CryptorHeaderV1.IDENTIFIER_LENGTH = 4;",
      "13356:         CryptorHeaderV1.SENTINEL = 'PNED';",
      "13357:         return CryptorHeaderV1;",
      "13358:     }());",
      "",
      "---------------",
      "--- Hunk 33 ---",
      "[Context before]",
      "12792:             setup.cbor = new default_1$1(function (arrayBuffer) { return stringifyBufferKeys(CborReader.decode(arrayBuffer)); }, decode$1);",
      "12793:             setup.PubNubFile = PubNubFile;",
      "12794:             setup.cryptography = new WebCryptography();",
      "12795:             _this = _super.call(this, setup) || this;",
      "12796:             if (listenToBrowserNetworkEvents) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13388:             setup.initCryptoModule = function (cryptoConfiguration) {",
      "13389:                 return new CryptoModule({",
      "13390:                     default: new LegacyCryptor({",
      "13391:                         cipherKey: cryptoConfiguration.cipherKey,",
      "13392:                         useRandomIVs: cryptoConfiguration.useRandomIVs,",
      "13393:                     }),",
      "13394:                     cryptors: [new AesCbcCryptor({ cipherKey: cryptoConfiguration.cipherKey })],",
      "13395:                 });",
      "13396:             };",
      "",
      "---------------",
      "--- Hunk 34 ---",
      "[Context before]",
      "12804:             }",
      "12805:             return _this;",
      "12806:         }",
      "12807:         return default_1;",
      "12808:     }(default_1$3));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13409:         default_1.CryptoModule = CryptoModule;",
      "",
      "---------------"
    ],
    "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
      "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "12:     LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR",
      "13:     OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR",
      "14:     PERFORMANCE OF THIS SOFTWARE.",
      "",
      "[Removed Lines]",
      "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.setCipherKey(o.cipherKey),this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e){return this.cipherKey=e,this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.3.3\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}var m,v,_,O,S,P=P||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=P,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),v=(m=P).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=v.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),O=(_=P).lib.WordArray,_.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return O.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=P,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],m=e[i+10],v=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],E=a[1],T=a[2],k=a[3],u,7,c[0]),k=t(k,w,E,T,s,12,c[1]),T=t(T,k,w,E,l,17,c[2]),E=t(E,T,k,w,p,22,c[3]);w=t(w,E,T,k,f,7,c[4]),k=t(k,w,E,T,h,12,c[5]),T=t(T,k,w,E,d,17,c[6]),E=t(E,T,k,w,y,22,c[7]),w=t(w,E,T,k,g,7,c[8]),k=t(k,w,E,T,b,12,c[9]),T=t(T,k,w,E,m,17,c[10]),E=t(E,T,k,w,v,22,c[11]),w=t(w,E,T,k,_,7,c[12]),k=t(k,w,E,T,O,12,c[13]),T=t(T,k,w,E,S,17,c[14]),w=n(w,E=t(E,T,k,w,P,22,c[15]),T,k,s,5,c[16]),k=n(k,w,E,T,d,9,c[17]),T=n(T,k,w,E,v,14,c[18]),E=n(E,T,k,w,u,20,c[19]),w=n(w,E,T,k,h,5,c[20]),k=n(k,w,E,T,m,9,c[21]),T=n(T,k,w,E,P,14,c[22]),E=n(E,T,k,w,f,20,c[23]),w=n(w,E,T,k,b,5,c[24]),k=n(k,w,E,T,S,9,c[25]),T=n(T,k,w,E,p,14,c[26]),E=n(E,T,k,w,g,20,c[27]),w=n(w,E,T,k,O,5,c[28]),k=n(k,w,E,T,l,9,c[29]),T=n(T,k,w,E,y,14,c[30]),w=r(w,E=n(E,T,k,w,_,20,c[31]),T,k,h,4,c[32]),k=r(k,w,E,T,g,11,c[33]),T=r(T,k,w,E,v,16,c[34]),E=r(E,T,k,w,S,23,c[35]),w=r(w,E,T,k,s,4,c[36]),k=r(k,w,E,T,f,11,c[37]),T=r(T,k,w,E,y,16,c[38]),E=r(E,T,k,w,m,23,c[39]),w=r(w,E,T,k,O,4,c[40]),k=r(k,w,E,T,u,11,c[41]),T=r(T,k,w,E,p,16,c[42]),E=r(E,T,k,w,d,23,c[43]),w=r(w,E,T,k,b,4,c[44]),k=r(k,w,E,T,_,11,c[45]),T=r(T,k,w,E,P,16,c[46]),w=o(w,E=r(E,T,k,w,l,23,c[47]),T,k,u,6,c[48]),k=o(k,w,E,T,y,10,c[49]),T=o(T,k,w,E,S,15,c[50]),E=o(E,T,k,w,h,21,c[51]),w=o(w,E,T,k,_,6,c[52]),k=o(k,w,E,T,p,10,c[53]),T=o(T,k,w,E,m,15,c[54]),E=o(E,T,k,w,s,21,c[55]),w=o(w,E,T,k,g,6,c[56]),k=o(k,w,E,T,P,10,c[57]),T=o(T,k,w,E,d,15,c[58]),E=o(E,T,k,w,O,21,c[59]),w=o(w,E,T,k,f,6,c[60]),k=o(k,w,E,T,v,10,c[61]),T=o(T,k,w,E,l,15,c[62]),E=o(E,T,k,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+E|0,a[2]=a[2]+T|0,a[3]=a[3]+k|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=P,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),P.lib.Cipher||function(e){var t=(h=P).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=P,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var m=h[y],v=h[m],_=h[v],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*v^257*m^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=m^h[h[h[_^m]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),P.mode.ECB=((S=P.lib.BlockCipherMode.extend()).Encryptor=S.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),S.Decryptor=S.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),S);var w=P;function k(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return w.lib.WordArray.create(n,e.length)}var T=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return w.HmacSHA256(e,this._config.secretKey).toString(w.enc.Base64)},e.prototype.SHA256=function(e){return w.SHA256(e).toString(w.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?w.enc.Base64.parse(e):\"hex\"===t.keyEncoding?w.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?w.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?w.mode.ECB:w.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?w.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return w.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=w.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(w.enc.Base64)}var s=this._getIV(n);return w.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(w.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=k((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=k(u.slice(16));try{var s=w.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(w.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=w.enc.Base64.parse(e);s=w.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(w.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),E=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),A=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function N(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function C(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var j={signPamFromParams:function(e){return C(e).map((function(t){return\"\".concat(t,\"=\").concat(N(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:N},M={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},R=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new E({timeEndpoint:i}),this._dedupingManager=new A({config:s})}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===M.PNTimeoutCategory?this._startSubscribeLoop():e.category===M.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:M.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===M.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=M.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=M.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(j.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._config.cipherKey){var d=o._crypto.decrypt(e.payload);\"object\"==typeof d&&null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._config.cipherKey?y.message=o._crypto.decrypt(e.payload):y.message=e.payload,o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),U={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==U.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==U.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case U.PNPublishOperation:t=\"pub\";break;case U.PNSignalOperation:t=\"sig\";break;case U.PNHistoryOperation:case U.PNFetchMessagesOperation:case U.PNDeleteMessagesOperation:case U.PNMessageCounts:t=\"hist\";break;case U.PNUnsubscribeOperation:case U.PNWhereNowOperation:case U.PNHereNowOperation:case U.PNHeartbeatOperation:case U.PNSetStateOperation:case U.PNGetStateOperation:t=\"pres\";break;case U.PNAddChannelsToGroupOperation:case U.PNRemoveChannelsFromGroupOperation:case U.PNChannelGroupsOperation:case U.PNRemoveGroupOperation:case U.PNChannelsForGroupOperation:t=\"cg\";break;case U.PNPushNotificationEnabledChannelsOperation:case U.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case U.PNCreateUserOperation:case U.PNUpdateUserOperation:case U.PNDeleteUserOperation:case U.PNGetUserOperation:case U.PNGetUsersOperation:case U.PNCreateSpaceOperation:case U.PNUpdateSpaceOperation:case U.PNDeleteSpaceOperation:case U.PNGetSpaceOperation:case U.PNGetSpacesOperation:case U.PNGetMembersOperation:case U.PNUpdateMembersOperation:case U.PNGetMembershipsOperation:case U.PNUpdateMembershipsOperation:t=\"obj\";break;case U.PNAddMessageActionOperation:case U.PNRemoveMessageActionOperation:case U.PNGetMessageActionsOperation:t=\"msga\";break;case U.PNAccessManagerGrant:case U.PNAccessManagerAudit:t=\"pam\";break;case U.PNAccessManagerGrantToken:case U.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),I=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),D=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(I),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(I),G=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(I),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new D(this._payload.apns,e,t),this.mpns=new F(this._payload.mpns,e,t),this.fcm=new G(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),L=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=M.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=M.PNNetworkDownCategory,this.announceStatus(e)},e}(),B=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),H=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function q(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function z(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function V(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function W(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=W(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(j.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function J(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===U.PNTimeOperation||t.getOperation()===U.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=j.createPromise());var h=t.validateParams(e,f);if(h)return l?l(q(h)):p?(p.reject(new H(\"Validation failed, check status for details\",q(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=z(t,e,f),m={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=V(a);var v=s.operationsLatencyForRequest();if(Object.keys(v).length&&(g=n(n({},g),v)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new H(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===U.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:M.PNUnknownCategory}),l(n,null)}else p&&p.reject(new H(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===W(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,m,O)}else if(\"PATCH\"===W(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,m,O)}else d=\"DELETE\"===W(e,t,f)?i.DELETE(g,m,O):\"GETFILE\"===W(e,t,f)?i.GETFILE(g,m,O):i.GET(g,m,O);return t.getOperation()===U.PNSubscribeOperation?d:p?p.promise:void 0}var Q=Object.freeze({__proto__:null,getOperation:function(){return U.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(j.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var X=Object.freeze({__proto__:null,getOperation:function(){return U.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(j.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return U.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(j.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return U.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return U.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(j.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var te=Object.freeze({__proto__:null,getOperation:function(){return U.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return U.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return U.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return U.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return U.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return U.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(j.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var se=Object.freeze({__proto__:null,getOperation:function(){return U.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return U.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return U.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(i),\"/uuid/\").concat(j.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var le=Object.freeze({__proto__:null,getOperation:function(){return U.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(j.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var pe=Object.freeze({__proto__:null,getOperation:function(){return U.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var fe=Object.freeze({__proto__:null,getOperation:function(){return U.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return U.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(j.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),de={getOperation:function(){return U.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ye={getOperation:function(){return U.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},ge={getOperation:function(){return U.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=e.crypto,r=e.config,o=JSON.stringify(t);return r.cipherKey&&(o=n.encrypt(o),o=JSON.stringify(o)),o||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(j.encodeString(t.channel),\"/0/\").concat(j.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},be=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.networking;return function(e){var a=e.channel,p=e.file,f=e.message,h=e.cipherKey,d=e.meta,y=e.ttl,g=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,b,m,v,_,O,S,P,w,k,T,E,A,N,C,j,M,R,U,x,I,D,F,G,K,L;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new H(\"Validation failed, check status for details\",q(\"channel can't be empty\"));if(!p)throw new H(\"Validation failed, check status for details\",q(\"file can't be empty\"));return e=s.create(p),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,b=o.url,m=o.form_fields,v=t.data,_=v.id,O=v.name,s.supportsEncryptFile&&(null!=h?h:u.cipherKey)?[4,c.encryptFile(null!=h?h:u.cipherKey,e,s)]:[3,3];case 2:e=i.sent(),i.label=3;case 3:S=m,e.mimeType&&(S=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=4;case 4:return i.trys.push([4,18,,19]),s.supportsFileUri&&p.uri?(k=(w=l).POSTFILE,T=[b,S],[4,e.toFileUri()]):[3,7];case 5:return[4,k.apply(w,T.concat([i.sent()]))];case 6:return P=i.sent(),[3,17];case 7:return s.supportsFile?(A=(E=l).POSTFILE,N=[b,S],[4,e.toFile()]):[3,10];case 8:return[4,A.apply(E,N.concat([i.sent()]))];case 9:return P=i.sent(),[3,17];case 10:return s.supportsBuffer?(j=(C=l).POSTFILE,M=[b,S],[4,e.toBuffer()]):[3,13];case 11:return[4,j.apply(C,M.concat([i.sent()]))];case 12:return P=i.sent(),[3,17];case 13:return s.supportsBlob?(U=(R=l).POSTFILE,x=[b,S],[4,e.toBlob()]):[3,16];case 14:return[4,U.apply(R,x.concat([i.sent()]))];case 15:return P=i.sent(),[3,17];case 16:throw new Error(\"Unsupported environment\");case 17:return[3,19];case 18:throw(I=i.sent()).response&&\"string\"==typeof I.response.text?(D=I.response.text,F=/<Message>(.*)<\\/Message>/gi.exec(D),new H(F?\"Upload to bucket failed: \".concat(F[1]):\"Upload to bucket failed.\",I)):new H(\"Upload to bucket failed.\",I);case 19:if(204!==P.status)throw new H(\"Upload to bucket was unsuccessful\",P);G=u.fileUploadPublishRetryLimit,K=!1,L={timetoken:\"0\"},i.label=20;case 20:return i.trys.push([20,22,,23]),[4,r({channel:a,message:f,fileId:_,fileName:O,meta:d,storeInHistory:g,ttl:y})];case 21:return L=i.sent(),K=!0,[3,23];case 22:return i.sent(),G-=1,[3,23];case 23:if(!K&&G>0)return[3,20];i.label=24;case 24:if(K)return[2,{timetoken:L.timetoken,id:_,name:O}];throw new H(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:_,name:O})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new H(\"Validation failed, check status for details\",q(\"channel can't be empty\"));if(!r)throw new H(\"Validation failed, check status for details\",q(\"file id can't be empty\"));if(!o)throw new H(\"Validation failed, check status for details\",q(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(j.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=V(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},ve={getOperation:function(){return U.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography;return o(void 0,void 0,void 0,(function(){var e,o,u,c;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(null!==(o=n.cipherKey)&&void 0!==o?o:a.cipherKey)?[4,s.decrypt(null!==(u=n.cipherKey)&&void 0!==u?u:a.cipherKey,e)]:[3,2];case 1:e=i.sent(),i.label=2;case 2:return[2,r.create({data:e,name:null!==(c=t.response.name)&&void 0!==c?c:n.name,mimeType:t.response.type})]}}))}))}},_e={getOperation:function(){return U.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Oe={getOperation:function(){return U.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Se={getOperation:function(){return U.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(j.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Pe={getOperation:function(){return U.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(j.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return U.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(j.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return U.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Te={getOperation:function(){return U.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return U.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ae={getOperation:function(){return U.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return U.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ce={getOperation:function(){return U.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(j.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return U.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(j.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return U.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(j.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Re=Object.freeze({__proto__:null,getOperation:function(){return U.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ue=Object.freeze({__proto__:null,getOperation:function(){return U.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,m=void 0!==b&&b,v=t.update,_=void 0!==v&&v,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=m?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function Ie(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function De(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=Ie(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=Ie(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=Ie(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=Ie(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=Ie(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=Ie(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=Ie(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=Ie(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=Ie(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=Ie(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=Ie(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=Ie(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Fe=Object.freeze({__proto__:null,getOperation:function(){return U.PNAccessManagerGrantToken},extractPermissions:Ie,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return De(0,t)},handleResponse:function(e,t){return t.data.token}}),Ge={getOperation:function(){return U.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(j.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=e.crypto,r=e.config,o=JSON.stringify(t);return r.cipherKey&&(o=n.encrypt(o),o=JSON.stringify(o)),o}var Le=Object.freeze({__proto__:null,getOperation:function(){return U.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(j.encodeString(r),\"/0/\").concat(j.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(j.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var Be=Object.freeze({__proto__:null,getOperation:function(){return U.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(j.encodeString(o),\"/0/\").concat(j.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function He(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}var qe=Object.freeze({__proto__:null,getOperation:function(){return U.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(j.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:He(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return U.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(j.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return U.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(j.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return U.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(j.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return U.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Je=Object.freeze({__proto__:null,getOperation:function(){return U.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(j.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return U.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(j.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return U.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(j.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var m=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:m,toState:p,toContext:f,event:e});try{for(var v=a(h),_=v.next();!_.done;_=v.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var ot,it,at,st=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ut=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new st},n.prototype.abort=function(){this._aborted=!0,this.notify(new st)},n}(Ye),ct=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ut,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),lt=function(e){return function(t,n){return new ct(t,n,e)}},pt=rt(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ft=rt(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),ht=(it=function(e){return e},at=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:ot,payload:it.apply(void 0,u([],s(e),!1)),managed:!1}},at.type=ot=\"EMIT_EVENTS\",at),dt=rt(\"RECONNECT\",(function(e){return e})),yt=rt(\"HANDSHAKE_RECONNECT\",(function(e){return e})),gt=nt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),bt=nt(\"DISCONNECT\",(function(){return{}})),mt=nt(\"RECONNECT\",(function(){return{}}));nt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var vt=nt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),_t=nt(\"HANDSHAKING_FAILURE\",(function(e){return e})),Ot=nt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),St=nt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),Pt=nt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),wt=nt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),kt=nt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Tt=nt(\"RECEIVING_FAILURE\",(function(e){return e})),Et=nt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=nt(\"RECONNECTING_FAILURE\",(function(e){return e})),Nt=nt(\"RECONNECTING_GIVEUP\",(function(){return{}})),Ct=nt(\"RECONNECTING_RETRY\",(function(){return{}})),jt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(pt.type,lt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(vt(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof H?[2,t.transition(_t(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ft.type,lt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(kt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof H?[2,t.transition(Tt(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,lt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(dt.type,lt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Nt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Et(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof H?[2,t.transition(At(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(yt.type,lt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Pt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(Ot(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof H?[2,t.transition(St(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(tt),Mt=new Ze(\"STOPPED\");Mt.on(gt.type,(function(e,t){return Mt.with({channels:t.payload.channels,groups:t.payload.groups})})),Mt.on(mt.type,(function(e){return Gt.with(n({},e))}));var Rt=new Ze(\"HANDSHAKE_FAILURE\");Rt.on(wt.type,(function(e){return Ft.with(n(n({},e),{attempts:0}))})),Rt.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Ut=new Ze(\"STOPPED\");Ut.on(gt.type,(function(e,t){return Ut.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(mt.type,(function(e){return Dt.with(n({},e))}));var xt=new Ze(\"RECEIVE_FAILURE\");xt.on(Ct.type,(function(e){return It.with(n(n({},e),{attempts:0}))})),xt.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var It=new Ze(\"RECEIVE_RECONNECTING\");It.onEnter((function(e){return dt(e)})),It.onExit((function(){return dt.cancel})),It.on(Et.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[ht(t.payload.events)])})),It.on(At.type,(function(e,t){return It.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),It.on(Nt.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),It.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new Ze(\"RECEIVING\");Dt.onEnter((function(e){return ft(e.channels,e.groups,e.cursor)})),Dt.onExit((function(){return ft.cancel})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{cursor:t.payload.cursor}),[ht(t.payload.events)])})),Dt.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Dt.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Dt.on(Tt.type,(function(e,t){return It.with(n(n({},e),{attempts:0,reason:t.payload}))})),Dt.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new Ze(\"HANDSHAKE_RECONNECTING\");Ft.onEnter((function(e){return yt(e)})),Ft.onExit((function(){return dt.cancel})),Ft.on(Et.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[ht(t.payload.events)])})),Ft.on(At.type,(function(e,t){return Ft.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ft.on(Nt.type,(function(e){return Rt.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Ft.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Gt=new Ze(\"HANDSHAKING\");Gt.onEnter((function(e){return pt(e.channels,e.groups)})),Gt.onExit((function(){return pt.cancel})),Gt.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Gt.with({channels:t.payload.channels,groups:t.payload.groups})})),Gt.on(vt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Gt.on(_t.type,(function(e,t){return Ft.with(n(n({},e),{attempts:0,reason:t.payload}))})),Gt.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Kt=new Ze(\"UNSUBSCRIBED\");Kt.on(gt.type,(function(e,t){return Gt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Lt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new jt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(gt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(gt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(gt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(bt())},e}(),Bt=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new T({config:i}),c=e.cryptography;r.init(i);var l=new B(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile};this.File=e.PubNubFile,this.encryptFile=function(e,n){return c.encryptFile(e,n,t.File)},this.decryptFile=function(e,n){return c.decryptFile(e,n,t.File)};var h=J.bind(this,f,$e),d=J.bind(this,f,ie),y=J.bind(this,f,se),b=J.bind(this,f,ce),m=J.bind(this,f,Je),v=new L;if(this._listenerManager=v,this.iAmHere=J.bind(this,f,se),this.iAmAway=J.bind(this,f,ie),this.setPresenceState=J.bind(this,f,ce),this.handshake=J.bind(this,f,Qe),this.receiveMessages=J.bind(this,f,Xe),!0===i.enableSubscribeBeta){var _=new Lt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=_.subscribe.bind(_),this.unsubscribe=_.unsubscribe.bind(_),this.eventEngine=_}else{var O=new R({timeEndpoint:h,leaveEndpoint:d,heartbeatEndpoint:y,setStateEndpoint:b,subscribeEndpoint:m,crypto:f.crypto,config:f.config,listenerManager:v,getFileUrl:function(e){return me(f,e)}});this.subscribe=O.adaptSubscribeChange.bind(O),this.unsubscribe=O.adaptUnsubscribeChange.bind(O),this.disconnect=O.disconnect.bind(O),this.reconnect=O.reconnect.bind(O),this.unsubscribeAll=O.unsubscribeAll.bind(O),this.getSubscribedChannels=O.getSubscribedChannels.bind(O),this.getSubscribedChannelGroups=O.getSubscribedChannelGroups.bind(O),this.setState=O.adaptStateChange.bind(O),this.presence=O.adaptPresenceChange.bind(O),this.destroy=function(e){O.unsubscribeAll(e),O.disconnect()}}this.addListener=v.addListener.bind(v),this.removeListener=v.removeListener.bind(v),this.removeAllListeners=v.removeAllListeners.bind(v),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:J.bind(this,f,Z),listChannels:J.bind(this,f,ee),addChannels:J.bind(this,f,Q),removeChannels:J.bind(this,f,X),deleteGroup:J.bind(this,f,Y)},this.push={addChannels:J.bind(this,f,te),removeChannels:J.bind(this,f,ne),deleteDevice:J.bind(this,f,oe),listChannels:J.bind(this,f,re)},this.hereNow=J.bind(this,f,le),this.whereNow=J.bind(this,f,ae),this.getState=J.bind(this,f,ue),this.grant=J.bind(this,f,Ue),this.grantToken=J.bind(this,f,Fe),this.audit=J.bind(this,f,Re),this.revokeToken=J.bind(this,f,Ge),this.publish=J.bind(this,f,Le),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=J.bind(this,f,Be),this.history=J.bind(this,f,qe),this.deleteMessages=J.bind(this,f,ze),this.messageCounts=J.bind(this,f,Ve),this.fetchMessages=J.bind(this,f,We),this.addMessageAction=J.bind(this,f,pe),this.removeMessageAction=J.bind(this,f,fe),this.getMessageActions=J.bind(this,f,he),this.listFiles=J.bind(this,f,de);var S=J.bind(this,f,ye);this.publishFile=J.bind(this,f,ge),this.sendFile=be({generateUploadUrl:S,publishFile:this.publishFile,modules:f}),this.getFileUrl=function(e){return me(f,e)},this.downloadFile=J.bind(this,f,ve),this.deleteFile=J.bind(this,f,_e),this.objects={getAllUUIDMetadata:J.bind(this,f,Oe),getUUIDMetadata:J.bind(this,f,Se),setUUIDMetadata:J.bind(this,f,Pe),removeUUIDMetadata:J.bind(this,f,we),getAllChannelMetadata:J.bind(this,f,ke),getChannelMetadata:J.bind(this,f,Te),setChannelMetadata:J.bind(this,f,Ee),removeChannelMetadata:J.bind(this,f,Ae),getChannelMembers:J.bind(this,f,Ne),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return J.call.apply(J,u([t,f,Ce,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return J.call.apply(J,u([t,f,Ce,n({type:\"delete\"},e)],s(r),!1))},getMemberships:J.bind(this,f,je),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return J.call.apply(J,u([t,f,Me,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return J.call.apply(J,u([t,f,Me,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=h,this.stop=this.destroy,this.encrypt=a.encrypt.bind(a),this.decrypt=a.decrypt.bind(a),this.getAuthKey=f.config.getAuthKey.bind(f.config),this.setAuthKey=f.config.setAuthKey.bind(f.config),this.setCipherKey=f.config.setCipherKey.bind(f.config),this.getUUID=f.config.getUUID.bind(f.config),this.setUUID=f.config.setUUID.bind(f.config),this.getUserId=f.config.getUserId.bind(f.config),this.setUserId=f.config.setUserId.bind(f.config),this.getFilterExpression=f.config.getFilterExpression.bind(f.config),this.setFilterExpression=f.config.setFilterExpression.bind(f.config),this.setHeartbeatInterval=f.config.setHeartbeatInterval.bind(f.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){f.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=U,e.CATEGORIES=M,e}(),Ht=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return M.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return M.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return M.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return M.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return M.PNNetworkIssuesCategory;if(e.timeout)return M.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return M.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return M.PNBadRequestCategory;if(e.response.forbidden)return M.PNAccessDeniedCategory}return M.PNUnknownCategory},e}();function qt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?qt(a):a})),n}var zt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Vt={exports:{}},Wt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Wt);var $t=en;en.default=en,en.stable=on,en.stableStringify=on;var Jt=\"[...]\",Qt=\"[Circular]\",Xt=[],Yt=[];function Zt(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function en(e,t,n,r){var o;void 0===r&&(r=Zt()),nn(e,\"\",0,[],void 0,0,r);try{o=0===Yt.length?JSON.stringify(e,t,n):JSON.stringify(e,sn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Xt.length;){var i=Xt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function tn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Xt.push([r,n,t,o])):Yt.push([t,n,e]):(r[n]=e,Xt.push([r,n,t]))}function nn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void tn(Qt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void tn(Jt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void tn(Jt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)nn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];nn(e[c],c,s,r,e,i,a)}}r.pop()}}function rn(e,t){return e<t?-1:e>t?1:0}function on(e,t,n,r){void 0===r&&(r=Zt());var o,i=an(e,\"\",0,[],void 0,0,r)||e;try{o=0===Yt.length?JSON.stringify(i,t,n):JSON.stringify(i,sn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Xt.length;){var a=Xt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function an(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void tn(Qt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void tn(Jt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void tn(Jt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)an(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(rn);for(s=0;s<c.length;s++){var l=c[s];an(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Xt.push([o,t,e]),o[t]=u}r.pop()}}function sn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Yt.length>0)for(var r=0;r<Yt.length;r++){var o=Yt[r];if(o[1]===t&&o[0]===n){n=o[2],Yt.splice(r,1);break}}return e.call(this,t,n)}}var un,cn=\"undefined\"!=typeof Symbol&&Symbol,ln=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},pn=\"Function.prototype.bind called on incompatible \",fn=Array.prototype.slice,hn=Object.prototype.toString,dn=\"[object Function]\",yn=function(e){var t=this;if(\"function\"!=typeof t||hn.call(t)!==dn)throw new TypeError(pn+t);for(var n,r=fn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(fn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(fn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},gn=Function.prototype.bind||yn,bn=gn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,vn=Function,_n=TypeError,On=function(e){try{return vn('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Sn=Object.getOwnPropertyDescriptor;if(Sn)try{Sn({},\"\")}catch(e){Sn=null}var Pn=function(){throw new _n},wn=Sn?function(){try{return Pn}catch(e){try{return Sn(arguments,\"callee\").get}catch(e){return Pn}}}():Pn,kn=\"function\"==typeof cn&&\"function\"==typeof Symbol&&\"symbol\"==typeof cn(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&ln(),Tn=Object.getPrototypeOf||function(e){return e.__proto__},En={},An=\"undefined\"==typeof Uint8Array?un:Tn(Uint8Array),Nn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?un:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?un:ArrayBuffer,\"%ArrayIteratorPrototype%\":kn?Tn([][Symbol.iterator]()):un,\"%AsyncFromSyncIteratorPrototype%\":un,\"%AsyncFunction%\":En,\"%AsyncGenerator%\":En,\"%AsyncGeneratorFunction%\":En,\"%AsyncIteratorPrototype%\":En,\"%Atomics%\":\"undefined\"==typeof Atomics?un:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?un:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?un:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?un:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?un:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?un:FinalizationRegistry,\"%Function%\":vn,\"%GeneratorFunction%\":En,\"%Int8Array%\":\"undefined\"==typeof Int8Array?un:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?un:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?un:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":kn?Tn(Tn([][Symbol.iterator]())):un,\"%JSON%\":\"object\"==typeof JSON?JSON:un,\"%Map%\":\"undefined\"==typeof Map?un:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&kn?Tn((new Map)[Symbol.iterator]()):un,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?un:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?un:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?un:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?un:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&kn?Tn((new Set)[Symbol.iterator]()):un,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?un:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":kn?Tn(\"\"[Symbol.iterator]()):un,\"%Symbol%\":kn?Symbol:un,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":wn,\"%TypedArray%\":An,\"%TypeError%\":_n,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?un:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?un:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?un:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?un:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?un:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?un:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?un:WeakSet},Cn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=On(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=On(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=On(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=Tn(o.prototype))}return Nn[t]=n,n},jn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Mn=gn,Rn=bn,Un=Mn.call(Function.call,Array.prototype.concat),xn=Mn.call(Function.apply,Array.prototype.splice),In=Mn.call(Function.call,String.prototype.replace),Dn=Mn.call(Function.call,String.prototype.slice),Fn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Gn=/\\\\(\\\\)?/g,Kn=function(e){var t=Dn(e,0,1),n=Dn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return In(e,Fn,(function(e,t,n,o){r[r.length]=n?In(o,Gn,\"$1\"):t||e})),r},Ln=function(e,t){var n,r=e;if(Rn(jn,r)&&(r=\"%\"+(n=jn[r])[0]+\"%\"),Rn(Nn,r)){var o=Nn[r];if(o===En&&(o=Cn(r)),void 0===o&&!t)throw new _n(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Bn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new _n(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new _n('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Ln(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,Un([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Dn(p,0,1),h=Dn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Rn(Nn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Nn[i];else if(null!=a){if(!(p in a)){if(!t)throw new _n(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Sn&&c+1>=n.length){var d=Sn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Rn(a,p),a=a[p];l&&!s&&(Nn[i]=a)}}return a},Hn={exports:{}};!function(e){var t=gn,n=Bn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(Hn);var qn=Bn,zn=Hn.exports,Vn=zn(qn(\"String.prototype.indexOf\")),Wn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Jn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Qn=$n&&Jn&&\"function\"==typeof Jn.get?Jn.get:null,Xn=$n&&Map.prototype.forEach,Yn=\"function\"==typeof Set&&Set.prototype,Zn=Object.getOwnPropertyDescriptor&&Yn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,er=Yn&&Zn&&\"function\"==typeof Zn.get?Zn.get:null,tr=Yn&&Set.prototype.forEach,nr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,or=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ir=Boolean.prototype.valueOf,ar=Object.prototype.toString,sr=Function.prototype.toString,ur=String.prototype.match,cr=String.prototype.slice,lr=String.prototype.replace,pr=String.prototype.toUpperCase,fr=String.prototype.toLowerCase,hr=RegExp.prototype.test,dr=Array.prototype.concat,yr=Array.prototype.join,gr=Array.prototype.slice,br=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,vr=Object.getOwnPropertySymbols,_r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Or=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Sr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Or||\"symbol\")?Symbol.toStringTag:null,Pr=Object.prototype.propertyIsEnumerable,wr=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function kr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-br(-e):br(e);if(r!==e){var o=String(r),i=cr.call(t,o.length+1);return lr.call(o,n,\"$&_\")+\".\"+lr.call(lr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return lr.call(t,n,\"$&_\")}var Tr=Wn,Er=Tr.custom,Ar=Rr(Er)?Er:null;function Nr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function Cr(e){return lr.call(String(e),/\"/g,\"&quot;\")}function jr(e){return!(\"[object Array]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}function Mr(e){return!(\"[object RegExp]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}function Rr(e){if(Or)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!_r)return!1;try{return _r.call(e),!0}catch(e){}return!1}var Ur=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ur.call(e,t)}function Ir(e){return ar.call(e)}function Dr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Fr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Fr(cr.call(e,0,t.maxStringLength),t)+r}return Nr(lr.call(lr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Gr),\"single\",t)}function Gr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+pr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Lr(e){return e+\" { ? }\"}function Br(e,t,n,r){return e+\" (\"+t+\") {\"+(r?Hr(n,r):yr.call(n,\", \"))+\"}\"}function Hr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+yr.call(e,\",\"+n)+\"\\n\"+t.prev}function qr(e,t){var n=jr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof vr?vr(e):[];if(Or){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Or&&i[\"$\"+u]instanceof Symbol||(hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof vr)for(var c=0;c<a.length;c++)Pr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var zr=Bn,Vr=function(e,t){var n=qn(e,!!t);return\"function\"==typeof n&&Vn(e,\".prototype.\")>-1?zn(n):n},Wr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Fr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?kr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?kr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return jr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=yr.call(Array(e.indent+1),\" \")}return{base:n,prev:yr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Dr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=gr.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Mr(t)){var h=function(e){if(e.name)return e.name;var t=ur.call(sr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=qr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+yr.call(d,\", \")+\" }\":\"\")}if(Rr(t)){var y=Or?lr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):_r.call(t);return\"object\"!=typeof t||Or?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+fr.call(String(t.nodeName)),b=t.attributes||[],m=0;m<b.length;m++)g+=\" \"+b[m].name+\"=\"+Nr(Cr(b[m].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+fr.call(String(t.nodeName))+\">\"}if(jr(t)){if(0===t.length)return\"[]\";var v=qr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Dr(e[t],\"\\n\")>=0)return!1;return!0}(v)?\"[\"+Hr(v,p)+\"]\":\"[ \"+yr.call(v,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}(t)){var _=qr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Pr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+yr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+yr.call(dr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(Ar&&\"function\"==typeof t[Ar]&&Tr)return Tr(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Qn||!e||\"object\"!=typeof e)return!1;try{Qn.call(e);try{er.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Xn&&Xn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Br(\"Map\",Qn.call(t),O,p)}if(function(e){if(!er||!e||\"object\"!=typeof e)return!1;try{er.call(e);try{Qn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return tr&&tr.call(t,(function(e){S.push(f(e,t))})),Br(\"Set\",er.call(t),S,p)}if(function(e){if(!nr||!e||\"object\"!=typeof e)return!1;try{nr.call(e,nr);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Lr(\"WeakMap\");if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{nr.call(e,nr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Lr(\"WeakSet\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{return or.call(e),!0}catch(e){}return!1}(t))return Lr(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}(t))return Kr(ir.call(t));if(function(e){return!(\"[object String]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Ir(e)||Sr&&\"object\"==typeof e&&Sr in e)}(t)&&!Mr(t)){var P=qr(t,f),w=wr?wr(t)===Object.prototype:t instanceof Object||t.constructor===Object,k=t instanceof Object?\"\":\"null prototype\",T=!w&&Sr&&Object(t)===t&&Sr in t?cr.call(Ir(t),8,-1):k?\"Object\":\"\",E=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||k?\"[\"+yr.call(dr.call([],T||[],k||[]),\": \")+\"] \":\"\");return 0===P.length?E+\"{}\":p?E+\"{\"+Hr(P,p)+\"}\":E+\"{ \"+yr.call(P,\", \")+\" }\"}return String(t)},$r=zr(\"%TypeError%\"),Jr=zr(\"%WeakMap%\",!0),Qr=zr(\"%Map%\",!0),Xr=Vr(\"WeakMap.prototype.get\",!0),Yr=Vr(\"WeakMap.prototype.set\",!0),Zr=Vr(\"WeakMap.prototype.has\",!0),eo=Vr(\"Map.prototype.get\",!0),to=Vr(\"Map.prototype.set\",!0),no=Vr(\"Map.prototype.has\",!0),ro=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},oo=String.prototype.replace,io=/%20/g,ao=\"RFC3986\",so={default:ao,formatters:{RFC1738:function(e){return oo.call(e,io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:ao},uo=so,co=Object.prototype.hasOwnProperty,lo=Array.isArray,po=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),fo=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},ho={arrayToObject:fo,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(lo(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===uo.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=po[u]:u<2048?a+=po[192|u>>6]+po[128|63&u]:u<55296||u>=57344?a+=po[224|u>>12]+po[128|u>>6&63]+po[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=po[240|u>>18]+po[128|u>>12&63]+po[128|u>>6&63]+po[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(lo(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(lo(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!co.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return lo(t)&&!lo(n)&&(o=fo(t,r)),lo(t)&&lo(n)?(n.forEach((function(n,o){if(co.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return co.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},yo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Wr(e))},get:function(r){if(Jr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Xr(e,r)}else if(Qr){if(t)return eo(t,r)}else if(n)return function(e,t){var n=ro(e,t);return n&&n.value}(n,r)},has:function(r){if(Jr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Zr(e,r)}else if(Qr){if(t)return no(t,r)}else if(n)return function(e,t){return!!ro(e,t)}(n,r);return!1},set:function(r,o){Jr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Jr),Yr(e,r,o)):Qr?(t||(t=new Qr),to(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=ro(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},go=ho,bo=so,mo=Object.prototype.hasOwnProperty,vo={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},_o=Array.isArray,Oo=Array.prototype.push,So=function(e,t){Oo.apply(e,_o(t)?t:[t])},Po=Date.prototype.toISOString,wo=bo.default,ko={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:go.encode,encodeValuesOnly:!1,format:wo,formatter:bo.formatters[wo],indices:!1,serializeDate:function(e){return Po.call(e)},skipNulls:!1,strictNullHandling:!1},To={},Eo=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,m=t,v=g,_=0,O=!1;void 0!==(v=v.get(To))&&!O;){var S=v.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===v.get(To)&&(_=0)}if(\"function\"==typeof u?m=u(n,m):m instanceof Date?m=p(m):\"comma\"===r&&_o(m)&&(m=go.maybeMap(m,(function(e){return e instanceof Date?p(e):e}))),null===m){if(i)return s&&!d?s(n,ko.encoder,y,\"key\",f):n;m=\"\"}if(\"string\"==typeof(b=m)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||go.isBuffer(m))return s?[h(d?n:s(n,ko.encoder,y,\"key\",f))+\"=\"+h(s(m,ko.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(m))];var P,w=[];if(void 0===m)return w;if(\"comma\"===r&&_o(m))d&&s&&(m=go.maybeMap(m,s)),P=[{value:m.length>0?m.join(\",\")||null:void 0}];else if(_o(u))P=u;else{var k=Object.keys(m);P=c?k.sort(c):k}for(var T=o&&_o(m)&&1===m.length?n+\"[]\":n,E=0;E<P.length;++E){var A=P[E],N=\"object\"==typeof A&&void 0!==A.value?A.value:m[A];if(!a||null!==N){var C=_o(m)?\"function\"==typeof r?r(T,A):T:T+(l?\".\"+A:\"[\"+A+\"]\");g.set(t,_);var j=yo();j.set(To,g),So(w,e(N,C,r,o,i,a,\"comma\"===r&&d&&_o(m)?null:s,u,c,l,p,f,h,d,y,j))}}return w},Ao=ho,No=Object.prototype.hasOwnProperty,Co=Array.isArray,jo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:Ao.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Mo=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Ro=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Uo=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&No.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&No.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Ro(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return ko;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||ko.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=bo.default;if(void 0!==e.format){if(!mo.call(bo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=bo.formatters[n],o=ko.filter;return(\"function\"==typeof e.filter||_o(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:ko.addQueryPrefix,allowDots:void 0===e.allowDots?ko.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ko.charsetSentinel,delimiter:void 0===e.delimiter?ko.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:ko.encode,encoder:\"function\"==typeof e.encoder?e.encoder:ko.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ko.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:ko.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:ko.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ko.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):_o(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in vo?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=vo[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=yo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||So(a,Eo(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Io={formats:so,parse:function(e,t){var n=function(e){if(!e)return jo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?jo.charset:e.charset;return{allowDots:void 0===e.allowDots?jo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:jo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:jo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:jo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:jo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:jo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:jo.decoder,delimiter:\"string\"==typeof e.delimiter||Ao.isRegExp(e.delimiter)?e.delimiter:jo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:jo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:jo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:jo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:jo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:jo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,jo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),jo.decoder,u,\"key\"),l=Ao.maybeMap(Ro(p.slice(h+1),t),(function(e){return t.decoder(e,jo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Mo(l)),p.indexOf(\"[]=\")>-1&&(l=Co(l)?[l]:l),No.call(r,c)?r[c]=Ao.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Uo(s,r[s],n,\"string\"==typeof e);o=Ao.merge(o,u,n)}return!0===n.allowSparse?o:Ao.compact(o)},stringify:xo},Do={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Do);const Fo=Wn,Go=Do.isObject,Ko=Do.hasOwn;var Lo=Bo;function Bo(){}Bo.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Bo.prototype.parse=function(e){return this._parser=e,this},Bo.prototype.responseType=function(e){return this._responseType=e,this},Bo.prototype.serialize=function(e){return this._serializer=e,this},Bo.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Bo.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const Ho=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),qo=new Set([408,413,429,500,502,503,504,521,522,524]);Bo.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&qo.has(t.status))return!0;if(e){if(e.code&&Ho.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Bo.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Bo.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Bo.prototype.catch=function(e){return this.then(void 0,e)},Bo.prototype.use=function(e){return e(this),this},Bo.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Bo.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Bo.prototype.get=function(e){return this._header[e.toLowerCase()]},Bo.prototype.getHeader=Bo.prototype.get,Bo.prototype.set=function(e,t){if(Go(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Bo.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Bo.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Go(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Bo.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Fo.gte(process.version,\"v13.0.0\")&&Fo.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Bo.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Bo.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Bo.prototype.redirects=function(e){return this._maxRedirects=e,this},Bo.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Bo.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Bo.prototype.send=function(e){const t=Go(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Go(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Bo.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Bo.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Bo.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Bo.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Bo.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const zo=Do;var Vo=Wo;function Wo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qo(){this._defaults=[]}Wo.prototype.get=function(e){return this.header[e.toLowerCase()]},Wo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=zo.type(t);const n=zo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=zo.parseLinks(e.link))}catch(e){}},Wo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Xo=0,Yo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Xo<Yo.length;Xo++){const e=Yo[Xo];Qo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Qo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Zo=Qo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Wt.exports,a=$t,s=Io,u=Lo,c=Do.isObject,l=Do.mixin,p=Do.hasOwn,f=Vo,h=Zo;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&m(t,n,e[n]);return t.join(\"&\")}function m(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){m(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&m(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function v(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=v,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":v,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function k(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=k,y.delete=k,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Vt,Vt.exports);var ei=Vt.exports;function ti(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ni(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ti)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:M.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ei.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function oi(e,t,n){var r=ei.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ii(e,t,n){var r=ei.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ai(e,t,n,r){var o=ei.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ni.call(this,o,n,r)}function si(e,t,n,r){var o=ei.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ni.call(this,o,n,r)}function ui(e,t,n){var r=ei.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ci(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var li,pi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.toArrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.toArrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return t=Buffer.from(e),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=o.sent(),r=Buffer.from(Buffer.from(n).toString(\"hex\").slice(0,32),\"utf8\").buffer,[2,crypto.subtle.importKey(\"raw\",r,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=ci,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){return n=t.slice(0,16),[2,crypto.subtle.decrypt({name:\"AES-CBC\",iv:n},e,t.slice(16))]}))}))},e.prototype.encryptString=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o,a;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=Buffer.from(t).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,r)];case 1:return o=i.sent(),a=ci(n.buffer,o),[2,Buffer.from(a).toString(\"utf8\")]}}))}))},e.prototype.decryptString=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o,a;return i(this,(function(i){switch(i.label){case 0:return n=Buffer.from(t),r=n.slice(0,16),o=n.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},e,o)];case 1:return a=i.sent(),[2,Buffer.from(a).toString(\"utf8\")]}}))}))},e.IV_LENGTH=16,e}(),fi=(li=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),li.supportsFile=\"undefined\"!=typeof File,li.supportsBlob=\"undefined\"!=typeof Blob,li.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,li.supportsBuffer=!1,li.supportsStream=!1,li.supportsString=!0,li.supportsEncryptFile=!0,li.supportsFileUri=!1,li);function hi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var di=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new Ht({del:ui,get:ii,post:ai,patch:si,sendBeacon:hi,getfile:oi,postfile:ri}),t.cbor=new zt((function(e){return qt(f.decode(e))}),b),t.PubNubFile=fi,t.cryptography=new pi,n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n}(Bt);return di}));",
      "",
      "[Added Lines]",
      "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.0\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?v(n):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:(n=this.getFileData(e.data),[4,this.defaultCryptor.encryptFileData(n)]);case 1:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:(s=this.getFileData(r),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})]);case 2:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){if(t instanceof ArrayBuffer)return t;if(\"string\"==typeof t)return e.encoder.encode(t);throw new Error(\"Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer\")},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
      "",
      "---------------"
    ],
    "lib/core/components/base64_codec.js||lib/core/components/base64_codec.js": [
      "File: lib/core/components/base64_codec.js -> lib/core/components/base64_codec.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: \"use strict\";",
      "2: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "4: var BASE64_CHARMAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';",
      "",
      "[Removed Lines]",
      "3: exports.decode = void 0;",
      "",
      "[Added Lines]",
      "3: exports.encode = exports.decode = void 0;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "48:     return data;",
      "49: }",
      "50: exports.decode = decode;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "51: function encode(input) {",
      "52:     var base64 = '';",
      "53:     var encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';",
      "54:     var bytes = new Uint8Array(input);",
      "55:     var byteLength = bytes.byteLength;",
      "56:     var byteRemainder = byteLength % 3;",
      "57:     var mainLength = byteLength - byteRemainder;",
      "58:     var a, b, c, d;",
      "59:     var chunk;",
      "61:     for (var i = 0; i < mainLength; i = i + 3) {",
      "63:         chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];",
      "65:         a = (chunk & 16515072) >> 18; // 16515072 = (2^6 - 1) << 18",
      "66:         b = (chunk & 258048) >> 12; // 258048   = (2^6 - 1) << 12",
      "67:         c = (chunk & 4032) >> 6; // 4032     = (2^6 - 1) << 6",
      "68:         d = chunk & 63; // 63       = 2^6 - 1",
      "70:         base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];",
      "71:     }",
      "73:     if (byteRemainder == 1) {",
      "74:         chunk = bytes[mainLength];",
      "75:         a = (chunk & 252) >> 2; // 252 = (2^6 - 1) << 2",
      "77:         b = (chunk & 3) << 4; // 3   = 2^2 - 1",
      "78:         base64 += encodings[a] + encodings[b] + '==';",
      "79:     }",
      "80:     else if (byteRemainder == 2) {",
      "81:         chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];",
      "82:         a = (chunk & 64512) >> 10; // 64512 = (2^6 - 1) << 10",
      "83:         b = (chunk & 1008) >> 4; // 1008  = (2^6 - 1) << 4",
      "85:         c = (chunk & 15) << 2; // 15    = 2^4 - 1",
      "86:         base64 += encodings[a] + encodings[b] + encodings[c] + '=';",
      "87:     }",
      "88:     return base64;",
      "89: }",
      "90: exports.encode = encode;",
      "",
      "---------------"
    ],
    "lib/core/components/config.js||lib/core/components/config.js": [
      "File: lib/core/components/config.js -> lib/core/components/config.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "22:         this.sdkFamily = setup.sdkFamily;",
      "23:         this.partnerId = setup.partnerId;",
      "24:         this.setAuthKey(setup.authKey);",
      "26:         this.setFilterExpression(setup.filterExpression);",
      "27:         if (typeof setup.origin !== 'string' && !Array.isArray(setup.origin) && setup.origin !== undefined) {",
      "28:             throw new Error('Origin must be either undefined, a string or a list of strings.');",
      "",
      "[Removed Lines]",
      "25:         this.setCipherKey(setup.cipherKey);",
      "",
      "[Added Lines]",
      "25:         this.cryptoModule = setup.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "81:             }",
      "82:             this.setUUID(setup.uuid);",
      "83:         }",
      "84:     }",
      "86:     default_1.prototype.getAuthKey = function () {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "84:         this.setCipherKey(setup.cipherKey, setup);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "90:         this.authKey = val;",
      "91:         return this;",
      "92:     };",
      "94:         this.cipherKey = val;",
      "95:         return this;",
      "96:     };",
      "97:     default_1.prototype.getUUID = function () {",
      "",
      "[Removed Lines]",
      "93:     default_1.prototype.setCipherKey = function (val) {",
      "",
      "[Added Lines]",
      "94:     default_1.prototype.setCipherKey = function (val, setup, modules) {",
      "95:         var _a;",
      "97:         if (this.cipherKey) {",
      "98:             this.cryptoModule =",
      "99:                 (_a = setup.cryptoModule) !== null && _a !== void 0 ? _a : setup.initCryptoModule({ cipherKey: this.cipherKey, useRandomIVs: this.useRandomIVs });",
      "100:             if (modules)",
      "101:                 modules.cryptoModule = this.cryptoModule;",
      "102:         }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "169:         return this;",
      "170:     };",
      "171:     default_1.prototype.getVersion = function () {",
      "173:     };",
      "174:     default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
      "175:         this._PNSDKSuffix[name] = suffix;",
      "",
      "[Removed Lines]",
      "172:         return '7.3.3';",
      "",
      "[Added Lines]",
      "180:         return '7.4.0';",
      "",
      "---------------"
    ],
    "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js": [
      "File: lib/core/components/subscription_manager.js -> lib/core/components/subscription_manager.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "31: var categories_1 = __importDefault(require(\"../constants/categories\"));",
      "32: var default_1 = /** @class */ (function () {",
      "33:     function default_1(_a) {",
      "35:         this._listenerManager = listenerManager;",
      "36:         this._config = config;",
      "37:         this._leaveEndpoint = leaveEndpoint;",
      "",
      "[Removed Lines]",
      "34:         var subscribeEndpoint = _a.subscribeEndpoint, leaveEndpoint = _a.leaveEndpoint, heartbeatEndpoint = _a.heartbeatEndpoint, setStateEndpoint = _a.setStateEndpoint, timeEndpoint = _a.timeEndpoint, getFileUrl = _a.getFileUrl, config = _a.config, crypto = _a.crypto, listenerManager = _a.listenerManager;",
      "",
      "[Added Lines]",
      "34:         var subscribeEndpoint = _a.subscribeEndpoint, leaveEndpoint = _a.leaveEndpoint, heartbeatEndpoint = _a.heartbeatEndpoint, setStateEndpoint = _a.setStateEndpoint, timeEndpoint = _a.timeEndpoint, getFileUrl = _a.getFileUrl, config = _a.config, crypto = _a.crypto, listenerManager = _a.listenerManager, cryptoModule = _a.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "40:         this._subscribeEndpoint = subscribeEndpoint;",
      "41:         this._getFileUrl = getFileUrl;",
      "42:         this._crypto = crypto;",
      "43:         this._channels = {};",
      "44:         this._presenceChannels = {};",
      "45:         this._heartbeatChannels = {};",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "43:         this._cryptoModule = cryptoModule;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "55:         this._isOnline = true;",
      "56:         this._reconnectionManager = new reconnection_manager_1.default({ timeEndpoint: timeEndpoint });",
      "57:         this._dedupingManager = new deduping_manager_1.default({ config: config });",
      "58:     }",
      "59:     default_1.prototype.adaptStateChange = function (args, callback) {",
      "60:         var _this = this;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "59:         if (this._cryptoModule)",
      "60:             this._decoder = new TextDecoder();",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "522:                 announce.timetoken = publishMetaData.publishTimetoken;",
      "523:                 announce.publisher = message.issuingClientId;",
      "524:                 var msgPayload = message.payload;",
      "528:                         msgPayload = decryptedPayload;",
      "529:                     }",
      "530:                 }",
      "",
      "[Removed Lines]",
      "525:                 if (_this._config.cipherKey) {",
      "526:                     var decryptedPayload = _this._crypto.decrypt(message.payload);",
      "527:                     if (typeof decryptedPayload === 'object' && decryptedPayload !== null) {",
      "",
      "[Added Lines]",
      "528:                 if (_this._cryptoModule) {",
      "529:                     var decryptedPayload = void 0;",
      "530:                     try {",
      "531:                         var decryptedData = _this._cryptoModule.decrypt(message.payload);",
      "532:                         decryptedPayload =",
      "533:                             decryptedData instanceof ArrayBuffer ? JSON.parse(_this._decoder.decode(decryptedData)) : decryptedData;",
      "534:                     }",
      "535:                     catch (e) {",
      "536:                         decryptedPayload = null;",
      "537:                         if (console && console.log) {",
      "538:                             console.log('decryption error', e.message);",
      "539:                         }",
      "540:                     }",
      "541:                     if (decryptedPayload !== null) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "558:                 if (message.userMetadata) {",
      "559:                     announce.userMetadata = message.userMetadata;",
      "560:                 }",
      "563:                 }",
      "564:                 else {",
      "565:                     announce.message = message.payload;",
      "",
      "[Removed Lines]",
      "561:                 if (_this._config.cipherKey) {",
      "562:                     announce.message = _this._crypto.decrypt(message.payload);",
      "",
      "[Added Lines]",
      "575:                 if (_this._cryptoModule) {",
      "576:                     var decryptedPayload = void 0;",
      "577:                     try {",
      "578:                         var decryptedData = _this._cryptoModule.decrypt(message.payload);",
      "579:                         decryptedPayload =",
      "580:                             decryptedData instanceof ArrayBuffer ? JSON.parse(_this._decoder.decode(decryptedData)) : decryptedData;",
      "581:                     }",
      "582:                     catch (e) {",
      "583:                         decryptedPayload = null;",
      "585:                         if (console && console.log) {",
      "586:                             console.log('decryption error', e.message); //eslint-disable-line",
      "587:                         }",
      "588:                     }",
      "589:                     if (decryptedPayload != null) {",
      "590:                         announce.message = decryptedPayload;",
      "591:                     }",
      "592:                     else {",
      "593:                         announce.message = message.payload;",
      "594:                     }",
      "",
      "---------------"
    ],
    "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js": [
      "File: lib/core/endpoints/fetch_messages.js -> lib/core/endpoints/fetch_messages.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "8: var operations_1 = __importDefault(require(\"../constants/operations\"));",
      "9: var utils_1 = __importDefault(require(\"../utils\"));",
      "10: function __processMessage(modules, message) {",
      "13:         return message;",
      "14:     try {",
      "16:     }",
      "17:     catch (e) {",
      "18:         return message;",
      "19:     }",
      "20: }",
      "",
      "[Removed Lines]",
      "11:     var config = modules.config, crypto = modules.crypto;",
      "12:     if (!config.cipherKey)",
      "15:         return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "11:     if (!modules.cryptoModule)",
      "14:         var decryptedData = modules.cryptoModule.decrypt(message);",
      "15:         var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "16:         return decryptedPayload;",
      "19:         if (console && console.log)",
      "20:             console.log('decryption error', e.message);",
      "",
      "---------------"
    ],
    "lib/core/endpoints/file_upload/download_file.js||lib/core/endpoints/file_upload/download_file.js": [
      "File: lib/core/endpoints/file_upload/download_file.js -> lib/core/endpoints/file_upload/download_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "69:     forceBuffered: function () { return true; },",
      "70:     prepareParams: function () { return ({}); },",
      "71:     handleResponse: function (_a, res, params) {",
      "73:         return __awaiter(void 0, void 0, void 0, function () {",
      "76:             return __generator(this, function (_e) {",
      "77:                 switch (_e.label) {",
      "78:                     case 0:",
      "79:                         body = res.response.body;",
      "82:                     case 1:",
      "86:                             data: body,",
      "87:                             name: (_d = res.response.name) !== null && _d !== void 0 ? _d : params.name,",
      "88:                             mimeType: res.response.type,",
      "",
      "[Removed Lines]",
      "72:         var PubNubFile = _a.PubNubFile, config = _a.config, cryptography = _a.cryptography;",
      "74:             var body;",
      "75:             var _b, _c, _d;",
      "80:                         if (!(PubNubFile.supportsEncryptFile && ((_b = params.cipherKey) !== null && _b !== void 0 ? _b : config.cipherKey))) return [3 /*break*/, 2];",
      "81:                         return [4 /*yield*/, cryptography.decrypt((_c = params.cipherKey) !== null && _c !== void 0 ? _c : config.cipherKey, body)];",
      "83:                         body = _e.sent();",
      "84:                         _e.label = 2;",
      "85:                     case 2: return [2 /*return*/, PubNubFile.create({",
      "",
      "[Added Lines]",
      "73:         var PubNubFile = _a.PubNubFile, config = _a.config, cryptography = _a.cryptography, cryptoModule = _a.cryptoModule;",
      "75:             var body, _b;",
      "76:             var _c, _d;",
      "81:                         if (!(PubNubFile.supportsEncryptFile && (params.cipherKey || cryptoModule))) return [3 /*break*/, 5];",
      "82:                         if (!(params.cipherKey == null)) return [3 /*break*/, 2];",
      "83:                         return [4 /*yield*/, cryptoModule.decryptFile(PubNubFile.create({ data: body, name: params.name }), PubNubFile)];",
      "85:                         _b = (_e.sent()).data;",
      "86:                         return [3 /*break*/, 4];",
      "87:                     case 2: return [4 /*yield*/, cryptography.decrypt((_c = params.cipherKey) !== null && _c !== void 0 ? _c : config.cipherKey, body)];",
      "88:                     case 3:",
      "89:                         _b = _e.sent();",
      "90:                         _e.label = 4;",
      "91:                     case 4:",
      "92:                         body = _b;",
      "93:                         _e.label = 5;",
      "94:                     case 5: return [2 /*return*/, PubNubFile.create({",
      "",
      "---------------"
    ],
    "lib/core/endpoints/file_upload/publish_file.js||lib/core/endpoints/file_upload/publish_file.js": [
      "File: lib/core/endpoints/file_upload/publish_file.js -> lib/core/endpoints/file_upload/publish_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "6: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "7: var operations_1 = __importDefault(require(\"../../constants/operations\"));",
      "8: var utils_1 = __importDefault(require(\"../../utils\"));",
      "11:     var stringifiedPayload = JSON.stringify(payload);",
      "14:         stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "15:     }",
      "16:     return stringifiedPayload || '';",
      "",
      "[Removed Lines]",
      "9: var preparePayload = function (_a, payload) {",
      "10:     var crypto = _a.crypto, config = _a.config;",
      "12:     if (config.cipherKey) {",
      "13:         stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "",
      "[Added Lines]",
      "9: var base64_codec_1 = require(\"../../components/base64_codec\");",
      "10: var preparePayload = function (modules, payload) {",
      "12:     if (modules.cryptoModule) {",
      "13:         var encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "14:         stringifiedPayload = typeof encrypted === 'string' ? encrypted : (0, base64_codec_1.encode)(encrypted);",
      "",
      "---------------"
    ],
    "lib/core/endpoints/file_upload/send_file.js||lib/core/endpoints/file_upload/send_file.js": [
      "File: lib/core/endpoints/file_upload/send_file.js -> lib/core/endpoints/file_upload/send_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "39: var endpoint_1 = require(\"../../components/endpoint\");",
      "40: var sendFile = function (_a) {",
      "41:     var _this = this;",
      "43:     return function (_a) {",
      "44:         var channel = _a.channel, input = _a.file, message = _a.message, cipherKey = _a.cipherKey, meta = _a.meta, ttl = _a.ttl, storeInHistory = _a.storeInHistory;",
      "45:         return __awaiter(_this, void 0, void 0, function () {",
      "49:                     case 0:",
      "50:                         if (!channel) {",
      "51:                             throw new endpoint_1.PubNubError('Validation failed, check status for details', (0, endpoint_1.createValidationError)(\"channel can't be empty\"));",
      "",
      "[Removed Lines]",
      "42:     var generateUploadUrl = _a.generateUploadUrl, publishFile = _a.publishFile, _b = _a.modules, PubNubFile = _b.PubNubFile, config = _b.config, cryptography = _b.cryptography, networking = _b.networking;",
      "46:             var file, _b, _c, url, formFields, _d, id, name, formFieldsWithMimeType, result, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, e_1, errorBody, reason, retries, wasSuccessful, publishResult, e_2;",
      "47:             return __generator(this, function (_s) {",
      "48:                 switch (_s.label) {",
      "",
      "[Added Lines]",
      "42:     var generateUploadUrl = _a.generateUploadUrl, publishFile = _a.publishFile, _b = _a.modules, PubNubFile = _b.PubNubFile, config = _b.config, cryptography = _b.cryptography, cryptoModule = _b.cryptoModule, networking = _b.networking;",
      "46:             var file, _b, _c, url, formFields, _d, id, name, _e, formFieldsWithMimeType, result, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, e_1, errorBody, reason, retries, wasSuccessful, publishResult, e_2;",
      "47:             return __generator(this, function (_t) {",
      "48:                 switch (_t.label) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "56:                         file = PubNubFile.create(input);",
      "57:                         return [4 /*yield*/, generateUploadUrl({ channel: channel, name: file.name })];",
      "58:                     case 1:",
      "62:                     case 2:",
      "66:                         formFieldsWithMimeType = formFields;",
      "67:                         if (file.mimeType) {",
      "68:                             formFieldsWithMimeType = formFields.map(function (entry) {",
      "",
      "[Removed Lines]",
      "59:                         _b = _s.sent(), _c = _b.file_upload_request, url = _c.url, formFields = _c.form_fields, _d = _b.data, id = _d.id, name = _d.name;",
      "60:                         if (!(PubNubFile.supportsEncryptFile && (cipherKey !== null && cipherKey !== void 0 ? cipherKey : config.cipherKey))) return [3 /*break*/, 3];",
      "61:                         return [4 /*yield*/, cryptography.encryptFile(cipherKey !== null && cipherKey !== void 0 ? cipherKey : config.cipherKey, file, PubNubFile)];",
      "63:                         file = _s.sent();",
      "64:                         _s.label = 3;",
      "65:                     case 3:",
      "",
      "[Added Lines]",
      "59:                         _b = _t.sent(), _c = _b.file_upload_request, url = _c.url, formFields = _c.form_fields, _d = _b.data, id = _d.id, name = _d.name;",
      "60:                         if (!(PubNubFile.supportsEncryptFile && (cipherKey || cryptoModule))) return [3 /*break*/, 6];",
      "61:                         if (!(cipherKey == null)) return [3 /*break*/, 3];",
      "62:                         return [4 /*yield*/, cryptoModule.encryptFile(file, PubNubFile)];",
      "64:                         _e = _t.sent();",
      "65:                         return [3 /*break*/, 5];",
      "66:                     case 3: return [4 /*yield*/, cryptography.encryptFile(cipherKey, file, PubNubFile)];",
      "67:                     case 4:",
      "68:                         _e = _t.sent();",
      "69:                         _t.label = 5;",
      "70:                     case 5:",
      "71:                         file = _e;",
      "72:                         _t.label = 6;",
      "73:                     case 6:",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "71:                                 return entry;",
      "72:                             });",
      "73:                         }",
      "85:                     case 7:",
      "91:                     case 9:",
      "94:                     case 10:",
      "100:                     case 12:",
      "103:                     case 13:",
      "109:                     case 15:",
      "114:                     case 18:",
      "116:                         if (e_1.response && typeof e_1.response.text === 'string') {",
      "117:                             errorBody = e_1.response.text;",
      "118:                             reason = /<Message>(.*)<\\/Message>/gi.exec(errorBody);",
      "",
      "[Removed Lines]",
      "74:                         _s.label = 4;",
      "75:                     case 4:",
      "76:                         _s.trys.push([4, 18, , 19]);",
      "77:                         if (!(PubNubFile.supportsFileUri && input.uri)) return [3 /*break*/, 7];",
      "78:                         _f = (_e = networking).POSTFILE;",
      "79:                         _g = [url, formFieldsWithMimeType];",
      "80:                         return [4 /*yield*/, file.toFileUri()];",
      "81:                     case 5: return [4 /*yield*/, _f.apply(_e, _g.concat([_s.sent()]))];",
      "82:                     case 6:",
      "83:                         result = _s.sent();",
      "84:                         return [3 /*break*/, 17];",
      "86:                         if (!PubNubFile.supportsFile) return [3 /*break*/, 10];",
      "87:                         _j = (_h = networking).POSTFILE;",
      "88:                         _k = [url, formFieldsWithMimeType];",
      "89:                         return [4 /*yield*/, file.toFile()];",
      "90:                     case 8: return [4 /*yield*/, _j.apply(_h, _k.concat([_s.sent()]))];",
      "92:                         result = _s.sent();",
      "93:                         return [3 /*break*/, 17];",
      "95:                         if (!PubNubFile.supportsBuffer) return [3 /*break*/, 13];",
      "96:                         _m = (_l = networking).POSTFILE;",
      "97:                         _o = [url, formFieldsWithMimeType];",
      "98:                         return [4 /*yield*/, file.toBuffer()];",
      "99:                     case 11: return [4 /*yield*/, _m.apply(_l, _o.concat([_s.sent()]))];",
      "101:                         result = _s.sent();",
      "102:                         return [3 /*break*/, 17];",
      "104:                         if (!PubNubFile.supportsBlob) return [3 /*break*/, 16];",
      "105:                         _q = (_p = networking).POSTFILE;",
      "106:                         _r = [url, formFieldsWithMimeType];",
      "107:                         return [4 /*yield*/, file.toBlob()];",
      "108:                     case 14: return [4 /*yield*/, _q.apply(_p, _r.concat([_s.sent()]))];",
      "110:                         result = _s.sent();",
      "111:                         return [3 /*break*/, 17];",
      "112:                     case 16: throw new Error('Unsupported environment');",
      "113:                     case 17: return [3 /*break*/, 19];",
      "115:                         e_1 = _s.sent();",
      "",
      "[Added Lines]",
      "82:                         _t.label = 7;",
      "84:                         _t.trys.push([7, 21, , 22]);",
      "85:                         if (!(PubNubFile.supportsFileUri && input.uri)) return [3 /*break*/, 10];",
      "86:                         _g = (_f = networking).POSTFILE;",
      "87:                         _h = [url, formFieldsWithMimeType];",
      "88:                         return [4 /*yield*/, file.toFileUri()];",
      "89:                     case 8: return [4 /*yield*/, _g.apply(_f, _h.concat([_t.sent()]))];",
      "91:                         result = _t.sent();",
      "92:                         return [3 /*break*/, 20];",
      "94:                         if (!PubNubFile.supportsFile) return [3 /*break*/, 13];",
      "95:                         _k = (_j = networking).POSTFILE;",
      "96:                         _l = [url, formFieldsWithMimeType];",
      "97:                         return [4 /*yield*/, file.toFile()];",
      "98:                     case 11: return [4 /*yield*/, _k.apply(_j, _l.concat([_t.sent()]))];",
      "100:                         result = _t.sent();",
      "101:                         return [3 /*break*/, 20];",
      "103:                         if (!PubNubFile.supportsBuffer) return [3 /*break*/, 16];",
      "104:                         _o = (_m = networking).POSTFILE;",
      "105:                         _p = [url, formFieldsWithMimeType];",
      "106:                         return [4 /*yield*/, file.toBuffer()];",
      "107:                     case 14: return [4 /*yield*/, _o.apply(_m, _p.concat([_t.sent()]))];",
      "109:                         result = _t.sent();",
      "110:                         return [3 /*break*/, 20];",
      "111:                     case 16:",
      "112:                         if (!PubNubFile.supportsBlob) return [3 /*break*/, 19];",
      "113:                         _r = (_q = networking).POSTFILE;",
      "114:                         _s = [url, formFieldsWithMimeType];",
      "115:                         return [4 /*yield*/, file.toBlob()];",
      "116:                     case 17: return [4 /*yield*/, _r.apply(_q, _s.concat([_t.sent()]))];",
      "118:                         result = _t.sent();",
      "119:                         return [3 /*break*/, 20];",
      "120:                     case 19: throw new Error('Unsupported environment');",
      "121:                     case 20: return [3 /*break*/, 22];",
      "122:                     case 21:",
      "123:                         e_1 = _t.sent();",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "121:                         else {",
      "122:                             throw new endpoint_1.PubNubError('Upload to bucket failed.', e_1);",
      "123:                         }",
      "126:                         if (result.status !== 204) {",
      "127:                             throw new endpoint_1.PubNubError('Upload to bucket was unsuccessful', result);",
      "128:                         }",
      "129:                         retries = config.fileUploadPublishRetryLimit;",
      "130:                         wasSuccessful = false;",
      "131:                         publishResult = { timetoken: '0' };",
      "135:                         return [4 /*yield*/, publishFile({",
      "136:                                 channel: channel,",
      "137:                                 message: message,",
      "",
      "[Removed Lines]",
      "124:                         return [3 /*break*/, 19];",
      "125:                     case 19:",
      "132:                         _s.label = 20;",
      "133:                     case 20:",
      "134:                         _s.trys.push([20, 22, , 23]);",
      "",
      "[Added Lines]",
      "132:                         return [3 /*break*/, 22];",
      "133:                     case 22:",
      "140:                         _t.label = 23;",
      "141:                     case 23:",
      "142:                         _t.trys.push([23, 25, , 26]);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "141:                                 storeInHistory: storeInHistory,",
      "142:                                 ttl: ttl,",
      "143:                             })];",
      "147:                         wasSuccessful = true;",
      "151:                         retries -= 1;",
      "157:                         if (!wasSuccessful) {",
      "158:                             throw new endpoint_1.PubNubError('Publish failed. You may want to execute that operation manually using pubnub.publishFile', {",
      "159:                                 channel: channel,",
      "",
      "[Removed Lines]",
      "144:                     case 21:",
      "146:                         publishResult = _s.sent();",
      "148:                         return [3 /*break*/, 23];",
      "149:                     case 22:",
      "150:                         e_2 = _s.sent();",
      "152:                         return [3 /*break*/, 23];",
      "153:                     case 23:",
      "154:                         if (!wasSuccessful && retries > 0) return [3 /*break*/, 20];",
      "155:                         _s.label = 24;",
      "156:                     case 24:",
      "",
      "[Added Lines]",
      "152:                     case 24:",
      "154:                         publishResult = _t.sent();",
      "156:                         return [3 /*break*/, 26];",
      "157:                     case 25:",
      "158:                         e_2 = _t.sent();",
      "160:                         return [3 /*break*/, 26];",
      "161:                     case 26:",
      "162:                         if (!wasSuccessful && retries > 0) return [3 /*break*/, 23];",
      "163:                         _t.label = 27;",
      "164:                     case 27:",
      "",
      "---------------"
    ],
    "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js": [
      "File: lib/core/endpoints/history/get_history.js -> lib/core/endpoints/history/get_history.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "8: var operations_1 = __importDefault(require(\"../../constants/operations\"));",
      "9: var utils_1 = __importDefault(require(\"../../utils\"));",
      "10: function __processMessage(modules, message) {",
      "13:         return message;",
      "14:     try {",
      "16:     }",
      "17:     catch (e) {",
      "18:         return message;",
      "19:     }",
      "20: }",
      "",
      "[Removed Lines]",
      "11:     var config = modules.config, crypto = modules.crypto;",
      "12:     if (!config.cipherKey)",
      "15:         return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "11:     if (!modules.cryptoModule)",
      "14:         var decryptedData = modules.cryptoModule.decrypt(message);",
      "15:         var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "16:         return decryptedPayload;",
      "19:         if (console && console.log)",
      "20:             console.log('decryption error', e.message);",
      "",
      "---------------"
    ],
    "lib/core/endpoints/publish.js||lib/core/endpoints/publish.js": [
      "File: lib/core/endpoints/publish.js -> lib/core/endpoints/publish.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "7: exports.handleResponse = exports.prepareParams = exports.postPayload = exports.isAuthSupported = exports.getRequestTimeout = exports.postURL = exports.getURL = exports.usePost = exports.validateParams = exports.getOperation = void 0;",
      "8: var operations_1 = __importDefault(require(\"../constants/operations\"));",
      "9: var utils_1 = __importDefault(require(\"../utils\"));",
      "10: function prepareMessagePayload(modules, messagePayload) {",
      "12:     var stringifiedPayload = JSON.stringify(messagePayload);",
      "15:         stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "16:     }",
      "18: }",
      "19: function getOperation() {",
      "20:     return operations_1.default.PNPublishOperation;",
      "",
      "[Removed Lines]",
      "11:     var crypto = modules.crypto, config = modules.config;",
      "13:     if (config.cipherKey) {",
      "14:         stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "17:     return stringifiedPayload;",
      "",
      "[Added Lines]",
      "10: var base64_codec_1 = require(\"../components/base64_codec\");",
      "13:     if (modules.cryptoModule) {",
      "14:         var encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "15:         stringifiedPayload = typeof encrypted === 'string' ? encrypted : (0, base64_codec_1.encode)(encrypted);",
      "18:     return stringifiedPayload || '';",
      "",
      "---------------"
    ],
    "lib/core/pubnub-common.js||lib/core/pubnub-common.js": [
      "File: lib/core/pubnub-common.js -> lib/core/pubnub-common.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "60: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "61: var config_1 = __importDefault(require(\"./components/config\"));",
      "62: var index_1 = __importDefault(require(\"./components/cryptography/index\"));",
      "63: var subscription_manager_1 = __importDefault(require(\"./components/subscription_manager\"));",
      "64: var telemetry_manager_1 = __importDefault(require(\"./components/telemetry_manager\"));",
      "65: var push_payload_1 = __importDefault(require(\"./components/push_payload\"));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "63: var base64_codec_1 = require(\"./components/base64_codec\");",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "141:             maximumSamplesCount: 60000,",
      "142:         });",
      "143:         this._telemetryManager = telemetryManager;",
      "144:         var modules = {",
      "145:             config: config,",
      "146:             networking: networking,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "145:         var cryptoModule = this._config.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "149:             tokenManager: tokenManager,",
      "150:             telemetryManager: telemetryManager,",
      "151:             PubNubFile: setup.PubNubFile,",
      "152:         };",
      "153:         this.File = setup.PubNubFile;",
      "156:         var timeEndpoint = endpoint_1.default.bind(this, modules, timeEndpointConfig);",
      "157:         var leaveEndpoint = endpoint_1.default.bind(this, modules, presenceLeaveEndpointConfig);",
      "158:         var heartbeatEndpoint = endpoint_1.default.bind(this, modules, presenceHeartbeatEndpointConfig);",
      "",
      "[Removed Lines]",
      "154:         this.encryptFile = function (key, file) { return cryptography.encryptFile(key, file, _this.File); };",
      "155:         this.decryptFile = function (key, file) { return cryptography.decryptFile(key, file, _this.File); };",
      "",
      "[Added Lines]",
      "154:             cryptoModule: cryptoModule,",
      "157:         this.encryptFile = function (key, file) {",
      "158:             if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "159:                 file = key;",
      "160:                 return modules.cryptoModule.encryptFile(file, this.File);",
      "161:             }",
      "162:             return cryptography.encryptFile(key, file, this.File);",
      "163:         };",
      "164:         this.decryptFile = function (key, file) {",
      "165:             if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "166:                 file = key;",
      "167:                 return modules.cryptoModule.decryptFile(file, this.File);",
      "168:             }",
      "169:             return cryptography.decryptFile(key, file, this.File);",
      "170:         };",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "183:                 config: modules.config,",
      "184:                 listenerManager: listenerManager,",
      "185:                 getFileUrl: function (params) { return (0, get_file_url_1.default)(modules, params); },",
      "186:             });",
      "187:             this.subscribe = subscriptionManager_1.adaptSubscribeChange.bind(subscriptionManager_1);",
      "188:             this.unsubscribe = subscriptionManager_1.adaptUnsubscribeChange.bind(subscriptionManager_1);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "201:                 cryptoModule: modules.cryptoModule,",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "472:         this.stop = this.destroy; // --------",
      "478:         this.getAuthKey = modules.config.getAuthKey.bind(modules.config);",
      "479:         this.setAuthKey = modules.config.setAuthKey.bind(modules.config);",
      "481:         this.getUUID = modules.config.getUUID.bind(modules.config);",
      "482:         this.setUUID = modules.config.setUUID.bind(modules.config);",
      "483:         this.getUserId = modules.config.getUserId.bind(modules.config);",
      "484:         this.setUserId = modules.config.setUserId.bind(modules.config);",
      "485:         this.getFilterExpression = modules.config.getFilterExpression.bind(modules.config);",
      "486:         this.setFilterExpression = modules.config.setFilterExpression.bind(modules.config);",
      "487:         this.setHeartbeatInterval = modules.config.setHeartbeatInterval.bind(modules.config);",
      "488:         if (networking.hasModule('proxy')) {",
      "489:             this.setProxy = function (proxy) {",
      "",
      "[Removed Lines]",
      "475:         this.encrypt = crypto.encrypt.bind(crypto);",
      "476:         this.decrypt = crypto.decrypt.bind(crypto);",
      "480:         this.setCipherKey = modules.config.setCipherKey.bind(modules.config);",
      "",
      "[Added Lines]",
      "491:         this.encrypt = function (data, key) {",
      "492:             if (typeof key === 'undefined' && modules.cryptoModule) {",
      "493:                 var encrypted = modules.cryptoModule.encrypt(data);",
      "494:                 return typeof encrypted === 'string' ? encrypted : (0, base64_codec_1.encode)(encrypted);",
      "495:             }",
      "496:             else {",
      "497:                 return crypto.encrypt(data, key);",
      "498:             }",
      "499:         };",
      "500:         this.decrypt = function (data, key) {",
      "501:             if (typeof key === 'undefined' && cryptoModule) {",
      "502:                 var decrypted = modules.cryptoModule.decrypt(data);",
      "503:                 return decrypted instanceof ArrayBuffer ? (0, base64_codec_1.encode)(decrypted) : decrypted;",
      "504:             }",
      "505:             else {",
      "506:                 return crypto.decrypt(data, key);",
      "507:             }",
      "508:         };",
      "519:         this.setCipherKey = function (key) { return modules.config.setCipherKey(key, setup, modules); };",
      "",
      "---------------"
    ],
    "lib/core/utils.js||lib/core/utils.js": [
      "File: lib/core/utils.js -> lib/core/utils.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "26:     });",
      "27:     return { promise: promise, reject: failureResolve, fulfill: successResolve };",
      "28: }",
      "29: module.exports = {",
      "30:     signPamFromParams: signPamFromParams,",
      "31:     endsWith: endsWith,",
      "32:     createPromise: createPromise,",
      "33:     encodeString: encodeString,",
      "34: };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "29: function stringToArrayBuffer(str) {",
      "30:     var buf = new ArrayBuffer(str.length * 2);",
      "31:     var bufView = new Uint16Array(buf);",
      "32:     for (var i = 0, strLen = str.length; i < strLen; i++) {",
      "33:         bufView[i] = str.charCodeAt(i);",
      "34:     }",
      "35:     return buf;",
      "36: }",
      "42:     stringToArrayBuffer: stringToArrayBuffer,",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/ICryptor.js||lib/crypto/modules/NodeCryptoModule/ICryptor.js": [
      "File: lib/crypto/modules/NodeCryptoModule/ICryptor.js -> lib/crypto/modules/NodeCryptoModule/ICryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js||lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js": [
      "File: lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js -> lib/crypto/modules/NodeCryptoModule/ILegacyCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js||lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js": [
      "File: lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js -> lib/crypto/modules/NodeCryptoModule/NodeCryptoModule.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __read = (this && this.__read) || function (o, n) {",
      "39:     var m = typeof Symbol === \"function\" && o[Symbol.iterator];",
      "40:     if (!m) return o;",
      "41:     var i = m.call(o), r, ar = [], e;",
      "42:     try {",
      "43:         while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);",
      "44:     }",
      "45:     catch (error) { e = { error: error }; }",
      "46:     finally {",
      "47:         try {",
      "48:             if (r && !r.done && (m = i[\"return\"])) m.call(i);",
      "49:         }",
      "50:         finally { if (e) throw e.error; }",
      "51:     }",
      "52:     return ar;",
      "53: };",
      "54: var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {",
      "55:     if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {",
      "56:         if (ar || !(i in from)) {",
      "57:             if (!ar) ar = Array.prototype.slice.call(from, 0, i);",
      "58:             ar[i] = from[i];",
      "59:         }",
      "60:     }",
      "61:     return to.concat(ar || Array.prototype.slice.call(from));",
      "62: };",
      "63: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "64:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "65: };",
      "66: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "67: exports.CryptoModule = exports.AesCbcCryptor = exports.LegacyCryptor = void 0;",
      "68: var stream_1 = require(\"stream\");",
      "69: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "70: var legacyCryptor_1 = __importDefault(require(\"./legacyCryptor\"));",
      "71: exports.LegacyCryptor = legacyCryptor_1.default;",
      "72: var aesCbcCryptor_1 = __importDefault(require(\"./aesCbcCryptor\"));",
      "73: exports.AesCbcCryptor = aesCbcCryptor_1.default;",
      "74: var CryptoModule = /** @class */ (function () {",
      "75:     function CryptoModule(cryptoModuleConfiguration) {",
      "76:         var _a;",
      "77:         this.defaultCryptor = cryptoModuleConfiguration.default;",
      "78:         this.cryptors = (_a = cryptoModuleConfiguration.cryptors) !== null && _a !== void 0 ? _a : [];",
      "79:     }",
      "82:     CryptoModule.legacyCryptoModule = function (config) {",
      "83:         var _a;",
      "84:         return new this({",
      "85:             default: new legacyCryptor_1.default({",
      "86:                 cipherKey: config.cipherKey,",
      "87:                 useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "88:             }),",
      "89:             cryptors: [new aesCbcCryptor_1.default({ cipherKey: config.cipherKey })],",
      "90:         });",
      "91:     };",
      "92:     CryptoModule.aesCbcCryptoModule = function (config) {",
      "93:         var _a;",
      "94:         return new this({",
      "95:             default: new aesCbcCryptor_1.default({ cipherKey: config.cipherKey }),",
      "96:             cryptors: [",
      "97:                 new legacyCryptor_1.default({",
      "98:                     cipherKey: config.cipherKey,",
      "99:                     useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "100:                 }),",
      "101:             ],",
      "102:         });",
      "103:     };",
      "104:     CryptoModule.withDefaultCryptor = function (defaultCryptor) {",
      "105:         return new this({ default: defaultCryptor });",
      "106:     };",
      "107:     CryptoModule.prototype.getAllCryptors = function () {",
      "108:         return __spreadArray([this.defaultCryptor], __read(this.cryptors), false);",
      "109:     };",
      "110:     CryptoModule.prototype.getLegacyCryptor = function () {",
      "111:         return this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "112:     };",
      "113:     CryptoModule.prototype.encrypt = function (data) {",
      "114:         var encrypted = this.defaultCryptor.encrypt(data);",
      "115:         if (!encrypted.metadata)",
      "116:             return encrypted.data;",
      "117:         var header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "118:         var headerData = new Uint8Array(header.length);",
      "119:         var pos = 0;",
      "120:         headerData.set(header.data, pos);",
      "121:         pos = header.length - encrypted.metadata.length;",
      "122:         headerData.set(encrypted.metadata, pos);",
      "123:         return Buffer.concat([headerData, Buffer.from(encrypted.data)]);",
      "124:     };",
      "125:     CryptoModule.prototype.decrypt = function (data) {",
      "126:         var encryptedData = Buffer.from(typeof data === 'string' ? (0, base64_codec_1.decode)(data) : data);",
      "127:         var header = CryptorHeader.tryParse(encryptedData);",
      "128:         var cryptor = this.getCryptor(header);",
      "129:         var metadata = header.length > 0",
      "130:             ? encryptedData.slice(header.length - header.metadataLength, header.length)",
      "131:             : null;",
      "132:         if (encryptedData.slice(header.length).byteLength <= 0)",
      "133:             throw new Error('decryption error. empty content');",
      "134:         return cryptor.decrypt({",
      "135:             data: encryptedData.slice(header.length),",
      "136:             metadata: metadata,",
      "137:         });",
      "138:     };",
      "139:     CryptoModule.prototype.encryptFile = function (file, File) {",
      "140:         return __awaiter(this, void 0, void 0, function () {",
      "141:             var encryptedStream, header, payload, pos, output;",
      "142:             return __generator(this, function (_a) {",
      "143:                 switch (_a.label) {",
      "144:                     case 0:",
      "149:                         if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "150:                             return [2 /*return*/, this.defaultCryptor.encryptFile(file, File)];",
      "151:                         if (file.data instanceof Buffer) {",
      "152:                             return [2 /*return*/, File.create({",
      "153:                                     name: file.name,",
      "154:                                     mimeType: 'application/octet-stream',",
      "155:                                     data: Buffer.from(this.encrypt(file.data)),",
      "156:                                 })];",
      "157:                         }",
      "158:                         if (!(file.data instanceof stream_1.Readable)) return [3 /*break*/, 2];",
      "159:                         if (file.contentLength === 0)",
      "160:                             throw new Error('encryption error. empty content');",
      "161:                         return [4 /*yield*/, this.defaultCryptor.encryptStream(file.data)];",
      "162:                     case 1:",
      "163:                         encryptedStream = _a.sent();",
      "164:                         header = CryptorHeader.from(this.defaultCryptor.identifier, encryptedStream.metadata);",
      "165:                         payload = new Uint8Array(header.length);",
      "166:                         pos = 0;",
      "167:                         payload.set(header.data, pos);",
      "168:                         pos += header.length;",
      "169:                         if (encryptedStream.metadata) {",
      "170:                             pos -= encryptedStream.metadata.length;",
      "171:                             payload.set(encryptedStream.metadata, pos);",
      "172:                         }",
      "173:                         output = new stream_1.PassThrough();",
      "174:                         output.write(payload);",
      "175:                         encryptedStream.stream.pipe(output);",
      "176:                         return [2 /*return*/, File.create({",
      "177:                                 name: file.name,",
      "178:                                 mimeType: 'application/octet-stream',",
      "179:                                 stream: output,",
      "180:                             })];",
      "181:                     case 2: return [2 /*return*/];",
      "182:                 }",
      "183:             });",
      "184:         });",
      "185:     };",
      "186:     CryptoModule.prototype.decryptFile = function (file, File) {",
      "187:         return __awaiter(this, void 0, void 0, function () {",
      "188:             var header, cryptor, stream_2;",
      "189:             var _this = this;",
      "190:             return __generator(this, function (_a) {",
      "191:                 if ((file === null || file === void 0 ? void 0 : file.data) instanceof Buffer) {",
      "192:                     header = CryptorHeader.tryParse(file.data);",
      "193:                     cryptor = this.getCryptor(header);",
      "198:                     if ((cryptor === null || cryptor === void 0 ? void 0 : cryptor.identifier) === CryptoModule.LEGACY_IDENTIFIER)",
      "199:                         return [2 /*return*/, cryptor.decryptFile(file, File)];",
      "200:                     return [2 /*return*/, File.create({",
      "201:                             name: file.name,",
      "202:                             data: Buffer.from(this.decrypt(file === null || file === void 0 ? void 0 : file.data)),",
      "203:                         })];",
      "204:                 }",
      "205:                 if (file.data instanceof stream_1.Readable) {",
      "206:                     stream_2 = file.data;",
      "207:                     return [2 /*return*/, new Promise(function (resolve) {",
      "208:                             stream_2.on('readable', function () { return resolve(_this.onStreamReadable(stream_2, file, File)); });",
      "209:                         })];",
      "210:                 }",
      "211:                 return [2 /*return*/];",
      "212:             });",
      "213:         });",
      "214:     };",
      "215:     CryptoModule.prototype.onStreamReadable = function (stream, file, File) {",
      "216:         return __awaiter(this, void 0, void 0, function () {",
      "217:             var magicBytes, versionByte, identifier, cryptor, headerSize, _a, _b;",
      "218:             var _c;",
      "219:             return __generator(this, function (_d) {",
      "220:                 switch (_d.label) {",
      "221:                     case 0:",
      "222:                         stream.removeAllListeners('readable');",
      "223:                         magicBytes = stream.read(4);",
      "224:                         if (!CryptorHeader.isSentinel(magicBytes)) {",
      "225:                             if (magicBytes === null)",
      "226:                                 throw new Error('decryption error. empty content');",
      "227:                             stream.unshift(magicBytes);",
      "228:                             return [2 /*return*/, this.decryptLegacyFileStream(stream, file, File)];",
      "229:                         }",
      "230:                         versionByte = stream.read(1);",
      "231:                         CryptorHeader.validateVersion(versionByte[0]);",
      "232:                         identifier = stream.read(4);",
      "233:                         cryptor = this.getCryptorFromId(CryptorHeader.tryGetIdentifier(identifier));",
      "234:                         headerSize = CryptorHeader.tryGetMetadataSizeFromStream(stream);",
      "235:                         if (file.contentLength <= CryptorHeader.MIN_HEADER_LEGTH + headerSize)",
      "236:                             throw new Error('decryption error. empty content');",
      "237:                         _b = (_a = File).create;",
      "238:                         _c = {",
      "239:                             name: file.name,",
      "240:                             mimeType: 'application/octet-stream'",
      "241:                         };",
      "242:                         return [4 /*yield*/, cryptor.decryptStream({ stream: stream, metadataLength: headerSize })];",
      "243:                     case 1: return [2 /*return*/, _b.apply(_a, [(_c.stream = _d.sent(),",
      "244:                                 _c)])];",
      "245:                 }",
      "246:             });",
      "247:         });",
      "248:     };",
      "249:     CryptoModule.prototype.decryptLegacyFileStream = function (stream, file, File) {",
      "250:         return __awaiter(this, void 0, void 0, function () {",
      "251:             var cryptor;",
      "252:             return __generator(this, function (_a) {",
      "253:                 if (file.contentLength <= 16)",
      "254:                     throw new Error('decryption error: empty content');",
      "255:                 cryptor = this.getLegacyCryptor();",
      "256:                 if (cryptor) {",
      "257:                     return [2 /*return*/, cryptor.decryptFile(File.create({",
      "258:                             name: file.name,",
      "259:                             stream: stream,",
      "260:                         }), File)];",
      "261:                 }",
      "262:                 else {",
      "263:                     throw new Error('unknown cryptor error');",
      "264:                 }",
      "265:                 return [2 /*return*/];",
      "266:             });",
      "267:         });",
      "268:     };",
      "269:     CryptoModule.prototype.getCryptor = function (header) {",
      "270:         if (header === '') {",
      "271:             var cryptor = this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "272:             if (cryptor)",
      "273:                 return cryptor;",
      "274:             throw new Error('unknown cryptor error');",
      "275:         }",
      "276:         else if (header instanceof CryptorHeaderV1) {",
      "277:             return this.getCryptorFromId(header.identifier);",
      "278:         }",
      "279:     };",
      "280:     CryptoModule.prototype.getCryptorFromId = function (id) {",
      "281:         var cryptor = this.getAllCryptors().find(function (c) { return id === c.identifier; });",
      "282:         if (cryptor) {",
      "283:             return cryptor;",
      "284:         }",
      "285:         throw new Error('unknown cryptor error');",
      "286:     };",
      "287:     CryptoModule.LEGACY_IDENTIFIER = '';",
      "288:     return CryptoModule;",
      "289: }());",
      "290: exports.CryptoModule = CryptoModule;",
      "292: var CryptorHeader = /** @class */ (function () {",
      "293:     function CryptorHeader() {",
      "294:     }",
      "295:     CryptorHeader.from = function (id, metadata) {",
      "296:         if (id === CryptorHeader.LEGACY_IDENTIFIER)",
      "297:             return;",
      "298:         return new CryptorHeaderV1(id, metadata.length);",
      "299:     };",
      "300:     CryptorHeader.isSentinel = function (bytes) {",
      "301:         if (bytes && bytes.byteLength >= 4) {",
      "302:             if (bytes.toString('utf8') == CryptorHeader.SENTINEL)",
      "303:                 return true;",
      "304:         }",
      "305:     };",
      "306:     CryptorHeader.validateVersion = function (data) {",
      "307:         if (data && data > CryptorHeader.MAX_VERSION)",
      "308:             throw new Error('decryption error. invalid header version');",
      "309:         return data;",
      "310:     };",
      "311:     CryptorHeader.tryGetIdentifier = function (data) {",
      "312:         if (data.byteLength < 4) {",
      "313:             throw new Error('unknown cryptor error. decryption failed');",
      "314:         }",
      "315:         else {",
      "316:             return data.toString('utf8');",
      "317:         }",
      "318:     };",
      "319:     CryptorHeader.tryGetMetadataSizeFromStream = function (stream) {",
      "320:         var sizeBuf = stream.read(1);",
      "321:         if (sizeBuf && sizeBuf[0] < 255) {",
      "322:             return sizeBuf[0];",
      "323:         }",
      "324:         if (sizeBuf[0] === 255) {",
      "325:             var nextBuf = stream.read(2);",
      "326:             if (nextBuf.length >= 2) {",
      "327:                 return new Uint16Array([nextBuf[0], nextBuf[1]]).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "328:             }",
      "329:         }",
      "330:         throw new Error('decryption error. Invalid metadata size');",
      "331:     };",
      "332:     CryptorHeader.tryParse = function (encryptedData) {",
      "333:         var sentinel = '';",
      "334:         var version = null;",
      "335:         if (encryptedData.length >= 4) {",
      "336:             sentinel = encryptedData.slice(0, 4);",
      "337:             if (sentinel.toString('utf8') !== CryptorHeader.SENTINEL)",
      "338:                 return '';",
      "339:         }",
      "340:         if (encryptedData.length >= 5) {",
      "341:             version = encryptedData[4];",
      "342:         }",
      "343:         else {",
      "344:             throw new Error('decryption error. invalid header version');",
      "345:         }",
      "346:         if (version > CryptorHeader.MAX_VERSION)",
      "347:             throw new Error('unknown cryptor error');",
      "348:         var identifier;",
      "349:         var pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "350:         if (encryptedData.length >= pos) {",
      "351:             identifier = encryptedData.slice(5, pos);",
      "352:         }",
      "353:         else {",
      "354:             throw new Error('decryption error. invalid crypto identifier');",
      "355:         }",
      "356:         var metadataLength = null;",
      "357:         if (encryptedData.length >= pos + 1) {",
      "358:             metadataLength = encryptedData[pos];",
      "359:         }",
      "360:         else {",
      "361:             throw new Error('decryption error. invalid metadata length');",
      "362:         }",
      "363:         pos += 1;",
      "364:         if (metadataLength === 255 && encryptedData.length >= pos + 2) {",
      "365:             metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "366:             pos += 2;",
      "367:         }",
      "368:         return new CryptorHeaderV1(identifier.toString('utf8'), metadataLength);",
      "369:     };",
      "370:     CryptorHeader.SENTINEL = 'PNED';",
      "371:     CryptorHeader.LEGACY_IDENTIFIER = '';",
      "372:     CryptorHeader.IDENTIFIER_LENGTH = 4;",
      "373:     CryptorHeader.VERSION = 1;",
      "374:     CryptorHeader.MAX_VERSION = 1;",
      "375:     CryptorHeader.MIN_HEADER_LEGTH = 10;",
      "376:     return CryptorHeader;",
      "377: }());",
      "379: var CryptorHeaderV1 = /** @class */ (function () {",
      "380:     function CryptorHeaderV1(id, metadataLength) {",
      "381:         this._identifier = id;",
      "382:         this._metadataLength = metadataLength;",
      "383:     }",
      "384:     Object.defineProperty(CryptorHeaderV1.prototype, \"identifier\", {",
      "385:         get: function () {",
      "386:             return this._identifier;",
      "387:         },",
      "388:         set: function (value) {",
      "389:             this._identifier = value;",
      "390:         },",
      "391:         enumerable: false,",
      "392:         configurable: true",
      "393:     });",
      "394:     Object.defineProperty(CryptorHeaderV1.prototype, \"metadataLength\", {",
      "395:         get: function () {",
      "396:             return this._metadataLength;",
      "397:         },",
      "398:         set: function (value) {",
      "399:             this._metadataLength = value;",
      "400:         },",
      "401:         enumerable: false,",
      "402:         configurable: true",
      "403:     });",
      "404:     Object.defineProperty(CryptorHeaderV1.prototype, \"version\", {",
      "405:         get: function () {",
      "406:             return CryptorHeader.VERSION;",
      "407:         },",
      "408:         enumerable: false,",
      "409:         configurable: true",
      "410:     });",
      "411:     Object.defineProperty(CryptorHeaderV1.prototype, \"length\", {",
      "412:         get: function () {",
      "413:             return (CryptorHeader.SENTINEL.length +",
      "414:                 1 +",
      "415:                 CryptorHeader.IDENTIFIER_LENGTH +",
      "416:                 (this.metadataLength < 255 ? 1 : 3) +",
      "417:                 this.metadataLength);",
      "418:         },",
      "419:         enumerable: false,",
      "420:         configurable: true",
      "421:     });",
      "422:     Object.defineProperty(CryptorHeaderV1.prototype, \"data\", {",
      "423:         get: function () {",
      "424:             var pos = 0;",
      "425:             var header = new Uint8Array(this.length);",
      "426:             header.set(Buffer.from(CryptorHeader.SENTINEL));",
      "427:             pos += CryptorHeader.SENTINEL.length;",
      "428:             header[pos] = this.version;",
      "429:             pos++;",
      "430:             if (this.identifier)",
      "431:                 header.set(Buffer.from(this.identifier), pos);",
      "432:             pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "433:             var metadataLength = this.metadataLength;",
      "434:             if (metadataLength < 255) {",
      "435:                 header[pos] = metadataLength;",
      "436:             }",
      "437:             else {",
      "438:                 header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "439:             }",
      "440:             return header;",
      "441:         },",
      "442:         enumerable: false,",
      "443:         configurable: true",
      "444:     });",
      "445:     return CryptorHeaderV1;",
      "446: }());",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js||lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js": [
      "File: lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js -> lib/crypto/modules/NodeCryptoModule/aesCbcCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "39: var stream_1 = require(\"stream\");",
      "40: var crypto_1 = require(\"crypto\");",
      "41: var AesCbcCryptor = /** @class */ (function () {",
      "42:     function AesCbcCryptor(configuration) {",
      "43:         this.cipherKey = configuration.cipherKey;",
      "44:     }",
      "45:     Object.defineProperty(AesCbcCryptor.prototype, \"algo\", {",
      "46:         get: function () {",
      "47:             return 'aes-256-cbc';",
      "48:         },",
      "49:         enumerable: false,",
      "50:         configurable: true",
      "51:     });",
      "52:     Object.defineProperty(AesCbcCryptor.prototype, \"identifier\", {",
      "53:         get: function () {",
      "54:             return 'ACRH';",
      "55:         },",
      "56:         enumerable: false,",
      "57:         configurable: true",
      "58:     });",
      "59:     AesCbcCryptor.prototype.getIv = function () {",
      "60:         return (0, crypto_1.randomBytes)(AesCbcCryptor.BLOCK_SIZE);",
      "61:     };",
      "62:     AesCbcCryptor.prototype.getKey = function () {",
      "63:         var sha = (0, crypto_1.createHash)('sha256');",
      "64:         sha.update(Buffer.from(this.cipherKey, 'utf8'));",
      "65:         return Buffer.from(sha.digest());",
      "66:     };",
      "67:     AesCbcCryptor.prototype.encrypt = function (data) {",
      "68:         var iv = this.getIv();",
      "69:         var key = this.getKey();",
      "70:         var plainData = typeof data === 'string' ? new TextEncoder().encode(data) : data;",
      "71:         var bPlain = Buffer.from(plainData);",
      "72:         if (bPlain.byteLength === 0)",
      "73:             throw new Error('encryption error. empty content');",
      "74:         var aes = (0, crypto_1.createCipheriv)(this.algo, key, iv);",
      "75:         return {",
      "76:             metadata: iv,",
      "77:             data: Buffer.concat([aes.update(bPlain), aes.final()]),",
      "78:         };",
      "79:     };",
      "80:     AesCbcCryptor.prototype.decrypt = function (encryptedData) {",
      "81:         var data = typeof encryptedData.data === 'string' ? new TextEncoder().encode(encryptedData.data) : encryptedData.data;",
      "82:         if (data.byteLength <= 0)",
      "83:             throw new Error('decryption error: empty content');",
      "84:         var aes = (0, crypto_1.createDecipheriv)(this.algo, this.getKey(), encryptedData.metadata);",
      "85:         return Uint8Array.from(Buffer.concat([aes.update(data), aes.final()])).buffer;",
      "86:     };",
      "87:     AesCbcCryptor.prototype.encryptStream = function (stream) {",
      "88:         return __awaiter(this, void 0, void 0, function () {",
      "89:             var output, bIv, aes;",
      "90:             return __generator(this, function (_a) {",
      "91:                 output = new stream_1.PassThrough();",
      "92:                 bIv = this.getIv();",
      "93:                 if (stream.readable === false)",
      "94:                     throw new Error('encryption error. empty stream');",
      "95:                 aes = (0, crypto_1.createCipheriv)(this.algo, this.getKey(), bIv);",
      "96:                 stream.pipe(aes).pipe(output);",
      "97:                 return [2 /*return*/, {",
      "98:                         stream: output,",
      "99:                         metadata: bIv,",
      "100:                         metadataLength: AesCbcCryptor.BLOCK_SIZE,",
      "101:                     }];",
      "102:             });",
      "103:         });",
      "104:     };",
      "105:     AesCbcCryptor.prototype.decryptStream = function (encryptedStream) {",
      "106:         return __awaiter(this, void 0, void 0, function () {",
      "107:             var decryptedStream, bIv, aes, onReadable;",
      "108:             var _this = this;",
      "109:             return __generator(this, function (_a) {",
      "110:                 decryptedStream = new stream_1.PassThrough();",
      "111:                 bIv = Buffer.alloc(0);",
      "112:                 aes = null;",
      "113:                 onReadable = function () {",
      "114:                     var data = encryptedStream.stream.read();",
      "115:                     while (data !== null) {",
      "116:                         if (data) {",
      "117:                             var bChunk = Buffer.from(data);",
      "118:                             var sliceLen = encryptedStream.metadataLength - bIv.byteLength;",
      "119:                             if (bChunk.byteLength < sliceLen) {",
      "120:                                 bIv = Buffer.concat([bIv, bChunk]);",
      "121:                             }",
      "122:                             else {",
      "123:                                 bIv = Buffer.concat([bIv, bChunk.slice(0, sliceLen)]);",
      "124:                                 aes = (0, crypto_1.createDecipheriv)(_this.algo, _this.getKey(), bIv);",
      "125:                                 aes.pipe(decryptedStream);",
      "126:                                 aes.write(bChunk.slice(sliceLen));",
      "127:                             }",
      "128:                         }",
      "129:                         data = encryptedStream.stream.read();",
      "130:                     }",
      "131:                 };",
      "132:                 encryptedStream.stream.on('readable', onReadable);",
      "133:                 encryptedStream.stream.on('end', function () {",
      "134:                     if (aes) {",
      "135:                         aes.end();",
      "136:                     }",
      "137:                     decryptedStream.end();",
      "138:                 });",
      "139:                 return [2 /*return*/, decryptedStream];",
      "140:             });",
      "141:         });",
      "142:     };",
      "143:     AesCbcCryptor.BLOCK_SIZE = 16;",
      "144:     return AesCbcCryptor;",
      "145: }());",
      "146: exports.default = AesCbcCryptor;",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/legacyCryptor.js||lib/crypto/modules/NodeCryptoModule/legacyCryptor.js": [
      "File: lib/crypto/modules/NodeCryptoModule/legacyCryptor.js -> lib/crypto/modules/NodeCryptoModule/legacyCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "39:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "40: };",
      "41: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "42: var index_1 = __importDefault(require(\"../../../core/components/cryptography/index\"));",
      "43: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "44: var node_1 = __importDefault(require(\"../node\"));",
      "45: var LegacyCryptor = /** @class */ (function () {",
      "46:     function LegacyCryptor(config) {",
      "47:         this.config = config;",
      "48:         this.cryptor = new index_1.default({ config: config });",
      "49:         this.fileCryptor = new node_1.default();",
      "50:     }",
      "51:     Object.defineProperty(LegacyCryptor.prototype, \"identifier\", {",
      "52:         get: function () {",
      "53:             return '';",
      "54:         },",
      "55:         enumerable: false,",
      "56:         configurable: true",
      "57:     });",
      "58:     LegacyCryptor.prototype.encrypt = function (data) {",
      "59:         if (data.length === 0)",
      "60:             throw new Error('encryption error. empty content');",
      "61:         return {",
      "62:             data: this.cryptor.encrypt(data),",
      "63:             metadata: null,",
      "64:         };",
      "65:     };",
      "66:     LegacyCryptor.prototype.decrypt = function (encryptedData) {",
      "67:         var data = typeof encryptedData.data === 'string' ? encryptedData.data : (0, base64_codec_1.encode)(encryptedData.data);",
      "68:         return this.cryptor.decrypt(data);",
      "69:     };",
      "70:     LegacyCryptor.prototype.encryptFile = function (file, File) {",
      "71:         return __awaiter(this, void 0, void 0, function () {",
      "72:             return __generator(this, function (_a) {",
      "73:                 return [2 /*return*/, this.fileCryptor.encryptFile(this.config.cipherKey, file, File)];",
      "74:             });",
      "75:         });",
      "76:     };",
      "77:     LegacyCryptor.prototype.decryptFile = function (file, File) {",
      "78:         return __awaiter(this, void 0, void 0, function () {",
      "79:             return __generator(this, function (_a) {",
      "80:                 return [2 /*return*/, this.fileCryptor.decryptFile(this.config.cipherKey, file, File)];",
      "81:             });",
      "82:         });",
      "83:     };",
      "84:     return LegacyCryptor;",
      "85: }());",
      "86: exports.default = LegacyCryptor;",
      "",
      "---------------"
    ],
    "lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js||lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js": [
      "File: lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js -> lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __read = (this && this.__read) || function (o, n) {",
      "39:     var m = typeof Symbol === \"function\" && o[Symbol.iterator];",
      "40:     if (!m) return o;",
      "41:     var i = m.call(o), r, ar = [], e;",
      "42:     try {",
      "43:         while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);",
      "44:     }",
      "45:     catch (error) { e = { error: error }; }",
      "46:     finally {",
      "47:         try {",
      "48:             if (r && !r.done && (m = i[\"return\"])) m.call(i);",
      "49:         }",
      "50:         finally { if (e) throw e.error; }",
      "51:     }",
      "52:     return ar;",
      "53: };",
      "54: var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {",
      "55:     if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {",
      "56:         if (ar || !(i in from)) {",
      "57:             if (!ar) ar = Array.prototype.slice.call(from, 0, i);",
      "58:             ar[i] = from[i];",
      "59:         }",
      "60:     }",
      "61:     return to.concat(ar || Array.prototype.slice.call(from));",
      "62: };",
      "63: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "64:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "65: };",
      "66: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "67: exports.CryptoModule = exports.AesCbcCryptor = exports.LegacyCryptor = void 0;",
      "68: var stream_1 = require(\"stream\");",
      "69: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "70: var legacyCryptor_1 = __importDefault(require(\"./legacyCryptor\"));",
      "71: exports.LegacyCryptor = legacyCryptor_1.default;",
      "72: var aesCbcCryptor_1 = __importDefault(require(\"./aesCbcCryptor\"));",
      "73: exports.AesCbcCryptor = aesCbcCryptor_1.default;",
      "74: var CryptoModule = /** @class */ (function () {",
      "75:     function CryptoModule(cryptoModuleConfiguration) {",
      "76:         var _a;",
      "77:         this.defaultCryptor = cryptoModuleConfiguration.default;",
      "78:         this.cryptors = (_a = cryptoModuleConfiguration.cryptors) !== null && _a !== void 0 ? _a : [];",
      "79:     }",
      "82:     CryptoModule.legacyCryptoModule = function (config) {",
      "83:         var _a;",
      "84:         return new this({",
      "85:             default: new legacyCryptor_1.default({",
      "86:                 cipherKey: config.cipherKey,",
      "87:                 useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "88:             }),",
      "89:             cryptors: [new aesCbcCryptor_1.default({ cipherKey: config.cipherKey })],",
      "90:         });",
      "91:     };",
      "92:     CryptoModule.aesCbcCryptoModule = function (config) {",
      "93:         var _a;",
      "94:         return new this({",
      "95:             default: new aesCbcCryptor_1.default({ cipherKey: config.cipherKey }),",
      "96:             cryptors: [",
      "97:                 new legacyCryptor_1.default({",
      "98:                     cipherKey: config.cipherKey,",
      "99:                     useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "100:                 }),",
      "101:             ],",
      "102:         });",
      "103:     };",
      "104:     CryptoModule.withDefaultCryptor = function (defaultCryptor) {",
      "105:         return new this({ default: defaultCryptor });",
      "106:     };",
      "107:     CryptoModule.prototype.getAllCryptors = function () {",
      "108:         return __spreadArray([this.defaultCryptor], __read(this.cryptors), false);",
      "109:     };",
      "110:     CryptoModule.prototype.getLegacyCryptor = function () {",
      "111:         return this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "112:     };",
      "113:     CryptoModule.prototype.encrypt = function (data) {",
      "114:         var encrypted = this.defaultCryptor.encrypt(data);",
      "115:         if (!encrypted.metadata)",
      "116:             return encrypted.data;",
      "117:         var header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "118:         var headerData = new Uint8Array(header.length);",
      "119:         var pos = 0;",
      "120:         headerData.set(header.data, pos);",
      "121:         pos = header.length - encrypted.metadata.length;",
      "122:         headerData.set(encrypted.metadata, pos);",
      "123:         return Buffer.concat([headerData, Buffer.from(encrypted.data)]);",
      "124:     };",
      "125:     CryptoModule.prototype.decrypt = function (data) {",
      "126:         var encryptedData = Buffer.from(typeof data === 'string' ? (0, base64_codec_1.decode)(data) : data);",
      "127:         var header = CryptorHeader.tryParse(encryptedData);",
      "128:         var cryptor = this.getCryptor(header);",
      "129:         var metadata = header.length > 0",
      "130:             ? encryptedData.slice(header.length - header.metadataLength, header.length)",
      "131:             : null;",
      "132:         if (encryptedData.slice(header.length).byteLength <= 0)",
      "133:             throw new Error('decryption error. empty content');",
      "134:         return cryptor.decrypt({",
      "135:             data: encryptedData.slice(header.length),",
      "136:             metadata: metadata,",
      "137:         });",
      "138:     };",
      "139:     CryptoModule.prototype.encryptFile = function (file, File) {",
      "140:         return __awaiter(this, void 0, void 0, function () {",
      "141:             var encryptedStream, header, payload, pos, output;",
      "142:             return __generator(this, function (_a) {",
      "143:                 switch (_a.label) {",
      "144:                     case 0:",
      "149:                         if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "150:                             return [2 /*return*/, this.defaultCryptor.encryptFile(file, File)];",
      "151:                         if (file.data instanceof Buffer) {",
      "152:                             return [2 /*return*/, File.create({",
      "153:                                     name: file.name,",
      "154:                                     mimeType: 'application/octet-stream',",
      "155:                                     data: Buffer.from(this.encrypt(file.data)),",
      "156:                                 })];",
      "157:                         }",
      "158:                         if (!(file.data instanceof stream_1.Readable)) return [3 /*break*/, 2];",
      "159:                         if (file.contentLength === 0)",
      "160:                             throw new Error('encryption error. empty content');",
      "161:                         return [4 /*yield*/, this.defaultCryptor.encryptStream(file.data)];",
      "162:                     case 1:",
      "163:                         encryptedStream = _a.sent();",
      "164:                         header = CryptorHeader.from(this.defaultCryptor.identifier, encryptedStream.metadata);",
      "165:                         payload = new Uint8Array(header.length);",
      "166:                         pos = 0;",
      "167:                         payload.set(header.data, pos);",
      "168:                         pos += header.length;",
      "169:                         if (encryptedStream.metadata) {",
      "170:                             pos -= encryptedStream.metadata.length;",
      "171:                             payload.set(encryptedStream.metadata, pos);",
      "172:                         }",
      "173:                         output = new stream_1.PassThrough();",
      "174:                         output.write(payload);",
      "175:                         encryptedStream.stream.pipe(output);",
      "176:                         return [2 /*return*/, File.create({",
      "177:                                 name: file.name,",
      "178:                                 mimeType: 'application/octet-stream',",
      "179:                                 stream: output,",
      "180:                             })];",
      "181:                     case 2: return [2 /*return*/];",
      "182:                 }",
      "183:             });",
      "184:         });",
      "185:     };",
      "186:     CryptoModule.prototype.decryptFile = function (file, File) {",
      "187:         return __awaiter(this, void 0, void 0, function () {",
      "188:             var header, cryptor, stream_2;",
      "189:             var _this = this;",
      "190:             return __generator(this, function (_a) {",
      "191:                 if ((file === null || file === void 0 ? void 0 : file.data) instanceof Buffer) {",
      "192:                     header = CryptorHeader.tryParse(file.data);",
      "193:                     cryptor = this.getCryptor(header);",
      "198:                     if ((cryptor === null || cryptor === void 0 ? void 0 : cryptor.identifier) === CryptoModule.LEGACY_IDENTIFIER)",
      "199:                         return [2 /*return*/, cryptor.decryptFile(file, File)];",
      "200:                     return [2 /*return*/, File.create({",
      "201:                             name: file.name,",
      "202:                             data: Buffer.from(this.decrypt(file === null || file === void 0 ? void 0 : file.data)),",
      "203:                         })];",
      "204:                 }",
      "205:                 if (file.data instanceof stream_1.Readable) {",
      "206:                     stream_2 = file.data;",
      "207:                     return [2 /*return*/, new Promise(function (resolve) {",
      "208:                             stream_2.on('readable', function () { return resolve(_this.onStreamReadable(stream_2, file, File)); });",
      "209:                         })];",
      "210:                 }",
      "211:                 return [2 /*return*/];",
      "212:             });",
      "213:         });",
      "214:     };",
      "215:     CryptoModule.prototype.onStreamReadable = function (stream, file, File) {",
      "216:         return __awaiter(this, void 0, void 0, function () {",
      "217:             var magicBytes, versionByte, identifier, cryptor, headerSize, _a, _b;",
      "218:             var _c;",
      "219:             return __generator(this, function (_d) {",
      "220:                 switch (_d.label) {",
      "221:                     case 0:",
      "222:                         stream.removeAllListeners('readable');",
      "223:                         magicBytes = stream.read(4);",
      "224:                         if (!CryptorHeader.isSentinel(magicBytes)) {",
      "225:                             if (magicBytes === null)",
      "226:                                 throw new Error('decryption error. empty content');",
      "227:                             stream.unshift(magicBytes);",
      "228:                             return [2 /*return*/, this.decryptLegacyFileStream(stream, file, File)];",
      "229:                         }",
      "230:                         versionByte = stream.read(1);",
      "231:                         CryptorHeader.validateVersion(versionByte[0]);",
      "232:                         identifier = stream.read(4);",
      "233:                         cryptor = this.getCryptorFromId(CryptorHeader.tryGetIdentifier(identifier));",
      "234:                         headerSize = CryptorHeader.tryGetMetadataSizeFromStream(stream);",
      "235:                         if (file.contentLength <= CryptorHeader.MIN_HEADER_LEGTH + headerSize)",
      "236:                             throw new Error('decryption error. empty content');",
      "237:                         _b = (_a = File).create;",
      "238:                         _c = {",
      "239:                             name: file.name,",
      "240:                             mimeType: 'application/octet-stream'",
      "241:                         };",
      "242:                         return [4 /*yield*/, cryptor.decryptStream({ stream: stream, metadataLength: headerSize })];",
      "243:                     case 1: return [2 /*return*/, _b.apply(_a, [(_c.stream = _d.sent(),",
      "244:                                 _c)])];",
      "245:                 }",
      "246:             });",
      "247:         });",
      "248:     };",
      "249:     CryptoModule.prototype.decryptLegacyFileStream = function (stream, file, File) {",
      "250:         return __awaiter(this, void 0, void 0, function () {",
      "251:             var cryptor;",
      "252:             return __generator(this, function (_a) {",
      "253:                 if (file.contentLength <= 16)",
      "254:                     throw new Error('decryption error: empty content');",
      "255:                 cryptor = this.getLegacyCryptor();",
      "256:                 if (cryptor) {",
      "257:                     return [2 /*return*/, cryptor.decryptFile(File.create({",
      "258:                             name: file.name,",
      "259:                             stream: stream,",
      "260:                         }), File)];",
      "261:                 }",
      "262:                 else {",
      "263:                     throw new Error('unknown cryptor error');",
      "264:                 }",
      "265:                 return [2 /*return*/];",
      "266:             });",
      "267:         });",
      "268:     };",
      "269:     CryptoModule.prototype.getCryptor = function (header) {",
      "270:         if (header === '') {",
      "271:             var cryptor = this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "272:             if (cryptor)",
      "273:                 return cryptor;",
      "274:             throw new Error('unknown cryptor error');",
      "275:         }",
      "276:         else if (header instanceof CryptorHeaderV1) {",
      "277:             return this.getCryptorFromId(header.identifier);",
      "278:         }",
      "279:     };",
      "280:     CryptoModule.prototype.getCryptorFromId = function (id) {",
      "281:         var cryptor = this.getAllCryptors().find(function (c) { return id === c.identifier; });",
      "282:         if (cryptor) {",
      "283:             return cryptor;",
      "284:         }",
      "285:         throw new Error('unknown cryptor error');",
      "286:     };",
      "287:     CryptoModule.LEGACY_IDENTIFIER = '';",
      "288:     return CryptoModule;",
      "289: }());",
      "290: exports.CryptoModule = CryptoModule;",
      "292: var CryptorHeader = /** @class */ (function () {",
      "293:     function CryptorHeader() {",
      "294:     }",
      "295:     CryptorHeader.from = function (id, metadata) {",
      "296:         if (id === CryptorHeader.LEGACY_IDENTIFIER)",
      "297:             return;",
      "298:         return new CryptorHeaderV1(id, metadata.length);",
      "299:     };",
      "300:     CryptorHeader.isSentinel = function (bytes) {",
      "301:         if (bytes && bytes.byteLength >= 4) {",
      "302:             if (bytes.toString('utf8') == CryptorHeader.SENTINEL)",
      "303:                 return true;",
      "304:         }",
      "305:     };",
      "306:     CryptorHeader.validateVersion = function (data) {",
      "307:         if (data && data > CryptorHeader.MAX_VERSION)",
      "308:             throw new Error('decryption error. invalid header version');",
      "309:         return data;",
      "310:     };",
      "311:     CryptorHeader.tryGetIdentifier = function (data) {",
      "312:         if (data.byteLength < 4) {",
      "313:             throw new Error('unknown cryptor error. decryption failed');",
      "314:         }",
      "315:         else {",
      "316:             return data.toString('utf8');",
      "317:         }",
      "318:     };",
      "319:     CryptorHeader.tryGetMetadataSizeFromStream = function (stream) {",
      "320:         var sizeBuf = stream.read(1);",
      "321:         if (sizeBuf && sizeBuf[0] < 255) {",
      "322:             return sizeBuf[0];",
      "323:         }",
      "324:         if (sizeBuf[0] === 255) {",
      "325:             var nextBuf = stream.read(2);",
      "326:             if (nextBuf.length >= 2) {",
      "327:                 return new Uint16Array([nextBuf[0], nextBuf[1]]).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "328:             }",
      "329:         }",
      "330:         throw new Error('decryption error. Invalid metadata size');",
      "331:     };",
      "332:     CryptorHeader.tryParse = function (encryptedData) {",
      "333:         var sentinel = '';",
      "334:         var version = null;",
      "335:         if (encryptedData.length >= 4) {",
      "336:             sentinel = encryptedData.slice(0, 4);",
      "337:             if (sentinel.toString('utf8') !== CryptorHeader.SENTINEL)",
      "338:                 return '';",
      "339:         }",
      "340:         if (encryptedData.length >= 5) {",
      "341:             version = encryptedData[4];",
      "342:         }",
      "343:         else {",
      "344:             throw new Error('decryption error. invalid header version');",
      "345:         }",
      "346:         if (version > CryptorHeader.MAX_VERSION)",
      "347:             throw new Error('unknown cryptor error');",
      "348:         var identifier;",
      "349:         var pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "350:         if (encryptedData.length >= pos) {",
      "351:             identifier = encryptedData.slice(5, pos);",
      "352:         }",
      "353:         else {",
      "354:             throw new Error('decryption error. invalid crypto identifier');",
      "355:         }",
      "356:         var metadataLength = null;",
      "357:         if (encryptedData.length >= pos + 1) {",
      "358:             metadataLength = encryptedData[pos];",
      "359:         }",
      "360:         else {",
      "361:             throw new Error('decryption error. invalid metadata length');",
      "362:         }",
      "363:         pos += 1;",
      "364:         if (metadataLength === 255 && encryptedData.length >= pos + 2) {",
      "365:             metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "366:             pos += 2;",
      "367:         }",
      "368:         return new CryptorHeaderV1(identifier.toString('utf8'), metadataLength);",
      "369:     };",
      "370:     CryptorHeader.SENTINEL = 'PNED';",
      "371:     CryptorHeader.LEGACY_IDENTIFIER = '';",
      "372:     CryptorHeader.IDENTIFIER_LENGTH = 4;",
      "373:     CryptorHeader.VERSION = 1;",
      "374:     CryptorHeader.MAX_VERSION = 1;",
      "375:     CryptorHeader.MIN_HEADER_LEGTH = 10;",
      "376:     return CryptorHeader;",
      "377: }());",
      "379: var CryptorHeaderV1 = /** @class */ (function () {",
      "380:     function CryptorHeaderV1(id, metadataLength) {",
      "381:         this._identifier = id;",
      "382:         this._metadataLength = metadataLength;",
      "383:     }",
      "384:     Object.defineProperty(CryptorHeaderV1.prototype, \"identifier\", {",
      "385:         get: function () {",
      "386:             return this._identifier;",
      "387:         },",
      "388:         set: function (value) {",
      "389:             this._identifier = value;",
      "390:         },",
      "391:         enumerable: false,",
      "392:         configurable: true",
      "393:     });",
      "394:     Object.defineProperty(CryptorHeaderV1.prototype, \"metadataLength\", {",
      "395:         get: function () {",
      "396:             return this._metadataLength;",
      "397:         },",
      "398:         set: function (value) {",
      "399:             this._metadataLength = value;",
      "400:         },",
      "401:         enumerable: false,",
      "402:         configurable: true",
      "403:     });",
      "404:     Object.defineProperty(CryptorHeaderV1.prototype, \"version\", {",
      "405:         get: function () {",
      "406:             return CryptorHeader.VERSION;",
      "407:         },",
      "408:         enumerable: false,",
      "409:         configurable: true",
      "410:     });",
      "411:     Object.defineProperty(CryptorHeaderV1.prototype, \"length\", {",
      "412:         get: function () {",
      "413:             return (CryptorHeader.SENTINEL.length +",
      "414:                 1 +",
      "415:                 CryptorHeader.IDENTIFIER_LENGTH +",
      "416:                 (this.metadataLength < 255 ? 1 : 3) +",
      "417:                 this.metadataLength);",
      "418:         },",
      "419:         enumerable: false,",
      "420:         configurable: true",
      "421:     });",
      "422:     Object.defineProperty(CryptorHeaderV1.prototype, \"data\", {",
      "423:         get: function () {",
      "424:             var pos = 0;",
      "425:             var header = new Uint8Array(this.length);",
      "426:             header.set(Buffer.from(CryptorHeader.SENTINEL));",
      "427:             pos += CryptorHeader.SENTINEL.length;",
      "428:             header[pos] = this.version;",
      "429:             pos++;",
      "430:             if (this.identifier)",
      "431:                 header.set(Buffer.from(this.identifier), pos);",
      "432:             pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "433:             var metadataLength = this.metadataLength;",
      "434:             if (metadataLength < 255) {",
      "435:                 header[pos] = metadataLength;",
      "436:             }",
      "437:             else {",
      "438:                 header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "439:             }",
      "440:             return header;",
      "441:         },",
      "442:         enumerable: false,",
      "443:         configurable: true",
      "444:     });",
      "445:     return CryptorHeaderV1;",
      "446: }());",
      "",
      "---------------"
    ],
    "lib/crypto/modules/WebCryptoModule/ICryptor.js||lib/crypto/modules/WebCryptoModule/ICryptor.js": [
      "File: lib/crypto/modules/WebCryptoModule/ICryptor.js -> lib/crypto/modules/WebCryptoModule/ICryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "",
      "---------------"
    ],
    "lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js||lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js": [
      "File: lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js -> lib/crypto/modules/WebCryptoModule/ILegacyCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "",
      "---------------"
    ],
    "lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js||lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js": [
      "File: lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js -> lib/crypto/modules/WebCryptoModule/aesCbcCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "39:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "40: };",
      "41: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "42: var hmac_sha256_1 = __importDefault(require(\"../../../core/components/cryptography/hmac-sha256\"));",
      "43: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "44: var AesCbcCryptor = /** @class */ (function () {",
      "45:     function AesCbcCryptor(configuration) {",
      "46:         this.cipherKey = configuration.cipherKey;",
      "47:         this.CryptoJS = hmac_sha256_1.default;",
      "48:         this.encryptedKey = this.CryptoJS.SHA256(this.cipherKey);",
      "49:     }",
      "50:     Object.defineProperty(AesCbcCryptor.prototype, \"algo\", {",
      "51:         get: function () {",
      "52:             return 'AES-CBC';",
      "53:         },",
      "54:         enumerable: false,",
      "55:         configurable: true",
      "56:     });",
      "57:     Object.defineProperty(AesCbcCryptor.prototype, \"identifier\", {",
      "58:         get: function () {",
      "59:             return 'ACRH';",
      "60:         },",
      "61:         enumerable: false,",
      "62:         configurable: true",
      "63:     });",
      "64:     AesCbcCryptor.prototype.getIv = function () {",
      "65:         return crypto.getRandomValues(new Uint8Array(AesCbcCryptor.BLOCK_SIZE));",
      "66:     };",
      "67:     AesCbcCryptor.prototype.getKey = function () {",
      "68:         return __awaiter(this, void 0, void 0, function () {",
      "69:             var bKey, abHash;",
      "70:             return __generator(this, function (_a) {",
      "71:                 switch (_a.label) {",
      "72:                     case 0:",
      "73:                         bKey = AesCbcCryptor.encoder.encode(this.cipherKey);",
      "74:                         return [4 /*yield*/, crypto.subtle.digest('SHA-256', bKey.buffer)];",
      "75:                     case 1:",
      "76:                         abHash = _a.sent();",
      "77:                         return [2 /*return*/, crypto.subtle.importKey('raw', abHash, this.algo, true, ['encrypt', 'decrypt'])];",
      "78:                 }",
      "79:             });",
      "80:         });",
      "81:     };",
      "82:     AesCbcCryptor.prototype.encrypt = function (data) {",
      "83:         var stringData = typeof data === 'string' ? data : AesCbcCryptor.decoder.decode(data);",
      "84:         if (stringData.length === 0)",
      "85:             throw new Error('encryption error. empty content');",
      "86:         var abIv = this.getIv();",
      "87:         return {",
      "88:             metadata: abIv,",
      "89:             data: (0, base64_codec_1.decode)(this.CryptoJS.AES.encrypt(data, this.encryptedKey, {",
      "90:                 iv: this.bufferToWordArray(abIv),",
      "91:                 mode: this.CryptoJS.mode.CBC,",
      "92:             }).ciphertext.toString(this.CryptoJS.enc.Base64)),",
      "93:         };",
      "94:     };",
      "95:     AesCbcCryptor.prototype.decrypt = function (encryptedData) {",
      "96:         var iv = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.metadata));",
      "97:         var data = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.data));",
      "98:         return AesCbcCryptor.encoder.encode(this.CryptoJS.AES.decrypt({ ciphertext: data }, this.encryptedKey, {",
      "99:             iv: iv,",
      "100:             mode: this.CryptoJS.mode.CBC,",
      "101:         }).toString(this.CryptoJS.enc.Utf8)).buffer;",
      "102:     };",
      "103:     AesCbcCryptor.prototype.encryptFileData = function (data) {",
      "104:         return __awaiter(this, void 0, void 0, function () {",
      "105:             var key, iv;",
      "106:             var _a;",
      "107:             return __generator(this, function (_b) {",
      "108:                 switch (_b.label) {",
      "109:                     case 0: return [4 /*yield*/, this.getKey()];",
      "110:                     case 1:",
      "111:                         key = _b.sent();",
      "112:                         iv = this.getIv();",
      "113:                         _a = {};",
      "114:                         return [4 /*yield*/, crypto.subtle.encrypt({ name: this.algo, iv: iv }, key, data)];",
      "115:                     case 2: return [2 /*return*/, (_a.data = _b.sent(),",
      "116:                             _a.metadata = iv,",
      "117:                             _a)];",
      "118:                 }",
      "119:             });",
      "120:         });",
      "121:     };",
      "122:     AesCbcCryptor.prototype.decryptFileData = function (encryptedData) {",
      "123:         return __awaiter(this, void 0, void 0, function () {",
      "124:             var key;",
      "125:             return __generator(this, function (_a) {",
      "126:                 switch (_a.label) {",
      "127:                     case 0: return [4 /*yield*/, this.getKey()];",
      "128:                     case 1:",
      "129:                         key = _a.sent();",
      "130:                         return [2 /*return*/, crypto.subtle.decrypt({ name: this.algo, iv: encryptedData.metadata }, key, encryptedData.data)];",
      "131:                 }",
      "132:             });",
      "133:         });",
      "134:     };",
      "135:     AesCbcCryptor.prototype.bufferToWordArray = function (b) {",
      "136:         var wa = [];",
      "137:         var i;",
      "138:         for (i = 0; i < b.length; i += 1) {",
      "139:             wa[(i / 4) | 0] |= b[i] << (24 - 8 * i);",
      "140:         }",
      "141:         return this.CryptoJS.lib.WordArray.create(wa, b.length);",
      "142:     };",
      "143:     AesCbcCryptor.BLOCK_SIZE = 16;",
      "144:     AesCbcCryptor.encoder = new TextEncoder();",
      "145:     AesCbcCryptor.decoder = new TextDecoder();",
      "146:     return AesCbcCryptor;",
      "147: }());",
      "148: exports.default = AesCbcCryptor;",
      "",
      "---------------"
    ],
    "lib/crypto/modules/WebCryptoModule/legacyCryptor.js||lib/crypto/modules/WebCryptoModule/legacyCryptor.js": [
      "File: lib/crypto/modules/WebCryptoModule/legacyCryptor.js -> lib/crypto/modules/WebCryptoModule/legacyCryptor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "39:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "40: };",
      "41: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "42: var index_1 = __importDefault(require(\"../../../core/components/cryptography/index\"));",
      "43: var web_1 = __importDefault(require(\"../web\"));",
      "44: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "45: var LegacyCryptor = /** @class */ (function () {",
      "46:     function LegacyCryptor(config) {",
      "47:         this.config = config;",
      "48:         this.cryptor = new index_1.default({ config: config });",
      "49:         this.fileCryptor = new web_1.default();",
      "50:     }",
      "51:     Object.defineProperty(LegacyCryptor.prototype, \"identifier\", {",
      "52:         get: function () {",
      "53:             return '';",
      "54:         },",
      "55:         enumerable: false,",
      "56:         configurable: true",
      "57:     });",
      "58:     LegacyCryptor.prototype.encrypt = function (data) {",
      "59:         var stringData = typeof data === 'string' ? data : new TextDecoder().decode(data);",
      "60:         return {",
      "61:             data: this.cryptor.encrypt(stringData),",
      "62:             metadata: null,",
      "63:         };",
      "64:     };",
      "65:     LegacyCryptor.prototype.decrypt = function (encryptedData) {",
      "66:         var data = typeof encryptedData.data === 'string' ? encryptedData.data : (0, base64_codec_1.encode)(encryptedData.data);",
      "67:         return this.cryptor.decrypt(data);",
      "68:     };",
      "69:     LegacyCryptor.prototype.encryptFile = function (file, File) {",
      "70:         var _a;",
      "71:         return __awaiter(this, void 0, void 0, function () {",
      "72:             return __generator(this, function (_b) {",
      "75:                 return [2 /*return*/, this.fileCryptor.encryptFile((_a = this.config) === null || _a === void 0 ? void 0 : _a.cipherKey, file, File)];",
      "76:             });",
      "77:         });",
      "78:     };",
      "79:     LegacyCryptor.prototype.decryptFile = function (file, File) {",
      "80:         return __awaiter(this, void 0, void 0, function () {",
      "81:             return __generator(this, function (_a) {",
      "84:                 return [2 /*return*/, this.fileCryptor.decryptFile(this.config.cipherKey, file, File)];",
      "85:             });",
      "86:         });",
      "87:     };",
      "88:     return LegacyCryptor;",
      "89: }());",
      "90: exports.default = LegacyCryptor;",
      "",
      "---------------"
    ],
    "lib/crypto/modules/WebCryptoModule/webCryptoModule.js||lib/crypto/modules/WebCryptoModule/webCryptoModule.js": [
      "File: lib/crypto/modules/WebCryptoModule/webCryptoModule.js -> lib/crypto/modules/WebCryptoModule/webCryptoModule.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: \"use strict\";",
      "2: var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {",
      "3:     function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }",
      "4:     return new (P || (P = Promise))(function (resolve, reject) {",
      "5:         function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }",
      "6:         function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }",
      "7:         function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }",
      "8:         step((generator = generator.apply(thisArg, _arguments || [])).next());",
      "9:     });",
      "10: };",
      "11: var __generator = (this && this.__generator) || function (thisArg, body) {",
      "12:     var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;",
      "13:     return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;",
      "14:     function verb(n) { return function (v) { return step([n, v]); }; }",
      "15:     function step(op) {",
      "16:         if (f) throw new TypeError(\"Generator is already executing.\");",
      "17:         while (_) try {",
      "18:             if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;",
      "19:             if (y = 0, t) op = [op[0] & 2, t.value];",
      "20:             switch (op[0]) {",
      "21:                 case 0: case 1: t = op; break;",
      "22:                 case 4: _.label++; return { value: op[1], done: false };",
      "23:                 case 5: _.label++; y = op[1]; op = [0]; continue;",
      "24:                 case 7: op = _.ops.pop(); _.trys.pop(); continue;",
      "25:                 default:",
      "26:                     if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }",
      "27:                     if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }",
      "28:                     if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }",
      "29:                     if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }",
      "30:                     if (t[2]) _.ops.pop();",
      "31:                     _.trys.pop(); continue;",
      "32:             }",
      "33:             op = body.call(thisArg, _);",
      "34:         } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }",
      "35:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "36:     }",
      "37: };",
      "38: var __read = (this && this.__read) || function (o, n) {",
      "39:     var m = typeof Symbol === \"function\" && o[Symbol.iterator];",
      "40:     if (!m) return o;",
      "41:     var i = m.call(o), r, ar = [], e;",
      "42:     try {",
      "43:         while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);",
      "44:     }",
      "45:     catch (error) { e = { error: error }; }",
      "46:     finally {",
      "47:         try {",
      "48:             if (r && !r.done && (m = i[\"return\"])) m.call(i);",
      "49:         }",
      "50:         finally { if (e) throw e.error; }",
      "51:     }",
      "52:     return ar;",
      "53: };",
      "54: var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {",
      "55:     if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {",
      "56:         if (ar || !(i in from)) {",
      "57:             if (!ar) ar = Array.prototype.slice.call(from, 0, i);",
      "58:             ar[i] = from[i];",
      "59:         }",
      "60:     }",
      "61:     return to.concat(ar || Array.prototype.slice.call(from));",
      "62: };",
      "63: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "64:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "65: };",
      "66: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "67: exports.CryptoModule = exports.AesCbcCryptor = exports.LegacyCryptor = void 0;",
      "68: var legacyCryptor_1 = __importDefault(require(\"./legacyCryptor\"));",
      "69: exports.LegacyCryptor = legacyCryptor_1.default;",
      "70: var aesCbcCryptor_1 = __importDefault(require(\"./aesCbcCryptor\"));",
      "71: exports.AesCbcCryptor = aesCbcCryptor_1.default;",
      "72: var base64_codec_1 = require(\"../../../core/components/base64_codec\");",
      "73: var CryptoModule = /** @class */ (function () {",
      "74:     function CryptoModule(cryptoModuleConfiguration) {",
      "75:         var _a;",
      "76:         this.defaultCryptor = cryptoModuleConfiguration.default;",
      "77:         this.cryptors = (_a = cryptoModuleConfiguration.cryptors) !== null && _a !== void 0 ? _a : [];",
      "78:     }",
      "81:     CryptoModule.legacyCryptoModule = function (config) {",
      "82:         var _a;",
      "83:         return new this({",
      "84:             default: new legacyCryptor_1.default({",
      "85:                 cipherKey: config.cipherKey,",
      "86:                 useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "87:             }),",
      "88:             cryptors: [new aesCbcCryptor_1.default({ cipherKey: config.cipherKey })],",
      "89:         });",
      "90:     };",
      "91:     CryptoModule.aesCbcCryptoModule = function (config) {",
      "92:         var _a;",
      "93:         return new this({",
      "94:             default: new aesCbcCryptor_1.default({ cipherKey: config.cipherKey }),",
      "95:             cryptors: [",
      "96:                 new legacyCryptor_1.default({",
      "97:                     cipherKey: config.cipherKey,",
      "98:                     useRandomIVs: (_a = config.useRandomIVs) !== null && _a !== void 0 ? _a : true,",
      "99:                 }),",
      "100:             ],",
      "101:         });",
      "102:     };",
      "103:     CryptoModule.withDefaultCryptor = function (defaultCryptor) {",
      "104:         return new this({ default: defaultCryptor });",
      "105:     };",
      "106:     CryptoModule.prototype.getAllCryptors = function () {",
      "107:         return __spreadArray([this.defaultCryptor], __read(this.cryptors), false);",
      "108:     };",
      "109:     CryptoModule.prototype.encrypt = function (data) {",
      "110:         var encrypted = this.defaultCryptor.encrypt(data);",
      "111:         if (!encrypted.metadata)",
      "112:             return encrypted.data;",
      "113:         var headerData = this.getHeaderData(encrypted);",
      "114:         return this.concatArrayBuffer(headerData, encrypted.data);",
      "115:     };",
      "116:     CryptoModule.prototype.decrypt = function (data) {",
      "117:         var encryptedData = typeof data === 'string' ? (0, base64_codec_1.decode)(data) : data;",
      "118:         var header = CryptorHeader.tryParse(encryptedData);",
      "119:         var cryptor = this.getCryptor(header);",
      "120:         var metadata = header.length > 0",
      "121:             ? encryptedData.slice(header.length - header.metadataLength, header.length)",
      "122:             : null;",
      "123:         if (encryptedData.slice(header.length).byteLength <= 0)",
      "124:             throw new Error('decryption error. empty content');",
      "125:         return cryptor.decrypt({",
      "126:             data: encryptedData.slice(header.length),",
      "127:             metadata: metadata,",
      "128:         });",
      "129:     };",
      "130:     CryptoModule.prototype.encryptFile = function (file, File) {",
      "131:         return __awaiter(this, void 0, void 0, function () {",
      "132:             var fileData, encrypted;",
      "133:             return __generator(this, function (_a) {",
      "134:                 switch (_a.label) {",
      "135:                     case 0:",
      "136:                         if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "137:                             return [2 /*return*/, this.defaultCryptor.encryptFile(file, File)];",
      "138:                         fileData = this.getFileData(file.data);",
      "139:                         return [4 /*yield*/, this.defaultCryptor.encryptFileData(fileData)];",
      "140:                     case 1:",
      "141:                         encrypted = _a.sent();",
      "142:                         return [2 /*return*/, File.create({",
      "143:                                 name: file.name,",
      "144:                                 mimeType: 'application/octet-stream',",
      "145:                                 data: this.concatArrayBuffer(this.getHeaderData(encrypted), encrypted.data),",
      "146:                             })];",
      "147:                 }",
      "148:             });",
      "149:         });",
      "150:     };",
      "151:     CryptoModule.prototype.decryptFile = function (file, File) {",
      "152:         return __awaiter(this, void 0, void 0, function () {",
      "153:             var data, header, cryptor, fileData, metadata, _a, _b;",
      "154:             var _c;",
      "155:             return __generator(this, function (_d) {",
      "156:                 switch (_d.label) {",
      "157:                     case 0: return [4 /*yield*/, file.data.arrayBuffer()];",
      "158:                     case 1:",
      "159:                         data = _d.sent();",
      "160:                         header = CryptorHeader.tryParse(data);",
      "161:                         cryptor = this.getCryptor(header);",
      "162:                         if ((cryptor === null || cryptor === void 0 ? void 0 : cryptor.identifier) === CryptoModule.LEGACY_IDENTIFIER) {",
      "163:                             return [2 /*return*/, cryptor.decryptFile(file, File)];",
      "164:                         }",
      "165:                         fileData = this.getFileData(data);",
      "166:                         metadata = fileData.slice(header.length - header.metadataLength, header.length);",
      "167:                         _b = (_a = File).create;",
      "168:                         _c = {",
      "169:                             name: file.name",
      "170:                         };",
      "171:                         return [4 /*yield*/, this.defaultCryptor.decryptFileData({",
      "172:                                 data: data.slice(header.length),",
      "173:                                 metadata: metadata,",
      "174:                             })];",
      "175:                     case 2: return [2 /*return*/, _b.apply(_a, [(_c.data = _d.sent(),",
      "176:                                 _c)])];",
      "177:                 }",
      "178:             });",
      "179:         });",
      "180:     };",
      "181:     CryptoModule.prototype.getCryptor = function (header) {",
      "182:         if (header === '') {",
      "183:             var cryptor = this.getAllCryptors().find(function (c) { return c.identifier === ''; });",
      "184:             if (cryptor)",
      "185:                 return cryptor;",
      "186:             throw new Error('unknown cryptor error');",
      "187:         }",
      "188:         else if (header instanceof CryptorHeaderV1) {",
      "189:             return this.getCryptorFromId(header.identifier);",
      "190:         }",
      "191:     };",
      "192:     CryptoModule.prototype.getCryptorFromId = function (id) {",
      "193:         var cryptor = this.getAllCryptors().find(function (c) { return id === c.identifier; });",
      "194:         if (cryptor) {",
      "195:             return cryptor;",
      "196:         }",
      "197:         throw Error('unknown cryptor error');",
      "198:     };",
      "199:     CryptoModule.prototype.concatArrayBuffer = function (ab1, ab2) {",
      "200:         var tmp = new Uint8Array(ab1.byteLength + ab2.byteLength);",
      "201:         tmp.set(new Uint8Array(ab1), 0);",
      "202:         tmp.set(new Uint8Array(ab2), ab1.byteLength);",
      "203:         return tmp.buffer;",
      "204:     };",
      "205:     CryptoModule.prototype.getHeaderData = function (encrypted) {",
      "206:         if (!encrypted.metadata)",
      "207:             return;",
      "208:         var header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "209:         var headerData = new Uint8Array(header.length);",
      "210:         var pos = 0;",
      "211:         headerData.set(header.data, pos);",
      "212:         pos += header.length - encrypted.metadata.byteLength;",
      "213:         headerData.set(new Uint8Array(encrypted.metadata), pos);",
      "214:         return headerData.buffer;",
      "215:     };",
      "216:     CryptoModule.prototype.getFileData = function (input) {",
      "217:         if (input instanceof ArrayBuffer) {",
      "218:             return input;",
      "219:         }",
      "220:         if (typeof input === 'string') {",
      "221:             return CryptoModule.encoder.encode(input);",
      "222:         }",
      "223:         throw new Error('Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer');",
      "224:     };",
      "225:     CryptoModule.LEGACY_IDENTIFIER = '';",
      "226:     CryptoModule.encoder = new TextEncoder();",
      "227:     CryptoModule.decoder = new TextDecoder();",
      "228:     return CryptoModule;",
      "229: }());",
      "230: exports.CryptoModule = CryptoModule;",
      "232: var CryptorHeader = /** @class */ (function () {",
      "233:     function CryptorHeader() {",
      "234:     }",
      "235:     CryptorHeader.from = function (id, metadata) {",
      "236:         if (id === CryptorHeader.LEGACY_IDENTIFIER)",
      "237:             return;",
      "238:         return new CryptorHeaderV1(id, metadata.byteLength);",
      "239:     };",
      "240:     CryptorHeader.tryParse = function (data) {",
      "241:         var encryptedData = new Uint8Array(data);",
      "242:         var sentinel = '';",
      "243:         var version = null;",
      "244:         if (encryptedData.byteLength >= 4) {",
      "245:             sentinel = encryptedData.slice(0, 4);",
      "246:             if (this.decoder.decode(sentinel) !== CryptorHeader.SENTINEL)",
      "247:                 return '';",
      "248:         }",
      "249:         if (encryptedData.byteLength >= 5) {",
      "250:             version = encryptedData[4];",
      "251:         }",
      "252:         else {",
      "253:             throw new Error('decryption error. invalid header version');",
      "254:         }",
      "255:         if (version > CryptorHeader.MAX_VERSION)",
      "256:             throw new Error('unknown cryptor error');",
      "257:         var identifier = '';",
      "258:         var pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "259:         if (encryptedData.byteLength >= pos) {",
      "260:             identifier = encryptedData.slice(5, pos);",
      "261:         }",
      "262:         else {",
      "263:             throw new Error('decryption error. invalid crypto identifier');",
      "264:         }",
      "265:         var metadataLength = null;",
      "266:         if (encryptedData.byteLength >= pos + 1) {",
      "267:             metadataLength = encryptedData[pos];",
      "268:         }",
      "269:         else {",
      "270:             throw new Error('decryption error. invalid metadata length');",
      "271:         }",
      "272:         pos += 1;",
      "273:         if (metadataLength === 255 && encryptedData.byteLength >= pos + 2) {",
      "274:             metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce(function (acc, val) { return (acc << 8) + val; }, 0);",
      "275:             pos += 2;",
      "276:         }",
      "277:         return new CryptorHeaderV1(this.decoder.decode(identifier), metadataLength);",
      "278:     };",
      "279:     CryptorHeader.SENTINEL = 'PNED';",
      "280:     CryptorHeader.LEGACY_IDENTIFIER = '';",
      "281:     CryptorHeader.IDENTIFIER_LENGTH = 4;",
      "282:     CryptorHeader.VERSION = 1;",
      "283:     CryptorHeader.MAX_VERSION = 1;",
      "284:     CryptorHeader.decoder = new TextDecoder();",
      "285:     return CryptorHeader;",
      "286: }());",
      "288: var CryptorHeaderV1 = /** @class */ (function () {",
      "289:     function CryptorHeaderV1(id, metadataLength) {",
      "290:         this._identifier = id;",
      "291:         this._metadataLength = metadataLength;",
      "292:     }",
      "293:     Object.defineProperty(CryptorHeaderV1.prototype, \"identifier\", {",
      "294:         get: function () {",
      "295:             return this._identifier;",
      "296:         },",
      "297:         set: function (value) {",
      "298:             this._identifier = value;",
      "299:         },",
      "300:         enumerable: false,",
      "301:         configurable: true",
      "302:     });",
      "303:     Object.defineProperty(CryptorHeaderV1.prototype, \"metadataLength\", {",
      "304:         get: function () {",
      "305:             return this._metadataLength;",
      "306:         },",
      "307:         set: function (value) {",
      "308:             this._metadataLength = value;",
      "309:         },",
      "310:         enumerable: false,",
      "311:         configurable: true",
      "312:     });",
      "313:     Object.defineProperty(CryptorHeaderV1.prototype, \"version\", {",
      "314:         get: function () {",
      "315:             return CryptorHeader.VERSION;",
      "316:         },",
      "317:         enumerable: false,",
      "318:         configurable: true",
      "319:     });",
      "320:     Object.defineProperty(CryptorHeaderV1.prototype, \"length\", {",
      "321:         get: function () {",
      "322:             return (CryptorHeader.SENTINEL.length +",
      "323:                 1 +",
      "324:                 CryptorHeader.IDENTIFIER_LENGTH +",
      "325:                 (this.metadataLength < 255 ? 1 : 3) +",
      "326:                 this.metadataLength);",
      "327:         },",
      "328:         enumerable: false,",
      "329:         configurable: true",
      "330:     });",
      "331:     Object.defineProperty(CryptorHeaderV1.prototype, \"data\", {",
      "332:         get: function () {",
      "333:             var pos = 0;",
      "334:             var header = new Uint8Array(this.length);",
      "335:             var encoder = new TextEncoder();",
      "336:             header.set(encoder.encode(CryptorHeader.SENTINEL));",
      "337:             pos += CryptorHeader.SENTINEL.length;",
      "338:             header[pos] = this.version;",
      "339:             pos++;",
      "340:             if (this.identifier)",
      "341:                 header.set(encoder.encode(this.identifier), pos);",
      "342:             pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "343:             var metadataLength = this.metadataLength;",
      "344:             if (metadataLength < 255) {",
      "345:                 header[pos] = metadataLength;",
      "346:             }",
      "347:             else {",
      "348:                 header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "349:             }",
      "350:             return header;",
      "351:         },",
      "352:         enumerable: false,",
      "353:         configurable: true",
      "354:     });",
      "355:     CryptorHeaderV1.IDENTIFIER_LENGTH = 4;",
      "356:     CryptorHeaderV1.SENTINEL = 'PNED';",
      "357:     return CryptorHeaderV1;",
      "358: }());",
      "",
      "---------------"
    ],
    "lib/crypto/modules/node.js||lib/crypto/modules/node.js": [
      "File: lib/crypto/modules/node.js -> lib/crypto/modules/node.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "94:                     case 0:",
      "95:                         bKey = this.getKey(key);",
      "96:                         if (!(file.data instanceof Buffer)) return [3 /*break*/, 2];",
      "97:                         _b = (_a = File).create;",
      "98:                         _e = {",
      "99:                             name: file.name,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "97:                         if (file.data.byteLength <= 0)",
      "98:                             throw new Error('encryption error. empty content');",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "104:                                 _e)])];",
      "105:                     case 2:",
      "106:                         if (!(file.data instanceof stream_1.Readable)) return [3 /*break*/, 4];",
      "107:                         _d = (_c = File).create;",
      "108:                         _f = {",
      "109:                             name: file.name,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "109:                         if (file.contentLength === 0)",
      "110:                             throw new Error('encryption error. empty content');",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "176:     NodeCryptography.prototype.decryptBuffer = function (key, ciphertext) {",
      "177:         var bIv = ciphertext.slice(0, NodeCryptography.IV_LENGTH);",
      "178:         var bCiphertext = ciphertext.slice(NodeCryptography.IV_LENGTH);",
      "179:         var aes = (0, crypto_1.createDecipheriv)(this.algo, key, bIv);",
      "180:         return Buffer.concat([aes.update(bCiphertext), aes.final()]);",
      "181:     };",
      "182:     NodeCryptography.prototype.encryptStream = function (key, stream) {",
      "189:     };",
      "190:     NodeCryptography.prototype.decryptStream = function (key, stream) {",
      "191:         var _this = this;",
      "",
      "[Removed Lines]",
      "183:         var output = new stream_1.PassThrough();",
      "184:         var bIv = this.getIv();",
      "185:         var aes = (0, crypto_1.createCipheriv)(this.algo, key, bIv);",
      "186:         output.write(bIv);",
      "187:         stream.pipe(aes).pipe(output);",
      "188:         return output;",
      "",
      "[Added Lines]",
      "183:         if (bCiphertext.byteLength <= 0)",
      "184:             throw new Error('decryption error: empty content');",
      "189:         return __awaiter(this, void 0, void 0, function () {",
      "190:             var bIv, aes, inited;",
      "191:             return __generator(this, function (_a) {",
      "192:                 bIv = this.getIv();",
      "193:                 aes = (0, crypto_1.createCipheriv)('aes-256-cbc', key, bIv).setAutoPadding(true);",
      "194:                 inited = false;",
      "195:                 return [2 /*return*/, stream.pipe(aes).pipe(new stream_1.Transform({",
      "196:                         transform: function (chunk, _, cb) {",
      "197:                             if (!inited) {",
      "198:                                 inited = true;",
      "199:                                 this.push(Buffer.concat([bIv, chunk]));",
      "200:                             }",
      "201:                             else {",
      "202:                                 this.push(chunk);",
      "203:                             }",
      "204:                             cb();",
      "205:                         },",
      "206:                     }))];",
      "207:             });",
      "208:         });",
      "",
      "---------------"
    ],
    "lib/crypto/modules/web.js||lib/crypto/modules/web.js": [
      "File: lib/crypto/modules/web.js -> lib/crypto/modules/web.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "96:             var bKey, abPlaindata, abCipherdata;",
      "97:             return __generator(this, function (_a) {",
      "98:                 switch (_a.label) {",
      "100:                     case 1:",
      "101:                         bKey = _a.sent();",
      "103:                     case 2:",
      "104:                         abPlaindata = _a.sent();",
      "105:                         return [4 /*yield*/, this.encryptArrayBuffer(bKey, abPlaindata)];",
      "",
      "[Removed Lines]",
      "99:                     case 0: return [4 /*yield*/, this.getKey(key)];",
      "102:                         return [4 /*yield*/, file.toArrayBuffer()];",
      "",
      "[Added Lines]",
      "99:                     case 0:",
      "100:                         if (file.data.byteLength <= 0)",
      "101:                             throw new Error('encryption error. empty content');",
      "102:                         return [4 /*yield*/, this.getKey(key)];",
      "105:                         return [4 /*yield*/, file.data.arrayBuffer()];",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "122:                     case 0: return [4 /*yield*/, this.getKey(key)];",
      "123:                     case 1:",
      "124:                         bKey = _a.sent();",
      "126:                     case 2:",
      "127:                         abCipherdata = _a.sent();",
      "128:                         return [4 /*yield*/, this.decryptArrayBuffer(bKey, abCipherdata)];",
      "",
      "[Removed Lines]",
      "125:                         return [4 /*yield*/, file.toArrayBuffer()];",
      "",
      "[Added Lines]",
      "128:                         return [4 /*yield*/, file.data.arrayBuffer()];",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "138:     };",
      "139:     WebCryptography.prototype.getKey = function (key) {",
      "140:         return __awaiter(this, void 0, void 0, function () {",
      "142:             return __generator(this, function (_a) {",
      "143:                 switch (_a.label) {",
      "147:                     case 1:",
      "150:                         return [2 /*return*/, crypto.subtle.importKey('raw', abKey, 'AES-CBC', true, ['encrypt', 'decrypt'])];",
      "151:                 }",
      "152:             });",
      "",
      "[Removed Lines]",
      "141:             var bKey, abHash, abKey;",
      "144:                     case 0:",
      "145:                         bKey = Buffer.from(key);",
      "146:                         return [4 /*yield*/, crypto.subtle.digest('SHA-256', bKey.buffer)];",
      "148:                         abHash = _a.sent();",
      "149:                         abKey = Buffer.from(Buffer.from(abHash).toString('hex').slice(0, 32), 'utf8').buffer;",
      "",
      "[Added Lines]",
      "144:             var digest, hashHex, abKey;",
      "147:                     case 0: return [4 /*yield*/, crypto.subtle.digest('SHA-256', WebCryptography.encoder.encode(key))];",
      "149:                         digest = _a.sent();",
      "150:                         hashHex = Array.from(new Uint8Array(digest))",
      "151:                             .map(function (b) { return b.toString(16).padStart(2, '0'); })",
      "152:                             .join('');",
      "153:                         abKey = WebCryptography.encoder.encode(hashHex.slice(0, 32)).buffer;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "169:     };",
      "170:     WebCryptography.prototype.decryptArrayBuffer = function (key, ciphertext) {",
      "171:         return __awaiter(this, void 0, void 0, function () {",
      "173:             return __generator(this, function (_a) {",
      "176:             });",
      "177:         });",
      "178:     };",
      "",
      "[Removed Lines]",
      "172:             var abIv;",
      "174:                 abIv = ciphertext.slice(0, 16);",
      "175:                 return [2 /*return*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, ciphertext.slice(16))];",
      "",
      "[Added Lines]",
      "176:             var abIv, data;",
      "178:                 switch (_a.label) {",
      "179:                     case 0:",
      "180:                         abIv = ciphertext.slice(0, 16);",
      "181:                         if (ciphertext.slice(WebCryptography.IV_LENGTH).byteLength <= 0)",
      "182:                             throw new Error('decryption error: empty content');",
      "183:                         return [4 /*yield*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, ciphertext.slice(WebCryptography.IV_LENGTH))];",
      "184:                     case 1:",
      "185:                         data = _a.sent();",
      "186:                         return [2 /*return*/, data];",
      "187:                 }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "183:                 switch (_a.label) {",
      "184:                     case 0:",
      "185:                         abIv = crypto.getRandomValues(new Uint8Array(16));",
      "187:                         return [4 /*yield*/, crypto.subtle.encrypt({ name: 'AES-CBC', iv: abIv }, key, abPlaintext)];",
      "188:                     case 1:",
      "189:                         abPayload = _a.sent();",
      "190:                         ciphertext = concatArrayBuffer(abIv.buffer, abPayload);",
      "192:                 }",
      "193:             });",
      "194:         });",
      "",
      "[Removed Lines]",
      "186:                         abPlaintext = Buffer.from(plaintext).buffer;",
      "191:                         return [2 /*return*/, Buffer.from(ciphertext).toString('utf8')];",
      "",
      "[Added Lines]",
      "198:                         abPlaintext = WebCryptography.encoder.encode(plaintext).buffer;",
      "203:                         return [2 /*return*/, WebCryptography.decoder.decode(ciphertext)];",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "199:             return __generator(this, function (_a) {",
      "200:                 switch (_a.label) {",
      "201:                     case 0:",
      "203:                         abIv = abCiphertext.slice(0, 16);",
      "204:                         abPayload = abCiphertext.slice(16);",
      "205:                         return [4 /*yield*/, crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, abPayload)];",
      "206:                     case 1:",
      "207:                         abPlaintext = _a.sent();",
      "209:                 }",
      "210:             });",
      "211:         });",
      "212:     };",
      "213:     WebCryptography.IV_LENGTH = 16;",
      "214:     return WebCryptography;",
      "215: }());",
      "216: exports.default = WebCryptography;",
      "",
      "[Removed Lines]",
      "202:                         abCiphertext = Buffer.from(ciphertext);",
      "208:                         return [2 /*return*/, Buffer.from(abPlaintext).toString('utf8')];",
      "",
      "[Added Lines]",
      "214:                         abCiphertext = WebCryptography.encoder.encode(ciphertext).buffer;",
      "220:                         return [2 /*return*/, WebCryptography.decoder.decode(abPlaintext)];",
      "226:     WebCryptography.encoder = new TextEncoder();",
      "227:     WebCryptography.decoder = new TextDecoder();",
      "",
      "---------------"
    ],
    "lib/file/modules/node.js||lib/file/modules/node.js": [
      "File: lib/file/modules/node.js -> lib/file/modules/node.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "36:         if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };",
      "37:     }",
      "38: };",
      "39: var _a;",
      "40: Object.defineProperty(exports, \"__esModule\", { value: true });",
      "41: var stream_1 = require(\"stream\");",
      "43: var path_1 = require(\"path\");",
      "44: var PubNubFile = (_a = /** @class */ (function () {",
      "45:         function PubNubFile(_a) {",
      "46:             var stream = _a.stream, data = _a.data, encoding = _a.encoding, name = _a.name, mimeType = _a.mimeType;",
      "47:             if (stream instanceof stream_1.Readable) {",
      "48:                 this.data = stream;",
      "51:                     this.name = (0, path_1.basename)(stream.path);",
      "52:                 }",
      "53:             }",
      "54:             else if (data instanceof Buffer) {",
      "",
      "[Removed Lines]",
      "42: var fs_1 = require(\"fs\");",
      "49:                 if (stream instanceof fs_1.ReadStream) {",
      "",
      "[Added Lines]",
      "38: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "39:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "40: };",
      "44: var fs_1 = __importDefault(require(\"fs\"));",
      "51:                 if (stream instanceof fs_1.default.ReadStream) {",
      "54:                     this.contentLength = fs_1.default.statSync(stream.path).size;",
      "",
      "---------------"
    ],
    "lib/node/index.js||lib/node/index.js": [
      "File: lib/node/index.js -> lib/node/index.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "17: var __importDefault = (this && this.__importDefault) || function (mod) {",
      "18:     return (mod && mod.__esModule) ? mod : { \"default\": mod };",
      "19: };",
      "20: var cbor_sync_1 = __importDefault(require(\"cbor-sync\"));",
      "21: var pubnub_common_1 = __importDefault(require(\"../core/pubnub-common\"));",
      "22: var networking_1 = __importDefault(require(\"../networking\"));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "20: var _a;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "26: var node_1 = require(\"../networking/modules/node\");",
      "27: var node_2 = __importDefault(require(\"../crypto/modules/node\"));",
      "28: var node_3 = __importDefault(require(\"../file/modules/node\"));",
      "49:         }",
      "",
      "[Removed Lines]",
      "29: module.exports = /** @class */ (function (_super) {",
      "30:     __extends(class_1, _super);",
      "31:     function class_1(setup) {",
      "32:         var _this = this;",
      "33:         setup.cbor = new common_1.default(function (buffer) { return cbor_sync_1.default.decode(Buffer.from(buffer)); }, base64_codec_1.decode);",
      "34:         setup.networking = new networking_1.default({",
      "35:             keepAlive: node_1.keepAlive,",
      "36:             del: web_node_1.del,",
      "37:             get: web_node_1.get,",
      "38:             post: web_node_1.post,",
      "39:             patch: web_node_1.patch,",
      "40:             proxy: node_1.proxy,",
      "41:             getfile: web_node_1.getfile,",
      "42:             postfile: web_node_1.postfile,",
      "43:         });",
      "44:         setup.sdkFamily = 'Nodejs';",
      "45:         setup.PubNubFile = node_3.default;",
      "46:         setup.cryptography = new node_2.default();",
      "47:         if (!('ssl' in setup)) {",
      "48:             setup.ssl = true;",
      "50:         _this = _super.call(this, setup) || this;",
      "51:         return _this;",
      "52:     }",
      "53:     return class_1;",
      "54: }(pubnub_common_1.default));",
      "",
      "[Added Lines]",
      "30: var nodeCryptoModule_1 = require(\"../crypto/modules/NodeCryptoModule/nodeCryptoModule\");",
      "31: module.exports = (_a = /** @class */ (function (_super) {",
      "32:         __extends(class_1, _super);",
      "33:         function class_1(setup) {",
      "34:             var _this = this;",
      "35:             setup.cbor = new common_1.default(function (buffer) { return cbor_sync_1.default.decode(Buffer.from(buffer)); }, base64_codec_1.decode);",
      "36:             setup.networking = new networking_1.default({",
      "37:                 keepAlive: node_1.keepAlive,",
      "38:                 del: web_node_1.del,",
      "39:                 get: web_node_1.get,",
      "40:                 post: web_node_1.post,",
      "41:                 patch: web_node_1.patch,",
      "42:                 proxy: node_1.proxy,",
      "43:                 getfile: web_node_1.getfile,",
      "44:                 postfile: web_node_1.postfile,",
      "45:             });",
      "46:             setup.sdkFamily = 'Nodejs';",
      "47:             setup.PubNubFile = node_3.default;",
      "48:             setup.cryptography = new node_2.default();",
      "49:             setup.initCryptoModule = function (cryptoConfiguration) {",
      "50:                 return new nodeCryptoModule_1.CryptoModule({",
      "51:                     default: new nodeCryptoModule_1.LegacyCryptor({",
      "52:                         cipherKey: cryptoConfiguration.cipherKey,",
      "53:                         useRandomIVs: cryptoConfiguration.useRandomIVs,",
      "54:                     }),",
      "55:                     cryptors: [new nodeCryptoModule_1.AesCbcCryptor({ cipherKey: cryptoConfiguration.cipherKey })],",
      "56:                 });",
      "57:             };",
      "58:             if (!('ssl' in setup)) {",
      "59:                 setup.ssl = true;",
      "60:             }",
      "61:             _this = _super.call(this, setup) || this;",
      "62:             return _this;",
      "64:         return class_1;",
      "65:     }(pubnub_common_1.default)),",
      "66:     _a.CryptoModule = nodeCryptoModule_1.CryptoModule,",
      "67:     _a);",
      "",
      "---------------"
    ],
    "lib/web/index.js||lib/web/index.js": [
      "File: lib/web/index.js -> lib/web/index.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "29: var web_node_1 = require(\"../networking/modules/web-node\");",
      "30: var web_1 = __importDefault(require(\"../crypto/modules/web\"));",
      "31: var web_2 = __importDefault(require(\"../file/modules/web\"));",
      "32: function sendBeacon(url) {",
      "33:     if (navigator && navigator.sendBeacon) {",
      "34:         navigator.sendBeacon(url);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32: var webCryptoModule_1 = require(\"../crypto/modules/WebCryptoModule/webCryptoModule\");",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "56:         setup.cbor = new common_1.default(function (arrayBuffer) { return (0, stringify_buffer_keys_1.stringifyBufferKeys)(cbor_js_1.default.decode(arrayBuffer)); }, base64_codec_1.decode);",
      "57:         setup.PubNubFile = web_2.default;",
      "58:         setup.cryptography = new web_1.default();",
      "59:         _this = _super.call(this, setup) || this;",
      "60:         if (listenToBrowserNetworkEvents) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "60:         setup.initCryptoModule = function (cryptoConfiguration) {",
      "61:             return new webCryptoModule_1.CryptoModule({",
      "62:                 default: new webCryptoModule_1.LegacyCryptor({",
      "63:                     cipherKey: cryptoConfiguration.cipherKey,",
      "64:                     useRandomIVs: cryptoConfiguration.useRandomIVs,",
      "65:                 }),",
      "66:                 cryptors: [new webCryptoModule_1.AesCbcCryptor({ cipherKey: cryptoConfiguration.cipherKey })],",
      "67:             });",
      "68:         };",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "68:         }",
      "69:         return _this;",
      "70:     }",
      "71:     return default_1;",
      "72: }(pubnub_common_1.default));",
      "73: exports.default = default_1;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "81:     default_1.CryptoModule = webCryptoModule_1.CryptoModule;",
      "",
      "---------------"
    ],
    "src/core/components/base64_codec.ts||src/core/components/base64_codec.ts": [
      "File: src/core/components/base64_codec.ts -> src/core/components/base64_codec.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "54:   return data;",
      "55: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "57: export function encode(input: ArrayBuffer): string {",
      "58:   let base64 = '';",
      "59:   const encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';",
      "61:   const bytes = new Uint8Array(input);",
      "62:   const byteLength = bytes.byteLength;",
      "63:   const byteRemainder = byteLength % 3;",
      "64:   const mainLength = byteLength - byteRemainder;",
      "66:   let a, b, c, d;",
      "67:   let chunk;",
      "70:   for (let i = 0; i < mainLength; i = i + 3) {",
      "72:     chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];",
      "75:     a = (chunk & 16515072) >> 18; // 16515072 = (2^6 - 1) << 18",
      "76:     b = (chunk & 258048) >> 12; // 258048   = (2^6 - 1) << 12",
      "77:     c = (chunk & 4032) >> 6; // 4032     = (2^6 - 1) << 6",
      "78:     d = chunk & 63; // 63       = 2^6 - 1",
      "81:     base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];",
      "82:   }",
      "85:   if (byteRemainder == 1) {",
      "86:     chunk = bytes[mainLength];",
      "88:     a = (chunk & 252) >> 2; // 252 = (2^6 - 1) << 2",
      "91:     b = (chunk & 3) << 4; // 3   = 2^2 - 1",
      "93:     base64 += encodings[a] + encodings[b] + '==';",
      "94:   } else if (byteRemainder == 2) {",
      "95:     chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];",
      "97:     a = (chunk & 64512) >> 10; // 64512 = (2^6 - 1) << 10",
      "98:     b = (chunk & 1008) >> 4; // 1008  = (2^6 - 1) << 4",
      "101:     c = (chunk & 15) << 2; // 15    = 2^4 - 1",
      "103:     base64 += encodings[a] + encodings[b] + encodings[c] + '=';",
      "104:   }",
      "106:   return base64;",
      "107: }",
      "",
      "---------------"
    ],
    "src/core/components/config.js||src/core/components/config.js": [
      "File: src/core/components/config.js -> src/core/components/config.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "129:   maximumCacheSize;",
      "134:   customEncrypt; // function to support custome encryption of messages",
      "",
      "[Removed Lines]",
      "132:     support customp encryption and decryption functions.",
      "",
      "[Added Lines]",
      "132:     support custom encryption and decryption functions.",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "142:   useRandomIVs;",
      "143:   enableSubscribeBeta;",
      "145:   constructor({ setup }) {",
      "146:     this._PNSDKSuffix = {};",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "146:     set cryptoModule to encrypt/decrypt messages and files.",
      "148:   cryptoModule;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "153:     this.sdkFamily = setup.sdkFamily;",
      "154:     this.partnerId = setup.partnerId;",
      "155:     this.setAuthKey(setup.authKey);",
      "158:     this.setFilterExpression(setup.filterExpression);",
      "",
      "[Removed Lines]",
      "156:     this.setCipherKey(setup.cipherKey);",
      "",
      "[Added Lines]",
      "161:     this.cryptoModule = setup.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "228:       this.setUUID(setup.uuid);",
      "229:     }",
      "230:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "235:     this.setCipherKey(setup.cipherKey, setup);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "239:     return this;",
      "240:   }",
      "243:     this.cipherKey = val;",
      "244:     return this;",
      "245:   }",
      "",
      "[Removed Lines]",
      "242:   setCipherKey(val) {",
      "",
      "[Added Lines]",
      "248:   setCipherKey(val, setup, modules) {",
      "250:     if (this.cipherKey) {",
      "251:       this.cryptoModule =",
      "252:         setup.cryptoModule ?? setup.initCryptoModule({ cipherKey: this.cipherKey, useRandomIVs: this.useRandomIVs });",
      "253:       if (modules) modules.cryptoModule = this.cryptoModule;",
      "254:     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "339:   }",
      "341:   getVersion() {",
      "343:   }",
      "345:   _addPnsdkSuffix(name, suffix) {",
      "",
      "[Removed Lines]",
      "342:     return '7.3.3';",
      "",
      "[Added Lines]",
      "353:     return '7.4.0';",
      "",
      "---------------"
    ],
    "src/core/components/cryptography/index.js||src/core/components/cryptography/index.js": [
      "File: src/core/components/cryptography/index.js -> src/core/components/cryptography/index.js"
    ],
    "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js": [
      "File: src/core/components/subscription_manager.js -> src/core/components/subscription_manager.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "58:   _pendingChannelGroupSubscriptions;",
      "61:   _dedupingManager;",
      "63:   constructor({",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61:   _cryptoModule;",
      "63:   _decoder;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "70:     config,",
      "71:     crypto,",
      "72:     listenerManager,",
      "73:   }) {",
      "74:     this._listenerManager = listenerManager;",
      "75:     this._config = config;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "77:     cryptoModule,",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "81:     this._getFileUrl = getFileUrl;",
      "83:     this._crypto = crypto;",
      "85:     this._channels = {};",
      "86:     this._presenceChannels = {};",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "89:     this._cryptoModule = cryptoModule;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "105:     this._reconnectionManager = new ReconnectionManager({ timeEndpoint });",
      "106:     this._dedupingManager = new DedupingManager({ config });",
      "107:   }",
      "109:   adaptStateChange(args, callback) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "114:     if (this._cryptoModule) this._decoder = new TextDecoder();",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "684:         let msgPayload = message.payload;",
      "690:             msgPayload = decryptedPayload;",
      "691:           }",
      "692:         }",
      "",
      "[Removed Lines]",
      "686:         if (this._config.cipherKey) {",
      "687:           const decryptedPayload = this._crypto.decrypt(message.payload);",
      "689:           if (typeof decryptedPayload === 'object' && decryptedPayload !== null) {",
      "",
      "[Added Lines]",
      "694:         if (this._cryptoModule) {",
      "695:           let decryptedPayload;",
      "696:           try {",
      "697:             const decryptedData = this._cryptoModule.decrypt(message.payload);",
      "698:             decryptedPayload =",
      "699:               decryptedData instanceof ArrayBuffer ? JSON.parse(this._decoder.decode(decryptedData)) : decryptedData;",
      "700:           } catch (e) {",
      "701:             decryptedPayload = null;",
      "702:             if (console && console.log) {",
      "703:               console.log('decryption error', e.message);",
      "704:             }",
      "705:           }",
      "706:           if (decryptedPayload !== null) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "727:           announce.userMetadata = message.userMetadata;",
      "728:         }",
      "732:         } else {",
      "733:           announce.message = message.payload;",
      "734:         }",
      "",
      "[Removed Lines]",
      "730:         if (this._config.cipherKey) {",
      "731:           announce.message = this._crypto.decrypt(message.payload);",
      "",
      "[Added Lines]",
      "747:         if (this._cryptoModule) {",
      "748:           let decryptedPayload;",
      "749:           try {",
      "750:             const decryptedData = this._cryptoModule.decrypt(message.payload);",
      "751:             decryptedPayload =",
      "752:               decryptedData instanceof ArrayBuffer ? JSON.parse(this._decoder.decode(decryptedData)) : decryptedData;",
      "753:           } catch (e) {",
      "754:             decryptedPayload = null;",
      "756:             if (console && console.log) {",
      "757:               console.log('decryption error', e.message); //eslint-disable-line",
      "758:             }",
      "759:           }",
      "760:           if (decryptedPayload != null) {",
      "761:             announce.message = decryptedPayload;",
      "762:           } else {",
      "763:             announce.message = message.payload;",
      "764:           }",
      "",
      "---------------"
    ],
    "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js": [
      "File: src/core/endpoints/fetch_messages.js -> src/core/endpoints/fetch_messages.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: import utils from '../utils';",
      "13: function __processMessage(modules, message) {",
      "17:   try {",
      "19:   } catch (e) {",
      "20:     return message;",
      "21:   }",
      "22: }",
      "",
      "[Removed Lines]",
      "14:   const { config, crypto } = modules;",
      "15:   if (!config.cipherKey) return message;",
      "18:     return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "14:   if (!modules.cryptoModule) return message;",
      "16:     const decryptedData = modules.cryptoModule.decrypt(message);",
      "17:     const decryptedPayload =",
      "18:       decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "19:     return decryptedPayload;",
      "21:     if (console && console.log) console.log('decryption error', e.message);",
      "",
      "---------------"
    ],
    "src/core/endpoints/file_upload/download_file.js||src/core/endpoints/file_upload/download_file.js": [
      "File: src/core/endpoints/file_upload/download_file.js -> src/core/endpoints/file_upload/download_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "35:   prepareParams: () => ({}),",
      "38:     let { body } = res.response;",
      "42:     }",
      "44:     return PubNubFile.create({",
      "",
      "[Removed Lines]",
      "37:   handleResponse: async ({ PubNubFile, config, cryptography }, res, params) => {",
      "40:     if (PubNubFile.supportsEncryptFile && (params.cipherKey ?? config.cipherKey)) {",
      "41:       body = await cryptography.decrypt(params.cipherKey ?? config.cipherKey, body);",
      "",
      "[Added Lines]",
      "39:   handleResponse: async ({ PubNubFile, config, cryptography, cryptoModule }, res, params) => {",
      "41:     if (PubNubFile.supportsEncryptFile && (params.cipherKey || cryptoModule)) {",
      "42:       body =",
      "43:         params.cipherKey == null",
      "44:           ? (await cryptoModule.decryptFile(PubNubFile.create({ data: body, name: params.name }), PubNubFile)).data",
      "45:           : await cryptography.decrypt(params.cipherKey ?? config.cipherKey, body);",
      "",
      "---------------"
    ],
    "src/core/endpoints/file_upload/publish_file.js||src/core/endpoints/file_upload/publish_file.js": [
      "File: src/core/endpoints/file_upload/publish_file.js -> src/core/endpoints/file_upload/publish_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: import operationConstants from '../../constants/operations';",
      "5: import utils from '../../utils';",
      "8:   let stringifiedPayload = JSON.stringify(payload);",
      "12:     stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "13:   }",
      "15:   return stringifiedPayload || '';",
      "16: };",
      "",
      "[Removed Lines]",
      "7: const preparePayload = ({ crypto, config }, payload) => {",
      "10:   if (config.cipherKey) {",
      "11:     stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "",
      "[Added Lines]",
      "5: import { encode } from '../../components/base64_codec';",
      "7: const preparePayload = (modules, payload) => {",
      "9:   if (modules.cryptoModule) {",
      "10:     const encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "11:     stringifiedPayload = typeof encrypted === 'string' ? encrypted : encode(encrypted);",
      "",
      "---------------"
    ],
    "src/core/endpoints/file_upload/send_file.js||src/core/endpoints/file_upload/send_file.js": [
      "File: src/core/endpoints/file_upload/send_file.js -> src/core/endpoints/file_upload/send_file.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: const sendFile = function ({",
      "4:   generateUploadUrl,",
      "5:   publishFile,",
      "7: }) {",
      "8:   return async ({ channel, file: input, message, cipherKey, meta, ttl, storeInHistory }) => {",
      "9:     if (!channel) {",
      "",
      "[Removed Lines]",
      "6:   modules: { PubNubFile, config, cryptography, networking },",
      "",
      "[Added Lines]",
      "6:   modules: { PubNubFile, config, cryptography, cryptoModule, networking },",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "27:       data: { id, name },",
      "28:     } = await generateUploadUrl({ channel, name: file.name });",
      "32:     }",
      "34:     let formFieldsWithMimeType = formFields;",
      "",
      "[Removed Lines]",
      "30:     if (PubNubFile.supportsEncryptFile && (cipherKey ?? config.cipherKey)) {",
      "31:       file = await cryptography.encryptFile(cipherKey ?? config.cipherKey, file, PubNubFile);",
      "",
      "[Added Lines]",
      "30:     if (PubNubFile.supportsEncryptFile && (cipherKey || cryptoModule)) {",
      "31:       file =",
      "32:         cipherKey == null",
      "33:           ? await cryptoModule.encryptFile(file, PubNubFile)",
      "34:           : await cryptography.encryptFile(cipherKey, file, PubNubFile);",
      "",
      "---------------"
    ],
    "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js": [
      "File: src/core/endpoints/history/get_history.js -> src/core/endpoints/history/get_history.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: import utils from '../../utils';",
      "7: function __processMessage(modules, message) {",
      "11:   try {",
      "13:   } catch (e) {",
      "14:     return message;",
      "15:   }",
      "16: }",
      "",
      "[Removed Lines]",
      "8:   const { config, crypto } = modules;",
      "9:   if (!config.cipherKey) return message;",
      "12:     return crypto.decrypt(message);",
      "",
      "[Added Lines]",
      "8:   if (!modules.cryptoModule) return message;",
      "10:     const decryptedData = modules.cryptoModule.decrypt(message);",
      "11:     const decryptedPayload =",
      "12:       decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
      "13:     return decryptedPayload;",
      "15:     if (console && console.log) console.log('decryption error', e.message);",
      "",
      "---------------"
    ],
    "src/core/endpoints/publish.js||src/core/endpoints/publish.js": [
      "File: src/core/endpoints/publish.js -> src/core/endpoints/publish.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: import { PublishResponse, PublishArguments, ModulesInject } from '../flow_interfaces';",
      "4: import operationConstants from '../constants/operations';",
      "5: import utils from '../utils';",
      "7: function prepareMessagePayload(modules, messagePayload) {",
      "9:   let stringifiedPayload = JSON.stringify(messagePayload);",
      "13:     stringifiedPayload = JSON.stringify(stringifiedPayload);",
      "14:   }",
      "17: }",
      "19: export function getOperation() {",
      "",
      "[Removed Lines]",
      "8:   const { crypto, config } = modules;",
      "11:   if (config.cipherKey) {",
      "12:     stringifiedPayload = crypto.encrypt(stringifiedPayload);",
      "16:   return stringifiedPayload;",
      "",
      "[Added Lines]",
      "6: import { encode } from '../components/base64_codec';",
      "11:   if (modules.cryptoModule) {",
      "12:     const encrypted = modules.cryptoModule.encrypt(stringifiedPayload);",
      "13:     stringifiedPayload = typeof encrypted === 'string' ? encrypted : encode(encrypted);",
      "16:   return stringifiedPayload || '';",
      "",
      "---------------"
    ],
    "src/core/pubnub-common.js||src/core/pubnub-common.js": [
      "File: src/core/pubnub-common.js -> src/core/pubnub-common.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: import Config from './components/config';",
      "2: import Crypto from './components/cryptography/index';",
      "3: import SubscriptionManager from './components/subscription_manager';",
      "4: import TelemetryManager from './components/telemetry_manager';",
      "5: import NotificationsPayload from './components/push_payload';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: import { encode } from './components/base64_codec';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "291:     });",
      "293:     this._telemetryManager = telemetryManager;",
      "295:     const modules = {",
      "296:       config,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "295:     const cryptoModule = this._config.cryptoModule;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "300:       tokenManager,",
      "301:       telemetryManager,",
      "302:       PubNubFile: setup.PubNubFile,",
      "303:     };",
      "305:     this.File = setup.PubNubFile;",
      "310:     const timeEndpoint = endpointCreator.bind(this, modules, timeEndpointConfig);",
      "311:     const leaveEndpoint = endpointCreator.bind(this, modules, presenceLeaveEndpointConfig);",
      "",
      "[Removed Lines]",
      "307:     this.encryptFile = (key, file) => cryptography.encryptFile(key, file, this.File);",
      "308:     this.decryptFile = (key, file) => cryptography.decryptFile(key, file, this.File);",
      "",
      "[Added Lines]",
      "305:       cryptoModule: cryptoModule,",
      "310:     this.encryptFile = function (key, file) {",
      "311:       if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "312:         file = key;",
      "313:         return modules.cryptoModule.encryptFile(file, this.File);",
      "314:       }",
      "315:       return cryptography.encryptFile(key, file, this.File);",
      "316:     };",
      "317:     this.decryptFile = function (key, file) {",
      "318:       if (arguments.length == 1 && typeof key != 'string' && modules.cryptoModule) {",
      "319:         file = key;",
      "320:         return modules.cryptoModule.decryptFile(file, this.File);",
      "321:       }",
      "322:       return cryptography.decryptFile(key, file, this.File);",
      "323:     };",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "341:         config: modules.config,",
      "342:         listenerManager,",
      "343:         getFileUrl: (params) => getFileUrlFunction(modules, params),",
      "344:       });",
      "346:       this.subscribe = subscriptionManager.adaptSubscribeChange.bind(subscriptionManager);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "359:         cryptoModule: modules.cryptoModule,",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "671:     this.getAuthKey = modules.config.getAuthKey.bind(modules.config);",
      "672:     this.setAuthKey = modules.config.setAuthKey.bind(modules.config);",
      "674:     this.getUUID = modules.config.getUUID.bind(modules.config);",
      "675:     this.setUUID = modules.config.setUUID.bind(modules.config);",
      "676:     this.getUserId = modules.config.getUserId.bind(modules.config);",
      "677:     this.setUserId = modules.config.setUserId.bind(modules.config);",
      "678:     this.getFilterExpression = modules.config.getFilterExpression.bind(modules.config);",
      "679:     this.setFilterExpression = modules.config.setFilterExpression.bind(modules.config);",
      "681:     this.setHeartbeatInterval = modules.config.setHeartbeatInterval.bind(modules.config);",
      "683:     if (networking.hasModule('proxy')) {",
      "",
      "[Removed Lines]",
      "667:     this.encrypt = crypto.encrypt.bind(crypto);",
      "668:     this.decrypt = crypto.decrypt.bind(crypto);",
      "673:     this.setCipherKey = modules.config.setCipherKey.bind(modules.config);",
      "",
      "[Added Lines]",
      "683:     this.encrypt = function (data, key) {",
      "684:       if (typeof key === 'undefined' && modules.cryptoModule) {",
      "685:         const encrypted = modules.cryptoModule.encrypt(data);",
      "686:         return typeof encrypted === 'string' ? encrypted : encode(encrypted);",
      "687:       } else {",
      "688:         return crypto.encrypt(data, key);",
      "689:       }",
      "690:     };",
      "691:     this.decrypt = function (data, key) {",
      "692:       if (typeof key === 'undefined' && cryptoModule) {",
      "693:         const decrypted = modules.cryptoModule.decrypt(data);",
      "694:         return decrypted instanceof ArrayBuffer ? encode(decrypted) : decrypted;",
      "695:       } else {",
      "696:         return crypto.decrypt(data, key);",
      "697:       }",
      "698:     };",
      "710:     this.setCipherKey = (key) => modules.config.setCipherKey(key, setup, modules);",
      "",
      "---------------"
    ],
    "src/core/utils.js||src/core/utils.js": [
      "File: src/core/utils.js -> src/core/utils.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "32:   return { promise, reject: failureResolve, fulfill: successResolve };",
      "33: }",
      "35: module.exports = {",
      "36:   signPamFromParams,",
      "37:   endsWith,",
      "38:   createPromise,",
      "39:   encodeString,",
      "40: };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "35: function stringToArrayBuffer(str) {",
      "36:   var buf = new ArrayBuffer(str.length * 2);",
      "37:   var bufView = new Uint16Array(buf);",
      "38:   for (var i = 0, strLen = str.length; i < strLen; i++) {",
      "39:     bufView[i] = str.charCodeAt(i);",
      "40:   }",
      "41:   return buf;",
      "42: }",
      "49:   stringToArrayBuffer,",
      "",
      "---------------"
    ],
    "src/crypto/modules/NodeCryptoModule/ICryptor.ts||src/crypto/modules/NodeCryptoModule/ICryptor.ts": [
      "File: src/crypto/modules/NodeCryptoModule/ICryptor.ts -> src/crypto/modules/NodeCryptoModule/ICryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: export type EncryptedDataType = {",
      "2:   data: Buffer | string;",
      "3:   metadata: Buffer | null;",
      "4: };",
      "6: export type EncryptedStream = {",
      "7:   stream: NodeJS.ReadableStream;",
      "8:   metadataLength: number;",
      "9:   metadata?: Buffer | undefined;",
      "10: };",
      "12: export interface ICryptor {",
      "13:   get identifier(): string;",
      "14:   encrypt(data: BufferSource | string): EncryptedDataType;",
      "15:   decrypt(data: EncryptedDataType): ArrayBuffer;",
      "17:   encryptStream(stream: NodeJS.ReadableStream): Promise<EncryptedStream>;",
      "18:   decryptStream(encryptedStream: EncryptedStream): Promise<NodeJS.ReadableStream>;",
      "19: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts||src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts": [
      "File: src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts -> src/crypto/modules/NodeCryptoModule/ILegacyCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { EncryptedDataType } from './ICryptor';",
      "3: export type PubNubFileType = {",
      "4:   stream: NodeJS.ReadStream;",
      "5:   data: NodeJS.ReadStream | Buffer;",
      "6:   name: string;",
      "7:   mimeType: string;",
      "8:   contentLength: number;",
      "10:   create(config: any): PubNubFileType;",
      "12:   toBuffer(): Buffer;",
      "13:   toArrayBuffer(): ArrayBuffer;",
      "14:   toString(): string;",
      "15:   toStream(): NodeJS.ReadStream;",
      "16: };",
      "18: export interface ILegacyCryptor<T extends PubNubFileType> {",
      "19:   get identifier(): string;",
      "21:   encrypt(data: string | ArrayBuffer): EncryptedDataType;",
      "22:   decrypt(data: EncryptedDataType): BufferSource | string;",
      "24:   encryptFile(file: T, File: T): Promise<T>;",
      "25:   decryptFile(file: T, File: T): Promise<T>;",
      "26: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts||src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts": [
      "File: src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts -> src/crypto/modules/NodeCryptoModule/aesCbcCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { PassThrough } from 'stream';",
      "2: import { createCipheriv, createDecipheriv, createHash, randomBytes } from 'crypto';",
      "3: import { ICryptor, EncryptedDataType, EncryptedStream } from './ICryptor';",
      "5: export default class AesCbcCryptor implements ICryptor {",
      "6:   static BLOCK_SIZE = 16;",
      "8:   cipherKey: string;",
      "9:   constructor(configuration: { cipherKey: string }) {",
      "10:     this.cipherKey = configuration.cipherKey;",
      "11:   }",
      "13:   get algo() {",
      "14:     return 'aes-256-cbc';",
      "15:   }",
      "17:   get identifier() {",
      "18:     return 'ACRH';",
      "19:   }",
      "21:   getIv() {",
      "22:     return randomBytes(AesCbcCryptor.BLOCK_SIZE);",
      "23:   }",
      "25:   getKey() {",
      "26:     const sha = createHash('sha256');",
      "27:     sha.update(Buffer.from(this.cipherKey, 'utf8'));",
      "28:     return Buffer.from(sha.digest());",
      "29:   }",
      "31:   encrypt(data: ArrayBuffer | string) {",
      "32:     const iv = this.getIv();",
      "33:     const key = this.getKey();",
      "34:     const plainData = typeof data === 'string' ? new TextEncoder().encode(data) : data;",
      "35:     const bPlain = Buffer.from(plainData);",
      "36:     if (bPlain.byteLength === 0) throw new Error('encryption error. empty content');",
      "37:     const aes = createCipheriv(this.algo, key, iv);",
      "39:     return {",
      "40:       metadata: iv,",
      "41:       data: Buffer.concat([aes.update(bPlain), aes.final()]),",
      "42:     };",
      "43:   }",
      "45:   decrypt(encryptedData: EncryptedDataType) {",
      "46:     const data =",
      "47:       typeof encryptedData.data === 'string' ? new TextEncoder().encode(encryptedData.data) : encryptedData.data;",
      "48:     if (data.byteLength <= 0) throw new Error('decryption error: empty content');",
      "49:     const aes = createDecipheriv(this.algo, this.getKey(), encryptedData.metadata);",
      "50:     return Uint8Array.from(Buffer.concat([aes.update(data), aes.final()])).buffer;",
      "51:   }",
      "53:   async encryptStream(stream: NodeJS.ReadableStream) {",
      "54:     const output = new PassThrough();",
      "55:     const bIv = this.getIv();",
      "56:     if (stream.readable === false) throw new Error('encryption error. empty stream');",
      "57:     const aes = createCipheriv(this.algo, this.getKey(), bIv);",
      "58:     stream.pipe(aes).pipe(output);",
      "59:     return {",
      "60:       stream: output,",
      "61:       metadata: bIv,",
      "62:       metadataLength: AesCbcCryptor.BLOCK_SIZE,",
      "63:     };",
      "64:   }",
      "66:   async decryptStream(encryptedStream: EncryptedStream) {",
      "67:     const decryptedStream = new PassThrough();",
      "68:     let bIv = Buffer.alloc(0);",
      "69:     let aes: any = null;",
      "70:     const onReadable = () => {",
      "71:       let data = encryptedStream.stream.read();",
      "72:       while (data !== null) {",
      "73:         if (data) {",
      "74:           const bChunk = Buffer.from(data);",
      "75:           const sliceLen = encryptedStream.metadataLength - bIv.byteLength;",
      "76:           if (bChunk.byteLength < sliceLen) {",
      "77:             bIv = Buffer.concat([bIv, bChunk]);",
      "78:           } else {",
      "79:             bIv = Buffer.concat([bIv, bChunk.slice(0, sliceLen)]);",
      "80:             aes = createDecipheriv(this.algo, this.getKey(), bIv);",
      "81:             aes.pipe(decryptedStream);",
      "82:             aes.write(bChunk.slice(sliceLen));",
      "83:           }",
      "84:         }",
      "85:         data = encryptedStream.stream.read();",
      "86:       }",
      "87:     };",
      "88:     encryptedStream.stream.on('readable', onReadable);",
      "89:     encryptedStream.stream.on('end', () => {",
      "90:       if (aes) {",
      "91:         aes.end();",
      "92:       }",
      "93:       decryptedStream.end();",
      "94:     });",
      "95:     return decryptedStream;",
      "96:   }",
      "97: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/NodeCryptoModule/legacyCryptor.ts||src/crypto/modules/NodeCryptoModule/legacyCryptor.ts": [
      "File: src/crypto/modules/NodeCryptoModule/legacyCryptor.ts -> src/crypto/modules/NodeCryptoModule/legacyCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import Crypto from '../../../core/components/cryptography/index';",
      "2: import { encode } from '../../../core/components/base64_codec';",
      "3: import FileCryptor from '../node';",
      "4: import { EncryptedDataType } from './ICryptor';",
      "5: import { ILegacyCryptor, PubNubFileType } from './ILegacyCryptor';",
      "7: export default class LegacyCryptor implements ILegacyCryptor<PubNubFileType> {",
      "8:   config;",
      "10:   cryptor;",
      "11:   fileCryptor;",
      "13:   constructor(config: any) {",
      "14:     this.config = config;",
      "15:     this.cryptor = new Crypto({ config });",
      "16:     this.fileCryptor = new FileCryptor();",
      "17:   }",
      "18:   get identifier() {",
      "19:     return '';",
      "20:   }",
      "21:   encrypt(data: string) {",
      "22:     if (data.length === 0) throw new Error('encryption error. empty content');",
      "23:     return {",
      "24:       data: this.cryptor.encrypt(data),",
      "25:       metadata: null,",
      "26:     };",
      "27:   }",
      "29:   decrypt(encryptedData: EncryptedDataType) {",
      "30:     const data = typeof encryptedData.data === 'string' ? encryptedData.data : encode(encryptedData.data);",
      "31:     return this.cryptor.decrypt(data);",
      "32:   }",
      "34:   async encryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "35:     return this.fileCryptor.encryptFile(this.config.cipherKey, file, File);",
      "36:   }",
      "38:   async decryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "39:     return this.fileCryptor.decryptFile(this.config.cipherKey, file, File);",
      "40:   }",
      "41: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts||src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts": [
      "File: src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts -> src/crypto/modules/NodeCryptoModule/nodeCryptoModule.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { Readable, PassThrough } from 'stream';",
      "2: import { decode } from '../../../core/components/base64_codec';",
      "3: import LegacyCryptor from './legacyCryptor';",
      "4: import AesCbcCryptor from './aesCbcCryptor';",
      "5: import { ICryptor } from './ICryptor';",
      "6: import { ILegacyCryptor, PubNubFileType } from './ILegacyCryptor';",
      "8: export { LegacyCryptor, AesCbcCryptor };",
      "10: type CryptorType = ICryptor | ILegacyCryptor<PubNubFileType>;",
      "12: type CryptoModuleConfiguration = {",
      "13:   default: CryptorType;",
      "14:   cryptors?: Array<CryptorType>;",
      "15: };",
      "17: export class CryptoModule {",
      "18:   static LEGACY_IDENTIFIER = '';",
      "20:   defaultCryptor: CryptorType;",
      "21:   cryptors: Array<CryptorType>;",
      "23:   constructor(cryptoModuleConfiguration: CryptoModuleConfiguration) {",
      "24:     this.defaultCryptor = cryptoModuleConfiguration.default;",
      "25:     this.cryptors = cryptoModuleConfiguration.cryptors ?? [];",
      "26:   }",
      "30:   static legacyCryptoModule(config) {",
      "31:     return new this({",
      "32:       default: new LegacyCryptor({",
      "33:         cipherKey: config.cipherKey,",
      "34:         useRandomIVs: config.useRandomIVs ?? true,",
      "35:       }),",
      "36:       cryptors: [new AesCbcCryptor({ cipherKey: config.cipherKey })],",
      "37:     });",
      "38:   }",
      "40:   static aesCbcCryptoModule(config: any) {",
      "41:     return new this({",
      "42:       default: new AesCbcCryptor({ cipherKey: config.cipherKey }),",
      "43:       cryptors: [",
      "44:         new LegacyCryptor({",
      "45:           cipherKey: config.cipherKey,",
      "46:           useRandomIVs: config.useRandomIVs ?? true,",
      "47:         }),",
      "48:       ],",
      "49:     });",
      "50:   }",
      "51:   static withDefaultCryptor(defaultCryptor: CryptorType) {",
      "52:     return new this({ default: defaultCryptor });",
      "53:   }",
      "55:   private getAllCryptors() {",
      "56:     return [this.defaultCryptor, ...this.cryptors];",
      "57:   }",
      "59:   private getLegacyCryptor() {",
      "60:     return this.getAllCryptors().find((c) => c.identifier === '');",
      "61:   }",
      "63:   encrypt(data: ArrayBuffer | string) {",
      "64:     const encrypted = this.defaultCryptor.encrypt(data);",
      "65:     if (!encrypted.metadata) return encrypted.data;",
      "67:     const header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "69:     const headerData = new Uint8Array(header!.length);",
      "70:     let pos = 0;",
      "71:     headerData.set(header!.data, pos);",
      "72:     pos = header!.length - encrypted.metadata.length;",
      "73:     headerData.set(encrypted.metadata, pos);",
      "74:     return Buffer.concat([headerData, Buffer.from(encrypted.data)]);",
      "75:   }",
      "77:   decrypt(data: ArrayBuffer | string) {",
      "78:     const encryptedData = Buffer.from(typeof data === 'string' ? decode(data) : data);",
      "79:     const header = CryptorHeader.tryParse(encryptedData);",
      "80:     const cryptor = this.getCryptor(header);",
      "81:     const metadata =",
      "82:       header.length > 0",
      "83:         ? encryptedData.slice(header.length - (header as CryptorHeaderV1).metadataLength, header.length)",
      "84:         : null;",
      "85:     if (encryptedData.slice(header.length).byteLength <= 0) throw new Error('decryption error. empty content');",
      "86:     return cryptor!.decrypt({",
      "87:       data: encryptedData.slice(header.length),",
      "88:       metadata: metadata,",
      "89:     });",
      "90:   }",
      "92:   async encryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "97:     if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "98:       return (this.defaultCryptor as ILegacyCryptor<PubNubFileType>).encryptFile(file, File);",
      "99:     if (file.data instanceof Buffer) {",
      "100:       return File.create({",
      "101:         name: file.name,",
      "102:         mimeType: 'application/octet-stream',",
      "103:         data: Buffer.from(this.encrypt(file.data!) as Buffer),",
      "104:       });",
      "105:     }",
      "106:     if (file.data instanceof Readable) {",
      "107:       if (file.contentLength === 0) throw new Error('encryption error. empty content');",
      "108:       const encryptedStream = await (this.defaultCryptor as ICryptor).encryptStream(file.data);",
      "109:       const header = CryptorHeader.from(this.defaultCryptor.identifier, encryptedStream.metadata!);",
      "110:       const payload = new Uint8Array(header!.length);",
      "111:       let pos = 0;",
      "112:       payload.set(header!.data, pos);",
      "113:       pos += header!.length;",
      "114:       if (encryptedStream.metadata) {",
      "115:         pos -= encryptedStream.metadata.length;",
      "116:         payload.set(encryptedStream.metadata, pos);",
      "117:       }",
      "118:       const output = new PassThrough();",
      "119:       output.write(payload);",
      "120:       encryptedStream.stream.pipe(output);",
      "121:       return File.create({",
      "122:         name: file.name,",
      "123:         mimeType: 'application/octet-stream',",
      "124:         stream: output,",
      "125:       });",
      "126:     }",
      "127:   }",
      "129:   async decryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "130:     if (file?.data instanceof Buffer) {",
      "131:       const header = CryptorHeader.tryParse(file.data);",
      "132:       const cryptor = this.getCryptor(header);",
      "137:       if (cryptor?.identifier === CryptoModule.LEGACY_IDENTIFIER)",
      "138:         return (cryptor as ILegacyCryptor<PubNubFileType>).decryptFile(file, File);",
      "139:       return File.create({",
      "140:         name: file.name,",
      "141:         data: Buffer.from(this.decrypt(file?.data) as ArrayBuffer),",
      "142:       });",
      "143:     }",
      "145:     if (file.data instanceof Readable) {",
      "146:       const stream = file.data;",
      "147:       return new Promise((resolve) => {",
      "148:         stream.on('readable', () => resolve(this.onStreamReadable(stream, file, File)));",
      "149:       });",
      "150:     }",
      "151:   }",
      "153:   private async onStreamReadable(stream: NodeJS.ReadableStream, file: PubNubFileType, File: PubNubFileType) {",
      "154:     stream.removeAllListeners('readable');",
      "155:     const magicBytes = stream.read(4);",
      "156:     if (!CryptorHeader.isSentinel(magicBytes as Buffer)) {",
      "157:       if (magicBytes === null) throw new Error('decryption error. empty content');",
      "158:       stream.unshift(magicBytes);",
      "159:       return this.decryptLegacyFileStream(stream, file, File);",
      "160:     }",
      "161:     const versionByte = stream.read(1);",
      "162:     CryptorHeader.validateVersion(versionByte[0] as number);",
      "163:     const identifier = stream.read(4);",
      "164:     const cryptor = this.getCryptorFromId(CryptorHeader.tryGetIdentifier(identifier as Buffer));",
      "165:     const headerSize = CryptorHeader.tryGetMetadataSizeFromStream(stream);",
      "166:     if (file.contentLength <= CryptorHeader.MIN_HEADER_LEGTH + headerSize)",
      "167:       throw new Error('decryption error. empty content');",
      "168:     return File.create({",
      "169:       name: file.name,",
      "170:       mimeType: 'application/octet-stream',",
      "171:       stream: await (cryptor as ICryptor).decryptStream({ stream: stream, metadataLength: headerSize as number }),",
      "172:     });",
      "173:   }",
      "175:   private async decryptLegacyFileStream(stream: NodeJS.ReadableStream, file: PubNubFileType, File: PubNubFileType) {",
      "176:     if (file.contentLength <= 16) throw new Error('decryption error: empty content');",
      "177:     const cryptor = this.getLegacyCryptor();",
      "178:     if (cryptor) {",
      "179:       return (cryptor as ILegacyCryptor<PubNubFileType>).decryptFile(",
      "180:         File.create({",
      "181:           name: file.name,",
      "182:           stream: stream,",
      "183:         }),",
      "184:         File,",
      "185:       );",
      "186:     } else {",
      "187:       throw new Error('unknown cryptor error');",
      "188:     }",
      "189:   }",
      "191:   private getCryptor(header: CryptorHeader) {",
      "192:     if (header === '') {",
      "193:       const cryptor = this.getAllCryptors().find((c) => c.identifier === '');",
      "194:       if (cryptor) return cryptor;",
      "195:       throw new Error('unknown cryptor error');",
      "196:     } else if (header instanceof CryptorHeaderV1) {",
      "197:       return this.getCryptorFromId(header.identifier);",
      "198:     }",
      "199:   }",
      "201:   private getCryptorFromId(id: string) {",
      "202:     const cryptor = this.getAllCryptors().find((c) => id === c.identifier);",
      "203:     if (cryptor) {",
      "204:       return cryptor;",
      "205:     }",
      "206:     throw new Error('unknown cryptor error');",
      "207:   }",
      "208: }",
      "211: class CryptorHeader {",
      "212:   static SENTINEL = 'PNED';",
      "213:   static LEGACY_IDENTIFIER = '';",
      "214:   static IDENTIFIER_LENGTH = 4;",
      "215:   static VERSION = 1;",
      "216:   static MAX_VERSION = 1;",
      "217:   static MIN_HEADER_LEGTH = 10;",
      "219:   static from(id: string, metadata: Buffer) {",
      "220:     if (id === CryptorHeader.LEGACY_IDENTIFIER) return;",
      "221:     return new CryptorHeaderV1(id, metadata.length);",
      "222:   }",
      "224:   static isSentinel(bytes: Buffer) {",
      "225:     if (bytes && bytes.byteLength >= 4) {",
      "226:       if (bytes.toString('utf8') == CryptorHeader.SENTINEL) return true;",
      "227:     }",
      "228:   }",
      "230:   static validateVersion(data: number) {",
      "231:     if (data && data > CryptorHeader.MAX_VERSION) throw new Error('decryption error. invalid header version');",
      "232:     return data;",
      "233:   }",
      "235:   static tryGetIdentifier(data: Buffer) {",
      "236:     if (data.byteLength < 4) {",
      "237:       throw new Error('unknown cryptor error. decryption failed');",
      "238:     } else {",
      "239:       return data.toString('utf8');",
      "240:     }",
      "241:   }",
      "243:   static tryGetMetadataSizeFromStream(stream: NodeJS.ReadableStream) {",
      "244:     const sizeBuf = stream.read(1);",
      "245:     if (sizeBuf && (sizeBuf[0] as number) < 255) {",
      "246:       return sizeBuf[0] as number;",
      "247:     }",
      "248:     if ((sizeBuf[0] as number) === 255) {",
      "249:       const nextBuf = stream.read(2);",
      "250:       if (nextBuf.length >= 2) {",
      "251:         return new Uint16Array([nextBuf[0] as number, nextBuf[1] as number]).reduce((acc, val) => (acc << 8) + val, 0);",
      "252:       }",
      "253:     }",
      "254:     throw new Error('decryption error. Invalid metadata size');",
      "255:   }",
      "256:   static tryParse(encryptedData: Buffer) {",
      "257:     let sentinel: any = '';",
      "258:     let version = null;",
      "259:     if (encryptedData.length >= 4) {",
      "260:       sentinel = encryptedData.slice(0, 4);",
      "261:       if (sentinel.toString('utf8') !== CryptorHeader.SENTINEL) return '';",
      "262:     }",
      "264:     if (encryptedData.length >= 5) {",
      "265:       version = encryptedData[4];",
      "266:     } else {",
      "267:       throw new Error('decryption error. invalid header version');",
      "268:     }",
      "269:     if (version > CryptorHeader.MAX_VERSION) throw new Error('unknown cryptor error');",
      "271:     let identifier: Buffer;",
      "272:     let pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "273:     if (encryptedData.length >= pos) {",
      "274:       identifier = encryptedData.slice(5, pos);",
      "275:     } else {",
      "276:       throw new Error('decryption error. invalid crypto identifier');",
      "277:     }",
      "278:     let metadataLength = null;",
      "279:     if (encryptedData.length >= pos + 1) {",
      "280:       metadataLength = encryptedData[pos];",
      "281:     } else {",
      "282:       throw new Error('decryption error. invalid metadata length');",
      "283:     }",
      "284:     pos += 1;",
      "285:     if (metadataLength === 255 && encryptedData.length >= pos + 2) {",
      "286:       metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce((acc, val) => (acc << 8) + val, 0);",
      "287:       pos += 2;",
      "288:     }",
      "289:     return new CryptorHeaderV1(identifier.toString('utf8'), metadataLength);",
      "290:   }",
      "291: }",
      "294: class CryptorHeaderV1 {",
      "295:   _identifier;",
      "296:   _metadataLength;",
      "298:   constructor(id: string, metadataLength: number) {",
      "299:     this._identifier = id;",
      "300:     this._metadataLength = metadataLength;",
      "301:   }",
      "303:   get identifier() {",
      "304:     return this._identifier;",
      "305:   }",
      "307:   set identifier(value) {",
      "308:     this._identifier = value;",
      "309:   }",
      "311:   get metadataLength() {",
      "312:     return this._metadataLength;",
      "313:   }",
      "315:   set metadataLength(value) {",
      "316:     this._metadataLength = value;",
      "317:   }",
      "319:   get version() {",
      "320:     return CryptorHeader.VERSION;",
      "321:   }",
      "323:   get length() {",
      "324:     return (",
      "325:       CryptorHeader.SENTINEL.length +",
      "326:       1 +",
      "327:       CryptorHeader.IDENTIFIER_LENGTH +",
      "328:       (this.metadataLength < 255 ? 1 : 3) +",
      "329:       this.metadataLength",
      "330:     );",
      "331:   }",
      "333:   get data() {",
      "334:     let pos = 0;",
      "335:     const header = new Uint8Array(this.length);",
      "336:     header.set(Buffer.from(CryptorHeader.SENTINEL));",
      "337:     pos += CryptorHeader.SENTINEL.length;",
      "338:     header[pos] = this.version;",
      "339:     pos++;",
      "340:     if (this.identifier) header.set(Buffer.from(this.identifier), pos);",
      "341:     pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "342:     const metadataLength = this.metadataLength;",
      "343:     if (metadataLength < 255) {",
      "344:       header[pos] = metadataLength;",
      "345:     } else {",
      "346:       header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "347:     }",
      "348:     return header;",
      "349:   }",
      "350: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/WebCryptoModule/ICryptor.ts||src/crypto/modules/WebCryptoModule/ICryptor.ts": [
      "File: src/crypto/modules/WebCryptoModule/ICryptor.ts -> src/crypto/modules/WebCryptoModule/ICryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: export type EncryptedDataType = {",
      "2:   data: ArrayBuffer;",
      "3:   metadata: ArrayBuffer | null;",
      "4: };",
      "6: export interface ICryptor {",
      "7:   get identifier(): string;",
      "8:   encrypt(data: ArrayBuffer | string): EncryptedDataType;",
      "9:   decrypt(data: EncryptedDataType): ArrayBuffer;",
      "11:   encryptFileData(data: ArrayBuffer): Promise<EncryptedDataType>;",
      "12:   decryptFileData(data: EncryptedDataType): Promise<ArrayBuffer>;",
      "13: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts||src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts": [
      "File: src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts -> src/crypto/modules/WebCryptoModule/ILegacyCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { EncryptedDataType } from './ICryptor';",
      "3: export type PubNubFileType = {",
      "4:   data: File | Blob;",
      "5:   name: string;",
      "6:   mimeType: string;",
      "8:   create(config: any): PubNubFileType;",
      "10:   toArrayBuffer(): ArrayBuffer;",
      "11:   toBlob(): Blob;",
      "12:   toString(): string;",
      "13:   toFile(): File;",
      "14: };",
      "16: export interface ILegacyCryptor<T extends PubNubFileType> {",
      "17:   get identifier(): string;",
      "19:   encrypt(data: ArrayBuffer | string): EncryptedDataType;",
      "20:   decrypt(data: EncryptedDataType): ArrayBuffer | string;",
      "22:   encryptFile(file: T, File: T): Promise<T>;",
      "23:   decryptFile(file: T, File: T): Promise<T>;",
      "24: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts||src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts": [
      "File: src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts -> src/crypto/modules/WebCryptoModule/aesCbcCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { ICryptor, EncryptedDataType } from './ICryptor';",
      "2: import cryptoJS from '../../../core/components/cryptography/hmac-sha256';",
      "3: import { decode } from '../../../core/components/base64_codec';",
      "5: export default class AesCbcCryptor implements ICryptor {",
      "6:   static BLOCK_SIZE = 16;",
      "7:   static encoder = new TextEncoder();",
      "8:   static decoder = new TextDecoder();",
      "10:   cipherKey: string;",
      "11:   encryptedKey: any;",
      "12:   CryptoJS: any;",
      "14:   constructor(configuration: { cipherKey: string }) {",
      "15:     this.cipherKey = configuration.cipherKey;",
      "16:     this.CryptoJS = cryptoJS;",
      "17:     this.encryptedKey = this.CryptoJS.SHA256(this.cipherKey);",
      "18:   }",
      "20:   get algo() {",
      "21:     return 'AES-CBC';",
      "22:   }",
      "24:   get identifier() {",
      "25:     return 'ACRH';",
      "26:   }",
      "28:   private getIv() {",
      "29:     return crypto.getRandomValues(new Uint8Array(AesCbcCryptor.BLOCK_SIZE));",
      "30:   }",
      "32:   private async getKey() {",
      "33:     const bKey = AesCbcCryptor.encoder.encode(this.cipherKey);",
      "34:     const abHash = await crypto.subtle.digest('SHA-256', bKey.buffer);",
      "35:     return crypto.subtle.importKey('raw', abHash, this.algo, true, ['encrypt', 'decrypt']);",
      "36:   }",
      "38:   encrypt(data: ArrayBuffer | string) {",
      "39:     const stringData = typeof data === 'string' ? data : AesCbcCryptor.decoder.decode(data);",
      "40:     if (stringData.length === 0) throw new Error('encryption error. empty content');",
      "41:     const abIv = this.getIv();",
      "42:     return {",
      "43:       metadata: abIv,",
      "44:       data: decode(",
      "45:         this.CryptoJS.AES.encrypt(data, this.encryptedKey, {",
      "46:           iv: this.bufferToWordArray(abIv),",
      "47:           mode: this.CryptoJS.mode.CBC,",
      "48:         }).ciphertext.toString(this.CryptoJS.enc.Base64),",
      "49:       ),",
      "50:     };",
      "51:   }",
      "53:   decrypt(encryptedData: EncryptedDataType) {",
      "54:     const iv = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.metadata!));",
      "55:     const data = this.bufferToWordArray(new Uint8ClampedArray(encryptedData.data));",
      "56:     return AesCbcCryptor.encoder.encode(",
      "57:       this.CryptoJS.AES.decrypt({ ciphertext: data }, this.encryptedKey, {",
      "58:         iv,",
      "59:         mode: this.CryptoJS.mode.CBC,",
      "60:       }).toString(this.CryptoJS.enc.Utf8),",
      "61:     ).buffer;",
      "62:   }",
      "64:   async encryptFileData(data: ArrayBuffer): Promise<EncryptedDataType> {",
      "65:     const key = await this.getKey();",
      "66:     const iv = this.getIv();",
      "67:     return {",
      "68:       data: await crypto.subtle.encrypt({ name: this.algo, iv: iv }, key, data),",
      "69:       metadata: iv,",
      "70:     };",
      "71:   }",
      "73:   async decryptFileData(encryptedData: EncryptedDataType): Promise<ArrayBuffer> {",
      "74:     const key = await this.getKey();",
      "75:     return crypto.subtle.decrypt({ name: this.algo, iv: encryptedData.metadata! }, key, encryptedData.data);",
      "76:   }",
      "78:   private bufferToWordArray(b: any) {",
      "79:     const wa: any[] = [];",
      "80:     let i;",
      "81:     for (i = 0; i < b.length; i += 1) {",
      "82:       wa[(i / 4) | 0] |= b[i] << (24 - 8 * i);",
      "83:     }",
      "84:     return this.CryptoJS.lib.WordArray.create(wa, b.length);",
      "85:   }",
      "86: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/WebCryptoModule/legacyCryptor.ts||src/crypto/modules/WebCryptoModule/legacyCryptor.ts": [
      "File: src/crypto/modules/WebCryptoModule/legacyCryptor.ts -> src/crypto/modules/WebCryptoModule/legacyCryptor.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import Crypto from '../../../core/components/cryptography/index';",
      "2: import FileCryptor from '../web';",
      "3: import { EncryptedDataType } from './ICryptor';",
      "4: import { ILegacyCryptor, PubNubFileType } from './ILegacyCryptor';",
      "5: import { encode } from '../../../core/components/base64_codec';",
      "7: export default class LegacyCryptor implements ILegacyCryptor<PubNubFileType> {",
      "8:   config;",
      "10:   cryptor;",
      "11:   fileCryptor;",
      "13:   constructor(config: any) {",
      "14:     this.config = config;",
      "15:     this.cryptor = new Crypto({ config });",
      "16:     this.fileCryptor = new FileCryptor();",
      "17:   }",
      "19:   get identifier() {",
      "20:     return '';",
      "21:   }",
      "22:   encrypt(data: ArrayBuffer | string) {",
      "23:     const stringData = typeof data === 'string' ? data : new TextDecoder().decode(data);",
      "24:     return {",
      "25:       data: this.cryptor.encrypt(stringData),",
      "26:       metadata: null,",
      "27:     };",
      "28:   }",
      "30:   decrypt(encryptedData: EncryptedDataType) {",
      "31:     const data = typeof encryptedData.data === 'string' ? encryptedData.data : encode(encryptedData.data);",
      "32:     return this.cryptor.decrypt(data);",
      "33:   }",
      "35:   async encryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "38:     return this.fileCryptor.encryptFile(this.config?.cipherKey, file, File);",
      "39:   }",
      "41:   async decryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "44:     return this.fileCryptor.decryptFile(this.config.cipherKey, file, File);",
      "45:   }",
      "46: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/WebCryptoModule/webCryptoModule.ts||src/crypto/modules/WebCryptoModule/webCryptoModule.ts": [
      "File: src/crypto/modules/WebCryptoModule/webCryptoModule.ts -> src/crypto/modules/WebCryptoModule/webCryptoModule.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import LegacyCryptor from './legacyCryptor';",
      "2: import AesCbcCryptor from './aesCbcCryptor';",
      "3: import { EncryptedDataType, ICryptor } from './ICryptor';",
      "4: import { ILegacyCryptor, PubNubFileType } from './ILegacyCryptor';",
      "5: import { decode } from '../../../core/components/base64_codec';",
      "7: export { LegacyCryptor, AesCbcCryptor };",
      "9: type CryptorType = ICryptor | ILegacyCryptor<PubNubFileType>;",
      "11: type CryptoModuleConfiguration = {",
      "12:   default: CryptorType;",
      "13:   cryptors?: Array<CryptorType>;",
      "14: };",
      "16: export class CryptoModule {",
      "17:   static LEGACY_IDENTIFIER = '';",
      "18:   static encoder = new TextEncoder();",
      "19:   static decoder = new TextDecoder();",
      "20:   defaultCryptor: CryptorType;",
      "21:   cryptors: Array<CryptorType>;",
      "23:   constructor(cryptoModuleConfiguration: CryptoModuleConfiguration) {",
      "24:     this.defaultCryptor = cryptoModuleConfiguration.default;",
      "25:     this.cryptors = cryptoModuleConfiguration.cryptors ?? [];",
      "26:   }",
      "30:   static legacyCryptoModule(config) {",
      "31:     return new this({",
      "32:       default: new LegacyCryptor({",
      "33:         cipherKey: config.cipherKey,",
      "34:         useRandomIVs: config.useRandomIVs ?? true,",
      "35:       }),",
      "36:       cryptors: [new AesCbcCryptor({ cipherKey: config.cipherKey })],",
      "37:     });",
      "38:   }",
      "40:   static aesCbcCryptoModule(config: any) {",
      "41:     return new this({",
      "42:       default: new AesCbcCryptor({ cipherKey: config.cipherKey }),",
      "43:       cryptors: [",
      "44:         new LegacyCryptor({",
      "45:           cipherKey: config.cipherKey,",
      "46:           useRandomIVs: config.useRandomIVs ?? true,",
      "47:         }),",
      "48:       ],",
      "49:     });",
      "50:   }",
      "52:   static withDefaultCryptor(defaultCryptor: CryptorType) {",
      "53:     return new this({ default: defaultCryptor });",
      "54:   }",
      "56:   private getAllCryptors() {",
      "57:     return [this.defaultCryptor, ...this.cryptors];",
      "58:   }",
      "60:   encrypt(data: ArrayBuffer | string) {",
      "61:     const encrypted = (this.defaultCryptor as ICryptor).encrypt(data);",
      "62:     if (!encrypted.metadata) return encrypted.data;",
      "63:     const headerData = this.getHeaderData(encrypted);",
      "64:     return this.concatArrayBuffer(headerData!, encrypted.data);",
      "65:   }",
      "67:   decrypt(data: ArrayBuffer | string) {",
      "68:     const encryptedData = typeof data === 'string' ? decode(data) : data;",
      "69:     const header = CryptorHeader.tryParse(encryptedData);",
      "70:     const cryptor = this.getCryptor(header);",
      "71:     const metadata =",
      "72:       header.length > 0",
      "73:         ? encryptedData.slice(header.length - (header as CryptorHeaderV1).metadataLength, header.length)",
      "74:         : null;",
      "75:     if (encryptedData.slice(header.length).byteLength <= 0) throw new Error('decryption error. empty content');",
      "76:     return cryptor!.decrypt({",
      "77:       data: encryptedData.slice(header.length),",
      "78:       metadata: metadata,",
      "79:     });",
      "80:   }",
      "82:   async encryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "83:     if (this.defaultCryptor.identifier === CryptorHeader.LEGACY_IDENTIFIER)",
      "84:       return (this.defaultCryptor as ILegacyCryptor<PubNubFileType>).encryptFile(file, File);",
      "85:     const fileData = this.getFileData(file.data);",
      "86:     const encrypted = await (this.defaultCryptor as ICryptor).encryptFileData(fileData);",
      "87:     return File.create({",
      "88:       name: file.name,",
      "89:       mimeType: 'application/octet-stream',",
      "90:       data: this.concatArrayBuffer(this.getHeaderData(encrypted)!, encrypted.data),",
      "91:     });",
      "92:   }",
      "94:   async decryptFile(file: PubNubFileType, File: PubNubFileType) {",
      "95:     const data = await file.data.arrayBuffer();",
      "96:     const header = CryptorHeader.tryParse(data);",
      "97:     const cryptor = this.getCryptor(header);",
      "98:     if (cryptor?.identifier === CryptoModule.LEGACY_IDENTIFIER) {",
      "99:       return (cryptor as ILegacyCryptor<PubNubFileType>).decryptFile(file, File);",
      "100:     }",
      "101:     const fileData = this.getFileData(data);",
      "102:     const metadata = fileData.slice(header.length - (header as CryptorHeaderV1).metadataLength, header.length);",
      "103:     return File.create({",
      "104:       name: file.name,",
      "105:       data: await (this.defaultCryptor as ICryptor).decryptFileData({",
      "106:         data: data.slice(header.length),",
      "107:         metadata: metadata,",
      "108:       }),",
      "109:     });",
      "110:   }",
      "112:   private getCryptor(header: string | CryptorHeaderV1) {",
      "113:     if (header === '') {",
      "114:       const cryptor = this.getAllCryptors().find((c) => c.identifier === '');",
      "115:       if (cryptor) return cryptor;",
      "116:       throw new Error('unknown cryptor error');",
      "117:     } else if (header instanceof CryptorHeaderV1) {",
      "118:       return this.getCryptorFromId(header.identifier);",
      "119:     }",
      "120:   }",
      "122:   private getCryptorFromId(id: string) {",
      "123:     const cryptor = this.getAllCryptors().find((c) => id === c.identifier);",
      "124:     if (cryptor) {",
      "125:       return cryptor;",
      "126:     }",
      "127:     throw Error('unknown cryptor error');",
      "128:   }",
      "130:   private concatArrayBuffer(ab1: ArrayBuffer, ab2: ArrayBuffer) {",
      "131:     const tmp = new Uint8Array(ab1.byteLength + ab2.byteLength);",
      "133:     tmp.set(new Uint8Array(ab1), 0);",
      "134:     tmp.set(new Uint8Array(ab2), ab1.byteLength);",
      "136:     return tmp.buffer;",
      "137:   }",
      "139:   private getHeaderData(encrypted: EncryptedDataType) {",
      "140:     if (!encrypted.metadata) return;",
      "141:     const header = CryptorHeader.from(this.defaultCryptor.identifier, encrypted.metadata);",
      "142:     const headerData = new Uint8Array(header!.length);",
      "143:     let pos = 0;",
      "144:     headerData.set(header!.data, pos);",
      "145:     pos += header!.length - encrypted.metadata.byteLength;",
      "146:     headerData.set(new Uint8Array(encrypted.metadata), pos);",
      "147:     return headerData.buffer;",
      "148:   }",
      "150:   private getFileData(input: any) {",
      "151:     if (input instanceof ArrayBuffer) {",
      "152:       return input;",
      "153:     }",
      "154:     if (typeof input === 'string') {",
      "155:       return CryptoModule.encoder.encode(input);",
      "156:     }",
      "157:     throw new Error('Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer');",
      "158:   }",
      "159: }",
      "162: class CryptorHeader {",
      "163:   static SENTINEL = 'PNED';",
      "164:   static LEGACY_IDENTIFIER = '';",
      "165:   static IDENTIFIER_LENGTH = 4;",
      "166:   static VERSION = 1;",
      "167:   static MAX_VERSION = 1;",
      "168:   static decoder = new TextDecoder();",
      "170:   static from(id: string, metadata: ArrayBuffer) {",
      "171:     if (id === CryptorHeader.LEGACY_IDENTIFIER) return;",
      "172:     return new CryptorHeaderV1(id, metadata.byteLength);",
      "173:   }",
      "175:   static tryParse(data: ArrayBuffer) {",
      "176:     const encryptedData = new Uint8Array(data);",
      "177:     let sentinel: any = '';",
      "178:     let version = null;",
      "179:     if (encryptedData.byteLength >= 4) {",
      "180:       sentinel = encryptedData.slice(0, 4);",
      "181:       if (this.decoder.decode(sentinel) !== CryptorHeader.SENTINEL) return '';",
      "182:     }",
      "183:     if (encryptedData.byteLength >= 5) {",
      "184:       version = (encryptedData as Uint8Array)[4] as number;",
      "185:     } else {",
      "186:       throw new Error('decryption error. invalid header version');",
      "187:     }",
      "188:     if (version > CryptorHeader.MAX_VERSION) throw new Error('unknown cryptor error');",
      "190:     let identifier: any = '';",
      "191:     let pos = 5 + CryptorHeader.IDENTIFIER_LENGTH;",
      "192:     if (encryptedData.byteLength >= pos) {",
      "193:       identifier = encryptedData.slice(5, pos);",
      "194:     } else {",
      "195:       throw new Error('decryption error. invalid crypto identifier');",
      "196:     }",
      "197:     let metadataLength = null;",
      "198:     if (encryptedData.byteLength >= pos + 1) {",
      "199:       metadataLength = (encryptedData as Uint8Array)[pos];",
      "200:     } else {",
      "201:       throw new Error('decryption error. invalid metadata length');",
      "202:     }",
      "203:     pos += 1;",
      "204:     if (metadataLength === 255 && encryptedData.byteLength >= pos + 2) {",
      "205:       metadataLength = new Uint16Array(encryptedData.slice(pos, pos + 2)).reduce((acc, val) => (acc << 8) + val, 0);",
      "206:       pos += 2;",
      "207:     }",
      "208:     return new CryptorHeaderV1(this.decoder.decode(identifier), metadataLength);",
      "209:   }",
      "210: }",
      "213: class CryptorHeaderV1 {",
      "214:   static IDENTIFIER_LENGTH = 4;",
      "215:   static SENTINEL = 'PNED';",
      "217:   _identifier;",
      "218:   _metadataLength;",
      "220:   constructor(id: string, metadataLength: number) {",
      "221:     this._identifier = id;",
      "222:     this._metadataLength = metadataLength;",
      "223:   }",
      "225:   get identifier() {",
      "226:     return this._identifier;",
      "227:   }",
      "229:   set identifier(value) {",
      "230:     this._identifier = value;",
      "231:   }",
      "233:   get metadataLength() {",
      "234:     return this._metadataLength;",
      "235:   }",
      "237:   set metadataLength(value) {",
      "238:     this._metadataLength = value;",
      "239:   }",
      "241:   get version() {",
      "242:     return CryptorHeader.VERSION;",
      "243:   }",
      "245:   get length() {",
      "246:     return (",
      "247:       CryptorHeader.SENTINEL.length +",
      "248:       1 +",
      "249:       CryptorHeader.IDENTIFIER_LENGTH +",
      "250:       (this.metadataLength < 255 ? 1 : 3) +",
      "251:       this.metadataLength",
      "252:     );",
      "253:   }",
      "255:   get data() {",
      "256:     let pos = 0;",
      "257:     const header = new Uint8Array(this.length);",
      "258:     const encoder = new TextEncoder();",
      "259:     header.set(encoder.encode(CryptorHeader.SENTINEL));",
      "260:     pos += CryptorHeader.SENTINEL.length;",
      "261:     header[pos] = this.version;",
      "262:     pos++;",
      "263:     if (this.identifier) header.set(encoder.encode(this.identifier), pos);",
      "264:     pos += CryptorHeader.IDENTIFIER_LENGTH;",
      "265:     const metadataLength = this.metadataLength;",
      "266:     if (metadataLength < 255) {",
      "267:       header[pos] = metadataLength;",
      "268:     } else {",
      "269:       header.set([255, metadataLength >> 8, metadataLength & 0xff], pos);",
      "270:     }",
      "271:     return header;",
      "272:   }",
      "273: }",
      "",
      "---------------"
    ],
    "src/crypto/modules/node.js||src/crypto/modules/node.js": [
      "File: src/crypto/modules/node.js -> src/crypto/modules/node.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: import { createCipheriv, createDecipheriv, createHash, randomBytes } from 'crypto';",
      "5: export default class NodeCryptography {",
      "",
      "[Removed Lines]",
      "2: import { Readable, PassThrough } from 'stream';",
      "",
      "[Added Lines]",
      "2: import { Readable, PassThrough, Transform } from 'stream';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "41:     const bKey = this.getKey(key);",
      "43:     if (file.data instanceof Buffer) {",
      "44:       return File.create({",
      "45:         name: file.name,",
      "46:         mimeType: 'application/octet-stream',",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "44:       if (file.data.byteLength <= 0) throw new Error('encryption error. empty content');",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "48:       });",
      "49:     }",
      "50:     if (file.data instanceof Readable) {",
      "51:       return File.create({",
      "52:         name: file.name,",
      "53:         mimeType: 'application/octet-stream',",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "52:       if (file.contentLength === 0) throw new Error('encryption error. empty content');",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "118:   decryptBuffer(key, ciphertext) {",
      "119:     const bIv = ciphertext.slice(0, NodeCryptography.IV_LENGTH);",
      "120:     const bCiphertext = ciphertext.slice(NodeCryptography.IV_LENGTH);",
      "122:     const aes = createDecipheriv(this.algo, key, bIv);",
      "124:     return Buffer.concat([aes.update(bCiphertext), aes.final()]);",
      "125:   }",
      "129:     const bIv = this.getIv();",
      "137:   }",
      "139:   decryptStream(key, stream) {",
      "",
      "[Removed Lines]",
      "127:   encryptStream(key, stream) {",
      "128:     const output = new PassThrough();",
      "131:     const aes = createCipheriv(this.algo, key, bIv);",
      "133:     output.write(bIv);",
      "134:     stream.pipe(aes).pipe(output);",
      "136:     return output;",
      "",
      "[Added Lines]",
      "123:     if (bCiphertext.byteLength <= 0) throw new Error('decryption error: empty content');",
      "129:   async encryptStream(key, stream) {",
      "131:     const aes = createCipheriv('aes-256-cbc', key, bIv).setAutoPadding(true);",
      "132:     let inited = false;",
      "133:     return stream.pipe(aes).pipe(",
      "134:       new Transform({",
      "135:         transform(chunk, _, cb) {",
      "136:           if (!inited) {",
      "137:             inited = true;",
      "138:             this.push(Buffer.concat([bIv, chunk]));",
      "139:           } else {",
      "140:             this.push(chunk);",
      "141:           }",
      "142:           cb();",
      "143:         },",
      "144:       }),",
      "145:     );",
      "",
      "---------------"
    ],
    "src/crypto/modules/web.js||src/crypto/modules/web.js": [
      "File: src/crypto/modules/web.js -> src/crypto/modules/web.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "12: export default class WebCryptography {",
      "13:   static IV_LENGTH = 16;",
      "15:   get algo() {",
      "16:     return 'aes-256-cbc';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14:   static encoder = new TextEncoder();",
      "15:   static decoder = new TextDecoder();",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "41:   }",
      "43:   async encryptFile(key, file, File) {",
      "44:     const bKey = await this.getKey(key);",
      "48:     const abCipherdata = await this.encryptArrayBuffer(bKey, abPlaindata);",
      "",
      "[Removed Lines]",
      "46:     const abPlaindata = await file.toArrayBuffer();",
      "",
      "[Added Lines]",
      "45:     if (file.data.byteLength <= 0) throw new Error('encryption error. empty content');",
      "48:     const abPlaindata = await file.data.arrayBuffer();",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "57:   async decryptFile(key, file, File) {",
      "58:     const bKey = await this.getKey(key);",
      "62:     const abPlaindata = await this.decryptArrayBuffer(bKey, abCipherdata);",
      "64:     return File.create({",
      "",
      "[Removed Lines]",
      "60:     const abCipherdata = await file.toArrayBuffer();",
      "",
      "[Added Lines]",
      "62:     const abCipherdata = await file.data.arrayBuffer();",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "68:   }",
      "70:   async getKey(key) {",
      "76:     return crypto.subtle.importKey('raw', abKey, 'AES-CBC', true, ['encrypt', 'decrypt']);",
      "77:   }",
      "",
      "[Removed Lines]",
      "71:     const bKey = Buffer.from(key);",
      "72:     const abHash = await crypto.subtle.digest('SHA-256', bKey.buffer);",
      "74:     const abKey = Buffer.from(Buffer.from(abHash).toString('hex').slice(0, 32), 'utf8').buffer;",
      "",
      "[Added Lines]",
      "72:     const digest = await crypto.subtle.digest('SHA-256', WebCryptography.encoder.encode(key));",
      "73:     const hashHex = Array.from(new Uint8Array(digest))",
      "74:       .map((b) => b.toString(16).padStart(2, '0'))",
      "75:       .join('');",
      "76:     const abKey = WebCryptography.encoder.encode(hashHex.slice(0, 32)).buffer;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "85:   async decryptArrayBuffer(key, ciphertext) {",
      "86:     const abIv = ciphertext.slice(0, 16);",
      "89:   }",
      "91:   async encryptString(key, plaintext) {",
      "92:     const abIv = crypto.getRandomValues(new Uint8Array(16));",
      "95:     const abPayload = await crypto.subtle.encrypt({ name: 'AES-CBC', iv: abIv }, key, abPlaintext);",
      "97:     const ciphertext = concatArrayBuffer(abIv.buffer, abPayload);",
      "100:   }",
      "102:   async decryptString(key, ciphertext) {",
      "104:     const abIv = abCiphertext.slice(0, 16);",
      "105:     const abPayload = abCiphertext.slice(16);",
      "107:     const abPlaintext = await crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, abPayload);",
      "110:   }",
      "111: }",
      "",
      "[Removed Lines]",
      "88:     return crypto.subtle.decrypt({ name: 'AES-CBC', iv: abIv }, key, ciphertext.slice(16));",
      "94:     const abPlaintext = Buffer.from(plaintext).buffer;",
      "99:     return Buffer.from(ciphertext).toString('utf8');",
      "103:     const abCiphertext = Buffer.from(ciphertext);",
      "109:     return Buffer.from(abPlaintext).toString('utf8');",
      "",
      "[Added Lines]",
      "88:     if (ciphertext.slice(WebCryptography.IV_LENGTH).byteLength <= 0) throw new Error('decryption error: empty content');",
      "89:     const data = await crypto.subtle.decrypt(",
      "90:       { name: 'AES-CBC', iv: abIv },",
      "91:       key,",
      "92:       ciphertext.slice(WebCryptography.IV_LENGTH),",
      "93:     );",
      "94:     return data;",
      "100:     const abPlaintext = WebCryptography.encoder.encode(plaintext).buffer;",
      "105:     return WebCryptography.decoder.decode(ciphertext);",
      "109:     const abCiphertext = WebCryptography.encoder.encode(ciphertext).buffer;",
      "115:     return WebCryptography.decoder.decode(abPlaintext);",
      "",
      "---------------"
    ],
    "src/file/modules/node.js||src/file/modules/node.js": [
      "File: src/file/modules/node.js -> src/file/modules/node.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: import { Readable, PassThrough } from 'stream';",
      "5: import { basename } from 'path';",
      "9: const PubNubFile = class PubNubFile {",
      "10:   static supportsBlob = false;",
      "",
      "[Removed Lines]",
      "4: import { ReadStream } from 'fs';",
      "7: import { IFile, FileClass } from '..';",
      "",
      "[Added Lines]",
      "2: import fs from 'fs';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "30:   mimeType;",
      "32:   static create(config) {",
      "33:     return new this(config);",
      "34:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "28:   contentLength;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "37:     if (stream instanceof Readable) {",
      "38:       this.data = stream;",
      "42:         this.name = basename(stream.path);",
      "43:       }",
      "44:     } else if (data instanceof Buffer) {",
      "45:       this.data = Buffer.from(data);",
      "",
      "[Removed Lines]",
      "40:       if (stream instanceof ReadStream) {",
      "",
      "[Added Lines]",
      "38:       if (stream instanceof fs.ReadStream) {",
      "41:         this.contentLength = fs.statSync(stream.path).size;",
      "",
      "---------------"
    ],
    "src/node/index.ts||src/node/index.ts": [
      "File: src/node/index.ts -> src/node/index.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "9: import NodeCryptography from '../crypto/modules/node';",
      "10: import PubNubFile from '../file/modules/node';",
      "12: export = class extends PubNubCore {",
      "13:   constructor(setup: any) {",
      "14:     setup.cbor = new Cbor((buffer: ArrayBuffer) => CborReader.decode(Buffer.from(buffer)), decode);",
      "15:     setup.networking = new Networking({",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11: import { CryptoModule, LegacyCryptor, AesCbcCryptor } from '../crypto/modules/NodeCryptoModule/nodeCryptoModule';",
      "14:   static CryptoModule = CryptoModule;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "27:     setup.PubNubFile = PubNubFile;",
      "28:     setup.cryptography = new NodeCryptography();",
      "30:     if (!('ssl' in setup)) {",
      "31:       setup.ssl = true;",
      "32:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32:     setup.initCryptoModule = (cryptoConfiguration: any) => {",
      "33:       return new CryptoModule({",
      "34:         default: new LegacyCryptor({",
      "35:           cipherKey: cryptoConfiguration.cipherKey,",
      "36:           useRandomIVs: cryptoConfiguration.useRandomIVs,",
      "37:         }),",
      "38:         cryptors: [new AesCbcCryptor({ cipherKey: cryptoConfiguration.cipherKey })],",
      "39:       });",
      "40:     };",
      "",
      "---------------"
    ],
    "src/web/index.js||src/web/index.js": [
      "File: src/web/index.js -> src/web/index.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "12: import WebCryptography from '../crypto/modules/web';",
      "13: import PubNubFile from '../file/modules/web';",
      "15: function sendBeacon(url) {",
      "16:   if (navigator && navigator.sendBeacon) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: import { CryptoModule, LegacyCryptor, AesCbcCryptor } from '../crypto/modules/WebCryptoModule/webCryptoModule';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "21: }",
      "23: export default class extends PubNubCore {",
      "24:   constructor(setup) {",
      "26:     const { listenToBrowserNetworkEvents = true } = setup;",
      "28:     setup.sdkFamily = 'Web';",
      "29:     setup.networking = new Networking({",
      "30:       del,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "25:   static CryptoModule = CryptoModule;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "40:     setup.PubNubFile = PubNubFile;",
      "41:     setup.cryptography = new WebCryptography();",
      "43:     super(setup);",
      "45:     if (listenToBrowserNetworkEvents) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "44:     setup.initCryptoModule = (cryptoConfiguration) => {",
      "45:       return new CryptoModule({",
      "46:         default: new LegacyCryptor({",
      "47:           cipherKey: cryptoConfiguration.cipherKey,",
      "48:           useRandomIVs: cryptoConfiguration.useRandomIVs,",
      "49:         }),",
      "50:         cryptors: [new AesCbcCryptor({ cipherKey: cryptoConfiguration.cipherKey })],",
      "51:       });",
      "52:     };",
      "",
      "---------------"
    ],
    "test/contract/steps/cryptoModule/cryptoModule.ts||test/contract/steps/cryptoModule/cryptoModule.ts": [
      "File: test/contract/steps/cryptoModule/cryptoModule.ts -> test/contract/steps/cryptoModule/cryptoModule.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: import { Given, When, Then, Before } from '@cucumber/cucumber';",
      "2: import { expect } from 'chai';",
      "3: import fs from 'fs';",
      "5: import {",
      "6:   CryptoModule,",
      "7:   AesCbcCryptor,",
      "8:   LegacyCryptor,",
      "9: } from '../../../../lib/crypto/modules/NodeCryptoModule/nodeCryptoModule.js';",
      "11: Before(function () {",
      "12:   this.useRandomIVs = true;",
      "13: });",
      "15: Given('Crypto module with {string} cryptor', function (cryptorIdentifier: string) {",
      "16:   this.cryptorIdentifier = cryptorIdentifier;",
      "17: });",
      "19: Given(",
      "20:   'Crypto module with default {string} and additional {string} cryptors',",
      "21:   function (defaultCryptorId: string, additionalCryptorId: string) {",
      "22:     this.defaultCryptorId = defaultCryptorId;",
      "23:     this.additionalCryptorId = additionalCryptorId;",
      "24:   },",
      "25: );",
      "27: Given('with {string} cipher key', function (cipherKey: string) {",
      "28:   this.cipherKey = cipherKey;",
      "29: });",
      "31: Given('with {string} vector', function (vector: string) {",
      "32:   if (vector === 'constant') this.useRandomIVs = false;",
      "33:   this._initCryptor = (id: string) => {",
      "34:     return id === 'legacy'",
      "35:       ? new LegacyCryptor({ cipherKey: this.cipherKey, useRandomIVs: this.useRandomIVs })",
      "36:       : new AesCbcCryptor({ cipherKey: this.cipherKey });",
      "37:   };",
      "38: });",
      "40: When('I decrypt {string} file', async function (fileName: string) {",
      "41:   if (this.cryptorIdentifier === 'acrh') {",
      "42:     const cryptor = new AesCbcCryptor({ cipherKey: this.cipherKey });",
      "43:     this.cryptoModule = CryptoModule.withDefaultCryptor(cryptor);",
      "44:   }",
      "45:   const pubnub = await this.getPubnub({ subscribeKey: 'key' });",
      "46:   const fileData = fs.readFileSync(this.getFilePath(fileName));",
      "47:   const file = pubnub.File.create({",
      "48:     name: fileName,",
      "49:     mimeType: 'text/plain',",
      "50:     data: fileData,",
      "51:   });",
      "52:   try {",
      "53:     const result = await this.cryptoModule.decryptFile(file, pubnub.File);",
      "54:   } catch (e: any) {",
      "55:     this.errorMessage = e?.message;",
      "56:   }",
      "57: });",
      "59: When('I decrypt {string} file as {string}', async function (fileName: string, format: string) {",
      "60:   if (this.defaultCryptorId && this.additionalCryptorId) {",
      "61:     this.cryptoModule = new CryptoModule({",
      "62:       default: this._initCryptor(this.defaultCryptorId),",
      "63:       cryptors: [this._initCryptor(this.additionalCryptorId)],",
      "64:     });",
      "65:   } else {",
      "66:     this.cryptoModule = CryptoModule.withDefaultCryptor(this._initCryptor(this.cryptorIdentifier));",
      "67:   }",
      "69:   const pubnub = await this.getPubnub({ subscribeKey: 'key' });",
      "71:   if (format === 'binary') {",
      "72:     this.isBinary = true;",
      "73:     if (!this.useRandomIVs) return;",
      "74:     let encrypteFile = pubnub.File.create({",
      "75:       name: fileName,",
      "76:       data: fs.readFileSync(this.getFilePath(fileName)),",
      "77:     });",
      "78:     try {",
      "79:       this.binaryFileResult = await this.cryptoModule.decryptFile(encrypteFile, pubnub.File);",
      "80:     } catch (e: any) {",
      "81:       this.errorMessage = e?.message;",
      "82:     }",
      "83:   } else if (format === 'stream') {",
      "84:     this.isStream = true;",
      "85:     const filestream = fs.createReadStream(this.getFilePath(fileName));",
      "86:     this.file = pubnub.File.create({",
      "87:       name: fileName,",
      "88:       stream: filestream,",
      "89:     });",
      "90:     try {",
      "91:       this.streamFileResult = await this.cryptoModule.decryptFile(this.file, pubnub.File);",
      "92:     } catch (e: any) {",
      "93:       this.errorMessage = e?.message;",
      "94:     }",
      "95:   }",
      "96: });",
      "98: Then('Decrypted file content equal to the {string} file content', async function (sourceFile: string) {",
      "99:   if (this.isBinary && !this.useRandomIVs) return;",
      "100:   if (this.isStream) {",
      "101:     const fileStream = await this.streamFileResult.toStream();",
      "102:     const tempFilePath = `${__dirname}/${this.file.name}`;",
      "103:     const outputStream = fs.createWriteStream(tempFilePath);",
      "104:     const expected = fs.readFileSync(this.getFilePath(sourceFile));",
      "105:     fileStream.pipe(outputStream);",
      "106:     return new Promise((resolve) => {",
      "107:       outputStream.on('finish', () => {",
      "108:         try {",
      "109:           const actual = fs.readFileSync(tempFilePath);",
      "110:           expect(Buffer.compare(actual, expected.slice(0, actual.length)) === 0).to.be.true;",
      "111:         } finally {",
      "112:           fs.unlink(tempFilePath, () => {});",
      "113:         }",
      "114:         resolve(0);",
      "115:       });",
      "116:     });",
      "117:   }",
      "118:   expect(this.binaryFileResult.data.equals(fs.readFileSync(this.getFilePath(sourceFile)))).to.be.true;",
      "119: });",
      "121: Then('I receive {string}', async function (result: string) {",
      "122:   if ((this.isBinaryFile || this.isBinary) && !this.useRandomIVs) return;",
      "123:   if (result === 'success') {",
      "124:     expect(this.errorMessage).to.be.undefined;",
      "125:   } else {",
      "126:     expect(this.errorMessage).to.have.string(result);",
      "127:   }",
      "128: });",
      "130: Given('Legacy code with {string} cipher key and {string} vector', function (cipherKey: string, vector: string) {",
      "131:   const cryptor = new LegacyCryptor({ cipherKey: cipherKey, useRandomIVs: vector === 'random' ? true : false });",
      "132:   this.cryptoModule = CryptoModule.withDefaultCryptor(cryptor);",
      "133: });",
      "135: When('I encrypt {string} file as {string}', async function (fileName: string, format: string) {",
      "136:   this.pubnub = await this.getPubnub({ subscribeKey: 'key' });",
      "137:   this.fileDataBuffer = fs.readFileSync(this.getFilePath(fileName));",
      "138:   if (format === 'stream') {",
      "139:     this.file = this.pubnub.File.create({",
      "140:       name: fileName,",
      "141:       mimeType: 'application/octet-stream',",
      "142:       stream: fs.createReadStream(this.getFilePath(fileName)),",
      "143:     });",
      "144:     this.isStream = true;",
      "145:   } else {",
      "146:     this.file = this.pubnub.File.create({",
      "147:       name: fileName,",
      "148:       mimeType: 'application/octet-stream',",
      "149:       data: this.fileDataBuffer,",
      "150:     });",
      "151:     this.isBinaryFile = true;",
      "152:   }",
      "153:   if (!this.cryptoModule) {",
      "154:     this.cryptoModule = CryptoModule.withDefaultCryptor(this._initCryptor(this.cryptorIdentifier));",
      "155:   }",
      "156:   try {",
      "157:     this.encryptedFile = await this.cryptoModule.encryptFile(this.file, this.pubnub.File);",
      "158:   } catch (e: any) {",
      "159:     this.errorMessage = e?.message;",
      "160:   }",
      "161: });",
      "163: Then('Successfully decrypt an encrypted file with legacy code', async function () {",
      "164:   const decryptedFile = await this.cryptoModule.decryptFile(this.encryptedFile, this.pubnub.File);",
      "165:   if (this.isStream) {",
      "166:     const fileStream = await decryptedFile.toStream();",
      "167:     const tempFilePath = `${__dirname}/${this.file.name}`;",
      "168:     const outputStream = fs.createWriteStream(tempFilePath);",
      "169:     fileStream.pipe(outputStream);",
      "170:     outputStream.on('end', () => {",
      "171:       const actualFileBuffer = fs.readFileSync(tempFilePath);",
      "172:       expect(actualFileBuffer).to.equalBytes(this.fileDataBuffer);",
      "173:       fs.unlink(tempFilePath, () => {});",
      "174:     });",
      "175:   } else {",
      "176:     expect(decryptedFile.data.toString('utf8')).to.equal(this.fileDataBuffer.toString('utf8'));",
      "177:   }",
      "178: });",
      "",
      "---------------"
    ],
    "test/contract/utils.ts||test/contract/utils.ts": [
      "File: test/contract/utils.ts -> test/contract/utils.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "7:   );",
      "8:   return JSON.parse(fileData);",
      "9: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11: export function getFilePath(filename) {",
      "12:   return `${process.cwd()}/dist/contract/contract/features/encryption/assets/${filename}`;",
      "13: }",
      "",
      "---------------"
    ],
    "test/contract/world.ts||test/contract/world.ts": [
      "File: test/contract/world.ts -> test/contract/world.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "4:   World",
      "5: } from '@cucumber/cucumber';",
      "6: import PubNub from '../../lib/node/index.js';",
      "8: import * as http from 'http';",
      "10: interface State {",
      "",
      "[Removed Lines]",
      "7: import { loadFixtureFile } from './utils';",
      "",
      "[Added Lines]",
      "7: import { loadFixtureFile, getFilePath } from './utils';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "134:     }",
      "135:     return this.fileFixtures[name];",
      "136:   }",
      "137: }",
      "139: setWorldConstructor(PubnubWorld);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "137:   getFilePath(filename) {",
      "138:     return getFilePath(filename);",
      "139:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "513113f586c96db3cb853820738b31c22003ce55",
      "candidate_info": {
        "commit_hash": "513113f586c96db3cb853820738b31c22003ce55",
        "repo": "pubnub/javascript",
        "commit_url": "https://github.com/pubnub/javascript/commit/513113f586c96db3cb853820738b31c22003ce55",
        "files": [
          ".pubnub.yml",
          "CHANGELOG.md",
          "README.md",
          "dist/web/pubnub.js",
          "dist/web/pubnub.min.js",
          "lib/core/components/config.js",
          "package.json",
          "src/core/components/config.js"
        ],
        "message": "chore:update license field in package.json (#344)\n\n* update licese field in package.json\n\n* PubNub SDK v7.4.2 release.\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>",
        "before_after_code_files": [
          "dist/web/pubnub.js||dist/web/pubnub.js",
          "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
          "lib/core/components/config.js||lib/core/components/config.js",
          "src/core/components/config.js||src/core/components/config.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ],
          "candidate": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ]
        }
      },
      "candidate_diff": {
        "dist/web/pubnub.js||dist/web/pubnub.js": [
          "File: dist/web/pubnub.js -> dist/web/pubnub.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "791:             return this;",
          "792:         };",
          "793:         default_1.prototype.getVersion = function () {",
          "795:         };",
          "796:         default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "797:             this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "794:             return '7.4.1';",
          "",
          "[Added Lines]",
          "794:             return '7.4.2';",
          "",
          "---------------"
        ],
        "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
          "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:     PERFORMANCE OF THIS SOFTWARE.",
          "",
          "[Removed Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.1\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:(n=this.getFileData(e.data),[4,this.defaultCryptor.encryptFileData(n)]);case 1:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:(s=this.getFileData(r),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})]);case 2:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){if(t instanceof ArrayBuffer)return t;if(\"string\"==typeof t)return e.encoder.encode(t);throw new Error(\"Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer\")},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
          "",
          "[Added Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.2\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:(n=this.getFileData(e.data),[4,this.defaultCryptor.encryptFileData(n)]);case 1:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:(s=this.getFileData(r),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})]);case 2:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){if(t instanceof ArrayBuffer)return t;if(\"string\"==typeof t)return e.encoder.encode(t);throw new Error(\"Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer\")},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
          "",
          "---------------"
        ],
        "lib/core/components/config.js||lib/core/components/config.js": [
          "File: lib/core/components/config.js -> lib/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "177:         return this;",
          "178:     };",
          "179:     default_1.prototype.getVersion = function () {",
          "181:     };",
          "182:     default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "183:         this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "180:         return '7.4.1';",
          "",
          "[Added Lines]",
          "180:         return '7.4.2';",
          "",
          "---------------"
        ],
        "src/core/components/config.js||src/core/components/config.js": [
          "File: src/core/components/config.js -> src/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "350:   }",
          "352:   getVersion() {",
          "354:   }",
          "356:   _addPnsdkSuffix(name, suffix) {",
          "",
          "[Removed Lines]",
          "353:     return '7.4.1';",
          "",
          "[Added Lines]",
          "353:     return '7.4.2';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b29cc36c8b730ad903a7cfc4480b2012e02da4bc",
      "candidate_info": {
        "commit_hash": "b29cc36c8b730ad903a7cfc4480b2012e02da4bc",
        "repo": "pubnub/javascript",
        "commit_url": "https://github.com/pubnub/javascript/commit/b29cc36c8b730ad903a7cfc4480b2012e02da4bc",
        "files": [
          ".pubnub.yml",
          "CHANGELOG.md",
          "README.md",
          "dist/web/pubnub.js",
          "dist/web/pubnub.min.js",
          "lib/core/components/config.js",
          "lib/entities/SubscriptionSet.js",
          "package.json",
          "src/core/components/config.js",
          "src/entities/SubscriptionSet.ts"
        ],
        "message": "fix: add-remove-subscription-listener-to-set (#368)\n\n* add/remove listener from subscription to subscriptionSet.\n* fixed additional entity name with pnpres being added while creating subscriptionSet\n\n* PubNub SDK v7.6.3 release.\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>",
        "before_after_code_files": [
          "dist/web/pubnub.js||dist/web/pubnub.js",
          "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
          "lib/core/components/config.js||lib/core/components/config.js",
          "lib/entities/SubscriptionSet.js||lib/entities/SubscriptionSet.js",
          "src/core/components/config.js||src/core/components/config.js",
          "src/entities/SubscriptionSet.ts||src/entities/SubscriptionSet.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ],
          "candidate": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ]
        }
      },
      "candidate_diff": {
        "dist/web/pubnub.js||dist/web/pubnub.js": [
          "File: dist/web/pubnub.js -> dist/web/pubnub.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "794:             return this;",
          "795:         };",
          "796:         default_1.prototype.getVersion = function () {",
          "798:         };",
          "799:         default_1.prototype._setRetryConfiguration = function (configuration) {",
          "800:             if (configuration.minimumdelay < 2) {",
          "",
          "[Removed Lines]",
          "797:             return '7.6.2';",
          "",
          "[Added Lines]",
          "797:             return '7.6.3';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "8432:             _this.options = subscriptionOptions;",
          "8433:             _this.eventEmitter = eventEmitter;",
          "8434:             _this.pubnub = pubnub;",
          "8436:                 var subscription = _this.pubnub.channel(c).subscription(_this.options);",
          "8437:                 _this.channelNames = __spreadArray$1(__spreadArray$1([], __read$1(_this.channelNames), false), __read$1(subscription.channels), false);",
          "8438:                 _this.subscriptionList.push(subscription);",
          "8439:             });",
          "8441:                 var subscription = _this.pubnub.channelGroup(cg).subscription(_this.options);",
          "8442:                 _this.groupNames = __spreadArray$1(__spreadArray$1([], __read$1(_this.groupNames), false), __read$1(subscription.channelGroups), false);",
          "8443:                 _this.subscriptionList.push(subscription);",
          "",
          "[Removed Lines]",
          "8435:             channels.forEach(function (c) {",
          "8440:             channelGroups.forEach(function (cg) {",
          "",
          "[Added Lines]",
          "8435:             channels",
          "8436:                 .filter(function (c) { return !c.endsWith('-pnpres'); })",
          "8437:                 .forEach(function (c) {",
          "8442:             channelGroups",
          "8443:                 .filter(function (cg) { return !cg.endsWith('-pnpres'); })",
          "8444:                 .forEach(function (cg) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "8450:             this.subscriptionList.push(subscription);",
          "8451:             this.channelNames = __spreadArray$1(__spreadArray$1([], __read$1(this.channelNames), false), __read$1(subscription.channels), false);",
          "8452:             this.groupNames = __spreadArray$1(__spreadArray$1([], __read$1(this.groupNames), false), __read$1(subscription.channelGroups), false);",
          "8453:         };",
          "8454:         SubscriptionSet.prototype.removeSubscription = function (subscription) {",
          "8455:             var channelsToRemove = subscription.channels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8457:             this.eventEmitter.addListener(this.listener, subscription.channels, subscription.channelGroups);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "8457:             this.channelNames = this.channelNames.filter(function (c) { return !channelsToRemove.includes(c); });",
          "8458:             this.groupNames = this.groupNames.filter(function (cg) { return !groupsToRemove.includes(cg); });",
          "8459:             this.subscriptionList = this.subscriptionList.filter(function (s) { return s !== subscription; });",
          "8460:         };",
          "8461:         SubscriptionSet.prototype.addSubscriptionSet = function (subscriptionSet) {",
          "8462:             this.subscriptionList = __spreadArray$1(__spreadArray$1([], __read$1(this.subscriptionList), false), __read$1(subscriptionSet.subscriptions), false);",
          "8463:             this.channelNames = __spreadArray$1(__spreadArray$1([], __read$1(this.channelNames), false), __read$1(subscriptionSet.channels), false);",
          "8464:             this.groupNames = __spreadArray$1(__spreadArray$1([], __read$1(this.groupNames), false), __read$1(subscriptionSet.channelGroups), false);",
          "8465:         };",
          "8466:         SubscriptionSet.prototype.removeSubscriptionSet = function (subscriptionSet) {",
          "8467:             var channelsToRemove = subscriptionSet.channels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8465:             this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "8471:             this.eventEmitter.addListener(this.listener, subscriptionSet.channels, subscriptionSet.channelGroups);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "8469:             this.channelNames = this.channelNames.filter(function (c) { return !channelsToRemove.includes(c); });",
          "8470:             this.groupNames = this.groupNames.filter(function (cg) { return !groupsToRemove.includes(cg); });",
          "8471:             this.subscriptionList = this.subscriptionList.filter(function (s) { return !subscriptionSet.subscriptions.includes(s); });",
          "8472:         };",
          "8473:         Object.defineProperty(SubscriptionSet.prototype, \"subscriptions\", {",
          "8474:             get: function () {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8479:             this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "",
          "---------------"
        ],
        "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
          "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:     PERFORMANCE OF THIS SOFTWARE.",
          "",
          "[Removed Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(f,f.exports);var d=f.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o,i=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=i.secretKey||i.secret_key,this.subscribeKey=i.subscribeKey||i.subscribe_key,this.publishKey=i.publishKey||i.publish_key,this.sdkName=i.sdkName,this.sdkFamily=i.sdkFamily,this.partnerId=i.partnerId,this.setAuthKey(i.authKey),this.cryptoModule=i.cryptoModule,this.setFilterExpression(i.filterExpression),\"string\"!=typeof i.origin&&!Array.isArray(i.origin)&&void 0!==i.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=i.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=i.ssl||!1,this.restore=i.restore||!1,this.proxy=i.proxy,this.keepAlive=i.keepAlive,this.keepAliveSettings=i.keepAliveSettings,this.autoNetworkDetection=i.autoNetworkDetection||!1,this.dedupeOnSubscribe=i.dedupeOnSubscribe||!1,this.maximumCacheSize=i.maximumCacheSize||100,this.customEncrypt=i.customEncrypt,this.customDecrypt=i.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=i.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=i.useRandomIVs)||void 0===n||n,this.enableEventEngine=null!==(r=i.enableEventEngine)&&void 0!==r&&r,this.maintainPresenceState=null===(o=i.maintainPresenceState)||void 0===o||o,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=i.logVerbosity||!1,this.suppressLeaveEvents=i.suppressLeaveEvents||!1,this.announceFailedHeartbeats=i.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=i.announceSuccessfulHeartbeats||!1,this.useInstanceId=i.useInstanceId||!1,this.useRequestId=i.useRequestId||!1,this.requestMessageCountThreshold=i.requestMessageCountThreshold,i.retryConfiguration&&this._setRetryConfiguration(i.retryConfiguration),this.setTransactionTimeout(i.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(i.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(i.useSendBeacon||!0),i.presenceTimeout?this.setPresenceTimeout(i.presenceTimeout):this._presenceTimeout=300,null!=i.heartbeatInterval&&this.setHeartbeatInterval(i.heartbeatInterval),\"string\"==typeof i.userId){if(\"string\"==typeof i.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(i.userId)}else{if(\"string\"!=typeof i.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(i.uuid)}this.setCipherKey(i.cipherKey,i)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.6.2\"},e.prototype._setRetryConfiguration=function(e){if(e.minimumdelay<2)throw new Error(\"Minimum delay can not be set less than 2 seconds for retry\");if(e.maximumDelay>150)throw new Error(\"Maximum delay can not be set more than 150 seconds for retry\");if(e.maximumDelay&&maximumRetry>6)throw new Error(\"Maximum retry for exponential retry policy can not be more than 6\");if(e.maximumRetry>10)throw new Error(\"Maximum retry for linear retry policy can not be more than 10\");this.retryConfiguration=e},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function m(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function s(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var a=0;a<n;a+=3){var u=s(),c=s(),l=s(),p=s(),h=(63&u)<<2|c>>4,f=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[a]=h,64!=l&&(o[a+1]=f),64!=p&&(o[a+2]=d)}return r}function b(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,s=i%3,a=i-s,u=0;u<a;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==s?n+=r[(252&(t=o[a]))>>2]+r[(3&t)<<4]+\"==\":2==s&&(n+=r[(64512&(t=o[a]<<8|o[a+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var v,_,S,w,O,P=P||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new s.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=P,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),h=2;h<=p;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var f=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],c=n[5],l=n[6],p=n[7],h=0;64>h;h++){if(16>h)f[h]=0|e[t+h];else{var d=f[h-15],y=f[h-2];f[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+f[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+f[h-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[h]+f[h],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=a+d|0,a=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(v=P).enc.Utf8,v.algo.HMAC=v.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,a=i.words,u=0;u<n;u++)s[u]^=1549556828,a[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),w=(S=P).lib.WordArray,S.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;4>s&&o+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var s=n.indexOf(e.charAt(i-1))<<i%4*2,a=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(s|a)<<24-o%4*8,o++}return w.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,s){return((e=e+(t&n|~t&r)+o+s)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,s){return((e=e+(t&r|n&~r)+o+s)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,s){return((e=e+(t^n^r)+o+s)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,s){return((e=e+(n^(t|~r))+o+s)<<i|e>>>32-i)+t}for(var i=P,s=(u=i.lib).WordArray,a=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var s=0;16>s;s++){var a=e[u=i+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[i+0],l=(a=e[i+1],e[i+2]),p=e[i+3],h=e[i+4],f=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],m=e[i+9],b=e[i+10],v=e[i+11],_=e[i+12],S=e[i+13],w=e[i+14],O=e[i+15],P=t(P=s[0],T=s[1],A=s[2],E=s[3],u,7,c[0]),E=t(E,P,T,A,a,12,c[1]),A=t(A,E,P,T,l,17,c[2]),T=t(T,A,E,P,p,22,c[3]);P=t(P,T,A,E,h,7,c[4]),E=t(E,P,T,A,f,12,c[5]),A=t(A,E,P,T,d,17,c[6]),T=t(T,A,E,P,y,22,c[7]),P=t(P,T,A,E,g,7,c[8]),E=t(E,P,T,A,m,12,c[9]),A=t(A,E,P,T,b,17,c[10]),T=t(T,A,E,P,v,22,c[11]),P=t(P,T,A,E,_,7,c[12]),E=t(E,P,T,A,S,12,c[13]),A=t(A,E,P,T,w,17,c[14]),P=n(P,T=t(T,A,E,P,O,22,c[15]),A,E,a,5,c[16]),E=n(E,P,T,A,d,9,c[17]),A=n(A,E,P,T,v,14,c[18]),T=n(T,A,E,P,u,20,c[19]),P=n(P,T,A,E,f,5,c[20]),E=n(E,P,T,A,b,9,c[21]),A=n(A,E,P,T,O,14,c[22]),T=n(T,A,E,P,h,20,c[23]),P=n(P,T,A,E,m,5,c[24]),E=n(E,P,T,A,w,9,c[25]),A=n(A,E,P,T,p,14,c[26]),T=n(T,A,E,P,g,20,c[27]),P=n(P,T,A,E,S,5,c[28]),E=n(E,P,T,A,l,9,c[29]),A=n(A,E,P,T,y,14,c[30]),P=r(P,T=n(T,A,E,P,_,20,c[31]),A,E,f,4,c[32]),E=r(E,P,T,A,g,11,c[33]),A=r(A,E,P,T,v,16,c[34]),T=r(T,A,E,P,w,23,c[35]),P=r(P,T,A,E,a,4,c[36]),E=r(E,P,T,A,h,11,c[37]),A=r(A,E,P,T,y,16,c[38]),T=r(T,A,E,P,b,23,c[39]),P=r(P,T,A,E,S,4,c[40]),E=r(E,P,T,A,u,11,c[41]),A=r(A,E,P,T,p,16,c[42]),T=r(T,A,E,P,d,23,c[43]),P=r(P,T,A,E,m,4,c[44]),E=r(E,P,T,A,_,11,c[45]),A=r(A,E,P,T,O,16,c[46]),P=o(P,T=r(T,A,E,P,l,23,c[47]),A,E,u,6,c[48]),E=o(E,P,T,A,y,10,c[49]),A=o(A,E,P,T,w,15,c[50]),T=o(T,A,E,P,f,21,c[51]),P=o(P,T,A,E,_,6,c[52]),E=o(E,P,T,A,p,10,c[53]),A=o(A,E,P,T,b,15,c[54]),T=o(T,A,E,P,a,21,c[55]),P=o(P,T,A,E,g,6,c[56]),E=o(E,P,T,A,O,10,c[57]),A=o(A,E,P,T,d,15,c[58]),T=o(T,A,E,P,S,21,c[59]),P=o(P,T,A,E,h,6,c[60]),E=o(E,P,T,A,v,10,c[61]),A=o(A,E,P,T,l,15,c[62]),T=o(T,A,E,P,m,21,c[63]);s[0]=s[0]+P|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e,t=P,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),o=r.create(),i=o.words,s=a.keySize,a=a.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),P.lib.Cipher||function(e){var t=(f=P).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=f.enc.Base64,s=f.algo.EvpKDF,a=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:h).decrypt(e,t,n,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=f.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(f.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],s=0;s<n;s+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=s.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:f}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=P,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],s=[],a=[],u=[],c=[],l=[],p=[],h=[],f=[],d=0;256>d;d++)f[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;r[y]=m,o[m]=y;var b=f[y],v=f[b],_=f[v],S=257*f[m]^16843008*m;i[y]=S<<24|S>>>8,s[y]=S<<16|S>>>16,a[y]=S<<8|S>>>24,u[y]=S,S=16843009*_^65537*v^257*b^16843008*y,c[m]=S<<24|S>>>8,l[m]=S<<16|S>>>16,p[m]=S<<8|S>>>24,h[m]=S,y?(y=b^f[f[f[_^b]]],g^=f[f[g]]):y=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var s=o[i-1];i%t?6<t&&4==i%t&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=w[i/t|0]<<24),o[i]=o[i-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,s=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?s:c[r[s>>>24]]^l[r[s>>>16&255]]^p[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,s,a,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,h,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],h=e[t+3]^n[3],f=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^s[255&h]^n[f++],g=r[l>>>24]^o[p>>>16&255]^i[h>>>8&255]^s[255&c]^n[f++],m=r[p>>>24]^o[h>>>16&255]^i[c>>>8&255]^s[255&l]^n[f++];h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^s[255&p]^n[f++],c=y,l=g,p=m}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^n[f++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[f++],m=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[f++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^n[f++],e[t]=y,e[t+1]=g,e[t+2]=m,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),P.mode.ECB=((O=P.lib.BlockCipherMode.extend()).Encryptor=O.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),O.Decryptor=O.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),O);var E=P;function A(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var T=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),s=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(s.clone()).toString(E.enc.Base64)}var a=this._getIV(n);return E.AES.encrypt(e,o,{iv:a,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=A((u=new Uint8ClampedArray(m(e))).slice(0,16)),s=A(u.slice(16));try{var a=E.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);a=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),C=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}(),k={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\",PNDisconnectedCategory:\"PNDisconnectedCategory\",PNConnectionErrorCategory:\"PNConnectionErrorCategory\",PNDisconnectedUnexpectedlyCategory:\"PNDisconnectedUnexpectedlyCategory\"},M=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,s=e.getFileUrl,a=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule,p=e.eventEmitter;this._listenerManager=c,this._config=a,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=s,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new C({config:a}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=p}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,s=e.channelGroups,a=void 0===s?[]:s,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),a.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),a.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:a,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),s.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),s.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:s},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=e.withPresence,u=void 0!==a&&a,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),s.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],a.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))})),s.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},(function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var n=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===k.PNTimeoutCategory?this._startSubscribeLoop():e.category===k.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:k.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===k.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=k.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,s=i.requestMessageCountThreshold,a=i.dedupeOnSubscribe;if(s&&o.length>=s){var u={};u.category=k.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}o.forEach((function(e){if(e.channel,e.subscriptionMatch,a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}n._eventEmitter.emitEvent(e)})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),j={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},R=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[j.PNSubscribeOperation,j.PNReceiveMessagesOperation,j.PNHandshakeOperation],this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){!this._telemetryExcludeOperations.includes(e)&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(!this._telemetryExcludeOperations.includes(e)&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case j.PNPublishOperation:t=\"pub\";break;case j.PNSignalOperation:t=\"sig\";break;case j.PNHistoryOperation:case j.PNFetchMessagesOperation:case j.PNDeleteMessagesOperation:case j.PNMessageCounts:t=\"hist\";break;case j.PNUnsubscribeOperation:case j.PNWhereNowOperation:case j.PNHereNowOperation:case j.PNHeartbeatOperation:case j.PNSetStateOperation:case j.PNGetStateOperation:t=\"pres\";break;case j.PNAddChannelsToGroupOperation:case j.PNRemoveChannelsFromGroupOperation:case j.PNChannelGroupsOperation:case j.PNRemoveGroupOperation:case j.PNChannelsForGroupOperation:t=\"cg\";break;case j.PNPushNotificationEnabledChannelsOperation:case j.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case j.PNCreateUserOperation:case j.PNUpdateUserOperation:case j.PNDeleteUserOperation:case j.PNGetUserOperation:case j.PNGetUsersOperation:case j.PNCreateSpaceOperation:case j.PNUpdateSpaceOperation:case j.PNDeleteSpaceOperation:case j.PNGetSpaceOperation:case j.PNGetSpacesOperation:case j.PNGetMembersOperation:case j.PNUpdateMembersOperation:case j.PNGetMembershipsOperation:case j.PNUpdateMembershipsOperation:t=\"obj\";break;case j.PNAddMessageActionOperation:case j.PNRemoveMessageActionOperation:case j.PNGetMessageActionsOperation:t=\"msga\";break;case j.PNAccessManagerGrant:case j.PNAccessManagerAudit:t=\"pam\";break;case j.PNAccessManagerGrantToken:case j.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),x=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),U=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,s={topic:t,environment:r};return i.length&&(s.excluded_devices=i),s},r}(x),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(x),D=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var s=r(i,[\"notification\",\"data\"]);e=n(n({},e),s)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(x),F=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new U(this._payload.apns,e,t),this.mpns=new I(this._payload.mpns,e,t),this.fcm=new D(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),L=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.includes(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=k.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=k.PNNetworkDownCategory,this.announceStatus(e)},e}(),G=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),s=n.pat.uuid?Object.keys(n.pat.uuid):[],a=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,h=i.length>0;(l||p||h)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),h&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var f=s.length>0,d=a.length>0,y=u.length>0;return(f||d||y)&&(c.patterns={},f&&(c.patterns.uuids={},s.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},a.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}();function K(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function B(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var H={signPamFromParams:function(e){return B(e).map((function(t){return\"\".concat(t,\"=\").concat(K(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:K,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},removeSingleOccurance:function(e,t){var n=Object.fromEntries(t.map((function(e){return[e,!1]})));return e.filter((function(e){return!(t.includes(e)&&!n[e])||(n[e]=!0,!1)}))},findUniqueCommonElements:function(e,t){return __spreadArray([],__read(e),!1).filter((function(n){return t.includes(n)&&e.indexOf(n)===e.lastIndexOf(n)&&t.indexOf(n)===t.lastIndexOf(n)}))}},q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,s=e.crypto,a=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(a=\"GET\"),\"GETFILE\"===a&&(a=\"GET\");var u=\"\".concat(a,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(H.signPamFromParams(n),\"\\n\");if(\"POST\"===a)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===a){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(s.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,s=e.config,a=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,h={};t.getOperation()===j.PNTimeOperation||t.getOperation()===j.PNChannelGroupsOperation?l=r[0]:(h=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=H.createPromise());var f=t.validateParams(e,h);if(f)return l?l(z(f)):p?(p.reject(new q(\"Validation failed, check status for details\",z(f))),p.promise):void 0;var d,g=t.prepareParams(e,h),m=V(t,e,h),b={url:m,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,h):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,h):null};g.uuid=s.UUID,g.pnsdk=W(s);var v=a.operationsLatencyForRequest();if(Object.keys(v).length&&(g=n(n({},g),v)),s.useInstanceId&&(g.instanceid=s.instanceId),s.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||s.getAuthKey();_&&(g.auth=_)}s.secretKey&&$(e,m,g,h,t);var S=function(n,r){if(n.error)return t.handleError&&t.handleError(e,h,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));a.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,h);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===j.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:k.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(a.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,h)){var w=t.postPayload(e,h);d=i.POST(g,w,b,S)}else if(\"PATCH\"===J(e,t,h)){w=t.patchPayload(e,h);d=i.PATCH(g,w,b,S)}else d=\"DELETE\"===J(e,t,h)?i.DELETE(g,b,S):\"GETFILE\"===J(e,t,h)?i.GETFILE(g,b,S):i.GET(g,b,S);return t.getOperation()===j.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a=t.start,u=t.count,c={type:r};return\"apns2\"===r&&delete(c=n(n({},c),{environment:i,topic:s})).type,a&&(c.start=a),u&&u>0&&(c.count=u),c},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a={type:r};return\"apns2\"===r&&delete(a=n(n({},a),{environment:i,topic:s})).type,a},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return j.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return j.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),o&&(s.state=JSON.stringify(o)),s.heartbeat=i.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,s=void 0===i?[]:i,a=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(a),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a={};return 1===o.length&&0===s.length?a[o[0]]=t.payload:a=t.payload,{channels:a}}});var le=Object.freeze({__proto__:null,getOperation:function(){return j.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,s=t.channelGroups,a=void 0===s?[]:s;return r?n.subscribeKey?0===i.length&&0===a.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/uuid/\").concat(H.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,s=void 0===i?[]:i,a=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||s.length>0){var u=o.length>0?o.join(\",\"):\",\";a+=\"/channel/\".concat(H.encodeString(u))}return a},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,s=void 0===i||i,a=t.includeState,u=void 0!==a&&a,c=t.queryParameters,l=void 0===c?{}:c,p={};return s||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||s.length>0||0===s.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var he=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var fe=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return j.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},me={getOperation:function(){return j.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(H.encodeString(t.channel),\"/0/\").concat(H.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},be=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,s=e.modules,a=s.PubNubFile,u=s.config,c=s.cryptography,l=s.cryptoModule,p=s.networking;return function(e){var s=e.channel,h=e.file,f=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,m=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,b,v,_,S,w,O,P,E,A,T,N,C,k,M,j,R,x,U,I,D,F,L,G,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!s)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!h)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=a.create(h),[4,n({channel:s,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,b=o.url,v=o.form_fields,_=t.data,S=_.id,w=_.name,a.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,a)]:[3,6];case 2:return O=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,a)];case 4:O=i.sent(),i.label=5;case 5:e=O,i.label=6;case 6:P=v,e.mimeType&&(P=v.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),a.supportsFileUri&&h.uri?(T=(A=p).POSTFILE,N=[b,P],[4,e.toFileUri()]):[3,10];case 8:return[4,T.apply(A,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return a.supportsFile?(k=(C=p).POSTFILE,M=[b,P],[4,e.toFile()]):[3,13];case 11:return[4,k.apply(C,M.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return a.supportsBuffer?(R=(j=p).POSTFILE,x=[b,P],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(j,x.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return a.supportsBlob?(I=(U=p).POSTFILE,D=[b,P],[4,e.toBlob()]):[3,19];case 17:return[4,I.apply(U,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(L=F.response.text,G=/<Message>(.*)<\\/Message>/gi.exec(L),new q(G?\"Upload to bucket failed: \".concat(G[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:s,message:f,fileId:S,fileName:w,meta:y,storeInHistory:m,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:S,name:w}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:s,id:S,name:w})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},ve=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,s=e.networking,a=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(H.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=a.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(s.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(s.getStandardOrigin()).concat(u)},_e={getOperation:function(){return j.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,s=e.config,a=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,a.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:s.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Se={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},we={getOperation:function(){return j.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Oe={getOperation:function(){return j.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Pe={getOperation:function(){return j.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return j.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ae={getOperation:function(){return j.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Te={getOperation:function(){return j.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return j.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return j.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return j.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&m.include.push(\"uuid\"),(null===(i=t.include)||void 0===i?void 0:i.customUUIDFields)&&m.include.push(\"uuid.custom\"),(null===(s=t.include)||void 0===s?void 0:s.UUIDStatusField)&&m.include.push(\"uuid.status\"),(null===(u=t.include)||void 0===u?void 0:u.UUIDTypeField)&&m.include.push(\"uuid.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return j.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&h.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&h.include.push(\"uuid\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return j.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&m.include.push(\"channel\"),(null===(i=t.include)||void 0===i?void 0:i.customChannelFields)&&m.include.push(\"channel.custom\"),(null===(s=t.include)||void 0===s?void 0:s.channelStatusField)&&m.include.push(\"channel.status\"),(null===(u=t.include)||void 0===u?void 0:u.channelTypeField)&&m.include.push(\"channel.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return j.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&h.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&h.include.push(\"channel\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var xe=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,s={};return n&&(s.channel=n),r&&(s[\"channel-group\"]=r),i.length>0&&(s.auth=i.join(\",\")),s},handleResponse:function(e,t){return t.payload}});var Ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.uuids,a=void 0===s?[]:s,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,h=void 0!==p&&p,f=t.manage,d=void 0!==f&&f,y=t.get,g=void 0!==y&&y,m=t.join,b=void 0!==m&&m,v=t.update,_=void 0!==v&&v,S=t.authKeys,w=void 0===S?[]:S,O=t.delete,P={};return P.r=l?\"1\":\"0\",P.w=h?\"1\":\"0\",P.m=d?\"1\":\"0\",P.d=O?\"1\":\"0\",P.g=g?\"1\":\"0\",P.j=b?\"1\":\"0\",P.u=_?\"1\":\"0\",r.length>0&&(P.channel=r.join(\",\")),i.length>0&&(P[\"channel-group\"]=i.join(\",\")),w.length>0&&(P.auth=w.join(\",\")),a.length>0&&(P[\"target-uuid\"]=a.join(\",\")),(u||0===u)&&(P.ttl=u),P},handleResponse:function(){return{}}});function Ie(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),s=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),a=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||s||c||a||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(Ie(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorizedUserId,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,h=o.spaces,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorized_uuid,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,h=o.channels,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}var Le=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,s,a,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),h=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),f=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.channels),y=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.groups),g=c||l||f||p||d||h||y;return Ie(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Ge={getOperation:function(){return j.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(H.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return j.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0/\").concat(H.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,s=t.ttl,a={};return null!=i&&(a.store=i?\"1\":\"0\"),s&&(a.ttl=s),!1===o&&(a.norep=\"true\"),n&&\"object\"==typeof n&&(a.meta=JSON.stringify(n)),a},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return j.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,s=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(H.encodeString(o),\"/0/\").concat(H.encodeString(s))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});var qe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,s=void 0===i?100:i,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=s,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message),o={timetoken:t.timetoken,entry:r.payload};t.meta&&(o.meta=t.meta),r.error&&(o.error=r.error),n.messages.push(o)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return j.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return j.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=a(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return j.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,s=e.config,a=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(a,\"/sub-key/\").concat(s.subscribeKey,\"/channel/\").concat(H.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,s=t.count,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,h=t.includeUUID,f=void 0===h||h,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=s||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),f&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={},i=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message);o.channel=r,o.timetoken=t.timetoken,o.message=i.payload,o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),i.error&&(o.error=i.error),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var Je=Object.freeze({__proto__:null,getOperation:function(){return j.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var $e=Object.freeze({__proto__:null,getOperation:function(){return j.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,s=t.timetoken,a=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),a&&a.length>0&&(c[\"filter-expr\"]=a),Object.keys(r).length&&(c.state=JSON.stringify(r)),s&&(c.tt=s),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={timetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return j.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,t.state&&(n.state=JSON.stringify(t.state)),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.ee=\"\",n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return j.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.tt=t.timetoken,n.tr=t.region,n.ee=\"\",n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=a(c,3),p=l[0],h=l[1],f=l[2];try{for(var d=s(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var m=this.currentState;this.currentState=p;var b=this.currentContext;this.currentContext=h,this.notify({type:\"transitionDone\",fromState:m,fromContext:b,toState:p,toContext:h,event:e});try{for(var v=s(f),_=v.next();!_.done;_=v.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}try{for(var S=s(this.currentState.enterEffects),w=S.next();!w.done;w=S.next()){g=w.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{w&&!w.done&&(u=S.return)&&u.call(S)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e.prototype.dispose=function(){var e,t;try{for(var n=s(this.instances.entries()),r=n.next();!r.done;r=n.next()){var o=a(r.value,2),i=o[0];o[1].cancel(),this.instances.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],a(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!1}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),st=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new it},n.prototype.abort=function(){this._aborted=!0,this.notify(new it)},n}(Ye),at=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new st,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch((function(e){}))},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),ut=function(e){return function(t,n){return new at(t,n,e)}},ct=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),lt=ot(\"RECEIVE_MESSAGES\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),pt=rt(\"EMIT_MESSAGES\",(function(e){return e})),ht=rt(\"EMIT_STATUS\",(function(e){return e})),ft=ot(\"RECEIVE_RECONNECT\",(function(e){return e})),dt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),yt=nt(\"SUBSCRIPTION_CHANGED\",(function(e,t){return{channels:e,groups:t}})),gt=nt(\"SUBSCRIPTION_RESTORED\",(function(e,t,n,r){return{channels:e,groups:t,cursor:{timetoken:n,region:null!=r?r:0}}})),mt=nt(\"HANDSHAKE_SUCCESS\",(function(e){return e})),bt=nt(\"HANDSHAKE_FAILURE\",(function(e){return e})),vt=nt(\"HANDSHAKE_RECONNECT_SUCCESS\",(function(e){return{cursor:e}})),_t=nt(\"HANDSHAKE_RECONNECT_FAILURE\",(function(e){return e})),St=nt(\"HANDSHAKE_RECONNECT_GIVEUP\",(function(e){return e})),wt=nt(\"RECEIVE_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Ot=nt(\"RECEIVE_FAILURE\",(function(e){return e})),Pt=nt(\"RECEIVE_RECONNECT_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Et=nt(\"RECEIVE_RECONNECT_FAILURE\",(function(e){return e})),At=nt(\"RECEIVING_RECONNECT_GIVEUP\",(function(e){return e})),Tt=nt(\"DISCONNECT\",(function(){return{}})),Nt=nt(\"RECONNECT\",(function(e,t){return{cursor:{timetoken:null!=e?e:\"\",region:null!=t?t:0}}})),Ct=nt(\"UNSUBSCRIBE_ALL\",(function(){return{}})),kt=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(ct.type,ut((function(e,r,a){var u=a.handshake,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:r.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:l.filterExpression},l.maintainPresenceState&&{state:c}))];case 2:return o=i.sent(),[2,t.transition(mt(o))];case 3:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(bt(s))]:[3,4];case 4:return[2]}}))}))}))),s.on(lt.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:u.filterExpression})];case 2:return r=i.sent(),t.transition(wt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q&&!n.aborted?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),s.on(pt.type,ut((function(e,t,n){var r=n.emitMessages;return o(s,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&r(e),[2]}))}))}))),s.on(ht.type,ut((function(e,t,n){var r=n.emitStatus;return o(s,void 0,void 0,(function(){return i(this,(function(t){return r(e),[2]}))}))}))),s.on(ft.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.delay,c=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return c.retryConfiguration&&c.retryConfiguration.shouldRetry(e.reason,e.attempts)?(n.throwIfAborted(),[4,u(c.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:c.filterExpression})];case 3:return r=i.sent(),[2,t.transition(Pt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Et(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(At(new q(c.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s.on(dt.type,ut((function(e,r,a){var u=a.handshake,c=a.delay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:p.filterExpression},p.maintainPresenceState&&{state:l}))];case 3:return o=i.sent(),[2,t.transition(vt(o))];case 4:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(_t(s))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(St(new q(p.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s}return t(r,e),r}(tt),Mt=new Ze(\"HANDSHAKE_FAILED\");Mt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Mt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor||e.cursor})})),Mt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region?t.payload.cursor.region:null!==(r=null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)&&void 0!==r?r:0}})})),Mt.on(Ct.type,(function(e){return Lt.with()}));var jt=new Ze(\"HANDSHAKE_STOPPED\");jt.on(yt.type,(function(e,t){return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),jt.on(Nt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor||e.cursor}))})),jt.on(gt.type,(function(e,t){var n;return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),jt.on(Ct.type,(function(e){return Lt.with()}));var Rt=new Ze(\"RECEIVE_FAILED\");Rt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Rt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(Ct.type,(function(e){return Lt.with(void 0)}));var xt=new Ze(\"RECEIVE_STOPPED\");xt.on(yt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),xt.on(gt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Ct.type,(function(){return Lt.with(void 0)}));var Ut=new Ze(\"RECEIVE_RECONNECTING\");Ut.onEnter((function(e){return ft(e)})),Ut.onExit((function(){return ft.cancel})),Ut.on(Pt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),Ut.on(Et.type,(function(e,t){return Ut.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ut.on(At.type,(function(e,t){var n;return Rt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNDisconnectedUnexpectedlyCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Ut.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),Ut.on(gt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Ut.on(yt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var It=new Ze(\"RECEIVING\");It.onEnter((function(e){return lt(e.channels,e.groups,e.cursor)})),It.onExit((function(){return lt.cancel})),It.on(wt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),It.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({cursor:e.cursor,channels:t.payload.channels,groups:t.payload.groups})})),It.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),It.on(Ot.type,(function(e,t){return Ut.with(n(n({},e),{attempts:0,reason:t.payload}))})),It.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),It.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var Dt=new Ze(\"HANDSHAKE_RECONNECTING\");Dt.onEnter((function(e){return dt(e)})),Dt.onExit((function(){return dt.cancel})),Dt.on(vt.type,(function(e,t){var n,r,o={timetoken:(null===(n=e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=e.cursor)||void 0===r?void 0:r.timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region};return It.with({channels:e.channels,groups:e.groups,cursor:o},[ht({category:k.PNConnectedCategory})])})),Dt.on(_t.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(St.type,(function(e,t){var n;return Mt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNConnectionErrorCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Dt.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Dt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Dt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:(null===(n=t.payload.cursor)||void 0===n?void 0:n.region)||(null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.region)||0}})})),Dt.on(Ct.type,(function(e){return Lt.with(void 0)}));var Ft=new Ze(\"HANDSHAKING\");Ft.onEnter((function(e){return ct(e.channels,e.groups)})),Ft.onExit((function(){return ct.cancel})),Ft.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ft.on(mt.type,(function(e,t){var n,r;return It.with({channels:e.channels,groups:e.groups,cursor:{timetoken:(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.timetoken:t.payload.timetoken,region:t.payload.region}},[ht({category:k.PNConnectedCategory})])})),Ft.on(bt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:e.cursor,attempts:0,reason:t.payload})})),Ft.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Ft.on(gt.type,(function(e,t){var n;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),Ft.on(Ct.type,(function(e){return Lt.with()}));var Lt=new Ze(\"UNSUBSCRIBED\");Lt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:t.payload.cursor})}));var Gt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dependencies=e,this.dispatcher=new kt(this.engine,e),this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Lt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=this,n=e.channels,r=e.channelGroups,o=e.timetoken,i=e.withPresence;this.channels=u(u([],a(this.channels),!1),a(null!=n?n:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=r?r:[]),!1),i&&(this.channels.map((function(e){return t.channels.push(\"\".concat(e,\"-pnpres\"))})),this.groups.map((function(e){return t.groups.push(\"\".concat(e,\"-pnpres\"))}))),o?this.engine.transition(gt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))),o)):this.engine.transition(yt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter((function(e){return!e.endsWith(\"-pnpres\")})))),groups:Array.from(new Set(this.groups.filter((function(e){return!e.endsWith(\"-pnpres\")}))))})},e.prototype.unsubscribe=function(e){var t=this,n=e.channels,r=void 0===n?[]:n,o=e.channelGroups,i=void 0===o?[]:o,s=H.removeSingleOccurance(this.channels,u(u([],a(r),!1),a(r.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1)),c=H.removeSingleOccurance(this.groups,u(u([],a(i),!1),a(i.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1));if(new Set(this.channels).size!==new Set(s).size||new Set(this.groups).size!==new Set(c).size){var l=H.findUniqueCommonElements(this.channels,r),p=H.findUniqueCommonElements(this.groups,i);this.dependencies.presenceState&&(null==l||l.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==p||p.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.channels=s,this.groups=c,this.engine.transition(yt(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:l.slice(0),groups:p.slice(0)})}},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(yt(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.reconnect=function(e){var t=e.timetoken,n=e.region;this.engine.transition(Nt(t,n))},e.prototype.disconnect=function(){this.engine.transition(Tt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},e.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},e.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),Kt=nt(\"RECONNECT\",(function(){return{}})),Bt=nt(\"DISCONNECT\",(function(){return{}})),Ht=nt(\"JOINED\",(function(e,t){return{channels:e,groups:t}})),qt=nt(\"LEFT\",(function(e,t){return{channels:e,groups:t}})),zt=nt(\"LEFT_ALL\",(function(){return{}})),Vt=nt(\"HEARTBEAT_SUCCESS\",(function(e){return{statusCode:e}})),Wt=nt(\"HEARTBEAT_FAILURE\",(function(e){return e})),Jt=nt(\"HEARTBEAT_GIVEUP\",(function(){return{}})),$t=nt(\"TIMES_UP\",(function(){return{}})),Qt=rt(\"HEARTBEAT\",(function(e,t){return{channels:e,groups:t}})),Xt=rt(\"LEAVE\",(function(e,t){return{channels:e,groups:t}})),Yt=rt(\"EMIT_STATUS\",(function(e){return e})),Zt=ot(\"WAIT\",(function(){return{}})),en=ot(\"DELAYED_HEARTBEAT\",(function(e){return e})),tn=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(Qt.type,ut((function(e,r,a){var u=a.heartbeat,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,u(n({channels:e.channels,channelGroups:e.groups},l.maintainPresenceState&&{state:c}))];case 1:return o.sent(),t.transition(Vt(200)),[3,3];case 2:return(r=o.sent())instanceof q?[2,t.transition(Wt(r))]:[3,3];case 3:return[2]}}))}))}))),s.on(Xt.type,ut((function(e,t,n){var r=n.leave,a=n.config;return o(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(a.suppressLeaveEvents)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r({channels:e.channels,channelGroups:e.groups})];case 2:case 3:return t.sent(),[3,4];case 4:return[2]}}))}))}))),s.on(Zt.type,ut((function(e,n,r){var a=r.heartbeatDelay;return o(s,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n.throwIfAborted(),[4,a()];case 1:return e.sent(),n.throwIfAborted(),[2,t.transition($t())]}}))}))}))),s.on(en.type,ut((function(e,r,a){var u=a.heartbeat,c=a.retryDelay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({channels:e.channels,channelGroups:e.groups},p.maintainPresenceState&&{state:l}))];case 3:return i.sent(),[2,t.transition(Vt(200))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Wt(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(Jt())];case 7:return[2]}}))}))}))),s.on(Yt.type,ut((function(e,t,r){var a=r.emitStatus,u=r.config;return o(s,void 0,void 0,(function(){var t;return i(this,(function(r){return u.announceFailedHeartbeats&&!0===(null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.error)?a(e.status):u.announceSuccessfulHeartbeats&&200===e.statusCode&&a(n(n({},e),{operation:j.PNHeartbeatOperation,error:!1})),[2]}))}))}))),s}return t(r,e),r}(tt),nn=new Ze(\"HEARTBEAT_STOPPED\");nn.on(Ht.type,(function(e,t){return nn.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),nn.on(qt.type,(function(e,t){return nn.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))})})),nn.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),nn.on(zt.type,(function(e,t){return un.with(void 0)}));var rn=new Ze(\"HEARTBEAT_COOLDOWN\");rn.onEnter((function(){return Zt()})),rn.onExit((function(){return Zt.cancel})),rn.on($t.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),rn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),rn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),rn.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),rn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var on=new Ze(\"HEARTBEAT_FAILED\");on.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),on.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),on.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),on.on(Bt.type,(function(e,t){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),on.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var sn=new Ze(\"HEARBEAT_RECONNECTING\");sn.onEnter((function(e){return en(e)})),sn.onExit((function(){return en.cancel})),sn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),sn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),sn.on(Bt.type,(function(e,t){nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),sn.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),sn.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),sn.on(Jt.type,(function(e,t){return on.with({channels:e.channels,groups:e.groups})})),sn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var an=new Ze(\"HEARTBEATING\");an.onEnter((function(e){return Qt(e.channels,e.groups)})),an.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),an.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),an.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),an.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:0,reason:t.payload}))})),an.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),an.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var un=new Ze(\"HEARTBEAT_INACTIVE\");un.on(Ht.type,(function(e,t){return an.with({channels:t.payload.channels,groups:t.payload.groups})}));var cn=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new tn(this.engine,e),this.dependencies=e,this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(un,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.join=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],a(this.channels),!1),a(null!=t?t:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=n?n:[]),!1),this.engine.transition(Ht(this.channels.slice(0),this.groups.slice(0)))},e.prototype.leave=function(e){var t=this,n=e.channels,r=e.groups;this.dependencies.presenceState&&(null==n||n.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==r||r.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.engine.transition(qt(null!=n?n:[],null!=r?r:[]))},e.prototype.leaveAll=function(){this.engine.transition(zt())},e.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),ln=function(){function e(){}return e.LinearRetryPolicy=function(e){return{delay:e.delay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:this.delay)+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e.ExponentialRetryPolicy=function(e){return{minimumDelay:e.minimumDelay,maximumDelay:e.maximumDelay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:Math.min(Math.pow(2,e),this.maximumDelay))+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e}(),pn=function(){function e(e){var t=e.modules,n=e.listenerManager,r=e.getFileUrl;this.modules=t,this.listenerManager=n,this.getFileUrl=r,this._channelListenerMap=new Map,this._groupListenerMap=new Map,t.cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.emitEvent=function(e){var t=e.channel,o=e.publishMetaData,i=e.subscriptionMatch;if(t===i&&(i=null),e.channel.endsWith(\"-pnpres\")){var s={channel:null,subscription:null};t&&(s.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(s.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=o.timetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announcePresence(s),this._announce(\"presence\",s,s.channel,s.subscription)}else if(1===e.messageType){(s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=e.payload,this.listenerManager.announceSignal(s),this._announce(\"signal\",s,s.channel,s.subscription)}else if(2===e.messageType){if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},this.listenerManager.announceObjects(s),this._announce(\"objects\",s,s.channel,s.subscription),\"uuid\"===e.payload.type){var a=this._renameChannelField(s),u=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"user\"})});this.listenerManager.announceUser(u),this._announce(\"user\",u,s.channel,s.subscription)}else if(\"channel\"===e.payload.type){a=this._renameChannelField(s);var c=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"space\"})});this.listenerManager.announceSpace(c),this._announce(\"space\",c,s.channel,s.subscription)}else if(\"membership\"===e.payload.type){var l=(a=this._renameChannelField(s)).message.data,p=l.uuid,h=l.channel,f=r(l,[\"uuid\",\"channel\"]);f.user=p,f.space=h;var d=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),data:f})});this.listenerManager.announceMembership(d),this._announce(\"membership\",d,s.channel,s.subscription)}}else if(3===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,s.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},s.event=e.payload.event,this.listenerManager.announceMessageAction(s),this._announce(\"messageAction\",s,s.channel,s.subscription)}else if(4===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId;var y=e.payload;if(this.modules.cryptoModule){var g=void 0;try{g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}null!==g&&(y=g)}e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=y.message,s.file={id:y.file.id,name:y.file.name,url:this.getFileUrl({id:y.file.id,name:y.file.name,channel:t})},this.listenerManager.announceFile(s),this._announce(\"file\",s,s.channel,s.subscription)}else{if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),this.modules.cryptoModule){g=void 0;try{var m;g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}s.message=null!=g?g:e.payload}else s.message=e.payload;s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announceMessage(s),this._announce(\"message\",s,s.channel,s.subscription)}},e.prototype.addListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){r._channelListenerMap[t]?r._channelListenerMap[t].includes(e)||r._channelListenerMap[t].push(e):r._channelListenerMap[t]=[e]})),null==n||n.forEach((function(t){r._groupListenerMap[t]?r._groupListenerMap[t].includes(e)||r._groupListenerMap[t].push(e):r._groupListenerMap[t]=[e]}))):this.listenerManager.addListener(e)},e.prototype.removeListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){var n;r._channelListenerMap[t]=null===(n=r._channelListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))})),null==n||n.forEach((function(t){var n;r._groupListenerMap[t]=null===(n=r._groupListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))}))):this.listenerManager.removeListener(e)},e.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e.prototype._announce=function(e,t,n,r){var o,i;null===(o=this._channelListenerMap[n])||void 0===o||o.forEach((function(n){return n[e]&&n[e](t)})),null===(i=this._groupListenerMap[r])||void 0===i||i.forEach((function(n){return n[e]&&n[e](t)}))},e}(),hn=function(){function e(){}return e.prototype.subscribe=function(){var e,t;this.pubnub.subscribe(n({channels:this.channelNames,channelGroups:this.groupNames},(null===(t=null===(e=this.options)||void 0===e?void 0:e.cursor)||void 0===t?void 0:t.timetoken)&&{timetoken:this.options.cursor.timetoken}))},e.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),channelGroups:this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))})},Object.defineProperty(e.prototype,\"onMessage\",{set:function(e){this.listener.message=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onPresence\",{set:function(e){this.listener.presence=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onSignal\",{set:function(e){this.listener.signal=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onObjects\",{set:function(e){this.listener.objects=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onMessageAction\",{set:function(e){this.listener.messageAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onFile\",{set:function(e){this.listener.file=e},enumerable:!1,configurable:!0}),e.prototype.addListener=function(e){this.eventEmitter.addListener(e,this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")})))},e.prototype.removeListener=function(e){this.eventEmitter.removeListener(e,this.channelNames,this.groupNames)},Object.defineProperty(e.prototype,\"channels\",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"channelGroups\",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),e}(),fn=function(e){function n(t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.subscriptionOptions,c=t.eventEmitter,l=t.pubnub,p=e.call(this)||this;return p.channelNames=[],p.groupNames=[],p.subscriptionList=[],p.options=s,p.eventEmitter=c,p.pubnub=l,r.forEach((function(e){var t=p.pubnub.channel(e).subscription(p.options);p.channelNames=u(u([],a(p.channelNames),!1),a(t.channels),!1),p.subscriptionList.push(t)})),i.forEach((function(e){var t=p.pubnub.channelGroup(e).subscription(p.options);p.groupNames=u(u([],a(p.groupNames),!1),a(t.channelGroups),!1),p.subscriptionList.push(t)})),p.listener={},c.addListener(p.listener,p.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),p.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),p}return t(n,e),n.prototype.addSubscription=function(e){this.subscriptionList.push(e),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscription=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return t!==e}))},n.prototype.addSubscriptionSet=function(e){this.subscriptionList=u(u([],a(this.subscriptionList),!1),a(e.subscriptions),!1),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscriptionSet=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return!e.subscriptions.includes(t)}))},Object.defineProperty(n.prototype,\"subscriptions\",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),n}(hn),dn=function(e){function r(t){var n=t.channels,r=t.channelGroups,o=t.subscriptionOptions,i=t.eventEmitter,s=t.pubnub,a=e.call(this)||this;return a.channelNames=[],a.groupNames=[],a.channelNames=n,a.groupNames=r,a.options=o,a.pubnub=s,a.eventEmitter=i,a.listener={},i.addListener(a.listener,a.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),a.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),a}return t(r,e),r.prototype.addSubscription=function(e){return new fn({channels:u(u([],a(this.channelNames),!1),a(e.channels),!1),channelGroups:u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),subscriptionOptions:n(n({},this.options),null==e?void 0:e.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},r}(hn),yn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),gn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[],channelGroups:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),mn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),bn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),vn=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var c=new T({config:i}),l=e.cryptography;r.init(i);var p=new G(i,o);this._tokenManager=p;var h=new R({maximumSamplesCount:6e4});this._telemetryManager=h;var f=this._config.cryptoModule,d={config:i,networking:r,crypto:c,cryptography:l,tokenManager:p,telemetryManager:h,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.encryptFile(t,this.File)):l.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.decryptFile(t,this.File)):l.decryptFile(e,t,this.File)};var y=Q.bind(this,d,Je),m=Q.bind(this,d,se),v=Q.bind(this,d,ue),_=Q.bind(this,d,le),S=Q.bind(this,d,$e),w=new L;if(this._listenerManager=w,this.iAmHere=Q.bind(this,d,ue),this.iAmAway=Q.bind(this,d,se),this.setPresenceState=Q.bind(this,d,le),this.handshake=Q.bind(this,d,Qe),this.receiveMessages=Q.bind(this,d,Xe),this._eventEmitter=new pn({modules:d,listenerManager:this._listenerManager,getFileUrl:function(e){return ve(d,e)}}),!0===i.enableEventEngine){if(i.maintainPresenceState&&(this.presenceState={},this.setState=function(e){var n,r;return null===(n=e.channels)||void 0===n||n.forEach((function(n){return t.presenceState[n]=e.state})),null===(r=e.channelGroups)||void 0===r||r.forEach((function(n){return t.presenceState[n]=e.state})),t.setPresenceState({channels:e.channels,channelGroups:e.channelGroups,state:t.presenceState})}),i.getHeartbeatInterval()){var O=new cn({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise((function(e){return setTimeout(e,1e3*d.config.getHeartbeatInterval())}))},retryDelay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},config:d.config,presenceState:this.presenceState,emitStatus:function(e){w.announceStatus(e)}});this.presenceEventEngine=O,this.join=this.presenceEventEngine.join.bind(O),this.leave=this.presenceEventEngine.leave.bind(O),this.leaveAll=this.presenceEventEngine.leaveAll.bind(O)}var P=new Gt({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:d.config,emitMessages:function(e){var n,r;try{for(var o=s(e),i=o.next();!i.done;i=o.next()){var a=i.value;t._eventEmitter.emitEvent(a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},emitStatus:function(e){w.announceStatus(e)}});this.subscribe=P.subscribe.bind(P),this.unsubscribe=P.unsubscribe.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.reconnect=P.reconnect.bind(P),this.disconnect=P.disconnect.bind(P),this.destroy=P.dispose.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.eventEngine=P}else{var E=new M({timeEndpoint:y,leaveEndpoint:m,heartbeatEndpoint:v,setStateEndpoint:_,subscribeEndpoint:S,crypto:d.crypto,config:d.config,listenerManager:w,getFileUrl:function(e){return ve(d,e)},cryptoModule:d.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=E.adaptSubscribeChange.bind(E),this.unsubscribe=E.adaptUnsubscribeChange.bind(E),this.disconnect=E.disconnect.bind(E),this.reconnect=E.reconnect.bind(E),this.unsubscribeAll=E.unsubscribeAll.bind(E),this.getSubscribedChannels=E.getSubscribedChannels.bind(E),this.getSubscribedChannelGroups=E.getSubscribedChannelGroups.bind(E),this.setState=E.adaptStateChange.bind(E),this.presence=E.adaptPresenceChange.bind(E),this.destroy=function(e){E.unsubscribeAll(e),E.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=p.parseToken.bind(p),this.setToken=p.setToken.bind(p),this.getToken=p.getToken.bind(p),this.channelGroups={listGroups:Q.bind(this,d,ee),listChannels:Q.bind(this,d,te),addChannels:Q.bind(this,d,X),removeChannels:Q.bind(this,d,Y),deleteGroup:Q.bind(this,d,Z)},this.push={addChannels:Q.bind(this,d,ne),removeChannels:Q.bind(this,d,re),deleteDevice:Q.bind(this,d,ie),listChannels:Q.bind(this,d,oe)},this.hereNow=Q.bind(this,d,pe),this.whereNow=Q.bind(this,d,ae),this.getState=Q.bind(this,d,ce),this.grant=Q.bind(this,d,Ue),this.grantToken=Q.bind(this,d,Le),this.audit=Q.bind(this,d,xe),this.revokeToken=Q.bind(this,d,Ge),this.publish=Q.bind(this,d,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,d,He),this.history=Q.bind(this,d,qe),this.deleteMessages=Q.bind(this,d,ze),this.messageCounts=Q.bind(this,d,Ve),this.fetchMessages=Q.bind(this,d,We),this.addMessageAction=Q.bind(this,d,he),this.removeMessageAction=Q.bind(this,d,fe),this.getMessageActions=Q.bind(this,d,de),this.listFiles=Q.bind(this,d,ye);var A=Q.bind(this,d,ge);this.publishFile=Q.bind(this,d,me),this.sendFile=be({generateUploadUrl:A,publishFile:this.publishFile,modules:d}),this.getFileUrl=function(e){return ve(d,e)},this.downloadFile=Q.bind(this,d,_e),this.deleteFile=Q.bind(this,d,Se),this.channel=function(e){return new yn(e,t._eventEmitter,t)},this.channelGroup=function(e){return new gn(e,t._eventEmitter,t)},this.channelMetadata=function(e){return new mn(e,t._eventEmitter,t)},this.userMetadata=function(e){return new bn(e,t._eventEmitter,t)},this.subscriptionSet=function(e){return new fn({channels:e.channels,channelGroups:e.channelGroups,subscriptionOptions:e.subscriptionOptions,eventEmitter:t._eventEmitter,pubnub:t})},this.objects={getAllUUIDMetadata:Q.bind(this,d,we),getUUIDMetadata:Q.bind(this,d,Oe),setUUIDMetadata:Q.bind(this,d,Pe),removeUUIDMetadata:Q.bind(this,d,Ee),getAllChannelMetadata:Q.bind(this,d,Ae),getChannelMetadata:Q.bind(this,d,Te),setChannelMetadata:Q.bind(this,d,Ne),removeChannelMetadata:Q.bind(this,d,Ce),getChannelMembers:Q.bind(this,d,ke),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"set\"},e)],a(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"delete\"},e)],a(r),!1))},getMemberships:Q.bind(this,d,je),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"set\"},e)],a(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"delete\"},e)],a(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,statusField:e.include.statusField,UUIDStatusField:e.include.userStatusField,UUIDTypeField:e.include.userTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,statusField:e.include.statusField,channelStatusField:e.include.spaceStatusField,channelTypeField:e.include.spaceTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=y,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&d.cryptoModule){var n=d.cryptoModule.encrypt(e);return\"string\"==typeof n?n:b(n)}return c.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=d.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return c.decrypt(e,t)},this.getAuthKey=d.config.getAuthKey.bind(d.config),this.setAuthKey=d.config.setAuthKey.bind(d.config),this.getUUID=d.config.getUUID.bind(d.config),this.setUUID=d.config.setUUID.bind(d.config),this.getUserId=d.config.getUserId.bind(d.config),this.setUserId=d.config.setUserId.bind(d.config),this.getFilterExpression=d.config.getFilterExpression.bind(d.config),this.setFilterExpression=d.config.setFilterExpression.bind(d.config),this.setCipherKey=function(t){return d.config.setCipherKey(t,e,d)},this.setHeartbeatInterval=d.config.setHeartbeatInterval.bind(d.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){d.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new F(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=j,e.CATEGORIES=k,e.LinearRetryPolicy=ln.LinearRetryPolicy,e.ExponentialRetryPolicy=ln.ExponentialRetryPolicy,e}(),_n=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return k.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return k.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return k.PNNetworkIssuesCategory;if(e.timeout)return k.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return k.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return k.PNBadRequestCategory;if(e.response.forbidden)return k.PNAccessDeniedCategory}return k.PNUnknownCategory},e}();function Sn(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,s=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(s)?Sn(s):s})),n}var wn=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),On={exports:{}},Pn={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Pn);var En=Mn;Mn.default=Mn,Mn.stable=Un,Mn.stableStringify=Un;var An=\"[...]\",Tn=\"[Circular]\",Nn=[],Cn=[];function kn(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Mn(e,t,n,r){var o;void 0===r&&(r=kn()),Rn(e,\"\",0,[],void 0,0,r);try{o=0===Cn.length?JSON.stringify(e,t,n):JSON.stringify(e,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var i=Nn.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function jn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Nn.push([r,n,t,o])):Cn.push([t,n,e]):(r[n]=e,Nn.push([r,n,t]))}function Rn(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)Rn(e[a],a,a,r,e,i,s);else{var u=Object.keys(e);for(a=0;a<u.length;a++){var c=u[a];Rn(e[c],c,a,r,e,i,s)}}r.pop()}}function xn(e,t){return e<t?-1:e>t?1:0}function Un(e,t,n,r){void 0===r&&(r=kn());var o,i=In(e,\"\",0,[],void 0,0,r)||e;try{o=0===Cn.length?JSON.stringify(i,t,n):JSON.stringify(i,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var s=Nn.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function In(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)In(e[a],a,a,r,e,i,s);else{var u={},c=Object.keys(e).sort(xn);for(a=0;a<c.length;a++){var l=c[a];In(e[l],l,a,r,e,i,s),u[l]=e[l]}if(void 0===o)return u;Nn.push([o,t,e]),o[t]=u}r.pop()}}function Dn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Cn.length>0)for(var r=0;r<Cn.length;r++){var o=Cn[r];if(o[1]===t&&o[0]===n){n=o[2],Cn.splice(r,1);break}}return e.call(this,t,n)}}var Fn,Ln=\"undefined\"!=typeof Symbol&&Symbol,Gn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},Kn=\"Function.prototype.bind called on incompatible \",Bn=Array.prototype.slice,Hn=Object.prototype.toString,qn=\"[object Function]\",zn=function(e){var t=this;if(\"function\"!=typeof t||Hn.call(t)!==qn)throw new TypeError(Kn+t);for(var n,r=Bn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(Bn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(Bn.call(arguments)))},i=Math.max(0,t.length-r.length),s=[],a=0;a<i;a++)s.push(\"$\"+a);if(n=Function(\"binder\",\"return function (\"+s.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},Vn=Function.prototype.bind||zn,Wn=Vn.call(Function.call,Object.prototype.hasOwnProperty),Jn=SyntaxError,$n=Function,Qn=TypeError,Xn=function(e){try{return $n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Yn=Object.getOwnPropertyDescriptor;if(Yn)try{Yn({},\"\")}catch(e){Yn=null}var Zn=function(){throw new Qn},er=Yn?function(){try{return Zn}catch(e){try{return Yn(arguments,\"callee\").get}catch(e){return Zn}}}():Zn,tr=\"function\"==typeof Ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof Ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&Gn(),nr=Object.getPrototypeOf||function(e){return e.__proto__},rr={},or=\"undefined\"==typeof Uint8Array?Fn:nr(Uint8Array),ir={\"%AggregateError%\":\"undefined\"==typeof AggregateError?Fn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?Fn:ArrayBuffer,\"%ArrayIteratorPrototype%\":tr?nr([][Symbol.iterator]()):Fn,\"%AsyncFromSyncIteratorPrototype%\":Fn,\"%AsyncFunction%\":rr,\"%AsyncGenerator%\":rr,\"%AsyncGeneratorFunction%\":rr,\"%AsyncIteratorPrototype%\":rr,\"%Atomics%\":\"undefined\"==typeof Atomics?Fn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?Fn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?Fn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?Fn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?Fn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?Fn:FinalizationRegistry,\"%Function%\":$n,\"%GeneratorFunction%\":rr,\"%Int8Array%\":\"undefined\"==typeof Int8Array?Fn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?Fn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?Fn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":tr?nr(nr([][Symbol.iterator]())):Fn,\"%JSON%\":\"object\"==typeof JSON?JSON:Fn,\"%Map%\":\"undefined\"==typeof Map?Fn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&tr?nr((new Map)[Symbol.iterator]()):Fn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?Fn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?Fn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?Fn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?Fn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&tr?nr((new Set)[Symbol.iterator]()):Fn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?Fn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":tr?nr(\"\"[Symbol.iterator]()):Fn,\"%Symbol%\":tr?Symbol:Fn,\"%SyntaxError%\":Jn,\"%ThrowTypeError%\":er,\"%TypedArray%\":or,\"%TypeError%\":Qn,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?Fn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?Fn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?Fn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?Fn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?Fn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?Fn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?Fn:WeakSet},sr=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Xn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Xn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Xn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=nr(o.prototype))}return ir[t]=n,n},ar={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},ur=Vn,cr=Wn,lr=ur.call(Function.call,Array.prototype.concat),pr=ur.call(Function.apply,Array.prototype.splice),hr=ur.call(Function.call,String.prototype.replace),fr=ur.call(Function.call,String.prototype.slice),dr=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,yr=/\\\\(\\\\)?/g,gr=function(e){var t=fr(e,0,1),n=fr(e,-1);if(\"%\"===t&&\"%\"!==n)throw new Jn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new Jn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return hr(e,dr,(function(e,t,n,o){r[r.length]=n?hr(o,yr,\"$1\"):t||e})),r},mr=function(e,t){var n,r=e;if(cr(ar,r)&&(r=\"%\"+(n=ar[r])[0]+\"%\"),cr(ir,r)){var o=ir[r];if(o===rr&&(o=sr(r)),void 0===o&&!t)throw new Qn(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new Jn(\"intrinsic \"+e+\" does not exist!\")},br=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new Qn(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new Qn('\"allowMissing\" argument must be a boolean');var n=gr(e),r=n.length>0?n[0]:\"\",o=mr(\"%\"+r+\"%\",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],pr(n,lr([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],h=fr(p,0,1),f=fr(p,-1);if(('\"'===h||\"'\"===h||\"`\"===h||'\"'===f||\"'\"===f||\"`\"===f)&&h!==f)throw new Jn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(a=!0),cr(ir,i=\"%\"+(r+=\".\"+p)+\"%\"))s=ir[i];else if(null!=s){if(!(p in s)){if(!t)throw new Qn(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Yn&&c+1>=n.length){var d=Yn(s,p);s=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:s[p]}else l=cr(s,p),s=s[p];l&&!a&&(ir[i]=s)}}return s},vr={exports:{}};!function(e){var t=Vn,n=br,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),s=n(\"%Object.getOwnPropertyDescriptor%\",!0),a=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(a)try{a({},\"a\",{value:1})}catch(e){a=null}e.exports=function(e){var n=i(t,o,arguments);if(s&&a){var r=s(n,\"length\");r.configurable&&a(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};a?a(e.exports,\"apply\",{value:c}):e.exports.apply=c}(vr);var _r=br,Sr=vr.exports,wr=Sr(_r(\"String.prototype.indexOf\")),Or=l(Object.freeze({__proto__:null,default:{}})),Pr=\"function\"==typeof Map&&Map.prototype,Er=Object.getOwnPropertyDescriptor&&Pr?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Ar=Pr&&Er&&\"function\"==typeof Er.get?Er.get:null,Tr=Pr&&Map.prototype.forEach,Nr=\"function\"==typeof Set&&Set.prototype,Cr=Object.getOwnPropertyDescriptor&&Nr?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,kr=Nr&&Cr&&\"function\"==typeof Cr.get?Cr.get:null,Mr=Nr&&Set.prototype.forEach,jr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,xr=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Ur=Boolean.prototype.valueOf,Ir=Object.prototype.toString,Dr=Function.prototype.toString,Fr=String.prototype.match,Lr=String.prototype.slice,Gr=String.prototype.replace,Kr=String.prototype.toUpperCase,Br=String.prototype.toLowerCase,Hr=RegExp.prototype.test,qr=Array.prototype.concat,zr=Array.prototype.join,Vr=Array.prototype.slice,Wr=Math.floor,Jr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,$r=Object.getOwnPropertySymbols,Qr=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Xr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Yr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xr||\"symbol\")?Symbol.toStringTag:null,Zr=Object.prototype.propertyIsEnumerable,eo=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function to(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||Hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-Wr(-e):Wr(e);if(r!==e){var o=String(r),i=Lr.call(t,o.length+1);return Gr.call(o,n,\"$&_\")+\".\"+Gr.call(Gr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return Gr.call(t,n,\"$&_\")}var no=Or,ro=no.custom,oo=co(ro)?ro:null;function io(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function so(e){return Gr.call(String(e),/\"/g,\"&quot;\")}function ao(e){return!(\"[object Array]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function uo(e){return!(\"[object RegExp]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function co(e){if(Xr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Qr)return!1;try{return Qr.call(e),!0}catch(e){}return!1}var lo=Object.prototype.hasOwnProperty||function(e){return e in this};function po(e,t){return lo.call(e,t)}function ho(e){return Ir.call(e)}function fo(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function yo(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return yo(Lr.call(e,0,t.maxStringLength),t)+r}return io(Gr.call(Gr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,go),\"single\",t)}function go(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+Kr.call(t.toString(16))}function mo(e){return\"Object(\"+e+\")\"}function bo(e){return e+\" { ? }\"}function vo(e,t,n,r){return e+\" (\"+t+\") {\"+(r?_o(n,r):zr.call(n,\", \"))+\"}\"}function _o(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+zr.call(e,\",\"+n)+\"\\n\"+t.prev}function So(e,t){var n=ao(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=po(e,o)?t(e[o],e):\"\"}var i,s=\"function\"==typeof $r?$r(e):[];if(Xr){i={};for(var a=0;a<s.length;a++)i[\"$\"+s[a]]=s[a]}for(var u in e)po(e,u)&&(n&&String(Number(u))===u&&u<e.length||Xr&&i[\"$\"+u]instanceof Symbol||(Hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof $r)for(var c=0;c<s.length;c++)Zr.call(e,s[c])&&r.push(\"[\"+t(s[c])+\"]: \"+t(e[s[c]],e));return r}var wo=br,Oo=function(e,t){var n=_r(e,!!t);return\"function\"==typeof n&&wr(e,\".prototype.\")>-1?Sr(n):n},Po=function e(t,n,r,o){var i=n||{};if(po(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(po(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var s=!po(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof s&&\"symbol\"!==s)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(po(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(po(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var a=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return yo(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return a?to(t,u):u}if(\"bigint\"==typeof t){var l=String(t)+\"n\";return a?to(t,l):l}var p=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=p&&p>0&&\"object\"==typeof t)return ao(t)?\"[Array]\":\"[Object]\";var h=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=zr.call(Array(e.indent+1),\" \")}return{base:n,prev:zr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(fo(o,t)>=0)return\"[Circular]\";function f(t,n,s){if(n&&(o=Vr.call(o)).push(n),s){var a={depth:i.depth};return po(i,\"quoteStyle\")&&(a.quoteStyle=i.quoteStyle),e(t,a,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!uo(t)){var d=function(e){if(e.name)return e.name;var t=Fr.call(Dr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),y=So(t,f);return\"[Function\"+(d?\": \"+d:\" (anonymous)\")+\"]\"+(y.length>0?\" { \"+zr.call(y,\", \")+\" }\":\"\")}if(co(t)){var g=Xr?Gr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Qr.call(t);return\"object\"!=typeof t||Xr?g:mo(g)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var m=\"<\"+Br.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)m+=\" \"+b[v].name+\"=\"+io(so(b[v].value),\"double\",i);return m+=\">\",t.childNodes&&t.childNodes.length&&(m+=\"...\"),m+=\"</\"+Br.call(String(t.nodeName))+\">\"}if(ao(t)){if(0===t.length)return\"[]\";var _=So(t,f);return h&&!function(e){for(var t=0;t<e.length;t++)if(fo(e[t],\"\\n\")>=0)return!1;return!0}(_)?\"[\"+_o(_,h)+\"]\":\"[ \"+zr.call(_,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)){var S=So(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Zr.call(t,\"cause\")?0===S.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+zr.call(S,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+zr.call(qr.call(\"[cause]: \"+f(t.cause),S),\", \")+\" }\"}if(\"object\"==typeof t&&s){if(oo&&\"function\"==typeof t[oo]&&no)return no(t,{depth:p-r});if(\"symbol\"!==s&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Ar||!e||\"object\"!=typeof e)return!1;try{Ar.call(e);try{kr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var w=[];return Tr&&Tr.call(t,(function(e,n){w.push(f(n,t,!0)+\" => \"+f(e,t))})),vo(\"Map\",Ar.call(t),w,h)}if(function(e){if(!kr||!e||\"object\"!=typeof e)return!1;try{kr.call(e);try{Ar.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var O=[];return Mr&&Mr.call(t,(function(e){O.push(f(e,t))})),vo(\"Set\",kr.call(t),O,h)}if(function(e){if(!jr||!e||\"object\"!=typeof e)return!1;try{jr.call(e,jr);try{Rr.call(e,Rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return bo(\"WeakMap\");if(function(e){if(!Rr||!e||\"object\"!=typeof e)return!1;try{Rr.call(e,Rr);try{jr.call(e,jr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return bo(\"WeakSet\");if(function(e){if(!xr||!e||\"object\"!=typeof e)return!1;try{return xr.call(e),!0}catch(e){}return!1}(t))return bo(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!Jr)return!1;try{return Jr.call(e),!0}catch(e){}return!1}(t))return mo(f(Jr.call(t)));if(function(e){return!(\"[object Boolean]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(Ur.call(t));if(function(e){return!(\"[object String]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(String(t)));if(\"undefined\"!=typeof window&&t===window)return\"{ [object Window] }\";if(t===c)return\"{ [object globalThis] }\";if(!function(e){return!(\"[object Date]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)&&!uo(t)){var P=So(t,f),E=eo?eo(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?\"\":\"null prototype\",T=!E&&Yr&&Object(t)===t&&Yr in t?Lr.call(ho(t),8,-1):A?\"Object\":\"\",N=(E||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||A?\"[\"+zr.call(qr.call([],T||[],A||[]),\": \")+\"] \":\"\");return 0===P.length?N+\"{}\":h?N+\"{\"+_o(P,h)+\"}\":N+\"{ \"+zr.call(P,\", \")+\" }\"}return String(t)},Eo=wo(\"%TypeError%\"),Ao=wo(\"%WeakMap%\",!0),To=wo(\"%Map%\",!0),No=Oo(\"WeakMap.prototype.get\",!0),Co=Oo(\"WeakMap.prototype.set\",!0),ko=Oo(\"WeakMap.prototype.has\",!0),Mo=Oo(\"Map.prototype.get\",!0),jo=Oo(\"Map.prototype.set\",!0),Ro=Oo(\"Map.prototype.has\",!0),xo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},Uo=String.prototype.replace,Io=/%20/g,Do=\"RFC3986\",Fo={default:Do,formatters:{RFC1738:function(e){return Uo.call(e,Io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:Do},Lo=Fo,Go=Object.prototype.hasOwnProperty,Ko=Array.isArray,Bo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),Ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},qo={arrayToObject:Ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],s=Object.keys(i),a=0;a<s.length;++a){var u=s[a],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(Ko(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var s=\"\",a=0;a<i.length;++a){var u=i.charCodeAt(a);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Lo.RFC1738&&(40===u||41===u)?s+=i.charAt(a):u<128?s+=Bo[u]:u<2048?s+=Bo[192|u>>6]+Bo[128|63&u]:u<55296||u>=57344?s+=Bo[224|u>>12]+Bo[128|u>>6&63]+Bo[128|63&u]:(a+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(a)),s+=Bo[240|u>>18]+Bo[128|u>>12&63]+Bo[128|u>>6&63]+Bo[128|63&u])}return s},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Ko(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(Ko(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!Go.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return Ko(t)&&!Ko(n)&&(o=Ho(t,r)),Ko(t)&&Ko(n)?(n.forEach((function(n,o){if(Go.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return Go.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},zo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new Eo(\"Side channel does not contain \"+Po(e))},get:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return No(e,r)}else if(To){if(t)return Mo(t,r)}else if(n)return function(e,t){var n=xo(e,t);return n&&n.value}(n,r)},has:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return ko(e,r)}else if(To){if(t)return Ro(t,r)}else if(n)return function(e,t){return!!xo(e,t)}(n,r);return!1},set:function(r,o){Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Ao),Co(e,r,o)):To?(t||(t=new To),jo(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=xo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},Vo=qo,Wo=Fo,Jo=Object.prototype.hasOwnProperty,$o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Qo=Array.isArray,Xo=Array.prototype.push,Yo=function(e,t){Xo.apply(e,Qo(t)?t:[t])},Zo=Date.prototype.toISOString,ei=Wo.default,ti={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:Vo.encode,encodeValuesOnly:!1,format:ei,formatter:Wo.formatters[ei],indices:!1,serializeDate:function(e){return Zo.call(e)},skipNulls:!1,strictNullHandling:!1},ni={},ri=function e(t,n,r,o,i,s,a,u,c,l,p,h,f,d,y,g){for(var m,b=t,v=g,_=0,S=!1;void 0!==(v=v.get(ni))&&!S;){var w=v.get(t);if(_+=1,void 0!==w){if(w===_)throw new RangeError(\"Cyclic object value\");S=!0}void 0===v.get(ni)&&(_=0)}if(\"function\"==typeof u?b=u(n,b):b instanceof Date?b=p(b):\"comma\"===r&&Qo(b)&&(b=Vo.maybeMap(b,(function(e){return e instanceof Date?p(e):e}))),null===b){if(i)return a&&!d?a(n,ti.encoder,y,\"key\",h):n;b=\"\"}if(\"string\"==typeof(m=b)||\"number\"==typeof m||\"boolean\"==typeof m||\"symbol\"==typeof m||\"bigint\"==typeof m||Vo.isBuffer(b))return a?[f(d?n:a(n,ti.encoder,y,\"key\",h))+\"=\"+f(a(b,ti.encoder,y,\"value\",h))]:[f(n)+\"=\"+f(String(b))];var O,P=[];if(void 0===b)return P;if(\"comma\"===r&&Qo(b))d&&a&&(b=Vo.maybeMap(b,a)),O=[{value:b.length>0?b.join(\",\")||null:void 0}];else if(Qo(u))O=u;else{var E=Object.keys(b);O=c?E.sort(c):E}for(var A=o&&Qo(b)&&1===b.length?n+\"[]\":n,T=0;T<O.length;++T){var N=O[T],C=\"object\"==typeof N&&void 0!==N.value?N.value:b[N];if(!s||null!==C){var k=Qo(b)?\"function\"==typeof r?r(A,N):A:A+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var M=zo();M.set(ni,g),Yo(P,e(C,k,r,o,i,s,\"comma\"===r&&d&&Qo(b)?null:a,u,c,l,p,h,f,d,y,M))}}return P},oi=qo,ii=Object.prototype.hasOwnProperty,si=Array.isArray,ai={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:oi.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ui=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},ci=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},li=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,s=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),a=s?o.slice(0,s.index):o,u=[];if(a){if(!n.plainObjects&&ii.call(Object.prototype,a)&&!n.allowPrototypes)return;u.push(a)}for(var c=0;n.depth>0&&null!==(s=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&ii.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push(\"[\"+o.slice(s.index)+\"]\"),function(e,t,n,r){for(var o=r?t:ci(t,n),i=e.length-1;i>=0;--i){var s,a=e[i];if(\"[]\"===a&&n.parseArrays)s=[].concat(o);else{s=n.plainObjects?Object.create(null):{};var u=\"[\"===a.charAt(0)&&\"]\"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&a!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(s=[])[c]=o:\"__proto__\"!==u&&(s[u]=o):s={0:o}}o=s}return o}(u,t,n,r)}},pi=function(e,t){var n,r=e,o=function(e){if(!e)return ti;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||ti.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=Wo.default;if(void 0!==e.format){if(!Jo.call(Wo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=Wo.formatters[n],o=ti.filter;return(\"function\"==typeof e.filter||Qo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:ti.addQueryPrefix,allowDots:void 0===e.allowDots?ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ti.charsetSentinel,delimiter:void 0===e.delimiter?ti.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:ti.encode,encoder:\"function\"==typeof e.encoder?e.encoder:ti.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ti.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:ti.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:ti.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ti.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Qo(o.filter)&&(n=o.filter);var i,s=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in $o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var a=$o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===a&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=zo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Yo(s,ri(r[p],p,a,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var h=s.join(o.delimiter),f=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?f+=\"utf8=%26%2310003%3B&\":f+=\"utf8=%E2%9C%93&\"),h.length>0?f+h:\"\"},hi={formats:Fo,parse:function(e,t){var n=function(e){if(!e)return ai;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?ai.charset:e.charset;return{allowDots:void 0===e.allowDots?ai.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:ai.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:ai.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:ai.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ai.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:ai.comma,decoder:\"function\"==typeof e.decoder?e.decoder:ai.decoder,delimiter:\"string\"==typeof e.delimiter||oi.isRegExp(e.delimiter)?e.delimiter:ai.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:ai.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:ai.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:ai.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:ai.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ai.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,i),a=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<s.length;++n)0===s[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===s[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===s[n]&&(u=\"iso-8859-1\"),a=n,n=s.length);for(n=0;n<s.length;++n)if(n!==a){var c,l,p=s[n],h=p.indexOf(\"]=\"),f=-1===h?p.indexOf(\"=\"):h+1;-1===f?(c=t.decoder(p,ai.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,f),ai.decoder,u,\"key\"),l=oi.maybeMap(ci(p.slice(f+1),t),(function(e){return t.decoder(e,ai.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=ui(l)),p.indexOf(\"[]=\")>-1&&(l=si(l)?[l]:l),ii.call(r,c)?r[c]=oi.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),s=0;s<i.length;++s){var a=i[s],u=li(a,r[a],n,\"string\"==typeof e);o=oi.merge(o,u,n)}return!0===n.allowSparse?o:oi.compact(o)},stringify:pi},fi={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(fi);const di=Or,yi=fi.isObject,gi=fi.hasOwn;var mi=bi;function bi(){}bi.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},bi.prototype.parse=function(e){return this._parser=e,this},bi.prototype.responseType=function(e){return this._responseType=e,this},bi.prototype.serialize=function(e){return this._serializer=e,this},bi.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(gi(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},bi.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const vi=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),_i=new Set([408,413,429,500,502,503,504,521,522,524]);bi.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&_i.has(t.status))return!0;if(e){if(e.code&&vi.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},bi.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},bi.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},bi.prototype.catch=function(e){return this.then(void 0,e)},bi.prototype.use=function(e){return e(this),this},bi.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},bi.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},bi.prototype.get=function(e){return this._header[e.toLowerCase()]},bi.prototype.getHeader=bi.prototype.get,bi.prototype.set=function(e,t){if(yi(e)){for(const t in e)gi(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},bi.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},bi.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(yi(e)){for(const t in e)gi(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)gi(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},bi.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(di.gte(process.version,\"v13.0.0\")&&di.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},bi.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},bi.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},bi.prototype.redirects=function(e){return this._maxRedirects=e,this},bi.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},bi.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},bi.prototype.send=function(e){const t=yi(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&yi(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");gi(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},bi.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},bi.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},bi.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},bi.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},bi.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Si=fi;var wi=Oi;function Oi(){}function Pi(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ai(){this._defaults=[]}Oi.prototype.get=function(e){return this.header[e.toLowerCase()]},Oi.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Si.type(t);const n=Si.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Si.parseLinks(e.link))}catch(e){}},Oi.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Ti=0,Ni=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Ti<Ni.length;Ti++){const e=Ni[Ti];Ai.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Ai.prototype._setDefaults=function(e){var t,n=Pi(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Ci=Ai;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Pn.exports,s=En,a=hi,u=mi,c=fi.isObject,l=fi.mixin,p=fi.hasOwn,h=wi,f=Ci;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=w,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function m(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&b(t,n,e[n]);return t.join(\"&\")}function b(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){b(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&b(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function v(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function S(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,s;for(let e=0,a=t.length;e<a;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),s=g(o.slice(r+1)),n[i]=s);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new S(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=m,y.parseString=v,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":a.stringify,\"application/json\":s},y.parse={\"application/x-www-form-urlencoded\":v,\"application/json\":JSON.parse},l(S.prototype,h.prototype),S.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},S.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=S,i(w.prototype),l(w.prototype,u.prototype),w.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},w.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},w.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},w.prototype.query=function(e){return\"string\"!=typeof e&&(e=m(e)),e&&this._query.push(e),this},w.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},w.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},w.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},w.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},w.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new f;for(var O=0,P=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];O<P.length;O++){const e=P[O];f.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}f.prototype.del=f.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(On,On.exports);var ki=On.exports;function Mi(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ji(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(Mi)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:k.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,s={};if(s.error=null!==e,s.operation=t.operation,o&&o.status&&(s.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{s.errorData=JSON.parse(e.response.text)}catch(t){s.errorData=e}else s.errorData=e;return s.category=r._detectErrorCategory(e),n(s,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return s.errorData=o,s.error=!0,n(s,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(s.errorData=i,s.statusCode=i.status,s.error=!0,s.category=r._detectErrorCategory(s),n(s,null)):(i.error&&i.error.message&&(s.errorData=i.error),n(s,i))})),o}function Ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ki.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function xi(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ui(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ii(e,t,n,r){var o=ki.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Di(e,t,n,r){var o=ki.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Fi(e,t,n){var r=ki.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var Gi,Ki=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:s})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,data:s})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=Li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return s=i.sent(),a=Li(r.buffer,s),[2,e.decoder.decode(a)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),s=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,s)];case 1:return a=i.sent(),[2,e.decoder.decode(a)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Bi=(Gi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),Gi.supportsFile=\"undefined\"!=typeof File,Gi.supportsBlob=\"undefined\"!=typeof Blob,Gi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,Gi.supportsBuffer=!1,Gi.supportsStream=!1,Gi.supportsString=!0,Gi.supportsEncryptFile=!0,Gi.supportsFileUri=!1,Gi),Hi=function(){function e(e){this.config=e,this.cryptor=new T({config:e}),this.fileCryptor=new Ki}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:b(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),qi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:m(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),zi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new qi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new qi({cipherKey:e.cipherKey}),cryptors:[new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],a(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?m(e):e,n=Vi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===Vi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=Vi.tryParse(r),(null==(s=this.getCryptor(o))?void 0:s.identifier)===e.LEGACY_IDENTIFIER?[2,s.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return a=i.sent(),u=a.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof Wi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=Vi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Vi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new Wi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var s=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return s=n[i],i+=1,255===s&&n.byteLength>=i+2&&(s=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new Wi(this.decoder.decode(o),s)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),Wi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return Vi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return Vi.SENTINEL.length+1+Vi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(Vi.SENTINEL)),t[e+=Vi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=Vi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function Ji(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var $i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new _n({del:Fi,get:Ui,post:Ii,patch:Di,sendBeacon:Ji,getfile:xi,postfile:Ri}),t.cbor=new wn((function(e){return Sn(h.decode(e))}),m),t.PubNubFile=Bi,t.cryptography=new Ki,t.initCryptoModule=function(e){return new zi({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new qi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=zi,n}(vn);return $i}));",
          "",
          "[Added Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(f,f.exports);var d=f.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o,i=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=i.secretKey||i.secret_key,this.subscribeKey=i.subscribeKey||i.subscribe_key,this.publishKey=i.publishKey||i.publish_key,this.sdkName=i.sdkName,this.sdkFamily=i.sdkFamily,this.partnerId=i.partnerId,this.setAuthKey(i.authKey),this.cryptoModule=i.cryptoModule,this.setFilterExpression(i.filterExpression),\"string\"!=typeof i.origin&&!Array.isArray(i.origin)&&void 0!==i.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=i.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=i.ssl||!1,this.restore=i.restore||!1,this.proxy=i.proxy,this.keepAlive=i.keepAlive,this.keepAliveSettings=i.keepAliveSettings,this.autoNetworkDetection=i.autoNetworkDetection||!1,this.dedupeOnSubscribe=i.dedupeOnSubscribe||!1,this.maximumCacheSize=i.maximumCacheSize||100,this.customEncrypt=i.customEncrypt,this.customDecrypt=i.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=i.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=i.useRandomIVs)||void 0===n||n,this.enableEventEngine=null!==(r=i.enableEventEngine)&&void 0!==r&&r,this.maintainPresenceState=null===(o=i.maintainPresenceState)||void 0===o||o,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=i.logVerbosity||!1,this.suppressLeaveEvents=i.suppressLeaveEvents||!1,this.announceFailedHeartbeats=i.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=i.announceSuccessfulHeartbeats||!1,this.useInstanceId=i.useInstanceId||!1,this.useRequestId=i.useRequestId||!1,this.requestMessageCountThreshold=i.requestMessageCountThreshold,i.retryConfiguration&&this._setRetryConfiguration(i.retryConfiguration),this.setTransactionTimeout(i.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(i.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(i.useSendBeacon||!0),i.presenceTimeout?this.setPresenceTimeout(i.presenceTimeout):this._presenceTimeout=300,null!=i.heartbeatInterval&&this.setHeartbeatInterval(i.heartbeatInterval),\"string\"==typeof i.userId){if(\"string\"==typeof i.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(i.userId)}else{if(\"string\"!=typeof i.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(i.uuid)}this.setCipherKey(i.cipherKey,i)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.6.3\"},e.prototype._setRetryConfiguration=function(e){if(e.minimumdelay<2)throw new Error(\"Minimum delay can not be set less than 2 seconds for retry\");if(e.maximumDelay>150)throw new Error(\"Maximum delay can not be set more than 150 seconds for retry\");if(e.maximumDelay&&maximumRetry>6)throw new Error(\"Maximum retry for exponential retry policy can not be more than 6\");if(e.maximumRetry>10)throw new Error(\"Maximum retry for linear retry policy can not be more than 10\");this.retryConfiguration=e},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function m(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function s(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var a=0;a<n;a+=3){var u=s(),c=s(),l=s(),p=s(),h=(63&u)<<2|c>>4,f=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[a]=h,64!=l&&(o[a+1]=f),64!=p&&(o[a+2]=d)}return r}function b(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,s=i%3,a=i-s,u=0;u<a;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==s?n+=r[(252&(t=o[a]))>>2]+r[(3&t)<<4]+\"==\":2==s&&(n+=r[(64512&(t=o[a]<<8|o[a+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var v,_,S,w,O,P=P||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new s.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=P,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),h=2;h<=p;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var f=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],c=n[5],l=n[6],p=n[7],h=0;64>h;h++){if(16>h)f[h]=0|e[t+h];else{var d=f[h-15],y=f[h-2];f[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+f[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+f[h-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[h]+f[h],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=a+d|0,a=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(v=P).enc.Utf8,v.algo.HMAC=v.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,a=i.words,u=0;u<n;u++)s[u]^=1549556828,a[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),w=(S=P).lib.WordArray,S.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;4>s&&o+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var s=n.indexOf(e.charAt(i-1))<<i%4*2,a=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(s|a)<<24-o%4*8,o++}return w.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,s){return((e=e+(t&n|~t&r)+o+s)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,s){return((e=e+(t&r|n&~r)+o+s)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,s){return((e=e+(t^n^r)+o+s)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,s){return((e=e+(n^(t|~r))+o+s)<<i|e>>>32-i)+t}for(var i=P,s=(u=i.lib).WordArray,a=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var s=0;16>s;s++){var a=e[u=i+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[i+0],l=(a=e[i+1],e[i+2]),p=e[i+3],h=e[i+4],f=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],m=e[i+9],b=e[i+10],v=e[i+11],_=e[i+12],S=e[i+13],w=e[i+14],O=e[i+15],P=t(P=s[0],T=s[1],A=s[2],E=s[3],u,7,c[0]),E=t(E,P,T,A,a,12,c[1]),A=t(A,E,P,T,l,17,c[2]),T=t(T,A,E,P,p,22,c[3]);P=t(P,T,A,E,h,7,c[4]),E=t(E,P,T,A,f,12,c[5]),A=t(A,E,P,T,d,17,c[6]),T=t(T,A,E,P,y,22,c[7]),P=t(P,T,A,E,g,7,c[8]),E=t(E,P,T,A,m,12,c[9]),A=t(A,E,P,T,b,17,c[10]),T=t(T,A,E,P,v,22,c[11]),P=t(P,T,A,E,_,7,c[12]),E=t(E,P,T,A,S,12,c[13]),A=t(A,E,P,T,w,17,c[14]),P=n(P,T=t(T,A,E,P,O,22,c[15]),A,E,a,5,c[16]),E=n(E,P,T,A,d,9,c[17]),A=n(A,E,P,T,v,14,c[18]),T=n(T,A,E,P,u,20,c[19]),P=n(P,T,A,E,f,5,c[20]),E=n(E,P,T,A,b,9,c[21]),A=n(A,E,P,T,O,14,c[22]),T=n(T,A,E,P,h,20,c[23]),P=n(P,T,A,E,m,5,c[24]),E=n(E,P,T,A,w,9,c[25]),A=n(A,E,P,T,p,14,c[26]),T=n(T,A,E,P,g,20,c[27]),P=n(P,T,A,E,S,5,c[28]),E=n(E,P,T,A,l,9,c[29]),A=n(A,E,P,T,y,14,c[30]),P=r(P,T=n(T,A,E,P,_,20,c[31]),A,E,f,4,c[32]),E=r(E,P,T,A,g,11,c[33]),A=r(A,E,P,T,v,16,c[34]),T=r(T,A,E,P,w,23,c[35]),P=r(P,T,A,E,a,4,c[36]),E=r(E,P,T,A,h,11,c[37]),A=r(A,E,P,T,y,16,c[38]),T=r(T,A,E,P,b,23,c[39]),P=r(P,T,A,E,S,4,c[40]),E=r(E,P,T,A,u,11,c[41]),A=r(A,E,P,T,p,16,c[42]),T=r(T,A,E,P,d,23,c[43]),P=r(P,T,A,E,m,4,c[44]),E=r(E,P,T,A,_,11,c[45]),A=r(A,E,P,T,O,16,c[46]),P=o(P,T=r(T,A,E,P,l,23,c[47]),A,E,u,6,c[48]),E=o(E,P,T,A,y,10,c[49]),A=o(A,E,P,T,w,15,c[50]),T=o(T,A,E,P,f,21,c[51]),P=o(P,T,A,E,_,6,c[52]),E=o(E,P,T,A,p,10,c[53]),A=o(A,E,P,T,b,15,c[54]),T=o(T,A,E,P,a,21,c[55]),P=o(P,T,A,E,g,6,c[56]),E=o(E,P,T,A,O,10,c[57]),A=o(A,E,P,T,d,15,c[58]),T=o(T,A,E,P,S,21,c[59]),P=o(P,T,A,E,h,6,c[60]),E=o(E,P,T,A,v,10,c[61]),A=o(A,E,P,T,l,15,c[62]),T=o(T,A,E,P,m,21,c[63]);s[0]=s[0]+P|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e,t=P,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),o=r.create(),i=o.words,s=a.keySize,a=a.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),P.lib.Cipher||function(e){var t=(f=P).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=f.enc.Base64,s=f.algo.EvpKDF,a=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:h).decrypt(e,t,n,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=f.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(f.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],s=0;s<n;s+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=s.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:f}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=P,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],s=[],a=[],u=[],c=[],l=[],p=[],h=[],f=[],d=0;256>d;d++)f[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;r[y]=m,o[m]=y;var b=f[y],v=f[b],_=f[v],S=257*f[m]^16843008*m;i[y]=S<<24|S>>>8,s[y]=S<<16|S>>>16,a[y]=S<<8|S>>>24,u[y]=S,S=16843009*_^65537*v^257*b^16843008*y,c[m]=S<<24|S>>>8,l[m]=S<<16|S>>>16,p[m]=S<<8|S>>>24,h[m]=S,y?(y=b^f[f[f[_^b]]],g^=f[f[g]]):y=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var s=o[i-1];i%t?6<t&&4==i%t&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=w[i/t|0]<<24),o[i]=o[i-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,s=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?s:c[r[s>>>24]]^l[r[s>>>16&255]]^p[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,s,a,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,h,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],h=e[t+3]^n[3],f=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^s[255&h]^n[f++],g=r[l>>>24]^o[p>>>16&255]^i[h>>>8&255]^s[255&c]^n[f++],m=r[p>>>24]^o[h>>>16&255]^i[c>>>8&255]^s[255&l]^n[f++];h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^s[255&p]^n[f++],c=y,l=g,p=m}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^n[f++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[f++],m=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[f++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^n[f++],e[t]=y,e[t+1]=g,e[t+2]=m,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),P.mode.ECB=((O=P.lib.BlockCipherMode.extend()).Encryptor=O.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),O.Decryptor=O.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),O);var E=P;function A(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var T=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),s=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(s.clone()).toString(E.enc.Base64)}var a=this._getIV(n);return E.AES.encrypt(e,o,{iv:a,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=A((u=new Uint8ClampedArray(m(e))).slice(0,16)),s=A(u.slice(16));try{var a=E.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);a=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),C=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}(),k={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\",PNDisconnectedCategory:\"PNDisconnectedCategory\",PNConnectionErrorCategory:\"PNConnectionErrorCategory\",PNDisconnectedUnexpectedlyCategory:\"PNDisconnectedUnexpectedlyCategory\"},M=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,s=e.getFileUrl,a=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule,p=e.eventEmitter;this._listenerManager=c,this._config=a,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=s,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new C({config:a}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=p}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,s=e.channelGroups,a=void 0===s?[]:s,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),a.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),a.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:a,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),s.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),s.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:s},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=e.withPresence,u=void 0!==a&&a,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),s.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],a.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))})),s.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},(function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var n=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===k.PNTimeoutCategory?this._startSubscribeLoop():e.category===k.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:k.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===k.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=k.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,s=i.requestMessageCountThreshold,a=i.dedupeOnSubscribe;if(s&&o.length>=s){var u={};u.category=k.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}o.forEach((function(e){if(e.channel,e.subscriptionMatch,a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}n._eventEmitter.emitEvent(e)})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),j={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},R=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[j.PNSubscribeOperation,j.PNReceiveMessagesOperation,j.PNHandshakeOperation],this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){!this._telemetryExcludeOperations.includes(e)&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(!this._telemetryExcludeOperations.includes(e)&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case j.PNPublishOperation:t=\"pub\";break;case j.PNSignalOperation:t=\"sig\";break;case j.PNHistoryOperation:case j.PNFetchMessagesOperation:case j.PNDeleteMessagesOperation:case j.PNMessageCounts:t=\"hist\";break;case j.PNUnsubscribeOperation:case j.PNWhereNowOperation:case j.PNHereNowOperation:case j.PNHeartbeatOperation:case j.PNSetStateOperation:case j.PNGetStateOperation:t=\"pres\";break;case j.PNAddChannelsToGroupOperation:case j.PNRemoveChannelsFromGroupOperation:case j.PNChannelGroupsOperation:case j.PNRemoveGroupOperation:case j.PNChannelsForGroupOperation:t=\"cg\";break;case j.PNPushNotificationEnabledChannelsOperation:case j.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case j.PNCreateUserOperation:case j.PNUpdateUserOperation:case j.PNDeleteUserOperation:case j.PNGetUserOperation:case j.PNGetUsersOperation:case j.PNCreateSpaceOperation:case j.PNUpdateSpaceOperation:case j.PNDeleteSpaceOperation:case j.PNGetSpaceOperation:case j.PNGetSpacesOperation:case j.PNGetMembersOperation:case j.PNUpdateMembersOperation:case j.PNGetMembershipsOperation:case j.PNUpdateMembershipsOperation:t=\"obj\";break;case j.PNAddMessageActionOperation:case j.PNRemoveMessageActionOperation:case j.PNGetMessageActionsOperation:t=\"msga\";break;case j.PNAccessManagerGrant:case j.PNAccessManagerAudit:t=\"pam\";break;case j.PNAccessManagerGrantToken:case j.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),x=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),U=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,s={topic:t,environment:r};return i.length&&(s.excluded_devices=i),s},r}(x),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(x),D=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var s=r(i,[\"notification\",\"data\"]);e=n(n({},e),s)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(x),F=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new U(this._payload.apns,e,t),this.mpns=new I(this._payload.mpns,e,t),this.fcm=new D(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),L=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.includes(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=k.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=k.PNNetworkDownCategory,this.announceStatus(e)},e}(),G=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),s=n.pat.uuid?Object.keys(n.pat.uuid):[],a=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,h=i.length>0;(l||p||h)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),h&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var f=s.length>0,d=a.length>0,y=u.length>0;return(f||d||y)&&(c.patterns={},f&&(c.patterns.uuids={},s.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},a.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}();function K(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function B(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var H={signPamFromParams:function(e){return B(e).map((function(t){return\"\".concat(t,\"=\").concat(K(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:K,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},removeSingleOccurance:function(e,t){var n=Object.fromEntries(t.map((function(e){return[e,!1]})));return e.filter((function(e){return!(t.includes(e)&&!n[e])||(n[e]=!0,!1)}))},findUniqueCommonElements:function(e,t){return __spreadArray([],__read(e),!1).filter((function(n){return t.includes(n)&&e.indexOf(n)===e.lastIndexOf(n)&&t.indexOf(n)===t.lastIndexOf(n)}))}},q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,s=e.crypto,a=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(a=\"GET\"),\"GETFILE\"===a&&(a=\"GET\");var u=\"\".concat(a,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(H.signPamFromParams(n),\"\\n\");if(\"POST\"===a)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===a){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(s.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,s=e.config,a=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,h={};t.getOperation()===j.PNTimeOperation||t.getOperation()===j.PNChannelGroupsOperation?l=r[0]:(h=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=H.createPromise());var f=t.validateParams(e,h);if(f)return l?l(z(f)):p?(p.reject(new q(\"Validation failed, check status for details\",z(f))),p.promise):void 0;var d,g=t.prepareParams(e,h),m=V(t,e,h),b={url:m,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,h):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,h):null};g.uuid=s.UUID,g.pnsdk=W(s);var v=a.operationsLatencyForRequest();if(Object.keys(v).length&&(g=n(n({},g),v)),s.useInstanceId&&(g.instanceid=s.instanceId),s.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||s.getAuthKey();_&&(g.auth=_)}s.secretKey&&$(e,m,g,h,t);var S=function(n,r){if(n.error)return t.handleError&&t.handleError(e,h,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));a.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,h);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===j.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:k.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(a.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,h)){var w=t.postPayload(e,h);d=i.POST(g,w,b,S)}else if(\"PATCH\"===J(e,t,h)){w=t.patchPayload(e,h);d=i.PATCH(g,w,b,S)}else d=\"DELETE\"===J(e,t,h)?i.DELETE(g,b,S):\"GETFILE\"===J(e,t,h)?i.GETFILE(g,b,S):i.GET(g,b,S);return t.getOperation()===j.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a=t.start,u=t.count,c={type:r};return\"apns2\"===r&&delete(c=n(n({},c),{environment:i,topic:s})).type,a&&(c.start=a),u&&u>0&&(c.count=u),c},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a={type:r};return\"apns2\"===r&&delete(a=n(n({},a),{environment:i,topic:s})).type,a},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return j.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return j.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),o&&(s.state=JSON.stringify(o)),s.heartbeat=i.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,s=void 0===i?[]:i,a=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(a),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a={};return 1===o.length&&0===s.length?a[o[0]]=t.payload:a=t.payload,{channels:a}}});var le=Object.freeze({__proto__:null,getOperation:function(){return j.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,s=t.channelGroups,a=void 0===s?[]:s;return r?n.subscribeKey?0===i.length&&0===a.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/uuid/\").concat(H.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,s=void 0===i?[]:i,a=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||s.length>0){var u=o.length>0?o.join(\",\"):\",\";a+=\"/channel/\".concat(H.encodeString(u))}return a},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,s=void 0===i||i,a=t.includeState,u=void 0!==a&&a,c=t.queryParameters,l=void 0===c?{}:c,p={};return s||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||s.length>0||0===s.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var he=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var fe=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return j.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},me={getOperation:function(){return j.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(H.encodeString(t.channel),\"/0/\").concat(H.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},be=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,s=e.modules,a=s.PubNubFile,u=s.config,c=s.cryptography,l=s.cryptoModule,p=s.networking;return function(e){var s=e.channel,h=e.file,f=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,m=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,b,v,_,S,w,O,P,E,A,T,N,C,k,M,j,R,x,U,I,D,F,L,G,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!s)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!h)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=a.create(h),[4,n({channel:s,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,b=o.url,v=o.form_fields,_=t.data,S=_.id,w=_.name,a.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,a)]:[3,6];case 2:return O=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,a)];case 4:O=i.sent(),i.label=5;case 5:e=O,i.label=6;case 6:P=v,e.mimeType&&(P=v.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),a.supportsFileUri&&h.uri?(T=(A=p).POSTFILE,N=[b,P],[4,e.toFileUri()]):[3,10];case 8:return[4,T.apply(A,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return a.supportsFile?(k=(C=p).POSTFILE,M=[b,P],[4,e.toFile()]):[3,13];case 11:return[4,k.apply(C,M.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return a.supportsBuffer?(R=(j=p).POSTFILE,x=[b,P],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(j,x.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return a.supportsBlob?(I=(U=p).POSTFILE,D=[b,P],[4,e.toBlob()]):[3,19];case 17:return[4,I.apply(U,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(L=F.response.text,G=/<Message>(.*)<\\/Message>/gi.exec(L),new q(G?\"Upload to bucket failed: \".concat(G[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:s,message:f,fileId:S,fileName:w,meta:y,storeInHistory:m,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:S,name:w}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:s,id:S,name:w})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},ve=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,s=e.networking,a=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(H.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=a.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(s.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(s.getStandardOrigin()).concat(u)},_e={getOperation:function(){return j.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,s=e.config,a=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,a.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:s.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Se={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},we={getOperation:function(){return j.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Oe={getOperation:function(){return j.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Pe={getOperation:function(){return j.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return j.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ae={getOperation:function(){return j.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Te={getOperation:function(){return j.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return j.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return j.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return j.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&m.include.push(\"uuid\"),(null===(i=t.include)||void 0===i?void 0:i.customUUIDFields)&&m.include.push(\"uuid.custom\"),(null===(s=t.include)||void 0===s?void 0:s.UUIDStatusField)&&m.include.push(\"uuid.status\"),(null===(u=t.include)||void 0===u?void 0:u.UUIDTypeField)&&m.include.push(\"uuid.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return j.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&h.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&h.include.push(\"uuid\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return j.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&m.include.push(\"channel\"),(null===(i=t.include)||void 0===i?void 0:i.customChannelFields)&&m.include.push(\"channel.custom\"),(null===(s=t.include)||void 0===s?void 0:s.channelStatusField)&&m.include.push(\"channel.status\"),(null===(u=t.include)||void 0===u?void 0:u.channelTypeField)&&m.include.push(\"channel.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return j.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&h.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&h.include.push(\"channel\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var xe=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,s={};return n&&(s.channel=n),r&&(s[\"channel-group\"]=r),i.length>0&&(s.auth=i.join(\",\")),s},handleResponse:function(e,t){return t.payload}});var Ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.uuids,a=void 0===s?[]:s,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,h=void 0!==p&&p,f=t.manage,d=void 0!==f&&f,y=t.get,g=void 0!==y&&y,m=t.join,b=void 0!==m&&m,v=t.update,_=void 0!==v&&v,S=t.authKeys,w=void 0===S?[]:S,O=t.delete,P={};return P.r=l?\"1\":\"0\",P.w=h?\"1\":\"0\",P.m=d?\"1\":\"0\",P.d=O?\"1\":\"0\",P.g=g?\"1\":\"0\",P.j=b?\"1\":\"0\",P.u=_?\"1\":\"0\",r.length>0&&(P.channel=r.join(\",\")),i.length>0&&(P[\"channel-group\"]=i.join(\",\")),w.length>0&&(P.auth=w.join(\",\")),a.length>0&&(P[\"target-uuid\"]=a.join(\",\")),(u||0===u)&&(P.ttl=u),P},handleResponse:function(){return{}}});function Ie(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),s=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),a=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||s||c||a||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(Ie(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorizedUserId,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,h=o.spaces,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorized_uuid,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,h=o.channels,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}var Le=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,s,a,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),h=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),f=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.channels),y=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.groups),g=c||l||f||p||d||h||y;return Ie(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Ge={getOperation:function(){return j.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(H.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return j.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0/\").concat(H.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,s=t.ttl,a={};return null!=i&&(a.store=i?\"1\":\"0\"),s&&(a.ttl=s),!1===o&&(a.norep=\"true\"),n&&\"object\"==typeof n&&(a.meta=JSON.stringify(n)),a},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return j.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,s=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(H.encodeString(o),\"/0/\").concat(H.encodeString(s))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});var qe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,s=void 0===i?100:i,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=s,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message),o={timetoken:t.timetoken,entry:r.payload};t.meta&&(o.meta=t.meta),r.error&&(o.error=r.error),n.messages.push(o)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return j.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return j.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=a(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return j.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,s=e.config,a=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(a,\"/sub-key/\").concat(s.subscribeKey,\"/channel/\").concat(H.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,s=t.count,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,h=t.includeUUID,f=void 0===h||h,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=s||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),f&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={},i=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message);o.channel=r,o.timetoken=t.timetoken,o.message=i.payload,o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),i.error&&(o.error=i.error),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var Je=Object.freeze({__proto__:null,getOperation:function(){return j.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var $e=Object.freeze({__proto__:null,getOperation:function(){return j.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,s=t.timetoken,a=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),a&&a.length>0&&(c[\"filter-expr\"]=a),Object.keys(r).length&&(c.state=JSON.stringify(r)),s&&(c.tt=s),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={timetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return j.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,t.state&&(n.state=JSON.stringify(t.state)),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.ee=\"\",n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return j.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.tt=t.timetoken,n.tr=t.region,n.ee=\"\",n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=a(c,3),p=l[0],h=l[1],f=l[2];try{for(var d=s(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var m=this.currentState;this.currentState=p;var b=this.currentContext;this.currentContext=h,this.notify({type:\"transitionDone\",fromState:m,fromContext:b,toState:p,toContext:h,event:e});try{for(var v=s(f),_=v.next();!_.done;_=v.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}try{for(var S=s(this.currentState.enterEffects),w=S.next();!w.done;w=S.next()){g=w.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{w&&!w.done&&(u=S.return)&&u.call(S)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e.prototype.dispose=function(){var e,t;try{for(var n=s(this.instances.entries()),r=n.next();!r.done;r=n.next()){var o=a(r.value,2),i=o[0];o[1].cancel(),this.instances.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],a(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!1}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),st=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new it},n.prototype.abort=function(){this._aborted=!0,this.notify(new it)},n}(Ye),at=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new st,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch((function(e){}))},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),ut=function(e){return function(t,n){return new at(t,n,e)}},ct=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),lt=ot(\"RECEIVE_MESSAGES\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),pt=rt(\"EMIT_MESSAGES\",(function(e){return e})),ht=rt(\"EMIT_STATUS\",(function(e){return e})),ft=ot(\"RECEIVE_RECONNECT\",(function(e){return e})),dt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),yt=nt(\"SUBSCRIPTION_CHANGED\",(function(e,t){return{channels:e,groups:t}})),gt=nt(\"SUBSCRIPTION_RESTORED\",(function(e,t,n,r){return{channels:e,groups:t,cursor:{timetoken:n,region:null!=r?r:0}}})),mt=nt(\"HANDSHAKE_SUCCESS\",(function(e){return e})),bt=nt(\"HANDSHAKE_FAILURE\",(function(e){return e})),vt=nt(\"HANDSHAKE_RECONNECT_SUCCESS\",(function(e){return{cursor:e}})),_t=nt(\"HANDSHAKE_RECONNECT_FAILURE\",(function(e){return e})),St=nt(\"HANDSHAKE_RECONNECT_GIVEUP\",(function(e){return e})),wt=nt(\"RECEIVE_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Ot=nt(\"RECEIVE_FAILURE\",(function(e){return e})),Pt=nt(\"RECEIVE_RECONNECT_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Et=nt(\"RECEIVE_RECONNECT_FAILURE\",(function(e){return e})),At=nt(\"RECEIVING_RECONNECT_GIVEUP\",(function(e){return e})),Tt=nt(\"DISCONNECT\",(function(){return{}})),Nt=nt(\"RECONNECT\",(function(e,t){return{cursor:{timetoken:null!=e?e:\"\",region:null!=t?t:0}}})),Ct=nt(\"UNSUBSCRIBE_ALL\",(function(){return{}})),kt=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(ct.type,ut((function(e,r,a){var u=a.handshake,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:r.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:l.filterExpression},l.maintainPresenceState&&{state:c}))];case 2:return o=i.sent(),[2,t.transition(mt(o))];case 3:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(bt(s))]:[3,4];case 4:return[2]}}))}))}))),s.on(lt.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:u.filterExpression})];case 2:return r=i.sent(),t.transition(wt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q&&!n.aborted?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),s.on(pt.type,ut((function(e,t,n){var r=n.emitMessages;return o(s,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&r(e),[2]}))}))}))),s.on(ht.type,ut((function(e,t,n){var r=n.emitStatus;return o(s,void 0,void 0,(function(){return i(this,(function(t){return r(e),[2]}))}))}))),s.on(ft.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.delay,c=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return c.retryConfiguration&&c.retryConfiguration.shouldRetry(e.reason,e.attempts)?(n.throwIfAborted(),[4,u(c.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:c.filterExpression})];case 3:return r=i.sent(),[2,t.transition(Pt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Et(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(At(new q(c.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s.on(dt.type,ut((function(e,r,a){var u=a.handshake,c=a.delay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:p.filterExpression},p.maintainPresenceState&&{state:l}))];case 3:return o=i.sent(),[2,t.transition(vt(o))];case 4:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(_t(s))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(St(new q(p.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s}return t(r,e),r}(tt),Mt=new Ze(\"HANDSHAKE_FAILED\");Mt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Mt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor||e.cursor})})),Mt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region?t.payload.cursor.region:null!==(r=null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)&&void 0!==r?r:0}})})),Mt.on(Ct.type,(function(e){return Lt.with()}));var jt=new Ze(\"HANDSHAKE_STOPPED\");jt.on(yt.type,(function(e,t){return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),jt.on(Nt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor||e.cursor}))})),jt.on(gt.type,(function(e,t){var n;return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),jt.on(Ct.type,(function(e){return Lt.with()}));var Rt=new Ze(\"RECEIVE_FAILED\");Rt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Rt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(Ct.type,(function(e){return Lt.with(void 0)}));var xt=new Ze(\"RECEIVE_STOPPED\");xt.on(yt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),xt.on(gt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Ct.type,(function(){return Lt.with(void 0)}));var Ut=new Ze(\"RECEIVE_RECONNECTING\");Ut.onEnter((function(e){return ft(e)})),Ut.onExit((function(){return ft.cancel})),Ut.on(Pt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),Ut.on(Et.type,(function(e,t){return Ut.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ut.on(At.type,(function(e,t){var n;return Rt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNDisconnectedUnexpectedlyCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Ut.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),Ut.on(gt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Ut.on(yt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var It=new Ze(\"RECEIVING\");It.onEnter((function(e){return lt(e.channels,e.groups,e.cursor)})),It.onExit((function(){return lt.cancel})),It.on(wt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),It.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({cursor:e.cursor,channels:t.payload.channels,groups:t.payload.groups})})),It.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),It.on(Ot.type,(function(e,t){return Ut.with(n(n({},e),{attempts:0,reason:t.payload}))})),It.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),It.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var Dt=new Ze(\"HANDSHAKE_RECONNECTING\");Dt.onEnter((function(e){return dt(e)})),Dt.onExit((function(){return dt.cancel})),Dt.on(vt.type,(function(e,t){var n,r,o={timetoken:(null===(n=e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=e.cursor)||void 0===r?void 0:r.timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region};return It.with({channels:e.channels,groups:e.groups,cursor:o},[ht({category:k.PNConnectedCategory})])})),Dt.on(_t.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(St.type,(function(e,t){var n;return Mt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNConnectionErrorCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Dt.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Dt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Dt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:(null===(n=t.payload.cursor)||void 0===n?void 0:n.region)||(null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.region)||0}})})),Dt.on(Ct.type,(function(e){return Lt.with(void 0)}));var Ft=new Ze(\"HANDSHAKING\");Ft.onEnter((function(e){return ct(e.channels,e.groups)})),Ft.onExit((function(){return ct.cancel})),Ft.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ft.on(mt.type,(function(e,t){var n,r;return It.with({channels:e.channels,groups:e.groups,cursor:{timetoken:(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.timetoken:t.payload.timetoken,region:t.payload.region}},[ht({category:k.PNConnectedCategory})])})),Ft.on(bt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:e.cursor,attempts:0,reason:t.payload})})),Ft.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Ft.on(gt.type,(function(e,t){var n;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),Ft.on(Ct.type,(function(e){return Lt.with()}));var Lt=new Ze(\"UNSUBSCRIBED\");Lt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:t.payload.cursor})}));var Gt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dependencies=e,this.dispatcher=new kt(this.engine,e),this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Lt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=this,n=e.channels,r=e.channelGroups,o=e.timetoken,i=e.withPresence;this.channels=u(u([],a(this.channels),!1),a(null!=n?n:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=r?r:[]),!1),i&&(this.channels.map((function(e){return t.channels.push(\"\".concat(e,\"-pnpres\"))})),this.groups.map((function(e){return t.groups.push(\"\".concat(e,\"-pnpres\"))}))),o?this.engine.transition(gt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))),o)):this.engine.transition(yt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter((function(e){return!e.endsWith(\"-pnpres\")})))),groups:Array.from(new Set(this.groups.filter((function(e){return!e.endsWith(\"-pnpres\")}))))})},e.prototype.unsubscribe=function(e){var t=this,n=e.channels,r=void 0===n?[]:n,o=e.channelGroups,i=void 0===o?[]:o,s=H.removeSingleOccurance(this.channels,u(u([],a(r),!1),a(r.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1)),c=H.removeSingleOccurance(this.groups,u(u([],a(i),!1),a(i.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1));if(new Set(this.channels).size!==new Set(s).size||new Set(this.groups).size!==new Set(c).size){var l=H.findUniqueCommonElements(this.channels,r),p=H.findUniqueCommonElements(this.groups,i);this.dependencies.presenceState&&(null==l||l.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==p||p.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.channels=s,this.groups=c,this.engine.transition(yt(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:l.slice(0),groups:p.slice(0)})}},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(yt(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.reconnect=function(e){var t=e.timetoken,n=e.region;this.engine.transition(Nt(t,n))},e.prototype.disconnect=function(){this.engine.transition(Tt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},e.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},e.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),Kt=nt(\"RECONNECT\",(function(){return{}})),Bt=nt(\"DISCONNECT\",(function(){return{}})),Ht=nt(\"JOINED\",(function(e,t){return{channels:e,groups:t}})),qt=nt(\"LEFT\",(function(e,t){return{channels:e,groups:t}})),zt=nt(\"LEFT_ALL\",(function(){return{}})),Vt=nt(\"HEARTBEAT_SUCCESS\",(function(e){return{statusCode:e}})),Wt=nt(\"HEARTBEAT_FAILURE\",(function(e){return e})),Jt=nt(\"HEARTBEAT_GIVEUP\",(function(){return{}})),$t=nt(\"TIMES_UP\",(function(){return{}})),Qt=rt(\"HEARTBEAT\",(function(e,t){return{channels:e,groups:t}})),Xt=rt(\"LEAVE\",(function(e,t){return{channels:e,groups:t}})),Yt=rt(\"EMIT_STATUS\",(function(e){return e})),Zt=ot(\"WAIT\",(function(){return{}})),en=ot(\"DELAYED_HEARTBEAT\",(function(e){return e})),tn=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(Qt.type,ut((function(e,r,a){var u=a.heartbeat,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,u(n({channels:e.channels,channelGroups:e.groups},l.maintainPresenceState&&{state:c}))];case 1:return o.sent(),t.transition(Vt(200)),[3,3];case 2:return(r=o.sent())instanceof q?[2,t.transition(Wt(r))]:[3,3];case 3:return[2]}}))}))}))),s.on(Xt.type,ut((function(e,t,n){var r=n.leave,a=n.config;return o(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(a.suppressLeaveEvents)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r({channels:e.channels,channelGroups:e.groups})];case 2:case 3:return t.sent(),[3,4];case 4:return[2]}}))}))}))),s.on(Zt.type,ut((function(e,n,r){var a=r.heartbeatDelay;return o(s,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n.throwIfAborted(),[4,a()];case 1:return e.sent(),n.throwIfAborted(),[2,t.transition($t())]}}))}))}))),s.on(en.type,ut((function(e,r,a){var u=a.heartbeat,c=a.retryDelay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({channels:e.channels,channelGroups:e.groups},p.maintainPresenceState&&{state:l}))];case 3:return i.sent(),[2,t.transition(Vt(200))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Wt(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(Jt())];case 7:return[2]}}))}))}))),s.on(Yt.type,ut((function(e,t,r){var a=r.emitStatus,u=r.config;return o(s,void 0,void 0,(function(){var t;return i(this,(function(r){return u.announceFailedHeartbeats&&!0===(null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.error)?a(e.status):u.announceSuccessfulHeartbeats&&200===e.statusCode&&a(n(n({},e),{operation:j.PNHeartbeatOperation,error:!1})),[2]}))}))}))),s}return t(r,e),r}(tt),nn=new Ze(\"HEARTBEAT_STOPPED\");nn.on(Ht.type,(function(e,t){return nn.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),nn.on(qt.type,(function(e,t){return nn.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))})})),nn.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),nn.on(zt.type,(function(e,t){return un.with(void 0)}));var rn=new Ze(\"HEARTBEAT_COOLDOWN\");rn.onEnter((function(){return Zt()})),rn.onExit((function(){return Zt.cancel})),rn.on($t.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),rn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),rn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),rn.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),rn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var on=new Ze(\"HEARTBEAT_FAILED\");on.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),on.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),on.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),on.on(Bt.type,(function(e,t){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),on.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var sn=new Ze(\"HEARBEAT_RECONNECTING\");sn.onEnter((function(e){return en(e)})),sn.onExit((function(){return en.cancel})),sn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),sn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),sn.on(Bt.type,(function(e,t){nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),sn.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),sn.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),sn.on(Jt.type,(function(e,t){return on.with({channels:e.channels,groups:e.groups})})),sn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var an=new Ze(\"HEARTBEATING\");an.onEnter((function(e){return Qt(e.channels,e.groups)})),an.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),an.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),an.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),an.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:0,reason:t.payload}))})),an.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),an.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var un=new Ze(\"HEARTBEAT_INACTIVE\");un.on(Ht.type,(function(e,t){return an.with({channels:t.payload.channels,groups:t.payload.groups})}));var cn=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new tn(this.engine,e),this.dependencies=e,this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(un,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.join=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],a(this.channels),!1),a(null!=t?t:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=n?n:[]),!1),this.engine.transition(Ht(this.channels.slice(0),this.groups.slice(0)))},e.prototype.leave=function(e){var t=this,n=e.channels,r=e.groups;this.dependencies.presenceState&&(null==n||n.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==r||r.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.engine.transition(qt(null!=n?n:[],null!=r?r:[]))},e.prototype.leaveAll=function(){this.engine.transition(zt())},e.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),ln=function(){function e(){}return e.LinearRetryPolicy=function(e){return{delay:e.delay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:this.delay)+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e.ExponentialRetryPolicy=function(e){return{minimumDelay:e.minimumDelay,maximumDelay:e.maximumDelay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:Math.min(Math.pow(2,e),this.maximumDelay))+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e}(),pn=function(){function e(e){var t=e.modules,n=e.listenerManager,r=e.getFileUrl;this.modules=t,this.listenerManager=n,this.getFileUrl=r,this._channelListenerMap=new Map,this._groupListenerMap=new Map,t.cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.emitEvent=function(e){var t=e.channel,o=e.publishMetaData,i=e.subscriptionMatch;if(t===i&&(i=null),e.channel.endsWith(\"-pnpres\")){var s={channel:null,subscription:null};t&&(s.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(s.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=o.timetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announcePresence(s),this._announce(\"presence\",s,s.channel,s.subscription)}else if(1===e.messageType){(s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=e.payload,this.listenerManager.announceSignal(s),this._announce(\"signal\",s,s.channel,s.subscription)}else if(2===e.messageType){if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},this.listenerManager.announceObjects(s),this._announce(\"objects\",s,s.channel,s.subscription),\"uuid\"===e.payload.type){var a=this._renameChannelField(s),u=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"user\"})});this.listenerManager.announceUser(u),this._announce(\"user\",u,s.channel,s.subscription)}else if(\"channel\"===e.payload.type){a=this._renameChannelField(s);var c=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"space\"})});this.listenerManager.announceSpace(c),this._announce(\"space\",c,s.channel,s.subscription)}else if(\"membership\"===e.payload.type){var l=(a=this._renameChannelField(s)).message.data,p=l.uuid,h=l.channel,f=r(l,[\"uuid\",\"channel\"]);f.user=p,f.space=h;var d=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),data:f})});this.listenerManager.announceMembership(d),this._announce(\"membership\",d,s.channel,s.subscription)}}else if(3===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,s.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},s.event=e.payload.event,this.listenerManager.announceMessageAction(s),this._announce(\"messageAction\",s,s.channel,s.subscription)}else if(4===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId;var y=e.payload;if(this.modules.cryptoModule){var g=void 0;try{g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}null!==g&&(y=g)}e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=y.message,s.file={id:y.file.id,name:y.file.name,url:this.getFileUrl({id:y.file.id,name:y.file.name,channel:t})},this.listenerManager.announceFile(s),this._announce(\"file\",s,s.channel,s.subscription)}else{if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),this.modules.cryptoModule){g=void 0;try{var m;g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}s.message=null!=g?g:e.payload}else s.message=e.payload;s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announceMessage(s),this._announce(\"message\",s,s.channel,s.subscription)}},e.prototype.addListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){r._channelListenerMap[t]?r._channelListenerMap[t].includes(e)||r._channelListenerMap[t].push(e):r._channelListenerMap[t]=[e]})),null==n||n.forEach((function(t){r._groupListenerMap[t]?r._groupListenerMap[t].includes(e)||r._groupListenerMap[t].push(e):r._groupListenerMap[t]=[e]}))):this.listenerManager.addListener(e)},e.prototype.removeListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){var n;r._channelListenerMap[t]=null===(n=r._channelListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))})),null==n||n.forEach((function(t){var n;r._groupListenerMap[t]=null===(n=r._groupListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))}))):this.listenerManager.removeListener(e)},e.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e.prototype._announce=function(e,t,n,r){var o,i;null===(o=this._channelListenerMap[n])||void 0===o||o.forEach((function(n){return n[e]&&n[e](t)})),null===(i=this._groupListenerMap[r])||void 0===i||i.forEach((function(n){return n[e]&&n[e](t)}))},e}(),hn=function(){function e(){}return e.prototype.subscribe=function(){var e,t;this.pubnub.subscribe(n({channels:this.channelNames,channelGroups:this.groupNames},(null===(t=null===(e=this.options)||void 0===e?void 0:e.cursor)||void 0===t?void 0:t.timetoken)&&{timetoken:this.options.cursor.timetoken}))},e.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),channelGroups:this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))})},Object.defineProperty(e.prototype,\"onMessage\",{set:function(e){this.listener.message=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onPresence\",{set:function(e){this.listener.presence=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onSignal\",{set:function(e){this.listener.signal=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onObjects\",{set:function(e){this.listener.objects=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onMessageAction\",{set:function(e){this.listener.messageAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onFile\",{set:function(e){this.listener.file=e},enumerable:!1,configurable:!0}),e.prototype.addListener=function(e){this.eventEmitter.addListener(e,this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")})))},e.prototype.removeListener=function(e){this.eventEmitter.removeListener(e,this.channelNames,this.groupNames)},Object.defineProperty(e.prototype,\"channels\",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"channelGroups\",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),e}(),fn=function(e){function n(t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.subscriptionOptions,c=t.eventEmitter,l=t.pubnub,p=e.call(this)||this;return p.channelNames=[],p.groupNames=[],p.subscriptionList=[],p.options=s,p.eventEmitter=c,p.pubnub=l,r.filter((function(e){return!e.endsWith(\"-pnpres\")})).forEach((function(e){var t=p.pubnub.channel(e).subscription(p.options);p.channelNames=u(u([],a(p.channelNames),!1),a(t.channels),!1),p.subscriptionList.push(t)})),i.filter((function(e){return!e.endsWith(\"-pnpres\")})).forEach((function(e){var t=p.pubnub.channelGroup(e).subscription(p.options);p.groupNames=u(u([],a(p.groupNames),!1),a(t.channelGroups),!1),p.subscriptionList.push(t)})),p.listener={},c.addListener(p.listener,p.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),p.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),p}return t(n,e),n.prototype.addSubscription=function(e){this.subscriptionList.push(e),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),this.eventEmitter.addListener(this.listener,e.channels,e.channelGroups)},n.prototype.removeSubscription=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return t!==e})),this.eventEmitter.removeListener(this.listener,t,n)},n.prototype.addSubscriptionSet=function(e){this.subscriptionList=u(u([],a(this.subscriptionList),!1),a(e.subscriptions),!1),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),this.eventEmitter.addListener(this.listener,e.channels,e.channelGroups)},n.prototype.removeSubscriptionSet=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return!e.subscriptions.includes(t)})),this.eventEmitter.removeListener(this.listener,t,n)},Object.defineProperty(n.prototype,\"subscriptions\",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),n}(hn),dn=function(e){function r(t){var n=t.channels,r=t.channelGroups,o=t.subscriptionOptions,i=t.eventEmitter,s=t.pubnub,a=e.call(this)||this;return a.channelNames=[],a.groupNames=[],a.channelNames=n,a.groupNames=r,a.options=o,a.pubnub=s,a.eventEmitter=i,a.listener={},i.addListener(a.listener,a.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),a.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),a}return t(r,e),r.prototype.addSubscription=function(e){return new fn({channels:u(u([],a(this.channelNames),!1),a(e.channels),!1),channelGroups:u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),subscriptionOptions:n(n({},this.options),null==e?void 0:e.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},r}(hn),yn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),gn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[],channelGroups:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),mn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),bn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),vn=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var c=new T({config:i}),l=e.cryptography;r.init(i);var p=new G(i,o);this._tokenManager=p;var h=new R({maximumSamplesCount:6e4});this._telemetryManager=h;var f=this._config.cryptoModule,d={config:i,networking:r,crypto:c,cryptography:l,tokenManager:p,telemetryManager:h,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.encryptFile(t,this.File)):l.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.decryptFile(t,this.File)):l.decryptFile(e,t,this.File)};var y=Q.bind(this,d,Je),m=Q.bind(this,d,se),v=Q.bind(this,d,ue),_=Q.bind(this,d,le),S=Q.bind(this,d,$e),w=new L;if(this._listenerManager=w,this.iAmHere=Q.bind(this,d,ue),this.iAmAway=Q.bind(this,d,se),this.setPresenceState=Q.bind(this,d,le),this.handshake=Q.bind(this,d,Qe),this.receiveMessages=Q.bind(this,d,Xe),this._eventEmitter=new pn({modules:d,listenerManager:this._listenerManager,getFileUrl:function(e){return ve(d,e)}}),!0===i.enableEventEngine){if(i.maintainPresenceState&&(this.presenceState={},this.setState=function(e){var n,r;return null===(n=e.channels)||void 0===n||n.forEach((function(n){return t.presenceState[n]=e.state})),null===(r=e.channelGroups)||void 0===r||r.forEach((function(n){return t.presenceState[n]=e.state})),t.setPresenceState({channels:e.channels,channelGroups:e.channelGroups,state:t.presenceState})}),i.getHeartbeatInterval()){var O=new cn({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise((function(e){return setTimeout(e,1e3*d.config.getHeartbeatInterval())}))},retryDelay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},config:d.config,presenceState:this.presenceState,emitStatus:function(e){w.announceStatus(e)}});this.presenceEventEngine=O,this.join=this.presenceEventEngine.join.bind(O),this.leave=this.presenceEventEngine.leave.bind(O),this.leaveAll=this.presenceEventEngine.leaveAll.bind(O)}var P=new Gt({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:d.config,emitMessages:function(e){var n,r;try{for(var o=s(e),i=o.next();!i.done;i=o.next()){var a=i.value;t._eventEmitter.emitEvent(a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},emitStatus:function(e){w.announceStatus(e)}});this.subscribe=P.subscribe.bind(P),this.unsubscribe=P.unsubscribe.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.reconnect=P.reconnect.bind(P),this.disconnect=P.disconnect.bind(P),this.destroy=P.dispose.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.eventEngine=P}else{var E=new M({timeEndpoint:y,leaveEndpoint:m,heartbeatEndpoint:v,setStateEndpoint:_,subscribeEndpoint:S,crypto:d.crypto,config:d.config,listenerManager:w,getFileUrl:function(e){return ve(d,e)},cryptoModule:d.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=E.adaptSubscribeChange.bind(E),this.unsubscribe=E.adaptUnsubscribeChange.bind(E),this.disconnect=E.disconnect.bind(E),this.reconnect=E.reconnect.bind(E),this.unsubscribeAll=E.unsubscribeAll.bind(E),this.getSubscribedChannels=E.getSubscribedChannels.bind(E),this.getSubscribedChannelGroups=E.getSubscribedChannelGroups.bind(E),this.setState=E.adaptStateChange.bind(E),this.presence=E.adaptPresenceChange.bind(E),this.destroy=function(e){E.unsubscribeAll(e),E.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=p.parseToken.bind(p),this.setToken=p.setToken.bind(p),this.getToken=p.getToken.bind(p),this.channelGroups={listGroups:Q.bind(this,d,ee),listChannels:Q.bind(this,d,te),addChannels:Q.bind(this,d,X),removeChannels:Q.bind(this,d,Y),deleteGroup:Q.bind(this,d,Z)},this.push={addChannels:Q.bind(this,d,ne),removeChannels:Q.bind(this,d,re),deleteDevice:Q.bind(this,d,ie),listChannels:Q.bind(this,d,oe)},this.hereNow=Q.bind(this,d,pe),this.whereNow=Q.bind(this,d,ae),this.getState=Q.bind(this,d,ce),this.grant=Q.bind(this,d,Ue),this.grantToken=Q.bind(this,d,Le),this.audit=Q.bind(this,d,xe),this.revokeToken=Q.bind(this,d,Ge),this.publish=Q.bind(this,d,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,d,He),this.history=Q.bind(this,d,qe),this.deleteMessages=Q.bind(this,d,ze),this.messageCounts=Q.bind(this,d,Ve),this.fetchMessages=Q.bind(this,d,We),this.addMessageAction=Q.bind(this,d,he),this.removeMessageAction=Q.bind(this,d,fe),this.getMessageActions=Q.bind(this,d,de),this.listFiles=Q.bind(this,d,ye);var A=Q.bind(this,d,ge);this.publishFile=Q.bind(this,d,me),this.sendFile=be({generateUploadUrl:A,publishFile:this.publishFile,modules:d}),this.getFileUrl=function(e){return ve(d,e)},this.downloadFile=Q.bind(this,d,_e),this.deleteFile=Q.bind(this,d,Se),this.channel=function(e){return new yn(e,t._eventEmitter,t)},this.channelGroup=function(e){return new gn(e,t._eventEmitter,t)},this.channelMetadata=function(e){return new mn(e,t._eventEmitter,t)},this.userMetadata=function(e){return new bn(e,t._eventEmitter,t)},this.subscriptionSet=function(e){return new fn({channels:e.channels,channelGroups:e.channelGroups,subscriptionOptions:e.subscriptionOptions,eventEmitter:t._eventEmitter,pubnub:t})},this.objects={getAllUUIDMetadata:Q.bind(this,d,we),getUUIDMetadata:Q.bind(this,d,Oe),setUUIDMetadata:Q.bind(this,d,Pe),removeUUIDMetadata:Q.bind(this,d,Ee),getAllChannelMetadata:Q.bind(this,d,Ae),getChannelMetadata:Q.bind(this,d,Te),setChannelMetadata:Q.bind(this,d,Ne),removeChannelMetadata:Q.bind(this,d,Ce),getChannelMembers:Q.bind(this,d,ke),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"set\"},e)],a(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"delete\"},e)],a(r),!1))},getMemberships:Q.bind(this,d,je),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"set\"},e)],a(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"delete\"},e)],a(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,statusField:e.include.statusField,UUIDStatusField:e.include.userStatusField,UUIDTypeField:e.include.userTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,statusField:e.include.statusField,channelStatusField:e.include.spaceStatusField,channelTypeField:e.include.spaceTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=y,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&d.cryptoModule){var n=d.cryptoModule.encrypt(e);return\"string\"==typeof n?n:b(n)}return c.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=d.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return c.decrypt(e,t)},this.getAuthKey=d.config.getAuthKey.bind(d.config),this.setAuthKey=d.config.setAuthKey.bind(d.config),this.getUUID=d.config.getUUID.bind(d.config),this.setUUID=d.config.setUUID.bind(d.config),this.getUserId=d.config.getUserId.bind(d.config),this.setUserId=d.config.setUserId.bind(d.config),this.getFilterExpression=d.config.getFilterExpression.bind(d.config),this.setFilterExpression=d.config.setFilterExpression.bind(d.config),this.setCipherKey=function(t){return d.config.setCipherKey(t,e,d)},this.setHeartbeatInterval=d.config.setHeartbeatInterval.bind(d.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){d.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new F(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=j,e.CATEGORIES=k,e.LinearRetryPolicy=ln.LinearRetryPolicy,e.ExponentialRetryPolicy=ln.ExponentialRetryPolicy,e}(),_n=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return k.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return k.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return k.PNNetworkIssuesCategory;if(e.timeout)return k.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return k.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return k.PNBadRequestCategory;if(e.response.forbidden)return k.PNAccessDeniedCategory}return k.PNUnknownCategory},e}();function Sn(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,s=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(s)?Sn(s):s})),n}var wn=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),On={exports:{}},Pn={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Pn);var En=Mn;Mn.default=Mn,Mn.stable=Un,Mn.stableStringify=Un;var An=\"[...]\",Tn=\"[Circular]\",Nn=[],Cn=[];function kn(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Mn(e,t,n,r){var o;void 0===r&&(r=kn()),Rn(e,\"\",0,[],void 0,0,r);try{o=0===Cn.length?JSON.stringify(e,t,n):JSON.stringify(e,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var i=Nn.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function jn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Nn.push([r,n,t,o])):Cn.push([t,n,e]):(r[n]=e,Nn.push([r,n,t]))}function Rn(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)Rn(e[a],a,a,r,e,i,s);else{var u=Object.keys(e);for(a=0;a<u.length;a++){var c=u[a];Rn(e[c],c,a,r,e,i,s)}}r.pop()}}function xn(e,t){return e<t?-1:e>t?1:0}function Un(e,t,n,r){void 0===r&&(r=kn());var o,i=In(e,\"\",0,[],void 0,0,r)||e;try{o=0===Cn.length?JSON.stringify(i,t,n):JSON.stringify(i,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var s=Nn.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function In(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)In(e[a],a,a,r,e,i,s);else{var u={},c=Object.keys(e).sort(xn);for(a=0;a<c.length;a++){var l=c[a];In(e[l],l,a,r,e,i,s),u[l]=e[l]}if(void 0===o)return u;Nn.push([o,t,e]),o[t]=u}r.pop()}}function Dn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Cn.length>0)for(var r=0;r<Cn.length;r++){var o=Cn[r];if(o[1]===t&&o[0]===n){n=o[2],Cn.splice(r,1);break}}return e.call(this,t,n)}}var Fn,Ln=\"undefined\"!=typeof Symbol&&Symbol,Gn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},Kn=\"Function.prototype.bind called on incompatible \",Bn=Array.prototype.slice,Hn=Object.prototype.toString,qn=\"[object Function]\",zn=function(e){var t=this;if(\"function\"!=typeof t||Hn.call(t)!==qn)throw new TypeError(Kn+t);for(var n,r=Bn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(Bn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(Bn.call(arguments)))},i=Math.max(0,t.length-r.length),s=[],a=0;a<i;a++)s.push(\"$\"+a);if(n=Function(\"binder\",\"return function (\"+s.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},Vn=Function.prototype.bind||zn,Wn=Vn.call(Function.call,Object.prototype.hasOwnProperty),Jn=SyntaxError,$n=Function,Qn=TypeError,Xn=function(e){try{return $n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Yn=Object.getOwnPropertyDescriptor;if(Yn)try{Yn({},\"\")}catch(e){Yn=null}var Zn=function(){throw new Qn},er=Yn?function(){try{return Zn}catch(e){try{return Yn(arguments,\"callee\").get}catch(e){return Zn}}}():Zn,tr=\"function\"==typeof Ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof Ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&Gn(),nr=Object.getPrototypeOf||function(e){return e.__proto__},rr={},or=\"undefined\"==typeof Uint8Array?Fn:nr(Uint8Array),ir={\"%AggregateError%\":\"undefined\"==typeof AggregateError?Fn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?Fn:ArrayBuffer,\"%ArrayIteratorPrototype%\":tr?nr([][Symbol.iterator]()):Fn,\"%AsyncFromSyncIteratorPrototype%\":Fn,\"%AsyncFunction%\":rr,\"%AsyncGenerator%\":rr,\"%AsyncGeneratorFunction%\":rr,\"%AsyncIteratorPrototype%\":rr,\"%Atomics%\":\"undefined\"==typeof Atomics?Fn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?Fn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?Fn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?Fn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?Fn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?Fn:FinalizationRegistry,\"%Function%\":$n,\"%GeneratorFunction%\":rr,\"%Int8Array%\":\"undefined\"==typeof Int8Array?Fn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?Fn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?Fn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":tr?nr(nr([][Symbol.iterator]())):Fn,\"%JSON%\":\"object\"==typeof JSON?JSON:Fn,\"%Map%\":\"undefined\"==typeof Map?Fn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&tr?nr((new Map)[Symbol.iterator]()):Fn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?Fn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?Fn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?Fn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?Fn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&tr?nr((new Set)[Symbol.iterator]()):Fn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?Fn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":tr?nr(\"\"[Symbol.iterator]()):Fn,\"%Symbol%\":tr?Symbol:Fn,\"%SyntaxError%\":Jn,\"%ThrowTypeError%\":er,\"%TypedArray%\":or,\"%TypeError%\":Qn,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?Fn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?Fn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?Fn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?Fn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?Fn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?Fn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?Fn:WeakSet},sr=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Xn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Xn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Xn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=nr(o.prototype))}return ir[t]=n,n},ar={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},ur=Vn,cr=Wn,lr=ur.call(Function.call,Array.prototype.concat),pr=ur.call(Function.apply,Array.prototype.splice),hr=ur.call(Function.call,String.prototype.replace),fr=ur.call(Function.call,String.prototype.slice),dr=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,yr=/\\\\(\\\\)?/g,gr=function(e){var t=fr(e,0,1),n=fr(e,-1);if(\"%\"===t&&\"%\"!==n)throw new Jn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new Jn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return hr(e,dr,(function(e,t,n,o){r[r.length]=n?hr(o,yr,\"$1\"):t||e})),r},mr=function(e,t){var n,r=e;if(cr(ar,r)&&(r=\"%\"+(n=ar[r])[0]+\"%\"),cr(ir,r)){var o=ir[r];if(o===rr&&(o=sr(r)),void 0===o&&!t)throw new Qn(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new Jn(\"intrinsic \"+e+\" does not exist!\")},br=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new Qn(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new Qn('\"allowMissing\" argument must be a boolean');var n=gr(e),r=n.length>0?n[0]:\"\",o=mr(\"%\"+r+\"%\",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],pr(n,lr([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],h=fr(p,0,1),f=fr(p,-1);if(('\"'===h||\"'\"===h||\"`\"===h||'\"'===f||\"'\"===f||\"`\"===f)&&h!==f)throw new Jn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(a=!0),cr(ir,i=\"%\"+(r+=\".\"+p)+\"%\"))s=ir[i];else if(null!=s){if(!(p in s)){if(!t)throw new Qn(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Yn&&c+1>=n.length){var d=Yn(s,p);s=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:s[p]}else l=cr(s,p),s=s[p];l&&!a&&(ir[i]=s)}}return s},vr={exports:{}};!function(e){var t=Vn,n=br,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),s=n(\"%Object.getOwnPropertyDescriptor%\",!0),a=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(a)try{a({},\"a\",{value:1})}catch(e){a=null}e.exports=function(e){var n=i(t,o,arguments);if(s&&a){var r=s(n,\"length\");r.configurable&&a(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};a?a(e.exports,\"apply\",{value:c}):e.exports.apply=c}(vr);var _r=br,Sr=vr.exports,wr=Sr(_r(\"String.prototype.indexOf\")),Or=l(Object.freeze({__proto__:null,default:{}})),Pr=\"function\"==typeof Map&&Map.prototype,Er=Object.getOwnPropertyDescriptor&&Pr?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Ar=Pr&&Er&&\"function\"==typeof Er.get?Er.get:null,Tr=Pr&&Map.prototype.forEach,Nr=\"function\"==typeof Set&&Set.prototype,Cr=Object.getOwnPropertyDescriptor&&Nr?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,kr=Nr&&Cr&&\"function\"==typeof Cr.get?Cr.get:null,Mr=Nr&&Set.prototype.forEach,jr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,xr=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Ur=Boolean.prototype.valueOf,Ir=Object.prototype.toString,Dr=Function.prototype.toString,Fr=String.prototype.match,Lr=String.prototype.slice,Gr=String.prototype.replace,Kr=String.prototype.toUpperCase,Br=String.prototype.toLowerCase,Hr=RegExp.prototype.test,qr=Array.prototype.concat,zr=Array.prototype.join,Vr=Array.prototype.slice,Wr=Math.floor,Jr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,$r=Object.getOwnPropertySymbols,Qr=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Xr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Yr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xr||\"symbol\")?Symbol.toStringTag:null,Zr=Object.prototype.propertyIsEnumerable,eo=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function to(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||Hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-Wr(-e):Wr(e);if(r!==e){var o=String(r),i=Lr.call(t,o.length+1);return Gr.call(o,n,\"$&_\")+\".\"+Gr.call(Gr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return Gr.call(t,n,\"$&_\")}var no=Or,ro=no.custom,oo=co(ro)?ro:null;function io(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function so(e){return Gr.call(String(e),/\"/g,\"&quot;\")}function ao(e){return!(\"[object Array]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function uo(e){return!(\"[object RegExp]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function co(e){if(Xr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Qr)return!1;try{return Qr.call(e),!0}catch(e){}return!1}var lo=Object.prototype.hasOwnProperty||function(e){return e in this};function po(e,t){return lo.call(e,t)}function ho(e){return Ir.call(e)}function fo(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function yo(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return yo(Lr.call(e,0,t.maxStringLength),t)+r}return io(Gr.call(Gr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,go),\"single\",t)}function go(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+Kr.call(t.toString(16))}function mo(e){return\"Object(\"+e+\")\"}function bo(e){return e+\" { ? }\"}function vo(e,t,n,r){return e+\" (\"+t+\") {\"+(r?_o(n,r):zr.call(n,\", \"))+\"}\"}function _o(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+zr.call(e,\",\"+n)+\"\\n\"+t.prev}function So(e,t){var n=ao(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=po(e,o)?t(e[o],e):\"\"}var i,s=\"function\"==typeof $r?$r(e):[];if(Xr){i={};for(var a=0;a<s.length;a++)i[\"$\"+s[a]]=s[a]}for(var u in e)po(e,u)&&(n&&String(Number(u))===u&&u<e.length||Xr&&i[\"$\"+u]instanceof Symbol||(Hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof $r)for(var c=0;c<s.length;c++)Zr.call(e,s[c])&&r.push(\"[\"+t(s[c])+\"]: \"+t(e[s[c]],e));return r}var wo=br,Oo=function(e,t){var n=_r(e,!!t);return\"function\"==typeof n&&wr(e,\".prototype.\")>-1?Sr(n):n},Po=function e(t,n,r,o){var i=n||{};if(po(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(po(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var s=!po(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof s&&\"symbol\"!==s)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(po(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(po(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var a=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return yo(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return a?to(t,u):u}if(\"bigint\"==typeof t){var l=String(t)+\"n\";return a?to(t,l):l}var p=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=p&&p>0&&\"object\"==typeof t)return ao(t)?\"[Array]\":\"[Object]\";var h=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=zr.call(Array(e.indent+1),\" \")}return{base:n,prev:zr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(fo(o,t)>=0)return\"[Circular]\";function f(t,n,s){if(n&&(o=Vr.call(o)).push(n),s){var a={depth:i.depth};return po(i,\"quoteStyle\")&&(a.quoteStyle=i.quoteStyle),e(t,a,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!uo(t)){var d=function(e){if(e.name)return e.name;var t=Fr.call(Dr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),y=So(t,f);return\"[Function\"+(d?\": \"+d:\" (anonymous)\")+\"]\"+(y.length>0?\" { \"+zr.call(y,\", \")+\" }\":\"\")}if(co(t)){var g=Xr?Gr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Qr.call(t);return\"object\"!=typeof t||Xr?g:mo(g)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var m=\"<\"+Br.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)m+=\" \"+b[v].name+\"=\"+io(so(b[v].value),\"double\",i);return m+=\">\",t.childNodes&&t.childNodes.length&&(m+=\"...\"),m+=\"</\"+Br.call(String(t.nodeName))+\">\"}if(ao(t)){if(0===t.length)return\"[]\";var _=So(t,f);return h&&!function(e){for(var t=0;t<e.length;t++)if(fo(e[t],\"\\n\")>=0)return!1;return!0}(_)?\"[\"+_o(_,h)+\"]\":\"[ \"+zr.call(_,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)){var S=So(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Zr.call(t,\"cause\")?0===S.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+zr.call(S,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+zr.call(qr.call(\"[cause]: \"+f(t.cause),S),\", \")+\" }\"}if(\"object\"==typeof t&&s){if(oo&&\"function\"==typeof t[oo]&&no)return no(t,{depth:p-r});if(\"symbol\"!==s&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Ar||!e||\"object\"!=typeof e)return!1;try{Ar.call(e);try{kr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var w=[];return Tr&&Tr.call(t,(function(e,n){w.push(f(n,t,!0)+\" => \"+f(e,t))})),vo(\"Map\",Ar.call(t),w,h)}if(function(e){if(!kr||!e||\"object\"!=typeof e)return!1;try{kr.call(e);try{Ar.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var O=[];return Mr&&Mr.call(t,(function(e){O.push(f(e,t))})),vo(\"Set\",kr.call(t),O,h)}if(function(e){if(!jr||!e||\"object\"!=typeof e)return!1;try{jr.call(e,jr);try{Rr.call(e,Rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return bo(\"WeakMap\");if(function(e){if(!Rr||!e||\"object\"!=typeof e)return!1;try{Rr.call(e,Rr);try{jr.call(e,jr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return bo(\"WeakSet\");if(function(e){if(!xr||!e||\"object\"!=typeof e)return!1;try{return xr.call(e),!0}catch(e){}return!1}(t))return bo(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!Jr)return!1;try{return Jr.call(e),!0}catch(e){}return!1}(t))return mo(f(Jr.call(t)));if(function(e){return!(\"[object Boolean]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(Ur.call(t));if(function(e){return!(\"[object String]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(String(t)));if(\"undefined\"!=typeof window&&t===window)return\"{ [object Window] }\";if(t===c)return\"{ [object globalThis] }\";if(!function(e){return!(\"[object Date]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)&&!uo(t)){var P=So(t,f),E=eo?eo(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?\"\":\"null prototype\",T=!E&&Yr&&Object(t)===t&&Yr in t?Lr.call(ho(t),8,-1):A?\"Object\":\"\",N=(E||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||A?\"[\"+zr.call(qr.call([],T||[],A||[]),\": \")+\"] \":\"\");return 0===P.length?N+\"{}\":h?N+\"{\"+_o(P,h)+\"}\":N+\"{ \"+zr.call(P,\", \")+\" }\"}return String(t)},Eo=wo(\"%TypeError%\"),Ao=wo(\"%WeakMap%\",!0),To=wo(\"%Map%\",!0),No=Oo(\"WeakMap.prototype.get\",!0),Co=Oo(\"WeakMap.prototype.set\",!0),ko=Oo(\"WeakMap.prototype.has\",!0),Mo=Oo(\"Map.prototype.get\",!0),jo=Oo(\"Map.prototype.set\",!0),Ro=Oo(\"Map.prototype.has\",!0),xo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},Uo=String.prototype.replace,Io=/%20/g,Do=\"RFC3986\",Fo={default:Do,formatters:{RFC1738:function(e){return Uo.call(e,Io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:Do},Lo=Fo,Go=Object.prototype.hasOwnProperty,Ko=Array.isArray,Bo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),Ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},qo={arrayToObject:Ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],s=Object.keys(i),a=0;a<s.length;++a){var u=s[a],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(Ko(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var s=\"\",a=0;a<i.length;++a){var u=i.charCodeAt(a);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Lo.RFC1738&&(40===u||41===u)?s+=i.charAt(a):u<128?s+=Bo[u]:u<2048?s+=Bo[192|u>>6]+Bo[128|63&u]:u<55296||u>=57344?s+=Bo[224|u>>12]+Bo[128|u>>6&63]+Bo[128|63&u]:(a+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(a)),s+=Bo[240|u>>18]+Bo[128|u>>12&63]+Bo[128|u>>6&63]+Bo[128|63&u])}return s},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Ko(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(Ko(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!Go.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return Ko(t)&&!Ko(n)&&(o=Ho(t,r)),Ko(t)&&Ko(n)?(n.forEach((function(n,o){if(Go.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return Go.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},zo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new Eo(\"Side channel does not contain \"+Po(e))},get:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return No(e,r)}else if(To){if(t)return Mo(t,r)}else if(n)return function(e,t){var n=xo(e,t);return n&&n.value}(n,r)},has:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return ko(e,r)}else if(To){if(t)return Ro(t,r)}else if(n)return function(e,t){return!!xo(e,t)}(n,r);return!1},set:function(r,o){Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Ao),Co(e,r,o)):To?(t||(t=new To),jo(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=xo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},Vo=qo,Wo=Fo,Jo=Object.prototype.hasOwnProperty,$o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Qo=Array.isArray,Xo=Array.prototype.push,Yo=function(e,t){Xo.apply(e,Qo(t)?t:[t])},Zo=Date.prototype.toISOString,ei=Wo.default,ti={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:Vo.encode,encodeValuesOnly:!1,format:ei,formatter:Wo.formatters[ei],indices:!1,serializeDate:function(e){return Zo.call(e)},skipNulls:!1,strictNullHandling:!1},ni={},ri=function e(t,n,r,o,i,s,a,u,c,l,p,h,f,d,y,g){for(var m,b=t,v=g,_=0,S=!1;void 0!==(v=v.get(ni))&&!S;){var w=v.get(t);if(_+=1,void 0!==w){if(w===_)throw new RangeError(\"Cyclic object value\");S=!0}void 0===v.get(ni)&&(_=0)}if(\"function\"==typeof u?b=u(n,b):b instanceof Date?b=p(b):\"comma\"===r&&Qo(b)&&(b=Vo.maybeMap(b,(function(e){return e instanceof Date?p(e):e}))),null===b){if(i)return a&&!d?a(n,ti.encoder,y,\"key\",h):n;b=\"\"}if(\"string\"==typeof(m=b)||\"number\"==typeof m||\"boolean\"==typeof m||\"symbol\"==typeof m||\"bigint\"==typeof m||Vo.isBuffer(b))return a?[f(d?n:a(n,ti.encoder,y,\"key\",h))+\"=\"+f(a(b,ti.encoder,y,\"value\",h))]:[f(n)+\"=\"+f(String(b))];var O,P=[];if(void 0===b)return P;if(\"comma\"===r&&Qo(b))d&&a&&(b=Vo.maybeMap(b,a)),O=[{value:b.length>0?b.join(\",\")||null:void 0}];else if(Qo(u))O=u;else{var E=Object.keys(b);O=c?E.sort(c):E}for(var A=o&&Qo(b)&&1===b.length?n+\"[]\":n,T=0;T<O.length;++T){var N=O[T],C=\"object\"==typeof N&&void 0!==N.value?N.value:b[N];if(!s||null!==C){var k=Qo(b)?\"function\"==typeof r?r(A,N):A:A+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var M=zo();M.set(ni,g),Yo(P,e(C,k,r,o,i,s,\"comma\"===r&&d&&Qo(b)?null:a,u,c,l,p,h,f,d,y,M))}}return P},oi=qo,ii=Object.prototype.hasOwnProperty,si=Array.isArray,ai={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:oi.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ui=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},ci=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},li=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,s=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),a=s?o.slice(0,s.index):o,u=[];if(a){if(!n.plainObjects&&ii.call(Object.prototype,a)&&!n.allowPrototypes)return;u.push(a)}for(var c=0;n.depth>0&&null!==(s=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&ii.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push(\"[\"+o.slice(s.index)+\"]\"),function(e,t,n,r){for(var o=r?t:ci(t,n),i=e.length-1;i>=0;--i){var s,a=e[i];if(\"[]\"===a&&n.parseArrays)s=[].concat(o);else{s=n.plainObjects?Object.create(null):{};var u=\"[\"===a.charAt(0)&&\"]\"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&a!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(s=[])[c]=o:\"__proto__\"!==u&&(s[u]=o):s={0:o}}o=s}return o}(u,t,n,r)}},pi=function(e,t){var n,r=e,o=function(e){if(!e)return ti;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||ti.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=Wo.default;if(void 0!==e.format){if(!Jo.call(Wo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=Wo.formatters[n],o=ti.filter;return(\"function\"==typeof e.filter||Qo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:ti.addQueryPrefix,allowDots:void 0===e.allowDots?ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ti.charsetSentinel,delimiter:void 0===e.delimiter?ti.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:ti.encode,encoder:\"function\"==typeof e.encoder?e.encoder:ti.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ti.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:ti.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:ti.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ti.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Qo(o.filter)&&(n=o.filter);var i,s=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in $o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var a=$o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===a&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=zo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Yo(s,ri(r[p],p,a,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var h=s.join(o.delimiter),f=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?f+=\"utf8=%26%2310003%3B&\":f+=\"utf8=%E2%9C%93&\"),h.length>0?f+h:\"\"},hi={formats:Fo,parse:function(e,t){var n=function(e){if(!e)return ai;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?ai.charset:e.charset;return{allowDots:void 0===e.allowDots?ai.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:ai.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:ai.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:ai.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ai.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:ai.comma,decoder:\"function\"==typeof e.decoder?e.decoder:ai.decoder,delimiter:\"string\"==typeof e.delimiter||oi.isRegExp(e.delimiter)?e.delimiter:ai.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:ai.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:ai.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:ai.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:ai.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ai.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,i),a=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<s.length;++n)0===s[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===s[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===s[n]&&(u=\"iso-8859-1\"),a=n,n=s.length);for(n=0;n<s.length;++n)if(n!==a){var c,l,p=s[n],h=p.indexOf(\"]=\"),f=-1===h?p.indexOf(\"=\"):h+1;-1===f?(c=t.decoder(p,ai.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,f),ai.decoder,u,\"key\"),l=oi.maybeMap(ci(p.slice(f+1),t),(function(e){return t.decoder(e,ai.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=ui(l)),p.indexOf(\"[]=\")>-1&&(l=si(l)?[l]:l),ii.call(r,c)?r[c]=oi.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),s=0;s<i.length;++s){var a=i[s],u=li(a,r[a],n,\"string\"==typeof e);o=oi.merge(o,u,n)}return!0===n.allowSparse?o:oi.compact(o)},stringify:pi},fi={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(fi);const di=Or,yi=fi.isObject,gi=fi.hasOwn;var mi=bi;function bi(){}bi.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},bi.prototype.parse=function(e){return this._parser=e,this},bi.prototype.responseType=function(e){return this._responseType=e,this},bi.prototype.serialize=function(e){return this._serializer=e,this},bi.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(gi(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},bi.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const vi=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),_i=new Set([408,413,429,500,502,503,504,521,522,524]);bi.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&_i.has(t.status))return!0;if(e){if(e.code&&vi.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},bi.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},bi.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},bi.prototype.catch=function(e){return this.then(void 0,e)},bi.prototype.use=function(e){return e(this),this},bi.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},bi.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},bi.prototype.get=function(e){return this._header[e.toLowerCase()]},bi.prototype.getHeader=bi.prototype.get,bi.prototype.set=function(e,t){if(yi(e)){for(const t in e)gi(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},bi.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},bi.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(yi(e)){for(const t in e)gi(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)gi(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},bi.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(di.gte(process.version,\"v13.0.0\")&&di.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},bi.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},bi.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},bi.prototype.redirects=function(e){return this._maxRedirects=e,this},bi.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},bi.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},bi.prototype.send=function(e){const t=yi(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&yi(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");gi(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},bi.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},bi.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},bi.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},bi.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},bi.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Si=fi;var wi=Oi;function Oi(){}function Pi(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ai(){this._defaults=[]}Oi.prototype.get=function(e){return this.header[e.toLowerCase()]},Oi.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Si.type(t);const n=Si.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Si.parseLinks(e.link))}catch(e){}},Oi.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Ti=0,Ni=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Ti<Ni.length;Ti++){const e=Ni[Ti];Ai.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Ai.prototype._setDefaults=function(e){var t,n=Pi(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Ci=Ai;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Pn.exports,s=En,a=hi,u=mi,c=fi.isObject,l=fi.mixin,p=fi.hasOwn,h=wi,f=Ci;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=w,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function m(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&b(t,n,e[n]);return t.join(\"&\")}function b(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){b(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&b(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function v(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function S(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,s;for(let e=0,a=t.length;e<a;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),s=g(o.slice(r+1)),n[i]=s);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new S(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=m,y.parseString=v,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":a.stringify,\"application/json\":s},y.parse={\"application/x-www-form-urlencoded\":v,\"application/json\":JSON.parse},l(S.prototype,h.prototype),S.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},S.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=S,i(w.prototype),l(w.prototype,u.prototype),w.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},w.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},w.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},w.prototype.query=function(e){return\"string\"!=typeof e&&(e=m(e)),e&&this._query.push(e),this},w.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},w.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},w.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},w.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},w.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new f;for(var O=0,P=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];O<P.length;O++){const e=P[O];f.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}f.prototype.del=f.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(On,On.exports);var ki=On.exports;function Mi(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ji(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(Mi)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:k.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,s={};if(s.error=null!==e,s.operation=t.operation,o&&o.status&&(s.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{s.errorData=JSON.parse(e.response.text)}catch(t){s.errorData=e}else s.errorData=e;return s.category=r._detectErrorCategory(e),n(s,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return s.errorData=o,s.error=!0,n(s,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(s.errorData=i,s.statusCode=i.status,s.error=!0,s.category=r._detectErrorCategory(s),n(s,null)):(i.error&&i.error.message&&(s.errorData=i.error),n(s,i))})),o}function Ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ki.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function xi(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ui(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ii(e,t,n,r){var o=ki.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Di(e,t,n,r){var o=ki.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Fi(e,t,n){var r=ki.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var Gi,Ki=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:s})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,data:s})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=Li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return s=i.sent(),a=Li(r.buffer,s),[2,e.decoder.decode(a)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),s=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,s)];case 1:return a=i.sent(),[2,e.decoder.decode(a)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Bi=(Gi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),Gi.supportsFile=\"undefined\"!=typeof File,Gi.supportsBlob=\"undefined\"!=typeof Blob,Gi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,Gi.supportsBuffer=!1,Gi.supportsStream=!1,Gi.supportsString=!0,Gi.supportsEncryptFile=!0,Gi.supportsFileUri=!1,Gi),Hi=function(){function e(e){this.config=e,this.cryptor=new T({config:e}),this.fileCryptor=new Ki}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:b(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),qi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:m(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),zi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new qi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new qi({cipherKey:e.cipherKey}),cryptors:[new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],a(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?m(e):e,n=Vi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===Vi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=Vi.tryParse(r),(null==(s=this.getCryptor(o))?void 0:s.identifier)===e.LEGACY_IDENTIFIER?[2,s.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return a=i.sent(),u=a.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof Wi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=Vi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Vi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new Wi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var s=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return s=n[i],i+=1,255===s&&n.byteLength>=i+2&&(s=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new Wi(this.decoder.decode(o),s)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),Wi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return Vi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return Vi.SENTINEL.length+1+Vi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(Vi.SENTINEL)),t[e+=Vi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=Vi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function Ji(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var $i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new _n({del:Fi,get:Ui,post:Ii,patch:Di,sendBeacon:Ji,getfile:xi,postfile:Ri}),t.cbor=new wn((function(e){return Sn(h.decode(e))}),m),t.PubNubFile=Bi,t.cryptography=new Ki,t.initCryptoModule=function(e){return new zi({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new qi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=zi,n}(vn);return $i}));",
          "",
          "---------------"
        ],
        "lib/core/components/config.js||lib/core/components/config.js": [
          "File: lib/core/components/config.js -> lib/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:         return this;",
          "181:     };",
          "182:     default_1.prototype.getVersion = function () {",
          "184:     };",
          "185:     default_1.prototype._setRetryConfiguration = function (configuration) {",
          "186:         if (configuration.minimumdelay < 2) {",
          "",
          "[Removed Lines]",
          "183:         return '7.6.2';",
          "",
          "[Added Lines]",
          "183:         return '7.6.3';",
          "",
          "---------------"
        ],
        "lib/entities/SubscriptionSet.js||lib/entities/SubscriptionSet.js": [
          "File: lib/entities/SubscriptionSet.js -> lib/entities/SubscriptionSet.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "53:         _this.options = subscriptionOptions;",
          "54:         _this.eventEmitter = eventEmitter;",
          "55:         _this.pubnub = pubnub;",
          "57:             var subscription = _this.pubnub.channel(c).subscription(_this.options);",
          "58:             _this.channelNames = __spreadArray(__spreadArray([], __read(_this.channelNames), false), __read(subscription.channels), false);",
          "59:             _this.subscriptionList.push(subscription);",
          "60:         });",
          "62:             var subscription = _this.pubnub.channelGroup(cg).subscription(_this.options);",
          "63:             _this.groupNames = __spreadArray(__spreadArray([], __read(_this.groupNames), false), __read(subscription.channelGroups), false);",
          "64:             _this.subscriptionList.push(subscription);",
          "",
          "[Removed Lines]",
          "56:         channels.forEach(function (c) {",
          "61:         channelGroups.forEach(function (cg) {",
          "",
          "[Added Lines]",
          "56:         channels",
          "57:             .filter(function (c) { return !c.endsWith('-pnpres'); })",
          "58:             .forEach(function (c) {",
          "63:         channelGroups",
          "64:             .filter(function (cg) { return !cg.endsWith('-pnpres'); })",
          "65:             .forEach(function (cg) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "71:         this.subscriptionList.push(subscription);",
          "72:         this.channelNames = __spreadArray(__spreadArray([], __read(this.channelNames), false), __read(subscription.channels), false);",
          "73:         this.groupNames = __spreadArray(__spreadArray([], __read(this.groupNames), false), __read(subscription.channelGroups), false);",
          "74:     };",
          "75:     SubscriptionSet.prototype.removeSubscription = function (subscription) {",
          "76:         var channelsToRemove = subscription.channels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:         this.eventEmitter.addListener(this.listener, subscription.channels, subscription.channelGroups);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "78:         this.channelNames = this.channelNames.filter(function (c) { return !channelsToRemove.includes(c); });",
          "79:         this.groupNames = this.groupNames.filter(function (cg) { return !groupsToRemove.includes(cg); });",
          "80:         this.subscriptionList = this.subscriptionList.filter(function (s) { return s !== subscription; });",
          "81:     };",
          "82:     SubscriptionSet.prototype.addSubscriptionSet = function (subscriptionSet) {",
          "83:         this.subscriptionList = __spreadArray(__spreadArray([], __read(this.subscriptionList), false), __read(subscriptionSet.subscriptions), false);",
          "84:         this.channelNames = __spreadArray(__spreadArray([], __read(this.channelNames), false), __read(subscriptionSet.channels), false);",
          "85:         this.groupNames = __spreadArray(__spreadArray([], __read(this.groupNames), false), __read(subscriptionSet.channelGroups), false);",
          "86:     };",
          "87:     SubscriptionSet.prototype.removeSubscriptionSet = function (subscriptionSet) {",
          "88:         var channelsToRemove = subscriptionSet.channels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "86:         this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "92:         this.eventEmitter.addListener(this.listener, subscriptionSet.channels, subscriptionSet.channelGroups);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "90:         this.channelNames = this.channelNames.filter(function (c) { return !channelsToRemove.includes(c); });",
          "91:         this.groupNames = this.groupNames.filter(function (cg) { return !groupsToRemove.includes(cg); });",
          "92:         this.subscriptionList = this.subscriptionList.filter(function (s) { return !subscriptionSet.subscriptions.includes(s); });",
          "93:     };",
          "94:     Object.defineProperty(SubscriptionSet.prototype, \"subscriptions\", {",
          "95:         get: function () {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "100:         this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "",
          "---------------"
        ],
        "src/core/components/config.js||src/core/components/config.js": [
          "File: src/core/components/config.js -> src/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "358:   }",
          "360:   getVersion() {",
          "362:   }",
          "364:   _setRetryConfiguration(configuration) {",
          "",
          "[Removed Lines]",
          "361:     return '7.6.2';",
          "",
          "[Added Lines]",
          "361:     return '7.6.3';",
          "",
          "---------------"
        ],
        "src/entities/SubscriptionSet.ts||src/entities/SubscriptionSet.ts": [
          "File: src/entities/SubscriptionSet.ts -> src/entities/SubscriptionSet.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "29:     this.options = subscriptionOptions;",
          "30:     this.eventEmitter = eventEmitter;",
          "31:     this.pubnub = pubnub;",
          "42:     this.listener = {};",
          "43:     eventEmitter.addListener(",
          "44:       this.listener,",
          "",
          "[Removed Lines]",
          "32:     channels.forEach((c) => {",
          "33:       const subscription = this.pubnub.channel(c).subscription(this.options);",
          "34:       this.channelNames = [...this.channelNames, ...subscription.channels];",
          "35:       this.subscriptionList.push(subscription);",
          "36:     });",
          "37:     channelGroups.forEach((cg) => {",
          "38:       const subscription = this.pubnub.channelGroup(cg).subscription(this.options);",
          "39:       this.groupNames = [...this.groupNames, ...subscription.channelGroups];",
          "40:       this.subscriptionList.push(subscription);",
          "41:     });",
          "",
          "[Added Lines]",
          "32:     channels",
          "33:       .filter((c) => !c.endsWith('-pnpres'))",
          "34:       .forEach((c) => {",
          "35:         const subscription = this.pubnub.channel(c).subscription(this.options);",
          "36:         this.channelNames = [...this.channelNames, ...subscription.channels];",
          "37:         this.subscriptionList.push(subscription);",
          "38:       });",
          "39:     channelGroups",
          "40:       .filter((cg) => !cg.endsWith('-pnpres'))",
          "41:       .forEach((cg) => {",
          "42:         const subscription = this.pubnub.channelGroup(cg).subscription(this.options);",
          "43:         this.groupNames = [...this.groupNames, ...subscription.channelGroups];",
          "44:         this.subscriptionList.push(subscription);",
          "45:       });",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "51:     this.subscriptionList.push(subscription);",
          "52:     this.channelNames = [...this.channelNames, ...subscription.channels];",
          "53:     this.groupNames = [...this.groupNames, ...subscription.channelGroups];",
          "54:   }",
          "56:   removeSubscription(subscription: Subscription) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "58:     this.eventEmitter.addListener(this.listener, subscription.channels, subscription.channelGroups);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "59:     this.channelNames = this.channelNames.filter((c) => !channelsToRemove.includes(c));",
          "60:     this.groupNames = this.groupNames.filter((cg) => !groupsToRemove.includes(cg));",
          "61:     this.subscriptionList = this.subscriptionList.filter((s) => s !== subscription);",
          "62:   }",
          "64:   addSubscriptionSet(subscriptionSet: SubscriptionSet) {",
          "65:     this.subscriptionList = [...this.subscriptionList, ...subscriptionSet.subscriptions];",
          "66:     this.channelNames = [...this.channelNames, ...subscriptionSet.channels];",
          "67:     this.groupNames = [...this.groupNames, ...subscriptionSet.channelGroups];",
          "68:   }",
          "70:   removeSubscriptionSet(subscriptionSet: SubscriptionSet) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "67:     this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "74:     this.eventEmitter.addListener(this.listener, subscriptionSet.channels, subscriptionSet.channelGroups);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "73:     this.channelNames = this.channelNames.filter((c) => !channelsToRemove.includes(c));",
          "74:     this.groupNames = this.groupNames.filter((cg) => !groupsToRemove.includes(cg));",
          "75:     this.subscriptionList = this.subscriptionList.filter((s) => !subscriptionSet.subscriptions.includes(s));",
          "76:   }",
          "78:   get subscriptions(): Subscription[] {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "83:     this.eventEmitter.removeListener(this.listener, channelsToRemove, groupsToRemove);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8d9d8c2befe1d6e5e727ec109881281074f2b44e",
      "candidate_info": {
        "commit_hash": "8d9d8c2befe1d6e5e727ec109881281074f2b44e",
        "repo": "pubnub/javascript",
        "commit_url": "https://github.com/pubnub/javascript/commit/8d9d8c2befe1d6e5e727ec109881281074f2b44e",
        "files": [
          ".pubnub.yml",
          "CHANGELOG.md",
          "README.md",
          "dist/web/pubnub.js",
          "dist/web/pubnub.min.js",
          "lib/core/components/config.js",
          "lib/core/endpoints/push/list_push_channels.js",
          "package.json",
          "src/core/components/config.js",
          "src/core/endpoints/push/list_push_channels.js",
          "test/integration/endpoints/push.test.js"
        ],
        "message": "CLEN-1924: pagination params listChannels api for push devices (#366)\n\n* added `start` and `count` to listChannels api for push devices\n\n* PubNub SDK v7.6.2 release.\n\n* Update .pubnub.yml\n\nCo-authored-by: Karolina Rymer <karolina.zydek@pubnub.com>\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>\nCo-authored-by: Karolina Rymer <karolina.zydek@pubnub.com>",
        "before_after_code_files": [
          "dist/web/pubnub.js||dist/web/pubnub.js",
          "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
          "lib/core/components/config.js||lib/core/components/config.js",
          "lib/core/endpoints/push/list_push_channels.js||lib/core/endpoints/push/list_push_channels.js",
          "src/core/components/config.js||src/core/components/config.js",
          "src/core/endpoints/push/list_push_channels.js||src/core/endpoints/push/list_push_channels.js",
          "test/integration/endpoints/push.test.js||test/integration/endpoints/push.test.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ],
          "candidate": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "src/core/components/config.js||src/core/components/config.js"
          ]
        }
      },
      "candidate_diff": {
        "dist/web/pubnub.js||dist/web/pubnub.js": [
          "File: dist/web/pubnub.js -> dist/web/pubnub.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "794:             return this;",
          "795:         };",
          "796:         default_1.prototype.getVersion = function () {",
          "798:         };",
          "799:         default_1.prototype._setRetryConfiguration = function (configuration) {",
          "800:             if (configuration.minimumdelay < 2) {",
          "",
          "[Removed Lines]",
          "797:             return '7.6.1';",
          "",
          "[Added Lines]",
          "797:             return '7.6.2';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3893:         return true;",
          "3894:     }",
          "3895:     function prepareParams$l(modules, incomingParams) {",
          "3897:         var parameters = { type: pushGateway };",
          "3898:         if (pushGateway === 'apns2') {",
          "3899:             parameters = __assign(__assign({}, parameters), { environment: environment, topic: topic });",
          "3900:             delete parameters.type;",
          "3901:         }",
          "3902:         return parameters;",
          "3903:     }",
          "3904:     function handleResponse$l(modules, serverResponse) {",
          "",
          "[Removed Lines]",
          "3896:         var pushGateway = incomingParams.pushGateway, _a = incomingParams.environment, environment = _a === void 0 ? 'development' : _a, topic = incomingParams.topic;",
          "",
          "[Added Lines]",
          "3896:         var pushGateway = incomingParams.pushGateway, _a = incomingParams.environment, environment = _a === void 0 ? 'development' : _a, topic = incomingParams.topic, start = incomingParams.start, count = incomingParams.count;",
          "3902:         if (start)",
          "3903:             parameters.start = start;",
          "3904:         if (count && count > 0)",
          "3905:             parameters.count = count;",
          "",
          "---------------"
        ],
        "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
          "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:     PERFORMANCE OF THIS SOFTWARE.",
          "",
          "[Removed Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(f,f.exports);var d=f.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o,i=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=i.secretKey||i.secret_key,this.subscribeKey=i.subscribeKey||i.subscribe_key,this.publishKey=i.publishKey||i.publish_key,this.sdkName=i.sdkName,this.sdkFamily=i.sdkFamily,this.partnerId=i.partnerId,this.setAuthKey(i.authKey),this.cryptoModule=i.cryptoModule,this.setFilterExpression(i.filterExpression),\"string\"!=typeof i.origin&&!Array.isArray(i.origin)&&void 0!==i.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=i.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=i.ssl||!1,this.restore=i.restore||!1,this.proxy=i.proxy,this.keepAlive=i.keepAlive,this.keepAliveSettings=i.keepAliveSettings,this.autoNetworkDetection=i.autoNetworkDetection||!1,this.dedupeOnSubscribe=i.dedupeOnSubscribe||!1,this.maximumCacheSize=i.maximumCacheSize||100,this.customEncrypt=i.customEncrypt,this.customDecrypt=i.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=i.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=i.useRandomIVs)||void 0===n||n,this.enableEventEngine=null!==(r=i.enableEventEngine)&&void 0!==r&&r,this.maintainPresenceState=null===(o=i.maintainPresenceState)||void 0===o||o,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=i.logVerbosity||!1,this.suppressLeaveEvents=i.suppressLeaveEvents||!1,this.announceFailedHeartbeats=i.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=i.announceSuccessfulHeartbeats||!1,this.useInstanceId=i.useInstanceId||!1,this.useRequestId=i.useRequestId||!1,this.requestMessageCountThreshold=i.requestMessageCountThreshold,i.retryConfiguration&&this._setRetryConfiguration(i.retryConfiguration),this.setTransactionTimeout(i.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(i.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(i.useSendBeacon||!0),i.presenceTimeout?this.setPresenceTimeout(i.presenceTimeout):this._presenceTimeout=300,null!=i.heartbeatInterval&&this.setHeartbeatInterval(i.heartbeatInterval),\"string\"==typeof i.userId){if(\"string\"==typeof i.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(i.userId)}else{if(\"string\"!=typeof i.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(i.uuid)}this.setCipherKey(i.cipherKey,i)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.6.1\"},e.prototype._setRetryConfiguration=function(e){if(e.minimumdelay<2)throw new Error(\"Minimum delay can not be set less than 2 seconds for retry\");if(e.maximumDelay>150)throw new Error(\"Maximum delay can not be set more than 150 seconds for retry\");if(e.maximumDelay&&maximumRetry>6)throw new Error(\"Maximum retry for exponential retry policy can not be more than 6\");if(e.maximumRetry>10)throw new Error(\"Maximum retry for linear retry policy can not be more than 10\");this.retryConfiguration=e},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function m(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function s(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var a=0;a<n;a+=3){var u=s(),c=s(),l=s(),p=s(),h=(63&u)<<2|c>>4,f=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[a]=h,64!=l&&(o[a+1]=f),64!=p&&(o[a+2]=d)}return r}function b(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,s=i%3,a=i-s,u=0;u<a;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==s?n+=r[(252&(t=o[a]))>>2]+r[(3&t)<<4]+\"==\":2==s&&(n+=r[(64512&(t=o[a]<<8|o[a+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var v,_,S,w,O,P=P||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new s.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=P,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),h=2;h<=p;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var f=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],c=n[5],l=n[6],p=n[7],h=0;64>h;h++){if(16>h)f[h]=0|e[t+h];else{var d=f[h-15],y=f[h-2];f[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+f[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+f[h-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[h]+f[h],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=a+d|0,a=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(v=P).enc.Utf8,v.algo.HMAC=v.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,a=i.words,u=0;u<n;u++)s[u]^=1549556828,a[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),w=(S=P).lib.WordArray,S.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;4>s&&o+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var s=n.indexOf(e.charAt(i-1))<<i%4*2,a=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(s|a)<<24-o%4*8,o++}return w.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,s){return((e=e+(t&n|~t&r)+o+s)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,s){return((e=e+(t&r|n&~r)+o+s)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,s){return((e=e+(t^n^r)+o+s)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,s){return((e=e+(n^(t|~r))+o+s)<<i|e>>>32-i)+t}for(var i=P,s=(u=i.lib).WordArray,a=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var s=0;16>s;s++){var a=e[u=i+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[i+0],l=(a=e[i+1],e[i+2]),p=e[i+3],h=e[i+4],f=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],m=e[i+9],b=e[i+10],v=e[i+11],_=e[i+12],S=e[i+13],w=e[i+14],O=e[i+15],P=t(P=s[0],T=s[1],A=s[2],E=s[3],u,7,c[0]),E=t(E,P,T,A,a,12,c[1]),A=t(A,E,P,T,l,17,c[2]),T=t(T,A,E,P,p,22,c[3]);P=t(P,T,A,E,h,7,c[4]),E=t(E,P,T,A,f,12,c[5]),A=t(A,E,P,T,d,17,c[6]),T=t(T,A,E,P,y,22,c[7]),P=t(P,T,A,E,g,7,c[8]),E=t(E,P,T,A,m,12,c[9]),A=t(A,E,P,T,b,17,c[10]),T=t(T,A,E,P,v,22,c[11]),P=t(P,T,A,E,_,7,c[12]),E=t(E,P,T,A,S,12,c[13]),A=t(A,E,P,T,w,17,c[14]),P=n(P,T=t(T,A,E,P,O,22,c[15]),A,E,a,5,c[16]),E=n(E,P,T,A,d,9,c[17]),A=n(A,E,P,T,v,14,c[18]),T=n(T,A,E,P,u,20,c[19]),P=n(P,T,A,E,f,5,c[20]),E=n(E,P,T,A,b,9,c[21]),A=n(A,E,P,T,O,14,c[22]),T=n(T,A,E,P,h,20,c[23]),P=n(P,T,A,E,m,5,c[24]),E=n(E,P,T,A,w,9,c[25]),A=n(A,E,P,T,p,14,c[26]),T=n(T,A,E,P,g,20,c[27]),P=n(P,T,A,E,S,5,c[28]),E=n(E,P,T,A,l,9,c[29]),A=n(A,E,P,T,y,14,c[30]),P=r(P,T=n(T,A,E,P,_,20,c[31]),A,E,f,4,c[32]),E=r(E,P,T,A,g,11,c[33]),A=r(A,E,P,T,v,16,c[34]),T=r(T,A,E,P,w,23,c[35]),P=r(P,T,A,E,a,4,c[36]),E=r(E,P,T,A,h,11,c[37]),A=r(A,E,P,T,y,16,c[38]),T=r(T,A,E,P,b,23,c[39]),P=r(P,T,A,E,S,4,c[40]),E=r(E,P,T,A,u,11,c[41]),A=r(A,E,P,T,p,16,c[42]),T=r(T,A,E,P,d,23,c[43]),P=r(P,T,A,E,m,4,c[44]),E=r(E,P,T,A,_,11,c[45]),A=r(A,E,P,T,O,16,c[46]),P=o(P,T=r(T,A,E,P,l,23,c[47]),A,E,u,6,c[48]),E=o(E,P,T,A,y,10,c[49]),A=o(A,E,P,T,w,15,c[50]),T=o(T,A,E,P,f,21,c[51]),P=o(P,T,A,E,_,6,c[52]),E=o(E,P,T,A,p,10,c[53]),A=o(A,E,P,T,b,15,c[54]),T=o(T,A,E,P,a,21,c[55]),P=o(P,T,A,E,g,6,c[56]),E=o(E,P,T,A,O,10,c[57]),A=o(A,E,P,T,d,15,c[58]),T=o(T,A,E,P,S,21,c[59]),P=o(P,T,A,E,h,6,c[60]),E=o(E,P,T,A,v,10,c[61]),A=o(A,E,P,T,l,15,c[62]),T=o(T,A,E,P,m,21,c[63]);s[0]=s[0]+P|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e,t=P,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),o=r.create(),i=o.words,s=a.keySize,a=a.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),P.lib.Cipher||function(e){var t=(f=P).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=f.enc.Base64,s=f.algo.EvpKDF,a=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:h).decrypt(e,t,n,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=f.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(f.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],s=0;s<n;s+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=s.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:f}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=P,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],s=[],a=[],u=[],c=[],l=[],p=[],h=[],f=[],d=0;256>d;d++)f[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;r[y]=m,o[m]=y;var b=f[y],v=f[b],_=f[v],S=257*f[m]^16843008*m;i[y]=S<<24|S>>>8,s[y]=S<<16|S>>>16,a[y]=S<<8|S>>>24,u[y]=S,S=16843009*_^65537*v^257*b^16843008*y,c[m]=S<<24|S>>>8,l[m]=S<<16|S>>>16,p[m]=S<<8|S>>>24,h[m]=S,y?(y=b^f[f[f[_^b]]],g^=f[f[g]]):y=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var s=o[i-1];i%t?6<t&&4==i%t&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=w[i/t|0]<<24),o[i]=o[i-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,s=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?s:c[r[s>>>24]]^l[r[s>>>16&255]]^p[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,s,a,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,h,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],h=e[t+3]^n[3],f=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^s[255&h]^n[f++],g=r[l>>>24]^o[p>>>16&255]^i[h>>>8&255]^s[255&c]^n[f++],m=r[p>>>24]^o[h>>>16&255]^i[c>>>8&255]^s[255&l]^n[f++];h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^s[255&p]^n[f++],c=y,l=g,p=m}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^n[f++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[f++],m=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[f++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^n[f++],e[t]=y,e[t+1]=g,e[t+2]=m,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),P.mode.ECB=((O=P.lib.BlockCipherMode.extend()).Encryptor=O.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),O.Decryptor=O.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),O);var E=P;function A(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var T=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),s=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(s.clone()).toString(E.enc.Base64)}var a=this._getIV(n);return E.AES.encrypt(e,o,{iv:a,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=A((u=new Uint8ClampedArray(m(e))).slice(0,16)),s=A(u.slice(16));try{var a=E.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);a=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),C=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}(),k={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\",PNDisconnectedCategory:\"PNDisconnectedCategory\",PNConnectionErrorCategory:\"PNConnectionErrorCategory\",PNDisconnectedUnexpectedlyCategory:\"PNDisconnectedUnexpectedlyCategory\"},M=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,s=e.getFileUrl,a=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule,p=e.eventEmitter;this._listenerManager=c,this._config=a,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=s,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new C({config:a}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=p}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,s=e.channelGroups,a=void 0===s?[]:s,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),a.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),a.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:a,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),s.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),s.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:s},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=e.withPresence,u=void 0!==a&&a,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),s.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],a.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))})),s.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},(function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var n=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===k.PNTimeoutCategory?this._startSubscribeLoop():e.category===k.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:k.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===k.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=k.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,s=i.requestMessageCountThreshold,a=i.dedupeOnSubscribe;if(s&&o.length>=s){var u={};u.category=k.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}o.forEach((function(e){if(e.channel,e.subscriptionMatch,a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}n._eventEmitter.emitEvent(e)})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),j={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},R=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[j.PNSubscribeOperation,j.PNReceiveMessagesOperation,j.PNHandshakeOperation],this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){!this._telemetryExcludeOperations.includes(e)&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(!this._telemetryExcludeOperations.includes(e)&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case j.PNPublishOperation:t=\"pub\";break;case j.PNSignalOperation:t=\"sig\";break;case j.PNHistoryOperation:case j.PNFetchMessagesOperation:case j.PNDeleteMessagesOperation:case j.PNMessageCounts:t=\"hist\";break;case j.PNUnsubscribeOperation:case j.PNWhereNowOperation:case j.PNHereNowOperation:case j.PNHeartbeatOperation:case j.PNSetStateOperation:case j.PNGetStateOperation:t=\"pres\";break;case j.PNAddChannelsToGroupOperation:case j.PNRemoveChannelsFromGroupOperation:case j.PNChannelGroupsOperation:case j.PNRemoveGroupOperation:case j.PNChannelsForGroupOperation:t=\"cg\";break;case j.PNPushNotificationEnabledChannelsOperation:case j.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case j.PNCreateUserOperation:case j.PNUpdateUserOperation:case j.PNDeleteUserOperation:case j.PNGetUserOperation:case j.PNGetUsersOperation:case j.PNCreateSpaceOperation:case j.PNUpdateSpaceOperation:case j.PNDeleteSpaceOperation:case j.PNGetSpaceOperation:case j.PNGetSpacesOperation:case j.PNGetMembersOperation:case j.PNUpdateMembersOperation:case j.PNGetMembershipsOperation:case j.PNUpdateMembershipsOperation:t=\"obj\";break;case j.PNAddMessageActionOperation:case j.PNRemoveMessageActionOperation:case j.PNGetMessageActionsOperation:t=\"msga\";break;case j.PNAccessManagerGrant:case j.PNAccessManagerAudit:t=\"pam\";break;case j.PNAccessManagerGrantToken:case j.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),x=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),U=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,s={topic:t,environment:r};return i.length&&(s.excluded_devices=i),s},r}(x),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(x),D=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var s=r(i,[\"notification\",\"data\"]);e=n(n({},e),s)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(x),F=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new U(this._payload.apns,e,t),this.mpns=new I(this._payload.mpns,e,t),this.fcm=new D(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),L=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.includes(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=k.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=k.PNNetworkDownCategory,this.announceStatus(e)},e}(),G=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),s=n.pat.uuid?Object.keys(n.pat.uuid):[],a=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,h=i.length>0;(l||p||h)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),h&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var f=s.length>0,d=a.length>0,y=u.length>0;return(f||d||y)&&(c.patterns={},f&&(c.patterns.uuids={},s.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},a.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}();function K(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function B(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var H={signPamFromParams:function(e){return B(e).map((function(t){return\"\".concat(t,\"=\").concat(K(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:K,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},removeSingleOccurance:function(e,t){var n=Object.fromEntries(t.map((function(e){return[e,!1]})));return e.filter((function(e){return!(t.includes(e)&&!n[e])||(n[e]=!0,!1)}))},findUniqueCommonElements:function(e,t){return __spreadArray([],__read(e),!1).filter((function(n){return t.includes(n)&&e.indexOf(n)===e.lastIndexOf(n)&&t.indexOf(n)===t.lastIndexOf(n)}))}},q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,s=e.crypto,a=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(a=\"GET\"),\"GETFILE\"===a&&(a=\"GET\");var u=\"\".concat(a,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(H.signPamFromParams(n),\"\\n\");if(\"POST\"===a)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===a){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(s.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,s=e.config,a=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,h={};t.getOperation()===j.PNTimeOperation||t.getOperation()===j.PNChannelGroupsOperation?l=r[0]:(h=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=H.createPromise());var f=t.validateParams(e,h);if(f)return l?l(z(f)):p?(p.reject(new q(\"Validation failed, check status for details\",z(f))),p.promise):void 0;var d,g=t.prepareParams(e,h),m=V(t,e,h),b={url:m,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,h):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,h):null};g.uuid=s.UUID,g.pnsdk=W(s);var v=a.operationsLatencyForRequest();if(Object.keys(v).length&&(g=n(n({},g),v)),s.useInstanceId&&(g.instanceid=s.instanceId),s.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||s.getAuthKey();_&&(g.auth=_)}s.secretKey&&$(e,m,g,h,t);var S=function(n,r){if(n.error)return t.handleError&&t.handleError(e,h,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));a.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,h);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===j.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:k.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(a.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,h)){var w=t.postPayload(e,h);d=i.POST(g,w,b,S)}else if(\"PATCH\"===J(e,t,h)){w=t.patchPayload(e,h);d=i.PATCH(g,w,b,S)}else d=\"DELETE\"===J(e,t,h)?i.DELETE(g,b,S):\"GETFILE\"===J(e,t,h)?i.GETFILE(g,b,S):i.GET(g,b,S);return t.getOperation()===j.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a={type:r};return\"apns2\"===r&&delete(a=n(n({},a),{environment:i,topic:s})).type,a},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a={type:r};return\"apns2\"===r&&delete(a=n(n({},a),{environment:i,topic:s})).type,a},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return j.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return j.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),o&&(s.state=JSON.stringify(o)),s.heartbeat=i.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,s=void 0===i?[]:i,a=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(a),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a={};return 1===o.length&&0===s.length?a[o[0]]=t.payload:a=t.payload,{channels:a}}});var le=Object.freeze({__proto__:null,getOperation:function(){return j.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,s=t.channelGroups,a=void 0===s?[]:s;return r?n.subscribeKey?0===i.length&&0===a.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/uuid/\").concat(H.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,s=void 0===i?[]:i,a=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||s.length>0){var u=o.length>0?o.join(\",\"):\",\";a+=\"/channel/\".concat(H.encodeString(u))}return a},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,s=void 0===i||i,a=t.includeState,u=void 0!==a&&a,c=t.queryParameters,l=void 0===c?{}:c,p={};return s||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||s.length>0||0===s.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var he=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var fe=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return j.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},me={getOperation:function(){return j.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(H.encodeString(t.channel),\"/0/\").concat(H.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},be=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,s=e.modules,a=s.PubNubFile,u=s.config,c=s.cryptography,l=s.cryptoModule,p=s.networking;return function(e){var s=e.channel,h=e.file,f=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,m=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,b,v,_,S,w,O,P,E,A,T,N,C,k,M,j,R,x,U,I,D,F,L,G,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!s)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!h)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=a.create(h),[4,n({channel:s,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,b=o.url,v=o.form_fields,_=t.data,S=_.id,w=_.name,a.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,a)]:[3,6];case 2:return O=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,a)];case 4:O=i.sent(),i.label=5;case 5:e=O,i.label=6;case 6:P=v,e.mimeType&&(P=v.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),a.supportsFileUri&&h.uri?(T=(A=p).POSTFILE,N=[b,P],[4,e.toFileUri()]):[3,10];case 8:return[4,T.apply(A,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return a.supportsFile?(k=(C=p).POSTFILE,M=[b,P],[4,e.toFile()]):[3,13];case 11:return[4,k.apply(C,M.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return a.supportsBuffer?(R=(j=p).POSTFILE,x=[b,P],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(j,x.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return a.supportsBlob?(I=(U=p).POSTFILE,D=[b,P],[4,e.toBlob()]):[3,19];case 17:return[4,I.apply(U,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(L=F.response.text,G=/<Message>(.*)<\\/Message>/gi.exec(L),new q(G?\"Upload to bucket failed: \".concat(G[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:s,message:f,fileId:S,fileName:w,meta:y,storeInHistory:m,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:S,name:w}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:s,id:S,name:w})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},ve=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,s=e.networking,a=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(H.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=a.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(s.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(s.getStandardOrigin()).concat(u)},_e={getOperation:function(){return j.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,s=e.config,a=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,a.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:s.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Se={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},we={getOperation:function(){return j.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Oe={getOperation:function(){return j.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Pe={getOperation:function(){return j.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return j.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ae={getOperation:function(){return j.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Te={getOperation:function(){return j.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return j.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return j.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return j.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&m.include.push(\"uuid\"),(null===(i=t.include)||void 0===i?void 0:i.customUUIDFields)&&m.include.push(\"uuid.custom\"),(null===(s=t.include)||void 0===s?void 0:s.UUIDStatusField)&&m.include.push(\"uuid.status\"),(null===(u=t.include)||void 0===u?void 0:u.UUIDTypeField)&&m.include.push(\"uuid.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return j.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&h.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&h.include.push(\"uuid\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return j.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&m.include.push(\"channel\"),(null===(i=t.include)||void 0===i?void 0:i.customChannelFields)&&m.include.push(\"channel.custom\"),(null===(s=t.include)||void 0===s?void 0:s.channelStatusField)&&m.include.push(\"channel.status\"),(null===(u=t.include)||void 0===u?void 0:u.channelTypeField)&&m.include.push(\"channel.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return j.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&h.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&h.include.push(\"channel\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var xe=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,s={};return n&&(s.channel=n),r&&(s[\"channel-group\"]=r),i.length>0&&(s.auth=i.join(\",\")),s},handleResponse:function(e,t){return t.payload}});var Ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.uuids,a=void 0===s?[]:s,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,h=void 0!==p&&p,f=t.manage,d=void 0!==f&&f,y=t.get,g=void 0!==y&&y,m=t.join,b=void 0!==m&&m,v=t.update,_=void 0!==v&&v,S=t.authKeys,w=void 0===S?[]:S,O=t.delete,P={};return P.r=l?\"1\":\"0\",P.w=h?\"1\":\"0\",P.m=d?\"1\":\"0\",P.d=O?\"1\":\"0\",P.g=g?\"1\":\"0\",P.j=b?\"1\":\"0\",P.u=_?\"1\":\"0\",r.length>0&&(P.channel=r.join(\",\")),i.length>0&&(P[\"channel-group\"]=i.join(\",\")),w.length>0&&(P.auth=w.join(\",\")),a.length>0&&(P[\"target-uuid\"]=a.join(\",\")),(u||0===u)&&(P.ttl=u),P},handleResponse:function(){return{}}});function Ie(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),s=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),a=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||s||c||a||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(Ie(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorizedUserId,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,h=o.spaces,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorized_uuid,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,h=o.channels,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}var Le=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,s,a,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),h=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),f=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.channels),y=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.groups),g=c||l||f||p||d||h||y;return Ie(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Ge={getOperation:function(){return j.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(H.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return j.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0/\").concat(H.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,s=t.ttl,a={};return null!=i&&(a.store=i?\"1\":\"0\"),s&&(a.ttl=s),!1===o&&(a.norep=\"true\"),n&&\"object\"==typeof n&&(a.meta=JSON.stringify(n)),a},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return j.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,s=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(H.encodeString(o),\"/0/\").concat(H.encodeString(s))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});var qe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,s=void 0===i?100:i,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=s,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message),o={timetoken:t.timetoken,entry:r.payload};t.meta&&(o.meta=t.meta),r.error&&(o.error=r.error),n.messages.push(o)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return j.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return j.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=a(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return j.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,s=e.config,a=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(a,\"/sub-key/\").concat(s.subscribeKey,\"/channel/\").concat(H.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,s=t.count,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,h=t.includeUUID,f=void 0===h||h,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=s||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),f&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={},i=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message);o.channel=r,o.timetoken=t.timetoken,o.message=i.payload,o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),i.error&&(o.error=i.error),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var Je=Object.freeze({__proto__:null,getOperation:function(){return j.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var $e=Object.freeze({__proto__:null,getOperation:function(){return j.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,s=t.timetoken,a=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),a&&a.length>0&&(c[\"filter-expr\"]=a),Object.keys(r).length&&(c.state=JSON.stringify(r)),s&&(c.tt=s),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={timetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return j.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,t.state&&(n.state=JSON.stringify(t.state)),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.ee=\"\",n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return j.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.tt=t.timetoken,n.tr=t.region,n.ee=\"\",n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=a(c,3),p=l[0],h=l[1],f=l[2];try{for(var d=s(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var m=this.currentState;this.currentState=p;var b=this.currentContext;this.currentContext=h,this.notify({type:\"transitionDone\",fromState:m,fromContext:b,toState:p,toContext:h,event:e});try{for(var v=s(f),_=v.next();!_.done;_=v.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}try{for(var S=s(this.currentState.enterEffects),w=S.next();!w.done;w=S.next()){g=w.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{w&&!w.done&&(u=S.return)&&u.call(S)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e.prototype.dispose=function(){var e,t;try{for(var n=s(this.instances.entries()),r=n.next();!r.done;r=n.next()){var o=a(r.value,2),i=o[0];o[1].cancel(),this.instances.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],a(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!1}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),st=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new it},n.prototype.abort=function(){this._aborted=!0,this.notify(new it)},n}(Ye),at=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new st,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch((function(e){}))},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),ut=function(e){return function(t,n){return new at(t,n,e)}},ct=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),lt=ot(\"RECEIVE_MESSAGES\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),pt=rt(\"EMIT_MESSAGES\",(function(e){return e})),ht=rt(\"EMIT_STATUS\",(function(e){return e})),ft=ot(\"RECEIVE_RECONNECT\",(function(e){return e})),dt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),yt=nt(\"SUBSCRIPTION_CHANGED\",(function(e,t){return{channels:e,groups:t}})),gt=nt(\"SUBSCRIPTION_RESTORED\",(function(e,t,n,r){return{channels:e,groups:t,cursor:{timetoken:n,region:null!=r?r:0}}})),mt=nt(\"HANDSHAKE_SUCCESS\",(function(e){return e})),bt=nt(\"HANDSHAKE_FAILURE\",(function(e){return e})),vt=nt(\"HANDSHAKE_RECONNECT_SUCCESS\",(function(e){return{cursor:e}})),_t=nt(\"HANDSHAKE_RECONNECT_FAILURE\",(function(e){return e})),St=nt(\"HANDSHAKE_RECONNECT_GIVEUP\",(function(e){return e})),wt=nt(\"RECEIVE_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Ot=nt(\"RECEIVE_FAILURE\",(function(e){return e})),Pt=nt(\"RECEIVE_RECONNECT_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Et=nt(\"RECEIVE_RECONNECT_FAILURE\",(function(e){return e})),At=nt(\"RECEIVING_RECONNECT_GIVEUP\",(function(e){return e})),Tt=nt(\"DISCONNECT\",(function(){return{}})),Nt=nt(\"RECONNECT\",(function(e,t){return{cursor:{timetoken:null!=e?e:\"\",region:null!=t?t:0}}})),Ct=nt(\"UNSUBSCRIBE_ALL\",(function(){return{}})),kt=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(ct.type,ut((function(e,r,a){var u=a.handshake,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:r.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:l.filterExpression},l.maintainPresenceState&&{state:c}))];case 2:return o=i.sent(),[2,t.transition(mt(o))];case 3:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(bt(s))]:[3,4];case 4:return[2]}}))}))}))),s.on(lt.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:u.filterExpression})];case 2:return r=i.sent(),t.transition(wt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q&&!n.aborted?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),s.on(pt.type,ut((function(e,t,n){var r=n.emitMessages;return o(s,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&r(e),[2]}))}))}))),s.on(ht.type,ut((function(e,t,n){var r=n.emitStatus;return o(s,void 0,void 0,(function(){return i(this,(function(t){return r(e),[2]}))}))}))),s.on(ft.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.delay,c=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return c.retryConfiguration&&c.retryConfiguration.shouldRetry(e.reason,e.attempts)?(n.throwIfAborted(),[4,u(c.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:c.filterExpression})];case 3:return r=i.sent(),[2,t.transition(Pt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Et(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(At(new q(c.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s.on(dt.type,ut((function(e,r,a){var u=a.handshake,c=a.delay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:p.filterExpression},p.maintainPresenceState&&{state:l}))];case 3:return o=i.sent(),[2,t.transition(vt(o))];case 4:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(_t(s))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(St(new q(p.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s}return t(r,e),r}(tt),Mt=new Ze(\"HANDSHAKE_FAILED\");Mt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Mt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor||e.cursor})})),Mt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region?t.payload.cursor.region:null!==(r=null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)&&void 0!==r?r:0}})})),Mt.on(Ct.type,(function(e){return Lt.with()}));var jt=new Ze(\"HANDSHAKE_STOPPED\");jt.on(yt.type,(function(e,t){return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),jt.on(Nt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor||e.cursor}))})),jt.on(gt.type,(function(e,t){var n;return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),jt.on(Ct.type,(function(e){return Lt.with()}));var Rt=new Ze(\"RECEIVE_FAILED\");Rt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Rt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(Ct.type,(function(e){return Lt.with(void 0)}));var xt=new Ze(\"RECEIVE_STOPPED\");xt.on(yt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),xt.on(gt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Ct.type,(function(){return Lt.with(void 0)}));var Ut=new Ze(\"RECEIVE_RECONNECTING\");Ut.onEnter((function(e){return ft(e)})),Ut.onExit((function(){return ft.cancel})),Ut.on(Pt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),Ut.on(Et.type,(function(e,t){return Ut.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ut.on(At.type,(function(e,t){var n;return Rt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNDisconnectedUnexpectedlyCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Ut.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),Ut.on(gt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Ut.on(yt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var It=new Ze(\"RECEIVING\");It.onEnter((function(e){return lt(e.channels,e.groups,e.cursor)})),It.onExit((function(){return lt.cancel})),It.on(wt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),It.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({cursor:e.cursor,channels:t.payload.channels,groups:t.payload.groups})})),It.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),It.on(Ot.type,(function(e,t){return Ut.with(n(n({},e),{attempts:0,reason:t.payload}))})),It.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),It.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var Dt=new Ze(\"HANDSHAKE_RECONNECTING\");Dt.onEnter((function(e){return dt(e)})),Dt.onExit((function(){return dt.cancel})),Dt.on(vt.type,(function(e,t){var n,r,o={timetoken:(null===(n=e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=e.cursor)||void 0===r?void 0:r.timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region};return It.with({channels:e.channels,groups:e.groups,cursor:o},[ht({category:k.PNConnectedCategory})])})),Dt.on(_t.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(St.type,(function(e,t){var n;return Mt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNConnectionErrorCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Dt.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Dt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Dt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:(null===(n=t.payload.cursor)||void 0===n?void 0:n.region)||(null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.region)||0}})})),Dt.on(Ct.type,(function(e){return Lt.with(void 0)}));var Ft=new Ze(\"HANDSHAKING\");Ft.onEnter((function(e){return ct(e.channels,e.groups)})),Ft.onExit((function(){return ct.cancel})),Ft.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ft.on(mt.type,(function(e,t){var n,r;return It.with({channels:e.channels,groups:e.groups,cursor:{timetoken:(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.timetoken:t.payload.timetoken,region:t.payload.region}},[ht({category:k.PNConnectedCategory})])})),Ft.on(bt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:e.cursor,attempts:0,reason:t.payload})})),Ft.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Ft.on(gt.type,(function(e,t){var n;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),Ft.on(Ct.type,(function(e){return Lt.with()}));var Lt=new Ze(\"UNSUBSCRIBED\");Lt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:t.payload.cursor})}));var Gt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dependencies=e,this.dispatcher=new kt(this.engine,e),this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Lt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=this,n=e.channels,r=e.channelGroups,o=e.timetoken,i=e.withPresence;this.channels=u(u([],a(this.channels),!1),a(null!=n?n:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=r?r:[]),!1),i&&(this.channels.map((function(e){return t.channels.push(\"\".concat(e,\"-pnpres\"))})),this.groups.map((function(e){return t.groups.push(\"\".concat(e,\"-pnpres\"))}))),o?this.engine.transition(gt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))),o)):this.engine.transition(yt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter((function(e){return!e.endsWith(\"-pnpres\")})))),groups:Array.from(new Set(this.groups.filter((function(e){return!e.endsWith(\"-pnpres\")}))))})},e.prototype.unsubscribe=function(e){var t=this,n=e.channels,r=void 0===n?[]:n,o=e.channelGroups,i=void 0===o?[]:o,s=H.removeSingleOccurance(this.channels,u(u([],a(r),!1),a(r.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1)),c=H.removeSingleOccurance(this.groups,u(u([],a(i),!1),a(i.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1));if(new Set(this.channels).size!==new Set(s).size||new Set(this.groups).size!==new Set(c).size){var l=H.findUniqueCommonElements(this.channels,r),p=H.findUniqueCommonElements(this.groups,i);this.dependencies.presenceState&&(null==l||l.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==p||p.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.channels=s,this.groups=c,this.engine.transition(yt(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:l.slice(0),groups:p.slice(0)})}},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(yt(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.reconnect=function(e){var t=e.timetoken,n=e.region;this.engine.transition(Nt(t,n))},e.prototype.disconnect=function(){this.engine.transition(Tt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},e.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},e.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),Kt=nt(\"RECONNECT\",(function(){return{}})),Bt=nt(\"DISCONNECT\",(function(){return{}})),Ht=nt(\"JOINED\",(function(e,t){return{channels:e,groups:t}})),qt=nt(\"LEFT\",(function(e,t){return{channels:e,groups:t}})),zt=nt(\"LEFT_ALL\",(function(){return{}})),Vt=nt(\"HEARTBEAT_SUCCESS\",(function(e){return{statusCode:e}})),Wt=nt(\"HEARTBEAT_FAILURE\",(function(e){return e})),Jt=nt(\"HEARTBEAT_GIVEUP\",(function(){return{}})),$t=nt(\"TIMES_UP\",(function(){return{}})),Qt=rt(\"HEARTBEAT\",(function(e,t){return{channels:e,groups:t}})),Xt=rt(\"LEAVE\",(function(e,t){return{channels:e,groups:t}})),Yt=rt(\"EMIT_STATUS\",(function(e){return e})),Zt=ot(\"WAIT\",(function(){return{}})),en=ot(\"DELAYED_HEARTBEAT\",(function(e){return e})),tn=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(Qt.type,ut((function(e,r,a){var u=a.heartbeat,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,u(n({channels:e.channels,channelGroups:e.groups},l.maintainPresenceState&&{state:c}))];case 1:return o.sent(),t.transition(Vt(200)),[3,3];case 2:return(r=o.sent())instanceof q?[2,t.transition(Wt(r))]:[3,3];case 3:return[2]}}))}))}))),s.on(Xt.type,ut((function(e,t,n){var r=n.leave,a=n.config;return o(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(a.suppressLeaveEvents)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r({channels:e.channels,channelGroups:e.groups})];case 2:case 3:return t.sent(),[3,4];case 4:return[2]}}))}))}))),s.on(Zt.type,ut((function(e,n,r){var a=r.heartbeatDelay;return o(s,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n.throwIfAborted(),[4,a()];case 1:return e.sent(),n.throwIfAborted(),[2,t.transition($t())]}}))}))}))),s.on(en.type,ut((function(e,r,a){var u=a.heartbeat,c=a.retryDelay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({channels:e.channels,channelGroups:e.groups},p.maintainPresenceState&&{state:l}))];case 3:return i.sent(),[2,t.transition(Vt(200))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Wt(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(Jt())];case 7:return[2]}}))}))}))),s.on(Yt.type,ut((function(e,t,r){var a=r.emitStatus,u=r.config;return o(s,void 0,void 0,(function(){var t;return i(this,(function(r){return u.announceFailedHeartbeats&&!0===(null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.error)?a(e.status):u.announceSuccessfulHeartbeats&&200===e.statusCode&&a(n(n({},e),{operation:j.PNHeartbeatOperation,error:!1})),[2]}))}))}))),s}return t(r,e),r}(tt),nn=new Ze(\"HEARTBEAT_STOPPED\");nn.on(Ht.type,(function(e,t){return nn.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),nn.on(qt.type,(function(e,t){return nn.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))})})),nn.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),nn.on(zt.type,(function(e,t){return un.with(void 0)}));var rn=new Ze(\"HEARTBEAT_COOLDOWN\");rn.onEnter((function(){return Zt()})),rn.onExit((function(){return Zt.cancel})),rn.on($t.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),rn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),rn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),rn.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),rn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var on=new Ze(\"HEARTBEAT_FAILED\");on.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),on.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),on.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),on.on(Bt.type,(function(e,t){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),on.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var sn=new Ze(\"HEARBEAT_RECONNECTING\");sn.onEnter((function(e){return en(e)})),sn.onExit((function(){return en.cancel})),sn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),sn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),sn.on(Bt.type,(function(e,t){nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),sn.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),sn.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),sn.on(Jt.type,(function(e,t){return on.with({channels:e.channels,groups:e.groups})})),sn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var an=new Ze(\"HEARTBEATING\");an.onEnter((function(e){return Qt(e.channels,e.groups)})),an.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),an.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),an.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),an.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:0,reason:t.payload}))})),an.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),an.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var un=new Ze(\"HEARTBEAT_INACTIVE\");un.on(Ht.type,(function(e,t){return an.with({channels:t.payload.channels,groups:t.payload.groups})}));var cn=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new tn(this.engine,e),this.dependencies=e,this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(un,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.join=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],a(this.channels),!1),a(null!=t?t:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=n?n:[]),!1),this.engine.transition(Ht(this.channels.slice(0),this.groups.slice(0)))},e.prototype.leave=function(e){var t=this,n=e.channels,r=e.groups;this.dependencies.presenceState&&(null==n||n.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==r||r.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.engine.transition(qt(null!=n?n:[],null!=r?r:[]))},e.prototype.leaveAll=function(){this.engine.transition(zt())},e.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),ln=function(){function e(){}return e.LinearRetryPolicy=function(e){return{delay:e.delay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:this.delay)+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e.ExponentialRetryPolicy=function(e){return{minimumDelay:e.minimumDelay,maximumDelay:e.maximumDelay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:Math.min(Math.pow(2,e),this.maximumDelay))+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e}(),pn=function(){function e(e){var t=e.modules,n=e.listenerManager,r=e.getFileUrl;this.modules=t,this.listenerManager=n,this.getFileUrl=r,this._channelListenerMap=new Map,this._groupListenerMap=new Map,t.cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.emitEvent=function(e){var t=e.channel,o=e.publishMetaData,i=e.subscriptionMatch;if(t===i&&(i=null),e.channel.endsWith(\"-pnpres\")){var s={channel:null,subscription:null};t&&(s.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(s.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=o.timetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announcePresence(s),this._announce(\"presence\",s,s.channel,s.subscription)}else if(1===e.messageType){(s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=e.payload,this.listenerManager.announceSignal(s),this._announce(\"signal\",s,s.channel,s.subscription)}else if(2===e.messageType){if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},this.listenerManager.announceObjects(s),this._announce(\"objects\",s,s.channel,s.subscription),\"uuid\"===e.payload.type){var a=this._renameChannelField(s),u=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"user\"})});this.listenerManager.announceUser(u),this._announce(\"user\",u,s.channel,s.subscription)}else if(\"channel\"===e.payload.type){a=this._renameChannelField(s);var c=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"space\"})});this.listenerManager.announceSpace(c),this._announce(\"space\",c,s.channel,s.subscription)}else if(\"membership\"===e.payload.type){var l=(a=this._renameChannelField(s)).message.data,p=l.uuid,h=l.channel,f=r(l,[\"uuid\",\"channel\"]);f.user=p,f.space=h;var d=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),data:f})});this.listenerManager.announceMembership(d),this._announce(\"membership\",d,s.channel,s.subscription)}}else if(3===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,s.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},s.event=e.payload.event,this.listenerManager.announceMessageAction(s),this._announce(\"messageAction\",s,s.channel,s.subscription)}else if(4===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId;var y=e.payload;if(this.modules.cryptoModule){var g=void 0;try{g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}null!==g&&(y=g)}e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=y.message,s.file={id:y.file.id,name:y.file.name,url:this.getFileUrl({id:y.file.id,name:y.file.name,channel:t})},this.listenerManager.announceFile(s),this._announce(\"file\",s,s.channel,s.subscription)}else{if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),this.modules.cryptoModule){g=void 0;try{var m;g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}s.message=null!=g?g:e.payload}else s.message=e.payload;s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announceMessage(s),this._announce(\"message\",s,s.channel,s.subscription)}},e.prototype.addListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){r._channelListenerMap[t]?r._channelListenerMap[t].includes(e)||r._channelListenerMap[t].push(e):r._channelListenerMap[t]=[e]})),null==n||n.forEach((function(t){r._groupListenerMap[t]?r._groupListenerMap[t].includes(e)||r._groupListenerMap[t].push(e):r._groupListenerMap[t]=[e]}))):this.listenerManager.addListener(e)},e.prototype.removeListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){var n;r._channelListenerMap[t]=null===(n=r._channelListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))})),null==n||n.forEach((function(t){var n;r._groupListenerMap[t]=null===(n=r._groupListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))}))):this.listenerManager.removeListener(e)},e.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e.prototype._announce=function(e,t,n,r){var o,i;null===(o=this._channelListenerMap[n])||void 0===o||o.forEach((function(n){return n[e]&&n[e](t)})),null===(i=this._groupListenerMap[r])||void 0===i||i.forEach((function(n){return n[e]&&n[e](t)}))},e}(),hn=function(){function e(){}return e.prototype.subscribe=function(){var e,t;this.pubnub.subscribe(n({channels:this.channelNames,channelGroups:this.groupNames},(null===(t=null===(e=this.options)||void 0===e?void 0:e.cursor)||void 0===t?void 0:t.timetoken)&&{timetoken:this.options.cursor.timetoken}))},e.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),channelGroups:this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))})},Object.defineProperty(e.prototype,\"onMessage\",{set:function(e){this.listener.message=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onPresence\",{set:function(e){this.listener.presence=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onSignal\",{set:function(e){this.listener.signal=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onObjects\",{set:function(e){this.listener.objects=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onMessageAction\",{set:function(e){this.listener.messageAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onFile\",{set:function(e){this.listener.file=e},enumerable:!1,configurable:!0}),e.prototype.addListener=function(e){this.eventEmitter.addListener(e,this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")})))},e.prototype.removeListener=function(e){this.eventEmitter.removeListener(e,this.channelNames,this.groupNames)},Object.defineProperty(e.prototype,\"channels\",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"channelGroups\",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),e}(),fn=function(e){function n(t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.subscriptionOptions,c=t.eventEmitter,l=t.pubnub,p=e.call(this)||this;return p.channelNames=[],p.groupNames=[],p.subscriptionList=[],p.options=s,p.eventEmitter=c,p.pubnub=l,r.forEach((function(e){var t=p.pubnub.channel(e).subscription(p.options);p.channelNames=u(u([],a(p.channelNames),!1),a(t.channels),!1),p.subscriptionList.push(t)})),i.forEach((function(e){var t=p.pubnub.channelGroup(e).subscription(p.options);p.groupNames=u(u([],a(p.groupNames),!1),a(t.channelGroups),!1),p.subscriptionList.push(t)})),p.listener={},c.addListener(p.listener,p.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),p.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),p}return t(n,e),n.prototype.addSubscription=function(e){this.subscriptionList.push(e),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscription=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return t!==e}))},n.prototype.addSubscriptionSet=function(e){this.subscriptionList=u(u([],a(this.subscriptionList),!1),a(e.subscriptions),!1),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscriptionSet=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return!e.subscriptions.includes(t)}))},Object.defineProperty(n.prototype,\"subscriptions\",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),n}(hn),dn=function(e){function r(t){var n=t.channels,r=t.channelGroups,o=t.subscriptionOptions,i=t.eventEmitter,s=t.pubnub,a=e.call(this)||this;return a.channelNames=[],a.groupNames=[],a.channelNames=n,a.groupNames=r,a.options=o,a.pubnub=s,a.eventEmitter=i,a.listener={},i.addListener(a.listener,a.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),a.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),a}return t(r,e),r.prototype.addSubscription=function(e){return new fn({channels:u(u([],a(this.channelNames),!1),a(e.channels),!1),channelGroups:u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),subscriptionOptions:n(n({},this.options),null==e?void 0:e.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},r}(hn),yn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),gn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[],channelGroups:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),mn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),bn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),vn=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var c=new T({config:i}),l=e.cryptography;r.init(i);var p=new G(i,o);this._tokenManager=p;var h=new R({maximumSamplesCount:6e4});this._telemetryManager=h;var f=this._config.cryptoModule,d={config:i,networking:r,crypto:c,cryptography:l,tokenManager:p,telemetryManager:h,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.encryptFile(t,this.File)):l.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.decryptFile(t,this.File)):l.decryptFile(e,t,this.File)};var y=Q.bind(this,d,Je),m=Q.bind(this,d,se),v=Q.bind(this,d,ue),_=Q.bind(this,d,le),S=Q.bind(this,d,$e),w=new L;if(this._listenerManager=w,this.iAmHere=Q.bind(this,d,ue),this.iAmAway=Q.bind(this,d,se),this.setPresenceState=Q.bind(this,d,le),this.handshake=Q.bind(this,d,Qe),this.receiveMessages=Q.bind(this,d,Xe),this._eventEmitter=new pn({modules:d,listenerManager:this._listenerManager,getFileUrl:function(e){return ve(d,e)}}),!0===i.enableEventEngine){if(i.maintainPresenceState&&(this.presenceState={},this.setState=function(e){var n,r;return null===(n=e.channels)||void 0===n||n.forEach((function(n){return t.presenceState[n]=e.state})),null===(r=e.channelGroups)||void 0===r||r.forEach((function(n){return t.presenceState[n]=e.state})),t.setPresenceState({channels:e.channels,channelGroups:e.channelGroups,state:t.presenceState})}),i.getHeartbeatInterval()){var O=new cn({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise((function(e){return setTimeout(e,1e3*d.config.getHeartbeatInterval())}))},retryDelay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},config:d.config,presenceState:this.presenceState,emitStatus:function(e){w.announceStatus(e)}});this.presenceEventEngine=O,this.join=this.presenceEventEngine.join.bind(O),this.leave=this.presenceEventEngine.leave.bind(O),this.leaveAll=this.presenceEventEngine.leaveAll.bind(O)}var P=new Gt({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:d.config,emitMessages:function(e){var n,r;try{for(var o=s(e),i=o.next();!i.done;i=o.next()){var a=i.value;t._eventEmitter.emitEvent(a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},emitStatus:function(e){w.announceStatus(e)}});this.subscribe=P.subscribe.bind(P),this.unsubscribe=P.unsubscribe.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.reconnect=P.reconnect.bind(P),this.disconnect=P.disconnect.bind(P),this.destroy=P.dispose.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.eventEngine=P}else{var E=new M({timeEndpoint:y,leaveEndpoint:m,heartbeatEndpoint:v,setStateEndpoint:_,subscribeEndpoint:S,crypto:d.crypto,config:d.config,listenerManager:w,getFileUrl:function(e){return ve(d,e)},cryptoModule:d.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=E.adaptSubscribeChange.bind(E),this.unsubscribe=E.adaptUnsubscribeChange.bind(E),this.disconnect=E.disconnect.bind(E),this.reconnect=E.reconnect.bind(E),this.unsubscribeAll=E.unsubscribeAll.bind(E),this.getSubscribedChannels=E.getSubscribedChannels.bind(E),this.getSubscribedChannelGroups=E.getSubscribedChannelGroups.bind(E),this.setState=E.adaptStateChange.bind(E),this.presence=E.adaptPresenceChange.bind(E),this.destroy=function(e){E.unsubscribeAll(e),E.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=p.parseToken.bind(p),this.setToken=p.setToken.bind(p),this.getToken=p.getToken.bind(p),this.channelGroups={listGroups:Q.bind(this,d,ee),listChannels:Q.bind(this,d,te),addChannels:Q.bind(this,d,X),removeChannels:Q.bind(this,d,Y),deleteGroup:Q.bind(this,d,Z)},this.push={addChannels:Q.bind(this,d,ne),removeChannels:Q.bind(this,d,re),deleteDevice:Q.bind(this,d,ie),listChannels:Q.bind(this,d,oe)},this.hereNow=Q.bind(this,d,pe),this.whereNow=Q.bind(this,d,ae),this.getState=Q.bind(this,d,ce),this.grant=Q.bind(this,d,Ue),this.grantToken=Q.bind(this,d,Le),this.audit=Q.bind(this,d,xe),this.revokeToken=Q.bind(this,d,Ge),this.publish=Q.bind(this,d,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,d,He),this.history=Q.bind(this,d,qe),this.deleteMessages=Q.bind(this,d,ze),this.messageCounts=Q.bind(this,d,Ve),this.fetchMessages=Q.bind(this,d,We),this.addMessageAction=Q.bind(this,d,he),this.removeMessageAction=Q.bind(this,d,fe),this.getMessageActions=Q.bind(this,d,de),this.listFiles=Q.bind(this,d,ye);var A=Q.bind(this,d,ge);this.publishFile=Q.bind(this,d,me),this.sendFile=be({generateUploadUrl:A,publishFile:this.publishFile,modules:d}),this.getFileUrl=function(e){return ve(d,e)},this.downloadFile=Q.bind(this,d,_e),this.deleteFile=Q.bind(this,d,Se),this.channel=function(e){return new yn(e,t._eventEmitter,t)},this.channelGroup=function(e){return new gn(e,t._eventEmitter,t)},this.channelMetadata=function(e){return new mn(e,t._eventEmitter,t)},this.userMetadata=function(e){return new bn(e,t._eventEmitter,t)},this.subscriptionSet=function(e){return new fn({channels:e.channels,channelGroups:e.channelGroups,subscriptionOptions:e.subscriptionOptions,eventEmitter:t._eventEmitter,pubnub:t})},this.objects={getAllUUIDMetadata:Q.bind(this,d,we),getUUIDMetadata:Q.bind(this,d,Oe),setUUIDMetadata:Q.bind(this,d,Pe),removeUUIDMetadata:Q.bind(this,d,Ee),getAllChannelMetadata:Q.bind(this,d,Ae),getChannelMetadata:Q.bind(this,d,Te),setChannelMetadata:Q.bind(this,d,Ne),removeChannelMetadata:Q.bind(this,d,Ce),getChannelMembers:Q.bind(this,d,ke),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"set\"},e)],a(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"delete\"},e)],a(r),!1))},getMemberships:Q.bind(this,d,je),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"set\"},e)],a(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"delete\"},e)],a(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,statusField:e.include.statusField,UUIDStatusField:e.include.userStatusField,UUIDTypeField:e.include.userTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,statusField:e.include.statusField,channelStatusField:e.include.spaceStatusField,channelTypeField:e.include.spaceTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=y,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&d.cryptoModule){var n=d.cryptoModule.encrypt(e);return\"string\"==typeof n?n:b(n)}return c.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=d.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return c.decrypt(e,t)},this.getAuthKey=d.config.getAuthKey.bind(d.config),this.setAuthKey=d.config.setAuthKey.bind(d.config),this.getUUID=d.config.getUUID.bind(d.config),this.setUUID=d.config.setUUID.bind(d.config),this.getUserId=d.config.getUserId.bind(d.config),this.setUserId=d.config.setUserId.bind(d.config),this.getFilterExpression=d.config.getFilterExpression.bind(d.config),this.setFilterExpression=d.config.setFilterExpression.bind(d.config),this.setCipherKey=function(t){return d.config.setCipherKey(t,e,d)},this.setHeartbeatInterval=d.config.setHeartbeatInterval.bind(d.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){d.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new F(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=j,e.CATEGORIES=k,e.LinearRetryPolicy=ln.LinearRetryPolicy,e.ExponentialRetryPolicy=ln.ExponentialRetryPolicy,e}(),_n=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return k.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return k.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return k.PNNetworkIssuesCategory;if(e.timeout)return k.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return k.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return k.PNBadRequestCategory;if(e.response.forbidden)return k.PNAccessDeniedCategory}return k.PNUnknownCategory},e}();function Sn(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,s=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(s)?Sn(s):s})),n}var wn=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),On={exports:{}},Pn={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Pn);var En=Mn;Mn.default=Mn,Mn.stable=Un,Mn.stableStringify=Un;var An=\"[...]\",Tn=\"[Circular]\",Nn=[],Cn=[];function kn(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Mn(e,t,n,r){var o;void 0===r&&(r=kn()),Rn(e,\"\",0,[],void 0,0,r);try{o=0===Cn.length?JSON.stringify(e,t,n):JSON.stringify(e,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var i=Nn.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function jn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Nn.push([r,n,t,o])):Cn.push([t,n,e]):(r[n]=e,Nn.push([r,n,t]))}function Rn(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)Rn(e[a],a,a,r,e,i,s);else{var u=Object.keys(e);for(a=0;a<u.length;a++){var c=u[a];Rn(e[c],c,a,r,e,i,s)}}r.pop()}}function xn(e,t){return e<t?-1:e>t?1:0}function Un(e,t,n,r){void 0===r&&(r=kn());var o,i=In(e,\"\",0,[],void 0,0,r)||e;try{o=0===Cn.length?JSON.stringify(i,t,n):JSON.stringify(i,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var s=Nn.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function In(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)In(e[a],a,a,r,e,i,s);else{var u={},c=Object.keys(e).sort(xn);for(a=0;a<c.length;a++){var l=c[a];In(e[l],l,a,r,e,i,s),u[l]=e[l]}if(void 0===o)return u;Nn.push([o,t,e]),o[t]=u}r.pop()}}function Dn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Cn.length>0)for(var r=0;r<Cn.length;r++){var o=Cn[r];if(o[1]===t&&o[0]===n){n=o[2],Cn.splice(r,1);break}}return e.call(this,t,n)}}var Fn,Ln=\"undefined\"!=typeof Symbol&&Symbol,Gn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},Kn=\"Function.prototype.bind called on incompatible \",Bn=Array.prototype.slice,Hn=Object.prototype.toString,qn=\"[object Function]\",zn=function(e){var t=this;if(\"function\"!=typeof t||Hn.call(t)!==qn)throw new TypeError(Kn+t);for(var n,r=Bn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(Bn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(Bn.call(arguments)))},i=Math.max(0,t.length-r.length),s=[],a=0;a<i;a++)s.push(\"$\"+a);if(n=Function(\"binder\",\"return function (\"+s.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},Vn=Function.prototype.bind||zn,Wn=Vn.call(Function.call,Object.prototype.hasOwnProperty),Jn=SyntaxError,$n=Function,Qn=TypeError,Xn=function(e){try{return $n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Yn=Object.getOwnPropertyDescriptor;if(Yn)try{Yn({},\"\")}catch(e){Yn=null}var Zn=function(){throw new Qn},er=Yn?function(){try{return Zn}catch(e){try{return Yn(arguments,\"callee\").get}catch(e){return Zn}}}():Zn,tr=\"function\"==typeof Ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof Ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&Gn(),nr=Object.getPrototypeOf||function(e){return e.__proto__},rr={},or=\"undefined\"==typeof Uint8Array?Fn:nr(Uint8Array),ir={\"%AggregateError%\":\"undefined\"==typeof AggregateError?Fn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?Fn:ArrayBuffer,\"%ArrayIteratorPrototype%\":tr?nr([][Symbol.iterator]()):Fn,\"%AsyncFromSyncIteratorPrototype%\":Fn,\"%AsyncFunction%\":rr,\"%AsyncGenerator%\":rr,\"%AsyncGeneratorFunction%\":rr,\"%AsyncIteratorPrototype%\":rr,\"%Atomics%\":\"undefined\"==typeof Atomics?Fn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?Fn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?Fn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?Fn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?Fn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?Fn:FinalizationRegistry,\"%Function%\":$n,\"%GeneratorFunction%\":rr,\"%Int8Array%\":\"undefined\"==typeof Int8Array?Fn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?Fn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?Fn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":tr?nr(nr([][Symbol.iterator]())):Fn,\"%JSON%\":\"object\"==typeof JSON?JSON:Fn,\"%Map%\":\"undefined\"==typeof Map?Fn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&tr?nr((new Map)[Symbol.iterator]()):Fn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?Fn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?Fn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?Fn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?Fn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&tr?nr((new Set)[Symbol.iterator]()):Fn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?Fn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":tr?nr(\"\"[Symbol.iterator]()):Fn,\"%Symbol%\":tr?Symbol:Fn,\"%SyntaxError%\":Jn,\"%ThrowTypeError%\":er,\"%TypedArray%\":or,\"%TypeError%\":Qn,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?Fn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?Fn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?Fn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?Fn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?Fn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?Fn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?Fn:WeakSet},sr=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Xn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Xn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Xn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=nr(o.prototype))}return ir[t]=n,n},ar={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},ur=Vn,cr=Wn,lr=ur.call(Function.call,Array.prototype.concat),pr=ur.call(Function.apply,Array.prototype.splice),hr=ur.call(Function.call,String.prototype.replace),fr=ur.call(Function.call,String.prototype.slice),dr=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,yr=/\\\\(\\\\)?/g,gr=function(e){var t=fr(e,0,1),n=fr(e,-1);if(\"%\"===t&&\"%\"!==n)throw new Jn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new Jn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return hr(e,dr,(function(e,t,n,o){r[r.length]=n?hr(o,yr,\"$1\"):t||e})),r},mr=function(e,t){var n,r=e;if(cr(ar,r)&&(r=\"%\"+(n=ar[r])[0]+\"%\"),cr(ir,r)){var o=ir[r];if(o===rr&&(o=sr(r)),void 0===o&&!t)throw new Qn(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new Jn(\"intrinsic \"+e+\" does not exist!\")},br=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new Qn(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new Qn('\"allowMissing\" argument must be a boolean');var n=gr(e),r=n.length>0?n[0]:\"\",o=mr(\"%\"+r+\"%\",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],pr(n,lr([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],h=fr(p,0,1),f=fr(p,-1);if(('\"'===h||\"'\"===h||\"`\"===h||'\"'===f||\"'\"===f||\"`\"===f)&&h!==f)throw new Jn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(a=!0),cr(ir,i=\"%\"+(r+=\".\"+p)+\"%\"))s=ir[i];else if(null!=s){if(!(p in s)){if(!t)throw new Qn(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Yn&&c+1>=n.length){var d=Yn(s,p);s=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:s[p]}else l=cr(s,p),s=s[p];l&&!a&&(ir[i]=s)}}return s},vr={exports:{}};!function(e){var t=Vn,n=br,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),s=n(\"%Object.getOwnPropertyDescriptor%\",!0),a=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(a)try{a({},\"a\",{value:1})}catch(e){a=null}e.exports=function(e){var n=i(t,o,arguments);if(s&&a){var r=s(n,\"length\");r.configurable&&a(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};a?a(e.exports,\"apply\",{value:c}):e.exports.apply=c}(vr);var _r=br,Sr=vr.exports,wr=Sr(_r(\"String.prototype.indexOf\")),Or=l(Object.freeze({__proto__:null,default:{}})),Pr=\"function\"==typeof Map&&Map.prototype,Er=Object.getOwnPropertyDescriptor&&Pr?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Ar=Pr&&Er&&\"function\"==typeof Er.get?Er.get:null,Tr=Pr&&Map.prototype.forEach,Nr=\"function\"==typeof Set&&Set.prototype,Cr=Object.getOwnPropertyDescriptor&&Nr?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,kr=Nr&&Cr&&\"function\"==typeof Cr.get?Cr.get:null,Mr=Nr&&Set.prototype.forEach,jr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,xr=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Ur=Boolean.prototype.valueOf,Ir=Object.prototype.toString,Dr=Function.prototype.toString,Fr=String.prototype.match,Lr=String.prototype.slice,Gr=String.prototype.replace,Kr=String.prototype.toUpperCase,Br=String.prototype.toLowerCase,Hr=RegExp.prototype.test,qr=Array.prototype.concat,zr=Array.prototype.join,Vr=Array.prototype.slice,Wr=Math.floor,Jr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,$r=Object.getOwnPropertySymbols,Qr=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Xr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Yr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xr||\"symbol\")?Symbol.toStringTag:null,Zr=Object.prototype.propertyIsEnumerable,eo=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function to(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||Hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-Wr(-e):Wr(e);if(r!==e){var o=String(r),i=Lr.call(t,o.length+1);return Gr.call(o,n,\"$&_\")+\".\"+Gr.call(Gr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return Gr.call(t,n,\"$&_\")}var no=Or,ro=no.custom,oo=co(ro)?ro:null;function io(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function so(e){return Gr.call(String(e),/\"/g,\"&quot;\")}function ao(e){return!(\"[object Array]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function uo(e){return!(\"[object RegExp]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function co(e){if(Xr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Qr)return!1;try{return Qr.call(e),!0}catch(e){}return!1}var lo=Object.prototype.hasOwnProperty||function(e){return e in this};function po(e,t){return lo.call(e,t)}function ho(e){return Ir.call(e)}function fo(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function yo(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return yo(Lr.call(e,0,t.maxStringLength),t)+r}return io(Gr.call(Gr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,go),\"single\",t)}function go(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+Kr.call(t.toString(16))}function mo(e){return\"Object(\"+e+\")\"}function bo(e){return e+\" { ? }\"}function vo(e,t,n,r){return e+\" (\"+t+\") {\"+(r?_o(n,r):zr.call(n,\", \"))+\"}\"}function _o(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+zr.call(e,\",\"+n)+\"\\n\"+t.prev}function So(e,t){var n=ao(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=po(e,o)?t(e[o],e):\"\"}var i,s=\"function\"==typeof $r?$r(e):[];if(Xr){i={};for(var a=0;a<s.length;a++)i[\"$\"+s[a]]=s[a]}for(var u in e)po(e,u)&&(n&&String(Number(u))===u&&u<e.length||Xr&&i[\"$\"+u]instanceof Symbol||(Hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof $r)for(var c=0;c<s.length;c++)Zr.call(e,s[c])&&r.push(\"[\"+t(s[c])+\"]: \"+t(e[s[c]],e));return r}var wo=br,Oo=function(e,t){var n=_r(e,!!t);return\"function\"==typeof n&&wr(e,\".prototype.\")>-1?Sr(n):n},Po=function e(t,n,r,o){var i=n||{};if(po(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(po(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var s=!po(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof s&&\"symbol\"!==s)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(po(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(po(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var a=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return yo(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return a?to(t,u):u}if(\"bigint\"==typeof t){var l=String(t)+\"n\";return a?to(t,l):l}var p=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=p&&p>0&&\"object\"==typeof t)return ao(t)?\"[Array]\":\"[Object]\";var h=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=zr.call(Array(e.indent+1),\" \")}return{base:n,prev:zr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(fo(o,t)>=0)return\"[Circular]\";function f(t,n,s){if(n&&(o=Vr.call(o)).push(n),s){var a={depth:i.depth};return po(i,\"quoteStyle\")&&(a.quoteStyle=i.quoteStyle),e(t,a,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!uo(t)){var d=function(e){if(e.name)return e.name;var t=Fr.call(Dr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),y=So(t,f);return\"[Function\"+(d?\": \"+d:\" (anonymous)\")+\"]\"+(y.length>0?\" { \"+zr.call(y,\", \")+\" }\":\"\")}if(co(t)){var g=Xr?Gr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Qr.call(t);return\"object\"!=typeof t||Xr?g:mo(g)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var m=\"<\"+Br.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)m+=\" \"+b[v].name+\"=\"+io(so(b[v].value),\"double\",i);return m+=\">\",t.childNodes&&t.childNodes.length&&(m+=\"...\"),m+=\"</\"+Br.call(String(t.nodeName))+\">\"}if(ao(t)){if(0===t.length)return\"[]\";var _=So(t,f);return h&&!function(e){for(var t=0;t<e.length;t++)if(fo(e[t],\"\\n\")>=0)return!1;return!0}(_)?\"[\"+_o(_,h)+\"]\":\"[ \"+zr.call(_,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)){var S=So(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Zr.call(t,\"cause\")?0===S.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+zr.call(S,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+zr.call(qr.call(\"[cause]: \"+f(t.cause),S),\", \")+\" }\"}if(\"object\"==typeof t&&s){if(oo&&\"function\"==typeof t[oo]&&no)return no(t,{depth:p-r});if(\"symbol\"!==s&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Ar||!e||\"object\"!=typeof e)return!1;try{Ar.call(e);try{kr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var w=[];return Tr&&Tr.call(t,(function(e,n){w.push(f(n,t,!0)+\" => \"+f(e,t))})),vo(\"Map\",Ar.call(t),w,h)}if(function(e){if(!kr||!e||\"object\"!=typeof e)return!1;try{kr.call(e);try{Ar.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var O=[];return Mr&&Mr.call(t,(function(e){O.push(f(e,t))})),vo(\"Set\",kr.call(t),O,h)}if(function(e){if(!jr||!e||\"object\"!=typeof e)return!1;try{jr.call(e,jr);try{Rr.call(e,Rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return bo(\"WeakMap\");if(function(e){if(!Rr||!e||\"object\"!=typeof e)return!1;try{Rr.call(e,Rr);try{jr.call(e,jr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return bo(\"WeakSet\");if(function(e){if(!xr||!e||\"object\"!=typeof e)return!1;try{return xr.call(e),!0}catch(e){}return!1}(t))return bo(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!Jr)return!1;try{return Jr.call(e),!0}catch(e){}return!1}(t))return mo(f(Jr.call(t)));if(function(e){return!(\"[object Boolean]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(Ur.call(t));if(function(e){return!(\"[object String]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(String(t)));if(\"undefined\"!=typeof window&&t===window)return\"{ [object Window] }\";if(t===c)return\"{ [object globalThis] }\";if(!function(e){return!(\"[object Date]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)&&!uo(t)){var P=So(t,f),E=eo?eo(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?\"\":\"null prototype\",T=!E&&Yr&&Object(t)===t&&Yr in t?Lr.call(ho(t),8,-1):A?\"Object\":\"\",N=(E||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||A?\"[\"+zr.call(qr.call([],T||[],A||[]),\": \")+\"] \":\"\");return 0===P.length?N+\"{}\":h?N+\"{\"+_o(P,h)+\"}\":N+\"{ \"+zr.call(P,\", \")+\" }\"}return String(t)},Eo=wo(\"%TypeError%\"),Ao=wo(\"%WeakMap%\",!0),To=wo(\"%Map%\",!0),No=Oo(\"WeakMap.prototype.get\",!0),Co=Oo(\"WeakMap.prototype.set\",!0),ko=Oo(\"WeakMap.prototype.has\",!0),Mo=Oo(\"Map.prototype.get\",!0),jo=Oo(\"Map.prototype.set\",!0),Ro=Oo(\"Map.prototype.has\",!0),xo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},Uo=String.prototype.replace,Io=/%20/g,Do=\"RFC3986\",Fo={default:Do,formatters:{RFC1738:function(e){return Uo.call(e,Io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:Do},Lo=Fo,Go=Object.prototype.hasOwnProperty,Ko=Array.isArray,Bo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),Ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},qo={arrayToObject:Ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],s=Object.keys(i),a=0;a<s.length;++a){var u=s[a],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(Ko(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var s=\"\",a=0;a<i.length;++a){var u=i.charCodeAt(a);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Lo.RFC1738&&(40===u||41===u)?s+=i.charAt(a):u<128?s+=Bo[u]:u<2048?s+=Bo[192|u>>6]+Bo[128|63&u]:u<55296||u>=57344?s+=Bo[224|u>>12]+Bo[128|u>>6&63]+Bo[128|63&u]:(a+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(a)),s+=Bo[240|u>>18]+Bo[128|u>>12&63]+Bo[128|u>>6&63]+Bo[128|63&u])}return s},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Ko(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(Ko(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!Go.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return Ko(t)&&!Ko(n)&&(o=Ho(t,r)),Ko(t)&&Ko(n)?(n.forEach((function(n,o){if(Go.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return Go.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},zo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new Eo(\"Side channel does not contain \"+Po(e))},get:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return No(e,r)}else if(To){if(t)return Mo(t,r)}else if(n)return function(e,t){var n=xo(e,t);return n&&n.value}(n,r)},has:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return ko(e,r)}else if(To){if(t)return Ro(t,r)}else if(n)return function(e,t){return!!xo(e,t)}(n,r);return!1},set:function(r,o){Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Ao),Co(e,r,o)):To?(t||(t=new To),jo(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=xo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},Vo=qo,Wo=Fo,Jo=Object.prototype.hasOwnProperty,$o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Qo=Array.isArray,Xo=Array.prototype.push,Yo=function(e,t){Xo.apply(e,Qo(t)?t:[t])},Zo=Date.prototype.toISOString,ei=Wo.default,ti={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:Vo.encode,encodeValuesOnly:!1,format:ei,formatter:Wo.formatters[ei],indices:!1,serializeDate:function(e){return Zo.call(e)},skipNulls:!1,strictNullHandling:!1},ni={},ri=function e(t,n,r,o,i,s,a,u,c,l,p,h,f,d,y,g){for(var m,b=t,v=g,_=0,S=!1;void 0!==(v=v.get(ni))&&!S;){var w=v.get(t);if(_+=1,void 0!==w){if(w===_)throw new RangeError(\"Cyclic object value\");S=!0}void 0===v.get(ni)&&(_=0)}if(\"function\"==typeof u?b=u(n,b):b instanceof Date?b=p(b):\"comma\"===r&&Qo(b)&&(b=Vo.maybeMap(b,(function(e){return e instanceof Date?p(e):e}))),null===b){if(i)return a&&!d?a(n,ti.encoder,y,\"key\",h):n;b=\"\"}if(\"string\"==typeof(m=b)||\"number\"==typeof m||\"boolean\"==typeof m||\"symbol\"==typeof m||\"bigint\"==typeof m||Vo.isBuffer(b))return a?[f(d?n:a(n,ti.encoder,y,\"key\",h))+\"=\"+f(a(b,ti.encoder,y,\"value\",h))]:[f(n)+\"=\"+f(String(b))];var O,P=[];if(void 0===b)return P;if(\"comma\"===r&&Qo(b))d&&a&&(b=Vo.maybeMap(b,a)),O=[{value:b.length>0?b.join(\",\")||null:void 0}];else if(Qo(u))O=u;else{var E=Object.keys(b);O=c?E.sort(c):E}for(var A=o&&Qo(b)&&1===b.length?n+\"[]\":n,T=0;T<O.length;++T){var N=O[T],C=\"object\"==typeof N&&void 0!==N.value?N.value:b[N];if(!s||null!==C){var k=Qo(b)?\"function\"==typeof r?r(A,N):A:A+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var M=zo();M.set(ni,g),Yo(P,e(C,k,r,o,i,s,\"comma\"===r&&d&&Qo(b)?null:a,u,c,l,p,h,f,d,y,M))}}return P},oi=qo,ii=Object.prototype.hasOwnProperty,si=Array.isArray,ai={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:oi.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ui=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},ci=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},li=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,s=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),a=s?o.slice(0,s.index):o,u=[];if(a){if(!n.plainObjects&&ii.call(Object.prototype,a)&&!n.allowPrototypes)return;u.push(a)}for(var c=0;n.depth>0&&null!==(s=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&ii.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push(\"[\"+o.slice(s.index)+\"]\"),function(e,t,n,r){for(var o=r?t:ci(t,n),i=e.length-1;i>=0;--i){var s,a=e[i];if(\"[]\"===a&&n.parseArrays)s=[].concat(o);else{s=n.plainObjects?Object.create(null):{};var u=\"[\"===a.charAt(0)&&\"]\"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&a!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(s=[])[c]=o:\"__proto__\"!==u&&(s[u]=o):s={0:o}}o=s}return o}(u,t,n,r)}},pi=function(e,t){var n,r=e,o=function(e){if(!e)return ti;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||ti.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=Wo.default;if(void 0!==e.format){if(!Jo.call(Wo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=Wo.formatters[n],o=ti.filter;return(\"function\"==typeof e.filter||Qo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:ti.addQueryPrefix,allowDots:void 0===e.allowDots?ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ti.charsetSentinel,delimiter:void 0===e.delimiter?ti.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:ti.encode,encoder:\"function\"==typeof e.encoder?e.encoder:ti.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ti.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:ti.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:ti.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ti.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Qo(o.filter)&&(n=o.filter);var i,s=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in $o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var a=$o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===a&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=zo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Yo(s,ri(r[p],p,a,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var h=s.join(o.delimiter),f=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?f+=\"utf8=%26%2310003%3B&\":f+=\"utf8=%E2%9C%93&\"),h.length>0?f+h:\"\"},hi={formats:Fo,parse:function(e,t){var n=function(e){if(!e)return ai;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?ai.charset:e.charset;return{allowDots:void 0===e.allowDots?ai.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:ai.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:ai.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:ai.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ai.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:ai.comma,decoder:\"function\"==typeof e.decoder?e.decoder:ai.decoder,delimiter:\"string\"==typeof e.delimiter||oi.isRegExp(e.delimiter)?e.delimiter:ai.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:ai.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:ai.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:ai.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:ai.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ai.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,i),a=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<s.length;++n)0===s[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===s[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===s[n]&&(u=\"iso-8859-1\"),a=n,n=s.length);for(n=0;n<s.length;++n)if(n!==a){var c,l,p=s[n],h=p.indexOf(\"]=\"),f=-1===h?p.indexOf(\"=\"):h+1;-1===f?(c=t.decoder(p,ai.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,f),ai.decoder,u,\"key\"),l=oi.maybeMap(ci(p.slice(f+1),t),(function(e){return t.decoder(e,ai.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=ui(l)),p.indexOf(\"[]=\")>-1&&(l=si(l)?[l]:l),ii.call(r,c)?r[c]=oi.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),s=0;s<i.length;++s){var a=i[s],u=li(a,r[a],n,\"string\"==typeof e);o=oi.merge(o,u,n)}return!0===n.allowSparse?o:oi.compact(o)},stringify:pi},fi={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(fi);const di=Or,yi=fi.isObject,gi=fi.hasOwn;var mi=bi;function bi(){}bi.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},bi.prototype.parse=function(e){return this._parser=e,this},bi.prototype.responseType=function(e){return this._responseType=e,this},bi.prototype.serialize=function(e){return this._serializer=e,this},bi.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(gi(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},bi.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const vi=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),_i=new Set([408,413,429,500,502,503,504,521,522,524]);bi.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&_i.has(t.status))return!0;if(e){if(e.code&&vi.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},bi.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},bi.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},bi.prototype.catch=function(e){return this.then(void 0,e)},bi.prototype.use=function(e){return e(this),this},bi.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},bi.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},bi.prototype.get=function(e){return this._header[e.toLowerCase()]},bi.prototype.getHeader=bi.prototype.get,bi.prototype.set=function(e,t){if(yi(e)){for(const t in e)gi(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},bi.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},bi.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(yi(e)){for(const t in e)gi(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)gi(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},bi.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(di.gte(process.version,\"v13.0.0\")&&di.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},bi.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},bi.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},bi.prototype.redirects=function(e){return this._maxRedirects=e,this},bi.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},bi.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},bi.prototype.send=function(e){const t=yi(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&yi(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");gi(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},bi.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},bi.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},bi.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},bi.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},bi.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Si=fi;var wi=Oi;function Oi(){}function Pi(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ai(){this._defaults=[]}Oi.prototype.get=function(e){return this.header[e.toLowerCase()]},Oi.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Si.type(t);const n=Si.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Si.parseLinks(e.link))}catch(e){}},Oi.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Ti=0,Ni=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Ti<Ni.length;Ti++){const e=Ni[Ti];Ai.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Ai.prototype._setDefaults=function(e){var t,n=Pi(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Ci=Ai;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Pn.exports,s=En,a=hi,u=mi,c=fi.isObject,l=fi.mixin,p=fi.hasOwn,h=wi,f=Ci;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=w,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function m(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&b(t,n,e[n]);return t.join(\"&\")}function b(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){b(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&b(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function v(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function S(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,s;for(let e=0,a=t.length;e<a;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),s=g(o.slice(r+1)),n[i]=s);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new S(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=m,y.parseString=v,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":a.stringify,\"application/json\":s},y.parse={\"application/x-www-form-urlencoded\":v,\"application/json\":JSON.parse},l(S.prototype,h.prototype),S.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},S.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=S,i(w.prototype),l(w.prototype,u.prototype),w.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},w.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},w.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},w.prototype.query=function(e){return\"string\"!=typeof e&&(e=m(e)),e&&this._query.push(e),this},w.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},w.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},w.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},w.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},w.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new f;for(var O=0,P=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];O<P.length;O++){const e=P[O];f.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}f.prototype.del=f.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(On,On.exports);var ki=On.exports;function Mi(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ji(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(Mi)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:k.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,s={};if(s.error=null!==e,s.operation=t.operation,o&&o.status&&(s.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{s.errorData=JSON.parse(e.response.text)}catch(t){s.errorData=e}else s.errorData=e;return s.category=r._detectErrorCategory(e),n(s,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return s.errorData=o,s.error=!0,n(s,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(s.errorData=i,s.statusCode=i.status,s.error=!0,s.category=r._detectErrorCategory(s),n(s,null)):(i.error&&i.error.message&&(s.errorData=i.error),n(s,i))})),o}function Ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ki.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function xi(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ui(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ii(e,t,n,r){var o=ki.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Di(e,t,n,r){var o=ki.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Fi(e,t,n){var r=ki.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var Gi,Ki=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:s})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,data:s})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=Li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return s=i.sent(),a=Li(r.buffer,s),[2,e.decoder.decode(a)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),s=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,s)];case 1:return a=i.sent(),[2,e.decoder.decode(a)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Bi=(Gi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),Gi.supportsFile=\"undefined\"!=typeof File,Gi.supportsBlob=\"undefined\"!=typeof Blob,Gi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,Gi.supportsBuffer=!1,Gi.supportsStream=!1,Gi.supportsString=!0,Gi.supportsEncryptFile=!0,Gi.supportsFileUri=!1,Gi),Hi=function(){function e(e){this.config=e,this.cryptor=new T({config:e}),this.fileCryptor=new Ki}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:b(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),qi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:m(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),zi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new qi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new qi({cipherKey:e.cipherKey}),cryptors:[new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],a(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?m(e):e,n=Vi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===Vi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=Vi.tryParse(r),(null==(s=this.getCryptor(o))?void 0:s.identifier)===e.LEGACY_IDENTIFIER?[2,s.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return a=i.sent(),u=a.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof Wi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=Vi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Vi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new Wi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var s=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return s=n[i],i+=1,255===s&&n.byteLength>=i+2&&(s=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new Wi(this.decoder.decode(o),s)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),Wi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return Vi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return Vi.SENTINEL.length+1+Vi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(Vi.SENTINEL)),t[e+=Vi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=Vi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function Ji(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var $i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new _n({del:Fi,get:Ui,post:Ii,patch:Di,sendBeacon:Ji,getfile:xi,postfile:Ri}),t.cbor=new wn((function(e){return Sn(h.decode(e))}),m),t.PubNubFile=Bi,t.cryptography=new Ki,t.initCryptoModule=function(e){return new zi({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new qi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=zi,n}(vn);return $i}));",
          "",
          "[Added Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(f,f.exports);var d=f.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o,i=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=i.secretKey||i.secret_key,this.subscribeKey=i.subscribeKey||i.subscribe_key,this.publishKey=i.publishKey||i.publish_key,this.sdkName=i.sdkName,this.sdkFamily=i.sdkFamily,this.partnerId=i.partnerId,this.setAuthKey(i.authKey),this.cryptoModule=i.cryptoModule,this.setFilterExpression(i.filterExpression),\"string\"!=typeof i.origin&&!Array.isArray(i.origin)&&void 0!==i.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=i.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=i.ssl||!1,this.restore=i.restore||!1,this.proxy=i.proxy,this.keepAlive=i.keepAlive,this.keepAliveSettings=i.keepAliveSettings,this.autoNetworkDetection=i.autoNetworkDetection||!1,this.dedupeOnSubscribe=i.dedupeOnSubscribe||!1,this.maximumCacheSize=i.maximumCacheSize||100,this.customEncrypt=i.customEncrypt,this.customDecrypt=i.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=i.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=i.useRandomIVs)||void 0===n||n,this.enableEventEngine=null!==(r=i.enableEventEngine)&&void 0!==r&&r,this.maintainPresenceState=null===(o=i.maintainPresenceState)||void 0===o||o,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=i.logVerbosity||!1,this.suppressLeaveEvents=i.suppressLeaveEvents||!1,this.announceFailedHeartbeats=i.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=i.announceSuccessfulHeartbeats||!1,this.useInstanceId=i.useInstanceId||!1,this.useRequestId=i.useRequestId||!1,this.requestMessageCountThreshold=i.requestMessageCountThreshold,i.retryConfiguration&&this._setRetryConfiguration(i.retryConfiguration),this.setTransactionTimeout(i.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(i.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(i.useSendBeacon||!0),i.presenceTimeout?this.setPresenceTimeout(i.presenceTimeout):this._presenceTimeout=300,null!=i.heartbeatInterval&&this.setHeartbeatInterval(i.heartbeatInterval),\"string\"==typeof i.userId){if(\"string\"==typeof i.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(i.userId)}else{if(\"string\"!=typeof i.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(i.uuid)}this.setCipherKey(i.cipherKey,i)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.6.2\"},e.prototype._setRetryConfiguration=function(e){if(e.minimumdelay<2)throw new Error(\"Minimum delay can not be set less than 2 seconds for retry\");if(e.maximumDelay>150)throw new Error(\"Maximum delay can not be set more than 150 seconds for retry\");if(e.maximumDelay&&maximumRetry>6)throw new Error(\"Maximum retry for exponential retry policy can not be more than 6\");if(e.maximumRetry>10)throw new Error(\"Maximum retry for linear retry policy can not be more than 10\");this.retryConfiguration=e},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function m(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function s(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var a=0;a<n;a+=3){var u=s(),c=s(),l=s(),p=s(),h=(63&u)<<2|c>>4,f=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[a]=h,64!=l&&(o[a+1]=f),64!=p&&(o[a+2]=d)}return r}function b(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,s=i%3,a=i-s,u=0;u<a;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==s?n+=r[(252&(t=o[a]))>>2]+r[(3&t)<<4]+\"==\":2==s&&(n+=r[(64512&(t=o[a]<<8|o[a+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var v,_,S,w,O,P=P||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,a=o/(4*i);if(t=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new s.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=n.algo={};return n}(Math);!function(e){for(var t=P,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),h=2;h<=p;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var f=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],c=n[5],l=n[6],p=n[7],h=0;64>h;h++){if(16>h)f[h]=0|e[t+h];else{var d=f[h-15],y=f[h-2];f[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+f[h-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+f[h-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[h]+f[h],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=a+d|0,a=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(v=P).enc.Utf8,v.algo.HMAC=v.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,a=i.words,u=0;u<n;u++)s[u]^=1549556828,a[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),w=(S=P).lib.WordArray,S.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;4>s&&o+.75*s<n;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var s=n.indexOf(e.charAt(i-1))<<i%4*2,a=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(s|a)<<24-o%4*8,o++}return w.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,s){return((e=e+(t&n|~t&r)+o+s)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,s){return((e=e+(t&r|n&~r)+o+s)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,s){return((e=e+(t^n^r)+o+s)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,s){return((e=e+(n^(t|~r))+o+s)<<i|e>>>32-i)+t}for(var i=P,s=(u=i.lib).WordArray,a=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var s=0;16>s;s++){var a=e[u=i+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[i+0],l=(a=e[i+1],e[i+2]),p=e[i+3],h=e[i+4],f=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],m=e[i+9],b=e[i+10],v=e[i+11],_=e[i+12],S=e[i+13],w=e[i+14],O=e[i+15],P=t(P=s[0],T=s[1],A=s[2],E=s[3],u,7,c[0]),E=t(E,P,T,A,a,12,c[1]),A=t(A,E,P,T,l,17,c[2]),T=t(T,A,E,P,p,22,c[3]);P=t(P,T,A,E,h,7,c[4]),E=t(E,P,T,A,f,12,c[5]),A=t(A,E,P,T,d,17,c[6]),T=t(T,A,E,P,y,22,c[7]),P=t(P,T,A,E,g,7,c[8]),E=t(E,P,T,A,m,12,c[9]),A=t(A,E,P,T,b,17,c[10]),T=t(T,A,E,P,v,22,c[11]),P=t(P,T,A,E,_,7,c[12]),E=t(E,P,T,A,S,12,c[13]),A=t(A,E,P,T,w,17,c[14]),P=n(P,T=t(T,A,E,P,O,22,c[15]),A,E,a,5,c[16]),E=n(E,P,T,A,d,9,c[17]),A=n(A,E,P,T,v,14,c[18]),T=n(T,A,E,P,u,20,c[19]),P=n(P,T,A,E,f,5,c[20]),E=n(E,P,T,A,b,9,c[21]),A=n(A,E,P,T,O,14,c[22]),T=n(T,A,E,P,h,20,c[23]),P=n(P,T,A,E,m,5,c[24]),E=n(E,P,T,A,w,9,c[25]),A=n(A,E,P,T,p,14,c[26]),T=n(T,A,E,P,g,20,c[27]),P=n(P,T,A,E,S,5,c[28]),E=n(E,P,T,A,l,9,c[29]),A=n(A,E,P,T,y,14,c[30]),P=r(P,T=n(T,A,E,P,_,20,c[31]),A,E,f,4,c[32]),E=r(E,P,T,A,g,11,c[33]),A=r(A,E,P,T,v,16,c[34]),T=r(T,A,E,P,w,23,c[35]),P=r(P,T,A,E,a,4,c[36]),E=r(E,P,T,A,h,11,c[37]),A=r(A,E,P,T,y,16,c[38]),T=r(T,A,E,P,b,23,c[39]),P=r(P,T,A,E,S,4,c[40]),E=r(E,P,T,A,u,11,c[41]),A=r(A,E,P,T,p,16,c[42]),T=r(T,A,E,P,d,23,c[43]),P=r(P,T,A,E,m,4,c[44]),E=r(E,P,T,A,_,11,c[45]),A=r(A,E,P,T,O,16,c[46]),P=o(P,T=r(T,A,E,P,l,23,c[47]),A,E,u,6,c[48]),E=o(E,P,T,A,y,10,c[49]),A=o(A,E,P,T,w,15,c[50]),T=o(T,A,E,P,f,21,c[51]),P=o(P,T,A,E,_,6,c[52]),E=o(E,P,T,A,p,10,c[53]),A=o(A,E,P,T,b,15,c[54]),T=o(T,A,E,P,a,21,c[55]),P=o(P,T,A,E,g,6,c[56]),E=o(E,P,T,A,O,10,c[57]),A=o(A,E,P,T,d,15,c[58]),T=o(T,A,E,P,S,21,c[59]),P=o(P,T,A,E,h,6,c[60]),E=o(E,P,T,A,v,10,c[61]),A=o(A,E,P,T,l,15,c[62]),T=o(T,A,E,P,m,21,c[63]);s[0]=s[0]+P|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=a._createHelper(u),i.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e,t=P,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(a=this.cfg).hasher.create(),o=r.create(),i=o.words,s=a.keySize,a=a.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<a;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*s,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),P.lib.Cipher||function(e){var t=(f=P).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=f.enc.Base64,s=f.algo.EvpKDF,a=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:h).decrypt(e,t,n,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=f.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(f.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],s=0;s<n;s+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(f.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),f=(f.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=s.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:f}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=P,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],s=[],a=[],u=[],c=[],l=[],p=[],h=[],f=[],d=0;256>d;d++)f[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;r[y]=m,o[m]=y;var b=f[y],v=f[b],_=f[v],S=257*f[m]^16843008*m;i[y]=S<<24|S>>>8,s[y]=S<<16|S>>>16,a[y]=S<<8|S>>>24,u[y]=S,S=16843009*_^65537*v^257*b^16843008*y,c[m]=S<<24|S>>>8,l[m]=S<<16|S>>>16,p[m]=S<<8|S>>>24,h[m]=S,y?(y=b^f[f[f[_^b]]],g^=f[f[g]]):y=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var s=o[i-1];i%t?6<t&&4==i%t&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=w[i/t|0]<<24),o[i]=o[i-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,s=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?s:c[r[s>>>24]]^l[r[s>>>16&255]]^p[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,s,a,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,h,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],h=e[t+3]^n[3],f=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^s[255&h]^n[f++],g=r[l>>>24]^o[p>>>16&255]^i[h>>>8&255]^s[255&c]^n[f++],m=r[p>>>24]^o[h>>>16&255]^i[c>>>8&255]^s[255&l]^n[f++];h=r[h>>>24]^o[c>>>16&255]^i[l>>>8&255]^s[255&p]^n[f++],c=y,l=g,p=m}y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^n[f++],g=(a[l>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[f++],m=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[f++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&p])^n[f++],e[t]=y,e[t+1]=g,e[t+2]=m,e[t+3]=h},keySize:8});e.AES=t._createHelper(n)}(),P.mode.ECB=((O=P.lib.BlockCipherMode.extend()).Encryptor=O.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),O.Decryptor=O.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),O);var E=P;function A(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var T=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),s=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(s.clone()).toString(E.enc.Base64)}var a=this._getIV(n);return E.AES.encrypt(e,o,{iv:a,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=A((u=new Uint8ClampedArray(m(e))).slice(0,16)),s=A(u.slice(16));try{var a=E.AES.decrypt({ciphertext:s},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);a=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(a)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),C=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}(),k={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\",PNDisconnectedCategory:\"PNDisconnectedCategory\",PNConnectionErrorCategory:\"PNConnectionErrorCategory\",PNDisconnectedUnexpectedlyCategory:\"PNDisconnectedUnexpectedlyCategory\"},M=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,s=e.getFileUrl,a=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule,p=e.eventEmitter;this._listenerManager=c,this._config=a,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=s,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new C({config:a}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=p}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,s=e.channelGroups,a=void 0===s?[]:s,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),a.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),a.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:a,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:a},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),s.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),s.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:s},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=e.withPresence,u=void 0!==a&&a,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),s.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,s=void 0===i?[]:i,a=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],a.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))})),s.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},(function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var n=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===k.PNTimeoutCategory?this._startSubscribeLoop():e.category===k.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:k.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===k.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=k.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var o=t.messages||[],i=this._config,s=i.requestMessageCountThreshold,a=i.dedupeOnSubscribe;if(s&&o.length>=s){var u={};u.category=k.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}o.forEach((function(e){if(e.channel,e.subscriptionMatch,a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}n._eventEmitter.emitEvent(e)})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),j={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},R=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[j.PNSubscribeOperation,j.PNReceiveMessagesOperation,j.PNHandshakeOperation],this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){!this._telemetryExcludeOperations.includes(e)&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(!this._telemetryExcludeOperations.includes(e)&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case j.PNPublishOperation:t=\"pub\";break;case j.PNSignalOperation:t=\"sig\";break;case j.PNHistoryOperation:case j.PNFetchMessagesOperation:case j.PNDeleteMessagesOperation:case j.PNMessageCounts:t=\"hist\";break;case j.PNUnsubscribeOperation:case j.PNWhereNowOperation:case j.PNHereNowOperation:case j.PNHeartbeatOperation:case j.PNSetStateOperation:case j.PNGetStateOperation:t=\"pres\";break;case j.PNAddChannelsToGroupOperation:case j.PNRemoveChannelsFromGroupOperation:case j.PNChannelGroupsOperation:case j.PNRemoveGroupOperation:case j.PNChannelsForGroupOperation:t=\"cg\";break;case j.PNPushNotificationEnabledChannelsOperation:case j.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case j.PNCreateUserOperation:case j.PNUpdateUserOperation:case j.PNDeleteUserOperation:case j.PNGetUserOperation:case j.PNGetUsersOperation:case j.PNCreateSpaceOperation:case j.PNUpdateSpaceOperation:case j.PNDeleteSpaceOperation:case j.PNGetSpaceOperation:case j.PNGetSpacesOperation:case j.PNGetMembersOperation:case j.PNUpdateMembersOperation:case j.PNGetMembershipsOperation:case j.PNUpdateMembershipsOperation:t=\"obj\";break;case j.PNAddMessageActionOperation:case j.PNRemoveMessageActionOperation:case j.PNGetMessageActionsOperation:t=\"msga\";break;case j.PNAccessManagerGrant:case j.PNAccessManagerAudit:t=\"pam\";break;case j.PNAccessManagerGrantToken:case j.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),x=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),U=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,s={topic:t,environment:r};return i.length&&(s.excluded_devices=i),s},r}(x),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(x),D=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var s=r(i,[\"notification\",\"data\"]);e=n(n({},e),s)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(x),F=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new U(this._payload.apns,e,t),this.mpns=new I(this._payload.mpns,e,t),this.fcm=new D(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),L=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.includes(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=k.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=k.PNNetworkDownCategory,this.announceStatus(e)},e}(),G=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),s=n.pat.uuid?Object.keys(n.pat.uuid):[],a=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,h=i.length>0;(l||p||h)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),h&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var f=s.length>0,d=a.length>0,y=u.length>0;return(f||d||y)&&(c.patterns={},f&&(c.patterns.uuids={},s.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},a.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}();function K(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function B(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var H={signPamFromParams:function(e){return B(e).map((function(t){return\"\".concat(t,\"=\").concat(K(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:K,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},removeSingleOccurance:function(e,t){var n=Object.fromEntries(t.map((function(e){return[e,!1]})));return e.filter((function(e){return!(t.includes(e)&&!n[e])||(n[e]=!0,!1)}))},findUniqueCommonElements:function(e,t){return __spreadArray([],__read(e),!1).filter((function(n){return t.includes(n)&&e.indexOf(n)===e.lastIndexOf(n)&&t.indexOf(n)===t.lastIndexOf(n)}))}},q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,s=e.crypto,a=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(a=\"GET\"),\"GETFILE\"===a&&(a=\"GET\");var u=\"\".concat(a,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(H.signPamFromParams(n),\"\\n\");if(\"POST\"===a)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===a){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(s.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,s=e.config,a=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,h={};t.getOperation()===j.PNTimeOperation||t.getOperation()===j.PNChannelGroupsOperation?l=r[0]:(h=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=H.createPromise());var f=t.validateParams(e,h);if(f)return l?l(z(f)):p?(p.reject(new q(\"Validation failed, check status for details\",z(f))),p.promise):void 0;var d,g=t.prepareParams(e,h),m=V(t,e,h),b={url:m,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,h):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,h):null};g.uuid=s.UUID,g.pnsdk=W(s);var v=a.operationsLatencyForRequest();if(Object.keys(v).length&&(g=n(n({},g),v)),s.useInstanceId&&(g.instanceid=s.instanceId),s.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||s.getAuthKey();_&&(g.auth=_)}s.secretKey&&$(e,m,g,h,t);var S=function(n,r){if(n.error)return t.handleError&&t.handleError(e,h,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));a.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,h);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===j.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:k.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(a.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,h)){var w=t.postPayload(e,h);d=i.POST(g,w,b,S)}else if(\"PATCH\"===J(e,t,h)){w=t.patchPayload(e,h);d=i.PATCH(g,w,b,S)}else d=\"DELETE\"===J(e,t,h)?i.DELETE(g,b,S):\"GETFILE\"===J(e,t,h)?i.GETFILE(g,b,S):i.GET(g,b,S);return t.getOperation()===j.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return j.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,s=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?s.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,s=t.environment,a=void 0===s?\"development\":s,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:a,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return j.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a=t.start,u=t.count,c={type:r};return\"apns2\"===r&&delete(c=n(n({},c),{environment:i,topic:s})).type,a&&(c.start=a),u&&u>0&&(c.count=u),c},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,s=t.topic,a={type:r};return\"apns2\"===r&&delete(a=n(n({},a),{environment:i,topic:s})).type,a},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return j.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return j.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),o&&(s.state=JSON.stringify(o)),s.heartbeat=i.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,s=void 0===i?[]:i,a=s.length>0?s.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(a),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a={};return 1===o.length&&0===s.length?a[o[0]]=t.payload:a=t.payload,{channels:a}}});var le=Object.freeze({__proto__:null,getOperation:function(){return j.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,s=t.channelGroups,a=void 0===s?[]:s;return r?n.subscribeKey?0===i.length&&0===a.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(i),\"/uuid/\").concat(H.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,s=void 0===i?[]:i,a=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||s.length>0){var u=o.length>0?o.join(\",\"):\",\";a+=\"/channel/\".concat(H.encodeString(u))}return a},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,s=void 0===i||i,a=t.includeState,u=void 0!==a&&a,c=t.queryParameters,l=void 0===c?{}:c,p={};return s||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,s=void 0===i?[]:i,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return o.length>1||s.length>0||0===s.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var he=Object.freeze({__proto__:null,getOperation:function(){return j.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var fe=Object.freeze({__proto__:null,getOperation:function(){return j.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return j.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(H.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return j.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},me={getOperation:function(){return j.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(H.encodeString(t.channel),\"/0/\").concat(H.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},be=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,s=e.modules,a=s.PubNubFile,u=s.config,c=s.cryptography,l=s.cryptoModule,p=s.networking;return function(e){var s=e.channel,h=e.file,f=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,m=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,b,v,_,S,w,O,P,E,A,T,N,C,k,M,j,R,x,U,I,D,F,L,G,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!s)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!h)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=a.create(h),[4,n({channel:s,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,b=o.url,v=o.form_fields,_=t.data,S=_.id,w=_.name,a.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,a)]:[3,6];case 2:return O=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,a)];case 4:O=i.sent(),i.label=5;case 5:e=O,i.label=6;case 6:P=v,e.mimeType&&(P=v.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),a.supportsFileUri&&h.uri?(T=(A=p).POSTFILE,N=[b,P],[4,e.toFileUri()]):[3,10];case 8:return[4,T.apply(A,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return a.supportsFile?(k=(C=p).POSTFILE,M=[b,P],[4,e.toFile()]):[3,13];case 11:return[4,k.apply(C,M.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return a.supportsBuffer?(R=(j=p).POSTFILE,x=[b,P],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(j,x.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return a.supportsBlob?(I=(U=p).POSTFILE,D=[b,P],[4,e.toBlob()]):[3,19];case 17:return[4,I.apply(U,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(L=F.response.text,G=/<Message>(.*)<\\/Message>/gi.exec(L),new q(G?\"Upload to bucket failed: \".concat(G[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:s,message:f,fileId:S,fileName:w,meta:y,storeInHistory:m,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:S,name:w}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:s,id:S,name:w})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},ve=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,s=e.networking,a=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(H.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=a.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(s.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(s.getStandardOrigin()).concat(u)},_e={getOperation:function(){return j.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,s=e.config,a=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,a.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:s.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Se={getOperation:function(){return j.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},we={getOperation:function(){return j.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Oe={getOperation:function(){return j.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Pe={getOperation:function(){return j.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return j.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ae={getOperation:function(){return j.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),h.include=h.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(h.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(h.start=null===(s=t.page)||void 0===s?void 0:s.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(h.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),h.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Te={getOperation:function(){return j.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return j.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return j.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return j.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&m.include.push(\"uuid\"),(null===(i=t.include)||void 0===i?void 0:i.customUUIDFields)&&m.include.push(\"uuid.custom\"),(null===(s=t.include)||void 0===s?void 0:s.UUIDStatusField)&&m.include.push(\"uuid.status\"),(null===(u=t.include)||void 0===u?void 0:u.UUIDTypeField)&&m.include.push(\"uuid.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return j.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(H.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&h.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&h.include.push(\"uuid\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return j.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h,f,d,y,g,m={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&m.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&m.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&m.include.push(\"channel\"),(null===(i=t.include)||void 0===i?void 0:i.customChannelFields)&&m.include.push(\"channel.custom\"),(null===(s=t.include)||void 0===s?void 0:s.channelStatusField)&&m.include.push(\"channel.status\"),(null===(u=t.include)||void 0===u?void 0:u.channelTypeField)&&m.include.push(\"channel.type\")),m.include=m.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(m.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(m.start=null===(h=t.page)||void 0===h?void 0:h.next),(null===(f=null==t?void 0:t.page)||void 0===f?void 0:f.prev)&&(m.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(m.filter=t.filter),m.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(m.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),m},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return j.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(H.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,s,u,c,l,p,h={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&h.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&h.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&h.include.push(\"channel\")),h.include=h.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(h.count=!0),(null===(s=null==t?void 0:t.page)||void 0===s?void 0:s.next)&&(h.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(h.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(h.filter=t.filter),null!=t.limit&&(h.limit=t.limit),(null==t?void 0:t.sort)&&(h.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=a(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),h},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var xe=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,s={};return n&&(s.channel=n),r&&(s[\"channel-group\"]=r),i.length>0&&(s.auth=i.join(\",\")),s},handleResponse:function(e,t){return t.payload}});var Ue=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.uuids,a=void 0===s?[]:s,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,h=void 0!==p&&p,f=t.manage,d=void 0!==f&&f,y=t.get,g=void 0!==y&&y,m=t.join,b=void 0!==m&&m,v=t.update,_=void 0!==v&&v,S=t.authKeys,w=void 0===S?[]:S,O=t.delete,P={};return P.r=l?\"1\":\"0\",P.w=h?\"1\":\"0\",P.m=d?\"1\":\"0\",P.d=O?\"1\":\"0\",P.g=g?\"1\":\"0\",P.j=b?\"1\":\"0\",P.u=_?\"1\":\"0\",r.length>0&&(P.channel=r.join(\",\")),i.length>0&&(P[\"channel-group\"]=i.join(\",\")),w.length>0&&(P.auth=w.join(\",\")),a.length>0&&(P[\"target-uuid\"]=a.join(\",\")),(u||0===u)&&(P.ttl=u),P},handleResponse:function(){return{}}});function Ie(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),s=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),a=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||s||c||a||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(Ie(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorizedUserId,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,h=o.spaces,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,s=t.authorized_uuid,a={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){a.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){a.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){a.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,h=o.channels,f=o.groups;p&&Object.keys(p).forEach((function(e){a.permissions.patterns.uuids[e]=De(p[e])})),h&&Object.keys(h).forEach((function(e){a.permissions.patterns.channels[e]=De(h[e])})),f&&Object.keys(f).forEach((function(e){a.permissions.patterns.groups[e]=De(f[e])}))}return(n||0===n)&&(a.ttl=n),i&&(a.permissions.meta=i),s&&(a.permissions.uuid=\"\".concat(s)),a}var Le=Object.freeze({__proto__:null,getOperation:function(){return j.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,s,a,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),h=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),f=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.channels),y=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.groups),g=c||l||f||p||d||h||y;return Ie(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Ge={getOperation:function(){return j.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(H.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:b(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return j.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0/\").concat(H.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(H.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,s=t.ttl,a={};return null!=i&&(a.store=i?\"1\":\"0\"),s&&(a.ttl=s),!1===o&&(a.norep=\"true\"),n&&\"object\"==typeof n&&(a.meta=JSON.stringify(n)),a},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return j.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,s=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(H.encodeString(o),\"/0/\").concat(H.encodeString(s))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});var qe=Object.freeze({__proto__:null,getOperation:function(){return j.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,s=void 0===i?100:i,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=s,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message),o={timetoken:t.timetoken,entry:r.payload};t.meta&&(o.meta=t.meta),r.error&&(o.error=r.error),n.messages.push(o)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return j.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(H.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return j.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(H.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=a(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return j.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,s=e.config,a=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(a,\"/sub-key/\").concat(s.subscribeKey,\"/channel/\").concat(H.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,s=t.count,a=t.stringifiedTimeToken,u=void 0!==a&&a,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,h=t.includeUUID,f=void 0===h||h,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=s||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),f&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={},i=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message);o.channel=r,o.timetoken=t.timetoken,o.message=i.payload,o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),i.error&&(o.error=i.error),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var Je=Object.freeze({__proto__:null,getOperation:function(){return j.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var $e=Object.freeze({__proto__:null,getOperation:function(){return j.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,s=t.timetoken,a=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),a&&a.length>0&&(c[\"filter-expr\"]=a),Object.keys(r).length&&(c.state=JSON.stringify(r)),s&&(c.tt=s),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={timetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return j.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,t.state&&(n.state=JSON.stringify(t.state)),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.ee=\"\",n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return j.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(H.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),t.filterExpression&&t.filterExpression.length>0&&(n[\"filter-expr\"]=t.filterExpression),n.tt=t.timetoken,n.tr=t.region,n.ee=\"\",n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=a(c,3),p=l[0],h=l[1],f=l[2];try{for(var d=s(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var m=this.currentState;this.currentState=p;var b=this.currentContext;this.currentContext=h,this.notify({type:\"transitionDone\",fromState:m,fromContext:b,toState:p,toContext:h,event:e});try{for(var v=s(f),_=v.next();!_.done;_=v.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}try{for(var S=s(this.currentState.enterEffects),w=S.next();!w.done;w=S.next()){g=w.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{w&&!w.done&&(u=S.return)&&u.call(S)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e.prototype.dispose=function(){var e,t;try{for(var n=s(this.instances.entries()),r=n.next();!r.done;r=n.next()){var o=a(r.value,2),i=o[0];o[1].cancel(),this.instances.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],a(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!1}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],a(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),st=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new it},n.prototype.abort=function(){this._aborted=!0,this.notify(new it)},n}(Ye),at=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new st,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch((function(e){}))},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),ut=function(e){return function(t,n){return new at(t,n,e)}},ct=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),lt=ot(\"RECEIVE_MESSAGES\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),pt=rt(\"EMIT_MESSAGES\",(function(e){return e})),ht=rt(\"EMIT_STATUS\",(function(e){return e})),ft=ot(\"RECEIVE_RECONNECT\",(function(e){return e})),dt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),yt=nt(\"SUBSCRIPTION_CHANGED\",(function(e,t){return{channels:e,groups:t}})),gt=nt(\"SUBSCRIPTION_RESTORED\",(function(e,t,n,r){return{channels:e,groups:t,cursor:{timetoken:n,region:null!=r?r:0}}})),mt=nt(\"HANDSHAKE_SUCCESS\",(function(e){return e})),bt=nt(\"HANDSHAKE_FAILURE\",(function(e){return e})),vt=nt(\"HANDSHAKE_RECONNECT_SUCCESS\",(function(e){return{cursor:e}})),_t=nt(\"HANDSHAKE_RECONNECT_FAILURE\",(function(e){return e})),St=nt(\"HANDSHAKE_RECONNECT_GIVEUP\",(function(e){return e})),wt=nt(\"RECEIVE_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Ot=nt(\"RECEIVE_FAILURE\",(function(e){return e})),Pt=nt(\"RECEIVE_RECONNECT_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Et=nt(\"RECEIVE_RECONNECT_FAILURE\",(function(e){return e})),At=nt(\"RECEIVING_RECONNECT_GIVEUP\",(function(e){return e})),Tt=nt(\"DISCONNECT\",(function(){return{}})),Nt=nt(\"RECONNECT\",(function(e,t){return{cursor:{timetoken:null!=e?e:\"\",region:null!=t?t:0}}})),Ct=nt(\"UNSUBSCRIBE_ALL\",(function(){return{}})),kt=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(ct.type,ut((function(e,r,a){var u=a.handshake,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:r.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:l.filterExpression},l.maintainPresenceState&&{state:c}))];case 2:return o=i.sent(),[2,t.transition(mt(o))];case 3:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(bt(s))]:[3,4];case 4:return[2]}}))}))}))),s.on(lt.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:u.filterExpression})];case 2:return r=i.sent(),t.transition(wt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q&&!n.aborted?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),s.on(pt.type,ut((function(e,t,n){var r=n.emitMessages;return o(s,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&r(e),[2]}))}))}))),s.on(ht.type,ut((function(e,t,n){var r=n.emitStatus;return o(s,void 0,void 0,(function(){return i(this,(function(t){return r(e),[2]}))}))}))),s.on(ft.type,ut((function(e,n,r){var a=r.receiveMessages,u=r.delay,c=r.config;return o(s,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return c.retryConfiguration&&c.retryConfiguration.shouldRetry(e.reason,e.attempts)?(n.throwIfAborted(),[4,u(c.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,a({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region,filterExpression:c.filterExpression})];case 3:return r=i.sent(),[2,t.transition(Pt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Et(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(At(new q(c.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s.on(dt.type,ut((function(e,r,a){var u=a.handshake,c=a.delay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({abortSignal:r,channels:e.channels,channelGroups:e.groups,filterExpression:p.filterExpression},p.maintainPresenceState&&{state:l}))];case 3:return o=i.sent(),[2,t.transition(vt(o))];case 4:return(s=i.sent())instanceof Error&&\"Aborted\"===s.message?[2]:s instanceof q?[2,t.transition(_t(s))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(St(new q(p.retryConfiguration.getGiveupReason(e.reason,e.attempts))))];case 7:return[2]}}))}))}))),s}return t(r,e),r}(tt),Mt=new Ze(\"HANDSHAKE_FAILED\");Mt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Mt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor||e.cursor})})),Mt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region?t.payload.cursor.region:null!==(r=null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)&&void 0!==r?r:0}})})),Mt.on(Ct.type,(function(e){return Lt.with()}));var jt=new Ze(\"HANDSHAKE_STOPPED\");jt.on(yt.type,(function(e,t){return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),jt.on(Nt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor||e.cursor}))})),jt.on(gt.type,(function(e,t){var n;return jt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),jt.on(Ct.type,(function(e){return Lt.with()}));var Rt=new Ze(\"RECEIVE_FAILED\");Rt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Rt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Rt.on(Ct.type,(function(e){return Lt.with(void 0)}));var xt=new Ze(\"RECEIVE_STOPPED\");xt.on(yt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),xt.on(gt.type,(function(e,t){return xt.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Nt.type,(function(e,t){var n;return Ft.with({channels:e.channels,groups:e.groups,cursor:{timetoken:t.payload.cursor.timetoken?null===(n=t.payload.cursor)||void 0===n?void 0:n.timetoken:e.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),xt.on(Ct.type,(function(){return Lt.with(void 0)}));var Ut=new Ze(\"RECEIVE_RECONNECTING\");Ut.onEnter((function(e){return ft(e)})),Ut.onExit((function(){return ft.cancel})),Ut.on(Pt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),Ut.on(Et.type,(function(e,t){return Ut.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ut.on(At.type,(function(e,t){var n;return Rt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNDisconnectedUnexpectedlyCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Ut.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),Ut.on(gt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),Ut.on(yt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var It=new Ze(\"RECEIVING\");It.onEnter((function(e){return lt(e.channels,e.groups,e.cursor)})),It.onExit((function(){return lt.cancel})),It.on(wt.type,(function(e,t){return It.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[pt(t.payload.events)])})),It.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({cursor:e.cursor,channels:t.payload.channels,groups:t.payload.groups})})),It.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||e.cursor.region}})})),It.on(Ot.type,(function(e,t){return Ut.with(n(n({},e),{attempts:0,reason:t.payload}))})),It.on(Tt.type,(function(e){return xt.with({channels:e.channels,groups:e.groups,cursor:e.cursor},[ht({category:k.PNDisconnectedCategory})])})),It.on(Ct.type,(function(e){return Lt.with(void 0,[ht({category:k.PNDisconnectedCategory})])}));var Dt=new Ze(\"HANDSHAKE_RECONNECTING\");Dt.onEnter((function(e){return dt(e)})),Dt.onExit((function(){return dt.cancel})),Dt.on(vt.type,(function(e,t){var n,r,o={timetoken:(null===(n=e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=e.cursor)||void 0===r?void 0:r.timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region};return It.with({channels:e.channels,groups:e.groups,cursor:o},[ht({category:k.PNConnectedCategory})])})),Dt.on(_t.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(St.type,(function(e,t){var n;return Mt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:t.payload},[ht({category:k.PNConnectionErrorCategory,error:null===(n=t.payload)||void 0===n?void 0:n.message})])})),Dt.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Dt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Dt.on(gt.type,(function(e,t){var n,r;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:(null===(n=t.payload.cursor)||void 0===n?void 0:n.region)||(null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.region)||0}})})),Dt.on(Ct.type,(function(e){return Lt.with(void 0)}));var Ft=new Ze(\"HANDSHAKING\");Ft.onEnter((function(e){return ct(e.channels,e.groups)})),Ft.onExit((function(){return ct.cancel})),Ft.on(yt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ft.on(mt.type,(function(e,t){var n,r;return It.with({channels:e.channels,groups:e.groups,cursor:{timetoken:(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.timetoken)?null===(r=null==e?void 0:e.cursor)||void 0===r?void 0:r.timetoken:t.payload.timetoken,region:t.payload.region}},[ht({category:k.PNConnectedCategory})])})),Ft.on(bt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:e.cursor,attempts:0,reason:t.payload})})),Ft.on(Tt.type,(function(e){return jt.with({channels:e.channels,groups:e.groups,cursor:e.cursor})})),Ft.on(gt.type,(function(e,t){var n;return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:{timetoken:t.payload.cursor.timetoken,region:t.payload.cursor.region||(null===(n=null==e?void 0:e.cursor)||void 0===n?void 0:n.region)||0}})})),Ft.on(Ct.type,(function(e){return Lt.with()}));var Lt=new Ze(\"UNSUBSCRIBED\");Lt.on(yt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(gt.type,(function(e,t){return Ft.with({channels:t.payload.channels,groups:t.payload.groups,cursor:t.payload.cursor})}));var Gt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dependencies=e,this.dispatcher=new kt(this.engine,e),this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Lt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=this,n=e.channels,r=e.channelGroups,o=e.timetoken,i=e.withPresence;this.channels=u(u([],a(this.channels),!1),a(null!=n?n:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=r?r:[]),!1),i&&(this.channels.map((function(e){return t.channels.push(\"\".concat(e,\"-pnpres\"))})),this.groups.map((function(e){return t.groups.push(\"\".concat(e,\"-pnpres\"))}))),o?this.engine.transition(gt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))),o)):this.engine.transition(yt(Array.from(new Set(u(u([],a(this.channels),!1),a(null!=n?n:[]),!1))),Array.from(new Set(u(u([],a(this.groups),!1),a(null!=r?r:[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter((function(e){return!e.endsWith(\"-pnpres\")})))),groups:Array.from(new Set(this.groups.filter((function(e){return!e.endsWith(\"-pnpres\")}))))})},e.prototype.unsubscribe=function(e){var t=this,n=e.channels,r=void 0===n?[]:n,o=e.channelGroups,i=void 0===o?[]:o,s=H.removeSingleOccurance(this.channels,u(u([],a(r),!1),a(r.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1)),c=H.removeSingleOccurance(this.groups,u(u([],a(i),!1),a(i.map((function(e){return\"\".concat(e,\"-pnpres\")}))),!1));if(new Set(this.channels).size!==new Set(s).size||new Set(this.groups).size!==new Set(c).size){var l=H.findUniqueCommonElements(this.channels,r),p=H.findUniqueCommonElements(this.groups,i);this.dependencies.presenceState&&(null==l||l.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==p||p.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.channels=s,this.groups=c,this.engine.transition(yt(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:l.slice(0),groups:p.slice(0)})}},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(yt(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.reconnect=function(e){var t=e.timetoken,n=e.region;this.engine.transition(Nt(t,n))},e.prototype.disconnect=function(){this.engine.transition(Tt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},e.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},e.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},e.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),Kt=nt(\"RECONNECT\",(function(){return{}})),Bt=nt(\"DISCONNECT\",(function(){return{}})),Ht=nt(\"JOINED\",(function(e,t){return{channels:e,groups:t}})),qt=nt(\"LEFT\",(function(e,t){return{channels:e,groups:t}})),zt=nt(\"LEFT_ALL\",(function(){return{}})),Vt=nt(\"HEARTBEAT_SUCCESS\",(function(e){return{statusCode:e}})),Wt=nt(\"HEARTBEAT_FAILURE\",(function(e){return e})),Jt=nt(\"HEARTBEAT_GIVEUP\",(function(){return{}})),$t=nt(\"TIMES_UP\",(function(){return{}})),Qt=rt(\"HEARTBEAT\",(function(e,t){return{channels:e,groups:t}})),Xt=rt(\"LEAVE\",(function(e,t){return{channels:e,groups:t}})),Yt=rt(\"EMIT_STATUS\",(function(e){return e})),Zt=ot(\"WAIT\",(function(){return{}})),en=ot(\"DELAYED_HEARTBEAT\",(function(e){return e})),tn=function(e){function r(t,r){var s=e.call(this,r)||this;return s.on(Qt.type,ut((function(e,r,a){var u=a.heartbeat,c=a.presenceState,l=a.config;return o(s,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,u(n({channels:e.channels,channelGroups:e.groups},l.maintainPresenceState&&{state:c}))];case 1:return o.sent(),t.transition(Vt(200)),[3,3];case 2:return(r=o.sent())instanceof q?[2,t.transition(Wt(r))]:[3,3];case 3:return[2]}}))}))}))),s.on(Xt.type,ut((function(e,t,n){var r=n.leave,a=n.config;return o(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(a.suppressLeaveEvents)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r({channels:e.channels,channelGroups:e.groups})];case 2:case 3:return t.sent(),[3,4];case 4:return[2]}}))}))}))),s.on(Zt.type,ut((function(e,n,r){var a=r.heartbeatDelay;return o(s,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return n.throwIfAborted(),[4,a()];case 1:return e.sent(),n.throwIfAborted(),[2,t.transition($t())]}}))}))}))),s.on(en.type,ut((function(e,r,a){var u=a.heartbeat,c=a.retryDelay,l=a.presenceState,p=a.config;return o(s,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return p.retryConfiguration&&p.retryConfiguration.shouldRetry(e.reason,e.attempts)?(r.throwIfAborted(),[4,c(p.retryConfiguration.getDelay(e.attempts,e.reason))]):[3,6];case 1:i.sent(),r.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,u(n({channels:e.channels,channelGroups:e.groups},p.maintainPresenceState&&{state:l}))];case 3:return i.sent(),[2,t.transition(Vt(200))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Wt(o))]:[3,5];case 5:return[3,7];case 6:return[2,t.transition(Jt())];case 7:return[2]}}))}))}))),s.on(Yt.type,ut((function(e,t,r){var a=r.emitStatus,u=r.config;return o(s,void 0,void 0,(function(){var t;return i(this,(function(r){return u.announceFailedHeartbeats&&!0===(null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.error)?a(e.status):u.announceSuccessfulHeartbeats&&200===e.statusCode&&a(n(n({},e),{operation:j.PNHeartbeatOperation,error:!1})),[2]}))}))}))),s}return t(r,e),r}(tt),nn=new Ze(\"HEARTBEAT_STOPPED\");nn.on(Ht.type,(function(e,t){return nn.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),nn.on(qt.type,(function(e,t){return nn.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))})})),nn.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),nn.on(zt.type,(function(e,t){return un.with(void 0)}));var rn=new Ze(\"HEARTBEAT_COOLDOWN\");rn.onEnter((function(){return Zt()})),rn.onExit((function(){return Zt.cancel})),rn.on($t.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),rn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),rn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),rn.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),rn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var on=new Ze(\"HEARTBEAT_FAILED\");on.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),on.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),on.on(Kt.type,(function(e,t){return an.with({channels:e.channels,groups:e.groups})})),on.on(Bt.type,(function(e,t){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),on.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var sn=new Ze(\"HEARBEAT_RECONNECTING\");sn.onEnter((function(e){return en(e)})),sn.onExit((function(){return en.cancel})),sn.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),sn.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),sn.on(Bt.type,(function(e,t){nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),sn.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),sn.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),sn.on(Jt.type,(function(e,t){return on.with({channels:e.channels,groups:e.groups})})),sn.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var an=new Ze(\"HEARTBEATING\");an.onEnter((function(e){return Qt(e.channels,e.groups)})),an.on(Vt.type,(function(e,t){return rn.with({channels:e.channels,groups:e.groups})})),an.on(Ht.type,(function(e,t){return an.with({channels:u(u([],a(e.channels),!1),a(t.payload.channels),!1),groups:u(u([],a(e.groups),!1),a(t.payload.groups),!1)})})),an.on(qt.type,(function(e,t){return an.with({channels:e.channels.filter((function(e){return!t.payload.channels.includes(e)})),groups:e.groups.filter((function(e){return!t.payload.groups.includes(e)}))},[Xt(t.payload.channels,t.payload.groups)])})),an.on(Wt.type,(function(e,t){return sn.with(n(n({},e),{attempts:0,reason:t.payload}))})),an.on(Bt.type,(function(e){return nn.with({channels:e.channels,groups:e.groups},[Xt(e.channels,e.groups)])})),an.on(zt.type,(function(e,t){return un.with(void 0,[Xt(e.channels,e.groups)])}));var un=new Ze(\"HEARTBEAT_INACTIVE\");un.on(Ht.type,(function(e,t){return an.with({channels:t.payload.channels,groups:t.payload.groups})}));var cn=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new tn(this.engine,e),this.dependencies=e,this._unsubscribeEngine=this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(un,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.join=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],a(this.channels),!1),a(null!=t?t:[]),!1),this.groups=u(u([],a(this.groups),!1),a(null!=n?n:[]),!1),this.engine.transition(Ht(this.channels.slice(0),this.groups.slice(0)))},e.prototype.leave=function(e){var t=this,n=e.channels,r=e.groups;this.dependencies.presenceState&&(null==n||n.forEach((function(e){return delete t.dependencies.presenceState[e]})),null==r||r.forEach((function(e){return delete t.dependencies.presenceState[e]}))),this.engine.transition(qt(null!=n?n:[],null!=r?r:[]))},e.prototype.leaveAll=function(){this.engine.transition(zt())},e.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},e}(),ln=function(){function e(){}return e.LinearRetryPolicy=function(e){return{delay:e.delay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:this.delay)+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e.ExponentialRetryPolicy=function(e){return{minimumDelay:e.minimumDelay,maximumDelay:e.maximumDelay,maximumRetry:e.maximumRetry,shouldRetry:function(e,t){var n;return 403!==(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)&&this.maximumRetry>t},getDelay:function(e,t){var n;return 1e3*((null!==(n=t.retryAfter)&&void 0!==n?n:Math.min(Math.pow(2,e),this.maximumDelay))+Math.random())},getGiveupReason:function(e,t){var n;return this.maximumRetry<=t?\"retry attempts exhaused.\":403===(null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.statusCode)?\"forbidden operation.\":\"unknown error\"}}},e}(),pn=function(){function e(e){var t=e.modules,n=e.listenerManager,r=e.getFileUrl;this.modules=t,this.listenerManager=n,this.getFileUrl=r,this._channelListenerMap=new Map,this._groupListenerMap=new Map,t.cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.emitEvent=function(e){var t=e.channel,o=e.publishMetaData,i=e.subscriptionMatch;if(t===i&&(i=null),e.channel.endsWith(\"-pnpres\")){var s={channel:null,subscription:null};t&&(s.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(s.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=o.timetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announcePresence(s),this._announce(\"presence\",s,s.channel,s.subscription)}else if(1===e.messageType){(s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=e.payload,this.listenerManager.announceSignal(s),this._announce(\"signal\",s,s.channel,s.subscription)}else if(2===e.messageType){if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),s.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},this.listenerManager.announceObjects(s),this._announce(\"objects\",s,s.channel,s.subscription),\"uuid\"===e.payload.type){var a=this._renameChannelField(s),u=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"user\"})});this.listenerManager.announceUser(u),this._announce(\"user\",u,s.channel,s.subscription)}else if(\"channel\"===e.payload.type){a=this._renameChannelField(s);var c=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),type:\"space\"})});this.listenerManager.announceSpace(c),this._announce(\"space\",c,s.channel,s.subscription)}else if(\"membership\"===e.payload.type){var l=(a=this._renameChannelField(s)).message.data,p=l.uuid,h=l.channel,f=r(l,[\"uuid\",\"channel\"]);f.user=p,f.space=h;var d=n(n({},a),{message:n(n({},a.message),{event:this._renameEvent(a.message.event),data:f})});this.listenerManager.announceMembership(d),this._announce(\"membership\",d,s.channel,s.subscription)}}else if(3===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,s.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},s.event=e.payload.event,this.listenerManager.announceMessageAction(s),this._announce(\"messageAction\",s,s.channel,s.subscription)}else if(4===e.messageType){(s={}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId;var y=e.payload;if(this.modules.cryptoModule){var g=void 0;try{g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}null!==g&&(y=g)}e.userMetadata&&(s.userMetadata=e.userMetadata),s.message=y.message,s.file={id:y.file.id,name:y.file.name,url:this.getFileUrl({id:y.file.id,name:y.file.name,channel:t})},this.listenerManager.announceFile(s),this._announce(\"file\",s,s.channel,s.subscription)}else{if((s={channel:null,subscription:null}).channel=t,s.subscription=i,s.timetoken=o.timetoken,s.publisher=e.issuingClientId,e.userMetadata&&(s.userMetadata=e.userMetadata),this.modules.cryptoModule){g=void 0;try{var m;g=(m=this.modules.cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(m)):m}catch(e){g=null,s.error=\"Error while decrypting message content: \".concat(e.message)}s.message=null!=g?g:e.payload}else s.message=e.payload;s.actualChannel=null!=i?t:null,s.subscribedChannel=null!=i?i:t,this.listenerManager.announceMessage(s),this._announce(\"message\",s,s.channel,s.subscription)}},e.prototype.addListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){r._channelListenerMap[t]?r._channelListenerMap[t].includes(e)||r._channelListenerMap[t].push(e):r._channelListenerMap[t]=[e]})),null==n||n.forEach((function(t){r._groupListenerMap[t]?r._groupListenerMap[t].includes(e)||r._groupListenerMap[t].push(e):r._groupListenerMap[t]=[e]}))):this.listenerManager.addListener(e)},e.prototype.removeListener=function(e,t,n){var r=this;t&&n?(null==t||t.forEach((function(t){var n;r._channelListenerMap[t]=null===(n=r._channelListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))})),null==n||n.forEach((function(t){var n;r._groupListenerMap[t]=null===(n=r._groupListenerMap[t])||void 0===n?void 0:n.filter((function(t){return t!==e}))}))):this.listenerManager.removeListener(e)},e.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e.prototype._announce=function(e,t,n,r){var o,i;null===(o=this._channelListenerMap[n])||void 0===o||o.forEach((function(n){return n[e]&&n[e](t)})),null===(i=this._groupListenerMap[r])||void 0===i||i.forEach((function(n){return n[e]&&n[e](t)}))},e}(),hn=function(){function e(){}return e.prototype.subscribe=function(){var e,t;this.pubnub.subscribe(n({channels:this.channelNames,channelGroups:this.groupNames},(null===(t=null===(e=this.options)||void 0===e?void 0:e.cursor)||void 0===t?void 0:t.timetoken)&&{timetoken:this.options.cursor.timetoken}))},e.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),channelGroups:this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))})},Object.defineProperty(e.prototype,\"onMessage\",{set:function(e){this.listener.message=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onPresence\",{set:function(e){this.listener.presence=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onSignal\",{set:function(e){this.listener.signal=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onObjects\",{set:function(e){this.listener.objects=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onMessageAction\",{set:function(e){this.listener.messageAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"onFile\",{set:function(e){this.listener.file=e},enumerable:!1,configurable:!0}),e.prototype.addListener=function(e){this.eventEmitter.addListener(e,this.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),this.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")})))},e.prototype.removeListener=function(e){this.eventEmitter.removeListener(e,this.channelNames,this.groupNames)},Object.defineProperty(e.prototype,\"channels\",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"channelGroups\",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),e}(),fn=function(e){function n(t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,s=t.subscriptionOptions,c=t.eventEmitter,l=t.pubnub,p=e.call(this)||this;return p.channelNames=[],p.groupNames=[],p.subscriptionList=[],p.options=s,p.eventEmitter=c,p.pubnub=l,r.forEach((function(e){var t=p.pubnub.channel(e).subscription(p.options);p.channelNames=u(u([],a(p.channelNames),!1),a(t.channels),!1),p.subscriptionList.push(t)})),i.forEach((function(e){var t=p.pubnub.channelGroup(e).subscription(p.options);p.groupNames=u(u([],a(p.groupNames),!1),a(t.channelGroups),!1),p.subscriptionList.push(t)})),p.listener={},c.addListener(p.listener,p.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),p.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),p}return t(n,e),n.prototype.addSubscription=function(e){this.subscriptionList.push(e),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscription=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return t!==e}))},n.prototype.addSubscriptionSet=function(e){this.subscriptionList=u(u([],a(this.subscriptionList),!1),a(e.subscriptions),!1),this.channelNames=u(u([],a(this.channelNames),!1),a(e.channels),!1),this.groupNames=u(u([],a(this.groupNames),!1),a(e.channelGroups),!1)},n.prototype.removeSubscriptionSet=function(e){var t=e.channels,n=e.channelGroups;this.channelNames=this.channelNames.filter((function(e){return!t.includes(e)})),this.groupNames=this.groupNames.filter((function(e){return!n.includes(e)})),this.subscriptionList=this.subscriptionList.filter((function(t){return!e.subscriptions.includes(t)}))},Object.defineProperty(n.prototype,\"subscriptions\",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),n}(hn),dn=function(e){function r(t){var n=t.channels,r=t.channelGroups,o=t.subscriptionOptions,i=t.eventEmitter,s=t.pubnub,a=e.call(this)||this;return a.channelNames=[],a.groupNames=[],a.channelNames=n,a.groupNames=r,a.options=o,a.pubnub=s,a.eventEmitter=i,a.listener={},i.addListener(a.listener,a.channelNames.filter((function(e){return!e.endsWith(\"-pnpres\")})),a.groupNames.filter((function(e){return!e.endsWith(\"-pnpres\")}))),a}return t(r,e),r.prototype.addSubscription=function(e){return new fn({channels:u(u([],a(this.channelNames),!1),a(e.channels),!1),channelGroups:u(u([],a(this.groupNames),!1),a(e.channelGroups),!1),subscriptionOptions:n(n({},this.options),null==e?void 0:e.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},r}(hn),yn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),gn=function(){function e(e,t,n){this.name=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[],channelGroups:(null==e?void 0:e.receivePresenceEvents)?[this.name,\"\".concat(this.name,\"-pnpres\")]:[this.name],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),mn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),bn=function(){function e(e,t,n){this.id=e,this.eventEmitter=t,this.pubnub=n}return e.prototype.subscription=function(e){return new dn({channels:[this.id],channelGroups:[],subscriptionOptions:e,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},e}(),vn=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var c=new T({config:i}),l=e.cryptography;r.init(i);var p=new G(i,o);this._tokenManager=p;var h=new R({maximumSamplesCount:6e4});this._telemetryManager=h;var f=this._config.cryptoModule,d={config:i,networking:r,crypto:c,cryptography:l,tokenManager:p,telemetryManager:h,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.encryptFile(t,this.File)):l.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&d.cryptoModule?(t=e,d.cryptoModule.decryptFile(t,this.File)):l.decryptFile(e,t,this.File)};var y=Q.bind(this,d,Je),m=Q.bind(this,d,se),v=Q.bind(this,d,ue),_=Q.bind(this,d,le),S=Q.bind(this,d,$e),w=new L;if(this._listenerManager=w,this.iAmHere=Q.bind(this,d,ue),this.iAmAway=Q.bind(this,d,se),this.setPresenceState=Q.bind(this,d,le),this.handshake=Q.bind(this,d,Qe),this.receiveMessages=Q.bind(this,d,Xe),this._eventEmitter=new pn({modules:d,listenerManager:this._listenerManager,getFileUrl:function(e){return ve(d,e)}}),!0===i.enableEventEngine){if(i.maintainPresenceState&&(this.presenceState={},this.setState=function(e){var n,r;return null===(n=e.channels)||void 0===n||n.forEach((function(n){return t.presenceState[n]=e.state})),null===(r=e.channelGroups)||void 0===r||r.forEach((function(n){return t.presenceState[n]=e.state})),t.setPresenceState({channels:e.channels,channelGroups:e.channelGroups,state:t.presenceState})}),i.getHeartbeatInterval()){var O=new cn({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise((function(e){return setTimeout(e,1e3*d.config.getHeartbeatInterval())}))},retryDelay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},config:d.config,presenceState:this.presenceState,emitStatus:function(e){w.announceStatus(e)}});this.presenceEventEngine=O,this.join=this.presenceEventEngine.join.bind(O),this.leave=this.presenceEventEngine.leave.bind(O),this.leaveAll=this.presenceEventEngine.leaveAll.bind(O)}var P=new Gt({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:d.config,emitMessages:function(e){var n,r;try{for(var o=s(e),i=o.next();!i.done;i=o.next()){var a=i.value;t._eventEmitter.emitEvent(a)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},emitStatus:function(e){w.announceStatus(e)}});this.subscribe=P.subscribe.bind(P),this.unsubscribe=P.unsubscribe.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.reconnect=P.reconnect.bind(P),this.disconnect=P.disconnect.bind(P),this.destroy=P.dispose.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.eventEngine=P}else{var E=new M({timeEndpoint:y,leaveEndpoint:m,heartbeatEndpoint:v,setStateEndpoint:_,subscribeEndpoint:S,crypto:d.crypto,config:d.config,listenerManager:w,getFileUrl:function(e){return ve(d,e)},cryptoModule:d.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=E.adaptSubscribeChange.bind(E),this.unsubscribe=E.adaptUnsubscribeChange.bind(E),this.disconnect=E.disconnect.bind(E),this.reconnect=E.reconnect.bind(E),this.unsubscribeAll=E.unsubscribeAll.bind(E),this.getSubscribedChannels=E.getSubscribedChannels.bind(E),this.getSubscribedChannelGroups=E.getSubscribedChannelGroups.bind(E),this.setState=E.adaptStateChange.bind(E),this.presence=E.adaptPresenceChange.bind(E),this.destroy=function(e){E.unsubscribeAll(e),E.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=p.parseToken.bind(p),this.setToken=p.setToken.bind(p),this.getToken=p.getToken.bind(p),this.channelGroups={listGroups:Q.bind(this,d,ee),listChannels:Q.bind(this,d,te),addChannels:Q.bind(this,d,X),removeChannels:Q.bind(this,d,Y),deleteGroup:Q.bind(this,d,Z)},this.push={addChannels:Q.bind(this,d,ne),removeChannels:Q.bind(this,d,re),deleteDevice:Q.bind(this,d,ie),listChannels:Q.bind(this,d,oe)},this.hereNow=Q.bind(this,d,pe),this.whereNow=Q.bind(this,d,ae),this.getState=Q.bind(this,d,ce),this.grant=Q.bind(this,d,Ue),this.grantToken=Q.bind(this,d,Le),this.audit=Q.bind(this,d,xe),this.revokeToken=Q.bind(this,d,Ge),this.publish=Q.bind(this,d,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,d,He),this.history=Q.bind(this,d,qe),this.deleteMessages=Q.bind(this,d,ze),this.messageCounts=Q.bind(this,d,Ve),this.fetchMessages=Q.bind(this,d,We),this.addMessageAction=Q.bind(this,d,he),this.removeMessageAction=Q.bind(this,d,fe),this.getMessageActions=Q.bind(this,d,de),this.listFiles=Q.bind(this,d,ye);var A=Q.bind(this,d,ge);this.publishFile=Q.bind(this,d,me),this.sendFile=be({generateUploadUrl:A,publishFile:this.publishFile,modules:d}),this.getFileUrl=function(e){return ve(d,e)},this.downloadFile=Q.bind(this,d,_e),this.deleteFile=Q.bind(this,d,Se),this.channel=function(e){return new yn(e,t._eventEmitter,t)},this.channelGroup=function(e){return new gn(e,t._eventEmitter,t)},this.channelMetadata=function(e){return new mn(e,t._eventEmitter,t)},this.userMetadata=function(e){return new bn(e,t._eventEmitter,t)},this.subscriptionSet=function(e){return new fn({channels:e.channels,channelGroups:e.channelGroups,subscriptionOptions:e.subscriptionOptions,eventEmitter:t._eventEmitter,pubnub:t})},this.objects={getAllUUIDMetadata:Q.bind(this,d,we),getUUIDMetadata:Q.bind(this,d,Oe),setUUIDMetadata:Q.bind(this,d,Pe),removeUUIDMetadata:Q.bind(this,d,Ee),getAllChannelMetadata:Q.bind(this,d,Ae),getChannelMetadata:Q.bind(this,d,Te),setChannelMetadata:Q.bind(this,d,Ne),removeChannelMetadata:Q.bind(this,d,Ce),getChannelMembers:Q.bind(this,d,ke),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"set\"},e)],a(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Me,n({type:\"delete\"},e)],a(r),!1))},getMemberships:Q.bind(this,d,je),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"set\"},e)],a(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,d,Re,n({type:\"delete\"},e)],a(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,statusField:e.include.statusField,UUIDStatusField:e.include.userStatusField,UUIDTypeField:e.include.userTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,statusField:e.include.statusField,channelStatusField:e.include.spaceStatusField,channelTypeField:e.include.spaceTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=a(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=y,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&d.cryptoModule){var n=d.cryptoModule.encrypt(e);return\"string\"==typeof n?n:b(n)}return c.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=d.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return c.decrypt(e,t)},this.getAuthKey=d.config.getAuthKey.bind(d.config),this.setAuthKey=d.config.setAuthKey.bind(d.config),this.getUUID=d.config.getUUID.bind(d.config),this.setUUID=d.config.setUUID.bind(d.config),this.getUserId=d.config.getUserId.bind(d.config),this.setUserId=d.config.setUserId.bind(d.config),this.getFilterExpression=d.config.getFilterExpression.bind(d.config),this.setFilterExpression=d.config.setFilterExpression.bind(d.config),this.setCipherKey=function(t){return d.config.setCipherKey(t,e,d)},this.setHeartbeatInterval=d.config.setHeartbeatInterval.bind(d.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){d.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new F(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=j,e.CATEGORIES=k,e.LinearRetryPolicy=ln.LinearRetryPolicy,e.ExponentialRetryPolicy=ln.ExponentialRetryPolicy,e}(),_n=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return k.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return k.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return k.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return k.PNNetworkIssuesCategory;if(e.timeout)return k.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return k.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return k.PNBadRequestCategory;if(e.response.forbidden)return k.PNAccessDeniedCategory}return k.PNUnknownCategory},e}();function Sn(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,s=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(s)?Sn(s):s})),n}var wn=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),On={exports:{}},Pn={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Pn);var En=Mn;Mn.default=Mn,Mn.stable=Un,Mn.stableStringify=Un;var An=\"[...]\",Tn=\"[Circular]\",Nn=[],Cn=[];function kn(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Mn(e,t,n,r){var o;void 0===r&&(r=kn()),Rn(e,\"\",0,[],void 0,0,r);try{o=0===Cn.length?JSON.stringify(e,t,n):JSON.stringify(e,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var i=Nn.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function jn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Nn.push([r,n,t,o])):Cn.push([t,n,e]):(r[n]=e,Nn.push([r,n,t]))}function Rn(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)Rn(e[a],a,a,r,e,i,s);else{var u=Object.keys(e);for(a=0;a<u.length;a++){var c=u[a];Rn(e[c],c,a,r,e,i,s)}}r.pop()}}function xn(e,t){return e<t?-1:e>t?1:0}function Un(e,t,n,r){void 0===r&&(r=kn());var o,i=In(e,\"\",0,[],void 0,0,r)||e;try{o=0===Cn.length?JSON.stringify(i,t,n):JSON.stringify(i,Dn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Nn.length;){var s=Nn.pop();4===s.length?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function In(e,t,n,r,o,i,s){var a;if(i+=1,\"object\"==typeof e&&null!==e){for(a=0;a<r.length;a++)if(r[a]===e)return void jn(Tn,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==s.depthLimit&&i>s.depthLimit)return void jn(An,e,t,o);if(void 0!==s.edgesLimit&&n+1>s.edgesLimit)return void jn(An,e,t,o);if(r.push(e),Array.isArray(e))for(a=0;a<e.length;a++)In(e[a],a,a,r,e,i,s);else{var u={},c=Object.keys(e).sort(xn);for(a=0;a<c.length;a++){var l=c[a];In(e[l],l,a,r,e,i,s),u[l]=e[l]}if(void 0===o)return u;Nn.push([o,t,e]),o[t]=u}r.pop()}}function Dn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Cn.length>0)for(var r=0;r<Cn.length;r++){var o=Cn[r];if(o[1]===t&&o[0]===n){n=o[2],Cn.splice(r,1);break}}return e.call(this,t,n)}}var Fn,Ln=\"undefined\"!=typeof Symbol&&Symbol,Gn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},Kn=\"Function.prototype.bind called on incompatible \",Bn=Array.prototype.slice,Hn=Object.prototype.toString,qn=\"[object Function]\",zn=function(e){var t=this;if(\"function\"!=typeof t||Hn.call(t)!==qn)throw new TypeError(Kn+t);for(var n,r=Bn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(Bn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(Bn.call(arguments)))},i=Math.max(0,t.length-r.length),s=[],a=0;a<i;a++)s.push(\"$\"+a);if(n=Function(\"binder\",\"return function (\"+s.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},Vn=Function.prototype.bind||zn,Wn=Vn.call(Function.call,Object.prototype.hasOwnProperty),Jn=SyntaxError,$n=Function,Qn=TypeError,Xn=function(e){try{return $n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Yn=Object.getOwnPropertyDescriptor;if(Yn)try{Yn({},\"\")}catch(e){Yn=null}var Zn=function(){throw new Qn},er=Yn?function(){try{return Zn}catch(e){try{return Yn(arguments,\"callee\").get}catch(e){return Zn}}}():Zn,tr=\"function\"==typeof Ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof Ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&Gn(),nr=Object.getPrototypeOf||function(e){return e.__proto__},rr={},or=\"undefined\"==typeof Uint8Array?Fn:nr(Uint8Array),ir={\"%AggregateError%\":\"undefined\"==typeof AggregateError?Fn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?Fn:ArrayBuffer,\"%ArrayIteratorPrototype%\":tr?nr([][Symbol.iterator]()):Fn,\"%AsyncFromSyncIteratorPrototype%\":Fn,\"%AsyncFunction%\":rr,\"%AsyncGenerator%\":rr,\"%AsyncGeneratorFunction%\":rr,\"%AsyncIteratorPrototype%\":rr,\"%Atomics%\":\"undefined\"==typeof Atomics?Fn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?Fn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?Fn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?Fn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?Fn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?Fn:FinalizationRegistry,\"%Function%\":$n,\"%GeneratorFunction%\":rr,\"%Int8Array%\":\"undefined\"==typeof Int8Array?Fn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?Fn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?Fn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":tr?nr(nr([][Symbol.iterator]())):Fn,\"%JSON%\":\"object\"==typeof JSON?JSON:Fn,\"%Map%\":\"undefined\"==typeof Map?Fn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&tr?nr((new Map)[Symbol.iterator]()):Fn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?Fn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?Fn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?Fn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?Fn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&tr?nr((new Set)[Symbol.iterator]()):Fn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?Fn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":tr?nr(\"\"[Symbol.iterator]()):Fn,\"%Symbol%\":tr?Symbol:Fn,\"%SyntaxError%\":Jn,\"%ThrowTypeError%\":er,\"%TypedArray%\":or,\"%TypeError%\":Qn,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?Fn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?Fn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?Fn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?Fn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?Fn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?Fn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?Fn:WeakSet},sr=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Xn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Xn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Xn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=nr(o.prototype))}return ir[t]=n,n},ar={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},ur=Vn,cr=Wn,lr=ur.call(Function.call,Array.prototype.concat),pr=ur.call(Function.apply,Array.prototype.splice),hr=ur.call(Function.call,String.prototype.replace),fr=ur.call(Function.call,String.prototype.slice),dr=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,yr=/\\\\(\\\\)?/g,gr=function(e){var t=fr(e,0,1),n=fr(e,-1);if(\"%\"===t&&\"%\"!==n)throw new Jn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new Jn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return hr(e,dr,(function(e,t,n,o){r[r.length]=n?hr(o,yr,\"$1\"):t||e})),r},mr=function(e,t){var n,r=e;if(cr(ar,r)&&(r=\"%\"+(n=ar[r])[0]+\"%\"),cr(ir,r)){var o=ir[r];if(o===rr&&(o=sr(r)),void 0===o&&!t)throw new Qn(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new Jn(\"intrinsic \"+e+\" does not exist!\")},br=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new Qn(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new Qn('\"allowMissing\" argument must be a boolean');var n=gr(e),r=n.length>0?n[0]:\"\",o=mr(\"%\"+r+\"%\",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],pr(n,lr([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],h=fr(p,0,1),f=fr(p,-1);if(('\"'===h||\"'\"===h||\"`\"===h||'\"'===f||\"'\"===f||\"`\"===f)&&h!==f)throw new Jn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(a=!0),cr(ir,i=\"%\"+(r+=\".\"+p)+\"%\"))s=ir[i];else if(null!=s){if(!(p in s)){if(!t)throw new Qn(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Yn&&c+1>=n.length){var d=Yn(s,p);s=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:s[p]}else l=cr(s,p),s=s[p];l&&!a&&(ir[i]=s)}}return s},vr={exports:{}};!function(e){var t=Vn,n=br,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),s=n(\"%Object.getOwnPropertyDescriptor%\",!0),a=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(a)try{a({},\"a\",{value:1})}catch(e){a=null}e.exports=function(e){var n=i(t,o,arguments);if(s&&a){var r=s(n,\"length\");r.configurable&&a(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};a?a(e.exports,\"apply\",{value:c}):e.exports.apply=c}(vr);var _r=br,Sr=vr.exports,wr=Sr(_r(\"String.prototype.indexOf\")),Or=l(Object.freeze({__proto__:null,default:{}})),Pr=\"function\"==typeof Map&&Map.prototype,Er=Object.getOwnPropertyDescriptor&&Pr?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Ar=Pr&&Er&&\"function\"==typeof Er.get?Er.get:null,Tr=Pr&&Map.prototype.forEach,Nr=\"function\"==typeof Set&&Set.prototype,Cr=Object.getOwnPropertyDescriptor&&Nr?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,kr=Nr&&Cr&&\"function\"==typeof Cr.get?Cr.get:null,Mr=Nr&&Set.prototype.forEach,jr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,xr=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Ur=Boolean.prototype.valueOf,Ir=Object.prototype.toString,Dr=Function.prototype.toString,Fr=String.prototype.match,Lr=String.prototype.slice,Gr=String.prototype.replace,Kr=String.prototype.toUpperCase,Br=String.prototype.toLowerCase,Hr=RegExp.prototype.test,qr=Array.prototype.concat,zr=Array.prototype.join,Vr=Array.prototype.slice,Wr=Math.floor,Jr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,$r=Object.getOwnPropertySymbols,Qr=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Xr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Yr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xr||\"symbol\")?Symbol.toStringTag:null,Zr=Object.prototype.propertyIsEnumerable,eo=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function to(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||Hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-Wr(-e):Wr(e);if(r!==e){var o=String(r),i=Lr.call(t,o.length+1);return Gr.call(o,n,\"$&_\")+\".\"+Gr.call(Gr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return Gr.call(t,n,\"$&_\")}var no=Or,ro=no.custom,oo=co(ro)?ro:null;function io(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function so(e){return Gr.call(String(e),/\"/g,\"&quot;\")}function ao(e){return!(\"[object Array]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function uo(e){return!(\"[object RegExp]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}function co(e){if(Xr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Qr)return!1;try{return Qr.call(e),!0}catch(e){}return!1}var lo=Object.prototype.hasOwnProperty||function(e){return e in this};function po(e,t){return lo.call(e,t)}function ho(e){return Ir.call(e)}function fo(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function yo(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return yo(Lr.call(e,0,t.maxStringLength),t)+r}return io(Gr.call(Gr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,go),\"single\",t)}function go(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+Kr.call(t.toString(16))}function mo(e){return\"Object(\"+e+\")\"}function bo(e){return e+\" { ? }\"}function vo(e,t,n,r){return e+\" (\"+t+\") {\"+(r?_o(n,r):zr.call(n,\", \"))+\"}\"}function _o(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+zr.call(e,\",\"+n)+\"\\n\"+t.prev}function So(e,t){var n=ao(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=po(e,o)?t(e[o],e):\"\"}var i,s=\"function\"==typeof $r?$r(e):[];if(Xr){i={};for(var a=0;a<s.length;a++)i[\"$\"+s[a]]=s[a]}for(var u in e)po(e,u)&&(n&&String(Number(u))===u&&u<e.length||Xr&&i[\"$\"+u]instanceof Symbol||(Hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof $r)for(var c=0;c<s.length;c++)Zr.call(e,s[c])&&r.push(\"[\"+t(s[c])+\"]: \"+t(e[s[c]],e));return r}var wo=br,Oo=function(e,t){var n=_r(e,!!t);return\"function\"==typeof n&&wr(e,\".prototype.\")>-1?Sr(n):n},Po=function e(t,n,r,o){var i=n||{};if(po(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(po(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var s=!po(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof s&&\"symbol\"!==s)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(po(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(po(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var a=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return yo(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return a?to(t,u):u}if(\"bigint\"==typeof t){var l=String(t)+\"n\";return a?to(t,l):l}var p=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=p&&p>0&&\"object\"==typeof t)return ao(t)?\"[Array]\":\"[Object]\";var h=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=zr.call(Array(e.indent+1),\" \")}return{base:n,prev:zr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(fo(o,t)>=0)return\"[Circular]\";function f(t,n,s){if(n&&(o=Vr.call(o)).push(n),s){var a={depth:i.depth};return po(i,\"quoteStyle\")&&(a.quoteStyle=i.quoteStyle),e(t,a,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!uo(t)){var d=function(e){if(e.name)return e.name;var t=Fr.call(Dr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),y=So(t,f);return\"[Function\"+(d?\": \"+d:\" (anonymous)\")+\"]\"+(y.length>0?\" { \"+zr.call(y,\", \")+\" }\":\"\")}if(co(t)){var g=Xr?Gr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Qr.call(t);return\"object\"!=typeof t||Xr?g:mo(g)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var m=\"<\"+Br.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)m+=\" \"+b[v].name+\"=\"+io(so(b[v].value),\"double\",i);return m+=\">\",t.childNodes&&t.childNodes.length&&(m+=\"...\"),m+=\"</\"+Br.call(String(t.nodeName))+\">\"}if(ao(t)){if(0===t.length)return\"[]\";var _=So(t,f);return h&&!function(e){for(var t=0;t<e.length;t++)if(fo(e[t],\"\\n\")>=0)return!1;return!0}(_)?\"[\"+_o(_,h)+\"]\":\"[ \"+zr.call(_,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)){var S=So(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Zr.call(t,\"cause\")?0===S.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+zr.call(S,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+zr.call(qr.call(\"[cause]: \"+f(t.cause),S),\", \")+\" }\"}if(\"object\"==typeof t&&s){if(oo&&\"function\"==typeof t[oo]&&no)return no(t,{depth:p-r});if(\"symbol\"!==s&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Ar||!e||\"object\"!=typeof e)return!1;try{Ar.call(e);try{kr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var w=[];return Tr&&Tr.call(t,(function(e,n){w.push(f(n,t,!0)+\" => \"+f(e,t))})),vo(\"Map\",Ar.call(t),w,h)}if(function(e){if(!kr||!e||\"object\"!=typeof e)return!1;try{kr.call(e);try{Ar.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var O=[];return Mr&&Mr.call(t,(function(e){O.push(f(e,t))})),vo(\"Set\",kr.call(t),O,h)}if(function(e){if(!jr||!e||\"object\"!=typeof e)return!1;try{jr.call(e,jr);try{Rr.call(e,Rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return bo(\"WeakMap\");if(function(e){if(!Rr||!e||\"object\"!=typeof e)return!1;try{Rr.call(e,Rr);try{jr.call(e,jr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return bo(\"WeakSet\");if(function(e){if(!xr||!e||\"object\"!=typeof e)return!1;try{return xr.call(e),!0}catch(e){}return!1}(t))return bo(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!Jr)return!1;try{return Jr.call(e),!0}catch(e){}return!1}(t))return mo(f(Jr.call(t)));if(function(e){return!(\"[object Boolean]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(Ur.call(t));if(function(e){return!(\"[object String]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t))return mo(f(String(t)));if(\"undefined\"!=typeof window&&t===window)return\"{ [object Window] }\";if(t===c)return\"{ [object globalThis] }\";if(!function(e){return!(\"[object Date]\"!==ho(e)||Yr&&\"object\"==typeof e&&Yr in e)}(t)&&!uo(t)){var P=So(t,f),E=eo?eo(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?\"\":\"null prototype\",T=!E&&Yr&&Object(t)===t&&Yr in t?Lr.call(ho(t),8,-1):A?\"Object\":\"\",N=(E||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||A?\"[\"+zr.call(qr.call([],T||[],A||[]),\": \")+\"] \":\"\");return 0===P.length?N+\"{}\":h?N+\"{\"+_o(P,h)+\"}\":N+\"{ \"+zr.call(P,\", \")+\" }\"}return String(t)},Eo=wo(\"%TypeError%\"),Ao=wo(\"%WeakMap%\",!0),To=wo(\"%Map%\",!0),No=Oo(\"WeakMap.prototype.get\",!0),Co=Oo(\"WeakMap.prototype.set\",!0),ko=Oo(\"WeakMap.prototype.has\",!0),Mo=Oo(\"Map.prototype.get\",!0),jo=Oo(\"Map.prototype.set\",!0),Ro=Oo(\"Map.prototype.has\",!0),xo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},Uo=String.prototype.replace,Io=/%20/g,Do=\"RFC3986\",Fo={default:Do,formatters:{RFC1738:function(e){return Uo.call(e,Io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:Do},Lo=Fo,Go=Object.prototype.hasOwnProperty,Ko=Array.isArray,Bo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),Ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},qo={arrayToObject:Ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],s=Object.keys(i),a=0;a<s.length;++a){var u=s[a],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(Ko(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var s=\"\",a=0;a<i.length;++a){var u=i.charCodeAt(a);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===Lo.RFC1738&&(40===u||41===u)?s+=i.charAt(a):u<128?s+=Bo[u]:u<2048?s+=Bo[192|u>>6]+Bo[128|63&u]:u<55296||u>=57344?s+=Bo[224|u>>12]+Bo[128|u>>6&63]+Bo[128|63&u]:(a+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(a)),s+=Bo[240|u>>18]+Bo[128|u>>12&63]+Bo[128|u>>6&63]+Bo[128|63&u])}return s},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Ko(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(Ko(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!Go.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return Ko(t)&&!Ko(n)&&(o=Ho(t,r)),Ko(t)&&Ko(n)?(n.forEach((function(n,o){if(Go.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return Go.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},zo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new Eo(\"Side channel does not contain \"+Po(e))},get:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return No(e,r)}else if(To){if(t)return Mo(t,r)}else if(n)return function(e,t){var n=xo(e,t);return n&&n.value}(n,r)},has:function(r){if(Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return ko(e,r)}else if(To){if(t)return Ro(t,r)}else if(n)return function(e,t){return!!xo(e,t)}(n,r);return!1},set:function(r,o){Ao&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Ao),Co(e,r,o)):To?(t||(t=new To),jo(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=xo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},Vo=qo,Wo=Fo,Jo=Object.prototype.hasOwnProperty,$o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Qo=Array.isArray,Xo=Array.prototype.push,Yo=function(e,t){Xo.apply(e,Qo(t)?t:[t])},Zo=Date.prototype.toISOString,ei=Wo.default,ti={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:Vo.encode,encodeValuesOnly:!1,format:ei,formatter:Wo.formatters[ei],indices:!1,serializeDate:function(e){return Zo.call(e)},skipNulls:!1,strictNullHandling:!1},ni={},ri=function e(t,n,r,o,i,s,a,u,c,l,p,h,f,d,y,g){for(var m,b=t,v=g,_=0,S=!1;void 0!==(v=v.get(ni))&&!S;){var w=v.get(t);if(_+=1,void 0!==w){if(w===_)throw new RangeError(\"Cyclic object value\");S=!0}void 0===v.get(ni)&&(_=0)}if(\"function\"==typeof u?b=u(n,b):b instanceof Date?b=p(b):\"comma\"===r&&Qo(b)&&(b=Vo.maybeMap(b,(function(e){return e instanceof Date?p(e):e}))),null===b){if(i)return a&&!d?a(n,ti.encoder,y,\"key\",h):n;b=\"\"}if(\"string\"==typeof(m=b)||\"number\"==typeof m||\"boolean\"==typeof m||\"symbol\"==typeof m||\"bigint\"==typeof m||Vo.isBuffer(b))return a?[f(d?n:a(n,ti.encoder,y,\"key\",h))+\"=\"+f(a(b,ti.encoder,y,\"value\",h))]:[f(n)+\"=\"+f(String(b))];var O,P=[];if(void 0===b)return P;if(\"comma\"===r&&Qo(b))d&&a&&(b=Vo.maybeMap(b,a)),O=[{value:b.length>0?b.join(\",\")||null:void 0}];else if(Qo(u))O=u;else{var E=Object.keys(b);O=c?E.sort(c):E}for(var A=o&&Qo(b)&&1===b.length?n+\"[]\":n,T=0;T<O.length;++T){var N=O[T],C=\"object\"==typeof N&&void 0!==N.value?N.value:b[N];if(!s||null!==C){var k=Qo(b)?\"function\"==typeof r?r(A,N):A:A+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var M=zo();M.set(ni,g),Yo(P,e(C,k,r,o,i,s,\"comma\"===r&&d&&Qo(b)?null:a,u,c,l,p,h,f,d,y,M))}}return P},oi=qo,ii=Object.prototype.hasOwnProperty,si=Array.isArray,ai={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:oi.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ui=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},ci=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},li=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,s=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),a=s?o.slice(0,s.index):o,u=[];if(a){if(!n.plainObjects&&ii.call(Object.prototype,a)&&!n.allowPrototypes)return;u.push(a)}for(var c=0;n.depth>0&&null!==(s=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&ii.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(s[1])}return s&&u.push(\"[\"+o.slice(s.index)+\"]\"),function(e,t,n,r){for(var o=r?t:ci(t,n),i=e.length-1;i>=0;--i){var s,a=e[i];if(\"[]\"===a&&n.parseArrays)s=[].concat(o);else{s=n.plainObjects?Object.create(null):{};var u=\"[\"===a.charAt(0)&&\"]\"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&a!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(s=[])[c]=o:\"__proto__\"!==u&&(s[u]=o):s={0:o}}o=s}return o}(u,t,n,r)}},pi=function(e,t){var n,r=e,o=function(e){if(!e)return ti;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||ti.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=Wo.default;if(void 0!==e.format){if(!Jo.call(Wo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=Wo.formatters[n],o=ti.filter;return(\"function\"==typeof e.filter||Qo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:ti.addQueryPrefix,allowDots:void 0===e.allowDots?ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ti.charsetSentinel,delimiter:void 0===e.delimiter?ti.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:ti.encode,encoder:\"function\"==typeof e.encoder?e.encoder:ti.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:ti.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:ti.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:ti.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ti.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Qo(o.filter)&&(n=o.filter);var i,s=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in $o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var a=$o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===a&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=zo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Yo(s,ri(r[p],p,a,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var h=s.join(o.delimiter),f=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?f+=\"utf8=%26%2310003%3B&\":f+=\"utf8=%E2%9C%93&\"),h.length>0?f+h:\"\"},hi={formats:Fo,parse:function(e,t){var n=function(e){if(!e)return ai;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?ai.charset:e.charset;return{allowDots:void 0===e.allowDots?ai.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:ai.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:ai.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:ai.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:ai.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:ai.comma,decoder:\"function\"==typeof e.decoder?e.decoder:ai.decoder,delimiter:\"string\"==typeof e.delimiter||oi.isRegExp(e.delimiter)?e.delimiter:ai.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:ai.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:ai.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:ai.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:ai.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:ai.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,s=o.split(t.delimiter,i),a=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<s.length;++n)0===s[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===s[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===s[n]&&(u=\"iso-8859-1\"),a=n,n=s.length);for(n=0;n<s.length;++n)if(n!==a){var c,l,p=s[n],h=p.indexOf(\"]=\"),f=-1===h?p.indexOf(\"=\"):h+1;-1===f?(c=t.decoder(p,ai.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,f),ai.decoder,u,\"key\"),l=oi.maybeMap(ci(p.slice(f+1),t),(function(e){return t.decoder(e,ai.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=ui(l)),p.indexOf(\"[]=\")>-1&&(l=si(l)?[l]:l),ii.call(r,c)?r[c]=oi.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),s=0;s<i.length;++s){var a=i[s],u=li(a,r[a],n,\"string\"==typeof e);o=oi.merge(o,u,n)}return!0===n.allowSparse?o:oi.compact(o)},stringify:pi},fi={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(fi);const di=Or,yi=fi.isObject,gi=fi.hasOwn;var mi=bi;function bi(){}bi.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},bi.prototype.parse=function(e){return this._parser=e,this},bi.prototype.responseType=function(e){return this._responseType=e,this},bi.prototype.serialize=function(e){return this._serializer=e,this},bi.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(gi(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},bi.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const vi=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),_i=new Set([408,413,429,500,502,503,504,521,522,524]);bi.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&_i.has(t.status))return!0;if(e){if(e.code&&vi.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},bi.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},bi.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},bi.prototype.catch=function(e){return this.then(void 0,e)},bi.prototype.use=function(e){return e(this),this},bi.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},bi.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},bi.prototype.get=function(e){return this._header[e.toLowerCase()]},bi.prototype.getHeader=bi.prototype.get,bi.prototype.set=function(e,t){if(yi(e)){for(const t in e)gi(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},bi.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},bi.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(yi(e)){for(const t in e)gi(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)gi(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},bi.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(di.gte(process.version,\"v13.0.0\")&&di.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},bi.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},bi.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},bi.prototype.redirects=function(e){return this._maxRedirects=e,this},bi.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},bi.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},bi.prototype.send=function(e){const t=yi(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&yi(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");gi(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},bi.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},bi.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},bi.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},bi.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},bi.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Si=fi;var wi=Oi;function Oi(){}function Pi(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ai(){this._defaults=[]}Oi.prototype.get=function(e){return this.header[e.toLowerCase()]},Oi.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Si.type(t);const n=Si.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Si.parseLinks(e.link))}catch(e){}},Oi.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Ti=0,Ni=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Ti<Ni.length;Ti++){const e=Ni[Ti];Ai.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Ai.prototype._setDefaults=function(e){var t,n=Pi(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Ci=Ai;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Pn.exports,s=En,a=hi,u=mi,c=fi.isObject,l=fi.mixin,p=fi.hasOwn,h=wi,f=Ci;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=w,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function m(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&b(t,n,e[n]);return t.join(\"&\")}function b(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){b(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&b(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function v(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function S(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,s;for(let e=0,a=t.length;e<a;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),s=g(o.slice(r+1)),n[i]=s);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function w(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new S(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=m,y.parseString=v,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":a.stringify,\"application/json\":s},y.parse={\"application/x-www-form-urlencoded\":v,\"application/json\":JSON.parse},l(S.prototype,h.prototype),S.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},S.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=S,i(w.prototype),l(w.prototype,u.prototype),w.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},w.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},w.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},w.prototype.query=function(e){return\"string\"!=typeof e&&(e=m(e)),e&&this._query.push(e),this},w.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},w.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},w.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},w.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},w.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},w.prototype.ca=w.prototype.agent,w.prototype.buffer=w.prototype.ca,w.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},w.prototype.pipe=w.prototype.write,w.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},w.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},w.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},w.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new f;for(var O=0,P=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];O<P.length;O++){const e=P[O];f.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}f.prototype.del=f.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(On,On.exports);var ki=On.exports;function Mi(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ji(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(Mi)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:k.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,s={};if(s.error=null!==e,s.operation=t.operation,o&&o.status&&(s.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{s.errorData=JSON.parse(e.response.text)}catch(t){s.errorData=e}else s.errorData=e;return s.category=r._detectErrorCategory(e),n(s,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return s.errorData=o,s.error=!0,n(s,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(s.errorData=i,s.statusCode=i.status,s.error=!0,s.category=r._detectErrorCategory(s),n(s,null)):(i.error&&i.error.message&&(s.errorData=i.error),n(s,i))})),o}function Ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ki.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function xi(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ui(e,t,n){var r=ki.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Ii(e,t,n,r){var o=ki.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Di(e,t,n,r){var o=ki.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ji.call(this,o,n,r)}function Fi(e,t,n){var r=ki.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ji.call(this,r,t,n)}function Li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var Gi,Ki=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:s})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,s;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return s=i.sent(),[2,n.create({name:t.name,data:s})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=Li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return s=i.sent(),a=Li(r.buffer,s),[2,e.decoder.decode(a)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),s=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,s)];case 1:return a=i.sent(),[2,e.decoder.decode(a)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Bi=(Gi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),Gi.supportsFile=\"undefined\"!=typeof File,Gi.supportsBlob=\"undefined\"!=typeof Blob,Gi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,Gi.supportsBuffer=!1,Gi.supportsStream=!1,Gi.supportsString=!0,Gi.supportsEncryptFile=!0,Gi.supportsFileUri=!1,Gi),Hi=function(){function e(e){this.config=e,this.cryptor=new T({config:e}),this.fileCryptor=new Ki}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:b(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),qi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:m(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),zi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new qi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new qi({cipherKey:e.cipherKey}),cryptors:[new Hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],a(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?m(e):e,n=Vi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===Vi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,s,a,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=Vi.tryParse(r),(null==(s=this.getCryptor(o))?void 0:s.identifier)===e.LEGACY_IDENTIFIER?[2,s.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return a=i.sent(),u=a.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof Wi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=Vi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),Vi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new Wi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var s=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return s=n[i],i+=1,255===s&&n.byteLength>=i+2&&(s=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new Wi(this.decoder.decode(o),s)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),Wi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return Vi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return Vi.SENTINEL.length+1+Vi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(Vi.SENTINEL)),t[e+=Vi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=Vi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function Ji(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var $i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new _n({del:Fi,get:Ui,post:Ii,patch:Di,sendBeacon:Ji,getfile:xi,postfile:Ri}),t.cbor=new wn((function(e){return Sn(h.decode(e))}),m),t.PubNubFile=Bi,t.cryptography=new Ki,t.initCryptoModule=function(e){return new zi({default:new Hi({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new qi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=zi,n}(vn);return $i}));",
          "",
          "---------------"
        ],
        "lib/core/components/config.js||lib/core/components/config.js": [
          "File: lib/core/components/config.js -> lib/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:         return this;",
          "181:     };",
          "182:     default_1.prototype.getVersion = function () {",
          "184:     };",
          "185:     default_1.prototype._setRetryConfiguration = function (configuration) {",
          "186:         if (configuration.minimumdelay < 2) {",
          "",
          "[Removed Lines]",
          "183:         return '7.6.1';",
          "",
          "[Added Lines]",
          "183:         return '7.6.2';",
          "",
          "---------------"
        ],
        "lib/core/endpoints/push/list_push_channels.js||lib/core/endpoints/push/list_push_channels.js": [
          "File: lib/core/endpoints/push/list_push_channels.js -> lib/core/endpoints/push/list_push_channels.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: }",
          "54: exports.isAuthSupported = isAuthSupported;",
          "55: function prepareParams(modules, incomingParams) {",
          "57:     var parameters = { type: pushGateway };",
          "58:     if (pushGateway === 'apns2') {",
          "59:         parameters = __assign(__assign({}, parameters), { environment: environment, topic: topic });",
          "60:         delete parameters.type;",
          "61:     }",
          "62:     return parameters;",
          "63: }",
          "64: exports.prepareParams = prepareParams;",
          "",
          "[Removed Lines]",
          "56:     var pushGateway = incomingParams.pushGateway, _a = incomingParams.environment, environment = _a === void 0 ? 'development' : _a, topic = incomingParams.topic;",
          "",
          "[Added Lines]",
          "56:     var pushGateway = incomingParams.pushGateway, _a = incomingParams.environment, environment = _a === void 0 ? 'development' : _a, topic = incomingParams.topic, start = incomingParams.start, count = incomingParams.count;",
          "62:     if (start)",
          "63:         parameters.start = start;",
          "64:     if (count && count > 0)",
          "65:         parameters.count = count;",
          "",
          "---------------"
        ],
        "src/core/components/config.js||src/core/components/config.js": [
          "File: src/core/components/config.js -> src/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "358:   }",
          "360:   getVersion() {",
          "362:   }",
          "364:   _setRetryConfiguration(configuration) {",
          "",
          "[Removed Lines]",
          "361:     return '7.6.1';",
          "",
          "[Added Lines]",
          "361:     return '7.6.2';",
          "",
          "---------------"
        ],
        "src/core/endpoints/push/list_push_channels.js||src/core/endpoints/push/list_push_channels.js": [
          "File: src/core/endpoints/push/list_push_channels.js -> src/core/endpoints/push/list_push_channels.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: }",
          "37: export function prepareParams(modules, incomingParams) {",
          "39:   let parameters = { type: pushGateway };",
          "41:   if (pushGateway === 'apns2') {",
          "",
          "[Removed Lines]",
          "38:   const { pushGateway, environment = 'development', topic } = incomingParams;",
          "",
          "[Added Lines]",
          "38:   const { pushGateway, environment = 'development', topic, start, count } = incomingParams;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "43:     delete parameters.type;",
          "44:   }",
          "46:   return parameters;",
          "47: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "46:   if (start) parameters.start = start;",
          "47:   if (count && count > 0) parameters.count = count;",
          "",
          "---------------"
        ],
        "test/integration/endpoints/push.test.js||test/integration/endpoints/push.test.js": [
          "File: test/integration/endpoints/push.test.js -> test/integration/endpoints/push.test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "395:       );",
          "396:     });",
          "398:     it('should add push disable for channels API telemetry information', (done) => {",
          "399:       let scope = utils.createNock().get('/v1/push/sub-key/mySubKey/devices/niceDevice').query(true);",
          "400:       const delays = [100, 200, 300, 400];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "398:     it('supports channel listing with start and count params', async () => {",
          "399:       const scope = utils",
          "400:         .createNock()",
          "401:         .get('/v1/push/sub-key/mySubKey/devices/coolDevice')",
          "402:         .query({",
          "403:           pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "404:           type: 'apns',",
          "405:           uuid: 'myUUID',",
          "406:           start: 'ch1',",
          "407:           count: 10,",
          "408:         })",
          "409:         .reply(200, '[\"ch1\", \"ch2\", \"ch3\"]');",
          "411:       var res = await pubnub.push.listChannels(",
          "412:         { device: 'coolDevice', pushGateway: 'apns', start: 'ch1', count: 10 },",
          "413:         (status, response) => {",
          "414:           assert.equal(status.error, false);",
          "415:           assert.deepEqual(response.channels, ['ch1', 'ch2', 'ch3']);",
          "416:           assert.equal(scope.isDone(), true);",
          "417:           done();",
          "418:         },",
          "419:       );",
          "420:     });",
          "422:     it('supports channel listing with(APNS2) start and count params', async () => {",
          "423:       const scope = utils",
          "424:         .createNock()",
          "425:         .get('/v2/push/sub-key/mySubKey/devices-apns2/coolDevice')",
          "426:         .query({",
          "427:           pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "428:           environment: 'production',",
          "429:           topic: 'com.test.apns',",
          "430:           uuid: 'myUUID',",
          "431:           start: 'ch1',",
          "432:           count: 10,",
          "433:         })",
          "434:         .reply(200, '[\"ch1\", \"ch2\", \"ch3\"]');",
          "435:       pubnub.push.listChannels(",
          "436:         {",
          "437:           device: 'coolDevice',",
          "438:           pushGateway: 'apns2',",
          "439:           environment: 'production',",
          "440:           topic: 'com.test.apns',",
          "441:           start: 'ch1',",
          "442:           count: 10,",
          "443:         },",
          "444:         (status, response) => {",
          "445:           assert.equal(status.error, false);",
          "446:           assert.deepEqual(response.channels, ['ch1', 'ch2', 'ch3']);",
          "447:           assert.equal(scope.isDone(), true);",
          "448:           done();",
          "449:         },",
          "450:       );",
          "451:     });",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "76bc5046d3f07fdaa6a4170e9a1f555059462757",
      "candidate_info": {
        "commit_hash": "76bc5046d3f07fdaa6a4170e9a1f555059462757",
        "repo": "pubnub/javascript",
        "commit_url": "https://github.com/pubnub/javascript/commit/76bc5046d3f07fdaa6a4170e9a1f555059462757",
        "files": [
          ".pubnub.yml",
          "CHANGELOG.md",
          "README.md",
          "dist/web/pubnub.js",
          "dist/web/pubnub.min.js",
          "lib/core/components/config.js",
          "lib/core/components/subscription_manager.js",
          "lib/core/endpoints/fetch_messages.js",
          "lib/core/endpoints/history/get_history.js",
          "lib/core/endpoints/objects/member/get.js",
          "lib/core/endpoints/objects/membership/get.js",
          "lib/core/pubnub-common.js",
          "package-lock.json",
          "package.json",
          "src/core/components/config.js",
          "src/core/components/subscription_manager.js",
          "src/core/endpoints/fetch_messages.js",
          "src/core/endpoints/history/get_history.js",
          "src/core/endpoints/objects/member/get.js",
          "src/core/endpoints/objects/membership/get.js",
          "src/core/pubnub-common.js",
          "test/integration/components/subscription_manager.test.js",
          "test/integration/endpoints/fetch_messages.test.js",
          "test/integration/endpoints/history.test.js"
        ],
        "message": "fix: crash unencrypted message with crypto module (#349)\n\n* subscription listener and history api handle plain message when crypto module is configured\n\n* test: subscription listener and history api with plain message along with crypto module\n\n* dist/lib\n\n* fix: AppContext membership apis optional fields only included when explicitly mentioned\n\n* lib/dist files\n\n* PubNub SDK v7.4.5 release.\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>",
        "before_after_code_files": [
          "dist/web/pubnub.js||dist/web/pubnub.js",
          "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
          "lib/core/components/config.js||lib/core/components/config.js",
          "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js",
          "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js",
          "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js",
          "lib/core/endpoints/objects/member/get.js||lib/core/endpoints/objects/member/get.js",
          "lib/core/endpoints/objects/membership/get.js||lib/core/endpoints/objects/membership/get.js",
          "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
          "src/core/components/config.js||src/core/components/config.js",
          "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js",
          "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js",
          "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js",
          "src/core/endpoints/objects/member/get.js||src/core/endpoints/objects/member/get.js",
          "src/core/endpoints/objects/membership/get.js||src/core/endpoints/objects/membership/get.js",
          "src/core/pubnub-common.js||src/core/pubnub-common.js",
          "test/integration/components/subscription_manager.test.js||test/integration/components/subscription_manager.test.js",
          "test/integration/endpoints/fetch_messages.test.js||test/integration/endpoints/fetch_messages.test.js",
          "test/integration/endpoints/history.test.js||test/integration/endpoints/history.test.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js",
            "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js",
            "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js",
            "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
            "src/core/components/config.js||src/core/components/config.js",
            "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js",
            "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js",
            "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js",
            "src/core/pubnub-common.js||src/core/pubnub-common.js"
          ],
          "candidate": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js",
            "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js",
            "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js",
            "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
            "src/core/components/config.js||src/core/components/config.js",
            "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js",
            "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js",
            "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js",
            "src/core/pubnub-common.js||src/core/pubnub-common.js"
          ]
        }
      },
      "candidate_diff": {
        "dist/web/pubnub.js||dist/web/pubnub.js": [
          "File: dist/web/pubnub.js -> dist/web/pubnub.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "791:             return this;",
          "792:         };",
          "793:         default_1.prototype.getVersion = function () {",
          "795:         };",
          "796:         default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "797:             this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "794:             return '7.4.4';",
          "",
          "[Added Lines]",
          "794:             return '7.4.5';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2354:                         }",
          "2355:                         catch (e) {",
          "2356:                             decryptedPayload = null;",
          "2360:                         }",
          "2361:                         if (decryptedPayload !== null) {",
          "2362:                             msgPayload = decryptedPayload;",
          "",
          "[Removed Lines]",
          "2357:                             if (console && console.log) {",
          "2358:                                 console.log('decryption error', e.message);",
          "2359:                             }",
          "",
          "[Added Lines]",
          "2357:                             announce.error = \"Error while decrypting message content: \".concat(e.message);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2401:                         }",
          "2402:                         catch (e) {",
          "2403:                             decryptedPayload = null;",
          "2408:                         }",
          "2409:                         if (decryptedPayload != null) {",
          "2410:                             announce.message = decryptedPayload;",
          "",
          "[Removed Lines]",
          "2405:                             if (console && console.log) {",
          "2406:                                 console.log('decryption error', e.message); //eslint-disable-line",
          "2407:                             }",
          "",
          "[Added Lines]",
          "2402:                             announce.error = \"Error while decrypting message content: \".concat(e.message);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5371:         getOperation: function () { return OPERATIONS.PNGetMembersOperation; },",
          "5372:         validateParams: function (_, params) {",
          "5373:             if (!(params === null || params === void 0 ? void 0 : params.channel)) {",
          "5375:             }",
          "5376:         },",
          "5377:         getURL: function (_a, params) {",
          "",
          "[Removed Lines]",
          "5374:                 return 'UUID cannot be empty';",
          "",
          "[Added Lines]",
          "5369:                 return 'channel cannot be empty';",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "5384:         },",
          "5385:         isAuthSupported: function () { return true; },",
          "5386:         prepareParams: function (_modules, params) {",
          "5388:             var queryParams = {};",
          "5390:             if (params === null || params === void 0 ? void 0 : params.include) {",
          "5392:                     queryParams.include.push('custom');",
          "5393:                 }",
          "5395:                     queryParams.include.push('uuid.custom');",
          "5396:                 }",
          "5399:                 }",
          "5400:             }",
          "5401:             queryParams.include = queryParams.include.join(',');",
          "5404:             }",
          "5407:             }",
          "5410:             }",
          "5411:             if (params === null || params === void 0 ? void 0 : params.filter) {",
          "5412:                 queryParams.filter = params.filter;",
          "5413:             }",
          "5415:             if (params === null || params === void 0 ? void 0 : params.sort) {",
          "5417:                     var _b = __read(_a, 2), key = _b[0], value = _b[1];",
          "5418:                     if (value === 'asc' || value === 'desc') {",
          "5419:                         return \"\".concat(key, \":\").concat(value);",
          "",
          "[Removed Lines]",
          "5387:             var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;",
          "5389:             queryParams.include = ['uuid.status', 'uuid.type', 'status'];",
          "5391:                 if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.customFields) {",
          "5394:                 if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customUUIDFields) {",
          "5397:                 if ((_d = (_c = params.include) === null || _c === void 0 ? void 0 : _c.UUIDFields) !== null && _d !== void 0 ? _d : true) {",
          "5398:                     queryParams.include.push('uuid');",
          "5402:             if ((_e = params === null || params === void 0 ? void 0 : params.include) === null || _e === void 0 ? void 0 : _e.totalCount) {",
          "5403:                 queryParams.count = (_f = params.include) === null || _f === void 0 ? void 0 : _f.totalCount;",
          "5405:             if ((_g = params === null || params === void 0 ? void 0 : params.page) === null || _g === void 0 ? void 0 : _g.next) {",
          "5406:                 queryParams.start = (_h = params.page) === null || _h === void 0 ? void 0 : _h.next;",
          "5408:             if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.prev) {",
          "5409:                 queryParams.end = (_k = params.page) === null || _k === void 0 ? void 0 : _k.prev;",
          "5414:             queryParams.limit = (_l = params === null || params === void 0 ? void 0 : params.limit) !== null && _l !== void 0 ? _l : 100;",
          "5416:                 queryParams.sort = Object.entries((_m = params.sort) !== null && _m !== void 0 ? _m : {}).map(function (_a) {",
          "",
          "[Added Lines]",
          "5382:             var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;",
          "5384:             queryParams.include = [];",
          "5386:                 if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.statusField) {",
          "5387:                     queryParams.include.push('status');",
          "5388:                 }",
          "5389:                 if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customFields) {",
          "5392:                 if ((_c = params.include) === null || _c === void 0 ? void 0 : _c.UUIDFields) {",
          "5393:                     queryParams.include.push('uuid');",
          "5394:                 }",
          "5395:                 if ((_d = params.include) === null || _d === void 0 ? void 0 : _d.customUUIDFields) {",
          "5398:                 if ((_e = params.include) === null || _e === void 0 ? void 0 : _e.UUIDStatusField) {",
          "5399:                     queryParams.include.push('uuid.status');",
          "5400:                 }",
          "5401:                 if ((_f = params.include) === null || _f === void 0 ? void 0 : _f.UUIDTypeField) {",
          "5402:                     queryParams.include.push('uuid.type');",
          "5406:             if ((_g = params === null || params === void 0 ? void 0 : params.include) === null || _g === void 0 ? void 0 : _g.totalCount) {",
          "5407:                 queryParams.count = (_h = params.include) === null || _h === void 0 ? void 0 : _h.totalCount;",
          "5409:             if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.next) {",
          "5410:                 queryParams.start = (_k = params.page) === null || _k === void 0 ? void 0 : _k.next;",
          "5412:             if ((_l = params === null || params === void 0 ? void 0 : params.page) === null || _l === void 0 ? void 0 : _l.prev) {",
          "5413:                 queryParams.end = (_m = params.page) === null || _m === void 0 ? void 0 : _m.prev;",
          "5418:             queryParams.limit = (_o = params === null || params === void 0 ? void 0 : params.limit) !== null && _o !== void 0 ? _o : 100;",
          "5420:                 queryParams.sort = Object.entries((_p = params.sort) !== null && _p !== void 0 ? _p : {}).map(function (_a) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "5541:         },",
          "5542:         isAuthSupported: function () { return true; },",
          "5543:         prepareParams: function (_modules, params) {",
          "5545:             var queryParams = {};",
          "5547:             if (params === null || params === void 0 ? void 0 : params.include) {",
          "5550:                 }",
          "5553:                 }",
          "5554:                 if ((_c = params.include) === null || _c === void 0 ? void 0 : _c.channelFields) {",
          "5555:                     queryParams.include.push('channel');",
          "5556:                 }",
          "5557:             }",
          "5558:             queryParams.include = queryParams.include.join(',');",
          "5561:             }",
          "5564:             }",
          "5567:             }",
          "5568:             if (params === null || params === void 0 ? void 0 : params.filter) {",
          "5569:                 queryParams.filter = params.filter;",
          "5570:             }",
          "5572:             if (params === null || params === void 0 ? void 0 : params.sort) {",
          "5574:                     var _b = __read(_a, 2), key = _b[0], value = _b[1];",
          "5575:                     if (value === 'asc' || value === 'desc') {",
          "5576:                         return \"\".concat(key, \":\").concat(value);",
          "",
          "[Removed Lines]",
          "5544:             var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;",
          "5546:             queryParams.include = ['channel.status', 'channel.type', 'status'];",
          "5548:                 if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.customFields) {",
          "5549:                     queryParams.include.push('custom');",
          "5551:                 if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customChannelFields) {",
          "5552:                     queryParams.include.push('channel.custom');",
          "5559:             if ((_d = params === null || params === void 0 ? void 0 : params.include) === null || _d === void 0 ? void 0 : _d.totalCount) {",
          "5560:                 queryParams.count = (_e = params.include) === null || _e === void 0 ? void 0 : _e.totalCount;",
          "5562:             if ((_f = params === null || params === void 0 ? void 0 : params.page) === null || _f === void 0 ? void 0 : _f.next) {",
          "5563:                 queryParams.start = (_g = params.page) === null || _g === void 0 ? void 0 : _g.next;",
          "5565:             if ((_h = params === null || params === void 0 ? void 0 : params.page) === null || _h === void 0 ? void 0 : _h.prev) {",
          "5566:                 queryParams.end = (_j = params.page) === null || _j === void 0 ? void 0 : _j.prev;",
          "5571:             queryParams.limit = (_k = params === null || params === void 0 ? void 0 : params.limit) !== null && _k !== void 0 ? _k : 100;",
          "5573:                 queryParams.sort = Object.entries((_l = params.sort) !== null && _l !== void 0 ? _l : {}).map(function (_a) {",
          "",
          "[Added Lines]",
          "5548:             var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;",
          "5550:             queryParams.include = [];",
          "5552:                 if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.statusField) {",
          "5553:                     queryParams.include.push('status');",
          "5555:                 if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customFields) {",
          "5556:                     queryParams.include.push('custom');",
          "5561:                 if ((_d = params.include) === null || _d === void 0 ? void 0 : _d.customChannelFields) {",
          "5562:                     queryParams.include.push('channel.custom');",
          "5563:                 }",
          "5564:                 if ((_e = params.include) === null || _e === void 0 ? void 0 : _e.channelStatusField) {",
          "5565:                     queryParams.include.push('channel.status');",
          "5566:                 }",
          "5567:                 if ((_f = params.include) === null || _f === void 0 ? void 0 : _f.channelTypeField) {",
          "5568:                     queryParams.include.push('channel.type');",
          "5569:                 }",
          "5572:             if ((_g = params === null || params === void 0 ? void 0 : params.include) === null || _g === void 0 ? void 0 : _g.totalCount) {",
          "5573:                 queryParams.count = (_h = params.include) === null || _h === void 0 ? void 0 : _h.totalCount;",
          "5575:             if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.next) {",
          "5576:                 queryParams.start = (_k = params.page) === null || _k === void 0 ? void 0 : _k.next;",
          "5578:             if ((_l = params === null || params === void 0 ? void 0 : params.page) === null || _l === void 0 ? void 0 : _l.prev) {",
          "5579:                 queryParams.end = (_m = params.page) === null || _m === void 0 ? void 0 : _m.prev;",
          "5584:             queryParams.limit = (_o = params === null || params === void 0 ? void 0 : params.limit) !== null && _o !== void 0 ? _o : 100;",
          "5586:                 queryParams.sort = Object.entries((_p = params.sort) !== null && _p !== void 0 ? _p : {}).map(function (_a) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "6241:     function __processMessage$1(modules, message) {",
          "6244:         try {",
          "6245:             var decryptedData = modules.cryptoModule.decrypt(message);",
          "6246:             var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "6248:         }",
          "6249:         catch (e) {",
          "6251:                 console.log('decryption error', e.message);",
          "6253:         }",
          "6254:     }",
          "6255:     function getOperation$5() {",
          "6256:         return OPERATIONS.PNHistoryOperation;",
          "",
          "[Removed Lines]",
          "6242:         if (!modules.cryptoModule)",
          "6243:             return message;",
          "6247:             return decryptedPayload;",
          "6250:             if (console && console.log)",
          "6252:             return message;",
          "",
          "[Added Lines]",
          "6255:         var result = {};",
          "6256:         if (!modules.cryptoModule) {",
          "6257:             result.payload = message;",
          "6258:             return result;",
          "6259:         }",
          "6263:             result.payload = decryptedPayload;",
          "6264:             return result;",
          "6267:             if (modules.config.logVerbosity && console && console.log)",
          "6269:             result.payload = message;",
          "6270:             result.error = \"Error while decrypting message content: \".concat(e.message);",
          "6272:         return result;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "6301:         };",
          "6302:         if (Array.isArray(serverResponse[0])) {",
          "6303:             serverResponse[0].forEach(function (serverHistoryItem) {",
          "6304:                 var item = {",
          "6305:                     timetoken: serverHistoryItem.timetoken,",
          "6307:                 };",
          "6308:                 if (serverHistoryItem.meta) {",
          "6309:                     item.meta = serverHistoryItem.meta;",
          "6310:                 }",
          "6311:                 response.messages.push(item);",
          "6312:             });",
          "6313:         }",
          "",
          "[Removed Lines]",
          "6306:                     entry: __processMessage$1(modules, serverHistoryItem.message),",
          "",
          "[Added Lines]",
          "6323:                 var processedMessgeResult = __processMessage$1(modules, serverHistoryItem.message);",
          "6326:                     entry: processedMessgeResult.payload,",
          "6331:                 if (processedMessgeResult.error)",
          "6332:                     item.error = processedMessgeResult.error;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "6440:     function __processMessage(modules, message) {",
          "6443:         try {",
          "6444:             var decryptedData = modules.cryptoModule.decrypt(message);",
          "6445:             var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "6447:         }",
          "6448:         catch (e) {",
          "6450:                 console.log('decryption error', e.message);",
          "6452:         }",
          "6453:     }",
          "6454:     function getOperation$2() {",
          "6455:         return OPERATIONS.PNFetchMessagesOperation;",
          "",
          "[Removed Lines]",
          "6441:         if (!modules.cryptoModule)",
          "6442:             return message;",
          "6446:             return decryptedPayload;",
          "6449:             if (console && console.log)",
          "6451:             return message;",
          "",
          "[Added Lines]",
          "6463:         var result = {};",
          "6464:         if (!modules.cryptoModule) {",
          "6465:             result.payload = message;",
          "6466:             return result;",
          "6467:         }",
          "6471:             result.payload = decryptedPayload;",
          "6472:             return result;",
          "6475:             if (modules.config.logVerbosity && console && console.log)",
          "6477:             result.payload = message;",
          "6478:             result.error = \"Error while decrypting message content: \".concat(e.message);",
          "6480:         return result;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "6511:             response.channels[channelName] = [];",
          "6512:             (serverResponse.channels[channelName] || []).forEach(function (messageEnvelope) {",
          "6513:                 var announce = {};",
          "6514:                 announce.channel = channelName;",
          "6515:                 announce.timetoken = messageEnvelope.timetoken;",
          "6517:                 announce.messageType = messageEnvelope.message_type;",
          "6518:                 announce.uuid = messageEnvelope.uuid;",
          "6519:                 if (messageEnvelope.actions) {",
          "",
          "[Removed Lines]",
          "6516:                 announce.message = __processMessage(modules, messageEnvelope.message);",
          "",
          "[Added Lines]",
          "6542:                 var processedMessgeResult = __processMessage(modules, messageEnvelope.message);",
          "6545:                 announce.message = processedMessgeResult.payload;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "6524:                 if (messageEnvelope.meta) {",
          "6525:                     announce.meta = messageEnvelope.meta;",
          "6526:                 }",
          "6527:                 response.channels[channelName].push(announce);",
          "6528:             });",
          "6529:         });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6556:                 if (processedMessgeResult.error)",
          "6557:                     announce.error = processedMessgeResult.error;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "7770:                             customFields: params.include.customFields,",
          "7771:                             UUIDFields: params.include.userFields,",
          "7772:                             customUUIDFields: params.include.customUserFields,",
          "7773:                             totalCount: params.include.totalCount,",
          "7774:                         },",
          "7775:                         sort: params.sort != null",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7804:                             statusField: params.include.statusField,",
          "7805:                             UUIDStatusField: params.include.userStatusField,",
          "7806:                             UUIDTypeField: params.include.userTypeField,",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "7803:                             customFields: params.include.customFields,",
          "7804:                             channelFields: params.include.spaceFields,",
          "7805:                             customChannelFields: params.include.customSpaceFields,",
          "7806:                             totalCount: params.include.totalCount,",
          "7807:                         },",
          "7808:                         sort: params.sort != null",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7840:                             statusField: params.include.statusField,",
          "7841:                             channelStatusField: params.include.spaceStatusField,",
          "7842:                             channelTypeField: params.include.spaceTypeField,",
          "",
          "---------------"
        ],
        "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
          "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "12:     LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR",
          "13:     OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR",
          "14:     PERFORMANCE OF THIS SOFTWARE.",
          "",
          "[Removed Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.4\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return s=i.sent(),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
          "",
          "[Added Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.5\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,S,O,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),O=(S=w).lib.WordArray,S.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return O.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],S=e[i+13],O=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,S,12,c[13]),T=t(T,E,w,A,O,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,O,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,S,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,O,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,S,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,O,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,S,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],S=257*h[b]^16843008*b;i[y]=S<<24|S>>>8,a[y]=S<<16|S>>>16,s[y]=S<<8|S>>>24,u[y]=S,S=16843009*_^65537*m^257*v^16843008*y,c[b]=S<<24|S>>>8,l[b]=S<<16|S>>>16,p[b]=S<<8|S>>>24,f[b]=S,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var O=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=O[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,y.error=\"Error while decrypting message content: \".concat(e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,y.error=\"Error while decrypting message content: \".concat(e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var S=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var O=t.postPayload(e,f);d=i.POST(g,O,v,S)}else if(\"PATCH\"===J(e,t,f)){O=t.patchPayload(e,f);d=i.PATCH(g,O,v,S)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,S):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,S):i.GET(g,v,S);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,S,O,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,S=_.id,O=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:S,fileName:O,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:S,name:O}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:S,name:O})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Se={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Oe={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y,g,b={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&b.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&b.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&b.include.push(\"uuid\"),(null===(i=t.include)||void 0===i?void 0:i.customUUIDFields)&&b.include.push(\"uuid.custom\"),(null===(a=t.include)||void 0===a?void 0:a.UUIDStatusField)&&b.include.push(\"uuid.status\"),(null===(u=t.include)||void 0===u?void 0:u.UUIDTypeField)&&b.include.push(\"uuid.type\")),b.include=b.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(b.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(b.start=null===(f=t.page)||void 0===f?void 0:f.next),(null===(h=null==t?void 0:t.page)||void 0===h?void 0:h.prev)&&(b.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(b.filter=t.filter),b.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(b.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),b},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y,g,b={include:[]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.statusField)&&b.include.push(\"status\"),(null===(r=t.include)||void 0===r?void 0:r.customFields)&&b.include.push(\"custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&b.include.push(\"channel\"),(null===(i=t.include)||void 0===i?void 0:i.customChannelFields)&&b.include.push(\"channel.custom\"),(null===(a=t.include)||void 0===a?void 0:a.channelStatusField)&&b.include.push(\"channel.status\"),(null===(u=t.include)||void 0===u?void 0:u.channelTypeField)&&b.include.push(\"channel.type\")),b.include=b.include.join(\",\"),(null===(c=null==t?void 0:t.include)||void 0===c?void 0:c.totalCount)&&(b.count=null===(l=t.include)||void 0===l?void 0:l.totalCount),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.next)&&(b.start=null===(f=t.page)||void 0===f?void 0:f.next),(null===(h=null==t?void 0:t.page)||void 0===h?void 0:h.prev)&&(b.end=null===(d=t.page)||void 0===d?void 0:d.prev),(null==t?void 0:t.filter)&&(b.filter=t.filter),b.limit=null!==(y=null==t?void 0:t.limit)&&void 0!==y?y:100,(null==t?void 0:t.sort)&&(b.sort=Object.entries(null!==(g=t.sort)&&void 0!==g?g:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),b},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,S=t.authKeys,O=void 0===S?[]:S,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),O.length>0&&(w.auth=O.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});var qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message),o={timetoken:t.timetoken,entry:r.payload};t.meta&&(o.meta=t.meta),r.error&&(o.error=r.error),n.messages.push(o)})),n}});var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={},i=function(e,t){var n={};if(!e.cryptoModule)return n.payload=t,n;try{var r=e.cryptoModule.decrypt(t),o=r instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(r)):r;return n.payload=o,n}catch(r){e.config.logVerbosity&&console&&console.log&&console.log(\"decryption error\",r.message),n.payload=t,n.error=\"Error while decrypting message content: \".concat(r.message)}return n}(e,t.message);o.channel=r,o.timetoken=t.timetoken,o.message=i.payload,o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),i.error&&(o.error=i.error),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Qe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Xe={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ye=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),Ze=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),et=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new Ze(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var S=a(this.currentState.enterEffects),O=S.next();!O.done;O=S.next()){g=O.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{O&&!O.done&&(u=S.return)&&u.call(S)}finally{if(i)throw i.error}}}},n}(Ye),tt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function nt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var ot,it,at,st=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ut=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new st},n.prototype.abort=function(){this._aborted=!0,this.notify(new st)},n}(Ye),ct=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ut,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),lt=function(e){return function(t,n){return new ct(t,n,e)}},pt=rt(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ft=rt(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),ht=(it=function(e){return e},at=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:ot,payload:it.apply(void 0,u([],s(e),!1)),managed:!1}},at.type=ot=\"EMIT_EVENTS\",at),dt=rt(\"RECONNECT\",(function(e){return e})),yt=rt(\"HANDSHAKE_RECONNECT\",(function(e){return e})),gt=nt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),bt=nt(\"DISCONNECT\",(function(){return{}})),vt=nt(\"RECONNECT\",(function(){return{}}));nt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var mt=nt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),_t=nt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=nt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Ot=nt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),Pt=nt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),wt=nt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Et=nt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Tt=nt(\"RECEIVING_FAILURE\",(function(e){return e})),At=nt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),Nt=nt(\"RECONNECTING_FAILURE\",(function(e){return e})),kt=nt(\"RECONNECTING_GIVEUP\",(function(){return{}})),Ct=nt(\"RECONNECTING_RETRY\",(function(){return{}})),jt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(pt.type,lt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(mt(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(_t(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ft.type,lt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Et(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Tt(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,lt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(dt.type,lt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(kt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(At(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Nt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(yt.type,lt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Pt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(tt),Mt=new Ze(\"STOPPED\");Mt.on(gt.type,(function(e,t){return Mt.with({channels:t.payload.channels,groups:t.payload.groups})})),Mt.on(vt.type,(function(e){return Gt.with(n({},e))}));var Rt=new Ze(\"HANDSHAKE_FAILURE\");Rt.on(wt.type,(function(e){return Ft.with(n(n({},e),{attempts:0}))})),Rt.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Ut=new Ze(\"STOPPED\");Ut.on(gt.type,(function(e,t){return Ut.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),Ut.on(vt.type,(function(e){return Dt.with(n({},e))}));var It=new Ze(\"RECEIVE_FAILURE\");It.on(Ct.type,(function(e){return xt.with(n(n({},e),{attempts:0}))})),It.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var xt=new Ze(\"RECEIVE_RECONNECTING\");xt.onEnter((function(e){return dt(e)})),xt.onExit((function(){return dt.cancel})),xt.on(At.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[ht(t.payload.events)])})),xt.on(Nt.type,(function(e,t){return xt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),xt.on(kt.type,(function(e){return It.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),xt.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new Ze(\"RECEIVING\");Dt.onEnter((function(e){return ft(e.channels,e.groups,e.cursor)})),Dt.onExit((function(){return ft.cancel})),Dt.on(Et.type,(function(e,t){return Dt.with(n(n({},e),{cursor:t.payload.cursor}),[ht(t.payload.events)])})),Dt.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Dt.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Dt.on(Tt.type,(function(e,t){return xt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Dt.on(bt.type,(function(e){return Ut.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new Ze(\"HANDSHAKE_RECONNECTING\");Ft.onEnter((function(e){return yt(e)})),Ft.onExit((function(){return dt.cancel})),Ft.on(At.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[ht(t.payload.events)])})),Ft.on(Nt.type,(function(e,t){return Ft.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Ft.on(kt.type,(function(e){return Rt.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Ft.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Gt=new Ze(\"HANDSHAKING\");Gt.onEnter((function(e){return pt(e.channels,e.groups)})),Gt.onExit((function(){return pt.cancel})),Gt.on(gt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Lt.with(void 0):Gt.with({channels:t.payload.channels,groups:t.payload.groups})})),Gt.on(mt.type,(function(e,t){return Dt.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Gt.on(_t.type,(function(e,t){return Ft.with(n(n({},e),{attempts:0,reason:t.payload}))})),Gt.on(bt.type,(function(e){return Mt.with({channels:e.channels,groups:e.groups})}));var Lt=new Ze(\"UNSUBSCRIBED\");Lt.on(gt.type,(function(e,t){return Gt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Kt=function(){function e(e){var t=this;this.engine=new et,this.channels=[],this.groups=[],this.dispatcher=new jt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Lt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(gt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(gt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(gt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(vt())},e.prototype.disconnect=function(){this.engine.transition(bt())},e}(),Bt=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,Je),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,$e),S=new B;if(this._listenerManager=S,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Qe),this.receiveMessages=Q.bind(this,h,Xe),!0===i.enableSubscribeBeta){var O=new Kt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=O.subscribe.bind(O),this.unsubscribe=O.unsubscribe.bind(O),this.eventEngine=O}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:S,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=S.addListener.bind(S),this.removeListener=S.removeListener.bind(S),this.removeAllListeners=S.removeAllListeners.bind(S),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,qe),this.deleteMessages=Q.bind(this,h,ze),this.messageCounts=Q.bind(this,h,Ve),this.fetchMessages=Q.bind(this,h,We),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Se),this.objects={getAllUUIDMetadata:Q.bind(this,h,Oe),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,statusField:e.include.statusField,UUIDStatusField:e.include.userStatusField,UUIDTypeField:e.include.userTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,statusField:e.include.statusField,channelStatusField:e.include.spaceStatusField,channelTypeField:e.include.spaceTypeField,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),Ht=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function qt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?qt(a):a})),n}var zt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Vt={exports:{}},Wt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Wt);var Jt=en;en.default=en,en.stable=on,en.stableStringify=on;var $t=\"[...]\",Qt=\"[Circular]\",Xt=[],Yt=[];function Zt(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function en(e,t,n,r){var o;void 0===r&&(r=Zt()),nn(e,\"\",0,[],void 0,0,r);try{o=0===Yt.length?JSON.stringify(e,t,n):JSON.stringify(e,sn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Xt.length;){var i=Xt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function tn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Xt.push([r,n,t,o])):Yt.push([t,n,e]):(r[n]=e,Xt.push([r,n,t]))}function nn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void tn(Qt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void tn($t,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void tn($t,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)nn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];nn(e[c],c,s,r,e,i,a)}}r.pop()}}function rn(e,t){return e<t?-1:e>t?1:0}function on(e,t,n,r){void 0===r&&(r=Zt());var o,i=an(e,\"\",0,[],void 0,0,r)||e;try{o=0===Yt.length?JSON.stringify(i,t,n):JSON.stringify(i,sn(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Xt.length;){var a=Xt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function an(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void tn(Qt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void tn($t,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void tn($t,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)an(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(rn);for(s=0;s<c.length;s++){var l=c[s];an(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Xt.push([o,t,e]),o[t]=u}r.pop()}}function sn(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Yt.length>0)for(var r=0;r<Yt.length;r++){var o=Yt[r];if(o[1]===t&&o[0]===n){n=o[2],Yt.splice(r,1);break}}return e.call(this,t,n)}}var un,cn=\"undefined\"!=typeof Symbol&&Symbol,ln=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},pn=\"Function.prototype.bind called on incompatible \",fn=Array.prototype.slice,hn=Object.prototype.toString,dn=\"[object Function]\",yn=function(e){var t=this;if(\"function\"!=typeof t||hn.call(t)!==dn)throw new TypeError(pn+t);for(var n,r=fn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(fn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(fn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},gn=Function.prototype.bind||yn,bn=gn.call(Function.call,Object.prototype.hasOwnProperty),vn=SyntaxError,mn=Function,_n=TypeError,Sn=function(e){try{return mn('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},On=Object.getOwnPropertyDescriptor;if(On)try{On({},\"\")}catch(e){On=null}var Pn=function(){throw new _n},wn=On?function(){try{return Pn}catch(e){try{return On(arguments,\"callee\").get}catch(e){return Pn}}}():Pn,En=\"function\"==typeof cn&&\"function\"==typeof Symbol&&\"symbol\"==typeof cn(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&ln(),Tn=Object.getPrototypeOf||function(e){return e.__proto__},An={},Nn=\"undefined\"==typeof Uint8Array?un:Tn(Uint8Array),kn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?un:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?un:ArrayBuffer,\"%ArrayIteratorPrototype%\":En?Tn([][Symbol.iterator]()):un,\"%AsyncFromSyncIteratorPrototype%\":un,\"%AsyncFunction%\":An,\"%AsyncGenerator%\":An,\"%AsyncGeneratorFunction%\":An,\"%AsyncIteratorPrototype%\":An,\"%Atomics%\":\"undefined\"==typeof Atomics?un:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?un:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?un:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?un:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?un:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?un:FinalizationRegistry,\"%Function%\":mn,\"%GeneratorFunction%\":An,\"%Int8Array%\":\"undefined\"==typeof Int8Array?un:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?un:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?un:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":En?Tn(Tn([][Symbol.iterator]())):un,\"%JSON%\":\"object\"==typeof JSON?JSON:un,\"%Map%\":\"undefined\"==typeof Map?un:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&En?Tn((new Map)[Symbol.iterator]()):un,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?un:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?un:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?un:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?un:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&En?Tn((new Set)[Symbol.iterator]()):un,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?un:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":En?Tn(\"\"[Symbol.iterator]()):un,\"%Symbol%\":En?Symbol:un,\"%SyntaxError%\":vn,\"%ThrowTypeError%\":wn,\"%TypedArray%\":Nn,\"%TypeError%\":_n,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?un:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?un:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?un:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?un:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?un:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?un:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?un:WeakSet},Cn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=Tn(o.prototype))}return kn[t]=n,n},jn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Mn=gn,Rn=bn,Un=Mn.call(Function.call,Array.prototype.concat),In=Mn.call(Function.apply,Array.prototype.splice),xn=Mn.call(Function.call,String.prototype.replace),Dn=Mn.call(Function.call,String.prototype.slice),Fn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Gn=/\\\\(\\\\)?/g,Ln=function(e){var t=Dn(e,0,1),n=Dn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new vn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new vn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return xn(e,Fn,(function(e,t,n,o){r[r.length]=n?xn(o,Gn,\"$1\"):t||e})),r},Kn=function(e,t){var n,r=e;if(Rn(jn,r)&&(r=\"%\"+(n=jn[r])[0]+\"%\"),Rn(kn,r)){var o=kn[r];if(o===An&&(o=Cn(r)),void 0===o&&!t)throw new _n(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new vn(\"intrinsic \"+e+\" does not exist!\")},Bn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new _n(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new _n('\"allowMissing\" argument must be a boolean');var n=Ln(e),r=n.length>0?n[0]:\"\",o=Kn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],In(n,Un([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Dn(p,0,1),h=Dn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new vn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Rn(kn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=kn[i];else if(null!=a){if(!(p in a)){if(!t)throw new _n(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(On&&c+1>=n.length){var d=On(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Rn(a,p),a=a[p];l&&!s&&(kn[i]=a)}}return a},Hn={exports:{}};!function(e){var t=gn,n=Bn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(Hn);var qn=Bn,zn=Hn.exports,Vn=zn(qn(\"String.prototype.indexOf\")),Wn=l(Object.freeze({__proto__:null,default:{}})),Jn=\"function\"==typeof Map&&Map.prototype,$n=Object.getOwnPropertyDescriptor&&Jn?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Qn=Jn&&$n&&\"function\"==typeof $n.get?$n.get:null,Xn=Jn&&Map.prototype.forEach,Yn=\"function\"==typeof Set&&Set.prototype,Zn=Object.getOwnPropertyDescriptor&&Yn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,er=Yn&&Zn&&\"function\"==typeof Zn.get?Zn.get:null,tr=Yn&&Set.prototype.forEach,nr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,rr=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,or=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ir=Boolean.prototype.valueOf,ar=Object.prototype.toString,sr=Function.prototype.toString,ur=String.prototype.match,cr=String.prototype.slice,lr=String.prototype.replace,pr=String.prototype.toUpperCase,fr=String.prototype.toLowerCase,hr=RegExp.prototype.test,dr=Array.prototype.concat,yr=Array.prototype.join,gr=Array.prototype.slice,br=Math.floor,vr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,mr=Object.getOwnPropertySymbols,_r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Or=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,Pr=Object.prototype.propertyIsEnumerable,wr=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Er(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||hr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-br(-e):br(e);if(r!==e){var o=String(r),i=cr.call(t,o.length+1);return lr.call(o,n,\"$&_\")+\".\"+lr.call(lr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return lr.call(t,n,\"$&_\")}var Tr=Wn,Ar=Tr.custom,Nr=Rr(Ar)?Ar:null;function kr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function Cr(e){return lr.call(String(e),/\"/g,\"&quot;\")}function jr(e){return!(\"[object Array]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}function Mr(e){return!(\"[object RegExp]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}function Rr(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!_r)return!1;try{return _r.call(e),!0}catch(e){}return!1}var Ur=Object.prototype.hasOwnProperty||function(e){return e in this};function Ir(e,t){return Ur.call(e,t)}function xr(e){return ar.call(e)}function Dr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Fr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Fr(cr.call(e,0,t.maxStringLength),t)+r}return kr(lr.call(lr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Gr),\"single\",t)}function Gr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+pr.call(t.toString(16))}function Lr(e){return\"Object(\"+e+\")\"}function Kr(e){return e+\" { ? }\"}function Br(e,t,n,r){return e+\" (\"+t+\") {\"+(r?Hr(n,r):yr.call(n,\", \"))+\"}\"}function Hr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+yr.call(e,\",\"+n)+\"\\n\"+t.prev}function qr(e,t){var n=jr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=Ir(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof mr?mr(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)Ir(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(hr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof mr)for(var c=0;c<a.length;c++)Pr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var zr=Bn,Vr=function(e,t){var n=qn(e,!!t);return\"function\"==typeof n&&Vn(e,\".prototype.\")>-1?zn(n):n},Wr=function e(t,n,r,o){var i=n||{};if(Ir(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(Ir(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!Ir(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(Ir(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(Ir(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Fr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Er(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Er(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return jr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=yr.call(Array(e.indent+1),\" \")}return{base:n,prev:yr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Dr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=gr.call(o)).push(n),a){var s={depth:i.depth};return Ir(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Mr(t)){var h=function(e){if(e.name)return e.name;var t=ur.call(sr.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=qr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+yr.call(d,\", \")+\" }\":\"\")}if(Rr(t)){var y=Sr?lr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):_r.call(t);return\"object\"!=typeof t||Sr?y:Lr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+fr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+kr(Cr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+fr.call(String(t.nodeName))+\">\"}if(jr(t)){if(0===t.length)return\"[]\";var m=qr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Dr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+Hr(m,p)+\"]\":\"[ \"+yr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}(t)){var _=qr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||Pr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+yr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+yr.call(dr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(Nr&&\"function\"==typeof t[Nr]&&Tr)return Tr(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Qn||!e||\"object\"!=typeof e)return!1;try{Qn.call(e);try{er.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var S=[];return Xn&&Xn.call(t,(function(e,n){S.push(f(n,t,!0)+\" => \"+f(e,t))})),Br(\"Map\",Qn.call(t),S,p)}if(function(e){if(!er||!e||\"object\"!=typeof e)return!1;try{er.call(e);try{Qn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var O=[];return tr&&tr.call(t,(function(e){O.push(f(e,t))})),Br(\"Set\",er.call(t),O,p)}if(function(e){if(!nr||!e||\"object\"!=typeof e)return!1;try{nr.call(e,nr);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Kr(\"WeakMap\");if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{nr.call(e,nr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Kr(\"WeakSet\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{return or.call(e),!0}catch(e){}return!1}(t))return Kr(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}(t))return Lr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!vr)return!1;try{return vr.call(e),!0}catch(e){}return!1}(t))return Lr(f(vr.call(t)));if(function(e){return!(\"[object Boolean]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}(t))return Lr(ir.call(t));if(function(e){return!(\"[object String]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}(t))return Lr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==xr(e)||Or&&\"object\"==typeof e&&Or in e)}(t)&&!Mr(t)){var P=qr(t,f),w=wr?wr(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Or&&Object(t)===t&&Or in t?cr.call(xr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+yr.call(dr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+Hr(P,p)+\"}\":A+\"{ \"+yr.call(P,\", \")+\" }\"}return String(t)},Jr=zr(\"%TypeError%\"),$r=zr(\"%WeakMap%\",!0),Qr=zr(\"%Map%\",!0),Xr=Vr(\"WeakMap.prototype.get\",!0),Yr=Vr(\"WeakMap.prototype.set\",!0),Zr=Vr(\"WeakMap.prototype.has\",!0),eo=Vr(\"Map.prototype.get\",!0),to=Vr(\"Map.prototype.set\",!0),no=Vr(\"Map.prototype.has\",!0),ro=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},oo=String.prototype.replace,io=/%20/g,ao=\"RFC3986\",so={default:ao,formatters:{RFC1738:function(e){return oo.call(e,io,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:ao},uo=so,co=Object.prototype.hasOwnProperty,lo=Array.isArray,po=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),fo=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},ho={arrayToObject:fo,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(lo(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===uo.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=po[u]:u<2048?a+=po[192|u>>6]+po[128|63&u]:u<55296||u>=57344?a+=po[224|u>>12]+po[128|u>>6&63]+po[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=po[240|u>>18]+po[128|u>>12&63]+po[128|u>>6&63]+po[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(lo(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(lo(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!co.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return lo(t)&&!lo(n)&&(o=fo(t,r)),lo(t)&&lo(n)?(n.forEach((function(n,o){if(co.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return co.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},yo=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new Jr(\"Side channel does not contain \"+Wr(e))},get:function(r){if($r&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Xr(e,r)}else if(Qr){if(t)return eo(t,r)}else if(n)return function(e,t){var n=ro(e,t);return n&&n.value}(n,r)},has:function(r){if($r&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Zr(e,r)}else if(Qr){if(t)return no(t,r)}else if(n)return function(e,t){return!!ro(e,t)}(n,r);return!1},set:function(r,o){$r&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new $r),Yr(e,r,o)):Qr?(t||(t=new Qr),to(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=ro(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},go=ho,bo=so,vo=Object.prototype.hasOwnProperty,mo={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},_o=Array.isArray,So=Array.prototype.push,Oo=function(e,t){So.apply(e,_o(t)?t:[t])},Po=Date.prototype.toISOString,wo=bo.default,Eo={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:go.encode,encodeValuesOnly:!1,format:wo,formatter:bo.formatters[wo],indices:!1,serializeDate:function(e){return Po.call(e)},skipNulls:!1,strictNullHandling:!1},To={},Ao=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,S=!1;void 0!==(m=m.get(To))&&!S;){var O=m.get(t);if(_+=1,void 0!==O){if(O===_)throw new RangeError(\"Cyclic object value\");S=!0}void 0===m.get(To)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&_o(v)&&(v=go.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,Eo.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||go.isBuffer(v))return s?[h(d?n:s(n,Eo.encoder,y,\"key\",f))+\"=\"+h(s(v,Eo.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&_o(v))d&&s&&(v=go.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(_o(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&_o(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=_o(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=yo();j.set(To,g),Oo(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&_o(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},No=ho,ko=Object.prototype.hasOwnProperty,Co=Array.isArray,jo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:No.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Mo=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Ro=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Uo=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&ko.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&ko.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Ro(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},Io=function(e,t){var n,r=e,o=function(e){if(!e)return Eo;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||Eo.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=bo.default;if(void 0!==e.format){if(!vo.call(bo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=bo.formatters[n],o=Eo.filter;return(\"function\"==typeof e.filter||_o(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:Eo.addQueryPrefix,allowDots:void 0===e.allowDots?Eo.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Eo.charsetSentinel,delimiter:void 0===e.delimiter?Eo.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:Eo.encode,encoder:\"function\"==typeof e.encoder?e.encoder:Eo.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:Eo.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:Eo.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:Eo.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Eo.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):_o(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in mo?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=mo[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=yo(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Oo(a,Ao(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},xo={formats:so,parse:function(e,t){var n=function(e){if(!e)return jo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?jo.charset:e.charset;return{allowDots:void 0===e.allowDots?jo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:jo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:jo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:jo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:jo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:jo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:jo.decoder,delimiter:\"string\"==typeof e.delimiter||No.isRegExp(e.delimiter)?e.delimiter:jo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:jo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:jo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:jo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:jo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:jo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,jo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),jo.decoder,u,\"key\"),l=No.maybeMap(Ro(p.slice(h+1),t),(function(e){return t.decoder(e,jo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Mo(l)),p.indexOf(\"[]=\")>-1&&(l=Co(l)?[l]:l),ko.call(r,c)?r[c]=No.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Uo(s,r[s],n,\"string\"==typeof e);o=No.merge(o,u,n)}return!0===n.allowSparse?o:No.compact(o)},stringify:Io},Do={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Do);const Fo=Wn,Go=Do.isObject,Lo=Do.hasOwn;var Ko=Bo;function Bo(){}Bo.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Bo.prototype.parse=function(e){return this._parser=e,this},Bo.prototype.responseType=function(e){return this._responseType=e,this},Bo.prototype.serialize=function(e){return this._serializer=e,this},Bo.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Lo(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Bo.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const Ho=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),qo=new Set([408,413,429,500,502,503,504,521,522,524]);Bo.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&qo.has(t.status))return!0;if(e){if(e.code&&Ho.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Bo.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Bo.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Bo.prototype.catch=function(e){return this.then(void 0,e)},Bo.prototype.use=function(e){return e(this),this},Bo.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Bo.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Bo.prototype.get=function(e){return this._header[e.toLowerCase()]},Bo.prototype.getHeader=Bo.prototype.get,Bo.prototype.set=function(e,t){if(Go(e)){for(const t in e)Lo(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Bo.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Bo.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Go(e)){for(const t in e)Lo(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Lo(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Bo.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Fo.gte(process.version,\"v13.0.0\")&&Fo.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Bo.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Bo.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Bo.prototype.redirects=function(e){return this._maxRedirects=e,this},Bo.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Bo.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Bo.prototype.send=function(e){const t=Go(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Go(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Lo(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Bo.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Bo.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Bo.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Bo.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Bo.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const zo=Do;var Vo=Wo;function Wo(){}function Jo(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return $o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $o(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function $o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qo(){this._defaults=[]}Wo.prototype.get=function(e){return this.header[e.toLowerCase()]},Wo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=zo.type(t);const n=zo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=zo.parseLinks(e.link))}catch(e){}},Wo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Xo=0,Yo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Xo<Yo.length;Xo++){const e=Yo[Xo];Qo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Qo.prototype._setDefaults=function(e){var t,n=Jo(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var Zo=Qo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Wt.exports,a=Jt,s=xo,u=Ko,c=Do.isObject,l=Do.mixin,p=Do.hasOwn,f=Vo,h=Zo;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=O,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function S(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function O(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new S(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(S.prototype,f.prototype),S.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},S.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=S,i(O.prototype),l(O.prototype,u.prototype),O.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},O.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},O.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},O.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},O.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},O.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},O.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},O.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},O.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},O.prototype.ca=O.prototype.agent,O.prototype.buffer=O.prototype.ca,O.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},O.prototype.pipe=O.prototype.write,O.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},O.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},O.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},O.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Vt,Vt.exports);var ei=Vt.exports;function ti(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ni(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ti)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function ri(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ei.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function oi(e,t,n){var r=ei.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ii(e,t,n){var r=ei.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ai(e,t,n,r){var o=ei.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ni.call(this,o,n,r)}function si(e,t,n,r){var o=ei.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ni.call(this,o,n,r)}function ui(e,t,n){var r=ei.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ni.call(this,r,t,n)}function ci(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var li,pi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=ci,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=ci(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),fi=(li=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),li.supportsFile=\"undefined\"!=typeof File,li.supportsBlob=\"undefined\"!=typeof Blob,li.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,li.supportsBuffer=!1,li.supportsStream=!1,li.supportsString=!0,li.supportsEncryptFile=!0,li.supportsFileUri=!1,li),hi=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new pi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),di=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),yi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new di({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey}),cryptors:[new hi({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=gi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===gi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:[4,this.getFileData(e.data)];case 1:return n=o.sent(),[4,this.defaultCryptor.encryptFileData(n)];case 2:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=gi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:[4,this.getFileData(r)];case 2:return s=i.sent(),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})];case 3:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof bi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=gi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t instanceof Blob?[4,t.arrayBuffer()]:[3,2];case 1:return[2,n.sent()];case 2:if(t instanceof ArrayBuffer)return[2,t];if(\"string\"==typeof t)return[2,e.encoder.encode(t)];throw new Error(\"Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob\")}}))}))},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new bi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new bi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),bi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return gi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return gi.SENTINEL.length+1+gi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(gi.SENTINEL)),t[e+=gi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=gi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function vi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var mi=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new Ht({del:ui,get:ii,post:ai,patch:si,sendBeacon:vi,getfile:oi,postfile:ri}),t.cbor=new zt((function(e){return qt(f.decode(e))}),b),t.PubNubFile=fi,t.cryptography=new pi,t.initCryptoModule=function(e){return new yi({default:new hi({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new di({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=yi,n}(Bt);return mi}));",
          "",
          "---------------"
        ],
        "lib/core/components/config.js||lib/core/components/config.js": [
          "File: lib/core/components/config.js -> lib/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "177:         return this;",
          "178:     };",
          "179:     default_1.prototype.getVersion = function () {",
          "181:     };",
          "182:     default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "183:         this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "180:         return '7.4.4';",
          "",
          "[Added Lines]",
          "180:         return '7.4.5';",
          "",
          "---------------"
        ],
        "lib/core/components/subscription_manager.js||lib/core/components/subscription_manager.js": [
          "File: lib/core/components/subscription_manager.js -> lib/core/components/subscription_manager.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "534:                     }",
          "535:                     catch (e) {",
          "536:                         decryptedPayload = null;",
          "540:                     }",
          "541:                     if (decryptedPayload !== null) {",
          "542:                         msgPayload = decryptedPayload;",
          "",
          "[Removed Lines]",
          "537:                         if (console && console.log) {",
          "538:                             console.log('decryption error', e.message);",
          "539:                         }",
          "",
          "[Added Lines]",
          "537:                         announce.error = \"Error while decrypting message content: \".concat(e.message);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "581:                     }",
          "582:                     catch (e) {",
          "583:                         decryptedPayload = null;",
          "588:                     }",
          "589:                     if (decryptedPayload != null) {",
          "590:                         announce.message = decryptedPayload;",
          "",
          "[Removed Lines]",
          "585:                         if (console && console.log) {",
          "586:                             console.log('decryption error', e.message); //eslint-disable-line",
          "587:                         }",
          "",
          "[Added Lines]",
          "582:                         announce.error = \"Error while decrypting message content: \".concat(e.message);",
          "",
          "---------------"
        ],
        "lib/core/endpoints/fetch_messages.js||lib/core/endpoints/fetch_messages.js": [
          "File: lib/core/endpoints/fetch_messages.js -> lib/core/endpoints/fetch_messages.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: var operations_1 = __importDefault(require(\"../constants/operations\"));",
          "9: var utils_1 = __importDefault(require(\"../utils\"));",
          "10: function __processMessage(modules, message) {",
          "13:     try {",
          "14:         var decryptedData = modules.cryptoModule.decrypt(message);",
          "15:         var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "17:     }",
          "18:     catch (e) {",
          "20:             console.log('decryption error', e.message);",
          "22:     }",
          "23: }",
          "24: function getOperation() {",
          "25:     return operations_1.default.PNFetchMessagesOperation;",
          "",
          "[Removed Lines]",
          "11:     if (!modules.cryptoModule)",
          "12:         return message;",
          "16:         return decryptedPayload;",
          "19:         if (console && console.log)",
          "21:         return message;",
          "",
          "[Added Lines]",
          "11:     var result = {};",
          "12:     if (!modules.cryptoModule) {",
          "13:         result.payload = message;",
          "14:         return result;",
          "15:     }",
          "19:         result.payload = decryptedPayload;",
          "20:         return result;",
          "23:         if (modules.config.logVerbosity && console && console.log)",
          "25:         result.payload = message;",
          "26:         result.error = \"Error while decrypting message content: \".concat(e.message);",
          "28:     return result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87:         response.channels[channelName] = [];",
          "88:         (serverResponse.channels[channelName] || []).forEach(function (messageEnvelope) {",
          "89:             var announce = {};",
          "90:             announce.channel = channelName;",
          "91:             announce.timetoken = messageEnvelope.timetoken;",
          "93:             announce.messageType = messageEnvelope.message_type;",
          "94:             announce.uuid = messageEnvelope.uuid;",
          "95:             if (messageEnvelope.actions) {",
          "",
          "[Removed Lines]",
          "92:             announce.message = __processMessage(modules, messageEnvelope.message);",
          "",
          "[Added Lines]",
          "96:             var processedMessgeResult = __processMessage(modules, messageEnvelope.message);",
          "99:             announce.message = processedMessgeResult.payload;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "100:             if (messageEnvelope.meta) {",
          "101:                 announce.meta = messageEnvelope.meta;",
          "102:             }",
          "103:             response.channels[channelName].push(announce);",
          "104:         });",
          "105:     });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "110:             if (processedMessgeResult.error)",
          "111:                 announce.error = processedMessgeResult.error;",
          "",
          "---------------"
        ],
        "lib/core/endpoints/history/get_history.js||lib/core/endpoints/history/get_history.js": [
          "File: lib/core/endpoints/history/get_history.js -> lib/core/endpoints/history/get_history.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: var operations_1 = __importDefault(require(\"../../constants/operations\"));",
          "9: var utils_1 = __importDefault(require(\"../../utils\"));",
          "10: function __processMessage(modules, message) {",
          "13:     try {",
          "14:         var decryptedData = modules.cryptoModule.decrypt(message);",
          "15:         var decryptedPayload = decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "17:     }",
          "18:     catch (e) {",
          "20:             console.log('decryption error', e.message);",
          "22:     }",
          "23: }",
          "24: function getOperation() {",
          "25:     return operations_1.default.PNHistoryOperation;",
          "",
          "[Removed Lines]",
          "11:     if (!modules.cryptoModule)",
          "12:         return message;",
          "16:         return decryptedPayload;",
          "19:         if (console && console.log)",
          "21:         return message;",
          "",
          "[Added Lines]",
          "11:     var result = {};",
          "12:     if (!modules.cryptoModule) {",
          "13:         result.payload = message;",
          "14:         return result;",
          "15:     }",
          "19:         result.payload = decryptedPayload;",
          "20:         return result;",
          "23:         if (modules.config.logVerbosity && console && console.log)",
          "25:         result.payload = message;",
          "26:         result.error = \"Error while decrypting message content: \".concat(e.message);",
          "28:     return result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76:     };",
          "77:     if (Array.isArray(serverResponse[0])) {",
          "78:         serverResponse[0].forEach(function (serverHistoryItem) {",
          "79:             var item = {",
          "80:                 timetoken: serverHistoryItem.timetoken,",
          "82:             };",
          "83:             if (serverHistoryItem.meta) {",
          "84:                 item.meta = serverHistoryItem.meta;",
          "85:             }",
          "86:             response.messages.push(item);",
          "87:         });",
          "88:     }",
          "",
          "[Removed Lines]",
          "81:                 entry: __processMessage(modules, serverHistoryItem.message),",
          "",
          "[Added Lines]",
          "85:             var processedMessgeResult = __processMessage(modules, serverHistoryItem.message);",
          "88:                 entry: processedMessgeResult.payload,",
          "93:             if (processedMessgeResult.error)",
          "94:                 item.error = processedMessgeResult.error;",
          "",
          "---------------"
        ],
        "lib/core/endpoints/objects/member/get.js||lib/core/endpoints/objects/member/get.js": [
          "File: lib/core/endpoints/objects/member/get.js -> lib/core/endpoints/objects/member/get.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "26:     getOperation: function () { return operations_1.default.PNGetMembersOperation; },",
          "27:     validateParams: function (_, params) {",
          "28:         if (!(params === null || params === void 0 ? void 0 : params.channel)) {",
          "30:         }",
          "31:     },",
          "32:     getURL: function (_a, params) {",
          "",
          "[Removed Lines]",
          "29:             return 'UUID cannot be empty';",
          "",
          "[Added Lines]",
          "29:             return 'channel cannot be empty';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "39:     },",
          "40:     isAuthSupported: function () { return true; },",
          "41:     prepareParams: function (_modules, params) {",
          "43:         var queryParams = {};",
          "45:         if (params === null || params === void 0 ? void 0 : params.include) {",
          "47:                 queryParams.include.push('custom');",
          "48:             }",
          "50:                 queryParams.include.push('uuid.custom');",
          "51:             }",
          "54:             }",
          "55:         }",
          "56:         queryParams.include = queryParams.include.join(',');",
          "59:         }",
          "62:         }",
          "65:         }",
          "66:         if (params === null || params === void 0 ? void 0 : params.filter) {",
          "67:             queryParams.filter = params.filter;",
          "68:         }",
          "70:         if (params === null || params === void 0 ? void 0 : params.sort) {",
          "72:                 var _b = __read(_a, 2), key = _b[0], value = _b[1];",
          "73:                 if (value === 'asc' || value === 'desc') {",
          "74:                     return \"\".concat(key, \":\").concat(value);",
          "",
          "[Removed Lines]",
          "42:         var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;",
          "44:         queryParams.include = ['uuid.status', 'uuid.type', 'status'];",
          "46:             if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.customFields) {",
          "49:             if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customUUIDFields) {",
          "52:             if ((_d = (_c = params.include) === null || _c === void 0 ? void 0 : _c.UUIDFields) !== null && _d !== void 0 ? _d : true) {",
          "53:                 queryParams.include.push('uuid');",
          "57:         if ((_e = params === null || params === void 0 ? void 0 : params.include) === null || _e === void 0 ? void 0 : _e.totalCount) {",
          "58:             queryParams.count = (_f = params.include) === null || _f === void 0 ? void 0 : _f.totalCount;",
          "60:         if ((_g = params === null || params === void 0 ? void 0 : params.page) === null || _g === void 0 ? void 0 : _g.next) {",
          "61:             queryParams.start = (_h = params.page) === null || _h === void 0 ? void 0 : _h.next;",
          "63:         if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.prev) {",
          "64:             queryParams.end = (_k = params.page) === null || _k === void 0 ? void 0 : _k.prev;",
          "69:         queryParams.limit = (_l = params === null || params === void 0 ? void 0 : params.limit) !== null && _l !== void 0 ? _l : 100;",
          "71:             queryParams.sort = Object.entries((_m = params.sort) !== null && _m !== void 0 ? _m : {}).map(function (_a) {",
          "",
          "[Added Lines]",
          "42:         var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;",
          "44:         queryParams.include = [];",
          "46:             if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.statusField) {",
          "47:                 queryParams.include.push('status');",
          "48:             }",
          "49:             if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customFields) {",
          "52:             if ((_c = params.include) === null || _c === void 0 ? void 0 : _c.UUIDFields) {",
          "53:                 queryParams.include.push('uuid');",
          "54:             }",
          "55:             if ((_d = params.include) === null || _d === void 0 ? void 0 : _d.customUUIDFields) {",
          "58:             if ((_e = params.include) === null || _e === void 0 ? void 0 : _e.UUIDStatusField) {",
          "59:                 queryParams.include.push('uuid.status');",
          "60:             }",
          "61:             if ((_f = params.include) === null || _f === void 0 ? void 0 : _f.UUIDTypeField) {",
          "62:                 queryParams.include.push('uuid.type');",
          "66:         if ((_g = params === null || params === void 0 ? void 0 : params.include) === null || _g === void 0 ? void 0 : _g.totalCount) {",
          "67:             queryParams.count = (_h = params.include) === null || _h === void 0 ? void 0 : _h.totalCount;",
          "69:         if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.next) {",
          "70:             queryParams.start = (_k = params.page) === null || _k === void 0 ? void 0 : _k.next;",
          "72:         if ((_l = params === null || params === void 0 ? void 0 : params.page) === null || _l === void 0 ? void 0 : _l.prev) {",
          "73:             queryParams.end = (_m = params.page) === null || _m === void 0 ? void 0 : _m.prev;",
          "78:         queryParams.limit = (_o = params === null || params === void 0 ? void 0 : params.limit) !== null && _o !== void 0 ? _o : 100;",
          "80:             queryParams.sort = Object.entries((_p = params.sort) !== null && _p !== void 0 ? _p : {}).map(function (_a) {",
          "",
          "---------------"
        ],
        "lib/core/endpoints/objects/membership/get.js||lib/core/endpoints/objects/membership/get.js": [
          "File: lib/core/endpoints/objects/membership/get.js -> lib/core/endpoints/objects/membership/get.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "37:     },",
          "38:     isAuthSupported: function () { return true; },",
          "39:     prepareParams: function (_modules, params) {",
          "41:         var queryParams = {};",
          "43:         if (params === null || params === void 0 ? void 0 : params.include) {",
          "46:             }",
          "49:             }",
          "50:             if ((_c = params.include) === null || _c === void 0 ? void 0 : _c.channelFields) {",
          "51:                 queryParams.include.push('channel');",
          "52:             }",
          "53:         }",
          "54:         queryParams.include = queryParams.include.join(',');",
          "57:         }",
          "60:         }",
          "63:         }",
          "64:         if (params === null || params === void 0 ? void 0 : params.filter) {",
          "65:             queryParams.filter = params.filter;",
          "66:         }",
          "68:         if (params === null || params === void 0 ? void 0 : params.sort) {",
          "70:                 var _b = __read(_a, 2), key = _b[0], value = _b[1];",
          "71:                 if (value === 'asc' || value === 'desc') {",
          "72:                     return \"\".concat(key, \":\").concat(value);",
          "",
          "[Removed Lines]",
          "40:         var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;",
          "42:         queryParams.include = ['channel.status', 'channel.type', 'status'];",
          "44:             if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.customFields) {",
          "45:                 queryParams.include.push('custom');",
          "47:             if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customChannelFields) {",
          "48:                 queryParams.include.push('channel.custom');",
          "55:         if ((_d = params === null || params === void 0 ? void 0 : params.include) === null || _d === void 0 ? void 0 : _d.totalCount) {",
          "56:             queryParams.count = (_e = params.include) === null || _e === void 0 ? void 0 : _e.totalCount;",
          "58:         if ((_f = params === null || params === void 0 ? void 0 : params.page) === null || _f === void 0 ? void 0 : _f.next) {",
          "59:             queryParams.start = (_g = params.page) === null || _g === void 0 ? void 0 : _g.next;",
          "61:         if ((_h = params === null || params === void 0 ? void 0 : params.page) === null || _h === void 0 ? void 0 : _h.prev) {",
          "62:             queryParams.end = (_j = params.page) === null || _j === void 0 ? void 0 : _j.prev;",
          "67:         queryParams.limit = (_k = params === null || params === void 0 ? void 0 : params.limit) !== null && _k !== void 0 ? _k : 100;",
          "69:             queryParams.sort = Object.entries((_l = params.sort) !== null && _l !== void 0 ? _l : {}).map(function (_a) {",
          "",
          "[Added Lines]",
          "40:         var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;",
          "42:         queryParams.include = [];",
          "44:             if ((_a = params.include) === null || _a === void 0 ? void 0 : _a.statusField) {",
          "45:                 queryParams.include.push('status');",
          "47:             if ((_b = params.include) === null || _b === void 0 ? void 0 : _b.customFields) {",
          "48:                 queryParams.include.push('custom');",
          "53:             if ((_d = params.include) === null || _d === void 0 ? void 0 : _d.customChannelFields) {",
          "54:                 queryParams.include.push('channel.custom');",
          "55:             }",
          "56:             if ((_e = params.include) === null || _e === void 0 ? void 0 : _e.channelStatusField) {",
          "57:                 queryParams.include.push('channel.status');",
          "58:             }",
          "59:             if ((_f = params.include) === null || _f === void 0 ? void 0 : _f.channelTypeField) {",
          "60:                 queryParams.include.push('channel.type');",
          "61:             }",
          "64:         if ((_g = params === null || params === void 0 ? void 0 : params.include) === null || _g === void 0 ? void 0 : _g.totalCount) {",
          "65:             queryParams.count = (_h = params.include) === null || _h === void 0 ? void 0 : _h.totalCount;",
          "67:         if ((_j = params === null || params === void 0 ? void 0 : params.page) === null || _j === void 0 ? void 0 : _j.next) {",
          "68:             queryParams.start = (_k = params.page) === null || _k === void 0 ? void 0 : _k.next;",
          "70:         if ((_l = params === null || params === void 0 ? void 0 : params.page) === null || _l === void 0 ? void 0 : _l.prev) {",
          "71:             queryParams.end = (_m = params.page) === null || _m === void 0 ? void 0 : _m.prev;",
          "76:         queryParams.limit = (_o = params === null || params === void 0 ? void 0 : params.limit) !== null && _o !== void 0 ? _o : 100;",
          "78:             queryParams.sort = Object.entries((_p = params.sort) !== null && _p !== void 0 ? _p : {}).map(function (_a) {",
          "",
          "---------------"
        ],
        "lib/core/pubnub-common.js||lib/core/pubnub-common.js": [
          "File: lib/core/pubnub-common.js -> lib/core/pubnub-common.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "427:                         customFields: params.include.customFields,",
          "428:                         UUIDFields: params.include.userFields,",
          "429:                         customUUIDFields: params.include.customUserFields,",
          "430:                         totalCount: params.include.totalCount,",
          "431:                     },",
          "432:                     sort: params.sort != null",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "430:                         statusField: params.include.statusField,",
          "431:                         UUIDStatusField: params.include.userStatusField,",
          "432:                         UUIDTypeField: params.include.userTypeField,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "460:                         customFields: params.include.customFields,",
          "461:                         channelFields: params.include.spaceFields,",
          "462:                         customChannelFields: params.include.customSpaceFields,",
          "463:                         totalCount: params.include.totalCount,",
          "464:                     },",
          "465:                     sort: params.sort != null",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "466:                         statusField: params.include.statusField,",
          "467:                         channelStatusField: params.include.spaceStatusField,",
          "468:                         channelTypeField: params.include.spaceTypeField,",
          "",
          "---------------"
        ],
        "src/core/components/config.js||src/core/components/config.js": [
          "File: src/core/components/config.js -> src/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "350:   }",
          "352:   getVersion() {",
          "354:   }",
          "356:   _addPnsdkSuffix(name, suffix) {",
          "",
          "[Removed Lines]",
          "353:     return '7.4.4';",
          "",
          "[Added Lines]",
          "353:     return '7.4.5';",
          "",
          "---------------"
        ],
        "src/core/components/subscription_manager.js||src/core/components/subscription_manager.js": [
          "File: src/core/components/subscription_manager.js -> src/core/components/subscription_manager.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "699:               decryptedData instanceof ArrayBuffer ? JSON.parse(this._decoder.decode(decryptedData)) : decryptedData;",
          "700:           } catch (e) {",
          "701:             decryptedPayload = null;",
          "705:           }",
          "706:           if (decryptedPayload !== null) {",
          "707:             msgPayload = decryptedPayload;",
          "",
          "[Removed Lines]",
          "702:             if (console && console.log) {",
          "703:               console.log('decryption error', e.message);",
          "704:             }",
          "",
          "[Added Lines]",
          "702:             announce.error = `Error while decrypting message content: ${e.message}`;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "752:               decryptedData instanceof ArrayBuffer ? JSON.parse(this._decoder.decode(decryptedData)) : decryptedData;",
          "753:           } catch (e) {",
          "754:             decryptedPayload = null;",
          "759:           }",
          "760:           if (decryptedPayload != null) {",
          "761:             announce.message = decryptedPayload;",
          "",
          "[Removed Lines]",
          "756:             if (console && console.log) {",
          "757:               console.log('decryption error', e.message); //eslint-disable-line",
          "758:             }",
          "",
          "[Added Lines]",
          "753:             announce.error = `Error while decrypting message content: ${e.message}`;",
          "",
          "---------------"
        ],
        "src/core/endpoints/fetch_messages.js||src/core/endpoints/fetch_messages.js": [
          "File: src/core/endpoints/fetch_messages.js -> src/core/endpoints/fetch_messages.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: import utils from '../utils';",
          "13: function __processMessage(modules, message) {",
          "15:   try {",
          "16:     const decryptedData = modules.cryptoModule.decrypt(message);",
          "17:     const decryptedPayload =",
          "18:       decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "20:   } catch (e) {",
          "23:   }",
          "24: }",
          "26: export function getOperation() {",
          "",
          "[Removed Lines]",
          "14:   if (!modules.cryptoModule) return message;",
          "19:     return decryptedPayload;",
          "21:     if (console && console.log) console.log('decryption error', e.message);",
          "22:     return message;",
          "",
          "[Added Lines]",
          "14:   const result = {};",
          "15:   if (!modules.cryptoModule) {",
          "16:     result.payload = message;",
          "17:     return result;",
          "18:   }",
          "23:     result.payload = decryptedPayload;",
          "24:     return result;",
          "26:     if (modules.config.logVerbosity && console && console.log) console.log('decryption error', e.message);",
          "27:     result.payload = message;",
          "28:     result.error = `Error while decrypting message content: ${e.message}`;",
          "30:   return result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "100:     (serverResponse.channels[channelName] || []).forEach((messageEnvelope) => {",
          "101:       const announce = {};",
          "102:       announce.channel = channelName;",
          "103:       announce.timetoken = messageEnvelope.timetoken;",
          "105:       announce.messageType = messageEnvelope.message_type;",
          "106:       announce.uuid = messageEnvelope.uuid;",
          "",
          "[Removed Lines]",
          "104:       announce.message = __processMessage(modules, messageEnvelope.message);",
          "",
          "[Added Lines]",
          "109:       const processedMessgeResult = __processMessage(modules, messageEnvelope.message);",
          "112:       announce.message = processedMessgeResult.payload;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "114:       if (messageEnvelope.meta) {",
          "115:         announce.meta = messageEnvelope.meta;",
          "116:       }",
          "118:       response.channels[channelName].push(announce);",
          "119:     });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:       if (processedMessgeResult.error) announce.error = processedMessgeResult.error;",
          "",
          "---------------"
        ],
        "src/core/endpoints/history/get_history.js||src/core/endpoints/history/get_history.js": [
          "File: src/core/endpoints/history/get_history.js -> src/core/endpoints/history/get_history.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: import utils from '../../utils';",
          "7: function __processMessage(modules, message) {",
          "9:   try {",
          "10:     const decryptedData = modules.cryptoModule.decrypt(message);",
          "11:     const decryptedPayload =",
          "12:       decryptedData instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decryptedData)) : decryptedData;",
          "14:   } catch (e) {",
          "17:   }",
          "18: }",
          "20: export function getOperation() {",
          "",
          "[Removed Lines]",
          "8:   if (!modules.cryptoModule) return message;",
          "13:     return decryptedPayload;",
          "15:     if (console && console.log) console.log('decryption error', e.message);",
          "16:     return message;",
          "",
          "[Added Lines]",
          "8:   const result = {};",
          "9:   if (!modules.cryptoModule) {",
          "10:     result.payload = message;",
          "11:     return result;",
          "12:   }",
          "17:     result.payload = decryptedPayload;",
          "18:     return result;",
          "20:     if (modules.config.logVerbosity && console && console.log) console.log('decryption error', e.message);",
          "21:     result.payload = message;",
          "22:     result.error = `Error while decrypting message content: ${e.message}`;",
          "24:   return result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69:   if (Array.isArray(serverResponse[0])) {",
          "70:     serverResponse[0].forEach((serverHistoryItem) => {",
          "71:       const item = {",
          "72:         timetoken: serverHistoryItem.timetoken,",
          "74:       };",
          "76:       if (serverHistoryItem.meta) {",
          "77:         item.meta = serverHistoryItem.meta;",
          "78:       }",
          "80:       response.messages.push(item);",
          "81:     });",
          "",
          "[Removed Lines]",
          "73:         entry: __processMessage(modules, serverHistoryItem.message),",
          "",
          "[Added Lines]",
          "78:       const processedMessgeResult = __processMessage(modules, serverHistoryItem.message);",
          "81:         entry: processedMessgeResult.payload,",
          "87:       if (processedMessgeResult.error) item.error = processedMessgeResult.error;",
          "",
          "---------------"
        ],
        "src/core/endpoints/objects/member/get.js||src/core/endpoints/objects/member/get.js": [
          "File: src/core/endpoints/objects/member/get.js -> src/core/endpoints/objects/member/get.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:   validateParams: (_, params) => {",
          "11:     if (!params?.channel) {",
          "13:     }",
          "14:   },",
          "",
          "[Removed Lines]",
          "12:       return 'UUID cannot be empty';",
          "",
          "[Added Lines]",
          "12:       return 'channel cannot be empty';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23:   prepareParams: (_modules, params) => {",
          "24:     const queryParams = {};",
          "27:     if (params?.include) {",
          "28:       if (params.include?.customFields) {",
          "29:         queryParams.include.push('custom');",
          "30:       }",
          "32:       if (params.include?.customUUIDFields) {",
          "33:         queryParams.include.push('uuid.custom');",
          "34:       }",
          "38:       }",
          "41:     queryParams.include = queryParams.include.join(',');",
          "43:     if (params?.include?.totalCount) {",
          "",
          "[Removed Lines]",
          "25:     queryParams.include = ['uuid.status', 'uuid.type', 'status'];",
          "36:       if (params.include?.UUIDFields ?? true) {",
          "37:         queryParams.include.push('uuid');",
          "39:     }",
          "",
          "[Added Lines]",
          "25:     queryParams.include = [];",
          "28:       if (params.include?.statusField) {",
          "29:         queryParams.include.push('status');",
          "30:       }",
          "36:       if (params.include?.UUIDFields) {",
          "37:         queryParams.include.push('uuid');",
          "38:       }",
          "44:       if (params.include?.UUIDStatusField) {",
          "45:         queryParams.include.push('uuid.status');",
          "48:       if (params.include?.UUIDTypeField) {",
          "49:         queryParams.include.push('uuid.type');",
          "50:       }",
          "51:     }",
          "",
          "---------------"
        ],
        "src/core/endpoints/objects/membership/get.js||src/core/endpoints/objects/membership/get.js": [
          "File: src/core/endpoints/objects/membership/get.js -> src/core/endpoints/objects/membership/get.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   prepareParams: (_modules, params) => {",
          "20:     const queryParams = {};",
          "23:     if (params?.include) {",
          "24:       if (params.include?.customFields) {",
          "25:         queryParams.include.push('custom');",
          "26:       }",
          "28:       if (params.include?.customChannelFields) {",
          "29:         queryParams.include.push('channel.custom');",
          "30:       }",
          "34:       }",
          "37:     queryParams.include = queryParams.include.join(',');",
          "39:     if (params?.include?.totalCount) {",
          "",
          "[Removed Lines]",
          "21:     queryParams.include = ['channel.status', 'channel.type', 'status'];",
          "32:       if (params.include?.channelFields) {",
          "33:         queryParams.include.push('channel');",
          "35:     }",
          "",
          "[Added Lines]",
          "21:     queryParams.include = [];",
          "24:       if (params.include?.statusField) {",
          "25:         queryParams.include.push('status');",
          "26:       }",
          "32:       if (params.include?.channelFields) {",
          "33:         queryParams.include.push('channel');",
          "34:       }",
          "40:       if (params.include?.channelStatusField) {",
          "41:         queryParams.include.push('channel.status');",
          "44:       if (params.include?.channelTypeField) {",
          "45:         queryParams.include.push('channel.type');",
          "46:       }",
          "47:     }",
          "",
          "---------------"
        ],
        "src/core/pubnub-common.js||src/core/pubnub-common.js": [
          "File: src/core/pubnub-common.js -> src/core/pubnub-common.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "623:               customFields: params.include.customFields,",
          "624:               UUIDFields: params.include.userFields,",
          "625:               customUUIDFields: params.include.customUserFields,",
          "626:               totalCount: params.include.totalCount,",
          "627:             },",
          "628:             sort:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "626:               statusField: params.include.statusField,",
          "627:               UUIDStatusField: params.include.userStatusField,",
          "628:               UUIDTypeField: params.include.userTypeField,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "652:               customFields: params.include.customFields,",
          "653:               channelFields: params.include.spaceFields,",
          "654:               customChannelFields: params.include.customSpaceFields,",
          "655:               totalCount: params.include.totalCount,",
          "656:             },",
          "657:             sort:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "658:               statusField: params.include.statusField,",
          "659:               channelStatusField: params.include.spaceStatusField,",
          "660:               channelTypeField: params.include.spaceTypeField,",
          "",
          "---------------"
        ],
        "test/integration/components/subscription_manager.test.js||test/integration/components/subscription_manager.test.js": [
          "File: test/integration/components/subscription_manager.test.js -> test/integration/components/subscription_manager.test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "12:   let pubnub;",
          "13:   let pubnubWithPassingHeartbeats;",
          "14:   let pubnubWithLimitedQueue;",
          "16:   before(() => {",
          "17:     nock.disableNetConnect();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15:   let pubnubWithCrypto;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "46:       autoNetworkDetection: false,",
          "47:       heartbeatInterval: 149,",
          "48:     });",
          "49:   });",
          "51:   afterEach(() => {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "50:     pubnubWithCrypto = new PubNub({",
          "51:       subscribeKey: 'mySubKey',",
          "52:       publishKey: 'myPublishKey',",
          "53:       uuid: 'myUUID',",
          "54:       cryptoModule: PubNub.CryptoModule.aesCbcCryptoModule({ cipherKey: 'cipherKey' }),",
          "55:     });",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "653:       }",
          "654:     }, 250);",
          "655:   });",
          "656: });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "664:   it('handles unencrypted message when cryptoModule is configured', (done) => {",
          "665:     const scope = utils",
          "666:       .createNock()",
          "667:       .get('/v2/subscribe/mySubKey/ch1/0')",
          "668:       .query({",
          "669:         pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "670:         uuid: 'myUUID',",
          "671:         heartbeat: 300,",
          "672:       })",
          "673:       .reply(",
          "674:         200,",
          "675:         '{\"t\":{\"t\":\"3\",\"r\":1},\"m\":[{\"a\":\"4\",\"f\":0,\"i\":\"Client-g5d4g\",\"p\":{\"t\":\"14607577960925503\",\"r\":1}, \"i\": \"client1\", \"k\":\"sub-c-4cec9f8e-01fa-11e6-8180-0619f8945a4f\",\"c\":\"coolChannel\",\"d\":\"hello\",\"b\":\"coolChan-bnel\"}]}',",
          "676:       );",
          "678:     let incomingPayloads = [];",
          "680:     pubnubWithCrypto.addListener({",
          "681:       message(messagePayload) {",
          "682:         incomingPayloads.push(messagePayload);",
          "683:         if (incomingPayloads.length === 1) {",
          "684:           assert.equal(scope.isDone(), true);",
          "685:           assert.deepEqual(incomingPayloads, [",
          "686:             {",
          "687:               actualChannel: 'coolChannel',",
          "688:               message: 'hello',",
          "689:               subscribedChannel: 'coolChan-bnel',",
          "690:               channel: 'coolChannel',",
          "691:               subscription: 'coolChan-bnel',",
          "692:               timetoken: '14607577960925503',",
          "693:               publisher: 'client1',",
          "694:               error: 'Error while decrypting message content: decryption error. invalid header version',",
          "695:             },",
          "696:           ]);",
          "697:           done();",
          "698:         }",
          "699:       },",
          "700:     });",
          "702:     pubnubWithCrypto.subscribe({ channels: ['ch1'] });",
          "703:   });",
          "705:   it('handles unencrypted message when `setCipherKey()` is used', (done) => {",
          "706:     pubnub.setCipherKey('hello');",
          "707:     const scope = utils",
          "708:       .createNock()",
          "709:       .get('/v2/subscribe/mySubKey/ch1/0')",
          "710:       .query({",
          "711:         pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "712:         uuid: 'myUUID',",
          "713:         heartbeat: 300,",
          "714:       })",
          "715:       .reply(",
          "716:         200,",
          "717:         '{\"t\":{\"t\":\"3\",\"r\":1},\"m\":[{\"a\":\"4\",\"f\":0,\"i\":\"Client-g5d4g\",\"p\":{\"t\":\"14607577960925503\",\"r\":1}, \"i\": \"client1\", \"k\":\"sub-c-4cec9f8e-01fa-11e6-8180-0619f8945a4f\",\"c\":\"coolChannel\",\"d\":\"hello\",\"b\":\"coolChan-bnel\"}]}',",
          "718:       );",
          "720:     let incomingPayloads = [];",
          "722:     pubnubWithCrypto.addListener({",
          "723:       message(messagePayload) {",
          "724:         incomingPayloads.push(messagePayload);",
          "725:         console.log('\\n\\n\\n incomingpayload = ', JSON.stringify(incomingPayloads));",
          "726:         if (incomingPayloads.length === 1) {",
          "727:           assert.equal(scope.isDone(), true);",
          "728:           assert.deepEqual(incomingPayloads, [",
          "729:             {",
          "730:               actualChannel: 'coolChannel',",
          "731:               message: 'hello',",
          "732:               subscribedChannel: 'coolChan-bnel',",
          "733:               channel: 'coolChannel',",
          "734:               subscription: 'coolChan-bnel',",
          "735:               timetoken: '14607577960925503',",
          "736:               publisher: 'client1',",
          "737:               error: 'Error while decrypting message content: decryption error. invalid header version',",
          "738:             },",
          "739:           ]);",
          "740:           done();",
          "741:         }",
          "742:       },",
          "743:     });",
          "745:     pubnubWithCrypto.subscribe({ channels: ['ch1'] });",
          "746:   });",
          "748:   it('handles encryped messages when cryptoModule is configured', (done) => {",
          "749:     const scope = utils",
          "750:       .createNock()",
          "751:       .get('/v2/subscribe/mySubKey/ch1/0')",
          "752:       .query({",
          "753:         pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "754:         uuid: 'myUUID',",
          "755:         heartbeat: 300,",
          "756:       })",
          "757:       .reply(",
          "758:         200,",
          "759:         '{\"t\":{\"t\":\"3\",\"r\":1},\"m\":[{\"a\":\"4\",\"f\":0,\"i\":\"Client-g5d4g\",\"p\":{\"t\":\"14607577960925503\",\"r\":1}, \"i\": \"client1\", \"k\":\"sub-c-4cec9f8e-01fa-11e6-8180-0619f8945a4f\",\"c\":\"coolChannel\",\"d\":\"UE5FRAFBQ1JIEIocqA6BfaybN/3U0WJRam0v3bPwfAXezgeCeGp+MztQ\",\"b\":\"coolChan-bnel\"}]}',",
          "760:       );",
          "762:     let incomingPayloads = [];",
          "764:     pubnubWithCrypto.addListener({",
          "765:       message(messagePayload) {",
          "766:         incomingPayloads.push(messagePayload);",
          "767:         if (incomingPayloads.length === 1) {",
          "768:           assert.equal(scope.isDone(), true);",
          "769:           assert.deepEqual(incomingPayloads, [",
          "770:             {",
          "771:               actualChannel: 'coolChannel',",
          "772:               message: 'hello',",
          "773:               subscribedChannel: 'coolChan-bnel',",
          "774:               channel: 'coolChannel',",
          "775:               subscription: 'coolChan-bnel',",
          "776:               timetoken: '14607577960925503',",
          "777:               publisher: 'client1',",
          "778:             },",
          "779:           ]);",
          "780:           done();",
          "781:         }",
          "782:       },",
          "783:     });",
          "785:     pubnubWithCrypto.subscribe({ channels: ['ch1'] });",
          "786:   });",
          "",
          "---------------"
        ],
        "test/integration/endpoints/fetch_messages.test.js||test/integration/endpoints/fetch_messages.test.js": [
          "File: test/integration/endpoints/fetch_messages.test.js -> test/integration/endpoints/fetch_messages.test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: import utils from '../../utils';",
          "7: import PubNub from '../../../src/node/index';",
          "10:   let publishCompleted = 0;",
          "11:   let messages = [];",
          "",
          "[Removed Lines]",
          "9: function publishMessagesToChannel(client        , count        , channel        , completion          ) {",
          "",
          "[Added Lines]",
          "9: function publishMessagesToChannel(client, count, channel, completion) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "38:   publish(publishCompleted);",
          "39: }",
          "48:   const types = ['reaction', 'receipt', 'custom'];",
          "49:   const values = [",
          "50:     PubNub.generateUUID(),",
          "",
          "[Removed Lines]",
          "41: function addActionsInChannel(",
          "42:   client        ,",
          "43:   count        ,",
          "44:   messageTimetokens               ,",
          "45:   channel        ,",
          "46:   completion",
          "47: ) {",
          "",
          "[Added Lines]",
          "41: function addActionsInChannel(client, count, messageTimetokens, channel, completion) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "562:       done();",
          "563:       });",
          "564:   });",
          "565: });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "560:   it('handles unencrypted payload when cryptomodule configured', (done) => {",
          "561:     nock.disableNetConnect();",
          "562:     const scope = utils",
          "563:       .createNock()",
          "564:       .get(`/v3/history/sub-key/${subscribeKey}/channel/ch1`)",
          "565:       .query({",
          "566:         max: '10',",
          "567:         pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "568:         uuid: 'myUUID',",
          "569:         include_uuid: 'true',",
          "570:         include_message_type: 'true',",
          "571:       })",
          "572:       .reply(",
          "573:         200,",
          "574:         '{ \"channels\": { \"ch1\": [{\"message\":\"hello\",\"timetoken\":\"11\"}, {\"message\":\"hey\",\"timetoken\":\"12\"}] } }',",
          "575:       );",
          "577:     pubnub.setCipherKey('cipherKey');",
          "578:     pubnub.fetchMessages({ channels: ['ch1'], count: 10 }, (status, response) => {",
          "579:       assert.equal(status.error, false);",
          "580:       assert.deepEqual(response, {",
          "581:         channels: {",
          "582:           ch1: [",
          "583:             {",
          "584:               channel: 'ch1',",
          "585:               message: 'hello',",
          "586:               timetoken: '11',",
          "587:               messageType: undefined,",
          "588:               uuid: undefined,",
          "589:               error: 'Error while decrypting message content: decryption error. invalid header version',",
          "590:             },",
          "591:             {",
          "592:               channel: 'ch1',",
          "593:               message: 'hey',",
          "594:               timetoken: '12',",
          "595:               messageType: undefined,",
          "596:               uuid: undefined,",
          "597:               error: 'Error while decrypting message content: decryption error. invalid header version',",
          "598:             },",
          "599:           ],",
          "600:         },",
          "601:       });",
          "602:       assert.equal(scope.isDone(), true);",
          "603:       done();",
          "604:     });",
          "605:   });",
          "",
          "---------------"
        ],
        "test/integration/endpoints/history.test.js||test/integration/endpoints/history.test.js": [
          "File: test/integration/endpoints/history.test.js -> test/integration/endpoints/history.test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: import utils from '../../utils';",
          "7: import PubNub from '../../../src/node/index';",
          "10:   let publishCompleted = 0;",
          "11:   let messages = [];",
          "",
          "[Removed Lines]",
          "9: function publishMessagesToChannel(client        , count        , channel        , completion          ) {",
          "",
          "[Added Lines]",
          "9: function publishMessagesToChannel(client, count, channel, completion) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61:       subscribeKey,",
          "62:       publishKey,",
          "63:       uuid: 'myUUID',",
          "65:     });",
          "66:   });",
          "",
          "[Removed Lines]",
          "64:       useRandomIVs: false",
          "",
          "[Added Lines]",
          "63:       useRandomIVs: false,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:       })",
          "80:       .reply(",
          "81:         200,",
          "83:       );",
          "99:   });",
          "101:   it('supports encrypted payload with timetoken', (done) => {",
          "",
          "[Removed Lines]",
          "82:         '[[{\"message\":{\"text\":\"hey\"},\"timetoken\":\"14648503433058358\"},{\"message\":{\"text2\":\"hey2\"},\"timetoken\":\"14648503433058359\"}],\"14648503433058358\",\"14649346364851578\"]'",
          "85:     pubnub.history(",
          "86:       { channel: 'ch1', stringifiedTimeToken: true },",
          "87:       (status, response) => {",
          "88:         assert.equal(status.error, false);",
          "89:         assert.deepEqual(response.startTimeToken, '14648503433058358');",
          "90:         assert.deepEqual(response.endTimeToken, '14649346364851578');",
          "91:         assert.deepEqual(response.messages, [",
          "92:           { timetoken: '14648503433058358', entry: { text: 'hey' } },",
          "93:           { timetoken: '14648503433058359', entry: { text2: 'hey2' } },",
          "94:         ]);",
          "95:         assert.equal(scope.isDone(), true);",
          "96:         done();",
          "97:       }",
          "98:     );",
          "",
          "[Added Lines]",
          "81:         '[[{\"message\":{\"text\":\"hey\"},\"timetoken\":\"14648503433058358\"},{\"message\":{\"text2\":\"hey2\"},\"timetoken\":\"14648503433058359\"}],\"14648503433058358\",\"14649346364851578\"]',",
          "84:     pubnub.history({ channel: 'ch1', stringifiedTimeToken: true }, (status, response) => {",
          "85:       assert.equal(status.error, false);",
          "86:       assert.deepEqual(response.startTimeToken, '14648503433058358');",
          "87:       assert.deepEqual(response.endTimeToken, '14649346364851578');",
          "88:       assert.deepEqual(response.messages, [",
          "89:         { timetoken: '14648503433058358', entry: { text: 'hey' } },",
          "90:         { timetoken: '14648503433058359', entry: { text2: 'hey2' } },",
          "91:       ]);",
          "92:       assert.equal(scope.isDone(), true);",
          "93:       done();",
          "94:     });",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "112:       })",
          "113:       .reply(",
          "114:         200,",
          "116:       );",
          "118:     pubnub.setCipherKey('cipherKey');",
          "133:   });",
          "135:   it('supports metadata', (done) => {",
          "",
          "[Removed Lines]",
          "115:         '[[{\"message\":\"zFJeF9BVABL80GUiQEBjLg==\",\"timetoken\":\"14649369736959785\"},{\"message\":\"HIq4MTi9nk/KEYlHOKpMCaH78ZXppGynDHrgY9nAd3s=\",\"timetoken\":\"14649369766426772\"}],\"14649369736959785\",\"14649369766426772\"]'",
          "119:     pubnub.history(",
          "120:       { channel: 'ch1', stringifiedTimeToken: true },",
          "121:       (status, response) => {",
          "122:         assert.equal(status.error, false);",
          "123:         assert.deepEqual(response.startTimeToken, '14649369736959785');",
          "124:         assert.deepEqual(response.endTimeToken, '14649369766426772');",
          "125:         assert.deepEqual(response.messages, [",
          "126:           { timetoken: '14649369736959785', entry: { text: 'hey' } },",
          "127:           { timetoken: '14649369766426772', entry: { text2: 'hey2' } },",
          "128:         ]);",
          "129:         assert.equal(scope.isDone(), true);",
          "130:         done();",
          "131:       }",
          "132:     );",
          "",
          "[Added Lines]",
          "111:         '[[{\"message\":\"zFJeF9BVABL80GUiQEBjLg==\",\"timetoken\":\"14649369736959785\"},{\"message\":\"HIq4MTi9nk/KEYlHOKpMCaH78ZXppGynDHrgY9nAd3s=\",\"timetoken\":\"14649369766426772\"}],\"14649369736959785\",\"14649369766426772\"]',",
          "115:     pubnub.history({ channel: 'ch1', stringifiedTimeToken: true }, (status, response) => {",
          "116:       assert.equal(status.error, false);",
          "117:       assert.deepEqual(response.startTimeToken, '14649369736959785');",
          "118:       assert.deepEqual(response.endTimeToken, '14649369766426772');",
          "119:       assert.deepEqual(response.messages, [",
          "120:         { timetoken: '14649369736959785', entry: { text: 'hey' } },",
          "121:         { timetoken: '14649369766426772', entry: { text2: 'hey2' } },",
          "122:       ]);",
          "123:       assert.equal(scope.isDone(), true);",
          "124:       done();",
          "125:     });",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "153:     const average = Math.floor(countedDelays.reduce((acc, delay) => acc + delay, 0) / countedDelays.length);",
          "154:     const leeway = 50;",
          "166:       .then((lastRequest) => {",
          "167:         utils.verifyRequestTelemetry(lastRequest.path, 'l_hist', average, leeway);",
          "168:         done();",
          "169:       });",
          "170:   }).timeout(60000);",
          "171: });",
          "",
          "[Removed Lines]",
          "156:     utils.runAPIWithResponseDelays(scope,",
          "157:       200,",
          "158:       '[[{\"message\":{\"text\":\"hey\"},\"timetoken\":\"14648503433058358\"},{\"message\":{\"text2\":\"hey2\"},\"timetoken\":\"14648503433058359\"}],\"14648503433058358\",\"14649346364851578\"]',",
          "159:       delays,",
          "160:       (completion) => {",
          "161:         pubnub.history(",
          "162:           { channel: 'ch1', stringifiedTimeToken: true },",
          "163:           () => { completion(); }",
          "164:         );",
          "165:       })",
          "",
          "[Added Lines]",
          "149:     utils",
          "150:       .runAPIWithResponseDelays(",
          "151:         scope,",
          "152:         200,",
          "153:         '[[{\"message\":{\"text\":\"hey\"},\"timetoken\":\"14648503433058358\"},{\"message\":{\"text2\":\"hey2\"},\"timetoken\":\"14648503433058359\"}],\"14648503433058358\",\"14649346364851578\"]',",
          "154:         delays,",
          "155:         (completion) => {",
          "156:           pubnub.history({ channel: 'ch1', stringifiedTimeToken: true }, () => {",
          "157:             completion();",
          "158:           });",
          "159:         },",
          "160:       )",
          "167:   it('handles unencrypted payload with cryptoModule', (done) => {",
          "168:     nock.disableNetConnect();",
          "169:     const scope = utils",
          "170:       .createNock()",
          "171:       .get(`/v2/history/sub-key/${subscribeKey}/channel/ch1`)",
          "172:       .query({",
          "173:         count: '100',",
          "174:         include_token: 'true',",
          "175:         pnsdk: `PubNub-JS-Nodejs/${pubnub.getVersion()}`,",
          "176:         uuid: 'myUUID',",
          "177:         string_message_token: true,",
          "178:       })",
          "179:       .reply(",
          "180:         200,",
          "181:         '[[{\"message\":\"zFJeF9BVABL80GUiQEBjLg==\",\"timetoken\":\"14648503433058358\"},{\"message\":\"hello\",\"timetoken\":\"14648503433058359\"}],\"14648503433058358\",\"14649346364851578\"]',",
          "182:       );",
          "183:     pubnub.setCipherKey('cipherKey');",
          "184:     pubnub.history({ channel: 'ch1', stringifiedTimeToken: true }, (status, response) => {",
          "185:       assert.equal(status.error, false);",
          "186:       assert.deepEqual(response.startTimeToken, '14648503433058358');",
          "187:       assert.deepEqual(response.endTimeToken, '14649346364851578');",
          "188:       assert.deepEqual(response.messages, [",
          "189:         { timetoken: '14648503433058358', entry: { text: 'hey' } },",
          "190:         {",
          "191:           timetoken: '14648503433058359',",
          "192:           entry: 'hello',",
          "193:           error: 'Error while decrypting message content: decryption error. invalid header version',",
          "194:         },",
          "195:       ]);",
          "196:       assert.equal(scope.isDone(), true);",
          "197:       done();",
          "198:     });",
          "199:   });",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3eca7d2a7ce5e40bc7e4d580eeea39e5dbf2a157",
      "candidate_info": {
        "commit_hash": "3eca7d2a7ce5e40bc7e4d580eeea39e5dbf2a157",
        "repo": "pubnub/javascript",
        "commit_url": "https://github.com/pubnub/javascript/commit/3eca7d2a7ce5e40bc7e4d580eeea39e5dbf2a157",
        "files": [
          ".pubnub.yml",
          "CHANGELOG.md",
          "README.md",
          "dist/web/pubnub.js",
          "dist/web/pubnub.min.js",
          "lib/core/components/config.js",
          "lib/core/pubnub-common.js",
          "package.json",
          "src/core/components/config.js",
          "src/core/pubnub-common.js",
          "test/integration/components/crypto.test.js"
        ],
        "message": "fix: pubnub.decrypt() function to return correct data format (#342)\n\n* fix: pubnub.decrypt() function to return correct data format\n\n* PubNub SDK v7.4.1 release.\n\n---------\n\nCo-authored-by: PubNub Release Bot <120067856+pubnub-release-bot@users.noreply.github.com>",
        "before_after_code_files": [
          "dist/web/pubnub.js||dist/web/pubnub.js",
          "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
          "lib/core/components/config.js||lib/core/components/config.js",
          "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
          "src/core/components/config.js||src/core/components/config.js",
          "src/core/pubnub-common.js||src/core/pubnub-common.js",
          "test/integration/components/crypto.test.js||test/integration/components/crypto.test.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
            "src/core/components/config.js||src/core/components/config.js",
            "src/core/pubnub-common.js||src/core/pubnub-common.js"
          ],
          "candidate": [
            "dist/web/pubnub.js||dist/web/pubnub.js",
            "dist/web/pubnub.min.js||dist/web/pubnub.min.js",
            "lib/core/components/config.js||lib/core/components/config.js",
            "lib/core/pubnub-common.js||lib/core/pubnub-common.js",
            "src/core/components/config.js||src/core/components/config.js",
            "src/core/pubnub-common.js||src/core/pubnub-common.js"
          ]
        }
      },
      "candidate_diff": {
        "dist/web/pubnub.js||dist/web/pubnub.js": [
          "File: dist/web/pubnub.js -> dist/web/pubnub.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "791:             return this;",
          "792:         };",
          "793:         default_1.prototype.getVersion = function () {",
          "795:         };",
          "796:         default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "797:             this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "794:             return '7.4.0';",
          "",
          "[Added Lines]",
          "794:             return '7.4.1';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "7843:             this.decrypt = function (data, key) {",
          "7844:                 if (typeof key === 'undefined' && cryptoModule) {",
          "7845:                     var decrypted = modules.cryptoModule.decrypt(data);",
          "7847:                 }",
          "7848:                 else {",
          "7849:                     return crypto.decrypt(data, key);",
          "",
          "[Removed Lines]",
          "7846:                     return decrypted instanceof ArrayBuffer ? encode$1(decrypted) : decrypted;",
          "",
          "[Added Lines]",
          "7846:                     return decrypted instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decrypted)) : decrypted;",
          "",
          "---------------"
        ],
        "dist/web/pubnub.min.js||dist/web/pubnub.min.js": [
          "File: dist/web/pubnub.min.js -> dist/web/pubnub.min.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:     PERFORMANCE OF THIS SOFTWARE.",
          "",
          "[Removed Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.0\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?v(n):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:(n=this.getFileData(e.data),[4,this.defaultCryptor.encryptFileData(n)]);case 1:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:(s=this.getFileData(r),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})]);case 2:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){if(t instanceof ArrayBuffer)return t;if(\"string\"==typeof t)return e.encoder.encode(t);throw new Error(\"Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer\")},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
          "",
          "[Added Lines]",
          "17: !function(e,t){!function(e){var t=\"0.1.0\",n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function r(){var e,t,n=\"\";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+=\"-\"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function o(e,t){var r=n[t||\"all\"];return r&&r.test(e)||!1}r.isUUID=o,r.VERSION=t,e.uuid=r,e.isUUID=o}(t),null!==e&&(e.exports=t.uuid)}(h,h.exports);var d=h.exports,y=function(){return d.uuid?d.uuid():d()},g=function(){function e(e){var t,n,r,o=e.setup;if(this._PNSDKSuffix={},this.instanceId=\"pn-\".concat(y()),this.secretKey=o.secretKey||o.secret_key,this.subscribeKey=o.subscribeKey||o.subscribe_key,this.publishKey=o.publishKey||o.publish_key,this.sdkName=o.sdkName,this.sdkFamily=o.sdkFamily,this.partnerId=o.partnerId,this.setAuthKey(o.authKey),this.cryptoModule=o.cryptoModule,this.setFilterExpression(o.filterExpression),\"string\"!=typeof o.origin&&!Array.isArray(o.origin)&&void 0!==o.origin)throw new Error(\"Origin must be either undefined, a string or a list of strings.\");if(this.origin=o.origin||Array.from({length:20},(function(e,t){return\"ps\".concat(t+1,\".pndsn.com\")})),this.secure=o.ssl||!1,this.restore=o.restore||!1,this.proxy=o.proxy,this.keepAlive=o.keepAlive,this.keepAliveSettings=o.keepAliveSettings,this.autoNetworkDetection=o.autoNetworkDetection||!1,this.dedupeOnSubscribe=o.dedupeOnSubscribe||!1,this.maximumCacheSize=o.maximumCacheSize||100,this.customEncrypt=o.customEncrypt,this.customDecrypt=o.customDecrypt,this.fileUploadPublishRetryLimit=null!==(t=o.fileUploadPublishRetryLimit)&&void 0!==t?t:5,this.useRandomIVs=null===(n=o.useRandomIVs)||void 0===n||n,this.enableSubscribeBeta=null!==(r=o.enableSubscribeBeta)&&void 0!==r&&r,\"undefined\"!=typeof location&&\"https:\"===location.protocol&&(this.secure=!0),this.logVerbosity=o.logVerbosity||!1,this.suppressLeaveEvents=o.suppressLeaveEvents||!1,this.announceFailedHeartbeats=o.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=o.announceSuccessfulHeartbeats||!1,this.useInstanceId=o.useInstanceId||!1,this.useRequestId=o.useRequestId||!1,this.requestMessageCountThreshold=o.requestMessageCountThreshold,this.setTransactionTimeout(o.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(o.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(o.useSendBeacon||!0),o.presenceTimeout?this.setPresenceTimeout(o.presenceTimeout):this._presenceTimeout=300,null!=o.heartbeatInterval&&this.setHeartbeatInterval(o.heartbeatInterval),\"string\"==typeof o.userId){if(\"string\"==typeof o.uuid)throw new Error(\"Only one of the following configuration options has to be provided: `uuid` or `userId`\");this.setUserId(o.userId)}else{if(\"string\"!=typeof o.uuid)throw new Error(\"One of the following configuration options has to be provided: `uuid` or `userId`\");this.setUUID(o.uuid)}this.setCipherKey(o.cipherKey,o)}return e.prototype.getAuthKey=function(){return this.authKey},e.prototype.setAuthKey=function(e){return this.authKey=e,this},e.prototype.setCipherKey=function(e,t,n){var r;return this.cipherKey=e,this.cipherKey&&(this.cryptoModule=null!==(r=t.cryptoModule)&&void 0!==r?r:t.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),n&&(n.cryptoModule=this.cryptoModule)),this},e.prototype.getUUID=function(){return this.UUID},e.prototype.setUUID=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing uuid parameter. Provide a valid string uuid\");return this.UUID=e,this},e.prototype.getUserId=function(){return this.UUID},e.prototype.setUserId=function(e){if(!e||\"string\"!=typeof e||0===e.trim().length)throw new Error(\"Missing or invalid userId parameter. Provide a valid string userId\");return this.UUID=e,this},e.prototype.getFilterExpression=function(){return this.filterExpression},e.prototype.setFilterExpression=function(e){return this.filterExpression=e,this},e.prototype.getPresenceTimeout=function(){return this._presenceTimeout},e.prototype.setPresenceTimeout=function(e){return e>=20?this._presenceTimeout=e:(this._presenceTimeout=20,console.log(\"WARNING: Presence timeout is less than the minimum. Using minimum value: \",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},e.prototype.setProxy=function(e){this.proxy=e},e.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},e.prototype.setHeartbeatInterval=function(e){return this._heartbeatInterval=e,this},e.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},e.prototype.setSubscribeTimeout=function(e){return this._subscribeRequestTimeout=e,this},e.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},e.prototype.setTransactionTimeout=function(e){return this._transactionalRequestTimeout=e,this},e.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},e.prototype.setSendBeaconConfig=function(e){return this._useSendBeacon=e,this},e.prototype.getVersion=function(){return\"7.4.1\"},e.prototype._addPnsdkSuffix=function(e,t){this._PNSDKSuffix[e]=t},e.prototype._getPnsdkSuffix=function(e){var t=this;return Object.keys(this._PNSDKSuffix).reduce((function(n,r){return n+e+t._PNSDKSuffix[r]}),\"\")},e}();function b(e){var t=e.replace(/==?$/,\"\"),n=Math.floor(t.length/4*3),r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;function a(){var e=t.charAt(i++),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(e);if(-1===n)throw new Error(\"Illegal character at \".concat(i,\": \").concat(t.charAt(i-1)));return n}for(var s=0;s<n;s+=3){var u=a(),c=a(),l=a(),p=a(),f=(63&u)<<2|c>>4,h=(15&c)<<4|l>>2,d=(3&l)<<6|p>>0;o[s]=f,64!=l&&(o[s+1]=h),64!=p&&(o[s+2]=d)}return r}function v(e){for(var t,n=\"\",r=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",o=new Uint8Array(e),i=o.byteLength,a=i%3,s=i-a,u=0;u<s;u+=3)n+=r[(16515072&(t=o[u]<<16|o[u+1]<<8|o[u+2]))>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==a?n+=r[(252&(t=o[s]))>>2]+r[(3&t)<<4]+\"==\":2==a&&(n+=r[(64512&(t=o[s]<<8|o[s+1]))>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+\"=\"),n}var m,_,O,S,P,w=w||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty(\"init\")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty(\"toString\")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join(\"\")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error(\"Malformed UTF-8 data\")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){\"string\"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=w,n=(o=t.lib).WordArray,r=o.Hasher,o=t.algo,i=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var p=e.sqrt(l),f=2;f<=p;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>c&&(i[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var h=[];o=o.SHA256=r.extend({_doReset:function(){this._hash=new n.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=n[5],l=n[6],p=n[7],f=0;64>f;f++){if(16>f)h[f]=0|e[t+f];else{var d=h[f-15],y=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[f-16]}d=p+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+h[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=l,l=c,c=u,u=s+d|0,s=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(o),t.HmacSHA256=r._createHmacHelper(o)}(Math),_=(m=w).enc.Utf8,m.algo.HMAC=m.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,\"string\"==typeof t&&(t=_.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,s=i.words,u=0;u<n;u++)a[u]^=1549556828,s[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),S=(O=w).lib.WordArray,O.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join(\"\")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return S.create(r,o)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"},function(e){function t(e,t,n,r,o,i,a){return((e=e+(t&n|~t&r)+o+a)<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,a){return((e=e+(t&r|n&~r)+o+a)<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,a){return((e=e+(t^n^r)+o+a)<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,a){return((e=e+(n^(t|~r))+o+a)<<i|e>>>32-i)+t}for(var i=w,a=(u=i.lib).WordArray,s=u.Hasher,u=i.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var a=0;16>a;a++){var s=e[u=i+a];e[u]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var u=e[i+0],l=(s=e[i+1],e[i+2]),p=e[i+3],f=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],g=e[i+8],b=e[i+9],v=e[i+10],m=e[i+11],_=e[i+12],O=e[i+13],S=e[i+14],P=e[i+15],w=t(w=a[0],A=a[1],T=a[2],E=a[3],u,7,c[0]),E=t(E,w,A,T,s,12,c[1]),T=t(T,E,w,A,l,17,c[2]),A=t(A,T,E,w,p,22,c[3]);w=t(w,A,T,E,f,7,c[4]),E=t(E,w,A,T,h,12,c[5]),T=t(T,E,w,A,d,17,c[6]),A=t(A,T,E,w,y,22,c[7]),w=t(w,A,T,E,g,7,c[8]),E=t(E,w,A,T,b,12,c[9]),T=t(T,E,w,A,v,17,c[10]),A=t(A,T,E,w,m,22,c[11]),w=t(w,A,T,E,_,7,c[12]),E=t(E,w,A,T,O,12,c[13]),T=t(T,E,w,A,S,17,c[14]),w=n(w,A=t(A,T,E,w,P,22,c[15]),T,E,s,5,c[16]),E=n(E,w,A,T,d,9,c[17]),T=n(T,E,w,A,m,14,c[18]),A=n(A,T,E,w,u,20,c[19]),w=n(w,A,T,E,h,5,c[20]),E=n(E,w,A,T,v,9,c[21]),T=n(T,E,w,A,P,14,c[22]),A=n(A,T,E,w,f,20,c[23]),w=n(w,A,T,E,b,5,c[24]),E=n(E,w,A,T,S,9,c[25]),T=n(T,E,w,A,p,14,c[26]),A=n(A,T,E,w,g,20,c[27]),w=n(w,A,T,E,O,5,c[28]),E=n(E,w,A,T,l,9,c[29]),T=n(T,E,w,A,y,14,c[30]),w=r(w,A=n(A,T,E,w,_,20,c[31]),T,E,h,4,c[32]),E=r(E,w,A,T,g,11,c[33]),T=r(T,E,w,A,m,16,c[34]),A=r(A,T,E,w,S,23,c[35]),w=r(w,A,T,E,s,4,c[36]),E=r(E,w,A,T,f,11,c[37]),T=r(T,E,w,A,y,16,c[38]),A=r(A,T,E,w,v,23,c[39]),w=r(w,A,T,E,O,4,c[40]),E=r(E,w,A,T,u,11,c[41]),T=r(T,E,w,A,p,16,c[42]),A=r(A,T,E,w,d,23,c[43]),w=r(w,A,T,E,b,4,c[44]),E=r(E,w,A,T,_,11,c[45]),T=r(T,E,w,A,P,16,c[46]),w=o(w,A=r(A,T,E,w,l,23,c[47]),T,E,u,6,c[48]),E=o(E,w,A,T,y,10,c[49]),T=o(T,E,w,A,S,15,c[50]),A=o(A,T,E,w,h,21,c[51]),w=o(w,A,T,E,_,6,c[52]),E=o(E,w,A,T,p,10,c[53]),T=o(T,E,w,A,v,15,c[54]),A=o(A,T,E,w,s,21,c[55]),w=o(w,A,T,E,g,6,c[56]),E=o(E,w,A,T,P,10,c[57]),T=o(T,E,w,A,d,15,c[58]),A=o(A,T,E,w,O,21,c[59]),w=o(w,A,T,E,f,6,c[60]),E=o(E,w,A,T,m,10,c[61]),T=o(T,E,w,A,l,15,c[62]),A=o(A,T,E,w,b,21,c[63]);a[0]=a[0]+w|0,a[1]=a[1]+A|0,a[2]=a[2]+T|0,a[3]=a[3]+E|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=s._createHelper(u),i.HmacMD5=s._createHmacHelper(u)}(Math),function(){var e,t=w,n=(e=t.lib).Base,r=e.WordArray,o=(e=t.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=(s=this.cfg).hasher.create(),o=r.create(),i=o.words,a=s.keySize,s=s.iterations;i.length<a;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var c=1;c<s;c++)u=n.finalize(u),n.reset();o.concat(u)}return o.sigBytes=4*a,o}});t.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),w.lib.Cipher||function(e){var t=(h=w).lib,n=t.Base,r=t.WordArray,o=t.BufferedBlockAlgorithm,i=h.enc.Base64,a=h.algo.EvpKDF,s=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return(\"string\"==typeof n?d:f).encrypt(e,t,n,r)},decrypt:function(t,n,r){return(\"string\"==typeof n?d:f).decrypt(e,t,n,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=h.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=r[o]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=o}}),u=u.CBC=l,l=(h.pad={}).Pkcs7={pad:function(e,t){for(var n,o=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);n=r.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:u,padding:l}),reset:function(){s.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,p.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return\"string\"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,n,o){return o||(o=r.random(8)),e=a.create({keySize:t+n}).compute(e,o),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:o})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:h}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=f.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,f.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=w,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],s=[],u=[],c=[],l=[],p=[],f=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;var y=0,g=0;for(d=0;256>d;d++){var b=(b=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&b^99;r[y]=b,o[b]=y;var v=h[y],m=h[v],_=h[m],O=257*h[b]^16843008*b;i[y]=O<<24|O>>>8,a[y]=O<<16|O>>>16,s[y]=O<<8|O>>>24,u[y]=O,O=16843009*_^65537*m^257*v^16843008*y,c[b]=O<<24|O>>>8,l[b]=O<<16|O>>>16,p[b]=O<<8|O>>>24,f[b]=O,y?(y=v^h[h[h[_^v]]],g^=h[h[g]]):y=g=1}var S=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),o=this._keySchedule=[],i=0;i<n;i++)if(i<t)o[i]=e[i];else{var a=o[i-1];i%t?6<t&&4==i%t&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=S[i/t|0]<<24),o[i]=o[i-t]^a}for(e=this._invKeySchedule=[],t=0;t<n;t++)i=n-t,a=t%4?o[i]:o[i-4],e[t]=4>t||4>=i?a:c[r[a>>>24]]^l[r[a>>>16&255]]^p[r[a>>>8&255]]^f[r[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,s,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],p=e[t+2]^n[2],f=e[t+3]^n[3],h=4,d=1;d<u;d++){var y=r[c>>>24]^o[l>>>16&255]^i[p>>>8&255]^a[255&f]^n[h++],g=r[l>>>24]^o[p>>>16&255]^i[f>>>8&255]^a[255&c]^n[h++],b=r[p>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[h++];f=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&p]^n[h++],c=y,l=g,p=b}y=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[p>>>8&255]<<8|s[255&f])^n[h++],g=(s[l>>>24]<<24|s[p>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h++],b=(s[p>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[h++],f=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&p])^n[h++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(n)}(),w.mode.ECB=((P=w.lib.BlockCipherMode.extend()).Encryptor=P.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),P.Decryptor=P.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),P);var E=w;function T(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return E.lib.WordArray.create(n,e.length)}var A=function(){function e(e){var t=e.config;this._config=t,this._iv=\"0123456789012345\",this._allowedKeyEncodings=[\"hex\",\"utf8\",\"base64\",\"binary\"],this._allowedKeyLengths=[128,256],this._allowedModes=[\"ecb\",\"cbc\"],this._defaultOptions={encryptKey:!0,keyEncoding:\"utf8\",keyLength:256,mode:\"cbc\"}}return e.prototype.HMACSHA256=function(e){return E.HmacSHA256(e,this._config.secretKey).toString(E.enc.Base64)},e.prototype.SHA256=function(e){return E.SHA256(e).toString(E.enc.Hex)},e.prototype._parseOptions=function(e){var t=e||{};return t.hasOwnProperty(\"encryptKey\")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty(\"keyEncoding\")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty(\"keyLength\")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty(\"mode\")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t},e.prototype._decodeKey=function(e,t){return\"base64\"===t.keyEncoding?E.enc.Base64.parse(e):\"hex\"===t.keyEncoding?E.enc.Hex.parse(e):e},e.prototype._getPaddedKey=function(e,t){return e=this._decodeKey(e,t),t.encryptKey?E.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e},e.prototype._getMode=function(e){return\"ecb\"===e.mode?E.mode.ECB:E.mode.CBC},e.prototype._getIV=function(e){return\"cbc\"===e.mode?E.enc.Utf8.parse(this._iv):null},e.prototype._getRandomIV=function(){return E.lib.WordArray.random(16)},e.prototype.encrypt=function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)},e.prototype.decrypt=function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)},e.prototype.pnEncrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=this._getRandomIV(),a=E.AES.encrypt(e,o,{iv:i,mode:r}).ciphertext;return i.clone().concat(a.clone()).toString(E.enc.Base64)}var s=this._getIV(n);return E.AES.encrypt(e,o,{iv:s,mode:r}).ciphertext.toString(E.enc.Base64)||e},e.prototype.pnDecrypt=function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getMode(n),o=this._getPaddedKey(t||this._config.cipherKey,n);if(this._config.useRandomIVs){var i=T((u=new Uint8ClampedArray(b(e))).slice(0,16)),a=T(u.slice(16));try{var s=E.AES.decrypt({ciphertext:a},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}else{i=this._getIV(n);try{var u=E.enc.Base64.parse(e);s=E.AES.decrypt({ciphertext:u},o,{iv:i,mode:r}).toString(E.enc.Utf8);return JSON.parse(s)}catch(e){return null}}},e}(),N=function(){function e(e){var t=e.timeEndpoint;this._timeEndpoint=t}return e.prototype.onReconnection=function(e){this._reconnectionCallback=e},e.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},e.prototype.stopPolling=function(){clearInterval(this._timeTimer)},e.prototype._performTimeLoop=function(){var e=this;this._timeEndpoint((function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())}))},e}(),k=function(){function e(e){var t=e.config;this.hashHistory=[],this._config=t}return e.prototype.getKey=function(e){var t=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.payload)).toString(),n=e.publishMetaData.publishTimetoken;return\"\".concat(n,\"-\").concat(t)},e.prototype.isDuplicate=function(e){return this.hashHistory.includes(this.getKey(e))},e.prototype.addEntry=function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))},e.prototype.clearHistory=function(){this.hashHistory=[]},e}();function C(e){return encodeURIComponent(e).replace(/[!~*'()]/g,(function(e){return\"%\".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function j(e){return function(e){var t=[];return Object.keys(e).forEach((function(e){return t.push(e)})),t}(e).sort()}var M={signPamFromParams:function(e){return j(e).map((function(t){return\"\".concat(t,\"=\").concat(C(e[t]))})).join(\"&\")},endsWith:function(e,t){return-1!==e.indexOf(t,this.length-t.length)},createPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),reject:t,fulfill:e}},encodeString:C,stringToArrayBuffer:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t}},R={PNNetworkUpCategory:\"PNNetworkUpCategory\",PNNetworkDownCategory:\"PNNetworkDownCategory\",PNNetworkIssuesCategory:\"PNNetworkIssuesCategory\",PNTimeoutCategory:\"PNTimeoutCategory\",PNBadRequestCategory:\"PNBadRequestCategory\",PNAccessDeniedCategory:\"PNAccessDeniedCategory\",PNUnknownCategory:\"PNUnknownCategory\",PNReconnectedCategory:\"PNReconnectedCategory\",PNConnectedCategory:\"PNConnectedCategory\",PNRequestMessageCountExceededCategory:\"PNRequestMessageCountExceededCategory\"},U=function(){function e(e){var t=e.subscribeEndpoint,n=e.leaveEndpoint,r=e.heartbeatEndpoint,o=e.setStateEndpoint,i=e.timeEndpoint,a=e.getFileUrl,s=e.config,u=e.crypto,c=e.listenerManager,l=e.cryptoModule;this._listenerManager=c,this._config=s,this._leaveEndpoint=n,this._heartbeatEndpoint=r,this._setStateEndpoint=o,this._subscribeEndpoint=t,this._getFileUrl=a,this._crypto=u,this._cryptoModule=l,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new N({timeEndpoint:i}),this._dedupingManager=new k({config:s}),this._cryptoModule&&(this._decoder=new TextDecoder)}return e.prototype.adaptStateChange=function(e,t){var n=this,r=e.state,o=e.channels,i=void 0===o?[]:o,a=e.channelGroups,s=void 0===a?[]:a,u=e.withHeartbeat,c=void 0!==u&&u;if(i.forEach((function(e){e in n._channels&&(n._channels[e].state=r)})),s.forEach((function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)})),c){var l={};return i.forEach((function(e){return l[e]=r})),s.forEach((function(e){return l[e]=r})),this._heartbeatEndpoint({channels:i,channelGroups:s,state:l},t)}return this._setStateEndpoint({state:r,channels:i,channelGroups:s},t)},e.prototype.adaptPresenceChange=function(e){var t=this,n=e.connected,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i;n?(o.forEach((function(e){t._heartbeatChannels[e]={state:{}}})),a.forEach((function(e){t._heartbeatChannelGroups[e]={state:{}}}))):(o.forEach((function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]})),a.forEach((function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]})),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:o,channelGroups:a},(function(e){t._listenerManager.announceStatus(e)}))),this.reconnect()},e.prototype.adaptSubscribeChange=function(e){var t=this,n=e.timetoken,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=e.withPresence,u=void 0!==s&&s,c=e.withHeartbeats,l=void 0!==c&&c;this._config.subscribeKey&&\"\"!==this._config.subscribeKey?(n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),\"0\"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),o.forEach((function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)})),a.forEach((function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),(l||t._config.getHeartbeatInterval())&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)})),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log(\"subscribe key missing; aborting subscribe\")},e.prototype.adaptUnsubscribeChange=function(e,t){var n=this,r=e.channels,o=void 0===r?[]:r,i=e.channelGroups,a=void 0===i?[]:i,s=[],u=[];o.forEach((function(e){e in n._channels&&(delete n._channels[e],s.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],s.push(e))})),a.forEach((function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._presenceChannelGroups[e],u.push(e))})),0===s.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:s,channelGroups:u},(function(e){e.affectedChannels=s,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)})),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},e.prototype.unsubscribeAll=function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)},e.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},e.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},e.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},e.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},e.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},e.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},e.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&void 0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},e.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},e.prototype._performHeartbeatLoop=function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach((function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)})),this.getSubscribedChannelGroups().forEach((function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)}));this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)}.bind(this))}},e.prototype._startSubscribeLoop=function(){var e=this;this._stopSubscribeLoop();var t={},n=[],r=[];if(Object.keys(this._channels).forEach((function(r){var o=e._channels[r].state;Object.keys(o).length&&(t[r]=o),n.push(r)})),Object.keys(this._presenceChannels).forEach((function(e){n.push(\"\".concat(e,\"-pnpres\"))})),Object.keys(this._channelGroups).forEach((function(n){var o=e._channelGroups[n].state;Object.keys(o).length&&(t[n]=o),r.push(n)})),Object.keys(this._presenceChannelGroups).forEach((function(e){r.push(\"\".concat(e,\"-pnpres\"))})),0!==n.length||0!==r.length){var o={channels:n,channelGroups:r,state:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(o,this._processSubscribeResponse.bind(this))}},e.prototype._processSubscribeResponse=function(e,t){var o=this;if(e.error){if(e.errorData&&\"Aborted\"===e.errorData.message)return;e.category===R.PNTimeoutCategory?this._startSubscribeLoop():e.category===R.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection((function(){o._config.autoNetworkDetection&&!o._isOnline&&(o._isOnline=!0,o._listenerManager.announceNetworkUp()),o.reconnect(),o._subscriptionStatusAnnounced=!0;var t={category:R.PNReconnectedCategory,operation:e.operation,lastTimetoken:o._lastTimetoken,currentTimetoken:o._currentTimetoken};o._listenerManager.announceStatus(t)})),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===R.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var i={};i.category=R.PNConnectedCategory,i.operation=e.operation,i.affectedChannels=this._pendingChannelSubscriptions,i.subscribedChannels=this.getSubscribedChannels(),i.affectedChannelGroups=this._pendingChannelGroupSubscriptions,i.lastTimetoken=this._lastTimetoken,i.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(i),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var a=t.messages||[],s=this._config,u=s.requestMessageCountThreshold,c=s.dedupeOnSubscribe;if(u&&a.length>=u){var l={};l.category=R.PNRequestMessageCountExceededCategory,l.operation=e.operation,this._listenerManager.announceStatus(l)}a.forEach((function(e){var t=e.channel,i=e.subscriptionMatch,a=e.publishMetaData;if(t===i&&(i=null),c){if(o._dedupingManager.isDuplicate(e))return;o._dedupingManager.addEntry(e)}if(M.endsWith(e.channel,\"-pnpres\"))(y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,t&&(y.channel=t.substring(0,t.lastIndexOf(\"-pnpres\"))),i&&(y.subscription=i.substring(0,i.lastIndexOf(\"-pnpres\"))),y.action=e.payload.action,y.state=e.payload.data,y.timetoken=a.publishTimetoken,y.occupancy=e.payload.occupancy,y.uuid=e.payload.uuid,y.timestamp=e.payload.timestamp,e.payload.join&&(y.join=e.payload.join),e.payload.leave&&(y.leave=e.payload.leave),e.payload.timeout&&(y.timeout=e.payload.timeout),o._listenerManager.announcePresence(y);else if(1===e.messageType){(y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=e.payload,o._listenerManager.announceSignal(y)}else if(2===e.messageType){if((y={channel:null,subscription:null}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),y.message={event:e.payload.event,type:e.payload.type,data:e.payload.data},o._listenerManager.announceObjects(y),\"uuid\"===e.payload.type){var s=o._renameChannelField(y);o._listenerManager.announceUser(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"user\"})}))}else if(\"channel\"===e.payload.type){s=o._renameChannelField(y);o._listenerManager.announceSpace(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),type:\"space\"})}))}else if(\"membership\"===e.payload.type){var u=(s=o._renameChannelField(y)).message.data,l=u.uuid,p=u.channel,f=r(u,[\"uuid\",\"channel\"]);f.user=l,f.space=p,o._listenerManager.announceMembership(n(n({},s),{message:n(n({},s.message),{event:o._renameEvent(s.message.event),data:f})}))}}else if(3===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,y.data={messageTimetoken:e.payload.data.messageTimetoken,actionTimetoken:e.payload.data.actionTimetoken,type:e.payload.data.type,uuid:e.issuingClientId,value:e.payload.data.value},y.event=e.payload.event,o._listenerManager.announceMessageAction(y)}else if(4===e.messageType){(y={}).channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId;var h=e.payload;if(o._cryptoModule){var d=void 0;try{d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}null!==d&&(h=d)}e.userMetadata&&(y.userMetadata=e.userMetadata),y.message=h.message,y.file={id:h.file.id,name:h.file.name,url:o._getFileUrl({id:h.file.id,name:h.file.name,channel:t})},o._listenerManager.announceFile(y)}else{var y;if((y={channel:null,subscription:null}).actualChannel=null!=i?t:null,y.subscribedChannel=null!=i?i:t,y.channel=t,y.subscription=i,y.timetoken=a.publishTimetoken,y.publisher=e.issuingClientId,e.userMetadata&&(y.userMetadata=e.userMetadata),o._cryptoModule){d=void 0;try{var g;d=(g=o._cryptoModule.decrypt(e.payload))instanceof ArrayBuffer?JSON.parse(o._decoder.decode(g)):g}catch(e){d=null,console&&console.log&&console.log(\"decryption error\",e.message)}y.message=null!=d?d:e.payload}else y.message=e.payload;o._listenerManager.announceMessage(y)}})),this._region=t.metadata.region,this._startSubscribeLoop()}},e.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(\"function\"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)},e.prototype._renameEvent=function(e){return\"set\"===e?\"updated\":\"removed\"},e.prototype._renameChannelField=function(e){var t=e.channel,n=r(e,[\"channel\"]);return n.spaceId=t,n},e}(),I={PNTimeOperation:\"PNTimeOperation\",PNHistoryOperation:\"PNHistoryOperation\",PNDeleteMessagesOperation:\"PNDeleteMessagesOperation\",PNFetchMessagesOperation:\"PNFetchMessagesOperation\",PNMessageCounts:\"PNMessageCountsOperation\",PNSubscribeOperation:\"PNSubscribeOperation\",PNUnsubscribeOperation:\"PNUnsubscribeOperation\",PNPublishOperation:\"PNPublishOperation\",PNSignalOperation:\"PNSignalOperation\",PNAddMessageActionOperation:\"PNAddActionOperation\",PNRemoveMessageActionOperation:\"PNRemoveMessageActionOperation\",PNGetMessageActionsOperation:\"PNGetMessageActionsOperation\",PNCreateUserOperation:\"PNCreateUserOperation\",PNUpdateUserOperation:\"PNUpdateUserOperation\",PNDeleteUserOperation:\"PNDeleteUserOperation\",PNGetUserOperation:\"PNGetUsersOperation\",PNGetUsersOperation:\"PNGetUsersOperation\",PNCreateSpaceOperation:\"PNCreateSpaceOperation\",PNUpdateSpaceOperation:\"PNUpdateSpaceOperation\",PNDeleteSpaceOperation:\"PNDeleteSpaceOperation\",PNGetSpaceOperation:\"PNGetSpacesOperation\",PNGetSpacesOperation:\"PNGetSpacesOperation\",PNGetMembersOperation:\"PNGetMembersOperation\",PNUpdateMembersOperation:\"PNUpdateMembersOperation\",PNGetMembershipsOperation:\"PNGetMembershipsOperation\",PNUpdateMembershipsOperation:\"PNUpdateMembershipsOperation\",PNListFilesOperation:\"PNListFilesOperation\",PNGenerateUploadUrlOperation:\"PNGenerateUploadUrlOperation\",PNPublishFileOperation:\"PNPublishFileOperation\",PNGetFileUrlOperation:\"PNGetFileUrlOperation\",PNDownloadFileOperation:\"PNDownloadFileOperation\",PNGetAllUUIDMetadataOperation:\"PNGetAllUUIDMetadataOperation\",PNGetUUIDMetadataOperation:\"PNGetUUIDMetadataOperation\",PNSetUUIDMetadataOperation:\"PNSetUUIDMetadataOperation\",PNRemoveUUIDMetadataOperation:\"PNRemoveUUIDMetadataOperation\",PNGetAllChannelMetadataOperation:\"PNGetAllChannelMetadataOperation\",PNGetChannelMetadataOperation:\"PNGetChannelMetadataOperation\",PNSetChannelMetadataOperation:\"PNSetChannelMetadataOperation\",PNRemoveChannelMetadataOperation:\"PNRemoveChannelMetadataOperation\",PNSetMembersOperation:\"PNSetMembersOperation\",PNSetMembershipsOperation:\"PNSetMembershipsOperation\",PNPushNotificationEnabledChannelsOperation:\"PNPushNotificationEnabledChannelsOperation\",PNRemoveAllPushNotificationsOperation:\"PNRemoveAllPushNotificationsOperation\",PNWhereNowOperation:\"PNWhereNowOperation\",PNSetStateOperation:\"PNSetStateOperation\",PNHereNowOperation:\"PNHereNowOperation\",PNGetStateOperation:\"PNGetStateOperation\",PNHeartbeatOperation:\"PNHeartbeatOperation\",PNChannelGroupsOperation:\"PNChannelGroupsOperation\",PNRemoveGroupOperation:\"PNRemoveGroupOperation\",PNChannelsForGroupOperation:\"PNChannelsForGroupOperation\",PNAddChannelsToGroupOperation:\"PNAddChannelsToGroupOperation\",PNRemoveChannelsFromGroupOperation:\"PNRemoveChannelsFromGroupOperation\",PNAccessManagerGrant:\"PNAccessManagerGrant\",PNAccessManagerGrantToken:\"PNAccessManagerGrantToken\",PNAccessManagerAudit:\"PNAccessManagerAudit\",PNAccessManagerRevokeToken:\"PNAccessManagerRevokeToken\",PNHandshakeOperation:\"PNHandshakeOperation\",PNReceiveMessagesOperation:\"PNReceiveMessagesOperation\"},x=function(){function e(e){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._maximumSamplesCount=e.maximumSamplesCount||this._maximumSamplesCount}return e.prototype.operationsLatencyForRequest=function(){var e=this,t={};return Object.keys(this._latencies).forEach((function(n){var r=e._latencies[n],o=e._averageLatency(r);o>0&&(t[\"l_\".concat(n)]=o)})),t},e.prototype.startLatencyMeasure=function(e,t){e!==I.PNSubscribeOperation&&t&&(this._trackedLatencies[t]=Date.now())},e.prototype.stopLatencyMeasure=function(e,t){if(e!==I.PNSubscribeOperation&&t){var n=this._endpointName(e),r=this._latencies[n],o=this._trackedLatencies[t];r||(this._latencies[n]=[],r=this._latencies[n]),r.push(Date.now()-o),r.length>this._maximumSamplesCount&&r.splice(0,r.length-this._maximumSamplesCount),delete this._trackedLatencies[t]}},e.prototype._averageLatency=function(e){return Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length)},e.prototype._endpointName=function(e){var t=null;switch(e){case I.PNPublishOperation:t=\"pub\";break;case I.PNSignalOperation:t=\"sig\";break;case I.PNHistoryOperation:case I.PNFetchMessagesOperation:case I.PNDeleteMessagesOperation:case I.PNMessageCounts:t=\"hist\";break;case I.PNUnsubscribeOperation:case I.PNWhereNowOperation:case I.PNHereNowOperation:case I.PNHeartbeatOperation:case I.PNSetStateOperation:case I.PNGetStateOperation:t=\"pres\";break;case I.PNAddChannelsToGroupOperation:case I.PNRemoveChannelsFromGroupOperation:case I.PNChannelGroupsOperation:case I.PNRemoveGroupOperation:case I.PNChannelsForGroupOperation:t=\"cg\";break;case I.PNPushNotificationEnabledChannelsOperation:case I.PNRemoveAllPushNotificationsOperation:t=\"push\";break;case I.PNCreateUserOperation:case I.PNUpdateUserOperation:case I.PNDeleteUserOperation:case I.PNGetUserOperation:case I.PNGetUsersOperation:case I.PNCreateSpaceOperation:case I.PNUpdateSpaceOperation:case I.PNDeleteSpaceOperation:case I.PNGetSpaceOperation:case I.PNGetSpacesOperation:case I.PNGetMembersOperation:case I.PNUpdateMembersOperation:case I.PNGetMembershipsOperation:case I.PNUpdateMembershipsOperation:t=\"obj\";break;case I.PNAddMessageActionOperation:case I.PNRemoveMessageActionOperation:case I.PNGetMessageActionsOperation:t=\"msga\";break;case I.PNAccessManagerGrant:case I.PNAccessManagerAudit:t=\"pam\";break;case I.PNAccessManagerGrantToken:case I.PNAccessManagerRevokeToken:t=\"pamv3\";break;default:t=\"time\"}return t},e}(),D=function(){function e(e,t,n){this._payload=e,this._setDefaultPayloadStructure(),this.title=t,this.body=n}return Object.defineProperty(e.prototype,\"payload\",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{set:function(e){this._title=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{set:function(e){this._subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{set:function(e){this._body=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{set:function(e){this._badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{set:function(e){this._sound=e},enumerable:!1,configurable:!0}),e.prototype._setDefaultPayloadStructure=function(){},e.prototype.toObject=function(){return{}},e}(),F=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"configurations\",{set:function(e){e&&e.length&&(this._configurations=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"notification\",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.aps.alert.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){e&&e.length&&(this._payload.aps.alert.subtitle=e,this._subtitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.aps.alert.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this._badge},set:function(e){null!=e&&(this._payload.aps.badge=e,this._badge=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.aps.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),r.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},r.prototype.toObject=function(){var e=this,t=n({},this._payload),r=t.aps,o=r.alert;if(this._isSilent&&(r[\"content-available\"]=1),\"apns2\"===this._apnsPushType){if(!this._configurations||!this._configurations.length)throw new ReferenceError(\"APNS2 configuration is missing\");var i=[];this._configurations.forEach((function(t){i.push(e._objectFromAPNS2Configuration(t))})),i.length&&(t.pn_push=i)}return o&&Object.keys(o).length||delete r.alert,this._isSilent&&(delete r.alert,delete r.badge,delete r.sound,o={}),this._isSilent||Object.keys(o).length?t:null},r.prototype._objectFromAPNS2Configuration=function(e){var t=this;if(!e.targets||!e.targets.length)throw new ReferenceError(\"At least one APNS2 target should be provided\");var n=[];e.targets.forEach((function(e){n.push(t._objectFromAPNSTarget(e))}));var r=e.collapseId,o=e.expirationDate,i={auth_method:\"token\",targets:n,version:\"v2\"};return r&&r.length&&(i.collapse_id=r),o&&(i.expiration=o.toISOString()),i},r.prototype._objectFromAPNSTarget=function(e){if(!e.topic||!e.topic.length)throw new TypeError(\"Target 'topic' undefined.\");var t=e.topic,n=e.environment,r=void 0===n?\"development\":n,o=e.excludedDevices,i=void 0===o?[]:o,a={topic:t,environment:r};return i.length&&(a.excluded_devices=i),a},r}(D),G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),Object.defineProperty(r.prototype,\"backContent\",{get:function(){return this._backContent},set:function(e){e&&e.length&&(this._payload.back_content=e,this._backContent=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"backTitle\",{get:function(){return this._backTitle},set:function(e){e&&e.length&&(this._payload.back_title=e,this._backTitle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"count\",{get:function(){return this._count},set:function(e){null!=e&&(this._payload.count=e,this._count=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"type\",{get:function(){return this._type},set:function(e){e&&e.length&&(this._payload.type=e,this._type=e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"subtitle\",{get:function(){return this.backTitle},set:function(e){this.backTitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"body\",{get:function(){return this.backContent},set:function(e){this.backContent=e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,\"badge\",{get:function(){return this.count},set:function(e){this.count=e},enumerable:!1,configurable:!0}),r.prototype.toObject=function(){return Object.keys(this._payload).length?n({},this._payload):null},r}(D),L=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return t(o,e),Object.defineProperty(o.prototype,\"notification\",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"data\",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"title\",{get:function(){return this._title},set:function(e){e&&e.length&&(this._payload.notification.title=e,this._title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"body\",{get:function(){return this._body},set:function(e){e&&e.length&&(this._payload.notification.body=e,this._body=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"sound\",{get:function(){return this._sound},set:function(e){e&&e.length&&(this._payload.notification.sound=e,this._sound=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"icon\",{get:function(){return this._icon},set:function(e){e&&e.length&&(this._payload.notification.icon=e,this._icon=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"tag\",{get:function(){return this._tag},set:function(e){e&&e.length&&(this._payload.notification.tag=e,this._tag=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,\"silent\",{set:function(e){this._isSilent=e},enumerable:!1,configurable:!0}),o.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},o.prototype.toObject=function(){var e=n({},this._payload.data),t=null,o={};if(Object.keys(this._payload).length>2){var i=this._payload;i.notification,i.data;var a=r(i,[\"notification\",\"data\"]);e=n(n({},e),a)}return this._isSilent?e.notification=this._payload.notification:t=this._payload.notification,Object.keys(e).length&&(o.data=e),t&&Object.keys(t).length&&(o.notification=t),Object.keys(o).length?o:null},o}(D),K=function(){function e(e,t){this._payload={apns:{},mpns:{},fcm:{}},this._title=e,this._body=t,this.apns=new F(this._payload.apns,e,t),this.mpns=new G(this._payload.mpns,e,t),this.fcm=new L(this._payload.fcm,e,t)}return Object.defineProperty(e.prototype,\"debugging\",{set:function(e){this._debugging=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"title\",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"body\",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"subtitle\",{get:function(){return this._subtitle},set:function(e){this._subtitle=e,this.apns.subtitle=e,this.mpns.subtitle=e,this.fcm.subtitle=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"badge\",{get:function(){return this._badge},set:function(e){this._badge=e,this.apns.badge=e,this.mpns.badge=e,this.fcm.badge=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"sound\",{get:function(){return this._sound},set:function(e){this._sound=e,this.apns.sound=e,this.mpns.sound=e,this.fcm.sound=e},enumerable:!1,configurable:!0}),e.prototype.buildPayload=function(e){var t={};if(e.includes(\"apns\")||e.includes(\"apns2\")){this.apns._apnsPushType=e.includes(\"apns\")?\"apns\":\"apns2\";var n=this.apns.toObject();n&&Object.keys(n).length&&(t.pn_apns=n)}if(e.includes(\"mpns\")){var r=this.mpns.toObject();r&&Object.keys(r).length&&(t.pn_mpns=r)}if(e.includes(\"fcm\")){var o=this.fcm.toObject();o&&Object.keys(o).length&&(t.pn_gcm=o)}return Object.keys(t).length&&this._debugging&&(t.pn_debug=!0),t},e}(),B=function(){function e(){this._listeners=[]}return e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListener=function(e){var t=[];this._listeners.forEach((function(n){n!==e&&t.push(n)})),this._listeners=t},e.prototype.removeAllListeners=function(){this._listeners=[]},e.prototype.announcePresence=function(e){this._listeners.forEach((function(t){t.presence&&t.presence(e)}))},e.prototype.announceStatus=function(e){this._listeners.forEach((function(t){t.status&&t.status(e)}))},e.prototype.announceMessage=function(e){this._listeners.forEach((function(t){t.message&&t.message(e)}))},e.prototype.announceSignal=function(e){this._listeners.forEach((function(t){t.signal&&t.signal(e)}))},e.prototype.announceMessageAction=function(e){this._listeners.forEach((function(t){t.messageAction&&t.messageAction(e)}))},e.prototype.announceFile=function(e){this._listeners.forEach((function(t){t.file&&t.file(e)}))},e.prototype.announceObjects=function(e){this._listeners.forEach((function(t){t.objects&&t.objects(e)}))},e.prototype.announceUser=function(e){this._listeners.forEach((function(t){t.user&&t.user(e)}))},e.prototype.announceSpace=function(e){this._listeners.forEach((function(t){t.space&&t.space(e)}))},e.prototype.announceMembership=function(e){this._listeners.forEach((function(t){t.membership&&t.membership(e)}))},e.prototype.announceNetworkUp=function(){var e={};e.category=R.PNNetworkUpCategory,this.announceStatus(e)},e.prototype.announceNetworkDown=function(){var e={};e.category=R.PNNetworkDownCategory,this.announceStatus(e)},e}(),H=function(){function e(e,t){this._config=e,this._cbor=t}return e.prototype.setToken=function(e){e&&e.length>0?this._token=e:this._token=void 0},e.prototype.getToken=function(){return this._token},e.prototype.extractPermissions=function(e){var t={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return 128==(128&e)&&(t.join=!0),64==(64&e)&&(t.update=!0),32==(32&e)&&(t.get=!0),8==(8&e)&&(t.delete=!0),4==(4&e)&&(t.manage=!0),2==(2&e)&&(t.write=!0),1==(1&e)&&(t.read=!0),t},e.prototype.parseToken=function(e){var t=this,n=this._cbor.decodeToken(e);if(void 0!==n){var r=n.res.uuid?Object.keys(n.res.uuid):[],o=Object.keys(n.res.chan),i=Object.keys(n.res.grp),a=n.pat.uuid?Object.keys(n.pat.uuid):[],s=Object.keys(n.pat.chan),u=Object.keys(n.pat.grp),c={version:n.v,timestamp:n.t,ttl:n.ttl,authorized_uuid:n.uuid},l=r.length>0,p=o.length>0,f=i.length>0;(l||p||f)&&(c.resources={},l&&(c.resources.uuids={},r.forEach((function(e){c.resources.uuids[e]=t.extractPermissions(n.res.uuid[e])}))),p&&(c.resources.channels={},o.forEach((function(e){c.resources.channels[e]=t.extractPermissions(n.res.chan[e])}))),f&&(c.resources.groups={},i.forEach((function(e){c.resources.groups[e]=t.extractPermissions(n.res.grp[e])}))));var h=a.length>0,d=s.length>0,y=u.length>0;return(h||d||y)&&(c.patterns={},h&&(c.patterns.uuids={},a.forEach((function(e){c.patterns.uuids[e]=t.extractPermissions(n.pat.uuid[e])}))),d&&(c.patterns.channels={},s.forEach((function(e){c.patterns.channels[e]=t.extractPermissions(n.pat.chan[e])}))),y&&(c.patterns.groups={},u.forEach((function(e){c.patterns.groups[e]=t.extractPermissions(n.pat.grp[e])})))),Object.keys(n.meta).length>0&&(c.meta=n.meta),c.signature=n.sig,c}},e}(),q=function(e){function n(t,n){var r=this.constructor,o=e.call(this,t)||this;return o.name=o.constructor.name,o.status=n,o.message=t,Object.setPrototypeOf(o,r.prototype),o}return t(n,e),n}(Error);function z(e){return(t={message:e}).type=\"validationError\",t.error=!0,t;var t}function V(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.usePatch&&e.usePatch(t,n)?e.patchURL(t,n):e.useGetFile&&e.useGetFile(t,n)?e.getFileURL(t,n):e.getURL(t,n)}function W(e){if(e.sdkName)return e.sdkName;var t=\"PubNub-JS-\".concat(e.sdkFamily);e.partnerId&&(t+=\"-\".concat(e.partnerId)),t+=\"/\".concat(e.getVersion());var n=e._getPnsdkSuffix(\" \");return n.length>0&&(t+=n),t}function J(e,t,n){return t.usePost&&t.usePost(e,n)?\"POST\":t.usePatch&&t.usePatch(e,n)?\"PATCH\":t.useDelete&&t.useDelete(e,n)?\"DELETE\":t.useGetFile&&t.useGetFile(e,n)?\"GETFILE\":\"GET\"}function $(e,t,n,r,o){var i=e.config,a=e.crypto,s=J(e,o,r);n.timestamp=Math.floor((new Date).getTime()/1e3),\"PNPublishOperation\"===o.getOperation()&&o.usePost&&o.usePost(e,r)&&(s=\"GET\"),\"GETFILE\"===s&&(s=\"GET\");var u=\"\".concat(s,\"\\n\").concat(i.publishKey,\"\\n\").concat(t,\"\\n\").concat(M.signPamFromParams(n),\"\\n\");if(\"POST\"===s)u+=\"string\"==typeof(c=o.postPayload(e,r))?c:JSON.stringify(c);else if(\"PATCH\"===s){var c;u+=\"string\"==typeof(c=o.patchPayload(e,r))?c:JSON.stringify(c)}var l=\"v2.\".concat(a.HMACSHA256(u));l=(l=(l=l.replace(/\\+/g,\"-\")).replace(/\\//g,\"_\")).replace(/=+$/,\"\"),n.signature=l}function Q(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e.networking,a=e.config,s=e.telemetryManager,u=e.tokenManager,c=y(),l=null,p=null,f={};t.getOperation()===I.PNTimeOperation||t.getOperation()===I.PNChannelGroupsOperation?l=r[0]:(f=r[0],l=r[1]),\"undefined\"==typeof Promise||l||(p=M.createPromise());var h=t.validateParams(e,f);if(h)return l?l(z(h)):p?(p.reject(new q(\"Validation failed, check status for details\",z(h))),p.promise):void 0;var d,g=t.prepareParams(e,f),b=V(t,e,f),v={url:b,operation:t.getOperation(),timeout:t.getRequestTimeout(e),headers:t.getRequestHeaders?t.getRequestHeaders():{},ignoreBody:\"function\"==typeof t.ignoreBody&&t.ignoreBody(e),forceBuffered:\"function\"==typeof t.forceBuffered?t.forceBuffered(e,f):null,abortSignal:\"function\"==typeof t.getAbortSignal?t.getAbortSignal(e,f):null};g.uuid=a.UUID,g.pnsdk=W(a);var m=s.operationsLatencyForRequest();if(Object.keys(m).length&&(g=n(n({},g),m)),a.useInstanceId&&(g.instanceid=a.instanceId),a.useRequestId&&(g.requestid=c),t.isAuthSupported()){var _=u.getToken()||a.getAuthKey();_&&(g.auth=_)}a.secretKey&&$(e,b,g,f,t);var O=function(n,r){if(n.error)return t.handleError&&t.handleError(e,f,n),void(l?l(n):p&&p.reject(new q(\"PubNub call failed, check status for details\",n)));s.stopLatencyMeasure(t.getOperation(),c);var o=t.handleResponse(e,r,f);\"function\"!=typeof(null==o?void 0:o.then)&&(o=Promise.resolve(o)),o.then((function(e){l?l(n,e):p&&p.fulfill(e)})).catch((function(e){if(l){var n=e;t.getOperation()===I.PNSubscribeOperation&&(n={statusCode:400,error:!0,operation:t.getOperation(),errorData:e,category:R.PNUnknownCategory}),l(n,null)}else p&&p.reject(new q(\"PubNub call failed, check status for details\",e))}))};if(s.startLatencyMeasure(t.getOperation(),c),\"POST\"===J(e,t,f)){var S=t.postPayload(e,f);d=i.POST(g,S,v,O)}else if(\"PATCH\"===J(e,t,f)){S=t.patchPayload(e,f);d=i.PATCH(g,S,v,O)}else d=\"DELETE\"===J(e,t,f)?i.DELETE(g,v,O):\"GETFILE\"===J(e,t,f)?i.GETFILE(g,v,O):i.GET(g,v,O);return t.getOperation()===I.PNSubscribeOperation?d:p?p.promise:void 0}var X=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddChannelsToGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Y=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveChannelsFromGroupOperation},validateParams:function(e,t){var n=t.channels,r=t.channelGroup,o=e.config;return r?n&&0!==n.length?o.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(\",\")}},handleResponse:function(){return{}}});var Z=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n),\"/remove\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}});var ee=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelGroupsOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v1/channel-registration/sub-key/\".concat(t.subscribeKey,\"/channel-group\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{groups:t.payload.groups}}});var te=Object.freeze({__proto__:null,getOperation:function(){return I.PNChannelsForGroupOperation},validateParams:function(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channel Group\"},getURL:function(e,t){var n=t.channelGroup,r=e.config;return\"/v1/channel-registration/sub-key/\".concat(r.subscribeKey,\"/channel-group/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{channels:t.payload.channels}}});var ne=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,add:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var re=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.channels,i=t.topic,a=e.config;return n?r?\"apns2\"!==r||i?o&&0!==o.length?a.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Channels\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.channels,i=void 0===o?[]:o,a=t.environment,s=void 0===a?\"development\":a,u=t.topic,c={type:r,remove:i.join(\",\")};return\"apns2\"===r&&delete(c=n(n({},c),{environment:s,topic:u})).type,c},handleResponse:function(){return{}}});var oe=Object.freeze({__proto__:null,getOperation:function(){return I.PNPushNotificationEnabledChannelsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(e,t){return{channels:t}}});var ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveAllPushNotificationsOperation},validateParams:function(e,t){var n=t.device,r=t.pushGateway,o=t.topic,i=e.config;return n?r?\"apns2\"!==r||o?i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing APNS2 topic\":\"Missing GW Type (pushGateway: gcm, apns or apns2)\":\"Missing Device ID (device)\"},getURL:function(e,t){var n=t.device,r=t.pushGateway,o=e.config;return\"apns2\"===r?\"/v2/push/sub-key/\".concat(o.subscribeKey,\"/devices-apns2/\").concat(n,\"/remove\"):\"/v1/push/sub-key/\".concat(o.subscribeKey,\"/devices/\").concat(n,\"/remove\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.pushGateway,o=t.environment,i=void 0===o?\"development\":o,a=t.topic,s={type:r};return\"apns2\"===r&&delete(s=n(n({},s),{environment:i,topic:a})).type,s},handleResponse:function(){return{}}});var ae=Object.freeze({__proto__:null,getOperation:function(){return I.PNUnsubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/leave\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(){return{}}});var se=Object.freeze({__proto__:null,getOperation:function(){return I.PNWhereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r;return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/uuid/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}});var ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNHeartbeatOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/heartbeat\")},isAuthSupported:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o=t.state,i=void 0===o?{}:o,a=e.config,s={};return r.length>0&&(s[\"channel-group\"]=r.join(\",\")),s.state=JSON.stringify(i),s.heartbeat=a.getPresenceTimeout(),s},handleResponse:function(){return{}}});var ce=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetStateOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.uuid,o=void 0===r?n.UUID:r,i=t.channels,a=void 0===i?[]:i,s=a.length>0?a.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(s),\"/uuid/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channelGroups,r=void 0===n?[]:n,o={};return r.length>0&&(o[\"channel-group\"]=r.join(\",\")),o},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s={};return 1===o.length&&0===a.length?s[o[0]]=t.payload:s=t.payload,{channels:s}}});var le=Object.freeze({__proto__:null,getOperation:function(){return I.PNSetStateOperation},validateParams:function(e,t){var n=e.config,r=t.state,o=t.channels,i=void 0===o?[]:o,a=t.channelGroups,s=void 0===a?[]:a;return r?n.subscribeKey?0===i.length&&0===s.length?\"Please provide a list of channels and/or channel-groups\":void 0:\"Missing Subscribe Key\":\"Missing State\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/presence/sub-key/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(i),\"/uuid/\").concat(M.encodeString(n.UUID),\"/data\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.state,r=t.channelGroups,o=void 0===r?[]:r,i={};return i.state=JSON.stringify(n),o.length>0&&(i[\"channel-group\"]=o.join(\",\")),i},handleResponse:function(e,t){return{state:t.payload}}});var pe=Object.freeze({__proto__:null,getOperation:function(){return I.PNHereNowOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=t.channelGroups,a=void 0===i?[]:i,s=\"/v2/presence/sub-key/\".concat(n.subscribeKey);if(o.length>0||a.length>0){var u=o.length>0?o.join(\",\"):\",\";s+=\"/channel/\".concat(M.encodeString(u))}return s},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var r=t.channelGroups,o=void 0===r?[]:r,i=t.includeUUIDs,a=void 0===i||i,s=t.includeState,u=void 0!==s&&s,c=t.queryParameters,l=void 0===c?{}:c,p={};return a||(p.disable_uuids=1),u&&(p.state=1),o.length>0&&(p[\"channel-group\"]=o.join(\",\")),p=n(n({},p),l)},handleResponse:function(e,t,n){var r=n.channels,o=void 0===r?[]:r,i=n.channelGroups,a=void 0===i?[]:i,s=n.includeUUIDs,u=void 0===s||s,c=n.includeState,l=void 0!==c&&c;return o.length>1||a.length>0||0===a.length&&0===o.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach((function(n){var r=t.payload.channels[n],o=[];return e.channels[n]={occupants:o,name:n,occupancy:r.occupancy},u&&r.uuids.forEach((function(e){l?o.push({state:e.state,uuid:e.uuid}):o.push({state:null,uuid:e})})),e})),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[o[0]]={occupants:n,name:o[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach((function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})})),e}()},handleError:function(e,t,n){402!==n.statusCode||this.getURL(e,t).includes(\"channel\")||(n.errorData.message=\"You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.\")}});var fe=Object.freeze({__proto__:null,getOperation:function(){return I.PNAddMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.action,o=t.channel;return t.messageTimetoken?n.subscribeKey?o?r?r.value?r.type?r.type.length>15?\"Action.type value exceed maximum length of 15\":void 0:\"Missing Action.type\":\"Missing Action.value\":\"Missing Action\":\"Missing message channel\":\"Missing Subscribe Key\":\"Missing message timetoken\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config,r=t.channel,o=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},getRequestHeaders:function(){return{\"Content-Type\":\"application/json\"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(e,t){return t.action},handleResponse:function(e,t){return{data:t.data}}});var he=Object.freeze({__proto__:null,getOperation:function(){return I.PNRemoveMessageActionOperation},validateParams:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken;return t.messageTimetoken?o?n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\":\"Missing action timetoken\":\"Missing message timetoken\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config,r=t.channel,o=t.actionTimetoken,i=t.messageTimetoken;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r),\"/message/\").concat(i,\"/action/\").concat(o)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{data:t.data}}});var de=Object.freeze({__proto__:null,getOperation:function(){return I.PNGetMessageActionsOperation},validateParams:function(e,t){var n=e.config,r=t.channel;return n.subscribeKey?r?void 0:\"Missing message channel\":\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channel;return\"/v1/message-actions/\".concat(n.subscribeKey,\"/channel/\").concat(M.encodeString(r))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.limit,r=t.start,o=t.end,i={};return n&&(i.limit=n),r&&(i.start=r),o&&(i.end=o),i},handleResponse:function(e,t){var n={data:t.data,start:null,end:null};return n.data.length&&(n.end=n.data[n.data.length-1].actionTimetoken,n.start=n.data[0].actionTimetoken),n}}),ye={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"channel can't be empty\"},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.limit&&(n.limit=t.limit),t.next&&(n.next=t.next),n},handleResponse:function(e,t){return{status:t.status,data:t.data,next:t.next,count:t.count}}},ge={getOperation:function(){return I.PNGenerateUploadUrlOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?void 0:\"name can't be empty\":\"channel can't be empty\"},usePost:function(){return!0},postURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/generate-upload-url\")},postPayload:function(e,t){return{name:t.name}},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data,file_upload_request:t.file_upload_request}}},be={getOperation:function(){return I.PNPublishFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.fileId)?(null==t?void 0:t.fileName)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},getURL:function(e,t){var n=e.config,r=n.publishKey,o=n.subscribeKey,i=function(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}(e,{message:t.message,file:{name:t.fileName,id:t.fileId}});return\"/v1/files/publish-file/\".concat(r,\"/\").concat(o,\"/0/\").concat(M.encodeString(t.channel),\"/0/\").concat(M.encodeString(i))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.ttl&&(n.ttl=t.ttl),void 0!==t.storeInHistory&&(n.store=t.storeInHistory?\"1\":\"0\"),t.meta&&\"object\"==typeof t.meta&&(n.meta=JSON.stringify(t.meta)),n},handleResponse:function(e,t){return{timetoken:t[2]}}},ve=function(e){var t=function(e){var t=this,n=e.generateUploadUrl,r=e.publishFile,a=e.modules,s=a.PubNubFile,u=a.config,c=a.cryptography,l=a.cryptoModule,p=a.networking;return function(e){var a=e.channel,f=e.file,h=e.message,d=e.cipherKey,y=e.meta,g=e.ttl,b=e.storeInHistory;return o(t,void 0,void 0,(function(){var e,t,o,v,m,_,O,S,P,w,E,T,A,N,k,C,j,M,R,U,I,x,D,F,G,L,K,B,H;return i(this,(function(i){switch(i.label){case 0:if(!a)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!f)throw new q(\"Validation failed, check status for details\",z(\"file can't be empty\"));return e=s.create(f),[4,n({channel:a,name:e.name})];case 1:return t=i.sent(),o=t.file_upload_request,v=o.url,m=o.form_fields,_=t.data,O=_.id,S=_.name,s.supportsEncryptFile&&(d||l)?null!=d?[3,3]:[4,l.encryptFile(e,s)]:[3,6];case 2:return P=i.sent(),[3,5];case 3:return[4,c.encryptFile(d,e,s)];case 4:P=i.sent(),i.label=5;case 5:e=P,i.label=6;case 6:w=m,e.mimeType&&(w=m.map((function(t){return\"Content-Type\"===t.key?{key:t.key,value:e.mimeType}:t}))),i.label=7;case 7:return i.trys.push([7,21,,22]),s.supportsFileUri&&f.uri?(A=(T=p).POSTFILE,N=[v,w],[4,e.toFileUri()]):[3,10];case 8:return[4,A.apply(T,N.concat([i.sent()]))];case 9:return E=i.sent(),[3,20];case 10:return s.supportsFile?(C=(k=p).POSTFILE,j=[v,w],[4,e.toFile()]):[3,13];case 11:return[4,C.apply(k,j.concat([i.sent()]))];case 12:return E=i.sent(),[3,20];case 13:return s.supportsBuffer?(R=(M=p).POSTFILE,U=[v,w],[4,e.toBuffer()]):[3,16];case 14:return[4,R.apply(M,U.concat([i.sent()]))];case 15:return E=i.sent(),[3,20];case 16:return s.supportsBlob?(x=(I=p).POSTFILE,D=[v,w],[4,e.toBlob()]):[3,19];case 17:return[4,x.apply(I,D.concat([i.sent()]))];case 18:return E=i.sent(),[3,20];case 19:throw new Error(\"Unsupported environment\");case 20:return[3,22];case 21:throw(F=i.sent()).response&&\"string\"==typeof F.response.text?(G=F.response.text,L=/<Message>(.*)<\\/Message>/gi.exec(G),new q(L?\"Upload to bucket failed: \".concat(L[1]):\"Upload to bucket failed.\",F)):new q(\"Upload to bucket failed.\",F);case 22:if(204!==E.status)throw new q(\"Upload to bucket was unsuccessful\",E);K=u.fileUploadPublishRetryLimit,B=!1,H={timetoken:\"0\"},i.label=23;case 23:return i.trys.push([23,25,,26]),[4,r({channel:a,message:h,fileId:O,fileName:S,meta:y,storeInHistory:b,ttl:g})];case 24:return H=i.sent(),B=!0,[3,26];case 25:return i.sent(),K-=1,[3,26];case 26:if(!B&&K>0)return[3,23];i.label=27;case 27:if(B)return[2,{timetoken:H.timetoken,id:O,name:S}];throw new q(\"Publish failed. You may want to execute that operation manually using pubnub.publishFile\",{channel:a,id:O,name:S})}}))}))}}(e);return function(e,n){var r=t(e);return\"function\"==typeof n?(r.then((function(e){return n(null,e)})).catch((function(e){return n(e,null)})),r):r}},me=function(e,t){var n=t.channel,r=t.id,o=t.name,i=e.config,a=e.networking,s=e.tokenManager;if(!n)throw new q(\"Validation failed, check status for details\",z(\"channel can't be empty\"));if(!r)throw new q(\"Validation failed, check status for details\",z(\"file id can't be empty\"));if(!o)throw new q(\"Validation failed, check status for details\",z(\"file name can't be empty\"));var u=\"/v1/files/\".concat(i.subscribeKey,\"/channels/\").concat(M.encodeString(n),\"/files/\").concat(r,\"/\").concat(o),c={};c.uuid=i.getUUID(),c.pnsdk=W(i);var l=s.getToken()||i.getAuthKey();l&&(c.auth=l),i.secretKey&&$(e,u,c,{},{getOperation:function(){return\"PubNubGetFileUrlOperation\"}});var p=Object.keys(c).map((function(e){return\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(c[e]))})).join(\"&\");return\"\"!==p?\"\".concat(a.getStandardOrigin()).concat(u,\"?\").concat(p):\"\".concat(a.getStandardOrigin()).concat(u)},_e={getOperation:function(){return I.PNDownloadFileOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.name)?(null==t?void 0:t.id)?void 0:\"id can't be empty\":\"name can't be empty\":\"channel can't be empty\"},useGetFile:function(){return!0},getFileURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t,n){var r=e.PubNubFile,a=e.config,s=e.cryptography,u=e.cryptoModule;return o(void 0,void 0,void 0,(function(){var e,o,c,l;return i(this,(function(i){switch(i.label){case 0:return e=t.response.body,r.supportsEncryptFile&&(n.cipherKey||u)?null!=n.cipherKey?[3,2]:[4,u.decryptFile(r.create({data:e,name:n.name}),r)]:[3,5];case 1:return o=i.sent().data,[3,4];case 2:return[4,s.decrypt(null!==(c=n.cipherKey)&&void 0!==c?c:a.cipherKey,e)];case 3:o=i.sent(),i.label=4;case 4:e=o,i.label=5;case 5:return[2,r.create({data:e,name:null!==(l=t.response.name)&&void 0!==l?l:n.name,mimeType:t.response.type})]}}))}))}},Oe={getOperation:function(){return I.PNListFilesOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.id)?(null==t?void 0:t.name)?void 0:\"file name can't be empty\":\"file id can't be empty\":\"channel can't be empty\"},useDelete:function(){return!0},getURL:function(e,t){var n=e.config;return\"/v1/files/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/files/\").concat(t.id,\"/\").concat(t.name)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status}}},Se={getOperation:function(){return I.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,next:t.next,prev:t.prev}}},Pe={getOperation:function(){return I.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},we={getOperation:function(){return I.PNSetUUIDMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.data))return\"Data cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o=e.config,i={};return i.uuid=null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:o.getUUID(),i.include=[\"status\",\"type\",\"custom\"],(null==t?void 0:t.include)&&!1===(null===(r=t.include)||void 0===r?void 0:r.customFields)&&i.include.pop(),i.include=i.include.join(\",\"),i},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ee={getOperation:function(){return I.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r=e.config;return{uuid:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Te={getOperation:function(){return I.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(e){var t=e.config;return\"/v2/objects/\".concat(t.subscribeKey,\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"status\",\"type\"]};return(null==t?void 0:t.include)&&(null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),f.include=f.include.join(\",\"),(null===(r=null==t?void 0:t.include)||void 0===r?void 0:r.totalCount)&&(f.count=null===(o=t.include)||void 0===o?void 0:o.totalCount),(null===(i=null==t?void 0:t.page)||void 0===i?void 0:i.next)&&(f.start=null===(a=t.page)||void 0===a?void 0:a.next),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.prev)&&(f.end=null===(c=t.page)||void 0===c?void 0:c.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),f.limit=null!==(l=null==t?void 0:t.limit)&&void 0!==l?l:100,(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Ae={getOperation:function(){return I.PNGetChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ne={getOperation:function(){return I.PNSetChannelMetadataOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.data)?void 0:\"Data cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},patchPayload:function(e,t){return t.data},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r={include:[\"status\",\"type\",\"custom\"]};return(null==t?void 0:t.include)&&!1===(null===(n=t.include)||void 0===n?void 0:n.customFields)&&r.include.pop(),r.include=r.include.join(\",\"),r},handleResponse:function(e,t){return{status:t.status,data:t.data}}},ke={getOperation:function(){return I.PNRemoveChannelMetadataOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"Channel cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{status:t.status,data:t.data}}},Ce={getOperation:function(){return I.PNGetMembersOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channel))return\"UUID cannot be empty\"},getURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d,y={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&y.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&y.include.push(\"uuid.custom\"),(null===(i=null===(o=t.include)||void 0===o?void 0:o.UUIDFields)||void 0===i||i)&&y.include.push(\"uuid\")),y.include=y.include.join(\",\"),(null===(a=null==t?void 0:t.include)||void 0===a?void 0:a.totalCount)&&(y.count=null===(u=t.include)||void 0===u?void 0:u.totalCount),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.next)&&(y.start=null===(l=t.page)||void 0===l?void 0:l.next),(null===(p=null==t?void 0:t.page)||void 0===p?void 0:p.prev)&&(y.end=null===(f=t.page)||void 0===f?void 0:f.prev),(null==t?void 0:t.filter)&&(y.filter=t.filter),y.limit=null!==(h=null==t?void 0:t.limit)&&void 0!==h?h:100,(null==t?void 0:t.sort)&&(y.sort=Object.entries(null!==(d=t.sort)&&void 0!==d?d:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),y},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},je={getOperation:function(){return I.PNSetMembersOperation},validateParams:function(e,t){return(null==t?void 0:t.channel)?(null==t?void 0:t.uuids)&&0!==(null==t?void 0:t.uuids.length)?void 0:\"UUIDs cannot be empty\":\"Channel cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n=e.config;return\"/v2/objects/\".concat(n.subscribeKey,\"/channels/\").concat(M.encodeString(t.channel),\"/uuids\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.uuids.map((function(e){return\"string\"==typeof e?{uuid:{id:e}}:{uuid:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"uuid.status\",\"uuid.type\",\"type\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customUUIDFields)&&f.include.push(\"uuid.custom\"),(null===(o=t.include)||void 0===o?void 0:o.UUIDFields)&&f.include.push(\"uuid\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Me={getOperation:function(){return I.PNGetMembershipsOperation},validateParams:function(){},getURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f,h,d={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&d.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&d.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&d.include.push(\"channel\")),d.include=d.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(d.count=null===(a=t.include)||void 0===a?void 0:a.totalCount),(null===(u=null==t?void 0:t.page)||void 0===u?void 0:u.next)&&(d.start=null===(c=t.page)||void 0===c?void 0:c.next),(null===(l=null==t?void 0:t.page)||void 0===l?void 0:l.prev)&&(d.end=null===(p=t.page)||void 0===p?void 0:p.prev),(null==t?void 0:t.filter)&&(d.filter=t.filter),d.limit=null!==(f=null==t?void 0:t.limit)&&void 0!==f?f:100,(null==t?void 0:t.sort)&&(d.sort=Object.entries(null!==(h=t.sort)&&void 0!==h?h:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),d},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}},Re={getOperation:function(){return I.PNSetMembershipsOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)||0===(null==t?void 0:t.channels.length))return\"Channels cannot be empty\"},usePatch:function(){return!0},patchURL:function(e,t){var n,r=e.config;return\"/v2/objects/\".concat(r.subscribeKey,\"/uuids/\").concat(M.encodeString(null!==(n=t.uuid)&&void 0!==n?n:r.getUUID()),\"/channels\")},patchPayload:function(e,t){var n;return(n={set:[],delete:[]})[t.type]=t.channels.map((function(e){return\"string\"==typeof e?{channel:{id:e}}:{channel:{id:e.id},custom:e.custom,status:e.status}})),n},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n,r,o,i,a,u,c,l,p,f={include:[\"channel.status\",\"channel.type\",\"status\"]};return(null==t?void 0:t.include)&&((null===(n=t.include)||void 0===n?void 0:n.customFields)&&f.include.push(\"custom\"),(null===(r=t.include)||void 0===r?void 0:r.customChannelFields)&&f.include.push(\"channel.custom\"),(null===(o=t.include)||void 0===o?void 0:o.channelFields)&&f.include.push(\"channel\")),f.include=f.include.join(\",\"),(null===(i=null==t?void 0:t.include)||void 0===i?void 0:i.totalCount)&&(f.count=!0),(null===(a=null==t?void 0:t.page)||void 0===a?void 0:a.next)&&(f.start=null===(u=t.page)||void 0===u?void 0:u.next),(null===(c=null==t?void 0:t.page)||void 0===c?void 0:c.prev)&&(f.end=null===(l=t.page)||void 0===l?void 0:l.prev),(null==t?void 0:t.filter)&&(f.filter=t.filter),null!=t.limit&&(f.limit=t.limit),(null==t?void 0:t.sort)&&(f.sort=Object.entries(null!==(p=t.sort)&&void 0!==p?p:{}).map((function(e){var t=s(e,2),n=t[0],r=t[1];return\"asc\"===r||\"desc\"===r?\"\".concat(n,\":\").concat(r):n}))),f},handleResponse:function(e,t){return{status:t.status,data:t.data,totalCount:t.totalCount,prev:t.prev,next:t.next}}};var Ue=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerAudit},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/audit/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channel,r=t.channelGroup,o=t.authKeys,i=void 0===o?[]:o,a={};return n&&(a.channel=n),r&&(a[\"channel-group\"]=r),i.length>0&&(a.auth=i.join(\",\")),a},handleResponse:function(e,t){return t.payload}});var Ie=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrant},validateParams:function(e,t){var n=e.config;return n.subscribeKey?n.publishKey?n.secretKey?null==t.uuids||t.authKeys?null==t.uuids||null==t.channels&&null==t.channelGroups?void 0:\"Both channel/channelgroup and uuid cannot be used in the same request\":\"authKeys are required for grant request on uuids\":\"Missing Secret Key\":\"Missing Publish Key\":\"Missing Subscribe Key\"},getURL:function(e){var t=e.config;return\"/v2/auth/grant/sub-key/\".concat(t.subscribeKey)},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.channelGroups,i=void 0===o?[]:o,a=t.uuids,s=void 0===a?[]:a,u=t.ttl,c=t.read,l=void 0!==c&&c,p=t.write,f=void 0!==p&&p,h=t.manage,d=void 0!==h&&h,y=t.get,g=void 0!==y&&y,b=t.join,v=void 0!==b&&b,m=t.update,_=void 0!==m&&m,O=t.authKeys,S=void 0===O?[]:O,P=t.delete,w={};return w.r=l?\"1\":\"0\",w.w=f?\"1\":\"0\",w.m=d?\"1\":\"0\",w.d=P?\"1\":\"0\",w.g=g?\"1\":\"0\",w.j=v?\"1\":\"0\",w.u=_?\"1\":\"0\",r.length>0&&(w.channel=r.join(\",\")),i.length>0&&(w[\"channel-group\"]=i.join(\",\")),S.length>0&&(w.auth=S.join(\",\")),s.length>0&&(w[\"target-uuid\"]=s.join(\",\")),(u||0===u)&&(w.ttl=u),w},handleResponse:function(){return{}}});function xe(e){var t,n,r,o,i=void 0!==(null==e?void 0:e.authorizedUserId),a=void 0!==(null===(t=null==e?void 0:e.resources)||void 0===t?void 0:t.users),s=void 0!==(null===(n=null==e?void 0:e.resources)||void 0===n?void 0:n.spaces),u=void 0!==(null===(r=null==e?void 0:e.patterns)||void 0===r?void 0:r.users),c=void 0!==(null===(o=null==e?void 0:e.patterns)||void 0===o?void 0:o.spaces);return u||a||c||s||i}function De(e){var t=0;return e.join&&(t|=128),e.update&&(t|=64),e.get&&(t|=32),e.delete&&(t|=8),e.manage&&(t|=4),e.write&&(t|=2),e.read&&(t|=1),t}function Fe(e,t){if(xe(t))return function(e,t){var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorizedUserId,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.users,c=r.spaces,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.users,f=o.spaces,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}(0,t);var n=t.ttl,r=t.resources,o=t.patterns,i=t.meta,a=t.authorized_uuid,s={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(r){var u=r.uuids,c=r.channels,l=r.groups;u&&Object.keys(u).forEach((function(e){s.permissions.resources.uuids[e]=De(u[e])})),c&&Object.keys(c).forEach((function(e){s.permissions.resources.channels[e]=De(c[e])})),l&&Object.keys(l).forEach((function(e){s.permissions.resources.groups[e]=De(l[e])}))}if(o){var p=o.uuids,f=o.channels,h=o.groups;p&&Object.keys(p).forEach((function(e){s.permissions.patterns.uuids[e]=De(p[e])})),f&&Object.keys(f).forEach((function(e){s.permissions.patterns.channels[e]=De(f[e])})),h&&Object.keys(h).forEach((function(e){s.permissions.patterns.groups[e]=De(h[e])}))}return(n||0===n)&&(s.ttl=n),i&&(s.permissions.meta=i),a&&(s.permissions.uuid=\"\".concat(a)),s}var Ge=Object.freeze({__proto__:null,getOperation:function(){return I.PNAccessManagerGrantToken},extractPermissions:De,validateParams:function(e,t){var n,r,o,i,a,s,u=e.config;if(!u.subscribeKey)return\"Missing Subscribe Key\";if(!u.publishKey)return\"Missing Publish Key\";if(!u.secretKey)return\"Missing Secret Key\";if(!t.resources&&!t.patterns)return\"Missing either Resources or Patterns.\";var c=void 0!==(null==t?void 0:t.authorized_uuid),l=void 0!==(null===(n=null==t?void 0:t.resources)||void 0===n?void 0:n.uuids),p=void 0!==(null===(r=null==t?void 0:t.resources)||void 0===r?void 0:r.channels),f=void 0!==(null===(o=null==t?void 0:t.resources)||void 0===o?void 0:o.groups),h=void 0!==(null===(i=null==t?void 0:t.patterns)||void 0===i?void 0:i.uuids),d=void 0!==(null===(a=null==t?void 0:t.patterns)||void 0===a?void 0:a.channels),y=void 0!==(null===(s=null==t?void 0:t.patterns)||void 0===s?void 0:s.groups),g=c||l||h||p||d||f||y;return xe(t)&&g?\"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`\":(!t.resources||t.resources.uuids&&0!==Object.keys(t.resources.uuids).length||t.resources.channels&&0!==Object.keys(t.resources.channels).length||t.resources.groups&&0!==Object.keys(t.resources.groups).length||t.resources.users&&0!==Object.keys(t.resources.users).length||t.resources.spaces&&0!==Object.keys(t.resources.spaces).length)&&(!t.patterns||t.patterns.uuids&&0!==Object.keys(t.patterns.uuids).length||t.patterns.channels&&0!==Object.keys(t.patterns.channels).length||t.patterns.groups&&0!==Object.keys(t.patterns.groups).length||t.patterns.users&&0!==Object.keys(t.patterns.users).length||t.patterns.spaces&&0!==Object.keys(t.patterns.spaces).length)?void 0:\"Missing values for either Resources or Patterns.\"},postURL:function(e){var t=e.config;return\"/v3/pam/\".concat(t.subscribeKey,\"/grant\")},usePost:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(e,t){return Fe(0,t)},handleResponse:function(e,t){return t.data.token}}),Le={getOperation:function(){return I.PNAccessManagerRevokeToken},validateParams:function(e,t){return e.config.secretKey?t?void 0:\"token can't be empty\":\"Missing Secret Key\"},getURL:function(e,t){var n=e.config;return\"/v3/pam/\".concat(n.subscribeKey,\"/grant/\").concat(M.encodeString(t))},useDelete:function(){return!0},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(e){return{uuid:e.config.getUUID()}},handleResponse:function(e,t){return{status:t.status,data:t.data}}};function Ke(e,t){var n=JSON.stringify(t);if(e.cryptoModule){var r=e.cryptoModule.encrypt(n);n=\"string\"==typeof r?r:v(r),n=JSON.stringify(n)}return n||\"\"}var Be=Object.freeze({__proto__:null,getOperation:function(){return I.PNPublishOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},usePost:function(e,t){var n=t.sendByPost;return void 0!==n&&n},getURL:function(e,t){var n=e.config,r=t.channel,o=Ke(e,t.message);return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0/\").concat(M.encodeString(o))},postURL:function(e,t){var n=e.config,r=t.channel;return\"/publish/\".concat(n.publishKey,\"/\").concat(n.subscribeKey,\"/0/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(e,t){return Ke(e,t.message)},prepareParams:function(e,t){var n=t.meta,r=t.replicate,o=void 0===r||r,i=t.storeInHistory,a=t.ttl,s={};return null!=i&&(s.store=i?\"1\":\"0\"),a&&(s.ttl=a),!1===o&&(s.norep=\"true\"),n&&\"object\"==typeof n&&(s.meta=JSON.stringify(n)),s},handleResponse:function(e,t){return{timetoken:t[2]}}});var He=Object.freeze({__proto__:null,getOperation:function(){return I.PNSignalOperation},validateParams:function(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing Message\":\"Missing Channel\"},getURL:function(e,t){var n,r=e.config,o=t.channel,i=t.message,a=(n=i,JSON.stringify(n));return\"/signal/\".concat(r.publishKey,\"/\").concat(r.subscribeKey,\"/0/\").concat(M.encodeString(o),\"/0/\").concat(M.encodeString(a))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(e,t){return{timetoken:t[2]}}});function qe(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}var ze=Object.freeze({__proto__:null,getOperation:function(){return I.PNHistoryOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v2/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o=t.reverse,i=t.count,a=void 0===i?100:i,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p={include_token:\"true\"};return p.count=a,n&&(p.start=n),r&&(p.end=r),u&&(p.string_message_token=\"true\"),null!=o&&(p.reverse=o.toString()),l&&(p.include_meta=\"true\"),p},handleResponse:function(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return Array.isArray(t[0])&&t[0].forEach((function(t){var r={timetoken:t.timetoken,entry:qe(e,t.message)};t.meta&&(r.meta=t.meta),n.messages.push(r)})),n}});var Ve=Object.freeze({__proto__:null,getOperation:function(){return I.PNDeleteMessagesOperation},validateParams:function(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},useDelete:function(){return!0},getURL:function(e,t){var n=t.channel,r=e.config;return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/channel/\").concat(M.encodeString(n))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.start,r=t.end,o={};return n&&(o.start=n),r&&(o.end=r),o},handleResponse:function(e,t){return t.payload}});var We=Object.freeze({__proto__:null,getOperation:function(){return I.PNMessageCounts},validateParams:function(e,t){var n=t.channels,r=t.timetoken,o=t.channelTimetokens,i=e.config;return n?r&&o?\"timetoken and channelTimetokens are incompatible together\":o&&o.length>1&&n.length!==o.length?\"Length of channelTimetokens and channels do not match\":i.subscribeKey?void 0:\"Missing Subscribe Key\":\"Missing channel\"},getURL:function(e,t){var n=t.channels,r=e.config,o=n.join(\",\");return\"/v3/history/sub-key/\".concat(r.subscribeKey,\"/message-counts/\").concat(M.encodeString(o))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.timetoken,r=t.channelTimetokens,o={};if(r&&1===r.length){var i=s(r,1)[0];o.timetoken=i}else r?o.channelsTimetoken=r.join(\",\"):n&&(o.timetoken=n);return o},handleResponse:function(e,t){return{channels:t.channels}}});var Je=Object.freeze({__proto__:null,getOperation:function(){return I.PNFetchMessagesOperation},validateParams:function(e,t){var n=t.channels,r=t.includeMessageActions,o=void 0!==r&&r,i=e.config;if(!n||0===n.length)return\"Missing channels\";if(!i.subscribeKey)return\"Missing Subscribe Key\";if(o&&n.length>1)throw new TypeError(\"History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.\")},getURL:function(e,t){var n=t.channels,r=void 0===n?[]:n,o=t.includeMessageActions,i=void 0!==o&&o,a=e.config,s=i?\"history-with-actions\":\"history\",u=r.length>0?r.join(\",\"):\",\";return\"/v3/\".concat(s,\"/sub-key/\").concat(a.subscribeKey,\"/channel/\").concat(M.encodeString(u))},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=t.channels,r=t.start,o=t.end,i=t.includeMessageActions,a=t.count,s=t.stringifiedTimeToken,u=void 0!==s&&s,c=t.includeMeta,l=void 0!==c&&c,p=t.includeUuid,f=t.includeUUID,h=void 0===f||f,d=t.includeMessageType,y=void 0===d||d,g={};return g.max=a||(n.length>1||!0===i?25:100),r&&(g.start=r),o&&(g.end=o),u&&(g.string_message_token=\"true\"),l&&(g.include_meta=\"true\"),h&&!1!==p&&(g.include_uuid=\"true\"),y&&(g.include_message_type=\"true\"),g},handleResponse:function(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach((function(r){n.channels[r]=[],(t.channels[r]||[]).forEach((function(t){var o={};o.channel=r,o.timetoken=t.timetoken,o.message=function(e,t){if(!e.cryptoModule)return t;try{var n=e.cryptoModule.decrypt(t);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}catch(e){return console&&console.log&&console.log(\"decryption error\",e.message),t}}(e,t.message),o.messageType=t.message_type,o.uuid=t.uuid,t.actions&&(o.actions=t.actions,o.data=t.actions),t.meta&&(o.meta=t.meta),n.channels[r].push(o)}))})),t.more&&(n.more=t.more),n}});var $e=Object.freeze({__proto__:null,getOperation:function(){return I.PNTimeOperation},getURL:function(){return\"/time/0\"},getRequestTimeout:function(e){return e.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(e,t){return{timetoken:t[0]}},validateParams:function(){}});var Qe=Object.freeze({__proto__:null,getOperation:function(){return I.PNSubscribeOperation},validateParams:function(e){if(!e.config.subscribeKey)return\"Missing Subscribe Key\"},getURL:function(e,t){var n=e.config,r=t.channels,o=void 0===r?[]:r,i=o.length>0?o.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(i),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n=e.config,r=t.state,o=t.channelGroups,i=void 0===o?[]:o,a=t.timetoken,s=t.filterExpression,u=t.region,c={heartbeat:n.getPresenceTimeout()};return i.length>0&&(c[\"channel-group\"]=i.join(\",\")),s&&s.length>0&&(c[\"filter-expr\"]=s),Object.keys(r).length&&(c.state=JSON.stringify(r)),a&&(c.tt=a),u&&(c.tr=u),c},handleResponse:function(e,t){var n=[];t.m.forEach((function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)}));var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}}),Xe={getOperation:function(){return I.PNHandshakeOperation},validateParams:function(e,t){if(!(null==t?void 0:t.channels)&&!(null==t?void 0:t.channelGroups))return\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=0,n},handleResponse:function(e,t){return{region:t.t.r,timetoken:t.t.t}}},Ye={getOperation:function(){return I.PNReceiveMessagesOperation},validateParams:function(e,t){return(null==t?void 0:t.channels)||(null==t?void 0:t.channelGroups)?(null==t?void 0:t.timetoken)?(null==t?void 0:t.region)?void 0:\"region can not be empty\":\"timetoken can not be empty\":\"channels and channleGroups both should not be empty\"},getURL:function(e,t){var n=e.config,r=t.channels?t.channels.join(\",\"):\",\";return\"/v2/subscribe/\".concat(n.subscribeKey,\"/\").concat(M.encodeString(r),\"/0\")},getRequestTimeout:function(e){return e.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(e,t){return t.abortSignal},prepareParams:function(e,t){var n={};return t.channelGroups&&t.channelGroups.length>0&&(n[\"channel-group\"]=t.channelGroups.join(\",\")),n.tt=t.timetoken,n.tr=t.region,n},handleResponse:function(e,t){var n=[];return t.m.forEach((function(e){var t={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,messageType:e.e,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:{timetoken:e.p.t,region:e.p.r}};n.push(t)})),{messages:n,metadata:{region:t.t.r,timetoken:t.t.t}}}},Ze=function(){function e(e){void 0===e&&(e=!1),this.sync=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.notify=function(e){var t=this,n=function(){t.listeners.forEach((function(t){t(e)}))};this.sync?n():setTimeout(n,0)},e}(),et=function(){function e(e){this.label=e,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return e.prototype.transition=function(e,t){var n;if(this.transitionMap.has(t.type))return null===(n=this.transitionMap.get(t.type))||void 0===n?void 0:n(e,t)},e.prototype.on=function(e,t){return this.transitionMap.set(e,t),this},e.prototype.with=function(e,t){return[this,e,null!=t?t:[]]},e.prototype.onEnter=function(e){return this.enterEffects.push(e),this},e.prototype.onExit=function(e){return this.exitEffects.push(e),this},e}(),tt=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.describe=function(e){return new et(e)},n.prototype.start=function(e,t){this.currentState=e,this.currentContext=t,this.notify({type:\"engineStarted\",state:e,context:t})},n.prototype.transition=function(e){var t,n,r,o,i,u;if(!this.currentState)throw new Error(\"Start the engine first\");this.notify({type:\"eventReceived\",event:e});var c=this.currentState.transition(this.currentContext,e);if(c){var l=s(c,3),p=l[0],f=l[1],h=l[2];try{for(var d=a(this.currentState.exitEffects),y=d.next();!y.done;y=d.next()){var g=y.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}var b=this.currentState;this.currentState=p;var v=this.currentContext;this.currentContext=f,this.notify({type:\"transitionDone\",fromState:b,fromContext:v,toState:p,toContext:f,event:e});try{for(var m=a(h),_=m.next();!_.done;_=m.next()){g=_.value;this.notify({type:\"invocationDispatched\",invocation:g})}}catch(e){r={error:e}}finally{try{_&&!_.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var O=a(this.currentState.enterEffects),S=O.next();!S.done;S=O.next()){g=S.value;this.notify({type:\"invocationDispatched\",invocation:g(this.currentContext)})}}catch(e){i={error:e}}finally{try{S&&!S.done&&(u=O.return)&&u.call(O)}finally{if(i)throw i.error}}}},n}(Ze),nt=function(){function e(e){this.dependencies=e,this.instances=new Map,this.handlers=new Map}return e.prototype.on=function(e,t){this.handlers.set(e,t)},e.prototype.dispatch=function(e){if(\"CANCEL\"!==e.type){var t=this.handlers.get(e.type);if(!t)throw new Error(\"Unhandled invocation '\".concat(e.type,\"'\"));var n=t(e.payload,this.dependencies);e.managed&&this.instances.set(e.type,n),n.start()}else if(this.instances.has(e.payload)){var r=this.instances.get(e.payload);null==r||r.cancel(),this.instances.delete(e.payload)}},e}();function rt(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:null==t?void 0:t.apply(void 0,u([],s(n),!1))}};return n.type=e,n}function ot(e,t){var n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return{type:e,payload:t.apply(void 0,u([],s(n),!1)),managed:!0}};return n.type=e,n.cancel={type:\"CANCEL\",payload:e,managed:!1},n}var it,at,st,ut=function(e){function n(){var t=this.constructor,n=e.call(this,\"The operation was aborted.\")||this;return n.name=\"AbortError\",Object.setPrototypeOf(n,t.prototype),n}return t(n,e),n}(Error),ct=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._aborted=!1,t}return t(n,e),Object.defineProperty(n.prototype,\"aborted\",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),n.prototype.throwIfAborted=function(){if(this._aborted)throw new ut},n.prototype.abort=function(){this._aborted=!0,this.notify(new ut)},n}(Ze),lt=function(e){function n(t,n,r){var o=e.call(this,t,n)||this;return o.asyncFunction=r,o.abortSignal=new ct,o}return t(n,e),n.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies)},n.prototype.cancel=function(){this.abortSignal.abort()},n}((function(e,t){this.payload=e,this.dependencies=t})),pt=function(e){return function(t,n){return new lt(t,n,e)}},ft=ot(\"HANDSHAKE\",(function(e,t){return{channels:e,groups:t}})),ht=ot(\"RECEIVE_EVENTS\",(function(e,t,n){return{channels:e,groups:t,cursor:n}})),dt=(at=function(e){return e},st=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:it,payload:at.apply(void 0,u([],s(e),!1)),managed:!1}},st.type=it=\"EMIT_EVENTS\",st),yt=ot(\"RECONNECT\",(function(e){return e})),gt=ot(\"HANDSHAKE_RECONNECT\",(function(e){return e})),bt=rt(\"SUBSCRIPTION_CHANGE\",(function(e,t){return{channels:e,groups:t}})),vt=rt(\"DISCONNECT\",(function(){return{}})),mt=rt(\"RECONNECT\",(function(){return{}}));rt(\"RESTORE\",(function(e,t,n,r){return{channels:e,groups:t,timetoken:n,region:r}}));var _t=rt(\"HANDSHAKING_SUCCESS\",(function(e){return e})),Ot=rt(\"HANDSHAKING_FAILURE\",(function(e){return e})),St=rt(\"HANDSHAKING_RECONNECTING_SUCCESS\",(function(e){return{cursor:e}})),Pt=rt(\"HANDSHAKING_RECONNECTING_FAILURE\",(function(e){return e})),wt=rt(\"HANDSHAKING_RECONNECTING_GIVEUP\",(function(){return{}})),Et=rt(\"HANDSHAKING_RECONNECTING_RETRY\",(function(){return{}})),Tt=rt(\"RECEIVING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),At=rt(\"RECEIVING_FAILURE\",(function(e){return e})),Nt=rt(\"RECONNECTING_SUCCESS\",(function(e,t){return{cursor:e,events:t}})),kt=rt(\"RECONNECTING_FAILURE\",(function(e){return e})),Ct=rt(\"RECONNECTING_GIVEUP\",(function(){return{}})),jt=rt(\"RECONNECTING_RETRY\",(function(){return{}})),Mt=function(e){function n(t,n){var r=e.call(this,n)||this;return r.on(ft.type,pt((function(e,n,a){var s=a.handshake;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 2:return r=i.sent(),t.transition(_t(r)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Ot(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(ht.type,pt((function(e,n,a){var s=a.receiveEvents;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:n.throwIfAborted(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 2:return r=i.sent(),t.transition(Tt(r.metadata,r.messages)),[3,4];case 3:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(At(o))]:[3,4];case 4:return[2]}}))}))}))),r.on(dt.type,pt((function(e,t,n){return n.receiveEvents,o(r,void 0,void 0,(function(){return i(this,(function(t){return e.length>0&&console.log(e),[2]}))}))}))),r.on(yt.type,pt((function(e,n,a){var s=a.receiveEvents,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(Ct())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups,timetoken:e.cursor.timetoken,region:e.cursor.region})];case 3:return r=i.sent(),[2,t.transition(Nt(r.metadata,r.messages))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(kt(o))]:[3,5];case 5:return[2]}}))}))}))),r.on(gt.type,pt((function(e,n,a){var s=a.handshake,u=a.shouldRetry,c=a.getRetryDelay,l=a.delay;return o(r,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:return u(e.reason,e.attempts)?(n.throwIfAborted(),[4,l(c(e.attempts))]):[2,t.transition(wt())];case 1:i.sent(),n.throwIfAborted(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,s({abortSignal:n,channels:e.channels,channelGroups:e.groups})];case 3:return r=i.sent(),[2,t.transition(St(r.metadata))];case 4:return(o=i.sent())instanceof Error&&\"Aborted\"===o.message?[2]:o instanceof q?[2,t.transition(Pt(o))]:[3,5];case 5:return[2]}}))}))}))),r}return t(n,e),n}(nt),Rt=new et(\"STOPPED\");Rt.on(bt.type,(function(e,t){return Rt.with({channels:t.payload.channels,groups:t.payload.groups})})),Rt.on(mt.type,(function(e){return Lt.with(n({},e))}));var Ut=new et(\"HANDSHAKE_FAILURE\");Ut.on(Et.type,(function(e){return Gt.with(n(n({},e),{attempts:0}))})),Ut.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var It=new et(\"STOPPED\");It.on(bt.type,(function(e,t){return It.with({channels:t.payload.channels,groups:t.payload.groups,cursor:e.cursor})})),It.on(mt.type,(function(e){return Ft.with(n({},e))}));var xt=new et(\"RECEIVE_FAILURE\");xt.on(jt.type,(function(e){return Dt.with(n(n({},e),{attempts:0}))})),xt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Dt=new et(\"RECEIVE_RECONNECTING\");Dt.onEnter((function(e){return yt(e)})),Dt.onExit((function(){return yt.cancel})),Dt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Dt.on(kt.type,(function(e,t){return Dt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Dt.on(Ct.type,(function(e){return xt.with({groups:e.groups,channels:e.channels,cursor:e.cursor,reason:e.reason})})),Dt.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Ft=new et(\"RECEIVING\");Ft.onEnter((function(e){return ht(e.channels,e.groups,e.cursor)})),Ft.onExit((function(){return ht.cancel})),Ft.on(Tt.type,(function(e,t){return Ft.with(n(n({},e),{cursor:t.payload.cursor}),[dt(t.payload.events)])})),Ft.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Ft.with(n(n({},e),{channels:t.payload.channels,groups:t.payload.groups}))})),Ft.on(At.type,(function(e,t){return Dt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Ft.on(vt.type,(function(e){return It.with({channels:e.channels,groups:e.groups,cursor:e.cursor})}));var Gt=new et(\"HANDSHAKE_RECONNECTING\");Gt.onEnter((function(e){return gt(e)})),Gt.onExit((function(){return yt.cancel})),Gt.on(Nt.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload.cursor},[dt(t.payload.events)])})),Gt.on(kt.type,(function(e,t){return Gt.with(n(n({},e),{attempts:e.attempts+1,reason:t.payload}))})),Gt.on(Ct.type,(function(e){return Ut.with({groups:e.groups,channels:e.channels,reason:e.reason})})),Gt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Lt=new et(\"HANDSHAKING\");Lt.onEnter((function(e){return ft(e.channels,e.groups)})),Lt.onExit((function(){return ft.cancel})),Lt.on(bt.type,(function(e,t){return 0===t.payload.channels.length&&0===t.payload.groups.length?Kt.with(void 0):Lt.with({channels:t.payload.channels,groups:t.payload.groups})})),Lt.on(_t.type,(function(e,t){return Ft.with({channels:e.channels,groups:e.groups,cursor:t.payload})})),Lt.on(Ot.type,(function(e,t){return Gt.with(n(n({},e),{attempts:0,reason:t.payload}))})),Lt.on(vt.type,(function(e){return Rt.with({channels:e.channels,groups:e.groups})}));var Kt=new et(\"UNSUBSCRIBED\");Kt.on(bt.type,(function(e,t){return Lt.with({channels:t.payload.channels,groups:t.payload.groups})}));var Bt=function(){function e(e){var t=this;this.engine=new tt,this.channels=[],this.groups=[],this.dispatcher=new Mt(this.engine,e),this.engine.subscribe((function(e){\"invocationDispatched\"===e.type&&t.dispatcher.dispatch(e.invocation)})),this.engine.start(Kt,void 0)}return Object.defineProperty(e.prototype,\"_engine\",{get:function(){return this.engine},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){var t=e.channels,n=e.groups;this.channels=u(u([],s(this.channels),!1),s(null!=t?t:[]),!1),this.groups=u(u([],s(this.groups),!1),s(null!=n?n:[]),!1),this.engine.transition(bt(this.channels,this.groups))},e.prototype.unsubscribe=function(e){var t=e.channels,n=e.groups;this.channels=this.channels.filter((function(e){var n;return null===(n=!(null==t?void 0:t.includes(e)))||void 0===n||n})),this.groups=this.groups.filter((function(e){var t;return null===(t=!(null==n?void 0:n.includes(e)))||void 0===t||t})),this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.engine.transition(bt(this.channels.slice(0),this.groups.slice(0)))},e.prototype.reconnect=function(){this.engine.transition(mt())},e.prototype.disconnect=function(){this.engine.transition(vt())},e}(),Ht=function(){function e(e){var t=this,r=e.networking,o=e.cbor,i=new g({setup:e});this._config=i;var a=new A({config:i}),c=e.cryptography;r.init(i);var l=new H(i,o);this._tokenManager=l;var p=new x({maximumSamplesCount:6e4});this._telemetryManager=p;var f=this._config.cryptoModule,h={config:i,networking:r,crypto:a,cryptography:c,tokenManager:l,telemetryManager:p,PubNubFile:e.PubNubFile,cryptoModule:f};this.File=e.PubNubFile,this.encryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.encryptFile(t,this.File)):c.encryptFile(e,t,this.File)},this.decryptFile=function(e,t){return 1==arguments.length&&\"string\"!=typeof e&&h.cryptoModule?(t=e,h.cryptoModule.decryptFile(t,this.File)):c.decryptFile(e,t,this.File)};var d=Q.bind(this,h,$e),y=Q.bind(this,h,ae),b=Q.bind(this,h,ue),m=Q.bind(this,h,le),_=Q.bind(this,h,Qe),O=new B;if(this._listenerManager=O,this.iAmHere=Q.bind(this,h,ue),this.iAmAway=Q.bind(this,h,ae),this.setPresenceState=Q.bind(this,h,le),this.handshake=Q.bind(this,h,Xe),this.receiveMessages=Q.bind(this,h,Ye),!0===i.enableSubscribeBeta){var S=new Bt({handshake:this.handshake,receiveEvents:this.receiveMessages});this.subscribe=S.subscribe.bind(S),this.unsubscribe=S.unsubscribe.bind(S),this.eventEngine=S}else{var P=new U({timeEndpoint:d,leaveEndpoint:y,heartbeatEndpoint:b,setStateEndpoint:m,subscribeEndpoint:_,crypto:h.crypto,config:h.config,listenerManager:O,getFileUrl:function(e){return me(h,e)},cryptoModule:h.cryptoModule});this.subscribe=P.adaptSubscribeChange.bind(P),this.unsubscribe=P.adaptUnsubscribeChange.bind(P),this.disconnect=P.disconnect.bind(P),this.reconnect=P.reconnect.bind(P),this.unsubscribeAll=P.unsubscribeAll.bind(P),this.getSubscribedChannels=P.getSubscribedChannels.bind(P),this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P),this.setState=P.adaptStateChange.bind(P),this.presence=P.adaptPresenceChange.bind(P),this.destroy=function(e){P.unsubscribeAll(e),P.disconnect()}}this.addListener=O.addListener.bind(O),this.removeListener=O.removeListener.bind(O),this.removeAllListeners=O.removeAllListeners.bind(O),this.parseToken=l.parseToken.bind(l),this.setToken=l.setToken.bind(l),this.getToken=l.getToken.bind(l),this.channelGroups={listGroups:Q.bind(this,h,ee),listChannels:Q.bind(this,h,te),addChannels:Q.bind(this,h,X),removeChannels:Q.bind(this,h,Y),deleteGroup:Q.bind(this,h,Z)},this.push={addChannels:Q.bind(this,h,ne),removeChannels:Q.bind(this,h,re),deleteDevice:Q.bind(this,h,ie),listChannels:Q.bind(this,h,oe)},this.hereNow=Q.bind(this,h,pe),this.whereNow=Q.bind(this,h,se),this.getState=Q.bind(this,h,ce),this.grant=Q.bind(this,h,Ie),this.grantToken=Q.bind(this,h,Ge),this.audit=Q.bind(this,h,Ue),this.revokeToken=Q.bind(this,h,Le),this.publish=Q.bind(this,h,Be),this.fire=function(e,n){return e.replicate=!1,e.storeInHistory=!1,t.publish(e,n)},this.signal=Q.bind(this,h,He),this.history=Q.bind(this,h,ze),this.deleteMessages=Q.bind(this,h,Ve),this.messageCounts=Q.bind(this,h,We),this.fetchMessages=Q.bind(this,h,Je),this.addMessageAction=Q.bind(this,h,fe),this.removeMessageAction=Q.bind(this,h,he),this.getMessageActions=Q.bind(this,h,de),this.listFiles=Q.bind(this,h,ye);var w=Q.bind(this,h,ge);this.publishFile=Q.bind(this,h,be),this.sendFile=ve({generateUploadUrl:w,publishFile:this.publishFile,modules:h}),this.getFileUrl=function(e){return me(h,e)},this.downloadFile=Q.bind(this,h,_e),this.deleteFile=Q.bind(this,h,Oe),this.objects={getAllUUIDMetadata:Q.bind(this,h,Se),getUUIDMetadata:Q.bind(this,h,Pe),setUUIDMetadata:Q.bind(this,h,we),removeUUIDMetadata:Q.bind(this,h,Ee),getAllChannelMetadata:Q.bind(this,h,Te),getChannelMetadata:Q.bind(this,h,Ae),setChannelMetadata:Q.bind(this,h,Ne),removeChannelMetadata:Q.bind(this,h,ke),getChannelMembers:Q.bind(this,h,Ce),setChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"set\"},e)],s(r),!1))},removeChannelMembers:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,je,n({type:\"delete\"},e)],s(r),!1))},getMemberships:Q.bind(this,h,Me),setMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"set\"},e)],s(r),!1))},removeMemberships:function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return Q.call.apply(Q,u([t,h,Re,n({type:\"delete\"},e)],s(r),!1))}},this.createUser=function(e){return t.objects.setUUIDMetadata({uuid:e.userId,data:e.data,include:e.include})},this.updateUser=this.createUser,this.removeUser=function(e){return t.objects.removeUUIDMetadata({uuid:null==e?void 0:e.userId})},this.fetchUser=function(e){return t.objects.getUUIDMetadata({uuid:null==e?void 0:e.userId,include:null==e?void 0:e.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(e){return t.objects.setChannelMetadata({channel:e.spaceId,data:e.data,include:e.include})},this.updateSpace=this.createSpace,this.removeSpace=function(e){return t.objects.removeChannelMetadata({channel:e.spaceId})},this.fetchSpace=function(e){return t.objects.getChannelMetadata({channel:e.spaceId,include:e.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(e){var n,r;return\"string\"==typeof e.spaceId?t.objects.setChannelMembers({channel:e.spaceId,uuids:null===(n=e.users)||void 0===n?void 0:n.map((function(e){return\"string\"==typeof e?e:{id:e.userId,custom:e.custom,status:e.status}})),limit:0}):t.objects.setMemberships({uuid:e.userId,channels:null===(r=e.spaces)||void 0===r?void 0:r.map((function(e){return\"string\"==typeof e?e:{id:e.spaceId,custom:e.custom,status:e.status}})),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.removeChannelMembers({channel:e.spaceId,uuids:e.userIds,limit:0}):t.objects.removeMemberships({uuid:e.userId,channels:e.spaceIds,limit:0})},this.fetchMemberships=function(e){return\"string\"==typeof e.spaceId?t.objects.getChannelMembers({channel:e.spaceId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,UUIDFields:e.include.userFields,customUUIDFields:e.include.customUserFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"user\",\"uuid\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{user:e.uuid,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e})):t.objects.getMemberships({uuid:e.userId,filter:e.filter,limit:e.limit,page:e.page,include:{customFields:e.include.customFields,channelFields:e.include.spaceFields,customChannelFields:e.include.customSpaceFields,totalCount:e.include.totalCount},sort:null!=e.sort?Object.fromEntries(Object.entries(e.sort).map((function(e){var t=s(e,2),n=t[0],r=t[1];return[n.replace(\"space\",\"channel\"),r]}))):null}).then((function(e){var t;return e.data=null===(t=e.data)||void 0===t?void 0:t.map((function(e){return{space:e.channel,custom:e.custom,updated:e.updated,eTag:e.eTag}})),e}))},this.time=d,this.stop=this.destroy,this.encrypt=function(e,t){if(void 0===t&&h.cryptoModule){var n=h.cryptoModule.encrypt(e);return\"string\"==typeof n?n:v(n)}return a.encrypt(e,t)},this.decrypt=function(e,t){if(void 0===t&&f){var n=h.cryptoModule.decrypt(e);return n instanceof ArrayBuffer?JSON.parse((new TextDecoder).decode(n)):n}return a.decrypt(e,t)},this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getUserId=h.config.getUserId.bind(h.config),this.setUserId=h.config.setUserId.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config),this.setCipherKey=function(t){return h.config.setCipherKey(t,e,h)},this.setHeartbeatInterval=h.config.setHeartbeatInterval.bind(h.config),r.hasModule(\"proxy\")&&(this.setProxy=function(e){h.config.setProxy(e),t.reconnect()})}return e.prototype.getVersion=function(){return this._config.getVersion()},e.prototype._addPnsdkSuffix=function(e,t){this._config._addPnsdkSuffix(e,t)},e.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},e.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},e.notificationPayload=function(e,t){return new K(e,t)},e.generateUUID=function(){return y()},e.OPERATIONS=I,e.CATEGORIES=R,e}(),qt=function(){function e(e){var t=this;this._modules={},Object.keys(e).forEach((function(n){t._modules[n]=e[n].bind(t)}))}return e.prototype.init=function(e){this._config=e,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},e.prototype.nextOrigin=function(){var e=this._config.secure?\"https://\":\"http://\";if(\"string\"==typeof this._config.origin)return\"\".concat(e).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var t=this._config.origin[this._currentSubDomain];return\"\".concat(e).concat(t)},e.prototype.hasModule=function(e){return e in this._modules},e.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},e.prototype.getStandardOrigin=function(){return this._standardOrigin},e.prototype.POSTFILE=function(e,t,n){return this._modules.postfile(e,t,n)},e.prototype.GETFILE=function(e,t,n){return this._modules.getfile(e,t,n)},e.prototype.POST=function(e,t,n,r){return this._modules.post(e,t,n,r)},e.prototype.PATCH=function(e,t,n,r){return this._modules.patch(e,t,n,r)},e.prototype.GET=function(e,t,n){return this._modules.get(e,t,n)},e.prototype.DELETE=function(e,t,n){return this._modules.del(e,t,n)},e.prototype._detectErrorCategory=function(e){if(\"ENOTFOUND\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNREFUSED\"===e.code)return R.PNNetworkIssuesCategory;if(\"ECONNRESET\"===e.code)return R.PNNetworkIssuesCategory;if(\"EAI_AGAIN\"===e.code)return R.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty(\"status\")&&void 0===e.status)return R.PNNetworkIssuesCategory;if(e.timeout)return R.PNTimeoutCategory;if(\"ETIMEDOUT\"===e.code)return R.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return R.PNBadRequestCategory;if(e.response.forbidden)return R.PNAccessDeniedCategory}return R.PNUnknownCategory},e}();function zt(e){var t=function(e){return e&&\"object\"==typeof e&&e.constructor===Object};if(!t(e))return e;var n={};return Object.keys(e).forEach((function(r){var o=function(e){return\"string\"==typeof e||e instanceof String}(r),i=r,a=e[r];Array.isArray(r)||o&&r.indexOf(\",\")>=0?i=(o?r.split(\",\"):r).reduce((function(e,t){return e+=String.fromCharCode(t)}),\"\"):(function(e){return\"number\"==typeof e&&isFinite(e)}(r)||o&&!isNaN(r))&&(i=String.fromCharCode(o?parseInt(r,10):10));n[i]=t(a)?zt(a):a})),n}var Vt=function(){function e(e,t){this._base64ToBinary=t,this._decode=e}return e.prototype.decodeToken=function(e){var t=\"\";e.length%4==3?t=\"=\":e.length%4==2&&(t=\"==\");var n=e.replace(/-/gi,\"+\").replace(/_/gi,\"/\")+t,r=this._decode(this._base64ToBinary(n));if(\"object\"==typeof r)return r},e}(),Wt={exports:{}},Jt={exports:{}};!function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+e]=this._callbacks[\"$\"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[\"$\"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[\"$\"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks[\"$\"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks[\"$\"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(Jt);var $t=tn;tn.default=tn,tn.stable=an,tn.stableStringify=an;var Qt=\"[...]\",Xt=\"[Circular]\",Yt=[],Zt=[];function en(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function tn(e,t,n,r){var o;void 0===r&&(r=en()),rn(e,\"\",0,[],void 0,0,r);try{o=0===Zt.length?JSON.stringify(e,t,n):JSON.stringify(e,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var i=Yt.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return o}function nn(e,t,n,r){var o=Object.getOwnPropertyDescriptor(r,n);void 0!==o.get?o.configurable?(Object.defineProperty(r,n,{value:e}),Yt.push([r,n,t,o])):Zt.push([t,n,e]):(r[n]=e,Yt.push([r,n,t]))}function rn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)rn(e[s],s,s,r,e,i,a);else{var u=Object.keys(e);for(s=0;s<u.length;s++){var c=u[s];rn(e[c],c,s,r,e,i,a)}}r.pop()}}function on(e,t){return e<t?-1:e>t?1:0}function an(e,t,n,r){void 0===r&&(r=en());var o,i=sn(e,\"\",0,[],void 0,0,r)||e;try{o=0===Zt.length?JSON.stringify(i,t,n):JSON.stringify(i,un(t),n)}catch(e){return JSON.stringify(\"[unable to serialize, circular reference is too complex to analyze]\")}finally{for(;0!==Yt.length;){var a=Yt.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function sn(e,t,n,r,o,i,a){var s;if(i+=1,\"object\"==typeof e&&null!==e){for(s=0;s<r.length;s++)if(r[s]===e)return void nn(Xt,e,t,o);try{if(\"function\"==typeof e.toJSON)return}catch(e){return}if(void 0!==a.depthLimit&&i>a.depthLimit)return void nn(Qt,e,t,o);if(void 0!==a.edgesLimit&&n+1>a.edgesLimit)return void nn(Qt,e,t,o);if(r.push(e),Array.isArray(e))for(s=0;s<e.length;s++)sn(e[s],s,s,r,e,i,a);else{var u={},c=Object.keys(e).sort(on);for(s=0;s<c.length;s++){var l=c[s];sn(e[l],l,s,r,e,i,a),u[l]=e[l]}if(void 0===o)return u;Yt.push([o,t,e]),o[t]=u}r.pop()}}function un(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(Zt.length>0)for(var r=0;r<Zt.length;r++){var o=Zt[r];if(o[1]===t&&o[0]===n){n=o[2],Zt.splice(r,1);break}}return e.call(this,t,n)}}var cn,ln=\"undefined\"!=typeof Symbol&&Symbol,pn=function(){if(\"function\"!=typeof Symbol||\"function\"!=typeof Object.getOwnPropertySymbols)return!1;if(\"symbol\"==typeof Symbol.iterator)return!0;var e={},t=Symbol(\"test\"),n=Object(t);if(\"string\"==typeof t)return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(t))return!1;if(\"[object Symbol]\"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if(\"function\"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if(\"function\"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(\"function\"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0},fn=\"Function.prototype.bind called on incompatible \",hn=Array.prototype.slice,dn=Object.prototype.toString,yn=\"[object Function]\",gn=function(e){var t=this;if(\"function\"!=typeof t||dn.call(t)!==yn)throw new TypeError(fn+t);for(var n,r=hn.call(arguments,1),o=function(){if(this instanceof n){var o=t.apply(this,r.concat(hn.call(arguments)));return Object(o)===o?o:this}return t.apply(e,r.concat(hn.call(arguments)))},i=Math.max(0,t.length-r.length),a=[],s=0;s<i;s++)a.push(\"$\"+s);if(n=Function(\"binder\",\"return function (\"+a.join(\",\")+\"){ return binder.apply(this,arguments); }\")(o),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n},bn=Function.prototype.bind||gn,vn=bn.call(Function.call,Object.prototype.hasOwnProperty),mn=SyntaxError,_n=Function,On=TypeError,Sn=function(e){try{return _n('\"use strict\"; return ('+e+\").constructor;\")()}catch(e){}},Pn=Object.getOwnPropertyDescriptor;if(Pn)try{Pn({},\"\")}catch(e){Pn=null}var wn=function(){throw new On},En=Pn?function(){try{return wn}catch(e){try{return Pn(arguments,\"callee\").get}catch(e){return wn}}}():wn,Tn=\"function\"==typeof ln&&\"function\"==typeof Symbol&&\"symbol\"==typeof ln(\"foo\")&&\"symbol\"==typeof Symbol(\"bar\")&&pn(),An=Object.getPrototypeOf||function(e){return e.__proto__},Nn={},kn=\"undefined\"==typeof Uint8Array?cn:An(Uint8Array),Cn={\"%AggregateError%\":\"undefined\"==typeof AggregateError?cn:AggregateError,\"%Array%\":Array,\"%ArrayBuffer%\":\"undefined\"==typeof ArrayBuffer?cn:ArrayBuffer,\"%ArrayIteratorPrototype%\":Tn?An([][Symbol.iterator]()):cn,\"%AsyncFromSyncIteratorPrototype%\":cn,\"%AsyncFunction%\":Nn,\"%AsyncGenerator%\":Nn,\"%AsyncGeneratorFunction%\":Nn,\"%AsyncIteratorPrototype%\":Nn,\"%Atomics%\":\"undefined\"==typeof Atomics?cn:Atomics,\"%BigInt%\":\"undefined\"==typeof BigInt?cn:BigInt,\"%Boolean%\":Boolean,\"%DataView%\":\"undefined\"==typeof DataView?cn:DataView,\"%Date%\":Date,\"%decodeURI%\":decodeURI,\"%decodeURIComponent%\":decodeURIComponent,\"%encodeURI%\":encodeURI,\"%encodeURIComponent%\":encodeURIComponent,\"%Error%\":Error,\"%eval%\":eval,\"%EvalError%\":EvalError,\"%Float32Array%\":\"undefined\"==typeof Float32Array?cn:Float32Array,\"%Float64Array%\":\"undefined\"==typeof Float64Array?cn:Float64Array,\"%FinalizationRegistry%\":\"undefined\"==typeof FinalizationRegistry?cn:FinalizationRegistry,\"%Function%\":_n,\"%GeneratorFunction%\":Nn,\"%Int8Array%\":\"undefined\"==typeof Int8Array?cn:Int8Array,\"%Int16Array%\":\"undefined\"==typeof Int16Array?cn:Int16Array,\"%Int32Array%\":\"undefined\"==typeof Int32Array?cn:Int32Array,\"%isFinite%\":isFinite,\"%isNaN%\":isNaN,\"%IteratorPrototype%\":Tn?An(An([][Symbol.iterator]())):cn,\"%JSON%\":\"object\"==typeof JSON?JSON:cn,\"%Map%\":\"undefined\"==typeof Map?cn:Map,\"%MapIteratorPrototype%\":\"undefined\"!=typeof Map&&Tn?An((new Map)[Symbol.iterator]()):cn,\"%Math%\":Math,\"%Number%\":Number,\"%Object%\":Object,\"%parseFloat%\":parseFloat,\"%parseInt%\":parseInt,\"%Promise%\":\"undefined\"==typeof Promise?cn:Promise,\"%Proxy%\":\"undefined\"==typeof Proxy?cn:Proxy,\"%RangeError%\":RangeError,\"%ReferenceError%\":ReferenceError,\"%Reflect%\":\"undefined\"==typeof Reflect?cn:Reflect,\"%RegExp%\":RegExp,\"%Set%\":\"undefined\"==typeof Set?cn:Set,\"%SetIteratorPrototype%\":\"undefined\"!=typeof Set&&Tn?An((new Set)[Symbol.iterator]()):cn,\"%SharedArrayBuffer%\":\"undefined\"==typeof SharedArrayBuffer?cn:SharedArrayBuffer,\"%String%\":String,\"%StringIteratorPrototype%\":Tn?An(\"\"[Symbol.iterator]()):cn,\"%Symbol%\":Tn?Symbol:cn,\"%SyntaxError%\":mn,\"%ThrowTypeError%\":En,\"%TypedArray%\":kn,\"%TypeError%\":On,\"%Uint8Array%\":\"undefined\"==typeof Uint8Array?cn:Uint8Array,\"%Uint8ClampedArray%\":\"undefined\"==typeof Uint8ClampedArray?cn:Uint8ClampedArray,\"%Uint16Array%\":\"undefined\"==typeof Uint16Array?cn:Uint16Array,\"%Uint32Array%\":\"undefined\"==typeof Uint32Array?cn:Uint32Array,\"%URIError%\":URIError,\"%WeakMap%\":\"undefined\"==typeof WeakMap?cn:WeakMap,\"%WeakRef%\":\"undefined\"==typeof WeakRef?cn:WeakRef,\"%WeakSet%\":\"undefined\"==typeof WeakSet?cn:WeakSet},jn=function e(t){var n;if(\"%AsyncFunction%\"===t)n=Sn(\"async function () {}\");else if(\"%GeneratorFunction%\"===t)n=Sn(\"function* () {}\");else if(\"%AsyncGeneratorFunction%\"===t)n=Sn(\"async function* () {}\");else if(\"%AsyncGenerator%\"===t){var r=e(\"%AsyncGeneratorFunction%\");r&&(n=r.prototype)}else if(\"%AsyncIteratorPrototype%\"===t){var o=e(\"%AsyncGenerator%\");o&&(n=An(o.prototype))}return Cn[t]=n,n},Mn={\"%ArrayBufferPrototype%\":[\"ArrayBuffer\",\"prototype\"],\"%ArrayPrototype%\":[\"Array\",\"prototype\"],\"%ArrayProto_entries%\":[\"Array\",\"prototype\",\"entries\"],\"%ArrayProto_forEach%\":[\"Array\",\"prototype\",\"forEach\"],\"%ArrayProto_keys%\":[\"Array\",\"prototype\",\"keys\"],\"%ArrayProto_values%\":[\"Array\",\"prototype\",\"values\"],\"%AsyncFunctionPrototype%\":[\"AsyncFunction\",\"prototype\"],\"%AsyncGenerator%\":[\"AsyncGeneratorFunction\",\"prototype\"],\"%AsyncGeneratorPrototype%\":[\"AsyncGeneratorFunction\",\"prototype\",\"prototype\"],\"%BooleanPrototype%\":[\"Boolean\",\"prototype\"],\"%DataViewPrototype%\":[\"DataView\",\"prototype\"],\"%DatePrototype%\":[\"Date\",\"prototype\"],\"%ErrorPrototype%\":[\"Error\",\"prototype\"],\"%EvalErrorPrototype%\":[\"EvalError\",\"prototype\"],\"%Float32ArrayPrototype%\":[\"Float32Array\",\"prototype\"],\"%Float64ArrayPrototype%\":[\"Float64Array\",\"prototype\"],\"%FunctionPrototype%\":[\"Function\",\"prototype\"],\"%Generator%\":[\"GeneratorFunction\",\"prototype\"],\"%GeneratorPrototype%\":[\"GeneratorFunction\",\"prototype\",\"prototype\"],\"%Int8ArrayPrototype%\":[\"Int8Array\",\"prototype\"],\"%Int16ArrayPrototype%\":[\"Int16Array\",\"prototype\"],\"%Int32ArrayPrototype%\":[\"Int32Array\",\"prototype\"],\"%JSONParse%\":[\"JSON\",\"parse\"],\"%JSONStringify%\":[\"JSON\",\"stringify\"],\"%MapPrototype%\":[\"Map\",\"prototype\"],\"%NumberPrototype%\":[\"Number\",\"prototype\"],\"%ObjectPrototype%\":[\"Object\",\"prototype\"],\"%ObjProto_toString%\":[\"Object\",\"prototype\",\"toString\"],\"%ObjProto_valueOf%\":[\"Object\",\"prototype\",\"valueOf\"],\"%PromisePrototype%\":[\"Promise\",\"prototype\"],\"%PromiseProto_then%\":[\"Promise\",\"prototype\",\"then\"],\"%Promise_all%\":[\"Promise\",\"all\"],\"%Promise_reject%\":[\"Promise\",\"reject\"],\"%Promise_resolve%\":[\"Promise\",\"resolve\"],\"%RangeErrorPrototype%\":[\"RangeError\",\"prototype\"],\"%ReferenceErrorPrototype%\":[\"ReferenceError\",\"prototype\"],\"%RegExpPrototype%\":[\"RegExp\",\"prototype\"],\"%SetPrototype%\":[\"Set\",\"prototype\"],\"%SharedArrayBufferPrototype%\":[\"SharedArrayBuffer\",\"prototype\"],\"%StringPrototype%\":[\"String\",\"prototype\"],\"%SymbolPrototype%\":[\"Symbol\",\"prototype\"],\"%SyntaxErrorPrototype%\":[\"SyntaxError\",\"prototype\"],\"%TypedArrayPrototype%\":[\"TypedArray\",\"prototype\"],\"%TypeErrorPrototype%\":[\"TypeError\",\"prototype\"],\"%Uint8ArrayPrototype%\":[\"Uint8Array\",\"prototype\"],\"%Uint8ClampedArrayPrototype%\":[\"Uint8ClampedArray\",\"prototype\"],\"%Uint16ArrayPrototype%\":[\"Uint16Array\",\"prototype\"],\"%Uint32ArrayPrototype%\":[\"Uint32Array\",\"prototype\"],\"%URIErrorPrototype%\":[\"URIError\",\"prototype\"],\"%WeakMapPrototype%\":[\"WeakMap\",\"prototype\"],\"%WeakSetPrototype%\":[\"WeakSet\",\"prototype\"]},Rn=bn,Un=vn,In=Rn.call(Function.call,Array.prototype.concat),xn=Rn.call(Function.apply,Array.prototype.splice),Dn=Rn.call(Function.call,String.prototype.replace),Fn=Rn.call(Function.call,String.prototype.slice),Gn=/[^%.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|%$))/g,Ln=/\\\\(\\\\)?/g,Kn=function(e){var t=Fn(e,0,1),n=Fn(e,-1);if(\"%\"===t&&\"%\"!==n)throw new mn(\"invalid intrinsic syntax, expected closing `%`\");if(\"%\"===n&&\"%\"!==t)throw new mn(\"invalid intrinsic syntax, expected opening `%`\");var r=[];return Dn(e,Gn,(function(e,t,n,o){r[r.length]=n?Dn(o,Ln,\"$1\"):t||e})),r},Bn=function(e,t){var n,r=e;if(Un(Mn,r)&&(r=\"%\"+(n=Mn[r])[0]+\"%\"),Un(Cn,r)){var o=Cn[r];if(o===Nn&&(o=jn(r)),void 0===o&&!t)throw new On(\"intrinsic \"+e+\" exists, but is not available. Please file an issue!\");return{alias:n,name:r,value:o}}throw new mn(\"intrinsic \"+e+\" does not exist!\")},Hn=function(e,t){if(\"string\"!=typeof e||0===e.length)throw new On(\"intrinsic name must be a non-empty string\");if(arguments.length>1&&\"boolean\"!=typeof t)throw new On('\"allowMissing\" argument must be a boolean');var n=Kn(e),r=n.length>0?n[0]:\"\",o=Bn(\"%\"+r+\"%\",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(r=u[0],xn(n,In([0,1],u)));for(var c=1,l=!0;c<n.length;c+=1){var p=n[c],f=Fn(p,0,1),h=Fn(p,-1);if(('\"'===f||\"'\"===f||\"`\"===f||'\"'===h||\"'\"===h||\"`\"===h)&&f!==h)throw new mn(\"property names with quotes must have matching quotes\");if(\"constructor\"!==p&&l||(s=!0),Un(Cn,i=\"%\"+(r+=\".\"+p)+\"%\"))a=Cn[i];else if(null!=a){if(!(p in a)){if(!t)throw new On(\"base intrinsic for \"+e+\" exists, but the property is not available.\");return}if(Pn&&c+1>=n.length){var d=Pn(a,p);a=(l=!!d)&&\"get\"in d&&!(\"originalValue\"in d.get)?d.get:a[p]}else l=Un(a,p),a=a[p];l&&!s&&(Cn[i]=a)}}return a},qn={exports:{}};!function(e){var t=bn,n=Hn,r=n(\"%Function.prototype.apply%\"),o=n(\"%Function.prototype.call%\"),i=n(\"%Reflect.apply%\",!0)||t.call(o,r),a=n(\"%Object.getOwnPropertyDescriptor%\",!0),s=n(\"%Object.defineProperty%\",!0),u=n(\"%Math.max%\");if(s)try{s({},\"a\",{value:1})}catch(e){s=null}e.exports=function(e){var n=i(t,o,arguments);if(a&&s){var r=a(n,\"length\");r.configurable&&s(n,\"length\",{value:1+u(0,e.length-(arguments.length-1))})}return n};var c=function(){return i(t,r,arguments)};s?s(e.exports,\"apply\",{value:c}):e.exports.apply=c}(qn);var zn=Hn,Vn=qn.exports,Wn=Vn(zn(\"String.prototype.indexOf\")),Jn=l(Object.freeze({__proto__:null,default:{}})),$n=\"function\"==typeof Map&&Map.prototype,Qn=Object.getOwnPropertyDescriptor&&$n?Object.getOwnPropertyDescriptor(Map.prototype,\"size\"):null,Xn=$n&&Qn&&\"function\"==typeof Qn.get?Qn.get:null,Yn=$n&&Map.prototype.forEach,Zn=\"function\"==typeof Set&&Set.prototype,er=Object.getOwnPropertyDescriptor&&Zn?Object.getOwnPropertyDescriptor(Set.prototype,\"size\"):null,tr=Zn&&er&&\"function\"==typeof er.get?er.get:null,nr=Zn&&Set.prototype.forEach,rr=\"function\"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,or=\"function\"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,ir=\"function\"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,ar=Boolean.prototype.valueOf,sr=Object.prototype.toString,ur=Function.prototype.toString,cr=String.prototype.match,lr=String.prototype.slice,pr=String.prototype.replace,fr=String.prototype.toUpperCase,hr=String.prototype.toLowerCase,dr=RegExp.prototype.test,yr=Array.prototype.concat,gr=Array.prototype.join,br=Array.prototype.slice,vr=Math.floor,mr=\"function\"==typeof BigInt?BigInt.prototype.valueOf:null,_r=Object.getOwnPropertySymbols,Or=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?Symbol.prototype.toString:null,Sr=\"function\"==typeof Symbol&&\"object\"==typeof Symbol.iterator,Pr=\"function\"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Sr||\"symbol\")?Symbol.toStringTag:null,wr=Object.prototype.propertyIsEnumerable,Er=(\"function\"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Tr(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||dr.call(/e/,t))return t;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(\"number\"==typeof e){var r=e<0?-vr(-e):vr(e);if(r!==e){var o=String(r),i=lr.call(t,o.length+1);return pr.call(o,n,\"$&_\")+\".\"+pr.call(pr.call(i,/([0-9]{3})/g,\"$&_\"),/_$/,\"\")}}return pr.call(t,n,\"$&_\")}var Ar=Jn,Nr=Ar.custom,kr=Ur(Nr)?Nr:null;function Cr(e,t,n){var r=\"double\"===(n.quoteStyle||t)?'\"':\"'\";return r+e+r}function jr(e){return pr.call(String(e),/\"/g,\"&quot;\")}function Mr(e){return!(\"[object Array]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Rr(e){return!(\"[object RegExp]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}function Ur(e){if(Sr)return e&&\"object\"==typeof e&&e instanceof Symbol;if(\"symbol\"==typeof e)return!0;if(!e||\"object\"!=typeof e||!Or)return!1;try{return Or.call(e),!0}catch(e){}return!1}var Ir=Object.prototype.hasOwnProperty||function(e){return e in this};function xr(e,t){return Ir.call(e,t)}function Dr(e){return sr.call(e)}function Fr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Gr(e,t){if(e.length>t.maxStringLength){var n=e.length-t.maxStringLength,r=\"... \"+n+\" more character\"+(n>1?\"s\":\"\");return Gr(lr.call(e,0,t.maxStringLength),t)+r}return Cr(pr.call(pr.call(e,/(['\\\\])/g,\"\\\\$1\"),/[\\x00-\\x1f]/g,Lr),\"single\",t)}function Lr(e){var t=e.charCodeAt(0),n={8:\"b\",9:\"t\",10:\"n\",12:\"f\",13:\"r\"}[t];return n?\"\\\\\"+n:\"\\\\x\"+(t<16?\"0\":\"\")+fr.call(t.toString(16))}function Kr(e){return\"Object(\"+e+\")\"}function Br(e){return e+\" { ? }\"}function Hr(e,t,n,r){return e+\" (\"+t+\") {\"+(r?qr(n,r):gr.call(n,\", \"))+\"}\"}function qr(e,t){if(0===e.length)return\"\";var n=\"\\n\"+t.prev+t.base;return n+gr.call(e,\",\"+n)+\"\\n\"+t.prev}function zr(e,t){var n=Mr(e),r=[];if(n){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=xr(e,o)?t(e[o],e):\"\"}var i,a=\"function\"==typeof _r?_r(e):[];if(Sr){i={};for(var s=0;s<a.length;s++)i[\"$\"+a[s]]=a[s]}for(var u in e)xr(e,u)&&(n&&String(Number(u))===u&&u<e.length||Sr&&i[\"$\"+u]instanceof Symbol||(dr.call(/[^\\w$]/,u)?r.push(t(u,e)+\": \"+t(e[u],e)):r.push(u+\": \"+t(e[u],e))));if(\"function\"==typeof _r)for(var c=0;c<a.length;c++)wr.call(e,a[c])&&r.push(\"[\"+t(a[c])+\"]: \"+t(e[a[c]],e));return r}var Vr=Hn,Wr=function(e,t){var n=zn(e,!!t);return\"function\"==typeof n&&Wn(e,\".prototype.\")>-1?Vn(n):n},Jr=function e(t,n,r,o){var i=n||{};if(xr(i,\"quoteStyle\")&&\"single\"!==i.quoteStyle&&\"double\"!==i.quoteStyle)throw new TypeError('option \"quoteStyle\" must be \"single\" or \"double\"');if(xr(i,\"maxStringLength\")&&(\"number\"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option \"maxStringLength\", if provided, must be a positive integer, Infinity, or `null`');var a=!xr(i,\"customInspect\")||i.customInspect;if(\"boolean\"!=typeof a&&\"symbol\"!==a)throw new TypeError(\"option \\\"customInspect\\\", if provided, must be `true`, `false`, or `'symbol'`\");if(xr(i,\"indent\")&&null!==i.indent&&\"\\t\"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option \"indent\" must be \"\\\\t\", an integer > 0, or `null`');if(xr(i,\"numericSeparator\")&&\"boolean\"!=typeof i.numericSeparator)throw new TypeError('option \"numericSeparator\", if provided, must be `true` or `false`');var s=i.numericSeparator;if(void 0===t)return\"undefined\";if(null===t)return\"null\";if(\"boolean\"==typeof t)return t?\"true\":\"false\";if(\"string\"==typeof t)return Gr(t,i);if(\"number\"==typeof t){if(0===t)return 1/0/t>0?\"0\":\"-0\";var u=String(t);return s?Tr(t,u):u}if(\"bigint\"==typeof t){var c=String(t)+\"n\";return s?Tr(t,c):c}var l=void 0===i.depth?5:i.depth;if(void 0===r&&(r=0),r>=l&&l>0&&\"object\"==typeof t)return Mr(t)?\"[Array]\":\"[Object]\";var p=function(e,t){var n;if(\"\\t\"===e.indent)n=\"\\t\";else{if(!(\"number\"==typeof e.indent&&e.indent>0))return null;n=gr.call(Array(e.indent+1),\" \")}return{base:n,prev:gr.call(Array(t+1),n)}}(i,r);if(void 0===o)o=[];else if(Fr(o,t)>=0)return\"[Circular]\";function f(t,n,a){if(n&&(o=br.call(o)).push(n),a){var s={depth:i.depth};return xr(i,\"quoteStyle\")&&(s.quoteStyle=i.quoteStyle),e(t,s,r+1,o)}return e(t,i,r+1,o)}if(\"function\"==typeof t&&!Rr(t)){var h=function(e){if(e.name)return e.name;var t=cr.call(ur.call(e),/^function\\s*([\\w$]+)/);if(t)return t[1];return null}(t),d=zr(t,f);return\"[Function\"+(h?\": \"+h:\" (anonymous)\")+\"]\"+(d.length>0?\" { \"+gr.call(d,\", \")+\" }\":\"\")}if(Ur(t)){var y=Sr?pr.call(String(t),/^(Symbol\\(.*\\))_[^)]*$/,\"$1\"):Or.call(t);return\"object\"!=typeof t||Sr?y:Kr(y)}if(function(e){if(!e||\"object\"!=typeof e)return!1;if(\"undefined\"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return\"string\"==typeof e.nodeName&&\"function\"==typeof e.getAttribute}(t)){for(var g=\"<\"+hr.call(String(t.nodeName)),b=t.attributes||[],v=0;v<b.length;v++)g+=\" \"+b[v].name+\"=\"+Cr(jr(b[v].value),\"double\",i);return g+=\">\",t.childNodes&&t.childNodes.length&&(g+=\"...\"),g+=\"</\"+hr.call(String(t.nodeName))+\">\"}if(Mr(t)){if(0===t.length)return\"[]\";var m=zr(t,f);return p&&!function(e){for(var t=0;t<e.length;t++)if(Fr(e[t],\"\\n\")>=0)return!1;return!0}(m)?\"[\"+qr(m,p)+\"]\":\"[ \"+gr.call(m,\", \")+\" ]\"}if(function(e){return!(\"[object Error]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)){var _=zr(t,f);return\"cause\"in Error.prototype||!(\"cause\"in t)||wr.call(t,\"cause\")?0===_.length?\"[\"+String(t)+\"]\":\"{ [\"+String(t)+\"] \"+gr.call(_,\", \")+\" }\":\"{ [\"+String(t)+\"] \"+gr.call(yr.call(\"[cause]: \"+f(t.cause),_),\", \")+\" }\"}if(\"object\"==typeof t&&a){if(kr&&\"function\"==typeof t[kr]&&Ar)return Ar(t,{depth:l-r});if(\"symbol\"!==a&&\"function\"==typeof t.inspect)return t.inspect()}if(function(e){if(!Xn||!e||\"object\"!=typeof e)return!1;try{Xn.call(e);try{tr.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var O=[];return Yn&&Yn.call(t,(function(e,n){O.push(f(n,t,!0)+\" => \"+f(e,t))})),Hr(\"Map\",Xn.call(t),O,p)}if(function(e){if(!tr||!e||\"object\"!=typeof e)return!1;try{tr.call(e);try{Xn.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var S=[];return nr&&nr.call(t,(function(e){S.push(f(e,t))})),Hr(\"Set\",tr.call(t),S,p)}if(function(e){if(!rr||!e||\"object\"!=typeof e)return!1;try{rr.call(e,rr);try{or.call(e,or)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Br(\"WeakMap\");if(function(e){if(!or||!e||\"object\"!=typeof e)return!1;try{or.call(e,or);try{rr.call(e,rr)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Br(\"WeakSet\");if(function(e){if(!ir||!e||\"object\"!=typeof e)return!1;try{return ir.call(e),!0}catch(e){}return!1}(t))return Br(\"WeakRef\");if(function(e){return!(\"[object Number]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(Number(t)));if(function(e){if(!e||\"object\"!=typeof e||!mr)return!1;try{return mr.call(e),!0}catch(e){}return!1}(t))return Kr(f(mr.call(t)));if(function(e){return!(\"[object Boolean]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(ar.call(t));if(function(e){return!(\"[object String]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t))return Kr(f(String(t)));if(!function(e){return!(\"[object Date]\"!==Dr(e)||Pr&&\"object\"==typeof e&&Pr in e)}(t)&&!Rr(t)){var P=zr(t,f),w=Er?Er(t)===Object.prototype:t instanceof Object||t.constructor===Object,E=t instanceof Object?\"\":\"null prototype\",T=!w&&Pr&&Object(t)===t&&Pr in t?lr.call(Dr(t),8,-1):E?\"Object\":\"\",A=(w||\"function\"!=typeof t.constructor?\"\":t.constructor.name?t.constructor.name+\" \":\"\")+(T||E?\"[\"+gr.call(yr.call([],T||[],E||[]),\": \")+\"] \":\"\");return 0===P.length?A+\"{}\":p?A+\"{\"+qr(P,p)+\"}\":A+\"{ \"+gr.call(P,\", \")+\" }\"}return String(t)},$r=Vr(\"%TypeError%\"),Qr=Vr(\"%WeakMap%\",!0),Xr=Vr(\"%Map%\",!0),Yr=Wr(\"WeakMap.prototype.get\",!0),Zr=Wr(\"WeakMap.prototype.set\",!0),eo=Wr(\"WeakMap.prototype.has\",!0),to=Wr(\"Map.prototype.get\",!0),no=Wr(\"Map.prototype.set\",!0),ro=Wr(\"Map.prototype.has\",!0),oo=function(e,t){for(var n,r=e;null!==(n=r.next);r=n)if(n.key===t)return r.next=n.next,n.next=e.next,e.next=n,n},io=String.prototype.replace,ao=/%20/g,so=\"RFC3986\",uo={default:so,formatters:{RFC1738:function(e){return io.call(e,ao,\"+\")},RFC3986:function(e){return String(e)}},RFC1738:\"RFC1738\",RFC3986:so},co=uo,lo=Object.prototype.hasOwnProperty,po=Array.isArray,fo=function(){for(var e=[],t=0;t<256;++t)e.push(\"%\"+((t<16?\"0\":\"\")+t.toString(16)).toUpperCase());return e}(),ho=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},yo={arrayToObject:ho,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:\"o\"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var u=a[s],c=i[u];\"object\"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:u}),n.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(po(n)){for(var r=[],o=0;o<n.length;++o)void 0!==n[o]&&r.push(n[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,n){var r=e.replace(/\\+/g,\" \");if(\"iso-8859-1\"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,n,r,o){if(0===e.length)return e;var i=e;if(\"symbol\"==typeof e?i=Symbol.prototype.toString.call(e):\"string\"!=typeof e&&(i=String(e)),\"iso-8859-1\"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return\"%26%23\"+parseInt(e.slice(2),16)+\"%3B\"}));for(var a=\"\",s=0;s<i.length;++s){var u=i.charCodeAt(s);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===co.RFC1738&&(40===u||41===u)?a+=i.charAt(s):u<128?a+=fo[u]:u<2048?a+=fo[192|u>>6]+fo[128|63&u]:u<55296||u>=57344?a+=fo[224|u>>12]+fo[128|u>>6&63]+fo[128|63&u]:(s+=1,u=65536+((1023&u)<<10|1023&i.charCodeAt(s)),a+=fo[240|u>>18]+fo[128|u>>12&63]+fo[128|u>>6&63]+fo[128|63&u])}return a},isBuffer:function(e){return!(!e||\"object\"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(po(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)},merge:function e(t,n,r){if(!n)return t;if(\"object\"!=typeof n){if(po(t))t.push(n);else{if(!t||\"object\"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!lo.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||\"object\"!=typeof t)return[t].concat(n);var o=t;return po(t)&&!po(n)&&(o=ho(t,r)),po(t)&&po(n)?(n.forEach((function(n,o){if(lo.call(t,o)){var i=t[o];i&&\"object\"==typeof i&&n&&\"object\"==typeof n?t[o]=e(i,n,r):t.push(n)}else t[o]=n})),t):Object.keys(n).reduce((function(t,o){var i=n[o];return lo.call(t,o)?t[o]=e(t[o],i,r):t[o]=i,t}),o)}},go=function(){var e,t,n,r={assert:function(e){if(!r.has(e))throw new $r(\"Side channel does not contain \"+Jr(e))},get:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return Yr(e,r)}else if(Xr){if(t)return to(t,r)}else if(n)return function(e,t){var n=oo(e,t);return n&&n.value}(n,r)},has:function(r){if(Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)){if(e)return eo(e,r)}else if(Xr){if(t)return ro(t,r)}else if(n)return function(e,t){return!!oo(e,t)}(n,r);return!1},set:function(r,o){Qr&&r&&(\"object\"==typeof r||\"function\"==typeof r)?(e||(e=new Qr),Zr(e,r,o)):Xr?(t||(t=new Xr),no(t,r,o)):(n||(n={key:{},next:null}),function(e,t,n){var r=oo(e,t);r?r.value=n:e.next={key:t,next:e.next,value:n}}(n,r,o))}};return r},bo=yo,vo=uo,mo=Object.prototype.hasOwnProperty,_o={brackets:function(e){return e+\"[]\"},comma:\"comma\",indices:function(e,t){return e+\"[\"+t+\"]\"},repeat:function(e){return e}},Oo=Array.isArray,So=Array.prototype.push,Po=function(e,t){So.apply(e,Oo(t)?t:[t])},wo=Date.prototype.toISOString,Eo=vo.default,To={addQueryPrefix:!1,allowDots:!1,charset:\"utf-8\",charsetSentinel:!1,delimiter:\"&\",encode:!0,encoder:bo.encode,encodeValuesOnly:!1,format:Eo,formatter:vo.formatters[Eo],indices:!1,serializeDate:function(e){return wo.call(e)},skipNulls:!1,strictNullHandling:!1},Ao={},No=function e(t,n,r,o,i,a,s,u,c,l,p,f,h,d,y,g){for(var b,v=t,m=g,_=0,O=!1;void 0!==(m=m.get(Ao))&&!O;){var S=m.get(t);if(_+=1,void 0!==S){if(S===_)throw new RangeError(\"Cyclic object value\");O=!0}void 0===m.get(Ao)&&(_=0)}if(\"function\"==typeof u?v=u(n,v):v instanceof Date?v=p(v):\"comma\"===r&&Oo(v)&&(v=bo.maybeMap(v,(function(e){return e instanceof Date?p(e):e}))),null===v){if(i)return s&&!d?s(n,To.encoder,y,\"key\",f):n;v=\"\"}if(\"string\"==typeof(b=v)||\"number\"==typeof b||\"boolean\"==typeof b||\"symbol\"==typeof b||\"bigint\"==typeof b||bo.isBuffer(v))return s?[h(d?n:s(n,To.encoder,y,\"key\",f))+\"=\"+h(s(v,To.encoder,y,\"value\",f))]:[h(n)+\"=\"+h(String(v))];var P,w=[];if(void 0===v)return w;if(\"comma\"===r&&Oo(v))d&&s&&(v=bo.maybeMap(v,s)),P=[{value:v.length>0?v.join(\",\")||null:void 0}];else if(Oo(u))P=u;else{var E=Object.keys(v);P=c?E.sort(c):E}for(var T=o&&Oo(v)&&1===v.length?n+\"[]\":n,A=0;A<P.length;++A){var N=P[A],k=\"object\"==typeof N&&void 0!==N.value?N.value:v[N];if(!a||null!==k){var C=Oo(v)?\"function\"==typeof r?r(T,N):T:T+(l?\".\"+N:\"[\"+N+\"]\");g.set(t,_);var j=go();j.set(Ao,g),Po(w,e(k,C,r,o,i,a,\"comma\"===r&&d&&Oo(v)?null:s,u,c,l,p,f,h,d,y,j))}}return w},ko=yo,Co=Object.prototype.hasOwnProperty,jo=Array.isArray,Mo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:\"utf-8\",charsetSentinel:!1,comma:!1,decoder:ko.decode,delimiter:\"&\",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Ro=function(e){return e.replace(/&#(\\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Uo=function(e,t){return e&&\"string\"==typeof e&&t.comma&&e.indexOf(\",\")>-1?e.split(\",\"):e},Io=function(e,t,n,r){if(e){var o=n.allowDots?e.replace(/\\.([^.[]+)/g,\"[$1]\"):e,i=/(\\[[^[\\]]*])/g,a=n.depth>0&&/(\\[[^[\\]]*])/.exec(o),s=a?o.slice(0,a.index):o,u=[];if(s){if(!n.plainObjects&&Co.call(Object.prototype,s)&&!n.allowPrototypes)return;u.push(s)}for(var c=0;n.depth>0&&null!==(a=i.exec(o))&&c<n.depth;){if(c+=1,!n.plainObjects&&Co.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push(\"[\"+o.slice(a.index)+\"]\"),function(e,t,n,r){for(var o=r?t:Uo(t,n),i=e.length-1;i>=0;--i){var a,s=e[i];if(\"[]\"===s&&n.parseArrays)a=[].concat(o);else{a=n.plainObjects?Object.create(null):{};var u=\"[\"===s.charAt(0)&&\"]\"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(u,10);n.parseArrays||\"\"!==u?!isNaN(c)&&s!==u&&String(c)===u&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(a=[])[c]=o:\"__proto__\"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,n,r)}},xo=function(e,t){var n,r=e,o=function(e){if(!e)return To;if(null!==e.encoder&&void 0!==e.encoder&&\"function\"!=typeof e.encoder)throw new TypeError(\"Encoder has to be a function.\");var t=e.charset||To.charset;if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var n=vo.default;if(void 0!==e.format){if(!mo.call(vo.formatters,e.format))throw new TypeError(\"Unknown format option provided.\");n=e.format}var r=vo.formatters[n],o=To.filter;return(\"function\"==typeof e.filter||Oo(e.filter))&&(o=e.filter),{addQueryPrefix:\"boolean\"==typeof e.addQueryPrefix?e.addQueryPrefix:To.addQueryPrefix,allowDots:void 0===e.allowDots?To.allowDots:!!e.allowDots,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:To.charsetSentinel,delimiter:void 0===e.delimiter?To.delimiter:e.delimiter,encode:\"boolean\"==typeof e.encode?e.encode:To.encode,encoder:\"function\"==typeof e.encoder?e.encoder:To.encoder,encodeValuesOnly:\"boolean\"==typeof e.encodeValuesOnly?e.encodeValuesOnly:To.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:\"function\"==typeof e.serializeDate?e.serializeDate:To.serializeDate,skipNulls:\"boolean\"==typeof e.skipNulls?e.skipNulls:To.skipNulls,sort:\"function\"==typeof e.sort?e.sort:null,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:To.strictNullHandling}}(t);\"function\"==typeof o.filter?r=(0,o.filter)(\"\",r):Oo(o.filter)&&(n=o.filter);var i,a=[];if(\"object\"!=typeof r||null===r)return\"\";i=t&&t.arrayFormat in _o?t.arrayFormat:t&&\"indices\"in t?t.indices?\"indices\":\"repeat\":\"indices\";var s=_o[i];if(t&&\"commaRoundTrip\"in t&&\"boolean\"!=typeof t.commaRoundTrip)throw new TypeError(\"`commaRoundTrip` must be a boolean, or absent\");var u=\"comma\"===s&&t&&t.commaRoundTrip;n||(n=Object.keys(r)),o.sort&&n.sort(o.sort);for(var c=go(),l=0;l<n.length;++l){var p=n[l];o.skipNulls&&null===r[p]||Po(a,No(r[p],p,s,u,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var f=a.join(o.delimiter),h=!0===o.addQueryPrefix?\"?\":\"\";return o.charsetSentinel&&(\"iso-8859-1\"===o.charset?h+=\"utf8=%26%2310003%3B&\":h+=\"utf8=%E2%9C%93&\"),f.length>0?h+f:\"\"},Do={formats:uo,parse:function(e,t){var n=function(e){if(!e)return Mo;if(null!==e.decoder&&void 0!==e.decoder&&\"function\"!=typeof e.decoder)throw new TypeError(\"Decoder has to be a function.\");if(void 0!==e.charset&&\"utf-8\"!==e.charset&&\"iso-8859-1\"!==e.charset)throw new TypeError(\"The charset option must be either utf-8, iso-8859-1, or undefined\");var t=void 0===e.charset?Mo.charset:e.charset;return{allowDots:void 0===e.allowDots?Mo.allowDots:!!e.allowDots,allowPrototypes:\"boolean\"==typeof e.allowPrototypes?e.allowPrototypes:Mo.allowPrototypes,allowSparse:\"boolean\"==typeof e.allowSparse?e.allowSparse:Mo.allowSparse,arrayLimit:\"number\"==typeof e.arrayLimit?e.arrayLimit:Mo.arrayLimit,charset:t,charsetSentinel:\"boolean\"==typeof e.charsetSentinel?e.charsetSentinel:Mo.charsetSentinel,comma:\"boolean\"==typeof e.comma?e.comma:Mo.comma,decoder:\"function\"==typeof e.decoder?e.decoder:Mo.decoder,delimiter:\"string\"==typeof e.delimiter||ko.isRegExp(e.delimiter)?e.delimiter:Mo.delimiter,depth:\"number\"==typeof e.depth||!1===e.depth?+e.depth:Mo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:\"boolean\"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Mo.interpretNumericEntities,parameterLimit:\"number\"==typeof e.parameterLimit?e.parameterLimit:Mo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:\"boolean\"==typeof e.plainObjects?e.plainObjects:Mo.plainObjects,strictNullHandling:\"boolean\"==typeof e.strictNullHandling?e.strictNullHandling:Mo.strictNullHandling}}(t);if(\"\"===e||null==e)return n.plainObjects?Object.create(null):{};for(var r=\"string\"==typeof e?function(e,t){var n,r={__proto__:null},o=t.ignoreQueryPrefix?e.replace(/^\\?/,\"\"):e,i=t.parameterLimit===1/0?void 0:t.parameterLimit,a=o.split(t.delimiter,i),s=-1,u=t.charset;if(t.charsetSentinel)for(n=0;n<a.length;++n)0===a[n].indexOf(\"utf8=\")&&(\"utf8=%E2%9C%93\"===a[n]?u=\"utf-8\":\"utf8=%26%2310003%3B\"===a[n]&&(u=\"iso-8859-1\"),s=n,n=a.length);for(n=0;n<a.length;++n)if(n!==s){var c,l,p=a[n],f=p.indexOf(\"]=\"),h=-1===f?p.indexOf(\"=\"):f+1;-1===h?(c=t.decoder(p,Mo.decoder,u,\"key\"),l=t.strictNullHandling?null:\"\"):(c=t.decoder(p.slice(0,h),Mo.decoder,u,\"key\"),l=ko.maybeMap(Uo(p.slice(h+1),t),(function(e){return t.decoder(e,Mo.decoder,u,\"value\")}))),l&&t.interpretNumericEntities&&\"iso-8859-1\"===u&&(l=Ro(l)),p.indexOf(\"[]=\")>-1&&(l=jo(l)?[l]:l),Co.call(r,c)?r[c]=ko.combine(r[c],l):r[c]=l}return r}(e,n):e,o=n.plainObjects?Object.create(null):{},i=Object.keys(r),a=0;a<i.length;++a){var s=i[a],u=Io(s,r[s],n,\"string\"==typeof e);o=ko.merge(o,u,n)}return!0===n.allowSparse?o:ko.compact(o)},stringify:xo},Fo={};!function(e){function t(e,t){var r=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if(\"string\"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===r&&e.constructor&&(r=e.constructor.name);if(\"Map\"===r||\"Set\"===r)return Array.from(e);if(\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&\"number\"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.type=e=>e.split(/ *; */).shift(),e.params=e=>{const n={};var r,o=t(e.split(/ *; */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *= */),t=e.shift(),o=e.shift();t&&o&&(n[t]=o)}}catch(e){o.e(e)}finally{o.f()}return n},e.parseLinks=e=>{const n={};var r,o=t(e.split(/ *, */));try{for(o.s();!(r=o.n()).done;){const e=r.value.split(/ *; */),t=e[0].slice(1,-1);n[e[1].split(/ *= */)[1].slice(1,-1)]=t}}catch(e){o.e(e)}finally{o.f()}return n},e.cleanHeader=(e,t)=>(delete e[\"content-type\"],delete e[\"content-length\"],delete e[\"transfer-encoding\"],delete e.host,t&&(delete e.authorization,delete e.cookie),e),e.isObject=e=>null!==e&&\"object\"==typeof e,e.hasOwn=Object.hasOwn||function(e,t){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");return Object.prototype.hasOwnProperty.call(new Object(e),t)},e.mixin=(t,n)=>{for(const r in n)e.hasOwn(n,r)&&(t[r]=n[r])}}(Fo);const Go=Jn,Lo=Fo.isObject,Ko=Fo.hasOwn;var Bo=Ho;function Ho(){}Ho.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},Ho.prototype.parse=function(e){return this._parser=e,this},Ho.prototype.responseType=function(e){return this._responseType=e,this},Ho.prototype.serialize=function(e){return this._serializer=e,this},Ho.prototype.timeout=function(e){if(!e||\"object\"!=typeof e)return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(const t in e)if(Ko(e,t))switch(t){case\"deadline\":this._timeout=e.deadline;break;case\"response\":this._responseTimeout=e.response;break;case\"upload\":this._uploadTimeout=e.upload;break;default:console.warn(\"Unknown timeout option\",t)}return this},Ho.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};const qo=new Set([\"ETIMEDOUT\",\"ECONNRESET\",\"EADDRINUSE\",\"ECONNREFUSED\",\"EPIPE\",\"ENOTFOUND\",\"ENETUNREACH\",\"EAI_AGAIN\"]),zo=new Set([408,413,429,500,502,503,504,521,522,524]);Ho.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{const n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&zo.has(t.status))return!0;if(e){if(e.code&&qo.has(e.code))return!0;if(e.timeout&&\"ECONNABORTED\"===e.code)return!0;if(e.crossDomain)return!0}return!1},Ho.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},Ho.prototype.then=function(e,t){if(!this._fullfilledPromise){const e=this;this._endCalled&&console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\"),this._fullfilledPromise=new Promise(((t,n)=>{e.on(\"abort\",(()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void n(this.timedoutError);const e=new Error(\"Aborted\");e.code=\"ABORTED\",e.status=this.status,e.method=this.method,e.url=this.url,n(e)})),e.end(((e,r)=>{e?n(e):t(r)}))}))}return this._fullfilledPromise.then(e,t)},Ho.prototype.catch=function(e){return this.then(void 0,e)},Ho.prototype.use=function(e){return e(this),this},Ho.prototype.ok=function(e){if(\"function\"!=typeof e)throw new Error(\"Callback required\");return this._okCallback=e,this},Ho.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},Ho.prototype.get=function(e){return this._header[e.toLowerCase()]},Ho.prototype.getHeader=Ho.prototype.get,Ho.prototype.set=function(e,t){if(Lo(e)){for(const t in e)Ko(e,t)&&this.set(t,e[t]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},Ho.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},Ho.prototype.field=function(e,t,n){if(null==e)throw new Error(\".field(name, val) name can not be empty\");if(this._data)throw new Error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");if(Lo(e)){for(const t in e)Ko(e,t)&&this.field(t,e[t]);return this}if(Array.isArray(t)){for(const n in t)Ko(t,n)&&this.field(e,t[n]);return this}if(null==t)throw new Error(\".field(name, val) val can not be empty\");return\"boolean\"==typeof t&&(t=String(t)),n?this._getFormData().append(e,t,n):this._getFormData().append(e,t),this},Ho.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(Go.gte(process.version,\"v13.0.0\")&&Go.lt(process.version,\"v14.0.0\"))throw new Error(\"Superagent does not work in v13 properly with abort() due to Node.js core changes\");this.req.abort()}return this.clearTimeout(),this.emit(\"abort\"),this},Ho.prototype._auth=function(e,t,n,r){switch(n.type){case\"basic\":this.set(\"Authorization\",`Basic ${r(`${e}:${t}`)}`);break;case\"auto\":this.username=e,this.password=t;break;case\"bearer\":this.set(\"Authorization\",`Bearer ${e}`)}return this},Ho.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},Ho.prototype.redirects=function(e){return this._maxRedirects=e,this},Ho.prototype.maxResponseSize=function(e){if(\"number\"!=typeof e)throw new TypeError(\"Invalid argument\");return this._maxResponseSize=e,this},Ho.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},Ho.prototype.send=function(e){const t=Lo(e);let n=this._header[\"content-type\"];if(this._formData)throw new Error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error(\"Can't merge these send calls\");if(t&&Lo(this._data))for(const t in e){if(\"bigint\"==typeof e[t]&&!e[t].toJSON)throw new Error(\"Cannot serialize BigInt value to json\");Ko(e,t)&&(this._data[t]=e[t])}else{if(\"bigint\"==typeof e)throw new Error(\"Cannot send value of type BigInt\");\"string\"==typeof e?(n||this.type(\"form\"),n=this._header[\"content-type\"],n&&(n=n.toLowerCase().trim()),this._data=\"application/x-www-form-urlencoded\"===n?this._data?`${this._data}&${e}`:e:(this._data||\"\")+e):this._data=e}return!t||this._isHost(e)||n||this.type(\"json\"),this},Ho.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},Ho.prototype._finalizeQueryString=function(){const e=this._query.join(\"&\");if(e&&(this.url+=(this.url.includes(\"?\")?\"&\":\"?\")+e),this._query.length=0,this._sort){const e=this.url.indexOf(\"?\");if(e>=0){const t=this.url.slice(e+1).split(\"&\");\"function\"==typeof this._sort?t.sort(this._sort):t.sort(),this.url=this.url.slice(0,e)+\"?\"+t.join(\"&\")}}},Ho.prototype._appendQueryString=()=>{console.warn(\"Unsupported\")},Ho.prototype._timeoutError=function(e,t,n){if(this._aborted)return;const r=new Error(`${e+t}ms exceeded`);r.timeout=t,r.code=\"ECONNABORTED\",r.errno=n,this.timedout=!0,this.timedoutError=r,this.abort(),this.callback(r)},Ho.prototype._setTimeouts=function(){const e=this;this._timeout&&!this._timer&&(this._timer=setTimeout((()=>{e._timeoutError(\"Timeout of \",e._timeout,\"ETIME\")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Response timeout of \",e._responseTimeout,\"ETIMEDOUT\")}),this._responseTimeout))};const Vo=Fo;var Wo=Jo;function Jo(){}function $o(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return Qo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qo(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xo(){this._defaults=[]}Jo.prototype.get=function(e){return this.header[e.toLowerCase()]},Jo.prototype._setHeaderProperties=function(e){const t=e[\"content-type\"]||\"\";this.type=Vo.type(t);const n=Vo.params(t);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(this[e]=n[e]);this.links={};try{e.link&&(this.links=Vo.parseLinks(e.link))}catch(e){}},Jo.prototype._setStatusProperties=function(e){const t=Math.trunc(e/100);this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1===t,this.ok=2===t,this.redirect=3===t,this.clientError=4===t,this.serverError=5===t,this.error=(4===t||5===t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e};for(var Yo=0,Zo=[\"use\",\"on\",\"once\",\"set\",\"query\",\"type\",\"accept\",\"auth\",\"withCredentials\",\"sortQuery\",\"retry\",\"ok\",\"redirects\",\"timeout\",\"buffer\",\"serialize\",\"parse\",\"ca\",\"key\",\"pfx\",\"cert\",\"disableTLSCerts\"];Yo<Zo.length;Yo++){const e=Zo[Yo];Xo.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this._defaults.push({fn:e,args:n}),this}}Xo.prototype._setDefaults=function(e){var t,n=$o(this._defaults);try{for(n.s();!(t=n.n()).done;){const n=t.value;e[n.fn](...n.args)}}catch(e){n.e(e)}finally{n.f()}};var ei=Xo;!function(e,t){function n(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if(\"string\"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}let o;\"undefined\"!=typeof window?o=window:\"undefined\"==typeof self?(console.warn(\"Using browser-only version of superagent in non-browser environment\"),o=void 0):o=self;const i=Jt.exports,a=$t,s=Do,u=Bo,c=Fo.isObject,l=Fo.mixin,p=Fo.hasOwn,f=Wo,h=ei;function d(){}e.exports=function(e,n){return\"function\"==typeof n?new t.Request(\"GET\",e).end(n):1===arguments.length?new t.Request(\"GET\",e):new t.Request(e,n)};const y=t=e.exports;t.Request=S,y.getXHR=()=>{if(o.XMLHttpRequest)return new o.XMLHttpRequest;throw new Error(\"Browser-only version of superagent could not find XHR\")};const g=\"\".trim?e=>e.trim():e=>e.replace(/(^\\s*|\\s*$)/g,\"\");function b(e){if(!c(e))return e;const t=[];for(const n in e)p(e,n)&&v(t,n,e[n]);return t.join(\"&\")}function v(e,t,r){if(void 0!==r)if(null!==r)if(Array.isArray(r)){var o,i=n(r);try{for(i.s();!(o=i.n()).done;){v(e,t,o.value)}}catch(e){i.e(e)}finally{i.f()}}else if(c(r))for(const n in r)p(r,n)&&v(e,`${t}[${n}]`,r[n]);else e.push(encodeURI(t)+\"=\"+encodeURIComponent(r));else e.push(encodeURI(t))}function m(e){const t={},n=e.split(\"&\");let r,o;for(let e=0,i=n.length;e<i;++e)r=n[e],o=r.indexOf(\"=\"),-1===o?t[decodeURIComponent(r)]=\"\":t[decodeURIComponent(r.slice(0,o))]=decodeURIComponent(r.slice(o+1));return t}function _(e){return/[/+]json($|[^-\\w])/i.test(e)}function O(e){this.req=e,this.xhr=this.req.xhr,this.text=\"HEAD\"!==this.req.method&&(\"\"===this.xhr.responseType||\"text\"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){const t=e.split(/\\r?\\n/),n={};let r,o,i,a;for(let e=0,s=t.length;e<s;++e)o=t[e],r=o.indexOf(\":\"),-1!==r&&(i=o.slice(0,r).toLowerCase(),a=g(o.slice(r+1)),n[i]=a);return n}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header[\"content-type\"]=this.xhr.getResponseHeader(\"content-type\"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body=\"HEAD\"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function S(e,t){const n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on(\"end\",(()=>{let e,t=null,r=null;try{r=new O(n)}catch(e){return t=new Error(\"Parser is unable to parse the response\"),t.parse=!0,t.original=e,n.xhr?(t.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,t.status=n.xhr.status?n.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),n.callback(t)}n.emit(\"response\",r);try{n._isResponseOK(r)||(e=new Error(r.statusText||r.text||\"Unsuccessful HTTP response\"))}catch(t){e=t}e?(e.original=t,e.response=r,e.status=e.status||r.status,n.callback(e,r)):n.callback(null,r)}))}y.serializeObject=b,y.parseString=m,y.types={html:\"text/html\",json:\"application/json\",xml:\"text/xml\",urlencoded:\"application/x-www-form-urlencoded\",form:\"application/x-www-form-urlencoded\",\"form-data\":\"application/x-www-form-urlencoded\"},y.serialize={\"application/x-www-form-urlencoded\":s.stringify,\"application/json\":a},y.parse={\"application/x-www-form-urlencoded\":m,\"application/json\":JSON.parse},l(O.prototype,f.prototype),O.prototype._parseBody=function(e){let t=y.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&_(this.type)&&(t=y.parse[\"application/json\"]),t&&e&&(e.length>0||e instanceof Object)?t(e):null)},O.prototype.toError=function(){const e=this.req,t=e.method,n=e.url,r=`cannot ${t} ${n} (${this.status})`,o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},y.Response=O,i(S.prototype),l(S.prototype,u.prototype),S.prototype.type=function(e){return this.set(\"Content-Type\",y.types[e]||e),this},S.prototype.accept=function(e){return this.set(\"Accept\",y.types[e]||e),this},S.prototype.auth=function(e,t,n){1===arguments.length&&(t=\"\"),\"object\"==typeof t&&null!==t&&(n=t,t=\"\"),n||(n={type:\"function\"==typeof btoa?\"basic\":\"auto\"});const r=n.encoder?n.encoder:e=>{if(\"function\"==typeof btoa)return btoa(e);throw new Error(\"Cannot use basic auth, btoa is not a function\")};return this._auth(e,t,n,r)},S.prototype.query=function(e){return\"string\"!=typeof e&&(e=b(e)),e&&this._query.push(e),this},S.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error(\"superagent can't mix .send() and .attach()\");this._getFormData().append(e,t,n||t.name)}return this},S.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},S.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();const n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit(\"error\",e)),n(e,t)},S.prototype.crossDomainError=function(){const e=new Error(\"Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.\");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},S.prototype.agent=function(){return console.warn(\"This is not supported in browser version of superagent\"),this},S.prototype.ca=S.prototype.agent,S.prototype.buffer=S.prototype.ca,S.prototype.write=()=>{throw new Error(\"Streaming is not supported in browser version of superagent\")},S.prototype.pipe=S.prototype.write,S.prototype._isHost=function(e){return e&&\"object\"==typeof e&&!Array.isArray(e)&&\"[object Object]\"!==Object.prototype.toString.call(e)},S.prototype.end=function(e){this._endCalled&&console.warn(\"Warning: .end() was called twice. This is not supported in superagent\"),this._endCalled=!0,this._callback=e||d,this._finalizeQueryString(),this._end()},S.prototype._setUploadTimeout=function(){const e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((()=>{e._timeoutError(\"Upload timeout of \",e._uploadTimeout,\"ETIMEDOUT\")}),this._uploadTimeout))},S.prototype._end=function(){if(this._aborted)return this.callback(new Error(\"The request has been aborted even before .end() was called\"));const e=this;this.xhr=y.getXHR();const t=this.xhr;let n=this._formData||this._data;this._setTimeouts(),t.addEventListener(\"readystatechange\",(()=>{const n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4!==n)return;let r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit(\"end\")}));const r=(t,n)=>{n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(e._uploadTimeoutTimer)),n.direction=t,e.emit(\"progress\",n)};if(this.hasListeners(\"progress\"))try{t.addEventListener(\"progress\",r.bind(null,\"download\")),t.upload&&t.upload.addEventListener(\"progress\",r.bind(null,\"upload\"))}catch(e){}t.upload&&this._setUploadTimeout();try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&\"GET\"!==this.method&&\"HEAD\"!==this.method&&\"string\"!=typeof n&&!this._isHost(n)){const e=this._header[\"content-type\"];let t=this._serializer||y.serialize[e?e.split(\";\")[0]:\"\"];!t&&_(e)&&(t=y.serialize[\"application/json\"]),t&&(n=t(n))}for(const e in this.header)null!==this.header[e]&&p(this.header,e)&&t.setRequestHeader(e,this.header[e]);this._responseType&&(t.responseType=this._responseType),this.emit(\"request\",this),t.send(void 0===n?null:n)},y.agent=()=>new h;for(var P=0,w=[\"GET\",\"POST\",\"OPTIONS\",\"PATCH\",\"PUT\",\"DELETE\"];P<w.length;P++){const e=w[P];h.prototype[e.toLowerCase()]=function(t,n){const r=new y.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}function E(e,t,n){const r=y(\"DELETE\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}h.prototype.del=h.prototype.delete,y.get=(e,t,n)=>{const r=y(\"GET\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.head=(e,t,n)=>{const r=y(\"HEAD\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},y.options=(e,t,n)=>{const r=y(\"OPTIONS\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.del=E,y.delete=E,y.patch=(e,t,n)=>{const r=y(\"PATCH\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.post=(e,t,n)=>{const r=y(\"POST\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},y.put=(e,t,n)=>{const r=y(\"PUT\",e);return\"function\"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}}(Wt,Wt.exports);var ti=Wt.exports;function ni(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;r.log(\"<<<<<\"),r.log(\"[\".concat(n,\"]\"),\"\\n\",e.url,\"\\n\",e.qs),r.log(\"-----\"),e.on(\"response\",(function(n){var o=(new Date).getTime()-t,i=(new Date).toISOString();r.log(\">>>>>>\"),r.log(\"[\".concat(i,\" / \").concat(o,\"]\"),\"\\n\",e.url,\"\\n\",e.qs,\"\\n\",n.text),r.log(\"-----\")}))}function ri(e,t,n){var r=this;this._config.logVerbosity&&(e=e.use(ni)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e));var o=e;if(t.abortSignal)var i=t.abortSignal.subscribe((function(){o.abort(),i()}));return!0===t.forceBuffered?o=\"undefined\"==typeof Blob?o.buffer().responseType(\"arraybuffer\"):o.responseType(\"arraybuffer\"):!1===t.forceBuffered&&(o=o.buffer(!1)),(o=o.timeout(t.timeout)).on(\"abort\",(function(){return n({category:R.PNUnknownCategory,error:!0,operation:t.operation,errorData:new Error(\"Aborted\")},null)})),o.end((function(e,o){var i,a={};if(a.error=null!==e,a.operation=t.operation,o&&o.status&&(a.statusCode=o.status),e){if(e.response&&e.response.text&&!r._config.logVerbosity)try{a.errorData=JSON.parse(e.response.text)}catch(t){a.errorData=e}else a.errorData=e;return a.category=r._detectErrorCategory(e),n(a,null)}if(t.ignoreBody)i={headers:o.headers,redirects:o.redirects,response:o};else try{i=JSON.parse(o.text)}catch(e){return a.errorData=o,a.error=!0,n(a,null)}return i.error&&1===i.error&&i.status&&i.message&&i.service?(a.errorData=i,a.statusCode=i.status,a.error=!0,a.category=r._detectErrorCategory(a),n(a,null)):(i.error&&i.error.message&&(a.errorData=i.error),n(a,i))})),o}function oi(e,t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return r=ti.post(e),t.forEach((function(e){var t=e.key,n=e.value;r=r.field(t,n)})),r.attach(\"file\",n,{contentType:\"application/octet-stream\"}),[4,r];case 1:return[2,o.sent()]}}))}))}function ii(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function ai(e,t,n){var r=ti.get(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function si(e,t,n,r){var o=ti.post(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ui(e,t,n,r){var o=ti.patch(this.getStandardOrigin()+n.url).query(e).set(n.headers).send(t);return ri.call(this,o,n,r)}function ci(e,t,n){var r=ti.delete(this.getStandardOrigin()+t.url).set(t.headers).query(e);return ri.call(this,r,t,n)}function li(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer}var pi,fi=function(){function e(){}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"aes-256-cbc\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.encryptString(n,t)];throw new Error(\"Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer\")}}))}))},e.prototype.decrypt=function(e,t){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.getKey(e)];case 1:if(n=r.sent(),t instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(n,t)];if(\"string\"==typeof t)return[2,this.decryptString(n,t)];throw new Error(\"Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer\")}}))}))},e.prototype.encryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:if(t.data.byteLength<=0)throw new Error(\"encryption error. empty content\");return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.encryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,mimeType:\"application/octet-stream\",data:a})]}}))}))},e.prototype.decryptFile=function(e,t,n){return o(this,void 0,void 0,(function(){var r,o,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.getKey(e)];case 1:return r=i.sent(),[4,t.data.arrayBuffer()];case 2:return o=i.sent(),[4,this.decryptArrayBuffer(r,o)];case 3:return a=i.sent(),[2,n.create({name:t.name,data:a})]}}))}))},e.prototype.getKey=function(t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,crypto.subtle.digest(\"SHA-256\",e.encoder.encode(t))];case 1:return n=i.sent(),r=Array.from(new Uint8Array(n)).map((function(e){return e.toString(16).padStart(2,\"0\")})).join(\"\"),o=e.encoder.encode(r.slice(0,32)).buffer,[2,crypto.subtle.importKey(\"raw\",o,\"AES-CBC\",!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encryptArrayBuffer=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=crypto.getRandomValues(new Uint8Array(16)),r=li,o=[n.buffer],[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:n},e,t)];case 1:return[2,r.apply(void 0,o.concat([i.sent()]))]}}))}))},e.prototype.decryptArrayBuffer=function(t,n){return o(this,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:if(r=n.slice(0,16),n.slice(e.IV_LENGTH).byteLength<=0)throw new Error(\"decryption error: empty content\");return[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:r},t,n.slice(e.IV_LENGTH))];case 1:return[2,o.sent()]}}))}))},e.prototype.encryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=crypto.getRandomValues(new Uint8Array(16)),o=e.encoder.encode(n).buffer,[4,crypto.subtle.encrypt({name:\"AES-CBC\",iv:r},t,o)];case 1:return a=i.sent(),s=li(r.buffer,a),[2,e.decoder.decode(s)]}}))}))},e.prototype.decryptString=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s;return i(this,(function(i){switch(i.label){case 0:return r=e.encoder.encode(n).buffer,o=r.slice(0,16),a=r.slice(16),[4,crypto.subtle.decrypt({name:\"AES-CBC\",iv:o},t,a)];case 1:return s=i.sent(),[2,e.decoder.decode(s)]}}))}))},e.IV_LENGTH=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),hi=(pi=function(){function e(e){if(e instanceof File)this.data=e,this.name=this.data.name,this.mimeType=this.data.type;else if(e.data){var t=e.data;this.data=new File([t],e.name,{type:e.mimeType}),this.name=e.name,e.mimeType&&(this.mimeType=e.mimeType)}if(void 0===this.data)throw new Error(\"Couldn't construct a file out of supplied options.\");if(void 0===this.name)throw new Error(\"Couldn't guess filename out of the options. Please provide one.\")}return e.create=function(e){return new this(e)},e.prototype.toBuffer=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toStream=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in Node.js environments.\")}))}))},e.prototype.toFileUri=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error(\"This feature is only supported in react native environments.\")}))}))},e.prototype.toBlob=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e.prototype.toArrayBuffer=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(r.result instanceof ArrayBuffer)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsArrayBuffer(e.data)}))]}))}))},e.prototype.toString=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r=new FileReader;r.addEventListener(\"load\",(function(){if(\"string\"==typeof r.result)return t(r.result)})),r.addEventListener(\"error\",(function(){n(r.error)})),r.readAsBinaryString(e.data)}))]}))}))},e.prototype.toFile=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.data]}))}))},e}(),pi.supportsFile=\"undefined\"!=typeof File,pi.supportsBlob=\"undefined\"!=typeof Blob,pi.supportsArrayBuffer=\"undefined\"!=typeof ArrayBuffer,pi.supportsBuffer=!1,pi.supportsStream=!1,pi.supportsString=!0,pi.supportsEncryptFile=!0,pi.supportsFileUri=!1,pi),di=function(){function e(e){this.config=e,this.cryptor=new A({config:e}),this.fileCryptor=new fi}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"\"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=\"string\"==typeof e?e:(new TextDecoder).decode(e);return{data:this.cryptor.encrypt(t),metadata:null}},e.prototype.decrypt=function(e){var t=\"string\"==typeof e.data?e.data:v(e.data);return this.cryptor.decrypt(t)},e.prototype.encryptFile=function(e,t){var n;return o(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.fileCryptor.encryptFile(null===(n=this.config)||void 0===n?void 0:n.cipherKey,e,t)]}))}))},e.prototype.decryptFile=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,e,t)]}))}))},e}(),yi=function(){function e(e){this.cipherKey=e.cipherKey,this.CryptoJS=E,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(e.prototype,\"algo\",{get:function(){return\"AES-CBC\"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"identifier\",{get:function(){return\"ACRH\"},enumerable:!1,configurable:!0}),e.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(e.BLOCK_SIZE))},e.prototype.getKey=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=e.encoder.encode(this.cipherKey),[4,crypto.subtle.digest(\"SHA-256\",t.buffer)];case 1:return n=r.sent(),[2,crypto.subtle.importKey(\"raw\",n,this.algo,!0,[\"encrypt\",\"decrypt\"])]}}))}))},e.prototype.encrypt=function(t){if(0===(\"string\"==typeof t?t:e.decoder.decode(t)).length)throw new Error(\"encryption error. empty content\");var n=this.getIv();return{metadata:n,data:b(this.CryptoJS.AES.encrypt(t,this.encryptedKey,{iv:this.bufferToWordArray(n),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},e.prototype.decrypt=function(t){var n=this.bufferToWordArray(new Uint8ClampedArray(t.metadata)),r=this.bufferToWordArray(new Uint8ClampedArray(t.data));return e.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:r},this.encryptedKey,{iv:n,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},e.prototype.encryptFileData=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,this.getKey()];case 1:return t=o.sent(),n=this.getIv(),r={},[4,crypto.subtle.encrypt({name:this.algo,iv:n},t,e)];case 2:return[2,(r.data=o.sent(),r.metadata=n,r)]}}))}))},e.prototype.decryptFileData=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getKey()];case 1:return t=n.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:e.metadata},t,e.data)]}}))}))},e.prototype.bufferToWordArray=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n[t/4|0]|=e[t]<<24-8*t;return this.CryptoJS.lib.WordArray.create(n,e.length)},e.BLOCK_SIZE=16,e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),gi=function(){function e(e){var t;this.defaultCryptor=e.default,this.cryptors=null!==(t=e.cryptors)&&void 0!==t?t:[]}return e.legacyCryptoModule=function(e){var t;return new this({default:new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t}),cryptors:[new yi({cipherKey:e.cipherKey})]})},e.aesCbcCryptoModule=function(e){var t;return new this({default:new yi({cipherKey:e.cipherKey}),cryptors:[new di({cipherKey:e.cipherKey,useRandomIVs:null===(t=e.useRandomIVs)||void 0===t||t})]})},e.withDefaultCryptor=function(e){return new this({default:e})},e.prototype.getAllCryptors=function(){return u([this.defaultCryptor],s(this.cryptors),!1)},e.prototype.encrypt=function(e){var t=this.defaultCryptor.encrypt(e);if(!t.metadata)return t.data;var n=this.getHeaderData(t);return this.concatArrayBuffer(n,t.data)},e.prototype.decrypt=function(e){var t=\"string\"==typeof e?b(e):e,n=bi.tryParse(t),r=this.getCryptor(n),o=n.length>0?t.slice(n.length-n.metadataLength,n.length):null;if(t.slice(n.length).byteLength<=0)throw new Error(\"decryption error. empty content\");return r.decrypt({data:t.slice(n.length),metadata:o})},e.prototype.encryptFile=function(e,t){return o(this,void 0,void 0,(function(){var n,r;return i(this,(function(o){switch(o.label){case 0:return this.defaultCryptor.identifier===bi.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(e,t)]:(n=this.getFileData(e.data),[4,this.defaultCryptor.encryptFileData(n)]);case 1:return r=o.sent(),[2,t.create({name:e.name,mimeType:\"application/octet-stream\",data:this.concatArrayBuffer(this.getHeaderData(r),r.data)})]}}))}))},e.prototype.decryptFile=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,s,u,c,l,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.data.arrayBuffer()];case 1:return r=i.sent(),o=bi.tryParse(r),(null==(a=this.getCryptor(o))?void 0:a.identifier)===e.LEGACY_IDENTIFIER?[2,a.decryptFile(t,n)]:(s=this.getFileData(r),u=s.slice(o.length-o.metadataLength,o.length),l=(c=n).create,p={name:t.name},[4,this.defaultCryptor.decryptFileData({data:r.slice(o.length),metadata:u})]);case 2:return[2,l.apply(c,[(p.data=i.sent(),p)])]}}))}))},e.prototype.getCryptor=function(e){if(\"\"===e){var t=this.getAllCryptors().find((function(e){return\"\"===e.identifier}));if(t)return t;throw new Error(\"unknown cryptor error\")}if(e instanceof vi)return this.getCryptorFromId(e.identifier)},e.prototype.getCryptorFromId=function(e){var t=this.getAllCryptors().find((function(t){return e===t.identifier}));if(t)return t;throw Error(\"unknown cryptor error\")},e.prototype.concatArrayBuffer=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},e.prototype.getHeaderData=function(e){if(e.metadata){var t=bi.from(this.defaultCryptor.identifier,e.metadata),n=new Uint8Array(t.length),r=0;return n.set(t.data,r),r+=t.length-e.metadata.byteLength,n.set(new Uint8Array(e.metadata),r),n.buffer}},e.prototype.getFileData=function(t){if(t instanceof ArrayBuffer)return t;if(\"string\"==typeof t)return e.encoder.encode(t);throw new Error(\"Cannot decrypt/encrypt file. In browsers file decryption supports only string or ArrayBuffer\")},e.LEGACY_IDENTIFIER=\"\",e.encoder=new TextEncoder,e.decoder=new TextDecoder,e}(),bi=function(){function e(){}return e.from=function(t,n){if(t!==e.LEGACY_IDENTIFIER)return new vi(t,n.byteLength)},e.tryParse=function(t){var n=new Uint8Array(t),r=\"\";if(n.byteLength>=4&&(r=n.slice(0,4),this.decoder.decode(r)!==e.SENTINEL))return\"\";if(!(n.byteLength>=5))throw new Error(\"decryption error. invalid header version\");if(n[4]>e.MAX_VERSION)throw new Error(\"unknown cryptor error\");var o=\"\",i=5+e.IDENTIFIER_LENGTH;if(!(n.byteLength>=i))throw new Error(\"decryption error. invalid crypto identifier\");o=n.slice(5,i);var a=null;if(!(n.byteLength>=i+1))throw new Error(\"decryption error. invalid metadata length\");return a=n[i],i+=1,255===a&&n.byteLength>=i+2&&(a=new Uint16Array(n.slice(i,i+2)).reduce((function(e,t){return(e<<8)+t}),0),i+=2),new vi(this.decoder.decode(o),a)},e.SENTINEL=\"PNED\",e.LEGACY_IDENTIFIER=\"\",e.IDENTIFIER_LENGTH=4,e.VERSION=1,e.MAX_VERSION=1,e.decoder=new TextDecoder,e}(),vi=function(){function e(e,t){this._identifier=e,this._metadataLength=t}return Object.defineProperty(e.prototype,\"identifier\",{get:function(){return this._identifier},set:function(e){this._identifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"metadataLength\",{get:function(){return this._metadataLength},set:function(e){this._metadataLength=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"version\",{get:function(){return bi.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"length\",{get:function(){return bi.SENTINEL.length+1+bi.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"data\",{get:function(){var e=0,t=new Uint8Array(this.length),n=new TextEncoder;t.set(n.encode(bi.SENTINEL)),t[e+=bi.SENTINEL.length]=this.version,e++,this.identifier&&t.set(n.encode(this.identifier),e),e+=bi.IDENTIFIER_LENGTH;var r=this.metadataLength;return r<255?t[e]=r:t.set([255,r>>8,255&r],e),t},enumerable:!1,configurable:!0}),e.IDENTIFIER_LENGTH=4,e.SENTINEL=\"PNED\",e}();function mi(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}var _i=function(e){function n(t){var n=this,r=t.listenToBrowserNetworkEvents,o=void 0===r||r;return t.sdkFamily=\"Web\",t.networking=new qt({del:ci,get:ai,post:si,patch:ui,sendBeacon:mi,getfile:ii,postfile:oi}),t.cbor=new Vt((function(e){return zt(f.decode(e))}),b),t.PubNubFile=hi,t.cryptography=new fi,t.initCryptoModule=function(e){return new gi({default:new di({cipherKey:e.cipherKey,useRandomIVs:e.useRandomIVs}),cryptors:[new yi({cipherKey:e.cipherKey})]})},n=e.call(this,t)||this,o&&(window.addEventListener(\"offline\",(function(){n.networkDownDetected()})),window.addEventListener(\"online\",(function(){n.networkUpDetected()}))),n}return t(n,e),n.CryptoModule=gi,n}(Ht);return _i}));",
          "",
          "---------------"
        ],
        "lib/core/components/config.js||lib/core/components/config.js": [
          "File: lib/core/components/config.js -> lib/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "177:         return this;",
          "178:     };",
          "179:     default_1.prototype.getVersion = function () {",
          "181:     };",
          "182:     default_1.prototype._addPnsdkSuffix = function (name, suffix) {",
          "183:         this._PNSDKSuffix[name] = suffix;",
          "",
          "[Removed Lines]",
          "180:         return '7.4.0';",
          "",
          "[Added Lines]",
          "180:         return '7.4.1';",
          "",
          "---------------"
        ],
        "lib/core/pubnub-common.js||lib/core/pubnub-common.js": [
          "File: lib/core/pubnub-common.js -> lib/core/pubnub-common.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "500:         this.decrypt = function (data, key) {",
          "501:             if (typeof key === 'undefined' && cryptoModule) {",
          "502:                 var decrypted = modules.cryptoModule.decrypt(data);",
          "504:             }",
          "505:             else {",
          "506:                 return crypto.decrypt(data, key);",
          "",
          "[Removed Lines]",
          "503:                 return decrypted instanceof ArrayBuffer ? (0, base64_codec_1.encode)(decrypted) : decrypted;",
          "",
          "[Added Lines]",
          "503:                 return decrypted instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decrypted)) : decrypted;",
          "",
          "---------------"
        ],
        "src/core/components/config.js||src/core/components/config.js": [
          "File: src/core/components/config.js -> src/core/components/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "350:   }",
          "352:   getVersion() {",
          "354:   }",
          "356:   _addPnsdkSuffix(name, suffix) {",
          "",
          "[Removed Lines]",
          "353:     return '7.4.0';",
          "",
          "[Added Lines]",
          "353:     return '7.4.1';",
          "",
          "---------------"
        ],
        "src/core/pubnub-common.js||src/core/pubnub-common.js": [
          "File: src/core/pubnub-common.js -> src/core/pubnub-common.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "691:     this.decrypt = function (data, key) {",
          "692:       if (typeof key === 'undefined' && cryptoModule) {",
          "693:         const decrypted = modules.cryptoModule.decrypt(data);",
          "695:       } else {",
          "696:         return crypto.decrypt(data, key);",
          "697:       }",
          "",
          "[Removed Lines]",
          "694:         return decrypted instanceof ArrayBuffer ? encode(decrypted) : decrypted;",
          "",
          "[Added Lines]",
          "694:         return decrypted instanceof ArrayBuffer ? JSON.parse(new TextDecoder().decode(decrypted)) : decrypted;",
          "",
          "---------------"
        ],
        "test/integration/components/crypto.test.js||test/integration/components/crypto.test.js": [
          "File: test/integration/components/crypto.test.js -> test/integration/components/crypto.test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "24:     expect(decrypted).to.deep.equal(data);",
          "25:   });",
          "26: });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27:   it('should be able to encrypt and decrypt a message with CryptoModule', () => {",
          "28:   const pubnub = new PubNub({",
          "29:     subscribeKey: 'demo-36',",
          "30:     publishKey: 'demo-36',",
          "31:     useRandomIVs: true,",
          "32:     cryptoModule: PubNub.CryptoModule.aesCbcCryptoModule({",
          "33:       cipherKey: 'abcd'",
          "34:     }),",
          "35:     uuid: 'myUUID',",
          "36:   });",
          "37:     const data = {",
          "38:       message:",
          "39:         'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.',",
          "40:     };",
          "41:     const plaintext = JSON.stringify(data);",
          "42:     const ciphertext = pubnub.encrypt(plaintext);",
          "44:     const decrypted = pubnub.decrypt(ciphertext);",
          "46:     expect(decrypted).to.deep.equal(data);",
          "47:   });",
          "",
          "---------------"
        ]
      }
    }
  ]
}