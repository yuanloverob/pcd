{
  "cve_id": "CVE-2021-39189",
  "cve_desc": "Pimcore is an open source data & experience management platform. In versions prior to 10.1.3, it is possible to enumerate usernames via the forgot password functionality. This issue is fixed in version 10.1.3. As a workaround, one may apply the available patch manually.",
  "repo": "pimcore/pimcore",
  "patch_hash": "d0a4de39cf05dce6af71f8ca039132bdfcbb0dce",
  "patch_info": {
    "commit_hash": "d0a4de39cf05dce6af71f8ca039132bdfcbb0dce",
    "repo": "pimcore/pimcore",
    "commit_url": "https://github.com/pimcore/pimcore/pull/10223/commits/d0a4de39cf05dce6af71f8ca039132bdfcbb0dce",
    "files": [
      "bundles/AdminBundle/Controller/Admin/LoginController.php",
      "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
    ],
    "message": "[Login] Lost password service - do not display any error messages",
    "before_after_code_files": [
      "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php",
      "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
    ]
  },
  "patch_diff": {
    "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php": [
      "File: bundles/AdminBundle/Controller/Admin/LoginController.php -> bundles/AdminBundle/Controller/Admin/LoginController.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "225:             if ($error) {",
      "226:                 Logger::error('Lost password service: ' . $error);",
      "227:                 $bruteforceProtectionHandler->addEntry($request->get('username'), $request);",
      "229:             }",
      "230:         }",
      "",
      "[Removed Lines]",
      "228:                 $params['error'] = $error;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig": [
      "File: bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig -> bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: {% block content %}",
      "12:         <div class=\"text error\">",
      "13:             {{ 'A temporary login link has been sent to your email address.'|trans([],'admin') }}",
      "14:             <br/>",
      "",
      "[Removed Lines]",
      "5:     {% if error is defined %}",
      "6:         <div class=\"text error\">",
      "7:             {{ error|trans([],'admin')|raw }}",
      "8:         </div>",
      "9:     {% endif %}",
      "11:     {% if error is not defined and (app.request.method == 'POST') %}",
      "",
      "[Added Lines]",
      "5:     {% if app.request.method == 'POST' %}",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c398852390eec45bf26299751706ca44e7ee379f",
      "candidate_info": {
        "commit_hash": "c398852390eec45bf26299751706ca44e7ee379f",
        "repo": "pimcore/pimcore",
        "commit_url": "https://github.com/pimcore/pimcore/commit/c398852390eec45bf26299751706ca44e7ee379f",
        "files": [
          "bundles/AdminBundle/Controller/Admin/LoginController.php",
          "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
        ],
        "message": "[Login] Lost password service - do not display any error messages",
        "before_after_code_files": [
          "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php",
          "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php",
            "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
          ],
          "candidate": [
            "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php",
            "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig"
          ]
        }
      },
      "candidate_diff": {
        "bundles/AdminBundle/Controller/Admin/LoginController.php||bundles/AdminBundle/Controller/Admin/LoginController.php": [
          "File: bundles/AdminBundle/Controller/Admin/LoginController.php -> bundles/AdminBundle/Controller/Admin/LoginController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "225:             if ($error) {",
          "226:                 Logger::error('Lost password service: ' . $error);",
          "227:                 $bruteforceProtectionHandler->addEntry($request->get('username'), $request);",
          "229:             }",
          "230:         }",
          "",
          "[Removed Lines]",
          "228:                 $params['error'] = $error;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig||bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig": [
          "File: bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig -> bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.twig",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: {% block content %}",
          "12:         <div class=\"text error\">",
          "13:             {{ 'A temporary login link has been sent to your email address.'|trans([],'admin') }}",
          "14:             <br/>",
          "",
          "[Removed Lines]",
          "5:     {% if error is defined %}",
          "6:         <div class=\"text error\">",
          "7:             {{ error|trans([],'admin')|raw }}",
          "8:         </div>",
          "9:     {% endif %}",
          "11:     {% if error is not defined and (app.request.method == 'POST') %}",
          "",
          "[Added Lines]",
          "5:     {% if app.request.method == 'POST' %}",
          "",
          "---------------"
        ]
      }
    }
  ]
}