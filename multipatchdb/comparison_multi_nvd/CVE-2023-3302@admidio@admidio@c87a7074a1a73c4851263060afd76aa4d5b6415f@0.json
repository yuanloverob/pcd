{
  "cve_id": "CVE-2023-3302",
  "cve_desc": "Improper Neutralization of Formula Elements in a CSV File in GitHub repository admidio/admidio prior to 4.2.9.",
  "repo": "admidio/admidio",
  "patch_hash": "c87a7074a1a73c4851263060afd76aa4d5b6415f",
  "patch_info": {
    "commit_hash": "c87a7074a1a73c4851263060afd76aa4d5b6415f",
    "repo": "admidio/admidio",
    "commit_url": "https://github.com/admidio/admidio/commit/c87a7074a1a73c4851263060afd76aa4d5b6415f",
    "files": [
      "adm_program/system/classes/ListConfiguration.php"
    ],
    "message": "Excel export could lead to execute apps #1433",
    "before_after_code_files": [
      "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
    ]
  },
  "patch_diff": {
    "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php": [
      "File: adm_program/system/classes/ListConfiguration.php -> adm_program/system/classes/ListConfiguration.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "235:         if ($format === 'csv') {",
      "237:         }",
      "239:         elseif ($format === 'pdf') {",
      "",
      "[Removed Lines]",
      "236:             $outputContent = $content;",
      "",
      "[Added Lines]",
      "236:             $content = preg_replace(\"/\\t/\", \"\\\\t\", $content);",
      "237:             $content = preg_replace(\"/\\r?\\n/\", \"\\\\n\", $content);",
      "238:             $outputContent = preg_replace(\"/^[@=+-]/\", \"#\", $content);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8459a4623d780515607793f93f2289f2709e93cd",
      "candidate_info": {
        "commit_hash": "8459a4623d780515607793f93f2289f2709e93cd",
        "repo": "admidio/admidio",
        "commit_url": "https://github.com/admidio/admidio/commit/8459a4623d780515607793f93f2289f2709e93cd",
        "files": [
          "adm_program/system/classes/ListConfiguration.php"
        ],
        "message": "document reges",
        "before_after_code_files": [
          "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ],
          "candidate": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ]
        }
      },
      "candidate_diff": {
        "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php": [
          "File: adm_program/system/classes/ListConfiguration.php -> adm_program/system/classes/ListConfiguration.php"
        ]
      }
    },
    {
      "candidate_hash": "1b70f3639a31fba9f3ee7f9b0fcbfcc47a83a090",
      "candidate_info": {
        "commit_hash": "1b70f3639a31fba9f3ee7f9b0fcbfcc47a83a090",
        "repo": "admidio/admidio",
        "commit_url": "https://github.com/admidio/admidio/commit/1b70f3639a31fba9f3ee7f9b0fcbfcc47a83a090",
        "files": [
          "adm_program/system/classes/ListConfiguration.php"
        ],
        "message": "Phone Numbers in International Format do not match between Category Report and Role export #1466",
        "before_after_code_files": [
          "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ],
          "candidate": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ]
        }
      },
      "candidate_diff": {
        "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php": [
          "File: adm_program/system/classes/ListConfiguration.php -> adm_program/system/classes/ListConfiguration.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "237:             $content = preg_replace(\"/\\t/\", \"\\\\t\", $content);",
          "238:             $content = preg_replace(\"/\\r?\\n/\", \"\\\\n\", $content);",
          "241:         }",
          "243:         elseif ($format === 'pdf') {",
          "",
          "[Removed Lines]",
          "240:             $outputContent = preg_replace(\"/^[@=+-]/\", \"#\", $content);",
          "",
          "[Added Lines]",
          "239:             $outputContent = preg_replace(\"/^[@=]/\", \"#\", $content);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3ad58f140f95cde7f18605ff3b54443af19eb9df",
      "candidate_info": {
        "commit_hash": "3ad58f140f95cde7f18605ff3b54443af19eb9df",
        "repo": "admidio/admidio",
        "commit_url": "https://github.com/admidio/admidio/commit/3ad58f140f95cde7f18605ff3b54443af19eb9df",
        "files": [
          "adm_program/system/classes/ListConfiguration.php"
        ],
        "message": "Excel export could lead to execute apps #1433",
        "before_after_code_files": [
          "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ],
          "candidate": [
            "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php"
          ]
        }
      },
      "candidate_diff": {
        "adm_program/system/classes/ListConfiguration.php||adm_program/system/classes/ListConfiguration.php": [
          "File: adm_program/system/classes/ListConfiguration.php -> adm_program/system/classes/ListConfiguration.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "235:         if ($format === 'csv') {",
          "237:         }",
          "239:         elseif ($format === 'pdf') {",
          "",
          "[Removed Lines]",
          "236:             $outputContent = $content;",
          "",
          "[Added Lines]",
          "236:             $content = preg_replace(\"/\\t/\", \"\\\\t\", $content);",
          "237:             $content = preg_replace(\"/\\r?\\n/\", \"\\\\n\", $content);",
          "238:             $outputContent = preg_replace(\"/^[@=+-]/\", \"#\", $content);",
          "",
          "---------------"
        ]
      }
    }
  ]
}