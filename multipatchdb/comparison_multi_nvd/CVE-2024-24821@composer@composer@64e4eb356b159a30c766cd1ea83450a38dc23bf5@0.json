{
  "cve_id": "CVE-2024-24821",
  "cve_desc": "Composer is a dependency Manager for the PHP language. In affected versions several files within the local working directory are included during the invocation of Composer and in the context of the executing user. As such, under certain conditions arbitrary code execution may lead to local privilege escalation, provide lateral user movement or malicious code execution when Composer is invoked within a directory with tampered files. All Composer CLI commands are affected, including composer.phar's self-update. The following scenarios are of high risk: Composer being run with sudo, Pipelines which may execute Composer on untrusted projects, Shared environments with developers who run Composer individually on the same project. This vulnerability has been addressed in versions 2.7.0 and 2.2.23. It is advised that the patched versions are applied at the earliest convenience. Where not possible, the following should be addressed: Remove all sudo composer privileges for all users to mitigate root privilege escalation, and avoid running Composer within an untrusted directory, or if needed, verify that the contents of `vendor/composer/InstalledVersions.php` and `vendor/composer/installed.php` do not include untrusted code.  A reset can also be done on these files by the following:```sh\nrm vendor/composer/installed.php vendor/composer/InstalledVersions.php\ncomposer install --no-scripts --no-plugins\n```",
  "repo": "composer/composer",
  "patch_hash": "64e4eb356b159a30c766cd1ea83450a38dc23bf5",
  "patch_info": {
    "commit_hash": "64e4eb356b159a30c766cd1ea83450a38dc23bf5",
    "repo": "composer/composer",
    "commit_url": "https://github.com/composer/composer/commit/64e4eb356b159a30c766cd1ea83450a38dc23bf5",
    "files": [
      "src/Composer/Factory.php",
      "src/Composer/Repository/FilesystemRepository.php",
      "tests/Composer/Test/InstalledVersionsTest.php",
      "tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
      "tests/Composer/Test/Repository/Fixtures/installed.php",
      "tests/Composer/Test/Repository/Fixtures/installed_complex.php",
      "tests/Composer/Test/Repository/Fixtures/installed_relative.php"
    ],
    "message": "Merge pull request from GHSA-7c6p-848j-wh5h\n\n* Fix usage of possibly compromised installed.php/InstalledVersions.php at runtime, refs GHSA-7c6p-848j-wh5h\n\n* Fix InstalledVersionsTest regression",
    "before_after_code_files": [
      "src/Composer/Factory.php||src/Composer/Factory.php",
      "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
      "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php",
      "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
      "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php",
      "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php",
      "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php"
    ]
  },
  "patch_diff": {
    "src/Composer/Factory.php||src/Composer/Factory.php": [
      "File: src/Composer/Factory.php -> src/Composer/Factory.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "18: use Composer\\Package\\Archiver;",
      "19: use Composer\\Package\\Version\\VersionGuesser;",
      "20: use Composer\\Package\\RootPackageInterface;",
      "21: use Composer\\Repository\\RepositoryManager;",
      "22: use Composer\\Repository\\RepositoryFactory;",
      "23: use Composer\\Util\\Filesystem;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "21: use Composer\\Repository\\FilesystemRepository;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "351:             $io->loadConfiguration($config);",
      "356:             }",
      "357:         }",
      "",
      "[Removed Lines]",
      "354:             if (false === $disablePlugins && false === $disableScripts && !class_exists('Composer\\InstalledVersions', false) && file_exists($installedVersionsPath = $config->get('vendor-dir').'/composer/InstalledVersions.php')) {",
      "355:                 include $installedVersionsPath;",
      "",
      "[Added Lines]",
      "356:             if (false === $disablePlugins && false === $disableScripts && !class_exists('Composer\\InstalledVersions', false) && file_exists($installedVersionsPath = $config->get('vendor-dir').'/composer/installed.php')) {",
      "359:                 if (class_exists('Composer\\InstalledVersions')) {",
      "360:                     FilesystemRepository::safelyLoadInstalledVersions($installedVersionsPath);",
      "361:                 }",
      "",
      "---------------"
    ],
    "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php": [
      "File: src/Composer/Repository/FilesystemRepository.php -> src/Composer/Repository/FilesystemRepository.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "20: use Composer\\Package\\AliasPackage;",
      "21: use Composer\\Package\\Dumper\\ArrayDumper;",
      "22: use Composer\\Installer\\InstallationManager;",
      "23: use Composer\\Util\\Filesystem;",
      "24: use Composer\\Util\\Platform;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "23: use Composer\\Pcre\\Preg;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "173:         }",
      "174:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "182:     public static function safelyLoadInstalledVersions(string $path): bool",
      "183:     {",
      "184:         $installedVersionsData = @file_get_contents($path);",
      "185:         $pattern = <<<'REGEX'",
      "186: {(?(DEFINE)",
      "187:    (?<number>  -? \\s*+ \\d++ (?:\\.\\d++)? )",
      "188:    (?<boolean> true | false | null )",
      "189:    (?<strings> (?&string) (?: \\s*+ \\. \\s*+ (?&string))*+ )",
      "190:    (?<string>  (?: \" (?:[^\"\\\\$]*+ | \\\\ [\"\\\\0] )* \" | ' (?:[^'\\\\]*+ | \\\\ ['\\\\] )* ' ) )",
      "191:    (?<array>   array\\( \\s*+ (?: (?:(?&number)|(?&strings)) \\s*+ => \\s*+ (?: (?:__DIR__ \\s*+ \\. \\s*+)? (?&strings) | (?&value) ) \\s*+, \\s*+ )*+  \\s*+ \\) )",
      "192:    (?<value>   (?: (?&number) | (?&boolean) | (?&strings) | (?&array) ) )",
      "193: )",
      "194: ^<\\?php\\s++return\\s++(?&array)\\s*+;$}ix",
      "195: REGEX;",
      "196:         if (is_string($installedVersionsData) && Preg::isMatch($pattern, trim($installedVersionsData))) {",
      "197:             \\Composer\\InstalledVersions::reload(eval('?>'.Preg::replace('{=>\\s*+__DIR__\\s*+\\.\\s*+([\\'\"])}', '=> '.var_export(dirname($path), true).' . $1', $installedVersionsData)));",
      "199:             return true;",
      "200:         }",
      "202:         return false;",
      "203:     }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "184:         foreach ($array as $key => $value) {",
      "185:             $lines .= str_repeat('    ', $level);",
      "188:             if (is_array($value)) {",
      "189:                 if (!empty($value)) {",
      "",
      "[Removed Lines]",
      "186:             $lines .= is_int($key) ? $key . ' => ' : '\\'' . $key . '\\' => ';",
      "",
      "[Added Lines]",
      "215:             $lines .= is_int($key) ? $key . ' => ' : var_export($key, true) . ' => ';",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "197:                 } else {",
      "198:                     $lines .= \"__DIR__ . \" . var_export('/' . $value, true) . \",\\n\";",
      "199:                 }",
      "201:                 $lines .= var_export($value, true) . \",\\n\";",
      "202:             }",
      "203:         }",
      "",
      "[Removed Lines]",
      "200:             } else {",
      "",
      "[Added Lines]",
      "229:             } elseif (is_string($value)) {",
      "231:             } elseif (is_bool($value)) {",
      "232:                 $lines .= ($value ? 'true' : 'false') . \",\\n\";",
      "233:             } elseif (is_null($value)) {",
      "234:                 $lines .= \"null,\\n\";",
      "235:             } else {",
      "236:                 throw new \\UnexpectedValueException('Unexpected type '.gettype($value));",
      "",
      "---------------"
    ],
    "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php": [
      "File: tests/Composer/Test/InstalledVersionsTest.php -> tests/Composer/Test/InstalledVersionsTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "49:         $this->root = self::getUniqueTmpDirectory();",
      "51:         $dir = $this->root;",
      "53:     }",
      "55:     public function testGetInstalledPackages(): void",
      "",
      "[Removed Lines]",
      "52:         InstalledVersions::reload(require __DIR__.'/Repository/Fixtures/installed.php');",
      "",
      "[Added Lines]",
      "52:         InstalledVersions::reload(require __DIR__.'/Repository/Fixtures/installed_relative.php');",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "222:     public function testGetRawData(): void",
      "223:     {",
      "224:         $dir = $this->root;",
      "226:     }",
      "",
      "[Removed Lines]",
      "225:         $this->assertSame(require __DIR__.'/Repository/Fixtures/installed.php', InstalledVersions::getRawData());",
      "",
      "[Added Lines]",
      "225:         $this->assertSame(require __DIR__.'/Repository/Fixtures/installed_relative.php', InstalledVersions::getRawData());",
      "",
      "---------------"
    ],
    "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php": [
      "File: tests/Composer/Test/Repository/FilesystemRepositoryTest.php -> tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "158:         $repository->addPackage($pkg);",
      "160:         $pkg = self::getPackage('c/c', '3.0');",
      "161:         $repository->addPackage($pkg);",
      "163:         $pkg = self::getPackage('meta/package', '3.0');",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "161:         $pkg->setDistReference('{${passthru(\\'bash -i\\')}} Foo\\\\Bar' . \"\\n\\ttab\\vverticaltab\\0\");",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "178:                 if ($package->getName() === 'c/c') {",
      "181:                 }",
      "",
      "[Removed Lines]",
      "180:                     return '/foo/bar/vendor/c/c';",
      "",
      "[Added Lines]",
      "181:                     return '/foo/bar/ven\\do{}r/c/c${}';",
      "182:                 }",
      "184:                 if ($package->getName() === 'a/provider') {",
      "185:                     return 'vendor/{${passthru(\\'bash -i\\')}}';",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "190:             }));",
      "192:         $repository->write(true, $im);",
      "",
      "[Removed Lines]",
      "193:         $this->assertSame(require __DIR__.'/Fixtures/installed.php', require $dir.'/installed.php');",
      "194:     }",
      "",
      "[Added Lines]",
      "198:         $this->assertSame(file_get_contents(__DIR__.'/Fixtures/installed.php'), file_get_contents($dir.'/installed.php'));",
      "199:     }",
      "201:     public function testSafelyLoadInstalledVersions(): void",
      "202:     {",
      "203:         $result = FilesystemRepository::safelyLoadInstalledVersions(__DIR__.'/Fixtures/installed_complex.php');",
      "204:         self::assertTrue($result, 'The file should be considered valid');",
      "205:         $rawData = \\Composer\\InstalledVersions::getAllRawData();",
      "206:         $rawData = end($rawData);",
      "207:         self::assertSame([",
      "208:             'root' => [",
      "209:                 'install_path' => __DIR__ . '/Fixtures/./',",
      "210:                 'aliases' => [",
      "211:                     0 => '1.10.x-dev',",
      "212:                     1 => '2.10.x-dev',",
      "213:                 ],",
      "214:                 'name' => '__root__',",
      "215:                 'true' => true,",
      "216:                 'false' => false,",
      "217:                 'null' => null,",
      "218:             ],",
      "219:             'versions' => [",
      "220:                 'a/provider' => [",
      "221:                     'foo' => \"simple string/no backslash\",",
      "222:                     'install_path' => __DIR__ . '/Fixtures/vendor/{${passthru(\\'bash -i\\')}}',",
      "223:                     'empty array' => [],",
      "224:                 ],",
      "225:                 'c/c' => [",
      "226:                     'install_path' => '/foo/bar/ven/do{}r/c/c${}',",
      "227:                     'aliases' => [],",
      "228:                     'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
      "229:  tab",
      "230: verticaltab' . \"\\0\",",
      "231:                 ],",
      "232:             ],",
      "233:         ], $rawData);",
      "",
      "---------------"
    ],
    "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php": [
      "File: tests/Composer/Test/Repository/Fixtures/installed.php -> tests/Composer/Test/Repository/Fixtures/installed.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "14:     'root' => array(",
      "15:         'name' => '__root__',",
      "16:         'pretty_version' => 'dev-master',",
      "17:         'version' => 'dev-master',",
      "18:         'reference' => 'sourceref-by-default',",
      "19:         'type' => 'library',",
      "22:         'aliases' => array(",
      "24:         ),",
      "25:         'dev' => true,",
      "26:     ),",
      "",
      "[Removed Lines]",
      "1: <?php",
      "13: return array(",
      "21:         'install_path' => $dir . '/./',",
      "23:             '1.10.x-dev',",
      "",
      "[Added Lines]",
      "1: <?php return array(",
      "8:         'install_path' => __DIR__ . '/./',",
      "10:             0 => '1.10.x-dev',",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "30:             'version' => 'dev-master',",
      "31:             'reference' => 'sourceref-by-default',",
      "32:             'type' => 'library',",
      "35:             'aliases' => array(",
      "37:             ),",
      "38:             'dev_requirement' => false,",
      "39:         ),",
      "",
      "[Removed Lines]",
      "34:             'install_path' => $dir . '/./',",
      "36:                 '1.10.x-dev',",
      "",
      "[Added Lines]",
      "20:             'install_path' => __DIR__ . '/./',",
      "22:                 0 => '1.10.x-dev',",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "42:             'version' => '1.1.0.0',",
      "43:             'reference' => 'distref-as-no-source',",
      "44:             'type' => 'library',",
      "47:             'aliases' => array(),",
      "48:             'dev_requirement' => false,",
      "49:         ),",
      "",
      "[Removed Lines]",
      "46:             'install_path' => $dir . '/vendor/a/provider',",
      "",
      "[Added Lines]",
      "31:             'install_path' => __DIR__ . '/vendor/{${passthru(\\'bash -i\\')}}',",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "52:             'version' => '1.2.0.0',",
      "53:             'reference' => 'distref-as-installed-from-dist',",
      "54:             'type' => 'library',",
      "57:             'aliases' => array(",
      "59:             ),",
      "60:             'dev_requirement' => false,",
      "61:         ),",
      "",
      "[Removed Lines]",
      "56:             'install_path' => $dir . '/vendor/a/provider2',",
      "58:               '1.4',",
      "",
      "[Added Lines]",
      "40:             'install_path' => __DIR__ . '/vendor/a/provider2',",
      "42:                 0 => '1.4',",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "64:             'version' => '2.2.0.0',",
      "65:             'reference' => null,",
      "66:             'type' => 'library',",
      "69:             'aliases' => array(),",
      "70:             'dev_requirement' => false,",
      "71:         ),",
      "72:         'c/c' => array(",
      "73:             'pretty_version' => '3.0',",
      "74:             'version' => '3.0.0.0',",
      "78:             'aliases' => array(),",
      "79:             'dev_requirement' => true,",
      "80:         ),",
      "81:         'foo/impl' => array(",
      "82:             'dev_requirement' => false,",
      "83:             'provided' => array(",
      "88:             ),",
      "89:         ),",
      "90:         'foo/impl2' => array(",
      "91:             'dev_requirement' => false,",
      "92:             'provided' => array(",
      "94:             ),",
      "95:             'replaced' => array(",
      "97:             ),",
      "98:         ),",
      "99:         'foo/replaced' => array(",
      "100:             'dev_requirement' => false,",
      "101:             'replaced' => array(",
      "103:             ),",
      "104:         ),",
      "105:         'meta/package' => array(",
      "106:             'pretty_version' => '3.0',",
      "",
      "[Removed Lines]",
      "68:             'install_path' => $dir . '/vendor/b/replacer',",
      "75:             'reference' => null,",
      "76:             'type' => 'library',",
      "77:             'install_path' => '/foo/bar/vendor/c/c',",
      "84:                 '^1.1',",
      "85:                 '1.2',",
      "86:                 '1.4',",
      "87:                 '2.0',",
      "93:                 '2.0',",
      "96:                 '2.2',",
      "102:                 '^3.0',",
      "",
      "[Added Lines]",
      "51:             'install_path' => __DIR__ . '/vendor/b/replacer',",
      "58:             'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
      "59:  tab",
      "60: verticaltab' . \"\\0\" . '',",
      "61:             'type' => 'library',",
      "68:             'provided' => array(",
      "69:                 0 => '^1.1',",
      "70:                 1 => '1.2',",
      "71:                 2 => '1.4',",
      "77:             'provided' => array(",
      "80:             'replaced' => array(",
      "86:             'replaced' => array(",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "110:             'install_path' => null,",
      "111:             'aliases' => array(),",
      "112:             'dev_requirement' => false,",
      "114:     ),",
      "115: );",
      "",
      "[Removed Lines]",
      "113:         )",
      "",
      "[Added Lines]",
      "97:             'dev_requirement' => false,",
      "",
      "---------------"
    ],
    "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php": [
      "File: tests/Composer/Test/Repository/Fixtures/installed_complex.php -> tests/Composer/Test/Repository/Fixtures/installed_complex.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <?php return array(",
      "2:     'root' => array(",
      "3:         'install_path' => __DIR__ . '/./',",
      "4:         'aliases' => array(",
      "5:             0 => '1.10.x-dev',",
      "6:             1 => '2.10.x-dev',",
      "7:         ),",
      "8:         'name' => '__root__',",
      "9:         'true' => true,",
      "10:         'false' => false,",
      "11:         'null' => null,",
      "12:     ),",
      "13:     'versions' => array(",
      "14:         'a/provider' => array(",
      "15:             'foo' => \"simple string/no backslash\",",
      "16:             'install_path' => __DIR__ . '/vendor/{${passthru(\\'bash -i\\')}}',",
      "17:             'empty array' => array(),",
      "18:         ),",
      "19:         'c/c' => array(",
      "20:             'install_path' => '/foo/bar/ven/do{}r/c/c${}',",
      "21:             'aliases' => array(),",
      "22:             'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
      "23:  tab",
      "24: verticaltab' . \"\\0\" . '',",
      "25:         ),",
      "26:     ),",
      "27: );",
      "",
      "---------------"
    ],
    "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php": [
      "File: tests/Composer/Test/Repository/Fixtures/installed_relative.php -> tests/Composer/Test/Repository/Fixtures/installed_relative.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <?php return array(",
      "2:     'root' => array(",
      "3:         'name' => '__root__',",
      "4:         'pretty_version' => 'dev-master',",
      "5:         'version' => 'dev-master',",
      "6:         'reference' => 'sourceref-by-default',",
      "7:         'type' => 'library',",
      "9:         'install_path' => $dir . '/./',",
      "10:         'aliases' => array(",
      "11:             '1.10.x-dev',",
      "12:         ),",
      "13:         'dev' => true,",
      "14:     ),",
      "15:     'versions' => array(",
      "16:         '__root__' => array(",
      "17:             'pretty_version' => 'dev-master',",
      "18:             'version' => 'dev-master',",
      "19:             'reference' => 'sourceref-by-default',",
      "20:             'type' => 'library',",
      "22:             'install_path' => $dir . '/./',",
      "23:             'aliases' => array(",
      "24:                 '1.10.x-dev',",
      "25:             ),",
      "26:             'dev_requirement' => false,",
      "27:         ),",
      "28:         'a/provider' => array(",
      "29:             'pretty_version' => '1.1',",
      "30:             'version' => '1.1.0.0',",
      "31:             'reference' => 'distref-as-no-source',",
      "32:             'type' => 'library',",
      "34:             'install_path' => $dir . '/vendor/a/provider',",
      "35:             'aliases' => array(),",
      "36:             'dev_requirement' => false,",
      "37:         ),",
      "38:         'a/provider2' => array(",
      "39:             'pretty_version' => '1.2',",
      "40:             'version' => '1.2.0.0',",
      "41:             'reference' => 'distref-as-installed-from-dist',",
      "42:             'type' => 'library',",
      "44:             'install_path' => $dir . '/vendor/a/provider2',",
      "45:             'aliases' => array(",
      "46:               '1.4',",
      "47:             ),",
      "48:             'dev_requirement' => false,",
      "49:         ),",
      "50:         'b/replacer' => array(",
      "51:             'pretty_version' => '2.2',",
      "52:             'version' => '2.2.0.0',",
      "53:             'reference' => null,",
      "54:             'type' => 'library',",
      "56:             'install_path' => $dir . '/vendor/b/replacer',",
      "57:             'aliases' => array(),",
      "58:             'dev_requirement' => false,",
      "59:         ),",
      "60:         'c/c' => array(",
      "61:             'pretty_version' => '3.0',",
      "62:             'version' => '3.0.0.0',",
      "63:             'reference' => null,",
      "64:             'type' => 'library',",
      "65:             'install_path' => '/foo/bar/vendor/c/c',",
      "66:             'aliases' => array(),",
      "67:             'dev_requirement' => true,",
      "68:         ),",
      "69:         'foo/impl' => array(",
      "70:             'dev_requirement' => false,",
      "71:             'provided' => array(",
      "72:                 '^1.1',",
      "73:                 '1.2',",
      "74:                 '1.4',",
      "75:                 '2.0',",
      "76:             ),",
      "77:         ),",
      "78:         'foo/impl2' => array(",
      "79:             'dev_requirement' => false,",
      "80:             'provided' => array(",
      "81:                 '2.0',",
      "82:             ),",
      "83:             'replaced' => array(",
      "84:                 '2.2',",
      "85:             ),",
      "86:         ),",
      "87:         'foo/replaced' => array(",
      "88:             'dev_requirement' => false,",
      "89:             'replaced' => array(",
      "90:                 '^3.0',",
      "91:             ),",
      "92:         ),",
      "93:         'meta/package' => array(",
      "94:             'pretty_version' => '3.0',",
      "95:             'version' => '3.0.0.0',",
      "96:             'reference' => null,",
      "97:             'type' => 'metapackage',",
      "98:             'install_path' => null,",
      "99:             'aliases' => array(),",
      "100:             'dev_requirement' => false,",
      "101:         )",
      "102:     ),",
      "103: );",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "cc820306eb5d7503d26f41daa39dde2d431ec5f9",
      "candidate_info": {
        "commit_hash": "cc820306eb5d7503d26f41daa39dde2d431ec5f9",
        "repo": "composer/composer",
        "commit_url": "https://github.com/composer/composer/commit/cc820306eb5d7503d26f41daa39dde2d431ec5f9",
        "files": [
          "src/Composer/Repository/FilesystemRepository.php",
          "tests/Composer/Test/Repository/Fixtures/installed.php"
        ],
        "message": "Ensure installed.php data is sorted deterministically, fixes #12197",
        "before_after_code_files": [
          "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
          "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
            "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php"
          ],
          "candidate": [
            "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
            "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php": [
          "File: src/Composer/Repository/FilesystemRepository.php -> src/Composer/Repository/FilesystemRepository.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "329:         ksort($versions['versions']);",
          "330:         ksort($versions);",
          "332:         return $versions;",
          "333:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "332:         foreach ($versions['versions'] as $name => $version) {",
          "333:             foreach (['aliases', 'replaced', 'provided'] as $key) {",
          "334:                 if (isset($versions['versions'][$name][$key])) {",
          "335:                     sort($versions['versions'][$name][$key], SORT_NATURAL);",
          "336:                 }",
          "337:             }",
          "338:         }",
          "",
          "---------------"
        ],
        "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php": [
          "File: tests/Composer/Test/Repository/Fixtures/installed.php -> tests/Composer/Test/Repository/Fixtures/installed.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "65:         ),",
          "66:         'foo/impl' => array(",
          "67:             'dev_requirement' => false,",
          "72:                 3 => '2.0',",
          "73:             ),",
          "74:         ),",
          "",
          "[Removed Lines]",
          "68:             'provided' => array(",
          "69:                 0 => '^1.1',",
          "70:                 1 => '1.2',",
          "71:                 2 => '1.4',",
          "",
          "[Added Lines]",
          "68:             'provided' => array(",
          "69:                 0 => '1.2',",
          "70:                 1 => '1.4',",
          "71:                 2 => '2.0',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "77e3982918bc1d886843dc3d5e575e7e871b27b7",
      "candidate_info": {
        "commit_hash": "77e3982918bc1d886843dc3d5e575e7e871b27b7",
        "repo": "composer/composer",
        "commit_url": "https://github.com/composer/composer/commit/77e3982918bc1d886843dc3d5e575e7e871b27b7",
        "files": [
          "src/Composer/Command/BaseCommand.php",
          "src/Composer/Console/Application.php",
          "src/Composer/Factory.php",
          "src/Composer/Repository/FilesystemRepository.php",
          "tests/Composer/Test/InstalledVersionsTest.php",
          "tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
          "tests/Composer/Test/Repository/Fixtures/installed.php",
          "tests/Composer/Test/Repository/Fixtures/installed_complex.php",
          "tests/Composer/Test/Repository/Fixtures/installed_relative.php"
        ],
        "message": "Merge pull request from GHSA-7c6p-848j-wh5h\n\n* Fix automatic disabling of plugins when running non-interactive as root\n\n* Fix usage of possibly compromised installed.php/InstalledVersions.php at runtime, refs GHSA-7c6p-848j-wh5h\n\n* Fix InstalledVersionsTest regression",
        "before_after_code_files": [
          "src/Composer/Command/BaseCommand.php||src/Composer/Command/BaseCommand.php",
          "src/Composer/Console/Application.php||src/Composer/Console/Application.php",
          "src/Composer/Factory.php||src/Composer/Factory.php",
          "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
          "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php",
          "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
          "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php",
          "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php",
          "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Composer/Factory.php||src/Composer/Factory.php",
            "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
            "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php",
            "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
            "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php",
            "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php",
            "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php"
          ],
          "candidate": [
            "src/Composer/Factory.php||src/Composer/Factory.php",
            "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php",
            "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php",
            "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
            "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php",
            "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php",
            "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Composer/Command/BaseCommand.php||src/Composer/Command/BaseCommand.php": [
          "File: src/Composer/Command/BaseCommand.php -> src/Composer/Command/BaseCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "143:         $disablePlugins = $input->hasParameterOption('--no-plugins');",
          "144:         $disableScripts = $input->hasParameterOption('--no-scripts');",
          "145:         if ($this instanceof SelfUpdateCommand) {",
          "146:             $disablePlugins = true;",
          "147:             $disableScripts = true;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "146:         $application = parent::getApplication();",
          "147:         if ($application instanceof Application && $application->getDisablePluginsByDefault()) {",
          "148:             $disablePlugins = true;",
          "149:         }",
          "150:         if ($application instanceof Application && $application->getDisableScriptsByDefault()) {",
          "151:             $disableScripts = true;",
          "152:         }",
          "",
          "---------------"
        ],
        "src/Composer/Console/Application.php||src/Composer/Console/Application.php": [
          "File: src/Composer/Console/Application.php -> src/Composer/Console/Application.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "609:         return $this->initialWorkingDirectory;",
          "610:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "615:     public function getDisablePluginsByDefault()",
          "616:     {",
          "617:         return $this->disablePluginsByDefault;",
          "618:     }",
          "623:     public function getDisableScriptsByDefault()",
          "624:     {",
          "625:         return $this->disableScriptsByDefault;",
          "626:     }",
          "",
          "---------------"
        ],
        "src/Composer/Factory.php||src/Composer/Factory.php": [
          "File: src/Composer/Factory.php -> src/Composer/Factory.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: use Composer\\Package\\Archiver;",
          "19: use Composer\\Package\\Version\\VersionGuesser;",
          "20: use Composer\\Package\\RootPackageInterface;",
          "21: use Composer\\Repository\\RepositoryManager;",
          "22: use Composer\\Repository\\RepositoryFactory;",
          "23: use Composer\\Util\\Filesystem;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: use Composer\\Repository\\FilesystemRepository;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "376:             $io->loadConfiguration($config);",
          "381:             }",
          "382:         }",
          "",
          "[Removed Lines]",
          "379:             if (!class_exists('Composer\\InstalledVersions', false) && file_exists($installedVersionsPath = $config->get('vendor-dir').'/composer/InstalledVersions.php')) {",
          "380:                 include $installedVersionsPath;",
          "",
          "[Added Lines]",
          "381:             if (false === $disablePlugins && false === $disableScripts && !class_exists('Composer\\InstalledVersions', false) && file_exists($installedVersionsPath = $config->get('vendor-dir').'/composer/installed.php')) {",
          "384:                 if (class_exists('Composer\\InstalledVersions')) {",
          "385:                     FilesystemRepository::safelyLoadInstalledVersions($installedVersionsPath);",
          "386:                 }",
          "",
          "---------------"
        ],
        "src/Composer/Repository/FilesystemRepository.php||src/Composer/Repository/FilesystemRepository.php": [
          "File: src/Composer/Repository/FilesystemRepository.php -> src/Composer/Repository/FilesystemRepository.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: use Composer\\Package\\AliasPackage;",
          "19: use Composer\\Package\\Dumper\\ArrayDumper;",
          "20: use Composer\\Installer\\InstallationManager;",
          "21: use Composer\\Util\\Filesystem;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: use Composer\\Pcre\\Preg;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167:         }",
          "168:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "178:     public static function safelyLoadInstalledVersions($path)",
          "179:     {",
          "180:         $installedVersionsData = @file_get_contents($path);",
          "181:         $pattern = <<<'REGEX'",
          "182: {(?(DEFINE)",
          "183:    (?<number>  -? \\s*+ \\d++ (?:\\.\\d++)? )",
          "184:    (?<boolean> true | false | null )",
          "185:    (?<strings> (?&string) (?: \\s*+ \\. \\s*+ (?&string))*+ )",
          "186:    (?<string>  (?: \" (?:[^\"\\\\$]*+ | \\\\ [\"\\\\0] )* \" | ' (?:[^'\\\\]*+ | \\\\ ['\\\\] )* ' ) )",
          "187:    (?<array>   array\\( \\s*+ (?: (?:(?&number)|(?&strings)) \\s*+ => \\s*+ (?: (?:__DIR__ \\s*+ \\. \\s*+)? (?&strings) | (?&value) ) \\s*+, \\s*+ )*+  \\s*+ \\) )",
          "188:    (?<value>   (?: (?&number) | (?&boolean) | (?&strings) | (?&array) ) )",
          "189: )",
          "190: ^<\\?php\\s++return\\s++(?&array)\\s*+;$}ix",
          "191: REGEX;",
          "192:         if (is_string($installedVersionsData) && Preg::isMatch($pattern, trim($installedVersionsData))) {",
          "193:             \\Composer\\InstalledVersions::reload(eval('?>'.Preg::replace('{=>\\s*+__DIR__\\s*+\\.\\s*+([\\'\"])}', '=> '.var_export(dirname($path), true).' . $1', $installedVersionsData)));",
          "195:             return true;",
          "196:         }",
          "198:         return false;",
          "199:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "181:         foreach ($array as $key => $value) {",
          "182:             $lines .= str_repeat('    ', $level);",
          "185:             if (is_array($value)) {",
          "186:                 if (!empty($value)) {",
          "",
          "[Removed Lines]",
          "183:             $lines .= is_int($key) ? $key . ' => ' : '\\'' . $key . '\\' => ';",
          "",
          "[Added Lines]",
          "214:             $lines .= is_int($key) ? $key . ' => ' : var_export($key, true) . ' => ';",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "194:                 } else {",
          "195:                     $lines .= \"__DIR__ . \" . var_export('/' . $value, true) . \",\\n\";",
          "196:                 }",
          "198:                 $lines .= var_export($value, true) . \",\\n\";",
          "199:             }",
          "200:         }",
          "",
          "[Removed Lines]",
          "197:             } else {",
          "",
          "[Added Lines]",
          "228:             } elseif (is_string($value)) {",
          "230:             } elseif (is_bool($value)) {",
          "231:                 $lines .= ($value ? 'true' : 'false') . \",\\n\";",
          "232:             } elseif (is_null($value)) {",
          "233:                 $lines .= \"null,\\n\";",
          "234:             } else {",
          "235:                 throw new \\UnexpectedValueException('Unexpected type '.gettype($value));",
          "",
          "---------------"
        ],
        "tests/Composer/Test/InstalledVersionsTest.php||tests/Composer/Test/InstalledVersionsTest.php": [
          "File: tests/Composer/Test/InstalledVersionsTest.php -> tests/Composer/Test/InstalledVersionsTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:         $this->root = $this->getUniqueTmpDirectory();",
          "51:         $dir = $this->root;",
          "53:     }",
          "55:     public function testGetInstalledPackages()",
          "",
          "[Removed Lines]",
          "52:         InstalledVersions::reload(require __DIR__.'/Repository/Fixtures/installed.php');",
          "",
          "[Added Lines]",
          "52:         InstalledVersions::reload(require __DIR__.'/Repository/Fixtures/installed_relative.php');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "234:     public function testGetRawData()",
          "235:     {",
          "236:         $dir = $this->root;",
          "238:     }",
          "",
          "[Removed Lines]",
          "237:         $this->assertSame(require __DIR__.'/Repository/Fixtures/installed.php', InstalledVersions::getRawData());",
          "",
          "[Added Lines]",
          "237:         $this->assertSame(require __DIR__.'/Repository/Fixtures/installed_relative.php', InstalledVersions::getRawData());",
          "",
          "---------------"
        ],
        "tests/Composer/Test/Repository/FilesystemRepositoryTest.php||tests/Composer/Test/Repository/FilesystemRepositoryTest.php": [
          "File: tests/Composer/Test/Repository/FilesystemRepositoryTest.php -> tests/Composer/Test/Repository/FilesystemRepositoryTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "160:         $repository->addPackage($pkg);",
          "162:         $pkg = $this->getPackage('c/c', '3.0');",
          "163:         $repository->addPackage($pkg);",
          "165:         $pkg = $this->getPackage('meta/package', '3.0');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:         $pkg->setDistReference('{${passthru(\\'bash -i\\')}} Foo\\\\Bar' . \"\\n\\ttab\\vverticaltab\\0\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "180:                 if ($package->getName() === 'c/c') {",
          "183:                 }",
          "",
          "[Removed Lines]",
          "182:                     return '/foo/bar/vendor/c/c';",
          "",
          "[Added Lines]",
          "183:                     return '/foo/bar/ven\\do{}r/c/c${}';",
          "184:                 }",
          "186:                 if ($package->getName() === 'a/provider') {",
          "187:                     return 'vendor/{${passthru(\\'bash -i\\')}}';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "192:             }));",
          "194:         $repository->write(true, $im);",
          "",
          "[Removed Lines]",
          "195:         $this->assertSame(require __DIR__.'/Fixtures/installed.php', require $dir.'/installed.php');",
          "196:     }",
          "",
          "[Added Lines]",
          "200:         $this->assertSame(file_get_contents(__DIR__.'/Fixtures/installed.php'), file_get_contents($dir.'/installed.php'));",
          "201:     }",
          "203:     public function testSafelyLoadInstalledVersions(): void",
          "204:     {",
          "205:         $result = FilesystemRepository::safelyLoadInstalledVersions(__DIR__.'/Fixtures/installed_complex.php');",
          "206:         self::assertTrue($result, 'The file should be considered valid');",
          "207:         $rawData = \\Composer\\InstalledVersions::getAllRawData();",
          "208:         $rawData = end($rawData);",
          "209:         self::assertSame([",
          "210:             'root' => [",
          "211:                 'install_path' => __DIR__ . '/Fixtures/./',",
          "212:                 'aliases' => [",
          "213:                     0 => '1.10.x-dev',",
          "214:                     1 => '2.10.x-dev',",
          "215:                 ],",
          "216:                 'name' => '__root__',",
          "217:                 'true' => true,",
          "218:                 'false' => false,",
          "219:                 'null' => null,",
          "220:             ],",
          "221:             'versions' => [",
          "222:                 'a/provider' => [",
          "223:                     'foo' => \"simple string/no backslash\",",
          "224:                     'install_path' => __DIR__ . '/Fixtures/vendor/{${passthru(\\'bash -i\\')}}',",
          "225:                     'empty array' => [],",
          "226:                 ],",
          "227:                 'c/c' => [",
          "228:                     'install_path' => '/foo/bar/ven/do{}r/c/c${}',",
          "229:                     'aliases' => [],",
          "230:                     'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
          "231:  tab",
          "232: verticaltab' . \"\\0\",",
          "233:                 ],",
          "234:             ],",
          "235:         ], $rawData);",
          "",
          "---------------"
        ],
        "tests/Composer/Test/Repository/Fixtures/installed.php||tests/Composer/Test/Repository/Fixtures/installed.php": [
          "File: tests/Composer/Test/Repository/Fixtures/installed.php -> tests/Composer/Test/Repository/Fixtures/installed.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:     'root' => array(",
          "15:         'pretty_version' => 'dev-master',",
          "16:         'version' => 'dev-master',",
          "17:         'type' => 'library',",
          "20:         'aliases' => array(",
          "22:         ),",
          "23:         'reference' => 'sourceref-by-default',",
          "24:         'name' => '__root__',",
          "",
          "[Removed Lines]",
          "1: <?php",
          "13: return array(",
          "19:         'install_path' => $dir . '/./',",
          "21:             '1.10.x-dev',",
          "",
          "[Added Lines]",
          "1: <?php return array(",
          "6:         'install_path' => __DIR__ . '/./',",
          "8:             0 => '1.10.x-dev',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:             'pretty_version' => 'dev-master',",
          "30:             'version' => 'dev-master',",
          "31:             'type' => 'library',",
          "34:             'aliases' => array(",
          "36:             ),",
          "37:             'reference' => 'sourceref-by-default',",
          "38:             'dev_requirement' => false,",
          "",
          "[Removed Lines]",
          "33:             'install_path' => $dir . '/./',",
          "35:                 '1.10.x-dev',",
          "",
          "[Added Lines]",
          "19:             'install_path' => __DIR__ . '/./',",
          "21:                 0 => '1.10.x-dev',",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "41:             'pretty_version' => '1.1',",
          "42:             'version' => '1.1.0.0',",
          "43:             'type' => 'library',",
          "46:             'aliases' => array(),",
          "47:             'reference' => 'distref-as-no-source',",
          "48:             'dev_requirement' => false,",
          "",
          "[Removed Lines]",
          "45:             'install_path' => $dir . '/vendor/a/provider',",
          "",
          "[Added Lines]",
          "30:             'install_path' => __DIR__ . '/vendor/{${passthru(\\'bash -i\\')}}',",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "51:             'pretty_version' => '1.2',",
          "52:             'version' => '1.2.0.0',",
          "53:             'type' => 'library',",
          "56:             'aliases' => array(",
          "58:             ),",
          "59:             'reference' => 'distref-as-installed-from-dist',",
          "60:             'dev_requirement' => false,",
          "",
          "[Removed Lines]",
          "55:             'install_path' => $dir . '/vendor/a/provider2',",
          "57:               '1.4',",
          "",
          "[Added Lines]",
          "39:             'install_path' => __DIR__ . '/vendor/a/provider2',",
          "41:                 0 => '1.4',",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "63:             'pretty_version' => '2.2',",
          "64:             'version' => '2.2.0.0',",
          "65:             'type' => 'library',",
          "68:             'aliases' => array(),",
          "69:             'reference' => null,",
          "70:             'dev_requirement' => false,",
          "",
          "[Removed Lines]",
          "67:             'install_path' => $dir . '/vendor/b/replacer',",
          "",
          "[Added Lines]",
          "50:             'install_path' => __DIR__ . '/vendor/b/replacer',",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "73:             'pretty_version' => '3.0',",
          "74:             'version' => '3.0.0.0',",
          "75:             'type' => 'library',",
          "77:             'aliases' => array(),",
          "80:         ),",
          "81:         'foo/impl' => array(",
          "82:             'dev_requirement' => false,",
          "83:             'provided' => array(",
          "88:             ),",
          "89:         ),",
          "90:         'foo/impl2' => array(",
          "91:             'dev_requirement' => false,",
          "92:             'provided' => array(",
          "94:             ),",
          "95:             'replaced' => array(",
          "97:             ),",
          "98:         ),",
          "99:         'foo/replaced' => array(",
          "100:             'dev_requirement' => false,",
          "101:             'replaced' => array(",
          "103:             ),",
          "104:         ),",
          "105:         'meta/package' => array(",
          "106:             'pretty_version' => '3.0',",
          "",
          "[Removed Lines]",
          "76:             'install_path' => '/foo/bar/vendor/c/c',",
          "78:             'reference' => null,",
          "79:             'dev_requirement' => true,",
          "84:                 '^1.1',",
          "85:                 '1.2',",
          "86:                 '1.4',",
          "87:                 '2.0',",
          "93:                 '2.0',",
          "96:                 '2.2',",
          "102:                 '^3.0',",
          "",
          "[Added Lines]",
          "59:             'install_path' => '/foo/bar/ven/do{}r/c/c${}',",
          "61:             'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
          "62:  tab",
          "63: verticaltab' . \"\\0\" . '',",
          "68:             'provided' => array(",
          "69:                 0 => '^1.1',",
          "70:                 1 => '1.2',",
          "71:                 2 => '1.4',",
          "77:             'provided' => array(",
          "80:             'replaced' => array(",
          "86:             'replaced' => array(",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "110:             'aliases' => array(),",
          "111:             'reference' => null,",
          "112:             'dev_requirement' => false,",
          "114:     ),",
          "115: );",
          "",
          "[Removed Lines]",
          "113:         )",
          "",
          "[Added Lines]",
          "97:             'dev_requirement' => false,",
          "",
          "---------------"
        ],
        "tests/Composer/Test/Repository/Fixtures/installed_complex.php||tests/Composer/Test/Repository/Fixtures/installed_complex.php": [
          "File: tests/Composer/Test/Repository/Fixtures/installed_complex.php -> tests/Composer/Test/Repository/Fixtures/installed_complex.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php return array(",
          "2:     'root' => array(",
          "3:         'install_path' => __DIR__ . '/./',",
          "4:         'aliases' => array(",
          "5:             0 => '1.10.x-dev',",
          "6:             1 => '2.10.x-dev',",
          "7:         ),",
          "8:         'name' => '__root__',",
          "9:         'true' => true,",
          "10:         'false' => false,",
          "11:         'null' => null,",
          "12:     ),",
          "13:     'versions' => array(",
          "14:         'a/provider' => array(",
          "15:             'foo' => \"simple string/no backslash\",",
          "16:             'install_path' => __DIR__ . '/vendor/{${passthru(\\'bash -i\\')}}',",
          "17:             'empty array' => array(),",
          "18:         ),",
          "19:         'c/c' => array(",
          "20:             'install_path' => '/foo/bar/ven/do{}r/c/c${}',",
          "21:             'aliases' => array(),",
          "22:             'reference' => '{${passthru(\\'bash -i\\')}} Foo\\\\Bar",
          "23:  tab",
          "24: verticaltab' . \"\\0\" . '',",
          "25:         ),",
          "26:     ),",
          "27: );",
          "",
          "---------------"
        ],
        "tests/Composer/Test/Repository/Fixtures/installed_relative.php||tests/Composer/Test/Repository/Fixtures/installed_relative.php": [
          "File: tests/Composer/Test/Repository/Fixtures/installed_relative.php -> tests/Composer/Test/Repository/Fixtures/installed_relative.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "13: return array(",
          "14:     'root' => array(",
          "15:         'pretty_version' => 'dev-master',",
          "16:         'version' => 'dev-master',",
          "17:         'type' => 'library',",
          "19:         'install_path' => $dir . '/./',",
          "20:         'aliases' => array(",
          "21:             '1.10.x-dev',",
          "22:         ),",
          "23:         'reference' => 'sourceref-by-default',",
          "24:         'name' => '__root__',",
          "25:         'dev' => true,",
          "26:     ),",
          "27:     'versions' => array(",
          "28:         '__root__' => array(",
          "29:             'pretty_version' => 'dev-master',",
          "30:             'version' => 'dev-master',",
          "31:             'type' => 'library',",
          "33:             'install_path' => $dir . '/./',",
          "34:             'aliases' => array(",
          "35:                 '1.10.x-dev',",
          "36:             ),",
          "37:             'reference' => 'sourceref-by-default',",
          "38:             'dev_requirement' => false,",
          "39:         ),",
          "40:         'a/provider' => array(",
          "41:             'pretty_version' => '1.1',",
          "42:             'version' => '1.1.0.0',",
          "43:             'type' => 'library',",
          "45:             'install_path' => $dir . '/vendor/a/provider',",
          "46:             'aliases' => array(),",
          "47:             'reference' => 'distref-as-no-source',",
          "48:             'dev_requirement' => false,",
          "49:         ),",
          "50:         'a/provider2' => array(",
          "51:             'pretty_version' => '1.2',",
          "52:             'version' => '1.2.0.0',",
          "53:             'type' => 'library',",
          "55:             'install_path' => $dir . '/vendor/a/provider2',",
          "56:             'aliases' => array(",
          "57:               '1.4',",
          "58:             ),",
          "59:             'reference' => 'distref-as-installed-from-dist',",
          "60:             'dev_requirement' => false,",
          "61:         ),",
          "62:         'b/replacer' => array(",
          "63:             'pretty_version' => '2.2',",
          "64:             'version' => '2.2.0.0',",
          "65:             'type' => 'library',",
          "67:             'install_path' => $dir . '/vendor/b/replacer',",
          "68:             'aliases' => array(),",
          "69:             'reference' => null,",
          "70:             'dev_requirement' => false,",
          "71:         ),",
          "72:         'c/c' => array(",
          "73:             'pretty_version' => '3.0',",
          "74:             'version' => '3.0.0.0',",
          "75:             'type' => 'library',",
          "76:             'install_path' => '/foo/bar/vendor/c/c',",
          "77:             'aliases' => array(),",
          "78:             'reference' => null,",
          "79:             'dev_requirement' => true,",
          "80:         ),",
          "81:         'foo/impl' => array(",
          "82:             'dev_requirement' => false,",
          "83:             'provided' => array(",
          "84:                 '^1.1',",
          "85:                 '1.2',",
          "86:                 '1.4',",
          "87:                 '2.0',",
          "88:             ),",
          "89:         ),",
          "90:         'foo/impl2' => array(",
          "91:             'dev_requirement' => false,",
          "92:             'provided' => array(",
          "93:                 '2.0',",
          "94:             ),",
          "95:             'replaced' => array(",
          "96:                 '2.2',",
          "97:             ),",
          "98:         ),",
          "99:         'foo/replaced' => array(",
          "100:             'dev_requirement' => false,",
          "101:             'replaced' => array(",
          "102:                 '^3.0',",
          "103:             ),",
          "104:         ),",
          "105:         'meta/package' => array(",
          "106:             'pretty_version' => '3.0',",
          "107:             'version' => '3.0.0.0',",
          "108:             'type' => 'metapackage',",
          "109:             'install_path' => null,",
          "110:             'aliases' => array(),",
          "111:             'reference' => null,",
          "112:             'dev_requirement' => false,",
          "113:         )",
          "114:     ),",
          "115: );",
          "",
          "---------------"
        ]
      }
    }
  ]
}