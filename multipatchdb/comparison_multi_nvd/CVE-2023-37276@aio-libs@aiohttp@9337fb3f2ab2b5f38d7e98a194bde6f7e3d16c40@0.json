{
  "cve_id": "CVE-2023-37276",
  "cve_desc": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. aiohttp v3.8.4 and earlier are bundled with llhttp v6.0.6. Vulnerable code is used by aiohttp for its HTTP request parser when available which is the default case when installing from a wheel. This vulnerability only affects users of aiohttp as an HTTP server (ie `aiohttp.Application`), you are not affected by this vulnerability if you are using aiohttp as an HTTP client library (ie `aiohttp.ClientSession`). Sending a crafted HTTP request will cause the server to misinterpret one of the HTTP header values leading to HTTP request smuggling. This issue has been addressed in version 3.8.5. Users are advised to upgrade. Users unable to upgrade can reinstall aiohttp using `AIOHTTP_NO_EXTENSIONS=1` as an environment variable to disable the llhttp HTTP request parser implementation. The pure Python implementation isn't vulnerable.",
  "repo": "aio-libs/aiohttp",
  "patch_hash": "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
  "patch_info": {
    "commit_hash": "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
    "repo": "aio-libs/aiohttp",
    "commit_url": "https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
    "files": [
      ".gitmodules",
      "docs/contributing.rst",
      "tests/test_http_parser.py",
      "vendor/README.rst",
      "vendor/llhttp"
    ],
    "message": "Fix bump llhttp to v8.1.1 (#7367) (#7377)\n\n(cherry picked from commit 41e2c4c1fdf34d800bb9e4247cd9ebfc6904d9d7)",
    "before_after_code_files": [
      "tests/test_http_parser.py||tests/test_http_parser.py"
    ]
  },
  "patch_diff": {
    "tests/test_http_parser.py||tests/test_http_parser.py": [
      "File: tests/test_http_parser.py -> tests/test_http_parser.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "685:         response.feed_data(b\"HTT/1\\r\\n\\r\\n\")",
      "688: def test_http_response_parser_code_under_100(response) -> None:",
      "689:     msg = response.feed_data(b\"HTTP/1.1 99 test\\r\\n\\r\\n\")[0][0][0]",
      "690:     assert msg.code == 99",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "688: @pytest.mark.skipif(not NO_EXTENSIONS, reason=\"Behaviour has changed in C parser\")",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e7fe416752d2b2ec6edc80c2b03ab47f4136d52e",
      "candidate_info": {
        "commit_hash": "e7fe416752d2b2ec6edc80c2b03ab47f4136d52e",
        "repo": "aio-libs/aiohttp",
        "commit_url": "https://github.com/aio-libs/aiohttp/commit/e7fe416752d2b2ec6edc80c2b03ab47f4136d52e",
        "files": [
          ".gitmodules",
          "docs/contributing.rst",
          "tests/test_http_parser.py",
          "vendor/README.rst",
          "vendor/llhttp"
        ],
        "message": "Fix bump llhttp to v8.1.1 (#7367) (#7376)\n\n(cherry picked from commit 41e2c4c1fdf34d800bb9e4247cd9ebfc6904d9d7)",
        "before_after_code_files": [
          "tests/test_http_parser.py||tests/test_http_parser.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_cherry_pick": 1,
        "olp_code_files": {
          "patch": [
            "tests/test_http_parser.py||tests/test_http_parser.py"
          ],
          "candidate": [
            "tests/test_http_parser.py||tests/test_http_parser.py"
          ]
        }
      },
      "candidate_diff": {
        "tests/test_http_parser.py||tests/test_http_parser.py": [
          "File: tests/test_http_parser.py -> tests/test_http_parser.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "693:         response.feed_data(b\"HTT/1\\r\\n\\r\\n\")",
          "696: def test_http_response_parser_code_under_100(response) -> None:",
          "697:     msg = response.feed_data(b\"HTTP/1.1 99 test\\r\\n\\r\\n\")[0][0][0]",
          "698:     assert msg.code == 99",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "696: @pytest.mark.skipif(not NO_EXTENSIONS, reason=\"Behaviour has changed in C parser\")",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "41e2c4c1fdf34d800bb9e4247cd9ebfc6904d9d7",
      "candidate_info": {
        "commit_hash": "41e2c4c1fdf34d800bb9e4247cd9ebfc6904d9d7",
        "repo": "aio-libs/aiohttp",
        "commit_url": "https://github.com/aio-libs/aiohttp/commit/41e2c4c1fdf34d800bb9e4247cd9ebfc6904d9d7",
        "files": [
          ".gitmodules",
          "docs/contributing.rst",
          "tests/test_http_parser.py",
          "vendor/README.rst",
          "vendor/llhttp"
        ],
        "message": "Fix bump llhttp to v8.1.1 (#7367)",
        "before_after_code_files": [
          "tests/test_http_parser.py||tests/test_http_parser.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_cherry_pick": 1,
        "olp_code_files": {
          "patch": [
            "tests/test_http_parser.py||tests/test_http_parser.py"
          ],
          "candidate": [
            "tests/test_http_parser.py||tests/test_http_parser.py"
          ]
        }
      },
      "candidate_diff": {
        "tests/test_http_parser.py||tests/test_http_parser.py": [
          "File: tests/test_http_parser.py -> tests/test_http_parser.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "694:         response.feed_data(b\"HTT/1\\r\\n\\r\\n\")",
          "697: def test_http_response_parser_code_under_100(response: Any) -> None:",
          "698:     msg = response.feed_data(b\"HTTP/1.1 99 test\\r\\n\\r\\n\")[0][0][0]",
          "699:     assert msg.code == 99",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "697: @pytest.mark.skipif(not NO_EXTENSIONS, reason=\"Behaviour has changed in C parser\")",
          "",
          "---------------"
        ]
      }
    }
  ]
}