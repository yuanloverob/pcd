{
  "cve_id": "CVE-2017-12662",
  "cve_desc": "ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePDFImage in coders/pdf.c.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "bd40cc5f53067322861b881485cbd70f509f3829",
  "patch_info": {
    "commit_hash": "bd40cc5f53067322861b881485cbd70f509f3829",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/bd40cc5f53067322861b881485cbd70f509f3829",
    "files": [
      "coders/pdf.c"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/issues/576",
    "before_after_code_files": [
      "coders/pdf.c||coders/pdf.c"
    ]
  },
  "patch_diff": {
    "coders/pdf.c||coders/pdf.c": [
      "File: coders/pdf.c -> coders/pdf.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1989:           default:",
      "1990:           {",
      "1991:             MemoryInfo",
      "1995:               Allocate pixel array.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1995:               Allocate pixel array.",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2086:             case RLECompression:",
      "2087:             default:",
      "2088:             {",
      "2093:                 Allocate pixel array.",
      "",
      "[Removed Lines]",
      "2089:               MemoryInfo",
      "",
      "[Added Lines]",
      "2093:               MemoryInfo",
      "2097:                 Allocate pixel array.",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2ad9ed3b3247fc96a47d488cd40db2f63f08d4e3",
      "candidate_info": {
        "commit_hash": "2ad9ed3b3247fc96a47d488cd40db2f63f08d4e3",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/2ad9ed3b3247fc96a47d488cd40db2f63f08d4e3",
        "files": [
          "coders/pdf.c"
        ],
        "message": "...",
        "before_after_code_files": [
          "coders/pdf.c||coders/pdf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/pdf.c||coders/pdf.c"
          ],
          "candidate": [
            "coders/pdf.c||coders/pdf.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/pdf.c||coders/pdf.c": [
          "File: coders/pdf.c -> coders/pdf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1158:   write_info=DestroyImageInfo(write_info);",
          "1159:   if (WriteBlob(image,length,group4) != (ssize_t) length)",
          "1160:     status=MagickFalse;",
          "1161:   group4=(unsigned char *) RelinquishMagickMemory(group4);",
          "1162:   return(status);",
          "1163: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1161:   group4=(unsigned char *) RelinquishMagickMemory(group4);",
          "1162:   return(status);",
          "1163: }",
          "1165: static MagickBooleanType WritePDFImage(const ImageInfo *image_info,Image *image,",
          "1166:   ExceptionInfo *exception)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1830:         (void) FormatLocaleString(buffer,MagickPathExtent,\"/SMask %.20g 0 R\\n\",",
          "1831:           (double) object+(has_icc_profile != MagickFalse ? 9 : 7));",
          "1832:         (void) WriteBlobString(image,buffer);",
          "1834:     (void) FormatLocaleString(buffer,MagickPathExtent,\"/Length %.20g 0 R\\n\",",
          "1835:       (double) object+1);",
          "1836:     (void) WriteBlobString(image,buffer);",
          "",
          "[Removed Lines]",
          "1833:       }",
          "",
          "[Added Lines]",
          "1839:       }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1880:           case RLECompression:",
          "1881:           default:",
          "1882:           {",
          "",
          "[Removed Lines]",
          "1883:             MemoryInfo",
          "",
          "[Added Lines]",
          "1889:             MemoryInfo",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1992:             MemoryInfo",
          "1998:             length=(size_t) number_pixels;",
          "1999:             length*=image->colorspace == CMYKColorspace ? 4UL : 3UL;",
          "",
          "[Removed Lines]",
          "1996:               Allocate pixel array.",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2093:             {",
          "2094:               MemoryInfo",
          "2098:                 Allocate pixel array.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2408:           {",
          "2409:             MemoryInfo",
          "2413:               Allocate pixel array.",
          "2415:             length=(size_t) number_pixels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2512:             MemoryInfo",
          "2518:             length=(size_t) number_pixels;",
          "2519:             length*=tile_image->colorspace == CMYKColorspace ? 4UL : 3UL;",
          "",
          "[Removed Lines]",
          "2516:               Allocate pixel array.",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2604:             {",
          "2605:               MemoryInfo",
          "2609:                 Allocate pixel array.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2818:           {",
          "2819:             MemoryInfo",
          "2823:               Allocate pixel array.",
          "2825:             length=(size_t) number_pixels;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}