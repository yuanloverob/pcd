{
  "cve_id": "CVE-2022-23633",
  "cve_desc": "Action Pack is a framework for handling and responding to web requests. Under certain circumstances response bodies will not be closed. In the event a response is *not* notified of a `close`, `ActionDispatch::Executor` will not know to reset thread local state for the next request. This can lead to data being leaked to subsequent requests.This has been fixed in Rails 7.0.2.1, 6.1.4.5, 6.0.4.5, and 5.2.6.1. Upgrading is highly recommended, but to work around this problem a middleware described in GHSA-wh98-p28r-vrc9 can be used.",
  "repo": "rails/rails",
  "patch_hash": "f9a2ad03943d5c2ba54e1d45f155442b519c75da",
  "patch_info": {
    "commit_hash": "f9a2ad03943d5c2ba54e1d45f155442b519c75da",
    "repo": "rails/rails",
    "commit_url": "https://github.com/rails/rails/commit/f9a2ad03943d5c2ba54e1d45f155442b519c75da",
    "files": [
      "activesupport/lib/active_support/reloader.rb"
    ],
    "message": "Fix reloader to work with new Executor signature\n\nThis is a follow up to [CVE-2022-23633].",
    "before_after_code_files": [
      "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
    ]
  },
  "patch_diff": {
    "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb": [
      "File: activesupport/lib/active_support/reloader.rb -> activesupport/lib/active_support/reloader.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "58:       prepare!",
      "59:     end",
      "62:       if check!",
      "63:         super",
      "64:       else",
      "",
      "[Removed Lines]",
      "61:     def self.run! # :nodoc:",
      "",
      "[Added Lines]",
      "61:     def self.run!(reset: false) # :nodoc:",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1b5aadc0182adcb4dc10b42de88a1ad3e870abe7",
      "candidate_info": {
        "commit_hash": "1b5aadc0182adcb4dc10b42de88a1ad3e870abe7",
        "repo": "rails/rails",
        "commit_url": "https://github.com/rails/rails/commit/1b5aadc0182adcb4dc10b42de88a1ad3e870abe7",
        "files": [
          "activesupport/lib/active_support/isolated_execution_state.rb",
          "activesupport/lib/active_support/reloader.rb"
        ],
        "message": "Fix reloader to work with new Executor signature\n\nThis is a follow up to [CVE-2022-23633].",
        "before_after_code_files": [
          "activesupport/lib/active_support/isolated_execution_state.rb||activesupport/lib/active_support/isolated_execution_state.rb",
          "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ],
          "candidate": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ]
        }
      },
      "candidate_diff": {
        "activesupport/lib/active_support/isolated_execution_state.rb||activesupport/lib/active_support/isolated_execution_state.rb": [
          "File: activesupport/lib/active_support/isolated_execution_state.rb -> activesupport/lib/active_support/isolated_execution_state.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:       end",
          "40:       def key?(key)",
          "42:       end",
          "44:       def delete(key)",
          "46:       end",
          "48:       def clear",
          "",
          "[Removed Lines]",
          "41:         state.key?(key)",
          "45:         state.delete(key)",
          "",
          "[Added Lines]",
          "41:         current.key?(key)",
          "45:         current.delete(key)",
          "",
          "---------------"
        ],
        "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb": [
          "File: activesupport/lib/active_support/reloader.rb -> activesupport/lib/active_support/reloader.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "58:       prepare!",
          "59:     end",
          "62:       if check!",
          "63:         super",
          "64:       else",
          "",
          "[Removed Lines]",
          "61:     def self.run! # :nodoc:",
          "",
          "[Added Lines]",
          "61:     def self.run!(reset: false) # :nodoc:",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "676ad96fa5d9d0213babc32c9bad8190597a00d1",
      "candidate_info": {
        "commit_hash": "676ad96fa5d9d0213babc32c9bad8190597a00d1",
        "repo": "rails/rails",
        "commit_url": "https://github.com/rails/rails/commit/676ad96fa5d9d0213babc32c9bad8190597a00d1",
        "files": [
          "activesupport/lib/active_support/reloader.rb"
        ],
        "message": "Fix reloader to work with new Executor signature\n\nThis is a follow up to [CVE-2022-23633].",
        "before_after_code_files": [
          "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ],
          "candidate": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ]
        }
      },
      "candidate_diff": {
        "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb": [
          "File: activesupport/lib/active_support/reloader.rb -> activesupport/lib/active_support/reloader.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "59:       prepare!",
          "60:     end",
          "63:       if check!",
          "64:         super",
          "65:       else",
          "",
          "[Removed Lines]",
          "62:     def self.run! # :nodoc:",
          "",
          "[Added Lines]",
          "62:     def self.run!(reset: false) # :nodoc:",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d1267768e9f57ebcf86ff7f011aca7fb08e733eb",
      "candidate_info": {
        "commit_hash": "d1267768e9f57ebcf86ff7f011aca7fb08e733eb",
        "repo": "rails/rails",
        "commit_url": "https://github.com/rails/rails/commit/d1267768e9f57ebcf86ff7f011aca7fb08e733eb",
        "files": [
          "activesupport/lib/active_support/reloader.rb"
        ],
        "message": "Fix reloader to work with new Executor signature\n\nThis is a follow up to [CVE-2022-23633].",
        "before_after_code_files": [
          "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ],
          "candidate": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ]
        }
      },
      "candidate_diff": {
        "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb": [
          "File: activesupport/lib/active_support/reloader.rb -> activesupport/lib/active_support/reloader.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "58:       prepare!",
          "59:     end",
          "62:       if check!",
          "63:         super",
          "64:       else",
          "",
          "[Removed Lines]",
          "61:     def self.run! # :nodoc:",
          "",
          "[Added Lines]",
          "61:     def self.run!(reset: false) # :nodoc:",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f85b396e5a0019eb614e4ee436ea713089696833",
      "candidate_info": {
        "commit_hash": "f85b396e5a0019eb614e4ee436ea713089696833",
        "repo": "rails/rails",
        "commit_url": "https://github.com/rails/rails/commit/f85b396e5a0019eb614e4ee436ea713089696833",
        "files": [
          "activesupport/lib/active_support/reloader.rb"
        ],
        "message": "Fix reloader to work with new Executor signature\n\nThis is a follow up to [CVE-2022-23633].",
        "before_after_code_files": [
          "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ],
          "candidate": [
            "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb"
          ]
        }
      },
      "candidate_diff": {
        "activesupport/lib/active_support/reloader.rb||activesupport/lib/active_support/reloader.rb": [
          "File: activesupport/lib/active_support/reloader.rb -> activesupport/lib/active_support/reloader.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "58:       prepare!",
          "59:     end",
          "62:       if check!",
          "63:         super",
          "64:       else",
          "",
          "[Removed Lines]",
          "61:     def self.run! # :nodoc:",
          "",
          "[Added Lines]",
          "61:     def self.run!(reset: false) # :nodoc:",
          "",
          "---------------"
        ]
      }
    }
  ]
}