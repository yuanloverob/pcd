{
  "cve_id": "CVE-2020-8565",
  "cve_desc": "In Kubernetes, if the logging level is set to at least 9, authorization and bearer tokens will be written to log files. This can occur both in API server logs and client tool output like kubectl. This affects <= v1.19.3, <= v1.18.10, <= v1.17.13, < v1.20.0-alpha2.",
  "repo": "kubernetes/kubernetes",
  "patch_hash": "e99df0e5a75eb6e86123b56d53e9b7ca0fd00419",
  "patch_info": {
    "commit_hash": "e99df0e5a75eb6e86123b56d53e9b7ca0fd00419",
    "repo": "kubernetes/kubernetes",
    "commit_url": "https://github.com/kubernetes/kubernetes/commit/e99df0e5a75eb6e86123b56d53e9b7ca0fd00419",
    "files": [
      "staging/src/k8s.io/client-go/transport/round_trippers.go"
    ],
    "message": "Merge pull request #95316 from sfowl/mask-token-in-toCurl\n\nMask bearer token in logs when logLevel >= 9",
    "before_after_code_files": [
      "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
    ]
  },
  "patch_diff": {
    "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go": [
      "File: staging/src/k8s.io/client-go/transport/round_trippers.go -> staging/src/k8s.io/client-go/transport/round_trippers.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "340:  headers := \"\"",
      "341:  for key, values := range r.RequestHeaders {",
      "342:   for _, value := range values {",
      "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
      "344:   }",
      "345:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "343:    value = maskValue(key, value)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f0f52255412cbc6834bd225a59608ebb4a0d399b",
      "candidate_info": {
        "commit_hash": "f0f52255412cbc6834bd225a59608ebb4a0d399b",
        "repo": "kubernetes/kubernetes",
        "commit_url": "https://github.com/kubernetes/kubernetes/commit/f0f52255412cbc6834bd225a59608ebb4a0d399b",
        "files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9",
        "before_after_code_files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/kubernetes/kubernetes/pull/95316"
        ],
        "olp_code_files": {
          "patch": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ],
          "candidate": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go": [
          "File: staging/src/k8s.io/client-go/transport/round_trippers.go -> staging/src/k8s.io/client-go/transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5d1b08e4cd270d84152fdde0b13d643b1bca0576",
      "candidate_info": {
        "commit_hash": "5d1b08e4cd270d84152fdde0b13d643b1bca0576",
        "repo": "kubernetes/kubernetes",
        "commit_url": "https://github.com/kubernetes/kubernetes/commit/5d1b08e4cd270d84152fdde0b13d643b1bca0576",
        "files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9",
        "before_after_code_files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ],
          "candidate": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go": [
          "File: staging/src/k8s.io/client-go/transport/round_trippers.go -> staging/src/k8s.io/client-go/transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f5bf592fc0d60fe2f135bcea30a61b7ee6d8f2b9",
      "candidate_info": {
        "commit_hash": "f5bf592fc0d60fe2f135bcea30a61b7ee6d8f2b9",
        "repo": "kubernetes/kubernetes",
        "commit_url": "https://github.com/kubernetes/kubernetes/commit/f5bf592fc0d60fe2f135bcea30a61b7ee6d8f2b9",
        "files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9",
        "before_after_code_files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ],
          "candidate": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go": [
          "File: staging/src/k8s.io/client-go/transport/round_trippers.go -> staging/src/k8s.io/client-go/transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "27f5d24017078154d39ccd258bd83562c911fed8",
      "candidate_info": {
        "commit_hash": "27f5d24017078154d39ccd258bd83562c911fed8",
        "repo": "kubernetes/kubernetes",
        "commit_url": "https://github.com/kubernetes/kubernetes/commit/27f5d24017078154d39ccd258bd83562c911fed8",
        "files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9",
        "before_after_code_files": [
          "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ],
          "candidate": [
            "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "staging/src/k8s.io/client-go/transport/round_trippers.go||staging/src/k8s.io/client-go/transport/round_trippers.go": [
          "File: staging/src/k8s.io/client-go/transport/round_trippers.go -> staging/src/k8s.io/client-go/transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    }
  ]
}