{
  "cve_id": "CVE-2018-1000079",
  "cve_desc": "RubyGems version Ruby 2.2 series: 2.2.9 and earlier, Ruby 2.3 series: 2.3.6 and earlier, Ruby 2.4 series: 2.4.3 and earlier, Ruby 2.5 series: 2.5.0 and earlier, prior to trunk revision 62422 contains a Directory Traversal vulnerability in gem installation that can result in the gem could write to arbitrary filesystem locations during installation. This attack appear to be exploitable via the victim must install a malicious gem. This vulnerability appears to have been fixed in 2.7.6.",
  "repo": "rubygems/rubygems",
  "patch_hash": "f83f911e19e27cbac1ccce7471d96642241dd759",
  "patch_info": {
    "commit_hash": "f83f911e19e27cbac1ccce7471d96642241dd759",
    "repo": "rubygems/rubygems",
    "commit_url": "https://github.com/rubygems/rubygems/commit/f83f911e19e27cbac1ccce7471d96642241dd759",
    "files": [
      "lib/rubygems/package.rb"
    ],
    "message": "Add bug fix for #270068",
    "before_after_code_files": [
      "lib/rubygems/package.rb||lib/rubygems/package.rb"
    ]
  },
  "patch_diff": {
    "lib/rubygems/package.rb||lib/rubygems/package.rb": [
      "File: lib/rubygems/package.rb -> lib/rubygems/package.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "424:     destination = File.expand_path destination",
      "426:     raise Gem::Package::PathError.new(destination, destination_dir) unless",
      "429:     destination.untaint",
      "430:     destination",
      "",
      "[Removed Lines]",
      "427:       destination.start_with? destination_dir",
      "",
      "[Added Lines]",
      "427:       destination.start_with? destination_dir + '/'",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "efcaafe796a604218478092b28e96d64cdb3875c",
      "candidate_info": {
        "commit_hash": "efcaafe796a604218478092b28e96d64cdb3875c",
        "repo": "rubygems/rubygems",
        "commit_url": "https://github.com/rubygems/rubygems/commit/efcaafe796a604218478092b28e96d64cdb3875c",
        "files": [
          "test/rubygems/test_gem_package.rb"
        ],
        "message": "Add failing test for #270068",
        "before_after_code_files": [
          "test/rubygems/test_gem_package.rb||test/rubygems/test_gem_package.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/rubygems/test_gem_package.rb||test/rubygems/test_gem_package.rb": [
          "File: test/rubygems/test_gem_package.rb -> test/rubygems/test_gem_package.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "566:                  \"#{@destination} is not allowed\", e.message)",
          "567:   end",
          "569:   def test_load_spec",
          "570:     entry = StringIO.new Gem.gzip @spec.to_yaml",
          "571:     def entry.full_name() 'metadata.gz' end",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "569:   def test_install_location_suffix",
          "570:     package = Gem::Package.new @gem",
          "572:     filename = \"../#{File.basename(@destination)}suffix.rb\"",
          "574:     e = assert_raises Gem::Package::PathError do",
          "575:       package.install_location filename, @destination",
          "576:     end",
          "578:     parent = File.expand_path File.join @destination, filename",
          "580:     assert_equal(\"installing into parent path #{parent} of \" +",
          "581:                  \"#{@destination} is not allowed\", e.message)",
          "582:   end",
          "",
          "---------------"
        ]
      }
    }
  ]
}