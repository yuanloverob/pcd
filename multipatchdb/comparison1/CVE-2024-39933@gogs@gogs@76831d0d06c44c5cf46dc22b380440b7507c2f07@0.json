{
  "cve_id": "CVE-2024-39933",
  "cve_desc": "Gogs through 0.13.0 allows argument injection during the tagging of a new release.",
  "repo": "gogs/gogs",
  "patch_hash": "76831d0d06c44c5cf46dc22b380440b7507c2f07",
  "patch_info": {
    "commit_hash": "76831d0d06c44c5cf46dc22b380440b7507c2f07",
    "repo": "gogs/gogs",
    "commit_url": "https://github.com/gogs/gogs/commit/76831d0d06c44c5cf46dc22b380440b7507c2f07",
    "files": [
      "CODEOWNERS",
      "go.mod",
      "go.sum",
      "internal/database/release.go",
      "internal/database/repo_editor.go"
    ],
    "message": "dep: update github.com/gogs/git-module to v1.8.4 (#7872)\n\n## Describe the pull request\n\nFixes\nhttps://github.com/gogs/gogs/security/advisories/GHSA-m27m-h5gj-wwmg by\nincluding https://github.com/gogs/git-module/pull/110",
    "before_after_code_files": [
      "go.mod||go.mod",
      "go.sum||go.sum",
      "internal/database/release.go||internal/database/release.go",
      "internal/database/repo_editor.go||internal/database/repo_editor.go"
    ]
  },
  "patch_diff": {
    "go.mod||go.mod": [
      "File: go.mod -> go.mod",
      "--- Hunk 1 ---",
      "[Context before]",
      "17:  github.com/go-macaron/toolbox v0.0.0-20190813233741-94defb8383c6",
      "18:  github.com/gogs/chardet v0.0.0-20150115103509-2404f7772561",
      "19:  github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14",
      "21:  github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4",
      "22:  github.com/gogs/go-libravatar v0.0.0-20191106065024-33a75213d0a0",
      "23:  github.com/gogs/minwinsvc v0.0.0-20170301035411-95be6356811a",
      "",
      "[Removed Lines]",
      "20:  github.com/gogs/git-module v1.8.3",
      "",
      "[Added Lines]",
      "20:  github.com/gogs/git-module v1.8.4",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "37:  github.com/satori/go.uuid v1.2.0",
      "38:  github.com/sergi/go-diff v1.3.1",
      "39:  github.com/sourcegraph/run v0.12.0",
      "41:  github.com/unknwon/cae v1.0.2",
      "42:  github.com/unknwon/com v1.0.1",
      "43:  github.com/unknwon/i18n v0.0.0-20190805065654-5c6446a380b6",
      "",
      "[Removed Lines]",
      "40:  github.com/stretchr/testify v1.9.0",
      "",
      "[Added Lines]",
      "40:  github.com/stretchr/testify v1.10.0",
      "",
      "---------------"
    ],
    "go.sum||go.sum": [
      "File: go.sum -> go.sum",
      "--- Hunk 1 ---",
      "[Context before]",
      "129: github.com/gogs/chardet v0.0.0-20150115103509-2404f7772561/go.mod h1:Pcatq5tYkCW2Q6yrR2VRHlbHpZ/R4/7qyL1TCF7vl14=",
      "130: github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14 h1:yXtpJr/LV6PFu4nTLgfjQdcMdzjbqqXMEnHfq0Or6p8=",
      "131: github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14/go.mod h1:jPoNZLWDAqA5N3G5amEoiNbhVrmM+ZQEcnQvNQ2KaZk=",
      "134: github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4 h1:C7NryI/RQhsIWwC2bHN601P1wJKeuQ6U/UCOYTn3Cic=",
      "135: github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4/go.mod h1:fR6z1Ie6rtF7kl/vBYMfgD5/G5B1blui7z426/sj2DU=",
      "136: github.com/gogs/go-libravatar v0.0.0-20191106065024-33a75213d0a0 h1:K02vod+sn3M1OOkdqi2tPxN2+xESK4qyITVQ3JkGEv4=",
      "",
      "[Removed Lines]",
      "132: github.com/gogs/git-module v1.8.3 h1:4N9HOLzkmSfb5y4Go4f/gdt1/Z60/aQaAKr8lbsfFps=",
      "133: github.com/gogs/git-module v1.8.3/go.mod h1:yAn6ZMwh8x0u3fMotXqMP7Ct1XNNOZWNdBSBx6IFGCY=",
      "",
      "[Added Lines]",
      "132: github.com/gogs/git-module v1.8.4 h1:oSt8sOL4NWOGrSo/CwbS+C4YXtk76QvxyPofem/ViTU=",
      "133: github.com/gogs/git-module v1.8.4/go.mod h1:bQY0aoMK5Q5+NKgy4jXe3K1GFW+GnsSk0SJK0jh6yD0=",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "419: github.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=",
      "420: github.com/stretchr/testify v1.8.1/go.mod h1:w2LPCIKwWwSfY2zedu0+kehJoqGctiVI29o6fzry7u4=",
      "421: github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=",
      "423: github.com/stretchr/testify v1.9.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=",
      "424: github.com/syndtr/goleveldb v1.0.0/go.mod h1:ZVVdQEZoIme9iO1Ch2Jdy24qqXrMMOU6lpPAyBWyWuQ=",
      "425: github.com/unknwon/cae v1.0.2 h1:3L8/RCN1ARvD5quyNjU30EdvYkFbxBfnRcIBXugpHlg=",
      "426: github.com/unknwon/cae v1.0.2/go.mod h1:HqpmD2fVq9G1oGEXrXzbgIp51uJ29Hshv41n9ljm+AA=",
      "",
      "[Removed Lines]",
      "422: github.com/stretchr/testify v1.9.0 h1:HtqpIVDClZ4nwg75+f6Lvsy/wHu+3BoSGCbBAcpTsTg=",
      "",
      "[Added Lines]",
      "423: github.com/stretchr/testify v1.10.0 h1:Xv5erBjTwe/5IxqUQTdXv5kgmIvbHo3QQyRwhJsOfJA=",
      "424: github.com/stretchr/testify v1.10.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "511: golang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
      "512: golang.org/x/sync v0.0.0-20220722155255-886fb9371eb4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
      "513: golang.org/x/sync v0.1.0/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
      "515: golang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=",
      "516: golang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
      "517: golang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
      "",
      "[Removed Lines]",
      "514: golang.org/x/sync v0.3.0/go.mod h1:FU7BRWz2tNW+3quACPkgCx/L+uEAv1htQ0V83Z9Rj+Y=",
      "",
      "[Added Lines]",
      "515: golang.org/x/sync v0.9.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
      "",
      "---------------"
    ],
    "internal/database/release.go||internal/database/release.go": [
      "File: internal/database/release.go -> internal/database/release.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "125:     return fmt.Errorf(\"get branch commit: %v\", err)",
      "126:    }",
      "130:    if err = gitRepo.CreateTag(r.TagName, commit.ID.String()); err != nil {",
      "131:     if strings.Contains(err.Error(), \"is not a valid tag name\") {",
      "132:      return ErrInvalidTagName{r.TagName}",
      "",
      "[Removed Lines]",
      "129:    r.TagName = strings.TrimPrefix(r.TagName, \"--\")",
      "",
      "[Added Lines]",
      "129:    r.TagName = strings.TrimLeft(r.TagName, \"-\")",
      "",
      "---------------"
    ],
    "internal/database/repo_editor.go||internal/database/repo_editor.go": [
      "File: internal/database/repo_editor.go -> internal/database/repo_editor.go"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c036214c453872289391db7d2eb100f695d5799c",
      "candidate_info": {
        "commit_hash": "c036214c453872289391db7d2eb100f695d5799c",
        "repo": "gogs/gogs",
        "commit_url": "https://github.com/gogs/gogs/commit/c036214c453872289391db7d2eb100f695d5799c",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "mod: bump github.com/stretchr/testify from 1.8.4 to 1.9.0 (#7714)\n\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "37:  github.com/satori/go.uuid v1.2.0",
          "38:  github.com/sergi/go-diff v1.3.1",
          "39:  github.com/sourcegraph/run v0.12.0",
          "41:  github.com/unknwon/cae v1.0.2",
          "42:  github.com/unknwon/com v1.0.1",
          "43:  github.com/unknwon/i18n v0.0.0-20190805065654-5c6446a380b6",
          "",
          "[Removed Lines]",
          "40:  github.com/stretchr/testify v1.8.4",
          "",
          "[Added Lines]",
          "40:  github.com/stretchr/testify v1.9.0",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "338: github.com/stretchr/testify v1.7.0/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=",
          "339: github.com/stretchr/testify v1.7.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=",
          "340: github.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=",
          "342: github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=",
          "343: github.com/syndtr/goleveldb v1.0.0/go.mod h1:ZVVdQEZoIme9iO1Ch2Jdy24qqXrMMOU6lpPAyBWyWuQ=",
          "344: github.com/unknwon/cae v1.0.2 h1:3L8/RCN1ARvD5quyNjU30EdvYkFbxBfnRcIBXugpHlg=",
          "345: github.com/unknwon/cae v1.0.2/go.mod h1:HqpmD2fVq9G1oGEXrXzbgIp51uJ29Hshv41n9ljm+AA=",
          "",
          "[Removed Lines]",
          "341: github.com/stretchr/testify v1.8.4 h1:CcVxjf3Q8PM0mHUKJCdn+eZZtm5yQwehR5yeSVQQcUk=",
          "",
          "[Added Lines]",
          "342: github.com/stretchr/testify v1.9.0 h1:HtqpIVDClZ4nwg75+f6Lvsy/wHu+3BoSGCbBAcpTsTg=",
          "343: github.com/stretchr/testify v1.9.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2b0f129a9121d8fe17dcd1deccfae03f50d82a79",
      "candidate_info": {
        "commit_hash": "2b0f129a9121d8fe17dcd1deccfae03f50d82a79",
        "repo": "gogs/gogs",
        "commit_url": "https://github.com/gogs/gogs/commit/2b0f129a9121d8fe17dcd1deccfae03f50d82a79",
        "files": [
          "CODEOWNERS",
          "go.mod",
          "go.sum",
          "internal/db/release.go",
          "internal/db/repo_editor.go"
        ],
        "message": "dep: update github.com/gogs/git-module to v1.8.4 (#7872)\n\nFixes\nhttps://github.com/gogs/gogs/security/advisories/GHSA-m27m-h5gj-wwmg by\nincluding https://github.com/gogs/git-module/pull/110",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum",
          "internal/db/release.go||internal/drelease.go",
          "internal/db/repo_editor.go||internal/drepo_editor.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:  github.com/go-macaron/toolbox v0.0.0-20190813233741-94defb8383c6",
          "18:  github.com/gogs/chardet v0.0.0-20150115103509-2404f7772561",
          "19:  github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14",
          "21:  github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4",
          "22:  github.com/gogs/go-libravatar v0.0.0-20191106065024-33a75213d0a0",
          "23:  github.com/gogs/minwinsvc v0.0.0-20170301035411-95be6356811a",
          "",
          "[Removed Lines]",
          "20:  github.com/gogs/git-module v1.8.1",
          "",
          "[Added Lines]",
          "20:  github.com/gogs/git-module v1.8.4",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "37:  github.com/satori/go.uuid v1.2.0",
          "38:  github.com/sergi/go-diff v1.3.1",
          "39:  github.com/sourcegraph/run v0.12.0",
          "41:  github.com/unknwon/cae v1.0.2",
          "42:  github.com/unknwon/com v1.0.1",
          "43:  github.com/unknwon/i18n v0.0.0-20190805065654-5c6446a380b6",
          "",
          "[Removed Lines]",
          "40:  github.com/stretchr/testify v1.9.0",
          "",
          "[Added Lines]",
          "40:  github.com/stretchr/testify v1.10.0",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "166: github.com/gogs/chardet v0.0.0-20150115103509-2404f7772561/go.mod h1:Pcatq5tYkCW2Q6yrR2VRHlbHpZ/R4/7qyL1TCF7vl14=",
          "167: github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14 h1:yXtpJr/LV6PFu4nTLgfjQdcMdzjbqqXMEnHfq0Or6p8=",
          "168: github.com/gogs/cron v0.0.0-20171120032916-9f6c956d3e14/go.mod h1:jPoNZLWDAqA5N3G5amEoiNbhVrmM+ZQEcnQvNQ2KaZk=",
          "171: github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4 h1:C7NryI/RQhsIWwC2bHN601P1wJKeuQ6U/UCOYTn3Cic=",
          "172: github.com/gogs/go-gogs-client v0.0.0-20200128182646-c69cb7680fd4/go.mod h1:fR6z1Ie6rtF7kl/vBYMfgD5/G5B1blui7z426/sj2DU=",
          "173: github.com/gogs/go-libravatar v0.0.0-20191106065024-33a75213d0a0 h1:K02vod+sn3M1OOkdqi2tPxN2+xESK4qyITVQ3JkGEv4=",
          "",
          "[Removed Lines]",
          "169: github.com/gogs/git-module v1.8.1 h1:yC5BZ3unJOXC8N6/FgGQ8EtJXpOd217lgDcd2aPOxkc=",
          "170: github.com/gogs/git-module v1.8.1/go.mod h1:Y3rsSqtFZEbn7lp+3gWf42GKIY1eNTtLt7JrmOy0yAQ=",
          "",
          "[Added Lines]",
          "169: github.com/gogs/git-module v1.8.4 h1:oSt8sOL4NWOGrSo/CwbS+C4YXtk76QvxyPofem/ViTU=",
          "170: github.com/gogs/git-module v1.8.4/go.mod h1:bQY0aoMK5Q5+NKgy4jXe3K1GFW+GnsSk0SJK0jh6yD0=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "473: github.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=",
          "474: github.com/stretchr/testify v1.8.1/go.mod h1:w2LPCIKwWwSfY2zedu0+kehJoqGctiVI29o6fzry7u4=",
          "475: github.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=",
          "477: github.com/stretchr/testify v1.9.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=",
          "478: github.com/syndtr/goleveldb v1.0.0/go.mod h1:ZVVdQEZoIme9iO1Ch2Jdy24qqXrMMOU6lpPAyBWyWuQ=",
          "479: github.com/unknwon/cae v1.0.2 h1:3L8/RCN1ARvD5quyNjU30EdvYkFbxBfnRcIBXugpHlg=",
          "480: github.com/unknwon/cae v1.0.2/go.mod h1:HqpmD2fVq9G1oGEXrXzbgIp51uJ29Hshv41n9ljm+AA=",
          "",
          "[Removed Lines]",
          "476: github.com/stretchr/testify v1.9.0 h1:HtqpIVDClZ4nwg75+f6Lvsy/wHu+3BoSGCbBAcpTsTg=",
          "",
          "[Added Lines]",
          "477: github.com/stretchr/testify v1.10.0 h1:Xv5erBjTwe/5IxqUQTdXv5kgmIvbHo3QQyRwhJsOfJA=",
          "478: github.com/stretchr/testify v1.10.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "615: golang.org/x/sync v0.0.0-20201207232520-09787c993a3a/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "616: golang.org/x/sync v0.0.0-20220722155255-886fb9371eb4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "617: golang.org/x/sync v0.1.0/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "618: golang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=",
          "619: golang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "620: golang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "619: golang.org/x/sync v0.9.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "",
          "---------------"
        ],
        "internal/db/release.go||internal/drelease.go": [
          "File: internal/db/release.go -> internal/drelease.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "125:     return fmt.Errorf(\"get branch commit: %v\", err)",
          "126:    }",
          "130:    if err = gitRepo.CreateTag(r.TagName, commit.ID.String()); err != nil {",
          "131:     if strings.Contains(err.Error(), \"is not a valid tag name\") {",
          "132:      return ErrInvalidTagName{r.TagName}",
          "",
          "[Removed Lines]",
          "129:    r.TagName = strings.TrimPrefix(r.TagName, \"--\")",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "internal/db/repo_editor.go||internal/drepo_editor.go": [
          "File: internal/db/repo_editor.go -> internal/drepo_editor.go"
        ]
      }
    }
  ]
}