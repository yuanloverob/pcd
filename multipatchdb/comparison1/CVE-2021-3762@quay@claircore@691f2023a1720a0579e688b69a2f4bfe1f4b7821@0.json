{
  "cve_id": "CVE-2021-3762",
  "cve_desc": "A directory traversal vulnerability was found in the ClairCore engine of Clair. An attacker can exploit this by supplying a crafted container image which, when scanned by Clair, allows for arbitrary file write on the filesystem, potentially allowing for remote code execution.",
  "repo": "quay/claircore",
  "patch_hash": "691f2023a1720a0579e688b69a2f4bfe1f4b7821",
  "patch_info": {
    "commit_hash": "691f2023a1720a0579e688b69a2f4bfe1f4b7821",
    "repo": "quay/claircore",
    "commit_url": "https://github.com/quay/claircore/commit/691f2023a1720a0579e688b69a2f4bfe1f4b7821",
    "files": [
      "rpm/packagescanner.go",
      "rpm/packagescanner_test.go"
    ],
    "message": "rpm: prevent directory traversal when extracting\n\nA malicious tar archive with a member consisting of multiple \"parent\"\nelements could cause a file outside of the target directory to be\noverwritten.\n\nFixes: CVE-2021-3762\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>",
    "before_after_code_files": [
      "rpm/packagescanner.go||rpm/packagescanner.go",
      "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
    ]
  },
  "patch_diff": {
    "rpm/packagescanner.go||rpm/packagescanner.go": [
      "File: rpm/packagescanner.go -> rpm/packagescanner.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "170:    continue",
      "171:   }",
      "176:   d := filepath.Dir(tgt)",
      "",
      "[Removed Lines]",
      "173:   tgt := filepath.Join(root, filepath.Clean(h.Name))",
      "",
      "[Added Lines]",
      "173:   tgt := relPath(root, h.Name)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "212:    stats.Reg++",
      "213:   case tar.TypeSymlink:",
      "216:    err = os.Symlink(ln, tgt)",
      "217:    stats.Symlink++",
      "218:   case tar.TypeLink:",
      "221:    _, exists := os.Lstat(ln)",
      "222:    switch {",
      "223:    case errors.Is(exists, nil):",
      "",
      "[Removed Lines]",
      "215:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
      "220:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
      "",
      "[Added Lines]",
      "215:    ln := relPath(root, h.Linkname)",
      "220:    ln := relPath(root, h.Linkname)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "470:  return false",
      "471: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "477: func relPath(root, member string) string {",
      "478:  return filepath.Join(root, filepath.Join(\"/\", member))",
      "479: }",
      "",
      "---------------"
    ],
    "rpm/packagescanner_test.go||rpm/packagescanner_test.go": [
      "File: rpm/packagescanner_test.go -> rpm/packagescanner_test.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "6:  \"os\"",
      "7:  \"os/exec\"",
      "8:  \"path/filepath\"",
      "9:  \"testing\"",
      "10:  \"time\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "9:  \"strings\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1636:   t.Error(cmp.Diff(got, want))",
      "1637:  }",
      "1638: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1641: func TestRelPath(t *testing.T) {",
      "1642:  root := `/tmp/fakedata`",
      "1643:  tt := [][2]string{",
      "1644:   {",
      "1645:    \"dev/null\",",
      "1646:    \"/dev/null\",",
      "1647:   },",
      "1648:   {",
      "1649:    \"dev/null\",",
      "1650:    \"./dev/null\",",
      "1651:   },",
      "1652:   {",
      "1653:    \"dev/null\",",
      "1654:    \"dev/null\",",
      "1655:   },",
      "1656:   {",
      "1657:    \"dev/null\",",
      "1658:    strings.Repeat(\"../\", 10) + \"dev/null\",",
      "1659:   },",
      "1660:   {",
      "1661:    \"dev/null\",",
      "1662:    strings.Repeat(\"../\", 10) + \"dev/./../dev/null\",",
      "1663:   },",
      "1664:  }",
      "1666:  for _, tc := range tt {",
      "1667:   want := filepath.Join(root, tc[0])",
      "1668:   t.Logf(\"in: %q + %q\", root, tc[1])",
      "1669:   got := relPath(root, tc[1])",
      "1670:   t.Logf(\"got: %q, want: %q\", got, want)",
      "1671:   if got != want {",
      "1672:    t.Error()",
      "1673:   }",
      "1674:  }",
      "1675: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ed5f52aec1c82746725e9cc23e98316eab8be25a",
      "candidate_info": {
        "commit_hash": "ed5f52aec1c82746725e9cc23e98316eab8be25a",
        "repo": "quay/claircore",
        "commit_url": "https://github.com/quay/claircore/commit/ed5f52aec1c82746725e9cc23e98316eab8be25a",
        "files": [
          "rpm/packagescanner.go",
          "rpm/packagescanner_test.go"
        ],
        "message": "rpm: prevent directory traversal when extracting\n\nA malicious tar archive with a member consisting of multiple \"parent\"\nelements could cause a file outside of the target directory to be\noverwritten.\n\nFixes: CVE-2021-3762\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>\nBackports: #478\n(cherry picked from commit 691f2023a1720a0579e688b69a2f4bfe1f4b7821)",
        "before_after_code_files": [
          "rpm/packagescanner.go||rpm/packagescanner.go",
          "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ],
          "candidate": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ]
        }
      },
      "candidate_diff": {
        "rpm/packagescanner.go||rpm/packagescanner.go": [
          "File: rpm/packagescanner.go -> rpm/packagescanner.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "169:    continue",
          "170:   }",
          "175:   d := filepath.Dir(tgt)",
          "",
          "[Removed Lines]",
          "172:   tgt := filepath.Join(root, filepath.Clean(h.Name))",
          "",
          "[Added Lines]",
          "172:   tgt := relPath(root, h.Name)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "211:    stats.Reg++",
          "212:   case tar.TypeSymlink:",
          "215:    err = os.Symlink(ln, tgt)",
          "216:    stats.Symlink++",
          "217:   case tar.TypeLink:",
          "220:    _, exists := os.Lstat(ln)",
          "221:    switch {",
          "222:    case errors.Is(exists, nil):",
          "",
          "[Removed Lines]",
          "214:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
          "219:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
          "",
          "[Added Lines]",
          "214:    ln := relPath(root, h.Linkname)",
          "219:    ln := relPath(root, h.Linkname)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "422:   }",
          "423:  }",
          "424: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "430: func relPath(root, member string) string {",
          "431:  return filepath.Join(root, filepath.Join(\"/\", member))",
          "432: }",
          "",
          "---------------"
        ],
        "rpm/packagescanner_test.go||rpm/packagescanner_test.go": [
          "File: rpm/packagescanner_test.go -> rpm/packagescanner_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:  \"os\"",
          "7:  \"os/exec\"",
          "8:  \"path/filepath\"",
          "9:  \"testing\"",
          "10:  \"time\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9:  \"strings\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1636:   t.Error(cmp.Diff(got, want))",
          "1637:  }",
          "1638: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1641: func TestRelPath(t *testing.T) {",
          "1642:  root := `/tmp/fakedata`",
          "1643:  tt := [][2]string{",
          "1644:   {",
          "1645:    \"dev/null\",",
          "1646:    \"/dev/null\",",
          "1647:   },",
          "1648:   {",
          "1649:    \"dev/null\",",
          "1650:    \"./dev/null\",",
          "1651:   },",
          "1652:   {",
          "1653:    \"dev/null\",",
          "1654:    \"dev/null\",",
          "1655:   },",
          "1656:   {",
          "1657:    \"dev/null\",",
          "1658:    strings.Repeat(\"../\", 10) + \"dev/null\",",
          "1659:   },",
          "1660:   {",
          "1661:    \"dev/null\",",
          "1662:    strings.Repeat(\"../\", 10) + \"dev/./../dev/null\",",
          "1663:   },",
          "1664:  }",
          "1666:  for _, tc := range tt {",
          "1667:   want := filepath.Join(root, tc[0])",
          "1668:   t.Logf(\"in: %q + %q\", root, tc[1])",
          "1669:   got := relPath(root, tc[1])",
          "1670:   t.Logf(\"got: %q, want: %q\", got, want)",
          "1671:   if got != want {",
          "1672:    t.Error()",
          "1673:   }",
          "1674:  }",
          "1675: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dff671c665141f126c072de8a744855d4916c9c7",
      "candidate_info": {
        "commit_hash": "dff671c665141f126c072de8a744855d4916c9c7",
        "repo": "quay/claircore",
        "commit_url": "https://github.com/quay/claircore/commit/dff671c665141f126c072de8a744855d4916c9c7",
        "files": [
          "rpm/packagescanner.go",
          "rpm/packagescanner_test.go"
        ],
        "message": "rpm: prevent directory traversal when extracting\n\nA malicious tar archive with a member consisting of multiple \"parent\"\nelements could cause a file outside of the target directory to be\noverwritten.\n\nFixes: CVE-2021-3762\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>\nBackports: #478\n(cherry picked from commit 691f2023a1720a0579e688b69a2f4bfe1f4b7821)",
        "before_after_code_files": [
          "rpm/packagescanner.go||rpm/packagescanner.go",
          "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ],
          "candidate": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ]
        }
      },
      "candidate_diff": {
        "rpm/packagescanner.go||rpm/packagescanner.go": [
          "File: rpm/packagescanner.go -> rpm/packagescanner.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "169:    continue",
          "170:   }",
          "175:   d := filepath.Dir(tgt)",
          "",
          "[Removed Lines]",
          "172:   tgt := filepath.Join(root, filepath.Clean(h.Name))",
          "",
          "[Added Lines]",
          "172:   tgt := relPath(root, h.Name)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "211:    stats.Reg++",
          "212:   case tar.TypeSymlink:",
          "215:    err = os.Symlink(ln, tgt)",
          "216:    stats.Symlink++",
          "217:   case tar.TypeLink:",
          "220:    _, exists := os.Lstat(ln)",
          "221:    switch {",
          "222:    case errors.Is(exists, nil):",
          "",
          "[Removed Lines]",
          "214:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
          "219:    ln := filepath.Join(root, filepath.Clean(h.Linkname))",
          "",
          "[Added Lines]",
          "214:    ln := relPath(root, h.Linkname)",
          "219:    ln := relPath(root, h.Linkname)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "422:   }",
          "423:  }",
          "424: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "430: func relPath(root, member string) string {",
          "431:  return filepath.Join(root, filepath.Join(\"/\", member))",
          "432: }",
          "",
          "---------------"
        ],
        "rpm/packagescanner_test.go||rpm/packagescanner_test.go": [
          "File: rpm/packagescanner_test.go -> rpm/packagescanner_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:  \"os\"",
          "7:  \"os/exec\"",
          "8:  \"path/filepath\"",
          "9:  \"testing\"",
          "10:  \"time\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9:  \"strings\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1636:   t.Error(cmp.Diff(got, want))",
          "1637:  }",
          "1638: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1641: func TestRelPath(t *testing.T) {",
          "1642:  root := `/tmp/fakedata`",
          "1643:  tt := [][2]string{",
          "1644:   {",
          "1645:    \"dev/null\",",
          "1646:    \"/dev/null\",",
          "1647:   },",
          "1648:   {",
          "1649:    \"dev/null\",",
          "1650:    \"./dev/null\",",
          "1651:   },",
          "1652:   {",
          "1653:    \"dev/null\",",
          "1654:    \"dev/null\",",
          "1655:   },",
          "1656:   {",
          "1657:    \"dev/null\",",
          "1658:    strings.Repeat(\"../\", 10) + \"dev/null\",",
          "1659:   },",
          "1660:   {",
          "1661:    \"dev/null\",",
          "1662:    strings.Repeat(\"../\", 10) + \"dev/./../dev/null\",",
          "1663:   },",
          "1664:  }",
          "1666:  for _, tc := range tt {",
          "1667:   want := filepath.Join(root, tc[0])",
          "1668:   t.Logf(\"in: %q + %q\", root, tc[1])",
          "1669:   got := relPath(root, tc[1])",
          "1670:   t.Logf(\"got: %q, want: %q\", got, want)",
          "1671:   if got != want {",
          "1672:    t.Error()",
          "1673:   }",
          "1674:  }",
          "1675: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "636b24343eadde834c83553ca1aa245ded5b9242",
      "candidate_info": {
        "commit_hash": "636b24343eadde834c83553ca1aa245ded5b9242",
        "repo": "quay/claircore",
        "commit_url": "https://github.com/quay/claircore/commit/636b24343eadde834c83553ca1aa245ded5b9242",
        "files": [
          "rpm/packagescanner.go",
          "rpm/packagescanner_test.go"
        ],
        "message": "rpm: special-case symlinks\n\nThe behavior of chmod(2) is more subtle than it really should be.\n\nDuring our permissions fixup pass, if the target of a symlink was in a\ndirectory not fixed yet (or in system's root) calling chmod on it will\nattempt to change the mode bits on a file the process won't have\npermissions for. The amount of corner cases in \"remove this directory\nand its contents\" is annoying.\n\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>",
        "before_after_code_files": [
          "rpm/packagescanner.go||rpm/packagescanner.go",
          "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ],
          "candidate": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ]
        }
      },
      "candidate_diff": {
        "rpm/packagescanner.go||rpm/packagescanner.go": [
          "File: rpm/packagescanner.go -> rpm/packagescanner.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "164:    Stringer(\"stderr\", &errbuf).",
          "165:    AnErr(\"err\", err).",
          "166:    Msg(\"error extracting layer\")",
          "167:   return nil, fmt.Errorf(\"rpm: failed to untar: %w\", err)",
          "168:  }",
          "169:  zlog.Debug(ctx).Str(\"dir\", root).Msg(\"extracted layer\")",
          "172:   if rmerr := os.RemoveAll(root); rmerr != nil {",
          "173:    err = fmt.Errorf(\"%v (and during cleanup: %v)\", err, rmerr)",
          "174:   }",
          "",
          "[Removed Lines]",
          "171:  if err := filepath.Walk(root, fixDirs(ctx)); err != nil {",
          "",
          "[Added Lines]",
          "167:   if rmerr := os.RemoveAll(root); rmerr != nil {",
          "168:    err = fmt.Errorf(\"%v (and during cleanup: %v)\", err, rmerr)",
          "169:   }",
          "174:  if err := filepath.Walk(root, fixPerms(ctx, root)); err != nil {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:  return pkgs, nil",
          "230: }",
          "238:  return func(path string, info os.FileInfo, err error) error {",
          "",
          "[Removed Lines]",
          "235: func fixDirs(ctx context.Context) filepath.WalkFunc {",
          "",
          "[Added Lines]",
          "239: func fixPerms(ctx context.Context, root string) filepath.WalkFunc {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:     Msg(\"error walking extracted layer\")",
          "245:    return nil",
          "246:   }",
          "248:    return nil",
          "249:   }",
          "251:  }",
          "252: }",
          "",
          "[Removed Lines]",
          "247:   if !info.IsDir() {",
          "250:   return os.Chmod(path, info.Mode()|0700)",
          "",
          "[Added Lines]",
          "251:   var mod os.FileMode = 0o0600",
          "252:   switch info.Mode() & os.ModeType {",
          "253:   case os.ModeDir:",
          "255:    mod |= 0o0100",
          "256:   case os.ModeSymlink:",
          "260:   default:",
          "262:   return os.Chmod(path, mod)",
          "",
          "---------------"
        ],
        "rpm/packagescanner_test.go||rpm/packagescanner_test.go": [
          "File: rpm/packagescanner_test.go -> rpm/packagescanner_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import (",
          "4:  \"context\"",
          "5:  \"net/http\"",
          "6:  \"os/exec\"",
          "7:  \"testing\"",
          "8:  \"time\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6:  \"os\"",
          "8:  \"path/filepath\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "15: )",
          "17: func TestScan(t *testing.T) {",
          "18:  hash, err := claircore.ParseDigest(\"sha256:729ec3a6ada3a6d26faca9b4779a037231f1762f759ef34c08bdd61bf52cd704\")",
          "19:  if err != nil {",
          "20:   t.Fatal(err)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20:  pat := filepath.Join(os.TempDir(), \"rpmscanner.*\")",
          "21:  prevs, err := filepath.Glob(pat)",
          "22:  if err != nil {",
          "23:   t.Error(err)",
          "24:  }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1619:  if !cmp.Equal(got, want) {",
          "1620:   t.Fatal(cmp.Diff(got, want))",
          "1621:  }",
          "1622: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1631:  ms, err := filepath.Glob(pat)",
          "1632:  if err != nil {",
          "1633:   t.Error(err)",
          "1634:  }",
          "1635:  if got, want := ms, prevs; !cmp.Equal(got, want) {",
          "1636:   t.Error(cmp.Diff(got, want))",
          "1637:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3c2fafca5b051ec99cbd2a608271667b82d87d98",
      "candidate_info": {
        "commit_hash": "3c2fafca5b051ec99cbd2a608271667b82d87d98",
        "repo": "quay/claircore",
        "commit_url": "https://github.com/quay/claircore/commit/3c2fafca5b051ec99cbd2a608271667b82d87d98",
        "files": [
          "rpm/packagescanner.go"
        ],
        "message": "rpm: remove tar(1) call\n\nThis commit removes the external call to tar and replaces it with\ncreating files directly.\n\nThe original motivation for the tar call was that recreating the correct\npermissions for everything is tricky. I now realize we most certainly do\n*not* want to recreate the permissions of the filesystem, because\nthey're frequently bonkers and require extra work to clean up properly.\n\nThe simplified extraction routine implemented here makes sure that all\nfiles remain readable and writable by the user creating them, so that\nthe Clair process can actually remove them. Any additional PRs to this\nlogic to support things like BSD suid/guid directory logic will send me\ninto my cups.\n\nCloses: #436\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>",
        "before_after_code_files": [
          "rpm/packagescanner.go||rpm/packagescanner.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "rpm/packagescanner.go||rpm/packagescanner.go"
          ],
          "candidate": [
            "rpm/packagescanner.go||rpm/packagescanner.go"
          ]
        }
      },
      "candidate_diff": {
        "rpm/packagescanner.go||rpm/packagescanner.go": [
          "File: rpm/packagescanner.go -> rpm/packagescanner.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "137:  if _, err := rd.Seek(0, io.SeekStart); err != nil {",
          "138:   return nil, fmt.Errorf(\"rpm: unable to seek: %w\", err)",
          "139:  }",
          "155:  )",
          "169:   }",
          "171:  }",
          "177:   }",
          "179:  }",
          "181:  var pkgs []*claircore.Package",
          "",
          "[Removed Lines]",
          "145:  errbuf := bytes.Buffer{}",
          "148:  tarcmd := exec.CommandContext(ctx, \"tar\",",
          "149:   \"--extract\",",
          "150:   \"--exclude\", \"dev\",",
          "151:   \"--exclude\", \".wh*\",",
          "152:   \"--delay-directory-restore\",",
          "153:   \"--no-same-owner\",",
          "154:   \"--no-same-permissions\",",
          "156:  tarcmd.Stdin = rd",
          "157:  tarcmd.Stderr = &errbuf",
          "158:  tarcmd.Dir = root",
          "159:  zlog.Debug(ctx).Str(\"dir\", root).Strs(\"cmd\", tarcmd.Args).Msg(\"tar invocation\")",
          "160:  if err := tarcmd.Run(); err != nil {",
          "161:   zlog.Error(ctx).",
          "162:    Str(\"dir\", root).",
          "163:    Strs(\"cmd\", tarcmd.Args).",
          "164:    Stringer(\"stderr\", &errbuf).",
          "165:    AnErr(\"err\", err).",
          "166:    Msg(\"error extracting layer\")",
          "167:   if rmerr := os.RemoveAll(root); rmerr != nil {",
          "168:    err = fmt.Errorf(\"%v (and during cleanup: %v)\", err, rmerr)",
          "170:   return nil, fmt.Errorf(\"rpm: failed to untar: %w\", err)",
          "172:  zlog.Debug(ctx).Str(\"dir\", root).Msg(\"extracted layer\")",
          "174:  if err := filepath.Walk(root, fixPerms(ctx, root)); err != nil {",
          "175:   if rmerr := os.RemoveAll(root); rmerr != nil {",
          "176:    err = fmt.Errorf(\"%v (and during cleanup: %v)\", err, rmerr)",
          "178:   return nil, fmt.Errorf(\"rpm: failed to change permissions: %w\", err)",
          "",
          "[Added Lines]",
          "141:  tr = tar.NewReader(rd)",
          "142:  const (",
          "145:   dirMode  = 0o0700",
          "146:   fileMode = 0o0600",
          "149:  var stats struct {",
          "150:   Reg, Link, Symlink, Dir, Whiteout int",
          "151:   OutOfOrder                        int",
          "152:  }",
          "154:  made := map[string]struct{}{root: {}}",
          "156:  var deferLn [][2]string",
          "157:  for h, err = tr.Next(); err == nil; h, err = tr.Next() {",
          "158:   if strings.HasPrefix(filepath.Base(h.Name), \".wh.\") {",
          "160:    stats.Whiteout++",
          "161:    continue",
          "162:   }",
          "164:   tgt := filepath.Join(root, filepath.Clean(h.Name))",
          "167:   d := filepath.Dir(tgt)",
          "168:   if _, ok := made[d]; !ok {",
          "169:    if err := os.MkdirAll(d, dirMode); err != nil {",
          "170:     return nil, err",
          "171:    }",
          "172:    made[d] = struct{}{}",
          "173:    stats.OutOfOrder++",
          "174:   }",
          "177:   var err error",
          "178:   switch h.Typeflag {",
          "179:   case tar.TypeDir:",
          "180:    m := h.FileInfo().Mode() | dirMode",
          "181:    if _, ok := made[tgt]; ok {",
          "184:     err = os.Chmod(tgt, m)",
          "185:     break",
          "186:    }",
          "187:    err = os.Mkdir(tgt, m)",
          "190:    made[d] = struct{}{}",
          "191:    stats.Dir++",
          "192:   case tar.TypeReg:",
          "193:    m := h.FileInfo().Mode() | fileMode",
          "194:    var f *os.File",
          "195:    f, err = os.OpenFile(tgt, os.O_CREATE|os.O_WRONLY, m)",
          "196:    if err != nil {",
          "197:     break // Handle after the switch.",
          "198:    }",
          "199:    _, err = io.Copy(f, tr)",
          "200:    if err := f.Close(); err != nil {",
          "201:     zlog.Warn(ctx).Err(err).Msg(\"error closing new file\")",
          "202:    }",
          "203:    stats.Reg++",
          "204:   case tar.TypeSymlink:",
          "205:    err = os.Symlink(h.Linkname, tgt)",
          "206:    stats.Symlink++",
          "207:   case tar.TypeLink:",
          "208:    _, exists := os.Lstat(h.Linkname)",
          "209:    switch {",
          "210:    case errors.Is(exists, nil):",
          "211:     err = os.Link(h.Linkname, tgt)",
          "212:    case errors.Is(exists, os.ErrNotExist):",
          "217:     deferLn = append(deferLn, [2]string{h.Linkname, tgt})",
          "218:    default:",
          "219:     err = exists",
          "220:    }",
          "221:    stats.Link++",
          "222:   default:",
          "225:   }",
          "226:   if err != nil {",
          "227:    return nil, err",
          "230:  for _, l := range deferLn {",
          "231:   if err := os.Link(l[0], l[1]); err != nil {",
          "232:    zlog.Error(ctx).",
          "233:     Err(err).",
          "234:     Msg(\"failed to finish links\")",
          "235:    return nil, err",
          "237:  }",
          "238:  if ct := len(deferLn); ct != 0 {",
          "239:   zlog.Debug(ctx).",
          "240:    Int(\"count\", ct).",
          "241:    Msg(\"processed deferred links\")",
          "244:  zlog.Info(ctx).",
          "245:   Int(\"file\", stats.Reg).",
          "246:   Int(\"dir\", stats.Dir).",
          "247:   Int(\"dir(out of order)\", stats.OutOfOrder).",
          "248:   Int(\"symlink\", stats.Symlink).",
          "249:   Int(\"link\", stats.Link).",
          "250:   Int(\"whiteout\", stats.Whiteout).",
          "251:   Msg(\"extracted layer\")",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "232:  return pkgs, nil",
          "233: }",
          "",
          "[Removed Lines]",
          "239: func fixPerms(ctx context.Context, root string) filepath.WalkFunc {",
          "242:  return func(path string, info os.FileInfo, err error) error {",
          "243:   if err != nil {",
          "244:    zlog.Warn(ctx).",
          "245:     Err(err).",
          "246:     Str(\"path\", path).",
          "247:     Interface(\"info\", info).",
          "248:     Msg(\"error walking extracted layer\")",
          "249:    return nil",
          "250:   }",
          "251:   var mod os.FileMode = 0o0600",
          "252:   switch info.Mode() & os.ModeType {",
          "253:   case os.ModeDir:",
          "255:    mod |= 0o0100",
          "256:   case os.ModeSymlink:",
          "259:    return nil",
          "260:   default:",
          "261:   }",
          "262:   return os.Chmod(path, mod)",
          "263:  }",
          "264: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "87ab3e3f8acff40f63f6a1bde84fca2fbb576de4",
      "candidate_info": {
        "commit_hash": "87ab3e3f8acff40f63f6a1bde84fca2fbb576de4",
        "repo": "quay/claircore",
        "commit_url": "https://github.com/quay/claircore/commit/87ab3e3f8acff40f63f6a1bde84fca2fbb576de4",
        "files": [
          "go.mod",
          "rpm/bdb.go",
          "rpm/dbkind_string.go",
          "rpm/extract.go",
          "rpm/packagescanner.go",
          "rpm/packagescanner_test.go",
          "rpm/sqlite.go",
          "rpm/testdata/sqlite.rpm-manifest.json"
        ],
        "message": "rpm: add sqlite db support\n\nSigned-off-by: Hank Donnay <hdonnay@redhat.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "rpm/bdb.go||rpm/bdb.go",
          "rpm/dbkind_string.go||rpm/dbkind_string.go",
          "rpm/extract.go||rpm/extract.go",
          "rpm/packagescanner.go||rpm/packagescanner.go",
          "rpm/packagescanner_test.go||rpm/packagescanner_test.go",
          "rpm/sqlite.go||rpm/sqlite.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ],
          "candidate": [
            "rpm/packagescanner.go||rpm/packagescanner.go",
            "rpm/packagescanner_test.go||rpm/packagescanner_test.go"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:  github.com/remind101/migrate v0.0.0-20170729031349-52c1edff7319",
          "28:  github.com/rs/zerolog v1.26.0",
          "29:  github.com/ulikunitz/xz v0.5.8",
          "30:  golang.org/x/sync v0.0.0-20210220032951-036812b2e83c",
          "31:  golang.org/x/text v0.3.7",
          "32:  golang.org/x/time v0.0.0-20210220033141-f8bda1e9f3ba",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "30:  golang.org/x/crypto v0.0.0-20210711020723-a769d52b0f97",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "58:  github.com/quay/claircore/toolkit v1.0.0 // indirect",
          "59:  github.com/remyoudompheng/bigfft v0.0.0-20200410134404-eec4a21b6bb0 // indirect",
          "60:  go.opentelemetry.io/otel v1.3.0 // indirect",
          "62:  golang.org/x/mod v0.5.1 // indirect",
          "63:  golang.org/x/sys v0.0.0-20220209214540-3681064d5158 // indirect",
          "64:  golang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1 // indirect",
          "",
          "[Removed Lines]",
          "61:  golang.org/x/crypto v0.0.0-20210711020723-a769d52b0f97 // indirect",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "rpm/bdb.go||rpm/bdb.go": [
          "File: rpm/bdb.go -> rpm/bdb.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package rpm",
          "3: import (",
          "4:  \"bytes\"",
          "5:  \"context\"",
          "6:  \"encoding/binary\"",
          "7:  \"errors\"",
          "8:  \"fmt\"",
          "9:  \"io\"",
          "10:  \"runtime/trace\"",
          "11:  \"strings\"",
          "13:  \"github.com/quay/zlog\"",
          "15:  \"github.com/quay/claircore\"",
          "16: )",
          "21: const queryFmt = `%{name}\\n` +",
          "22:  `%{evr}\\n` +",
          "23:  `%{payloaddigestalgo}:%{payloaddigest}\\n` +",
          "24:  `%{sigpgp:pgpsig}\\n` +",
          "25:  `%{sourcerpm}\\n` +",
          "26:  `%{RPMTAG_MODULARITYLABEL}\\n` +",
          "27:  `%{ARCH}\\n` +",
          "28:  `.\\n`",
          "29: const delim = \"\\n.\\n\"",
          "31: func querySplit(data []byte, atEOF bool) (advance int, token []byte, err error) {",
          "32:  i := bytes.Index(data, []byte(delim))",
          "33:  switch {",
          "34:  case len(data) == 0 && atEOF:",
          "35:   return 0, nil, io.EOF",
          "36:  case i == -1 && atEOF:",
          "37:   return 0, nil, errors.New(\"invalid format\")",
          "38:  case i == -1 && !atEOF:",
          "39:   return 0, nil, nil",
          "40:  default:",
          "41:  }",
          "42:  tok := data[:i]",
          "43:  return len(tok) + len(delim), tok, nil",
          "44: }",
          "46: func parsePackage(ctx context.Context, src map[string]*claircore.Package, buf *bytes.Buffer) (*claircore.Package, error) {",
          "47:  defer trace.StartRegion(ctx, \"parsePackage\").End()",
          "48:  p := claircore.Package{",
          "49:   Kind: claircore.BINARY,",
          "50:  }",
          "51:  var err error",
          "52:  var line string",
          "54:  for i := 0; ; i++ {",
          "56:   line, err = buf.ReadString('\\n')",
          "57:   line = strings.TrimSpace(line)",
          "58:   if strings.HasPrefix(line, \"(none)\") {",
          "59:    continue",
          "60:   }",
          "61:   if line == \"\" && err == nil {",
          "62:    zlog.Info(ctx).",
          "63:     Str(\"package\", p.Name).",
          "64:     Int(\"lineno\", i).",
          "65:     Msg(\"unexpected empty line\")",
          "66:    continue",
          "67:   }",
          "68:   switch i {",
          "69:   case 0:",
          "70:    p.Name = line",
          "71:   case 1:",
          "72:    p.Version = line",
          "73:   case 2:",
          "74:    p.RepositoryHint = \"hash:\"",
          "75:    switch line[0] {",
          "76:    case '8': // sha256",
          "77:     p.RepositoryHint += \"sha256\" + line[1:]",
          "78:    }",
          "79:   case 3:",
          "80:    const delim = `Key ID `",
          "81:    i := strings.Index(line, delim)",
          "82:    if i == -1 { // ???",
          "83:     break",
          "84:    }",
          "85:    p.RepositoryHint += \"|key:\" + line[i+len(delim):]",
          "86:   case 4:",
          "87:    line = strings.TrimSuffix(line, \".src.rpm\")",
          "88:    sp := strings.Split(line, \"-\")",
          "89:    name := strings.Join(sp[:len(sp)-2], \"-\")",
          "90:    if s, ok := src[name]; ok {",
          "91:     p.Source = s",
          "92:     break",
          "93:    }",
          "94:    p.Source = &claircore.Package{",
          "95:     Name:    name,",
          "96:     Version: sp[len(sp)-2] + \"-\" + sp[len(sp)-1],",
          "97:     Kind:    claircore.SOURCE,",
          "98:    }",
          "99:    src[name] = p.Source",
          "100:   case 5:",
          "101:    moduleSplit := strings.Split(line, \":\")",
          "102:    if len(moduleSplit) < 2 {",
          "103:     continue",
          "104:    }",
          "105:    moduleStream := fmt.Sprintf(\"%s:%s\", moduleSplit[0], moduleSplit[1])",
          "106:    p.Module = moduleStream",
          "107:    if p.Source != nil {",
          "108:     p.Source.Module = moduleStream",
          "109:    }",
          "110:   case 6:",
          "111:    p.Arch = line",
          "112:   }",
          "113:   switch err {",
          "114:   case nil:",
          "115:   case io.EOF:",
          "116:    return &p, nil",
          "117:   default:",
          "118:    return nil, err",
          "119:   }",
          "120:  }",
          "121: }",
          "134: func checkMagic(ctx context.Context, r io.Reader) bool {",
          "135:  const (",
          "136:   Hash  = 0x00061561",
          "137:   BTree = 0x00053162",
          "138:   Queue = 0x00042253",
          "139:   Log   = 0x00040988",
          "140:  )",
          "142:  be := []binary.ByteOrder{binary.LittleEndian, binary.BigEndian}",
          "143:  b := make([]byte, 4)",
          "146:  for _, discard := range []int64{0, 8} {",
          "147:   if _, err := io.Copy(io.Discard, io.LimitReader(r, discard)); err != nil {",
          "148:    zlog.Warn(ctx).Err(err).Msg(\"unexpected error checking magic\")",
          "149:    return false",
          "150:   }",
          "151:   if _, err := io.ReadFull(r, b); err != nil {",
          "152:    zlog.Warn(ctx).Err(err).Msg(\"unexpected error checking magic\")",
          "153:    return false",
          "154:   }",
          "155:   for _, o := range be {",
          "156:    n := o.Uint32(b)",
          "157:    if n == Hash || n == BTree || n == Queue || n == Log {",
          "158:     return true",
          "159:    }",
          "160:   }",
          "161:  }",
          "163:  return false",
          "164: }",
          "",
          "---------------"
        ],
        "rpm/dbkind_string.go||rpm/dbkind_string.go": [
          "File: rpm/dbkind_string.go -> rpm/dbkind_string.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: package rpm",
          "5: import \"strconv\"",
          "7: func _() {",
          "10:  var x [1]struct{}",
          "11:  _ = x[kindBDB-1]",
          "12:  _ = x[kindSQLite-2]",
          "13: }",
          "15: const _dbKind_name = \"bdbsqlite\"",
          "17: var _dbKind_index = [...]uint8{0, 3, 9}",
          "19: func (i dbKind) String() string {",
          "20:  i -= 1",
          "21:  if i >= dbKind(len(_dbKind_index)-1) {",
          "22:   return \"dbKind(\" + strconv.FormatInt(int64(i+1), 10) + \")\"",
          "23:  }",
          "24:  return _dbKind_name[_dbKind_index[i]:_dbKind_index[i+1]]",
          "25: }",
          "",
          "---------------"
        ],
        "rpm/extract.go||rpm/extract.go": [
          "File: rpm/extract.go -> rpm/extract.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package rpm",
          "3: import (",
          "4:  \"archive/tar\"",
          "5:  \"context\"",
          "6:  \"errors\"",
          "7:  \"fmt\"",
          "8:  \"io\"",
          "9:  \"io/ioutil\"",
          "10:  \"os\"",
          "11:  \"path/filepath\"",
          "12:  \"strings\"",
          "14:  \"github.com/quay/zlog\"",
          "15: )",
          "17: func extractTar(ctx context.Context, rd io.ReadSeeker) (string, error) {",
          "18:  root, err := ioutil.TempDir(\"\", \"rpmscanner.\")",
          "19:  if err != nil {",
          "20:   return \"\", err",
          "21:  }",
          "22:  empty := filepath.Join(os.TempDir(), \"rpm.emptyfile\")",
          "23:  ef, err := os.Create(empty)",
          "24:  if err != nil {",
          "25:   return \"\", err",
          "26:  }",
          "27:  if err := ef.Close(); err != nil {",
          "28:   return \"\", err",
          "29:  }",
          "32:  if err := ctx.Err(); err != nil {",
          "33:   return \"\", err",
          "34:  }",
          "35:  if _, err := rd.Seek(0, io.SeekStart); err != nil {",
          "36:   return \"\", fmt.Errorf(\"rpm: unable to seek: %w\", err)",
          "37:  }",
          "38:  tr := tar.NewReader(rd)",
          "39:  const (",
          "42:   dirMode  = 0o0700",
          "43:   fileMode = 0o0600",
          "44:  )",
          "46:  var stats struct {",
          "47:   Reg, Link, Symlink, Dir, Whiteout int",
          "48:   OutOfOrder                        int",
          "49:  }",
          "51:  made := map[string]struct{}{root: {}}",
          "53:  var deferLn [][2]string",
          "54:  var h *tar.Header",
          "55:  for h, err = tr.Next(); err == nil; h, err = tr.Next() {",
          "56:   if strings.HasPrefix(filepath.Base(h.Name), \".wh.\") {",
          "58:    stats.Whiteout++",
          "59:    continue",
          "60:   }",
          "62:   tgt := relPath(root, h.Name)",
          "65:   d := filepath.Dir(tgt)",
          "66:   if _, ok := made[d]; !ok {",
          "67:    if err := os.MkdirAll(d, dirMode); err != nil {",
          "68:     return \"\", err",
          "69:    }",
          "70:    made[d] = struct{}{}",
          "71:    stats.OutOfOrder++",
          "72:   }",
          "75:   var err error",
          "76:   switch h.Typeflag {",
          "77:   case tar.TypeDir:",
          "78:    m := h.FileInfo().Mode() | dirMode",
          "79:    if _, ok := made[tgt]; ok {",
          "82:     err = os.Chmod(tgt, m)",
          "83:     break",
          "84:    }",
          "85:    err = os.Mkdir(tgt, m)",
          "88:    made[d] = struct{}{}",
          "89:    stats.Dir++",
          "90:   case tar.TypeReg:",
          "91:    m := h.FileInfo().Mode() | fileMode",
          "92:    var f *os.File",
          "93:    f, err = os.OpenFile(tgt, os.O_CREATE|os.O_WRONLY, m)",
          "94:    if err != nil {",
          "95:     break // Handle after the switch.",
          "96:    }",
          "97:    _, err = io.Copy(f, tr)",
          "98:    if err := f.Close(); err != nil {",
          "99:     zlog.Warn(ctx).Err(err).Msg(\"error closing new file\")",
          "100:    }",
          "101:    stats.Reg++",
          "102:   case tar.TypeSymlink:",
          "104:    ln := relPath(root, h.Linkname)",
          "105:    err = os.Symlink(ln, tgt)",
          "106:    stats.Symlink++",
          "107:   case tar.TypeLink:",
          "109:    ln := relPath(root, h.Linkname)",
          "110:    _, exists := os.Lstat(ln)",
          "111:    switch {",
          "112:    case errors.Is(exists, nil):",
          "113:     err = os.Link(ln, tgt)",
          "114:    case errors.Is(exists, os.ErrNotExist):",
          "119:     deferLn = append(deferLn, [2]string{ln, tgt})",
          "120:    default:",
          "121:     err = exists",
          "122:    }",
          "123:    stats.Link++",
          "124:   default:",
          "127:   }",
          "128:   if err != nil {",
          "129:    return \"\", err",
          "130:   }",
          "131:  }",
          "132:  if err != io.EOF {",
          "133:   return \"\", err",
          "134:  }",
          "135:  for _, l := range deferLn {",
          "136:   if err := os.Link(l[0], l[1]); err != nil {",
          "137:    zlog.Debug(ctx).",
          "138:     Err(err).",
          "139:     Msg(\"cross-layer (or invalid) hardlink found\")",
          "140:    if err := os.Link(empty, l[1]); err != nil {",
          "141:     return \"\", err",
          "142:    }",
          "143:   }",
          "144:  }",
          "145:  if ct := len(deferLn); ct != 0 {",
          "146:   zlog.Debug(ctx).",
          "147:    Int(\"count\", ct).",
          "148:    Msg(\"processed deferred links\")",
          "149:  }",
          "151:  zlog.Info(ctx).",
          "152:   Int(\"file\", stats.Reg).",
          "153:   Int(\"dir\", stats.Dir).",
          "154:   Int(\"dir(out of order)\", stats.OutOfOrder).",
          "155:   Int(\"symlink\", stats.Symlink).",
          "156:   Int(\"link\", stats.Link).",
          "157:   Int(\"whiteout\", stats.Whiteout).",
          "158:   Msg(\"extracted layer\")",
          "159:  return root, nil",
          "160: }",
          "",
          "---------------"
        ],
        "rpm/packagescanner.go||rpm/packagescanner.go": [
          "File: rpm/packagescanner.go -> rpm/packagescanner.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package rpm",
          "3: import (",
          "5:  \"bufio\"",
          "6:  \"bytes\"",
          "7:  \"context\"",
          "9:  \"errors\"",
          "10:  \"fmt\"",
          "11:  \"io\"",
          "13:  \"os\"",
          "14:  \"os/exec\"",
          "15:  \"path/filepath\"",
          "16:  \"runtime/trace\"",
          "19:  \"github.com/quay/zlog\"",
          "21:  \"github.com/quay/claircore\"",
          "22:  \"github.com/quay/claircore/indexer\"",
          "23: )",
          "25: const (",
          "26:  pkgName    = \"rpm\"",
          "27:  pkgKind    = \"package\"",
          "29: )",
          "36: var (",
          "37:  _ indexer.VersionedScanner = (*Scanner)(nil)",
          "38:  _ indexer.PackageScanner   = (*Scanner)(nil)",
          "",
          "[Removed Lines]",
          "4:  \"archive/tar\"",
          "8:  \"encoding/binary\"",
          "12:  \"io/ioutil\"",
          "17:  \"strings\"",
          "28:  pkgVersion = \"4\"",
          "32: var dbnames = map[string]struct{}{",
          "33:  \"Packages\": {},",
          "34: }",
          "",
          "[Added Lines]",
          "10:  \"io/fs\"",
          "13:  \"path\"",
          "16:  \"sync\"",
          "22:  \"github.com/quay/claircore/pkg/tarfs\"",
          "23:  \"github.com/quay/claircore/rpm/sqlite\"",
          "29:  pkgVersion = \"5\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "81:  rd, ok := r.(interface {",
          "82:   io.ReadCloser",
          "83:   io.Seeker",
          "84:  })",
          "85:  if !ok {",
          "86:   return nil, errors.New(\"rpm: cannot seek on returned layer Reader\")",
          "87:  }",
          "108:  }",
          "111:  }",
          "119:  if len(found) == 0 {",
          "120:   return nil, nil",
          "121:  }",
          "127:  defer func() {",
          "132:    zlog.Error(ctx).Err(err).Msg(\"error removing extracted files\")",
          "133:   }",
          "134:  }()",
          "171:    continue",
          "172:   }",
          "196:    }",
          "206:    if err != nil {",
          "234:    }",
          "253:     return nil, err",
          "254:    }",
          "300:     if err != nil {",
          "301:      return err",
          "302:     }",
          "315:    }",
          "320:   }",
          "321:  }",
          "323:  return pkgs, nil",
          "324: }",
          "420:   }",
          "427:   }",
          "467:    }",
          "468:   }",
          "469:  }",
          "472: }",
          "",
          "[Removed Lines]",
          "94:  possible := make(map[string]int)",
          "95:  tr := tar.NewReader(rd)",
          "98:  var h *tar.Header",
          "99:  for h, err = tr.Next(); err == nil; h, err = tr.Next() {",
          "100:   n := filepath.Base(h.Name)",
          "101:   d := filepath.Dir(h.Name)",
          "102:   if _, ok := dbnames[n]; ok && checkMagic(ctx, tr) {",
          "103:    possible[d]++",
          "104:   }",
          "105:  }",
          "106:  if err != io.EOF {",
          "107:   return nil, err",
          "109:  if len(possible) == 0 {",
          "110:   return nil, nil",
          "112:  found := make([]string, 0)",
          "113:  for k, score := range possible {",
          "114:   if score == len(dbnames) {",
          "115:    found = append(found, filepath.Join(\"/\", k))",
          "116:   }",
          "117:  }",
          "118:  zlog.Debug(ctx).Int(\"count\", len(found)).Msg(\"found possible databases\")",
          "123:  root, err := ioutil.TempDir(\"\", \"rpmscanner.\")",
          "124:  if err != nil {",
          "125:   return nil, err",
          "126:  }",
          "128:   if err := os.RemoveAll(root); err != nil {",
          "135:  empty := filepath.Join(os.TempDir(), \"rpm.emptyfile\")",
          "136:  ef, err := os.Create(empty)",
          "137:  if err != nil {",
          "138:   return nil, err",
          "139:  }",
          "140:  if err := ef.Close(); err != nil {",
          "141:   return nil, err",
          "142:  }",
          "145:  if err := ctx.Err(); err != nil {",
          "146:   return nil, err",
          "147:  }",
          "148:  if _, err := rd.Seek(0, io.SeekStart); err != nil {",
          "149:   return nil, fmt.Errorf(\"rpm: unable to seek: %w\", err)",
          "150:  }",
          "151:  tr = tar.NewReader(rd)",
          "152:  const (",
          "155:   dirMode  = 0o0700",
          "156:   fileMode = 0o0600",
          "157:  )",
          "159:  var stats struct {",
          "160:   Reg, Link, Symlink, Dir, Whiteout int",
          "161:   OutOfOrder                        int",
          "162:  }",
          "164:  made := map[string]struct{}{root: {}}",
          "166:  var deferLn [][2]string",
          "167:  for h, err = tr.Next(); err == nil; h, err = tr.Next() {",
          "168:   if strings.HasPrefix(filepath.Base(h.Name), \".wh.\") {",
          "170:    stats.Whiteout++",
          "174:   tgt := relPath(root, h.Name)",
          "177:   d := filepath.Dir(tgt)",
          "178:   if _, ok := made[d]; !ok {",
          "179:    if err := os.MkdirAll(d, dirMode); err != nil {",
          "180:     return nil, err",
          "181:    }",
          "182:    made[d] = struct{}{}",
          "183:    stats.OutOfOrder++",
          "184:   }",
          "187:   var err error",
          "188:   switch h.Typeflag {",
          "189:   case tar.TypeDir:",
          "190:    m := h.FileInfo().Mode() | dirMode",
          "191:    if _, ok := made[tgt]; ok {",
          "194:     err = os.Chmod(tgt, m)",
          "195:     break",
          "197:    err = os.Mkdir(tgt, m)",
          "200:    made[d] = struct{}{}",
          "201:    stats.Dir++",
          "202:   case tar.TypeReg:",
          "203:    m := h.FileInfo().Mode() | fileMode",
          "204:    var f *os.File",
          "205:    f, err = os.OpenFile(tgt, os.O_CREATE|os.O_WRONLY, m)",
          "207:     break // Handle after the switch.",
          "208:    }",
          "209:    _, err = io.Copy(f, tr)",
          "210:    if err := f.Close(); err != nil {",
          "211:     zlog.Warn(ctx).Err(err).Msg(\"error closing new file\")",
          "212:    }",
          "213:    stats.Reg++",
          "214:   case tar.TypeSymlink:",
          "216:    ln := relPath(root, h.Linkname)",
          "217:    err = os.Symlink(ln, tgt)",
          "218:    stats.Symlink++",
          "219:   case tar.TypeLink:",
          "221:    ln := relPath(root, h.Linkname)",
          "222:    _, exists := os.Lstat(ln)",
          "223:    switch {",
          "224:    case errors.Is(exists, nil):",
          "225:     err = os.Link(ln, tgt)",
          "226:    case errors.Is(exists, os.ErrNotExist):",
          "231:     deferLn = append(deferLn, [2]string{ln, tgt})",
          "232:    default:",
          "233:     err = exists",
          "235:    stats.Link++",
          "236:   default:",
          "239:   }",
          "240:   if err != nil {",
          "241:    return nil, err",
          "242:   }",
          "243:  }",
          "244:  if err != io.EOF {",
          "245:   return nil, err",
          "246:  }",
          "247:  for _, l := range deferLn {",
          "248:   if err := os.Link(l[0], l[1]); err != nil {",
          "249:    zlog.Debug(ctx).",
          "250:     Err(err).",
          "251:     Msg(\"cross-layer (or invalid) hardlink found\")",
          "252:    if err := os.Link(empty, l[1]); err != nil {",
          "255:   }",
          "256:  }",
          "257:  if ct := len(deferLn); ct != 0 {",
          "258:   zlog.Debug(ctx).",
          "259:    Int(\"count\", ct).",
          "260:    Msg(\"processed deferred links\")",
          "261:  }",
          "263:  zlog.Info(ctx).",
          "264:   Int(\"file\", stats.Reg).",
          "265:   Int(\"dir\", stats.Dir).",
          "266:   Int(\"dir(out of order)\", stats.OutOfOrder).",
          "267:   Int(\"symlink\", stats.Symlink).",
          "268:   Int(\"link\", stats.Link).",
          "269:   Int(\"whiteout\", stats.Whiteout).",
          "270:   Msg(\"extracted layer\")",
          "272:  var pkgs []*claircore.Package",
          "274:  for _, db := range found {",
          "275:   zlog.Debug(ctx).Str(\"db\", db).Msg(\"examining database\")",
          "277:   cmd := exec.CommandContext(ctx, \"rpm\",",
          "278:    `--root`, root, `--dbpath`, db,",
          "279:    `--query`, `--all`, `--queryformat`, queryFmt)",
          "280:   r, err := cmd.StdoutPipe()",
          "281:   if err != nil {",
          "282:    return nil, err",
          "283:   }",
          "284:   errbuf := bytes.Buffer{}",
          "285:   cmd.Stderr = &errbuf",
          "286:   zlog.Debug(ctx).Str(\"db\", db).Strs(\"cmd\", cmd.Args).Msg(\"rpm invocation\")",
          "287:   if err := cmd.Start(); err != nil {",
          "288:    r.Close()",
          "289:    return nil, err",
          "290:   }",
          "292:   if err := func() error {",
          "293:    defer r.Close()",
          "294:    srcs := make(map[string]*claircore.Package)",
          "295:    s := bufio.NewScanner(r)",
          "296:    s.Split(querySplit)",
          "298:    for s.Scan() {",
          "299:     p, err := parsePackage(ctx, srcs, bytes.NewBuffer(s.Bytes()))",
          "303:     p.PackageDB = db",
          "304:     pkgs = append(pkgs, p)",
          "305:    }",
          "307:    return s.Err()",
          "308:   }(); err != nil {",
          "309:    if errbuf.Len() != 0 {",
          "310:     zlog.Warn(ctx).",
          "311:      Str(\"db\", db).",
          "312:      Strs(\"cmd\", cmd.Args).",
          "313:      Str(\"err\", errbuf.String()).",
          "314:      Msg(\"error output\")",
          "316:    return nil, fmt.Errorf(\"rpm: error reading rpm output: %w\", err)",
          "317:   }",
          "318:   if err := cmd.Wait(); err != nil {",
          "319:    return nil, err",
          "329: const queryFmt = `%{name}\\n` +",
          "330:  `%{evr}\\n` +",
          "331:  `%{payloaddigestalgo}:%{payloaddigest}\\n` +",
          "332:  `%{sigpgp:pgpsig}\\n` +",
          "333:  `%{sourcerpm}\\n` +",
          "334:  `%{RPMTAG_MODULARITYLABEL}\\n` +",
          "335:  `%{ARCH}\\n` +",
          "336:  `.\\n`",
          "337: const delim = \"\\n.\\n\"",
          "339: func querySplit(data []byte, atEOF bool) (advance int, token []byte, err error) {",
          "340:  i := bytes.Index(data, []byte(delim))",
          "341:  switch {",
          "342:  case len(data) == 0 && atEOF:",
          "343:   return 0, nil, io.EOF",
          "344:  case i == -1 && atEOF:",
          "345:   return 0, nil, errors.New(\"invalid format\")",
          "346:  case i == -1 && !atEOF:",
          "347:   return 0, nil, nil",
          "348:  default:",
          "349:  }",
          "350:  tok := data[:i]",
          "351:  return len(tok) + len(delim), tok, nil",
          "352: }",
          "354: func parsePackage(ctx context.Context, src map[string]*claircore.Package, buf *bytes.Buffer) (*claircore.Package, error) {",
          "355:  defer trace.StartRegion(ctx, \"parsePackage\").End()",
          "356:  p := claircore.Package{",
          "357:   Kind: claircore.BINARY,",
          "358:  }",
          "359:  var err error",
          "360:  var line string",
          "362:  for i := 0; ; i++ {",
          "364:   line, err = buf.ReadString('\\n')",
          "365:   line = strings.TrimSpace(line)",
          "366:   if strings.HasPrefix(line, \"(none)\") {",
          "367:    continue",
          "368:   }",
          "369:   if line == \"\" && err == nil {",
          "370:    zlog.Info(ctx).",
          "371:     Str(\"package\", p.Name).",
          "372:     Int(\"lineno\", i).",
          "373:     Msg(\"unexpected empty line\")",
          "374:    continue",
          "375:   }",
          "376:   switch i {",
          "377:   case 0:",
          "378:    p.Name = line",
          "379:   case 1:",
          "380:    p.Version = line",
          "381:   case 2:",
          "382:    p.RepositoryHint = \"hash:\"",
          "383:    switch line[0] {",
          "384:    case '8': // sha256",
          "385:     p.RepositoryHint += \"sha256\" + line[1:]",
          "386:    }",
          "387:   case 3:",
          "388:    const delim = `Key ID `",
          "389:    i := strings.Index(line, delim)",
          "390:    if i == -1 { // ???",
          "391:     break",
          "392:    }",
          "393:    p.RepositoryHint += \"|key:\" + line[i+len(delim):]",
          "394:   case 4:",
          "395:    line = strings.TrimSuffix(line, \".src.rpm\")",
          "396:    sp := strings.Split(line, \"-\")",
          "397:    name := strings.Join(sp[:len(sp)-2], \"-\")",
          "398:    if s, ok := src[name]; ok {",
          "399:     p.Source = s",
          "400:     break",
          "401:    }",
          "402:    p.Source = &claircore.Package{",
          "403:     Name:    name,",
          "404:     Version: sp[len(sp)-2] + \"-\" + sp[len(sp)-1],",
          "405:     Kind:    claircore.SOURCE,",
          "406:    }",
          "407:    src[name] = p.Source",
          "408:   case 5:",
          "409:    moduleSplit := strings.Split(line, \":\")",
          "410:    if len(moduleSplit) < 2 {",
          "411:     continue",
          "412:    }",
          "413:    moduleStream := fmt.Sprintf(\"%s:%s\", moduleSplit[0], moduleSplit[1])",
          "414:    p.Module = moduleStream",
          "415:    if p.Source != nil {",
          "416:     p.Source.Module = moduleStream",
          "417:    }",
          "418:   case 6:",
          "419:    p.Arch = line",
          "421:   switch err {",
          "422:   case nil:",
          "423:   case io.EOF:",
          "424:    return &p, nil",
          "425:   default:",
          "426:    return nil, err",
          "428:  }",
          "429: }",
          "442: func checkMagic(ctx context.Context, r io.Reader) bool {",
          "443:  const (",
          "444:   Hash  = 0x00061561",
          "445:   BTree = 0x00053162",
          "446:   Queue = 0x00042253",
          "447:   Log   = 0x00040988",
          "448:  )",
          "450:  be := []binary.ByteOrder{binary.LittleEndian, binary.BigEndian}",
          "451:  b := make([]byte, 4)",
          "454:  for _, discard := range []int64{0, 8} {",
          "455:   if _, err := io.Copy(io.Discard, io.LimitReader(r, discard)); err != nil {",
          "456:    zlog.Warn(ctx).Err(err).Msg(\"unexpected error checking magic\")",
          "457:    return false",
          "458:   }",
          "459:   if _, err := io.ReadFull(r, b); err != nil {",
          "460:    zlog.Warn(ctx).Err(err).Msg(\"unexpected error checking magic\")",
          "461:    return false",
          "462:   }",
          "463:   for _, o := range be {",
          "464:    n := o.Uint32(b)",
          "465:    if n == Hash || n == BTree || n == Queue || n == Log {",
          "466:     return true",
          "471:  return false",
          "",
          "[Added Lines]",
          "80:   io.ReaderAt",
          "86:  found := make([]foundDB, 0)",
          "87:  sys, err := tarfs.New(rd)",
          "88:  if err != nil {",
          "89:   return nil, fmt.Errorf(\"rpm: unable to create tarfs: %w\", err)",
          "91:  if err := fs.WalkDir(sys, \".\", findDBs(ctx, &found, sys)); err != nil {",
          "92:   return nil, fmt.Errorf(\"rpm: error walking fs: %w\", err)",
          "98:  zlog.Debug(ctx).Int(\"count\", len(found)).Msg(\"found possible databases\")",
          "100:  var (",
          "101:   extractRoot string",
          "102:   extractErr  error",
          "103:   extractOnce sync.Once",
          "104:  )",
          "106:   if extractRoot == \"\" {",
          "107:    return",
          "108:   }",
          "109:   if err := os.RemoveAll(extractRoot); err != nil {",
          "117:  var pkgs []*claircore.Package",
          "118:  done := map[string]struct{}{}",
          "119:  for _, db := range found {",
          "120:   ctx := zlog.ContextWithValues(ctx, \"db\", db.String())",
          "121:   zlog.Debug(ctx).Msg(\"examining database\")",
          "122:   if _, ok := done[db.Path]; ok {",
          "123:    zlog.Debug(ctx).Msg(\"already seen, skipping\")",
          "126:   done[db.Path] = struct{}{}",
          "128:   switch db.Kind {",
          "129:   case kindBDB:",
          "130:    extractOnce.Do(func() { extractRoot, extractErr = extractTar(ctx, rd) })",
          "131:    if err := extractErr; err != nil {",
          "132:     return nil, err",
          "136:    cmd := exec.CommandContext(ctx, \"rpm\",",
          "137:     `--root`, extractRoot, `--dbpath`, filepath.Join(\"/\", db.Path),",
          "138:     `--query`, `--all`, `--queryformat`, queryFmt)",
          "139:    r, err := cmd.StdoutPipe()",
          "141:     return nil, err",
          "143:    errbuf := bytes.Buffer{}",
          "144:    cmd.Stderr = &errbuf",
          "145:    zlog.Debug(ctx).Strs(\"cmd\", cmd.Args).Msg(\"rpm invocation\")",
          "146:    if err := cmd.Start(); err != nil {",
          "147:     r.Close()",
          "151:    if err := func() error {",
          "152:     defer r.Close()",
          "153:     srcs := make(map[string]*claircore.Package)",
          "154:     s := bufio.NewScanner(r)",
          "155:     s.Split(querySplit)",
          "157:     for s.Scan() {",
          "158:      p, err := parsePackage(ctx, srcs, bytes.NewBuffer(s.Bytes()))",
          "159:      if err != nil {",
          "160:       return err",
          "161:      }",
          "162:      p.PackageDB = db.String()",
          "163:      pkgs = append(pkgs, p)",
          "164:     }",
          "166:     return s.Err()",
          "167:    }(); err != nil {",
          "168:     if errbuf.Len() != 0 {",
          "169:      zlog.Warn(ctx).",
          "170:       Strs(\"cmd\", cmd.Args).",
          "171:       Str(\"err\", errbuf.String()).",
          "172:       Msg(\"error output\")",
          "173:     }",
          "174:     return nil, fmt.Errorf(\"rpm: error reading rpm output: %w\", err)",
          "175:    }",
          "176:    if err := cmd.Wait(); err != nil {",
          "177:     return nil, err",
          "178:    }",
          "179:   case kindSQLite:",
          "180:    if err := func() error {",
          "181:     r, err := sys.Open(path.Join(db.Path, `rpmdb.sqlite`))",
          "185:     defer func() {",
          "186:      if err := r.Close(); err != nil {",
          "187:       zlog.Warn(ctx).Err(err).Msg(\"unable to close tarfs sqlite db\")",
          "188:      }",
          "189:     }()",
          "190:     f, err := os.CreateTemp(os.TempDir(), `rpmdb.sqlite.*`)",
          "191:     if err != nil {",
          "192:      return err",
          "193:     }",
          "194:     defer func() {",
          "195:      if err := os.Remove(f.Name()); err != nil {",
          "196:       zlog.Error(ctx).Err(err).Msg(\"unable to unlink sqlite db\")",
          "197:      }",
          "198:      if err := f.Close(); err != nil {",
          "199:       zlog.Warn(ctx).Err(err).Msg(\"unable to close sqlite db\")",
          "200:      }",
          "201:     }()",
          "202:     zlog.Debug(ctx).Str(\"file\", f.Name()).Msg(\"copying sqlite db out of tar\")",
          "203:     if _, err := io.Copy(f, r); err != nil {",
          "204:      return err",
          "205:     }",
          "206:     if err := f.Sync(); err != nil {",
          "207:      return err",
          "208:     }",
          "209:     rpm, err := sqlite.Open(f.Name())",
          "210:     defer rpm.Close()",
          "211:     infos, err := rpm.Packages(ctx)",
          "212:     if err != nil {",
          "213:      return err",
          "214:     }",
          "215:     ps, err := packagesFromInfos(ctx, db.String(), infos)",
          "216:     if err != nil {",
          "217:      return err",
          "218:     }",
          "219:     pkgs = append(pkgs, ps...)",
          "220:     return nil",
          "221:    }(); err != nil {",
          "222:     return nil, fmt.Errorf(\"rpm: error reading sqlite db: %w\", err)",
          "224:   default:",
          "225:    panic(\"programmer error\")",
          "232: func findDBs(ctx context.Context, out *[]foundDB, sys fs.FS) fs.WalkDirFunc {",
          "233:  return func(p string, d fs.DirEntry, err error) error {",
          "234:   if err != nil {",
          "235:    return err",
          "237:   if d.IsDir() {",
          "238:    return nil",
          "241:   dir, n := path.Split(p)",
          "242:   dir = path.Clean(dir)",
          "243:   switch {",
          "244:   case n == `Packages`:",
          "245:    f, err := sys.Open(p)",
          "246:    if err != nil {",
          "247:     return err",
          "249:    defer f.Close()",
          "250:    if !checkMagic(ctx, f) {",
          "251:     return nil",
          "252:    }",
          "254:     Path: dir,",
          "255:     Kind: kindBDB,",
          "256:    })",
          "257:   case n == `rpmdb.sqlite`:",
          "259:     Path: dir,",
          "260:     Kind: kindSQLite,",
          "261:    })",
          "263:   return nil",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "478: func relPath(root, member string) string {",
          "479:  return filepath.Join(root, filepath.Join(\"/\", member))",
          "480: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "275: type dbKind uint",
          "279: const (",
          "280:  _ dbKind = iota",
          "282:  kindBDB    //bdb",
          "283:  kindSQLite //sqlite",
          "284: )",
          "286: type foundDB struct {",
          "287:  Path string",
          "288:  Kind dbKind",
          "289: }",
          "291: func (f foundDB) String() string {",
          "292:  return f.Kind.String() + \":\" + f.Path",
          "293: }",
          "",
          "---------------"
        ],
        "rpm/packagescanner_test.go||rpm/packagescanner_test.go": [
          "File: rpm/packagescanner_test.go -> rpm/packagescanner_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:  \"github.com/quay/claircore\"",
          "17:  \"github.com/quay/claircore/test/fetch\"",
          "18: )",
          "20: func TestScan(t *testing.T) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18:  \"github.com/quay/claircore/test/rpmtest\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:   t.Fatal(err)",
          "30:  }",
          "31:  want := []*claircore.Package{",
          "33:    Name:           \"tzdata\",",
          "34:    Version:        \"2019a-1.el8\",",
          "35:    Arch:           \"noarch\",",
          "36:    Kind:           claircore.BINARY,",
          "37:    Source:         &claircore.Package{Name: \"tzdata\", Version: \"2019a-1.el8\", Kind: claircore.SOURCE},",
          "39:    RepositoryHint: \"hash:sha256:d7e32f5f28a029a7fd4ed9a1d0ac3be568c2c5a926e787202a1c3fbbaf70cf5c|key:05b555b38483c65d\",",
          "40:   },",
          "42:    Name:           \"ncurses-base\",",
          "43:    Version:        \"6.1-7.20180224.el8\",",
          "44:    Arch:           \"noarch\",",
          "45:    Kind:           claircore.BINARY,",
          "46:    Source:         &claircore.Package{Name: \"ncurses\", Version: \"6.1-7.20180224.el8\", Kind: claircore.SOURCE},",
          "48:    RepositoryHint: \"hash:sha256:198e189345f93894eb71fac81c54816b6d303d03831abd15bdc98079f0f86fcb|key:05b555b38483c65d\",",
          "49:   },",
          "51:    Name:           \"dnf-data\",",
          "52:    Version:        \"4.0.9.2-5.el8\",",
          "53:    Arch:           \"noarch\",",
          "54:    Kind:           claircore.BINARY,",
          "55:    Source:         &claircore.Package{Name: \"dnf\", Version: \"4.0.9.2-5.el8\", Kind: claircore.SOURCE},",
          "57:    RepositoryHint: \"hash:sha256:1d39c148148c09be1273ea8bfa5626d39f30a7d3633499f972ecd4415a9257e8|key:05b555b38483c65d\",",
          "58:   },",
          "60:    Name:           \"dbus-common\",",
          "61:    Version:        \"1:1.12.8-7.el8\",",
          "62:    Arch:           \"noarch\",",
          "63:    Kind:           claircore.BINARY,",
          "64:    Source:         &claircore.Package{Name: \"dbus\", Version: \"1.12.8-7.el8\", Kind: claircore.SOURCE},",
          "66:    RepositoryHint: \"hash:sha256:78aad94d6baf0eec001772b09959cb2fb758d57484ad4fc171f211914b014ad9|key:05b555b38483c65d\",",
          "67:   },",
          "69:    Name:           \"setup\",",
          "70:    Version:        \"2.12.2-1.el8\",",
          "71:    Arch:           \"noarch\",",
          "72:    Kind:           claircore.BINARY,",
          "73:    Source:         &claircore.Package{Name: \"setup\", Version: \"2.12.2-1.el8\", Kind: claircore.SOURCE},",
          "75:    RepositoryHint: \"hash:sha256:b61ced6a392c34c287a0686d81f66d3e660c40a6108ac5698f4a4696aed4fff2|key:05b555b38483c65d\",",
          "76:   },",
          "78:    Name:           \"basesystem\",",
          "79:    Version:        \"11-5.el8\",",
          "80:    Arch:           \"noarch\",",
          "81:    Kind:           claircore.BINARY,",
          "82:    Source:         &claircore.Package{Name: \"basesystem\", Version: \"11-5.el8\", Kind: claircore.SOURCE},",
          "84:    RepositoryHint: \"hash:sha256:fa127960f98c176c3e57432cbd96a74767f5fa803db325c0eacae18b47d52105|key:05b555b38483c65d\",",
          "85:   },",
          "87:    Name:           \"libselinux\",",
          "88:    Version:        \"2.8-6.el8\",",
          "89:    Arch:           \"x86_64\",",
          "90:    Kind:           claircore.BINARY,",
          "91:    Source:         &claircore.Package{Name: \"libselinux\", Version: \"2.8-6.el8\", Kind: claircore.SOURCE},",
          "93:    RepositoryHint: \"hash:sha256:01fd401648619764cbf68a489e83451602c898495fa4520e41c48c48f62a4e36|key:05b555b38483c65d\",",
          "94:   },",
          "96:    Name:           \"glibc-minimal-langpack\",",
          "97:    Version:        \"2.28-42.el8.1\",",
          "98:    Arch:           \"x86_64\",",
          "99:    Kind:           claircore.BINARY,",
          "100:    Source:         &claircore.Package{Name: \"glibc\", Version: \"2.28-42.el8.1\", Kind: claircore.SOURCE},",
          "102:    RepositoryHint: \"hash:sha256:fa127960f98c176c3e57432cbd96a74767f5fa803db325c0eacae18b47d52105|key:05b555b38483c65d\",",
          "103:   },",
          "105:    Name:           \"glibc\",",
          "106:    Version:        \"2.28-42.el8.1\",",
          "107:    Arch:           \"x86_64\",",
          "108:    Kind:           claircore.BINARY,",
          "109:    Source:         &claircore.Package{Name: \"glibc\", Version: \"2.28-42.el8.1\", Kind: claircore.SOURCE},",
          "111:    RepositoryHint: \"hash:sha256:ca20e19a3a4cc6b4b8b84aea620975c1a51a5d9e84649808ae15075a07f0d7ea|key:05b555b38483c65d\",",
          "112:   },",
          "114:    Name:           \"libsepol\",",
          "115:    Version:        \"2.8-2.el8\",",
          "116:    Arch:           \"x86_64\",",
          "117:    Kind:           claircore.BINARY,",
          "118:    Source:         &claircore.Package{Name: \"libsepol\", Version: \"2.8-2.el8\", Kind: claircore.SOURCE},",
          "120:    RepositoryHint: \"hash:sha256:ee8fecca7fde8168278953711f935a04c309eda37d9f5647cecf25ff659f7730|key:05b555b38483c65d\",",
          "121:   },",
          "123:    Name:           \"xz-libs\",",
          "124:    Version:        \"5.2.4-3.el8\",",
          "125:    Arch:           \"x86_64\",",
          "126:    Kind:           claircore.BINARY,",
          "127:    Source:         &claircore.Package{Name: \"xz\", Version: \"5.2.4-3.el8\", Kind: claircore.SOURCE},",
          "129:    RepositoryHint: \"hash:sha256:8694f6056932283de5b0f277bda721ce9ff5d7d217a12175cde6f23187c2a4b1|key:05b555b38483c65d\",",
          "130:   },",
          "132:    Name:           \"libcap\",",
          "133:    Version:        \"2.25-9.el8\",",
          "134:    Arch:           \"x86_64\",",
          "135:    Kind:           claircore.BINARY,",
          "136:    Source:         &claircore.Package{Name: \"libcap\", Version: \"2.25-9.el8\", Kind: claircore.SOURCE},",
          "138:    RepositoryHint: \"hash:sha256:897f61e794f569c44820f011b6e4fbfc19fc79e4a50faca94a0c5da658ccda91|key:05b555b38483c65d\",",
          "139:   },",
          "141:    Name:           \"libgpg-error\",",
          "142:    Version:        \"1.31-1.el8\",",
          "143:    Arch:           \"x86_64\",",
          "144:    Kind:           claircore.BINARY,",
          "145:    Source:         &claircore.Package{Name: \"libgpg-error\", Version: \"1.31-1.el8\", Kind: claircore.SOURCE},",
          "147:    RepositoryHint: \"hash:sha256:ef78b78f406942ae056c86b3096b0eabc9f2bf5dd63f9685c6d7a28b385c2f4a|key:05b555b38483c65d\",",
          "148:   },",
          "150:    Name:           \"libcom_err\",",
          "151:    Version:        \"1.44.3-2.el8\",",
          "152:    Arch:           \"x86_64\",",
          "153:    Kind:           claircore.BINARY,",
          "154:    Source:         &claircore.Package{Name: \"e2fsprogs\", Version: \"1.44.3-2.el8\", Kind: claircore.SOURCE},",
          "156:    RepositoryHint: \"hash:sha256:bebfaaf923400e5f7cad4000c963f7717c36f4e5f82f0d72f3db86f80a493621|key:05b555b38483c65d\",",
          "157:   },",
          "159:    Name:           \"libxml2\",",
          "160:    Version:        \"2.9.7-5.el8\",",
          "161:    Arch:           \"x86_64\",",
          "162:    Kind:           claircore.BINARY,",
          "163:    Source:         &claircore.Package{Name: \"libxml2\", Version: \"2.9.7-5.el8\", Kind: claircore.SOURCE},",
          "165:    RepositoryHint: \"hash:sha256:f09f1d58921b7a592b9a7c2836676ef4c8b55cd7192395ed3b74ee771fbbb589|key:05b555b38483c65d\",",
          "166:   },",
          "168:    Name:           \"expat\",",
          "169:    Version:        \"2.2.5-3.el8\",",
          "170:    Arch:           \"x86_64\",",
          "171:    Kind:           claircore.BINARY,",
          "172:    Source:         &claircore.Package{Name: \"expat\", Version: \"2.2.5-3.el8\", Kind: claircore.SOURCE},",
          "174:    RepositoryHint: \"hash:sha256:08d977c11da01f64f916d0e6d26200ca286391b5166df9998ba5c2dbfebcb691|key:05b555b38483c65d\",",
          "175:   },",
          "177:    Name:           \"libuuid\",",
          "178:    Version:        \"2.32.1-8.el8\",",
          "179:    Arch:           \"x86_64\",",
          "180:    Kind:           claircore.BINARY,",
          "181:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "183:    RepositoryHint: \"hash:sha256:7b1331cda22a580eff4882fd7b7b92cc8066e9e88b5072569b4015a6ff19866a|key:05b555b38483c65d\",",
          "184:   },",
          "186:    Name:           \"chkconfig\",",
          "187:    Version:        \"1.11-1.el8\",",
          "188:    Arch:           \"x86_64\",",
          "189:    Kind:           claircore.BINARY,",
          "190:    Source:         &claircore.Package{Name: \"chkconfig\", Version: \"1.11-1.el8\", Kind: claircore.SOURCE},",
          "192:    RepositoryHint: \"hash:sha256:bd0102959bf6176a832d60f7ac16d42270e3b6422a2299326266a75e06014ae9|key:05b555b38483c65d\",",
          "193:   },",
          "195:    Name:           \"gmp\",",
          "196:    Version:        \"1:6.1.2-8.el8\",",
          "197:    Arch:           \"x86_64\",",
          "198:    Kind:           claircore.BINARY,",
          "199:    Source:         &claircore.Package{Name: \"gmp\", Version: \"6.1.2-8.el8\", Kind: claircore.SOURCE},",
          "201:    RepositoryHint: \"hash:sha256:8262c6291fbd17ff6043261d8f9769bf5a3304639da7c25c6145baa55b37462b|key:05b555b38483c65d\",",
          "202:   },",
          "204:    Name:           \"libattr\",",
          "205:    Version:        \"2.4.48-3.el8\",",
          "206:    Arch:           \"x86_64\",",
          "207:    Kind:           claircore.BINARY,",
          "208:    Source:         &claircore.Package{Name: \"attr\", Version: \"2.4.48-3.el8\", Kind: claircore.SOURCE},",
          "210:    RepositoryHint: \"hash:sha256:4305eea35033526e55f5043bdc963e58b79a1f9500bb1a6f5b937b552306ca4e|key:05b555b38483c65d\",",
          "211:   },",
          "213:    Name:           \"coreutils-single\",",
          "214:    Version:        \"8.30-6.el8\",",
          "215:    Arch:           \"x86_64\",",
          "216:    Kind:           claircore.BINARY,",
          "217:    Source:         &claircore.Package{Name: \"coreutils\", Version: \"8.30-6.el8\", Kind: claircore.SOURCE},",
          "219:    RepositoryHint: \"hash:sha256:2bd25cb124f007586a6e47d0d8f17e19deef98d0ad3471221c916fa08c01ba48|key:05b555b38483c65d\",",
          "220:   },",
          "222:    Name:           \"libblkid\",",
          "223:    Version:        \"2.32.1-8.el8\",",
          "224:    Arch:           \"x86_64\",",
          "225:    Kind:           claircore.BINARY,",
          "226:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "228:    RepositoryHint: \"hash:sha256:f4ffcd322ff77998f1940ea057480e2aad29ae28e4546c3e7eb2b0cb339b6a97|key:05b555b38483c65d\",",
          "229:   },",
          "231:    Name:           \"libcap-ng\",",
          "232:    Version:        \"0.7.9-4.el8\",",
          "233:    Arch:           \"x86_64\",",
          "234:    Kind:           claircore.BINARY,",
          "235:    Source:         &claircore.Package{Name: \"libcap-ng\", Version: \"0.7.9-4.el8\", Kind: claircore.SOURCE},",
          "237:    RepositoryHint: \"hash:sha256:972a95960a481af19fd0a71750abbc33a5537ef403f81d6c0d8281e26fbe65b4|key:05b555b38483c65d\",",
          "238:   },",
          "240:    Name:           \"libffi\",",
          "241:    Version:        \"3.1-18.el8\",",
          "242:    Arch:           \"x86_64\",",
          "243:    Kind:           claircore.BINARY,",
          "244:    Source:         &claircore.Package{Name: \"libffi\", Version: \"3.1-18.el8\", Kind: claircore.SOURCE},",
          "246:    RepositoryHint: \"hash:sha256:9b3b30a8a81f7d1b03d43ccc0b356a4cc7ed5d309ab7030ffb9a13b864272f29|key:05b555b38483c65d\",",
          "247:   },",
          "249:    Name:           \"lua-libs\",",
          "250:    Version:        \"5.3.4-10.el8\",",
          "251:    Arch:           \"x86_64\",",
          "252:    Kind:           claircore.BINARY,",
          "253:    Source:         &claircore.Package{Name: \"lua\", Version: \"5.3.4-10.el8\", Kind: claircore.SOURCE},",
          "255:    RepositoryHint: \"hash:sha256:ae89b936f5d6d9da2a0358a2dd1f1a364c8947b868cb86a0a15fdd167ecebf8e|key:05b555b38483c65d\",",
          "256:   },",
          "258:    Name:           \"p11-kit\",",
          "259:    Version:        \"0.23.14-4.el8\",",
          "260:    Arch:           \"x86_64\",",
          "261:    Kind:           claircore.BINARY,",
          "262:    Source:         &claircore.Package{Name: \"p11-kit\", Version: \"0.23.14-4.el8\", Kind: claircore.SOURCE},",
          "264:    RepositoryHint: \"hash:sha256:17efd6d31955ee8f51e840ecbaa906e2f9b39e0c9bc16f67f6d6af2d33f09792|key:05b555b38483c65d\",",
          "265:   },",
          "267:    Name:           \"gzip\",",
          "268:    Version:        \"1.9-4.el8\",",
          "269:    Arch:           \"x86_64\",",
          "270:    Kind:           claircore.BINARY,",
          "271:    Source:         &claircore.Package{Name: \"gzip\", Version: \"1.9-4.el8\", Kind: claircore.SOURCE},",
          "273:    RepositoryHint: \"hash:sha256:7a65a5e253d82c342a2e56e37d7d2ca8c59d43153f877e4c23bf2bc06c47f87c|key:05b555b38483c65d\",",
          "274:   },",
          "276:    Name:           \"libassuan\",",
          "277:    Version:        \"2.5.1-3.el8\",",
          "278:    Arch:           \"x86_64\",",
          "279:    Kind:           claircore.BINARY,",
          "280:    Source:         &claircore.Package{Name: \"libassuan\", Version: \"2.5.1-3.el8\", Kind: claircore.SOURCE},",
          "282:    RepositoryHint: \"hash:sha256:125a1910e1bd3aedee5c6aa7b7a0f0a758178849b004916a4ca25d569a54cc8d|key:05b555b38483c65d\",",
          "283:   },",
          "285:    Name:           \"libidn2\",",
          "286:    Version:        \"2.0.5-1.el8\",",
          "287:    Arch:           \"x86_64\",",
          "288:    Kind:           claircore.BINARY,",
          "289:    Source:         &claircore.Package{Name: \"libidn2\", Version: \"2.0.5-1.el8\", Kind: claircore.SOURCE},",
          "291:    RepositoryHint: \"hash:sha256:b7e550df988802e651ff53d9f74a09f04439875fbf04728dd7dc21affa2bb400|key:05b555b38483c65d\",",
          "292:   },",
          "294:    Name:           \"gdbm-libs\",",
          "295:    Version:        \"1:1.18-1.el8\",",
          "296:    Arch:           \"x86_64\",",
          "297:    Kind:           claircore.BINARY,",
          "298:    Source:         &claircore.Package{Name: \"gdbm\", Version: \"1.18-1.el8\", Kind: claircore.SOURCE},",
          "300:    RepositoryHint: \"hash:sha256:5a5327261b2078028882c990e909e9d30fbf796319b619ac460b8f867c1111a6|key:05b555b38483c65d\",",
          "301:   },",
          "303:    Name:           \"libtasn1\",",
          "304:    Version:        \"4.13-3.el8\",",
          "305:    Arch:           \"x86_64\",",
          "306:    Kind:           claircore.BINARY,",
          "307:    Source:         &claircore.Package{Name: \"libtasn1\", Version: \"4.13-3.el8\", Kind: claircore.SOURCE},",
          "309:    RepositoryHint: \"hash:sha256:2f5301c3c9c5095667e754aee9dd9289c730bd22fd16f608ee190abe06d111c8|key:05b555b38483c65d\",",
          "310:   },",
          "312:    Name:           \"lzo\",",
          "313:    Version:        \"2.08-14.el8\",",
          "314:    Arch:           \"x86_64\",",
          "315:    Kind:           claircore.BINARY,",
          "316:    Source:         &claircore.Package{Name: \"lzo\", Version: \"2.08-14.el8\", Kind: claircore.SOURCE},",
          "318:    RepositoryHint: \"hash:sha256:89c7940be2ba590c182539c7cbbc6d875ca9d91899af70262c1ba7aad0e88a7a|key:05b555b38483c65d\",",
          "319:   },",
          "321:    Name:           \"grep\",",
          "322:    Version:        \"3.1-6.el8\",",
          "323:    Arch:           \"x86_64\",",
          "324:    Kind:           claircore.BINARY,",
          "325:    Source:         &claircore.Package{Name: \"grep\", Version: \"3.1-6.el8\", Kind: claircore.SOURCE},",
          "327:    RepositoryHint: \"hash:sha256:eb9a23a41775c978a663c37cae8b8166e0cf95120b2df4554104879afc4dec84|key:05b555b38483c65d\",",
          "328:   },",
          "330:    Name:           \"glib2\",",
          "331:    Version:        \"2.56.4-1.el8\",",
          "332:    Arch:           \"x86_64\",",
          "333:    Kind:           claircore.BINARY,",
          "334:    Source:         &claircore.Package{Name: \"glib2\", Version: \"2.56.4-1.el8\", Kind: claircore.SOURCE},",
          "336:    RepositoryHint: \"hash:sha256:de8a077d6d178c638670fb73ead324c6e4b306371f6b1760c88c74dc1dc17e4c|key:05b555b38483c65d\",",
          "337:   },",
          "339:    Name:           \"dbus-libs\",",
          "340:    Version:        \"1:1.12.8-7.el8\",",
          "341:    Arch:           \"x86_64\",",
          "342:    Kind:           claircore.BINARY,",
          "343:    Source:         &claircore.Package{Name: \"dbus\", Version: \"1.12.8-7.el8\", Kind: claircore.SOURCE},",
          "345:    RepositoryHint: \"hash:sha256:d35f0c6f32c7c91af1960f54753d1480751c211a017fbc6d3990ef9c48d0c1d2|key:05b555b38483c65d\",",
          "346:   },",
          "348:    Name:           \"openssl-libs\",",
          "349:    Version:        \"1:1.1.1-8.el8\",",
          "350:    Arch:           \"x86_64\",",
          "351:    Kind:           claircore.BINARY,",
          "352:    Source:         &claircore.Package{Name: \"openssl\", Version: \"1.1.1-8.el8\", Kind: claircore.SOURCE},",
          "354:    RepositoryHint: \"hash:sha256:8fd2a342447a88a225120b87bbcb2772223d6d9bf708ef64fdee39eb9f891f92|key:05b555b38483c65d\",",
          "355:   },",
          "357:    Name:           \"kmod-libs\",",
          "358:    Version:        \"25-11.el8\",",
          "359:    Arch:           \"x86_64\",",
          "360:    Kind:           claircore.BINARY,",
          "361:    Source:         &claircore.Package{Name: \"kmod\", Version: \"25-11.el8\", Kind: claircore.SOURCE},",
          "363:    RepositoryHint: \"hash:sha256:bb6192209d173080d53d6cd1835ce8b3bd8f873770cab307a065ec6dae9fcf7c|key:05b555b38483c65d\",",
          "364:   },",
          "366:    Name:           \"kmod\",",
          "367:    Version:        \"25-11.el8\",",
          "368:    Arch:           \"x86_64\",",
          "369:    Kind:           claircore.BINARY,",
          "370:    Source:         &claircore.Package{Name: \"kmod\", Version: \"25-11.el8\", Kind: claircore.SOURCE},",
          "372:    RepositoryHint: \"hash:sha256:434f99c93cd522ec93798f0c22e38eab3209eaa2aad0842967c13bf3da1e1ecf|key:05b555b38483c65d\",",
          "373:   },",
          "375:    Name:           \"libarchive\",",
          "376:    Version:        \"3.3.2-3.el8\",",
          "377:    Arch:           \"x86_64\",",
          "378:    Kind:           claircore.BINARY,",
          "379:    Source:         &claircore.Package{Name: \"libarchive\", Version: \"3.3.2-3.el8\", Kind: claircore.SOURCE},",
          "381:    RepositoryHint: \"hash:sha256:db90fd1df0e1640d5e5793fcfdce6355a86f98fa65bd32d649d3ea093695d1bc|key:05b555b38483c65d\",",
          "382:   },",
          "384:    Name:           \"dhcp-libs\",",
          "385:    Version:        \"12:4.3.6-30.el8\",",
          "386:    Arch:           \"x86_64\",",
          "387:    Kind:           claircore.BINARY,",
          "388:    Source:         &claircore.Package{Name: \"dhcp\", Version: \"4.3.6-30.el8\", Kind: claircore.SOURCE},",
          "390:    RepositoryHint: \"hash:sha256:2c55ad3dff760f9fb0369a7bf4a8e9c2f62643c5a6784a836ee5d5a020a20136|key:05b555b38483c65d\",",
          "391:   },",
          "393:    Name:           \"procps-ng\",",
          "394:    Version:        \"3.3.15-1.el8\",",
          "395:    Arch:           \"x86_64\",",
          "396:    Kind:           claircore.BINARY,",
          "397:    Source:         &claircore.Package{Name: \"procps-ng\", Version: \"3.3.15-1.el8\", Kind: claircore.SOURCE},",
          "399:    RepositoryHint: \"hash:sha256:e5bb29d135facd79163c6c9a2d172778a96a77b03b368d6009f081046b40931e|key:05b555b38483c65d\",",
          "400:   },",
          "402:    Name:           \"squashfs-tools\",",
          "403:    Version:        \"4.3-17.el8\",",
          "404:    Arch:           \"x86_64\",",
          "405:    Kind:           claircore.BINARY,",
          "406:    Source:         &claircore.Package{Name: \"squashfs-tools\", Version: \"4.3-17.el8\", Kind: claircore.SOURCE},",
          "408:    RepositoryHint: \"hash:sha256:e6850f0458d5389ee6da189f668936a35320ec388cf78cb2705f404fc790b121|key:05b555b38483c65d\",",
          "409:   },",
          "411:    Name:           \"libsemanage\",",
          "412:    Version:        \"2.8-5.el8\",",
          "413:    Arch:           \"x86_64\",",
          "414:    Kind:           claircore.BINARY,",
          "415:    Source:         &claircore.Package{Name: \"libsemanage\", Version: \"2.8-5.el8\", Kind: claircore.SOURCE},",
          "417:    RepositoryHint: \"hash:sha256:881856796644b3feb1a813cabe229cf49f03ce010dc6355aaa3a311c8888ebf2|key:05b555b38483c65d\",",
          "418:   },",
          "420:    Name:           \"dbus-daemon\",",
          "421:    Version:        \"1:1.12.8-7.el8\",",
          "422:    Arch:           \"x86_64\",",
          "423:    Kind:           claircore.BINARY,",
          "424:    Source:         &claircore.Package{Name: \"dbus\", Version: \"1.12.8-7.el8\", Kind: claircore.SOURCE},",
          "426:    RepositoryHint: \"hash:sha256:5f998117eaec75d9f037ca5eb011dad0417dac04df588e882d569da452c4bf6e|key:05b555b38483c65d\",",
          "427:   },",
          "429:    Name:           \"libfdisk\",",
          "430:    Version:        \"2.32.1-8.el8\",",
          "431:    Arch:           \"x86_64\",",
          "432:    Kind:           claircore.BINARY,",
          "433:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "435:    RepositoryHint: \"hash:sha256:4a249ff76734cd511c62bd2c868bc3849bd018a511b7f2673992527da86f5c66|key:05b555b38483c65d\",",
          "436:   },",
          "438:    Name:           \"mpfr\",",
          "439:    Version:        \"3.1.6-1.el8\",",
          "440:    Arch:           \"x86_64\",",
          "441:    Kind:           claircore.BINARY,",
          "442:    Source:         &claircore.Package{Name: \"mpfr\", Version: \"3.1.6-1.el8\", Kind: claircore.SOURCE},",
          "444:    RepositoryHint: \"hash:sha256:d87079c0d4956f1d1040142a27ed979025702e30825679f991ac728194a659e4|key:05b555b38483c65d\",",
          "445:   },",
          "447:    Name:           \"gnutls\",",
          "448:    Version:        \"3.6.5-2.el8\",",
          "449:    Arch:           \"x86_64\",",
          "450:    Kind:           claircore.BINARY,",
          "451:    Source:         &claircore.Package{Name: \"gnutls\", Version: \"3.6.5-2.el8\", Kind: claircore.SOURCE},",
          "453:    RepositoryHint: \"hash:sha256:4ff33e6e9f7c7e0808603ba867a347dc2210f74e629b4041cf2756f9ae5294c8|key:05b555b38483c65d\",",
          "454:   },",
          "456:    Name:           \"libcomps\",",
          "457:    Version:        \"0.1.8-13.el8\",",
          "458:    Arch:           \"x86_64\",",
          "459:    Kind:           claircore.BINARY,",
          "460:    Source:         &claircore.Package{Name: \"libcomps\", Version: \"0.1.8-13.el8\", Kind: claircore.SOURCE},",
          "462:    RepositoryHint: \"hash:sha256:80b60fb3c4e4298985f621f0e90fa8ed23606f93ab1e10d597dca654dc067484|key:05b555b38483c65d\",",
          "463:   },",
          "465:    Name:           \"libksba\",",
          "466:    Version:        \"1.3.5-7.el8\",",
          "467:    Arch:           \"x86_64\",",
          "468:    Kind:           claircore.BINARY,",
          "469:    Source:         &claircore.Package{Name: \"libksba\", Version: \"1.3.5-7.el8\", Kind: claircore.SOURCE},",
          "471:    RepositoryHint: \"hash:sha256:d5dad8c759e726a82bd638e021a4cc9e28aeeef396ac19b4a9c8b005faaa720c|key:05b555b38483c65d\",",
          "472:   },",
          "474:    Name:           \"cpio\",",
          "475:    Version:        \"2.12-8.el8\",",
          "476:    Arch:           \"x86_64\",",
          "477:    Kind:           claircore.BINARY,",
          "478:    Source:         &claircore.Package{Name: \"cpio\", Version: \"2.12-8.el8\", Kind: claircore.SOURCE},",
          "480:    RepositoryHint: \"hash:sha256:7c20ffcc208509068a0ebbc230cbc61ad5318bbadebce8458944507338c2b24f|key:05b555b38483c65d\",",
          "481:   },",
          "483:    Name:           \"ipcalc\",",
          "484:    Version:        \"0.2.4-3.el8\",",
          "485:    Arch:           \"x86_64\",",
          "486:    Kind:           claircore.BINARY,",
          "487:    Source:         &claircore.Package{Name: \"ipcalc\", Version: \"0.2.4-3.el8\", Kind: claircore.SOURCE},",
          "489:    RepositoryHint: \"hash:sha256:6fea29fb4705ce72e9434c67359d8d28adecb9a33c74448e32a8631f0f73fe59|key:05b555b38483c65d\",",
          "490:   },",
          "492:    Name:           \"iproute\",",
          "493:    Version:        \"4.18.0-11.el8\",",
          "494:    Arch:           \"x86_64\",",
          "495:    Kind:           claircore.BINARY,",
          "496:    Source:         &claircore.Package{Name: \"iproute\", Version: \"4.18.0-11.el8\", Kind: claircore.SOURCE},",
          "498:    RepositoryHint: \"hash:sha256:76d8af499d1fcc15ce44916c4f8f979344cea3283c482283be77535e1ad4615e|key:05b555b38483c65d\",",
          "499:   },",
          "501:    Name:           \"libpkgconf\",",
          "502:    Version:        \"1.4.2-1.el8\",",
          "503:    Arch:           \"x86_64\",",
          "504:    Kind:           claircore.BINARY,",
          "505:    Source:         &claircore.Package{Name: \"pkgconf\", Version: \"1.4.2-1.el8\", Kind: claircore.SOURCE},",
          "507:    RepositoryHint: \"hash:sha256:b26a3437a2c18586d600d672c81242e8bf82ed749848c130fd05f57aaadac68e|key:05b555b38483c65d\",",
          "508:   },",
          "510:    Name:           \"pkgconf-pkg-config\",",
          "511:    Version:        \"1.4.2-1.el8\",",
          "512:    Arch:           \"x86_64\",",
          "513:    Kind:           claircore.BINARY,",
          "514:    Source:         &claircore.Package{Name: \"pkgconf\", Version: \"1.4.2-1.el8\", Kind: claircore.SOURCE},",
          "516:    RepositoryHint: \"hash:sha256:eff64ebb4a63a0d685adc24caa7b8d91845aa82451af90018a803fafb71d4811|key:05b555b38483c65d\",",
          "517:   },",
          "519:    Name:           \"iptables-libs\",",
          "520:    Version:        \"1.8.2-9.el8\",",
          "521:    Arch:           \"x86_64\",",
          "522:    Kind:           claircore.BINARY,",
          "523:    Source:         &claircore.Package{Name: \"iptables\", Version: \"1.8.2-9.el8\", Kind: claircore.SOURCE},",
          "525:    RepositoryHint: \"hash:sha256:5133c7170a13b625089db4043d58a9b861024a6a003d835ea11265110a670a58|key:05b555b38483c65d\",",
          "526:   },",
          "528:    Name:           \"libsigsegv\",",
          "529:    Version:        \"2.11-5.el8\",",
          "530:    Arch:           \"x86_64\",",
          "531:    Kind:           claircore.BINARY,",
          "532:    Source:         &claircore.Package{Name: \"libsigsegv\", Version: \"2.11-5.el8\", Kind: claircore.SOURCE},",
          "534:    RepositoryHint: \"hash:sha256:8ef967becb561e4a833980ee6912d22d5a96331f9bc987c8747d968b5bf0f1d7|key:05b555b38483c65d\",",
          "535:   },",
          "537:    Name:           \"libverto\",",
          "538:    Version:        \"0.3.0-5.el8\",",
          "539:    Arch:           \"x86_64\",",
          "540:    Kind:           claircore.BINARY,",
          "541:    Source:         &claircore.Package{Name: \"libverto\", Version: \"0.3.0-5.el8\", Kind: claircore.SOURCE},",
          "543:    RepositoryHint: \"hash:sha256:37d6350891458ab76e74b450d7b5345f5ea930b433880deb62861b40efabbf4d|key:05b555b38483c65d\",",
          "544:   },",
          "546:    Name:           \"libtirpc\",",
          "547:    Version:        \"1.1.4-3.el8\",",
          "548:    Arch:           \"x86_64\",",
          "549:    Kind:           claircore.BINARY,",
          "550:    Source:         &claircore.Package{Name: \"libtirpc\", Version: \"1.1.4-3.el8\", Kind: claircore.SOURCE},",
          "552:    RepositoryHint: \"hash:sha256:2c2c3b2f61bfb031fe47913d988b260553ec8c731cf9caf0fbf8a7fa17a02588|key:05b555b38483c65d\",",
          "553:   },",
          "555:    Name:           \"platform-python-pip\",",
          "556:    Version:        \"9.0.3-13.el8\",",
          "557:    Arch:           \"noarch\",",
          "558:    Kind:           claircore.BINARY,",
          "559:    Source:         &claircore.Package{Name: \"python-pip\", Version: \"9.0.3-13.el8\", Kind: claircore.SOURCE},",
          "561:    RepositoryHint: \"hash:sha256:a17ca26c61d2358056d2d84a9b6cd6d045a52315b4a071d45259cc5d9826e6e2|key:05b555b38483c65d\",",
          "562:   },",
          "564:    Name:           \"platform-python\",",
          "565:    Version:        \"3.6.8-1.el8.0.1\",",
          "566:    Arch:           \"x86_64\",",
          "567:    Kind:           claircore.BINARY,",
          "568:    Source:         &claircore.Package{Name: \"python3\", Version: \"3.6.8-1.el8.0.1\", Kind: claircore.SOURCE},",
          "570:    RepositoryHint: \"hash:sha256:8b6d99e81232845cdf0300a88aca99fcf7b69b837eece6c7c421d74be7a01084|key:05b555b38483c65d\",",
          "571:   },",
          "573:    Name:           \"libpwquality\",",
          "574:    Version:        \"1.4.0-9.el8\",",
          "575:    Arch:           \"x86_64\",",
          "576:    Kind:           claircore.BINARY,",
          "577:    Source:         &claircore.Package{Name: \"libpwquality\", Version: \"1.4.0-9.el8\", Kind: claircore.SOURCE},",
          "579:    RepositoryHint: \"hash:sha256:d0d4c07d84d6b99525b9159cfa27a94d310319c472424c9dc4338cf3291bbce5|key:05b555b38483c65d\",",
          "580:   },",
          "582:    Name:           \"util-linux\",",
          "583:    Version:        \"2.32.1-8.el8\",",
          "584:    Arch:           \"x86_64\",",
          "585:    Kind:           claircore.BINARY,",
          "586:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "588:    RepositoryHint: \"hash:sha256:d3a9eb395bf4bdab98e73f30bcb2bf253acd06b9ae61c9e8617a8addbedd3e21|key:05b555b38483c65d\",",
          "589:   },",
          "591:    Name:           \"curl\",",
          "592:    Version:        \"7.61.1-8.el8\",",
          "593:    Arch:           \"x86_64\",",
          "594:    Kind:           claircore.BINARY,",
          "595:    Source:         &claircore.Package{Name: \"curl\", Version: \"7.61.1-8.el8\", Kind: claircore.SOURCE},",
          "597:    RepositoryHint: \"hash:sha256:49a45974fa83806e3942ebcad2c8bf72e6f3337fd3b9f94ebd526c0b438b98db|key:05b555b38483c65d\",",
          "598:   },",
          "600:    Name:           \"rpm-libs\",",
          "601:    Version:        \"4.14.2-9.el8\",",
          "602:    Arch:           \"x86_64\",",
          "603:    Kind:           claircore.BINARY,",
          "604:    Source:         &claircore.Package{Name: \"rpm\", Version: \"4.14.2-9.el8\", Kind: claircore.SOURCE},",
          "606:    RepositoryHint: \"hash:sha256:c0de3a7135f47b510eddde4d885e00afd072bd41ef45b1b597b1081d00c2a796|key:05b555b38483c65d\",",
          "607:   },",
          "609:    Name:           \"device-mapper\",",
          "610:    Version:        \"8:1.02.155-6.el8\",",
          "611:    Arch:           \"x86_64\",",
          "612:    Kind:           claircore.BINARY,",
          "613:    Source:         &claircore.Package{Name: \"lvm2\", Version: \"2.03.02-6.el8\", Kind: claircore.SOURCE},",
          "615:    RepositoryHint: \"hash:sha256:b01c1445b0d9d05d9dc80e38e4b293d156cad5472994ace856e67bf6ae5d6a7d|key:05b555b38483c65d\",",
          "616:   },",
          "618:    Name:           \"cryptsetup-libs\",",
          "619:    Version:        \"2.0.6-1.el8\",",
          "620:    Arch:           \"x86_64\",",
          "621:    Kind:           claircore.BINARY,",
          "622:    Source:         &claircore.Package{Name: \"cryptsetup\", Version: \"2.0.6-1.el8\", Kind: claircore.SOURCE},",
          "624:    RepositoryHint: \"hash:sha256:03717069bc76838257d6254f03aace77f5e9c4c47dbaa5917c15871327820622|key:05b555b38483c65d\",",
          "625:   },",
          "627:    Name:           \"elfutils-libs\",",
          "628:    Version:        \"0.174-6.el8\",",
          "629:    Arch:           \"x86_64\",",
          "630:    Kind:           claircore.BINARY,",
          "631:    Source:         &claircore.Package{Name: \"elfutils\", Version: \"0.174-6.el8\", Kind: claircore.SOURCE},",
          "633:    RepositoryHint: \"hash:sha256:7aabee2dda39d1e1081ac6cdd6fab8990e8aab183ba9026897b0feaa755a74eb|key:05b555b38483c65d\",",
          "634:   },",
          "636:    Name:           \"systemd\",",
          "637:    Version:        \"239-13.el8\",",
          "638:    Arch:           \"x86_64\",",
          "639:    Kind:           claircore.BINARY,",
          "640:    Source:         &claircore.Package{Name: \"systemd\", Version: \"239-13.el8\", Kind: claircore.SOURCE},",
          "642:    RepositoryHint: \"hash:sha256:18edae8342701d20cfbb4881d1e6a13da188788282e45d7844591d36dccc6198|key:05b555b38483c65d\",",
          "643:   },",
          "645:    Name:           \"iputils\",",
          "646:    Version:        \"20180629-1.el8\",",
          "647:    Arch:           \"x86_64\",",
          "648:    Kind:           claircore.BINARY,",
          "649:    Source:         &claircore.Package{Name: \"iputils\", Version: \"20180629-1.el8\", Kind: claircore.SOURCE},",
          "651:    RepositoryHint: \"hash:sha256:89e074b2d8fe4e935a648edf0853354e728c1f42f7c5c8ffee24ad969fbfe085|key:05b555b38483c65d\",",
          "652:   },",
          "654:    Name:           \"libkcapi-hmaccalc\",",
          "655:    Version:        \"1.1.1-16_1.el8\",",
          "656:    Arch:           \"x86_64\",",
          "657:    Kind:           claircore.BINARY,",
          "658:    Source:         &claircore.Package{Name: \"libkcapi\", Version: \"1.1.1-16_1.el8\", Kind: claircore.SOURCE},",
          "660:    RepositoryHint: \"hash:sha256:1db37d679dbc3e413d5c785c69a02ff3db9df0d7a8ac8552ad728da4df5d4239|key:05b555b38483c65d\",",
          "661:   },",
          "663:    Name:           \"dracut\",",
          "664:    Version:        \"049-10.git20190115.el8\",",
          "665:    Arch:           \"x86_64\",",
          "666:    Kind:           claircore.BINARY,",
          "667:    Source:         &claircore.Package{Name: \"dracut\", Version: \"049-10.git20190115.el8\", Kind: claircore.SOURCE},",
          "669:    RepositoryHint: \"hash:sha256:a612253fab9c7daa22e13cdfe8b0bbebd03be5b6839206248c53bd5549b30da3|key:05b555b38483c65d\",",
          "670:   },",
          "672:    Name:           \"python3-libcomps\",",
          "673:    Version:        \"0.1.8-13.el8\",",
          "674:    Arch:           \"x86_64\",",
          "675:    Kind:           claircore.BINARY,",
          "676:    Source:         &claircore.Package{Name: \"libcomps\", Version: \"0.1.8-13.el8\", Kind: claircore.SOURCE},",
          "678:    RepositoryHint: \"hash:sha256:9ce8ebad74c1dd410e8d300f024a6cb43e1611fe447a02139c66f8a3db63710d|key:05b555b38483c65d\",",
          "679:   },",
          "681:    Name:           \"python3-iniparse\",",
          "682:    Version:        \"0.4-31.el8\",",
          "683:    Arch:           \"noarch\",",
          "684:    Kind:           claircore.BINARY,",
          "685:    Source:         &claircore.Package{Name: \"python-iniparse\", Version: \"0.4-31.el8\", Kind: claircore.SOURCE},",
          "687:    RepositoryHint: \"hash:sha256:8f54f5b9503c405dea9e8d55438d3d364e961bd4adc80942757f82b03614427e|key:05b555b38483c65d\",",
          "688:   },",
          "690:    Name:           \"dhcp-client\",",
          "691:    Version:        \"12:4.3.6-30.el8\",",
          "692:    Arch:           \"x86_64\",",
          "693:    Kind:           claircore.BINARY,",
          "694:    Source:         &claircore.Package{Name: \"dhcp\", Version: \"4.3.6-30.el8\", Kind: claircore.SOURCE},",
          "696:    RepositoryHint: \"hash:sha256:c50cefb76514f0e995490ce4998955b3b2323ca2de7f4f665de1b65d68a64386|key:05b555b38483c65d\",",
          "697:   },",
          "699:    Name:           \"cyrus-sasl-lib\",",
          "700:    Version:        \"2.1.27-0.3rc7.el8\",",
          "701:    Arch:           \"x86_64\",",
          "702:    Kind:           claircore.BINARY,",
          "703:    Source:         &claircore.Package{Name: \"cyrus-sasl\", Version: \"2.1.27-0.3rc7.el8\", Kind: claircore.SOURCE},",
          "705:    RepositoryHint: \"hash:sha256:cc76a7d3107fd59aab4997f9d72355ecb55a22b02d15154c7f752a6dcbac446d|key:05b555b38483c65d\",",
          "706:   },",
          "708:    Name:           \"libyaml\",",
          "709:    Version:        \"0.1.7-5.el8\",",
          "710:    Arch:           \"x86_64\",",
          "711:    Kind:           claircore.BINARY,",
          "712:    Source:         &claircore.Package{Name: \"libyaml\", Version: \"0.1.7-5.el8\", Kind: claircore.SOURCE},",
          "714:    RepositoryHint: \"hash:sha256:d7948b4fd90d0e92bcfd9e9f5fc9d2fd871259e528dbc594fdfb528e83f6f41d|key:05b555b38483c65d\",",
          "715:   },",
          "717:    Name:           \"npth\",",
          "718:    Version:        \"1.5-4.el8\",",
          "719:    Arch:           \"x86_64\",",
          "720:    Kind:           claircore.BINARY,",
          "721:    Source:         &claircore.Package{Name: \"npth\", Version: \"1.5-4.el8\", Kind: claircore.SOURCE},",
          "723:    RepositoryHint: \"hash:sha256:239d0769bf245c8714b159c9d1fb31618d86e85afdaca085ca7c145bcf81307c|key:05b555b38483c65d\",",
          "724:   },",
          "726:    Name:           \"gpgme\",",
          "727:    Version:        \"1.10.0-6.el8.0.1\",",
          "728:    Arch:           \"x86_64\",",
          "729:    Kind:           claircore.BINARY,",
          "730:    Source:         &claircore.Package{Name: \"gpgme\", Version: \"1.10.0-6.el8.0.1\", Kind: claircore.SOURCE},",
          "732:    RepositoryHint: \"hash:sha256:f56057290d8aace26d2142f45c55193d59d6ff93c2f25d3ea8751ced7c139518|key:05b555b38483c65d\",",
          "733:   },",
          "735:    Name:           \"libdnf\",",
          "736:    Version:        \"0.22.5-4.el8\",",
          "737:    Arch:           \"x86_64\",",
          "738:    Kind:           claircore.BINARY,",
          "739:    Source:         &claircore.Package{Name: \"libdnf\", Version: \"0.22.5-4.el8\", Kind: claircore.SOURCE},",
          "741:    RepositoryHint: \"hash:sha256:6a025ed38a3633e5f89c28d3fbc84d9dec0bb04549ae045ddd3728738032cb3a|key:05b555b38483c65d\",",
          "742:   },",
          "744:    Name:           \"python3-hawkey\",",
          "745:    Version:        \"0.22.5-4.el8\",",
          "746:    Arch:           \"x86_64\",",
          "747:    Kind:           claircore.BINARY,",
          "748:    Source:         &claircore.Package{Name: \"libdnf\", Version: \"0.22.5-4.el8\", Kind: claircore.SOURCE},",
          "750:    RepositoryHint: \"hash:sha256:d8ae3aa132427a2e26900d332c1993e249e23c584fb365d2e138e9913741359e|key:05b555b38483c65d\",",
          "751:   },",
          "753:    Name:           \"rpm-build-libs\",",
          "754:    Version:        \"4.14.2-9.el8\",",
          "755:    Arch:           \"x86_64\",",
          "756:    Kind:           claircore.BINARY,",
          "757:    Source:         &claircore.Package{Name: \"rpm\", Version: \"4.14.2-9.el8\", Kind: claircore.SOURCE},",
          "759:    RepositoryHint: \"hash:sha256:10937ed3ff0ccfc8ef1114cbb45160f559cbf055f0cd6668e151ba1ecdf6a077|key:05b555b38483c65d\",",
          "760:   },",
          "762:    Name:           \"python3-dnf\",",
          "763:    Version:        \"4.0.9.2-5.el8\",",
          "764:    Arch:           \"noarch\",",
          "765:    Kind:           claircore.BINARY,",
          "766:    Source:         &claircore.Package{Name: \"dnf\", Version: \"4.0.9.2-5.el8\", Kind: claircore.SOURCE},",
          "768:    RepositoryHint: \"hash:sha256:60b7ea649dcdb08af67e003a19074197a5a5226d6cd7189be14bd2437d3eba8e|key:05b555b38483c65d\",",
          "769:   },",
          "771:    Name:           \"yum\",",
          "772:    Version:        \"4.0.9.2-5.el8\",",
          "773:    Arch:           \"noarch\",",
          "774:    Kind:           claircore.BINARY,",
          "775:    Source:         &claircore.Package{Name: \"dnf\", Version: \"4.0.9.2-5.el8\", Kind: claircore.SOURCE},",
          "777:    RepositoryHint: \"hash:sha256:edcce9280e083d452153361916428af9987ad521b14d744ed8af455e796db5c3|key:05b555b38483c65d\",",
          "778:   },",
          "780:    Name:           \"binutils\",",
          "781:    Version:        \"2.30-49.el8\",",
          "782:    Arch:           \"x86_64\",",
          "783:    Kind:           claircore.BINARY,",
          "784:    Source:         &claircore.Package{Name: \"binutils\", Version: \"2.30-49.el8\", Kind: claircore.SOURCE},",
          "786:    RepositoryHint: \"hash:sha256:352f73bb853581e9037bd4cffb67e81a35d2453610d60eb18c4293f212fc01e2|key:05b555b38483c65d\",",
          "787:   },",
          "789:    Name:           \"vim-minimal\",",
          "790:    Version:        \"2:8.0.1763-10.el8\",",
          "791:    Arch:           \"x86_64\",",
          "792:    Kind:           claircore.BINARY,",
          "793:    Source:         &claircore.Package{Name: \"vim\", Version: \"8.0.1763-10.el8\", Kind: claircore.SOURCE},",
          "795:    RepositoryHint: \"hash:sha256:27cef2a26cbe4b678aa716df3ffcd12af8a60dbfc91b5f17b0257bc12f26ae8c|key:05b555b38483c65d\",",
          "796:   },",
          "798:    Name:           \"less\",",
          "799:    Version:        \"530-1.el8\",",
          "800:    Arch:           \"x86_64\",",
          "801:    Kind:           claircore.BINARY,",
          "802:    Source:         &claircore.Package{Name: \"less\", Version: \"530-1.el8\", Kind: claircore.SOURCE},",
          "804:    RepositoryHint: \"hash:sha256:bb2e5b9746e4f479ebcc5d3c10fe8ecfd3aa74ee2e0a18b0c3375b221592d59a|key:05b555b38483c65d\",",
          "805:   },",
          "807:    Name:           \"rootfiles\",",
          "808:    Version:        \"8.1-22.el8\",",
          "809:    Arch:           \"noarch\",",
          "810:    Kind:           claircore.BINARY,",
          "811:    Source:         &claircore.Package{Name: \"rootfiles\", Version: \"8.1-22.el8\", Kind: claircore.SOURCE},",
          "813:    RepositoryHint: \"hash:sha256:2a98466dc0e09984721d45c869a18d77a8914602e16e070b294b28d4632385c7|key:05b555b38483c65d\",",
          "814:   },",
          "816:    Name:           \"libgcc\",",
          "817:    Version:        \"8.2.1-3.5.el8\",",
          "818:    Arch:           \"x86_64\",",
          "819:    Kind:           claircore.BINARY,",
          "820:    Source:         &claircore.Package{Name: \"gcc\", Version: \"8.2.1-3.5.el8\", Kind: claircore.SOURCE},",
          "822:    RepositoryHint: \"hash:sha256:847423825bfc1689f71dacfddc03a1da120090816358eb08cfed0d5aa2bb4cfa|key:05b555b38483c65d\",",
          "823:   },",
          "825:    Name:           \"pkgconf-m4\",",
          "826:    Version:        \"1.4.2-1.el8\",",
          "827:    Arch:           \"noarch\",",
          "828:    Kind:           claircore.BINARY,",
          "829:    Source:         &claircore.Package{Name: \"pkgconf\", Version: \"1.4.2-1.el8\", Kind: claircore.SOURCE},",
          "831:    RepositoryHint: \"hash:sha256:7e4935774062919285cf636e45243330e3c34b818bc5723c53ea7659e6eb9068|key:05b555b38483c65d\",",
          "832:   },",
          "834:    Name:           \"libreport-filesystem\",",
          "835:    Version:        \"2.9.5-6.el8\",",
          "836:    Arch:           \"x86_64\",",
          "837:    Kind:           claircore.BINARY,",
          "838:    Source:         &claircore.Package{Name: \"libreport\", Version: \"2.9.5-6.el8\", Kind: claircore.SOURCE},",
          "840:    RepositoryHint: \"hash:sha256:4139659800d97238058035061cb9621c82756a62c41651c4a690fa865d1a3f2b|key:05b555b38483c65d\",",
          "841:   },",
          "843:    Name:           \"dhcp-common\",",
          "844:    Version:        \"12:4.3.6-30.el8\",",
          "845:    Arch:           \"noarch\",",
          "846:    Kind:           claircore.BINARY,",
          "847:    Source:         &claircore.Package{Name: \"dhcp\", Version: \"4.3.6-30.el8\", Kind: claircore.SOURCE},",
          "849:    RepositoryHint: \"hash:sha256:320f84bfbf31a518c3763485e5fc2d8dc3853ed9e06737343bb0b7714cc81f48|key:05b555b38483c65d\",",
          "850:   },",
          "852:    Name:           \"centos-release\",",
          "853:    Version:        \"8.0-0.1905.0.9.el8\",",
          "854:    Arch:           \"x86_64\",",
          "855:    Kind:           claircore.BINARY,",
          "856:    Source:         &claircore.Package{Name: \"centos-release\", Version: \"8.0-0.1905.0.9.el8\", Kind: claircore.SOURCE},",
          "858:    RepositoryHint: \"hash:sha256:fe84e3755fc24a31e60dd8d5d3e910ecf01683bd266ef63e3b45c7f7c6d7c196|key:05b555b38483c65d\",",
          "859:   },",
          "861:    Name:           \"filesystem\",",
          "862:    Version:        \"3.8-2.el8\",",
          "863:    Arch:           \"x86_64\",",
          "864:    Kind:           claircore.BINARY,",
          "865:    Source:         &claircore.Package{Name: \"filesystem\", Version: \"3.8-2.el8\", Kind: claircore.SOURCE},",
          "867:    RepositoryHint: \"hash:sha256:28d85a65f1cea65de75a2cc90a1027dfc6745dcfc0f0568fc9a8502230f2a2fd|key:05b555b38483c65d\",",
          "868:   },",
          "870:    Name:           \"pcre2\",",
          "871:    Version:        \"10.32-1.el8\",",
          "872:    Arch:           \"x86_64\",",
          "873:    Kind:           claircore.BINARY,",
          "874:    Source:         &claircore.Package{Name: \"pcre2\", Version: \"10.32-1.el8\", Kind: claircore.SOURCE},",
          "876:    RepositoryHint: \"hash:sha256:d14d99ac7f78178d0307273296c5a121ac62aa4f4160c328d697ae80014c7d91|key:05b555b38483c65d\",",
          "877:   },",
          "879:    Name:           \"ncurses-libs\",",
          "880:    Version:        \"6.1-7.20180224.el8\",",
          "881:    Arch:           \"x86_64\",",
          "882:    Kind:           claircore.BINARY,",
          "883:    Source:         &claircore.Package{Name: \"ncurses\", Version: \"6.1-7.20180224.el8\", Kind: claircore.SOURCE},",
          "885:    RepositoryHint: \"hash:sha256:973c3259be26361f886c5e87e6e88230b54e24111d30d2d34149fd16946480ee|key:05b555b38483c65d\",",
          "886:   },",
          "888:    Name:           \"glibc-common\",",
          "889:    Version:        \"2.28-42.el8.1\",",
          "890:    Arch:           \"x86_64\",",
          "891:    Kind:           claircore.BINARY,",
          "892:    Source:         &claircore.Package{Name: \"glibc\", Version: \"2.28-42.el8.1\", Kind: claircore.SOURCE},",
          "894:    RepositoryHint: \"hash:sha256:12cd1a5700218c9f54bb43b7833c8fa0105fd12eb156da7ad53495b7d362ff4a|key:05b555b38483c65d\",",
          "895:   },",
          "897:    Name:           \"bash\",",
          "898:    Version:        \"4.4.19-7.el8\",",
          "899:    Arch:           \"x86_64\",",
          "900:    Kind:           claircore.BINARY,",
          "901:    Source:         &claircore.Package{Name: \"bash\", Version: \"4.4.19-7.el8\", Kind: claircore.SOURCE},",
          "903:    RepositoryHint: \"hash:sha256:b4c385ed5f03c511ea189937cca0806f2b72e62e6e55b2c7f58b927b8f09ebf9|key:05b555b38483c65d\",",
          "904:   },",
          "906:    Name:           \"zlib\",",
          "907:    Version:        \"1.2.11-10.el8\",",
          "908:    Arch:           \"x86_64\",",
          "909:    Kind:           claircore.BINARY,",
          "910:    Source:         &claircore.Package{Name: \"zlib\", Version: \"1.2.11-10.el8\", Kind: claircore.SOURCE},",
          "912:    RepositoryHint: \"hash:sha256:294731059e720f86656d3dce46a700dfca01a4ac861f8cf42e80eb7dc15c95ae|key:05b555b38483c65d\",",
          "913:   },",
          "915:    Name:           \"bzip2-libs\",",
          "916:    Version:        \"1.0.6-26.el8\",",
          "917:    Arch:           \"x86_64\",",
          "918:    Kind:           claircore.BINARY,",
          "919:    Source:         &claircore.Package{Name: \"bzip2\", Version: \"1.0.6-26.el8\", Kind: claircore.SOURCE},",
          "921:    RepositoryHint: \"hash:sha256:47c78745b26ed5be27eb31c3f2603f5b9572fb3801799acab06a2dbbc510dbcb|key:05b555b38483c65d\",",
          "922:   },",
          "924:    Name:           \"info\",",
          "925:    Version:        \"6.5-4.el8\",",
          "926:    Arch:           \"x86_64\",",
          "927:    Kind:           claircore.BINARY,",
          "928:    Source:         &claircore.Package{Name: \"texinfo\", Version: \"6.5-4.el8\", Kind: claircore.SOURCE},",
          "930:    RepositoryHint: \"hash:sha256:211d7e76cdffb417db117ca3d10abc9ecd3e60132c928cd5bb4440a2f6db14bb|key:05b555b38483c65d\",",
          "931:   },",
          "933:    Name:           \"elfutils-libelf\",",
          "934:    Version:        \"0.174-6.el8\",",
          "935:    Arch:           \"x86_64\",",
          "936:    Kind:           claircore.BINARY,",
          "937:    Source:         &claircore.Package{Name: \"elfutils\", Version: \"0.174-6.el8\", Kind: claircore.SOURCE},",
          "939:    RepositoryHint: \"hash:sha256:2287da8c39b3bd442ef8637a4acefbf3d4a6a3249d57145866334710d1f7188b|key:05b555b38483c65d\",",
          "940:   },",
          "942:    Name:           \"libxcrypt\",",
          "943:    Version:        \"4.1.1-4.el8\",",
          "944:    Arch:           \"x86_64\",",
          "945:    Kind:           claircore.BINARY,",
          "946:    Source:         &claircore.Package{Name: \"libxcrypt\", Version: \"4.1.1-4.el8\", Kind: claircore.SOURCE},",
          "948:    RepositoryHint: \"hash:sha256:4824a32a4a9b5d154f7ca7bf808012eecd70e1bebe249aec064b0121a54e3d8d|key:05b555b38483c65d\",",
          "949:   },",
          "951:    Name:           \"sqlite-libs\",",
          "952:    Version:        \"3.26.0-3.el8\",",
          "953:    Arch:           \"x86_64\",",
          "954:    Kind:           claircore.BINARY,",
          "955:    Source:         &claircore.Package{Name: \"sqlite\", Version: \"3.26.0-3.el8\", Kind: claircore.SOURCE},",
          "957:    RepositoryHint: \"hash:sha256:3330aeb4246959fa47ae7ca7b853f419ac33b9039bc1b9f2cc68afcbc57f4a64|key:05b555b38483c65d\",",
          "958:   },",
          "960:    Name:           \"libstdc++\",",
          "961:    Version:        \"8.2.1-3.5.el8\",",
          "962:    Arch:           \"x86_64\",",
          "963:    Kind:           claircore.BINARY,",
          "964:    Source:         &claircore.Package{Name: \"gcc\", Version: \"8.2.1-3.5.el8\", Kind: claircore.SOURCE},",
          "966:    RepositoryHint: \"hash:sha256:d3f35907911a5556f5ba1f5eb6b326051f13e2bb9c608729b59a53a4d05002a5|key:05b555b38483c65d\",",
          "967:   },",
          "969:    Name:           \"popt\",",
          "970:    Version:        \"1.16-14.el8\",",
          "971:    Arch:           \"x86_64\",",
          "972:    Kind:           claircore.BINARY,",
          "973:    Source:         &claircore.Package{Name: \"popt\", Version: \"1.16-14.el8\", Kind: claircore.SOURCE},",
          "975:    RepositoryHint: \"hash:sha256:f4e07c1baa0a68c09bac8b913b7851b8595d6d33bacd53534127d6f56760707e|key:05b555b38483c65d\",",
          "976:   },",
          "978:    Name:           \"readline\",",
          "979:    Version:        \"7.0-10.el8\",",
          "980:    Arch:           \"x86_64\",",
          "981:    Kind:           claircore.BINARY,",
          "982:    Source:         &claircore.Package{Name: \"readline\", Version: \"7.0-10.el8\", Kind: claircore.SOURCE},",
          "984:    RepositoryHint: \"hash:sha256:fc00ff55f5026585d089ef1b6c6226e0ce1b60da8b6cd75e19b6b61e499f7f4a|key:05b555b38483c65d\",",
          "985:   },",
          "987:    Name:           \"json-c\",",
          "988:    Version:        \"0.13.1-0.2.el8\",",
          "989:    Arch:           \"x86_64\",",
          "990:    Kind:           claircore.BINARY,",
          "991:    Source:         &claircore.Package{Name: \"json-c\", Version: \"0.13.1-0.2.el8\", Kind: claircore.SOURCE},",
          "993:    RepositoryHint: \"hash:sha256:17835daff24726949b52b534bb294ea014fec5ad3398704aa142d4a54e0e684c|key:05b555b38483c65d\",",
          "994:   },",
          "996:    Name:           \"libacl\",",
          "997:    Version:        \"2.2.53-1.el8\",",
          "998:    Arch:           \"x86_64\",",
          "999:    Kind:           claircore.BINARY,",
          "1000:    Source:         &claircore.Package{Name: \"acl\", Version: \"2.2.53-1.el8\", Kind: claircore.SOURCE},",
          "1002:    RepositoryHint: \"hash:sha256:8e89edde49807da4391927c04fe5236a0da7d36e7437002386fedda1f5a4e527|key:05b555b38483c65d\",",
          "1003:   },",
          "1005:    Name:           \"sed\",",
          "1006:    Version:        \"4.5-1.el8\",",
          "1007:    Arch:           \"x86_64\",",
          "1008:    Kind:           claircore.BINARY,",
          "1009:    Source:         &claircore.Package{Name: \"sed\", Version: \"4.5-1.el8\", Kind: claircore.SOURCE},",
          "1011:    RepositoryHint: \"hash:sha256:682b016c8b5a80d4f797d4c9f1b74357f42b8b0fc382c76c35407345aba8f35e|key:05b555b38483c65d\",",
          "1012:   },",
          "1014:    Name:           \"libmount\",",
          "1015:    Version:        \"2.32.1-8.el8\",",
          "1016:    Arch:           \"x86_64\",",
          "1017:    Kind:           claircore.BINARY,",
          "1018:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "1020:    RepositoryHint: \"hash:sha256:25229bfc1bdf1e5d00600719813ec431805349db57fa3288a61cf2f4109582c5|key:05b555b38483c65d\",",
          "1021:   },",
          "1023:    Name:           \"audit-libs\",",
          "1024:    Version:        \"3.0-0.10.20180831git0047a6c.el8\",",
          "1025:    Arch:           \"x86_64\",",
          "1026:    Kind:           claircore.BINARY,",
          "1027:    Source:         &claircore.Package{Name: \"audit\", Version: \"3.0-0.10.20180831git0047a6c.el8\", Kind: claircore.SOURCE},",
          "1029:    RepositoryHint: \"hash:sha256:d84a722fba1d9be6626c5df380b7139a17e019382b133bf77de9527321334ea4|key:05b555b38483c65d\",",
          "1030:   },",
          "1032:    Name:           \"libsmartcols\",",
          "1033:    Version:        \"2.32.1-8.el8\",",
          "1034:    Arch:           \"x86_64\",",
          "1035:    Kind:           claircore.BINARY,",
          "1036:    Source:         &claircore.Package{Name: \"util-linux\", Version: \"2.32.1-8.el8\", Kind: claircore.SOURCE},",
          "1038:    RepositoryHint: \"hash:sha256:e318db8fdde219b303b17a47696d3e15762006e1b3a9fda56e8f70aba831b104|key:05b555b38483c65d\",",
          "1039:   },",
          "1041:    Name:           \"lz4-libs\",",
          "1042:    Version:        \"1.8.1.2-4.el8\",",
          "1043:    Arch:           \"x86_64\",",
          "1044:    Kind:           claircore.BINARY,",
          "1045:    Source:         &claircore.Package{Name: \"lz4\", Version: \"1.8.1.2-4.el8\", Kind: claircore.SOURCE},",
          "1047:    RepositoryHint: \"hash:sha256:9b61743ad828418c11cf6cc5df84ffe33df8029cbf66dd4201fd807d577e79b2|key:05b555b38483c65d\",",
          "1048:   },",
          "1050:    Name:           \"libgcrypt\",",
          "1051:    Version:        \"1.8.3-2.el8\",",
          "1052:    Arch:           \"x86_64\",",
          "1053:    Kind:           claircore.BINARY,",
          "1054:    Source:         &claircore.Package{Name: \"libgcrypt\", Version: \"1.8.3-2.el8\", Kind: claircore.SOURCE},",
          "1056:    RepositoryHint: \"hash:sha256:b018ee0c3c9c7cd43eb12fe8d9f1d87e895e3edc17dd14bbbba4ce952b405c90|key:05b555b38483c65d\",",
          "1057:   },",
          "1059:    Name:           \"cracklib\",",
          "1060:    Version:        \"2.9.6-15.el8\",",
          "1061:    Arch:           \"x86_64\",",
          "1062:    Kind:           claircore.BINARY,",
          "1063:    Source:         &claircore.Package{Name: \"cracklib\", Version: \"2.9.6-15.el8\", Kind: claircore.SOURCE},",
          "1065:    RepositoryHint: \"hash:sha256:fd0ef8f701b21567253a6fb60fa62ba4613861f2b8cdbdb86c3d1ff9fbc4efff|key:05b555b38483c65d\",",
          "1066:   },",
          "1068:    Name:           \"libunistring\",",
          "1069:    Version:        \"0.9.9-3.el8\",",
          "1070:    Arch:           \"x86_64\",",
          "1071:    Kind:           claircore.BINARY,",
          "1072:    Source:         &claircore.Package{Name: \"libunistring\", Version: \"0.9.9-3.el8\", Kind: claircore.SOURCE},",
          "1074:    RepositoryHint: \"hash:sha256:6cfbea1d92f367e7c123690b5f85787c197449eadcb9f1125bfa563e66c00959|key:05b555b38483c65d\",",
          "1075:   },",
          "1077:    Name:           \"file-libs\",",
          "1078:    Version:        \"5.33-8.el8\",",
          "1079:    Arch:           \"x86_64\",",
          "1080:    Kind:           claircore.BINARY,",
          "1081:    Source:         &claircore.Package{Name: \"file\", Version: \"5.33-8.el8\", Kind: claircore.SOURCE},",
          "1083:    RepositoryHint: \"hash:sha256:4cc51b1e501ecc26f44d35edb9339dfd244e2d3f69e6461380d35f3e0c60b431|key:05b555b38483c65d\",",
          "1084:   },",
          "1086:    Name:           \"keyutils-libs\",",
          "1087:    Version:        \"1.5.10-6.el8\",",
          "1088:    Arch:           \"x86_64\",",
          "1089:    Kind:           claircore.BINARY,",
          "1090:    Source:         &claircore.Package{Name: \"keyutils\", Version: \"1.5.10-6.el8\", Kind: claircore.SOURCE},",
          "1092:    RepositoryHint: \"hash:sha256:abae45bc135c128d35073e3ace81da43505ef991d41e9cfa903bbb7ca0322fd1|key:05b555b38483c65d\",",
          "1093:   },",
          "1095:    Name:           \"p11-kit-trust\",",
          "1096:    Version:        \"0.23.14-4.el8\",",
          "1097:    Arch:           \"x86_64\",",
          "1098:    Kind:           claircore.BINARY,",
          "1099:    Source:         &claircore.Package{Name: \"p11-kit\", Version: \"0.23.14-4.el8\", Kind: claircore.SOURCE},",
          "1101:    RepositoryHint: \"hash:sha256:3f93570de11b5bdc1620b49a6e70b4792deff2bc7f1f2a1da595bb92930553d4|key:05b555b38483c65d\",",
          "1102:   },",
          "1104:    Name:           \"pcre\",",
          "1105:    Version:        \"8.42-4.el8\",",
          "1106:    Arch:           \"x86_64\",",
          "1107:    Kind:           claircore.BINARY,",
          "1108:    Source:         &claircore.Package{Name: \"pcre\", Version: \"8.42-4.el8\", Kind: claircore.SOURCE},",
          "1110:    RepositoryHint: \"hash:sha256:822a78f1a57b439511d3edd2d943f51f0393e6cb6713bc4a8cca994326f360ac|key:05b555b38483c65d\",",
          "1111:   },",
          "1113:    Name:           \"systemd-libs\",",
          "1114:    Version:        \"239-13.el8\",",
          "1115:    Arch:           \"x86_64\",",
          "1116:    Kind:           claircore.BINARY,",
          "1117:    Source:         &claircore.Package{Name: \"systemd\", Version: \"239-13.el8\", Kind: claircore.SOURCE},",
          "1119:    RepositoryHint: \"hash:sha256:3026b57c21d436ee69d56c0d6cb3ead0b2efb383f5000e5da35221f34ac387b8|key:05b555b38483c65d\",",
          "1120:   },",
          "1122:    Name:           \"crypto-policies\",",
          "1123:    Version:        \"20181217-6.git9a35207.el8\",",
          "1124:    Arch:           \"noarch\",",
          "1125:    Kind:           claircore.BINARY,",
          "1126:    Source:         &claircore.Package{Name: \"crypto-policies\", Version: \"20181217-6.git9a35207.el8\", Kind: claircore.SOURCE},",
          "1128:    RepositoryHint: \"hash:sha256:41950f001f00292a7a46f668ec915de747b9b00fb2cb90c37ce37424f082028f|key:05b555b38483c65d\",",
          "1129:   },",
          "1131:    Name:           \"ca-certificates\",",
          "1132:    Version:        \"2018.2.24-6.el8\",",
          "1133:    Arch:           \"noarch\",",
          "1134:    Kind:           claircore.BINARY,",
          "1135:    Source:         &claircore.Package{Name: \"ca-certificates\", Version: \"2018.2.24-6.el8\", Kind: claircore.SOURCE},",
          "1137:    RepositoryHint: \"hash:sha256:a3778bda947716315a2aa5fdb3dba7358d507d9d910ae509e1a90178884b831f|key:05b555b38483c65d\",",
          "1138:   },",
          "1140:    Name:           \"libdb\",",
          "1141:    Version:        \"5.3.28-36.el8\",",
          "1142:    Arch:           \"x86_64\",",
          "1143:    Kind:           claircore.BINARY,",
          "1144:    Source:         &claircore.Package{Name: \"libdb\", Version: \"5.3.28-36.el8\", Kind: claircore.SOURCE},",
          "1146:    RepositoryHint: \"hash:sha256:2bde2c8d9a7a826a3c675e898096ff694d0f0daf1ff2c0198c4b48df3b1a62df|key:05b555b38483c65d\",",
          "1147:   },",
          "1149:    Name:           \"ima-evm-utils\",",
          "1150:    Version:        \"1.1-4.el8\",",
          "1151:    Arch:           \"x86_64\",",
          "1152:    Kind:           claircore.BINARY,",
          "1153:    Source:         &claircore.Package{Name: \"ima-evm-utils\", Version: \"1.1-4.el8\", Kind: claircore.SOURCE},",
          "1155:    RepositoryHint: \"hash:sha256:5507d55b18ed310c90a7ba3397210efdd19b7036dfa7aeaf335fa9bf7c714bea|key:05b555b38483c65d\",",
          "1156:   },",
          "1158:    Name:           \"libdb-utils\",",
          "1159:    Version:        \"5.3.28-36.el8\",",
          "1160:    Arch:           \"x86_64\",",
          "1161:    Kind:           claircore.BINARY,",
          "1162:    Source:         &claircore.Package{Name: \"libdb\", Version: \"5.3.28-36.el8\", Kind: claircore.SOURCE},",
          "1164:    RepositoryHint: \"hash:sha256:7c11e7a417437b36c80d7e6df1c87d0aca248dbd3fbe054418522d737e462165|key:05b555b38483c65d\",",
          "1165:   },",
          "1167:    Name:           \"dbus-tools\",",
          "1168:    Version:        \"1:1.12.8-7.el8\",",
          "1169:    Arch:           \"x86_64\",",
          "1170:    Kind:           claircore.BINARY,",
          "1171:    Source:         &claircore.Package{Name: \"dbus\", Version: \"1.12.8-7.el8\", Kind: claircore.SOURCE},",
          "1173:    RepositoryHint: \"hash:sha256:2385478eb665b11efcc60ee45ab4a4e1d4836f4263142bad1733f6301b9e2130|key:05b555b38483c65d\",",
          "1174:   },",
          "1176:    Name:           \"libusbx\",",
          "1177:    Version:        \"1.0.22-1.el8\",",
          "1178:    Arch:           \"x86_64\",",
          "1179:    Kind:           claircore.BINARY,",
          "1180:    Source:         &claircore.Package{Name: \"libusbx\", Version: \"1.0.22-1.el8\", Kind: claircore.SOURCE},",
          "1182:    RepositoryHint: \"hash:sha256:60c7ca280fc3b6d01fca78bcc74fed36fc249cbd095c1e5b12c44a970bb14f41|key:05b555b38483c65d\",",
          "1183:   },",
          "1185:    Name:           \"xz\",",
          "1186:    Version:        \"5.2.4-3.el8\",",
          "1187:    Arch:           \"x86_64\",",
          "1188:    Kind:           claircore.BINARY,",
          "1189:    Source:         &claircore.Package{Name: \"xz\", Version: \"5.2.4-3.el8\", Kind: claircore.SOURCE},",
          "1191:    RepositoryHint: \"hash:sha256:26e73b37d5e13d2e80c7eb6c52bd662538059d89f3b4b73a13a019467496991d|key:05b555b38483c65d\",",
          "1192:   },",
          "1194:    Name:           \"gdbm\",",
          "1195:    Version:        \"1:1.18-1.el8\",",
          "1196:    Arch:           \"x86_64\",",
          "1197:    Kind:           claircore.BINARY,",
          "1198:    Source:         &claircore.Package{Name: \"gdbm\", Version: \"1.18-1.el8\", Kind: claircore.SOURCE},",
          "1200:    RepositoryHint: \"hash:sha256:38a0a084c7d171b9f00ca5fa33126cf60606af87996dc7dfdae578078df065e2|key:05b555b38483c65d\",",
          "1201:   },",
          "1203:    Name:           \"shadow-utils\",",
          "1204:    Version:        \"2:4.6-7.el8\",",
          "1205:    Arch:           \"x86_64\",",
          "1206:    Kind:           claircore.BINARY,",
          "1207:    Source:         &claircore.Package{Name: \"shadow-utils\", Version: \"4.6-7.el8\", Kind: claircore.SOURCE},",
          "1209:    RepositoryHint: \"hash:sha256:0c67edd6e2020b5393a377026ba914276d6cac44c7ebc01dd83d72bc59100a52|key:05b555b38483c65d\",",
          "1210:   },",
          "1212:    Name:           \"libutempter\",",
          "1213:    Version:        \"1.1.6-14.el8\",",
          "1214:    Arch:           \"x86_64\",",
          "1215:    Kind:           claircore.BINARY,",
          "1216:    Source:         &claircore.Package{Name: \"libutempter\", Version: \"1.1.6-14.el8\", Kind: claircore.SOURCE},",
          "1218:    RepositoryHint: \"hash:sha256:de4deec2a205db42de5d15899ed3fa75b2c0a68fcce053ebfb488262c38c1272|key:05b555b38483c65d\",",
          "1219:   },",
          "1221:    Name:           \"acl\",",
          "1222:    Version:        \"2.2.53-1.el8\",",
          "1223:    Arch:           \"x86_64\",",
          "1224:    Kind:           claircore.BINARY,",
          "1225:    Source:         &claircore.Package{Name: \"acl\", Version: \"2.2.53-1.el8\", Kind: claircore.SOURCE},",
          "1227:    RepositoryHint: \"hash:sha256:65af1230ea97986fe3e79a8381ab7deea40fd9073dc380e58e1070b954912297|key:05b555b38483c65d\",",
          "1228:   },",
          "1230:    Name:           \"nettle\",",
          "1231:    Version:        \"3.4.1-1.el8\",",
          "1232:    Arch:           \"x86_64\",",
          "1233:    Kind:           claircore.BINARY,",
          "1234:    Source:         &claircore.Package{Name: \"nettle\", Version: \"3.4.1-1.el8\", Kind: claircore.SOURCE},",
          "1236:    RepositoryHint: \"hash:sha256:2e9fc253e3b189524c710e32784dee974f8d68e00cc13f5cd376f72c3c507a37|key:05b555b38483c65d\",",
          "1237:   },",
          "1239:    Name:           \"snappy\",",
          "1240:    Version:        \"1.1.7-5.el8\",",
          "1241:    Arch:           \"x86_64\",",
          "1242:    Kind:           claircore.BINARY,",
          "1243:    Source:         &claircore.Package{Name: \"snappy\", Version: \"1.1.7-5.el8\", Kind: claircore.SOURCE},",
          "1245:    RepositoryHint: \"hash:sha256:7a5daa20e22e94cc46f956a90d1d8b425bcc934eefb6c5a08a3840df28c17e20|key:05b555b38483c65d\",",
          "1246:   },",
          "1248:    Name:           \"libmetalink\",",
          "1249:    Version:        \"0.1.3-7.el8\",",
          "1250:    Arch:           \"x86_64\",",
          "1251:    Kind:           claircore.BINARY,",
          "1252:    Source:         &claircore.Package{Name: \"libmetalink\", Version: \"0.1.3-7.el8\", Kind: claircore.SOURCE},",
          "1254:    RepositoryHint: \"hash:sha256:a18613c99fa5c0c718cb4e16023331047de8f1e050388c48bcc1ff07d77ee074|key:05b555b38483c65d\",",
          "1255:   },",
          "1257:    Name:           \"findutils\",",
          "1258:    Version:        \"1:4.6.0-20.el8\",",
          "1259:    Arch:           \"x86_64\",",
          "1260:    Kind:           claircore.BINARY,",
          "1261:    Source:         &claircore.Package{Name: \"findutils\", Version: \"4.6.0-20.el8\", Kind: claircore.SOURCE},",
          "1263:    RepositoryHint: \"hash:sha256:d81c8b387d276fd99bf90d58db3c06b4385f93051d6cf66b3d7b1cc04458d94f|key:05b555b38483c65d\",",
          "1264:   },",
          "1266:    Name:           \"ethtool\",",
          "1267:    Version:        \"2:4.16-1.el8\",",
          "1268:    Arch:           \"x86_64\",",
          "1269:    Kind:           claircore.BINARY,",
          "1270:    Source:         &claircore.Package{Name: \"ethtool\", Version: \"4.16-1.el8\", Kind: claircore.SOURCE},",
          "1272:    RepositoryHint: \"hash:sha256:959880aa8d1418eefe9de0d504f0e6843e2c2998c0194816713b2678d132de23|key:05b555b38483c65d\",",
          "1273:   },",
          "1275:    Name:           \"libmnl\",",
          "1276:    Version:        \"1.0.4-6.el8\",",
          "1277:    Arch:           \"x86_64\",",
          "1278:    Kind:           claircore.BINARY,",
          "1279:    Source:         &claircore.Package{Name: \"libmnl\", Version: \"1.0.4-6.el8\", Kind: claircore.SOURCE},",
          "1281:    RepositoryHint: \"hash:sha256:481d76ead6bd438882cd12e4cddeb086a386dec5886055e85cfb78fda081fe29|key:05b555b38483c65d\",",
          "1282:   },",
          "1284:    Name:           \"libnghttp2\",",
          "1285:    Version:        \"1.33.0-1.el8\",",
          "1286:    Arch:           \"x86_64\",",
          "1287:    Kind:           claircore.BINARY,",
          "1288:    Source:         &claircore.Package{Name: \"nghttp2\", Version: \"1.33.0-1.el8\", Kind: claircore.SOURCE},",
          "1290:    RepositoryHint: \"hash:sha256:cca0b5ec230d1a27453a8d85176d5c9c00e7604269339b1dc1b912a8b90aee97|key:05b555b38483c65d\",",
          "1291:   },",
          "1293:    Name:           \"pkgconf\",",
          "1294:    Version:        \"1.4.2-1.el8\",",
          "1295:    Arch:           \"x86_64\",",
          "1296:    Kind:           claircore.BINARY,",
          "1297:    Source:         &claircore.Package{Name: \"pkgconf\", Version: \"1.4.2-1.el8\", Kind: claircore.SOURCE},",
          "1299:    RepositoryHint: \"hash:sha256:7a4067f2f48fa82bff14356d601702e226cdd0246e2ff1953d8fde384457846c|key:05b555b38483c65d\",",
          "1300:   },",
          "1302:    Name:           \"libpcap\",",
          "1303:    Version:        \"14:1.9.0-1.el8\",",
          "1304:    Arch:           \"x86_64\",",
          "1305:    Kind:           claircore.BINARY,",
          "1306:    Source:         &claircore.Package{Name: \"libpcap\", Version: \"1.9.0-1.el8\", Kind: claircore.SOURCE},",
          "1308:    RepositoryHint: \"hash:sha256:d0442eca6382626563cf35b783b5f41cc666426e4d9ff6741a1a2ae54ec51079|key:05b555b38483c65d\",",
          "1309:   },",
          "1311:    Name:           \"libseccomp\",",
          "1312:    Version:        \"2.3.3-3.el8\",",
          "1313:    Arch:           \"x86_64\",",
          "1314:    Kind:           claircore.BINARY,",
          "1315:    Source:         &claircore.Package{Name: \"libseccomp\", Version: \"2.3.3-3.el8\", Kind: claircore.SOURCE},",
          "1317:    RepositoryHint: \"hash:sha256:3e8ef42392e684455ed7c63500c296268dc6500bc86b35b57c9d21873b214bdc|key:05b555b38483c65d\",",
          "1318:   },",
          "1320:    Name:           \"gawk\",",
          "1321:    Version:        \"4.2.1-1.el8\",",
          "1322:    Arch:           \"x86_64\",",
          "1323:    Kind:           claircore.BINARY,",
          "1324:    Source:         &claircore.Package{Name: \"gawk\", Version: \"4.2.1-1.el8\", Kind: claircore.SOURCE},",
          "1326:    RepositoryHint: \"hash:sha256:63b029da02286255977312a750ece107b8f28a29df9d0f85de2bbd18d9928498|key:05b555b38483c65d\",",
          "1327:   },",
          "1329:    Name:           \"krb5-libs\",",
          "1330:    Version:        \"1.16.1-22.el8\",",
          "1331:    Arch:           \"x86_64\",",
          "1332:    Kind:           claircore.BINARY,",
          "1333:    Source:         &claircore.Package{Name: \"krb5\", Version: \"1.16.1-22.el8\", Kind: claircore.SOURCE},",
          "1335:    RepositoryHint: \"hash:sha256:cbcc23ff27479b930f74c47c4da9e426106adc4439526f00d2100df131d389b8|key:05b555b38483c65d\",",
          "1336:   },",
          "1338:    Name:           \"libnsl2\",",
          "1339:    Version:        \"1.2.0-2.20180605git4a062cf.el8\",",
          "1340:    Arch:           \"x86_64\",",
          "1341:    Kind:           claircore.BINARY,",
          "1342:    Source:         &claircore.Package{Name: \"libnsl2\", Version: \"1.2.0-2.20180605git4a062cf.el8\", Kind: claircore.SOURCE},",
          "1344:    RepositoryHint: \"hash:sha256:8ea76352c8e248f3c26b773d9de3a160960e6a6fb76ddb8583175a2227d516ef|key:05b555b38483c65d\",",
          "1345:   },",
          "1347:    Name:           \"platform-python-setuptools\",",
          "1348:    Version:        \"39.2.0-4.el8\",",
          "1349:    Arch:           \"noarch\",",
          "1350:    Kind:           claircore.BINARY,",
          "1351:    Source:         &claircore.Package{Name: \"python-setuptools\", Version: \"39.2.0-4.el8\", Kind: claircore.SOURCE},",
          "1353:    RepositoryHint: \"hash:sha256:bf1f60991ba170187ce0a8a0742c4c656613886777e04ebe88d4077516eafcdd|key:05b555b38483c65d\",",
          "1354:   },",
          "1356:    Name:           \"python3-libs\",",
          "1357:    Version:        \"3.6.8-1.el8.0.1\",",
          "1358:    Arch:           \"x86_64\",",
          "1359:    Kind:           claircore.BINARY,",
          "1360:    Source:         &claircore.Package{Name: \"python3\", Version: \"3.6.8-1.el8.0.1\", Kind: claircore.SOURCE},",
          "1362:    RepositoryHint: \"hash:sha256:6b878c69858ac7b1da44c91dc7dd25c857c9085d636fbbc96dd0fdbcbd16b43c|key:05b555b38483c65d\",",
          "1363:   },",
          "1365:    Name:           \"pam\",",
          "1366:    Version:        \"1.3.1-4.el8\",",
          "1367:    Arch:           \"x86_64\",",
          "1368:    Kind:           claircore.BINARY,",
          "1369:    Source:         &claircore.Package{Name: \"pam\", Version: \"1.3.1-4.el8\", Kind: claircore.SOURCE},",
          "1371:    RepositoryHint: \"hash:sha256:f6801a288957cf9da1c3f25cf923e08ac4a8cce76c8830bebe20d06756c7c8c6|key:05b555b38483c65d\",",
          "1372:   },",
          "1374:    Name:           \"libcurl-minimal\",",
          "1375:    Version:        \"7.61.1-8.el8\",",
          "1376:    Arch:           \"x86_64\",",
          "1377:    Kind:           claircore.BINARY,",
          "1378:    Source:         &claircore.Package{Name: \"curl\", Version: \"7.61.1-8.el8\", Kind: claircore.SOURCE},",
          "1380:    RepositoryHint: \"hash:sha256:dd3252e3c4326c9566a15c9a9fdf068822970cbc85e8f9bb3e0bc6c8f38d2763|key:05b555b38483c65d\",",
          "1381:   },",
          "1383:    Name:           \"rpm\",",
          "1384:    Version:        \"4.14.2-9.el8\",",
          "1385:    Arch:           \"x86_64\",",
          "1386:    Kind:           claircore.BINARY,",
          "1387:    Source:         &claircore.Package{Name: \"rpm\", Version: \"4.14.2-9.el8\", Kind: claircore.SOURCE},",
          "1389:    RepositoryHint: \"hash:sha256:cfa9f7711b0ff9f9c2c8879b1d902d5cd211c6dcde089ef4c514c1ef7fc197e6|key:05b555b38483c65d\",",
          "1390:   },",
          "1392:    Name:           \"libsolv\",",
          "1393:    Version:        \"0.6.35-6.el8\",",
          "1394:    Arch:           \"x86_64\",",
          "1395:    Kind:           claircore.BINARY,",
          "1396:    Source:         &claircore.Package{Name: \"libsolv\", Version: \"0.6.35-6.el8\", Kind: claircore.SOURCE},",
          "1398:    RepositoryHint: \"hash:sha256:9cc540d9c389e9b8ffa3fb5f25c6ee126f81c142043e5f33499ff4b0eb68d815|key:05b555b38483c65d\",",
          "1399:   },",
          "1401:    Name:           \"device-mapper-libs\",",
          "1402:    Version:        \"8:1.02.155-6.el8\",",
          "1403:    Arch:           \"x86_64\",",
          "1404:    Kind:           claircore.BINARY,",
          "1405:    Source:         &claircore.Package{Name: \"lvm2\", Version: \"2.03.02-6.el8\", Kind: claircore.SOURCE},",
          "1407:    RepositoryHint: \"hash:sha256:2accf23b7986d0a834c7033c2a003de4f0e957a6598d3ee3dbe40d5af395f738|key:05b555b38483c65d\",",
          "1408:   },",
          "1410:    Name:           \"elfutils-default-yama-scope\",",
          "1411:    Version:        \"0.174-6.el8\",",
          "1412:    Arch:           \"noarch\",",
          "1413:    Kind:           claircore.BINARY,",
          "1414:    Source:         &claircore.Package{Name: \"elfutils\", Version: \"0.174-6.el8\", Kind: claircore.SOURCE},",
          "1416:    RepositoryHint: \"hash:sha256:e59050e14d6b11165c09f020deb0c58cac3a9fd7cdb6c1a2da429fb34c9ee961|key:05b555b38483c65d\",",
          "1417:   },",
          "1419:    Name:           \"systemd-pam\",",
          "1420:    Version:        \"239-13.el8\",",
          "1421:    Arch:           \"x86_64\",",
          "1422:    Kind:           claircore.BINARY,",
          "1423:    Source:         &claircore.Package{Name: \"systemd\", Version: \"239-13.el8\", Kind: claircore.SOURCE},",
          "1425:    RepositoryHint: \"hash:sha256:04a90a0a7cee7bbc1fe433592a664fd2fc7695ad62e63d0319fb21a28aa657e5|key:05b555b38483c65d\",",
          "1426:   },",
          "1428:    Name:           \"dbus\",",
          "1429:    Version:        \"1:1.12.8-7.el8\",",
          "1430:    Arch:           \"x86_64\",",
          "1431:    Kind:           claircore.BINARY,",
          "1432:    Source:         &claircore.Package{Name: \"dbus\", Version: \"1.12.8-7.el8\", Kind: claircore.SOURCE},",
          "1434:    RepositoryHint: \"hash:sha256:fa127960f98c176c3e57432cbd96a74767f5fa803db325c0eacae18b47d52105|key:05b555b38483c65d\",",
          "1435:   },",
          "1437:    Name:           \"libkcapi\",",
          "1438:    Version:        \"1.1.1-16_1.el8\",",
          "1439:    Arch:           \"x86_64\",",
          "1440:    Kind:           claircore.BINARY,",
          "1441:    Source:         &claircore.Package{Name: \"libkcapi\", Version: \"1.1.1-16_1.el8\", Kind: claircore.SOURCE},",
          "1443:    RepositoryHint: \"hash:sha256:85e0a0bf27ae8bd85227284bce4d5755d9df4d76636e9e674d40245c1f1d53e3|key:05b555b38483c65d\",",
          "1444:   },",
          "1446:    Name:           \"systemd-udev\",",
          "1447:    Version:        \"239-13.el8\",",
          "1448:    Arch:           \"x86_64\",",
          "1449:    Kind:           claircore.BINARY,",
          "1450:    Source:         &claircore.Package{Name: \"systemd\", Version: \"239-13.el8\", Kind: claircore.SOURCE},",
          "1452:    RepositoryHint: \"hash:sha256:06f37071663c4c6007dfcc252c52caea5207059ed41368acd232bdcc2bf4df54|key:05b555b38483c65d\",",
          "1453:   },",
          "1455:    Name:           \"dracut-squash\",",
          "1456:    Version:        \"049-10.git20190115.el8\",",
          "1457:    Arch:           \"x86_64\",",
          "1458:    Kind:           claircore.BINARY,",
          "1459:    Source:         &claircore.Package{Name: \"dracut\", Version: \"049-10.git20190115.el8\", Kind: claircore.SOURCE},",
          "1461:    RepositoryHint: \"hash:sha256:d83c42b5837f392e1f2fadcec976f864da0c4a445453931784c3b0ef26efe268|key:05b555b38483c65d\",",
          "1462:   },",
          "1464:    Name:           \"python3-six\",",
          "1465:    Version:        \"1.11.0-8.el8\",",
          "1466:    Arch:           \"noarch\",",
          "1467:    Kind:           claircore.BINARY,",
          "1468:    Source:         &claircore.Package{Name: \"python-six\", Version: \"1.11.0-8.el8\", Kind: claircore.SOURCE},",
          "1470:    RepositoryHint: \"hash:sha256:3cf7b959035f68ffa0568a421cb52b5b9ac18d0ed33b1758ced4c53824dec052|key:05b555b38483c65d\",",
          "1471:   },",
          "1473:    Name:           \"bind-export-libs\",",
          "1474:    Version:        \"32:9.11.4-16.P2.el8\",",
          "1475:    Arch:           \"x86_64\",",
          "1476:    Kind:           claircore.BINARY,",
          "1477:    Source:         &claircore.Package{Name: \"bind\", Version: \"9.11.4-16.P2.el8\", Kind: claircore.SOURCE},",
          "1479:    RepositoryHint: \"hash:sha256:937fc7723d74e019dc1ed08a96d184798fe5ef787e3acf6149def2701d71543a|key:05b555b38483c65d\",",
          "1480:   },",
          "1482:    Name:           \"dracut-network\",",
          "1483:    Version:        \"049-10.git20190115.el8\",",
          "1484:    Arch:           \"x86_64\",",
          "1485:    Kind:           claircore.BINARY,",
          "1486:    Source:         &claircore.Package{Name: \"dracut\", Version: \"049-10.git20190115.el8\", Kind: claircore.SOURCE},",
          "1488:    RepositoryHint: \"hash:sha256:32c2c2ff8aa3b0b359f0caaa363d3c60bca96b17f60a11798ceeebd404822225|key:05b555b38483c65d\",",
          "1489:   },",
          "1491:    Name:           \"openldap\",",
          "1492:    Version:        \"2.4.46-9.el8\",",
          "1493:    Arch:           \"x86_64\",",
          "1494:    Kind:           claircore.BINARY,",
          "1495:    Source:         &claircore.Package{Name: \"openldap\", Version: \"2.4.46-9.el8\", Kind: claircore.SOURCE},",
          "1497:    RepositoryHint: \"hash:sha256:10d4086b87d0241e00c2974a21b81f7fd191ff63a9a5fe7b645e124b68e1133a|key:05b555b38483c65d\",",
          "1498:   },",
          "1500:    Name:           \"libmodulemd1\",",
          "1501:    Version:        \"1.8.0-5.el8\",",
          "1502:    Arch:           \"x86_64\",",
          "1503:    Kind:           claircore.BINARY,",
          "1504:    Source:         &claircore.Package{Name: \"libmodulemd\", Version: \"2.0.0-5.el8\", Kind: claircore.SOURCE},",
          "1506:    RepositoryHint: \"hash:sha256:552186ee8a462d8aa824886240f0ab6595aacbda85961ba46fd6faa01093d4f8|key:05b555b38483c65d\",",
          "1507:   },",
          "1509:    Name:           \"gnupg2\",",
          "1510:    Version:        \"2.2.9-1.el8\",",
          "1511:    Arch:           \"x86_64\",",
          "1512:    Kind:           claircore.BINARY,",
          "1513:    Source:         &claircore.Package{Name: \"gnupg2\", Version: \"2.2.9-1.el8\", Kind: claircore.SOURCE},",
          "1515:    RepositoryHint: \"hash:sha256:c8ff770f39becd78672e71a097c8dc85f0bbc224c34c7cbde9174f4f37f4eb78|key:05b555b38483c65d\",",
          "1516:   },",
          "1518:    Name:           \"librepo\",",
          "1519:    Version:        \"1.9.2-1.el8\",",
          "1520:    Arch:           \"x86_64\",",
          "1521:    Kind:           claircore.BINARY,",
          "1522:    Source:         &claircore.Package{Name: \"librepo\", Version: \"1.9.2-1.el8\", Kind: claircore.SOURCE},",
          "1524:    RepositoryHint: \"hash:sha256:b2ce0987d742e94ee121873d7991c93c20f55e07fca1cdb48b17b7dddc978038|key:05b555b38483c65d\",",
          "1525:   },",
          "1527:    Name:           \"python3-libdnf\",",
          "1528:    Version:        \"0.22.5-4.el8\",",
          "1529:    Arch:           \"x86_64\",",
          "1530:    Kind:           claircore.BINARY,",
          "1531:    Source:         &claircore.Package{Name: \"libdnf\", Version: \"0.22.5-4.el8\", Kind: claircore.SOURCE},",
          "1533:    RepositoryHint: \"hash:sha256:a9ff479162d2b4410d3c66dc30670ac95159a5a1e3d55c647d72acaea82b9383|key:05b555b38483c65d\",",
          "1534:   },",
          "1536:    Name:           \"python3-gpg\",",
          "1537:    Version:        \"1.10.0-6.el8.0.1\",",
          "1538:    Arch:           \"x86_64\",",
          "1539:    Kind:           claircore.BINARY,",
          "1540:    Source:         &claircore.Package{Name: \"gpgme\", Version: \"1.10.0-6.el8.0.1\", Kind: claircore.SOURCE},",
          "1542:    RepositoryHint: \"hash:sha256:d864cd6a05dc2ec6b186542cb06b859e9be60663641aab3a4137c0974ee4bd5c|key:05b555b38483c65d\",",
          "1543:   },",
          "1545:    Name:           \"python3-rpm\",",
          "1546:    Version:        \"4.14.2-9.el8\",",
          "1547:    Arch:           \"x86_64\",",
          "1548:    Kind:           claircore.BINARY,",
          "1549:    Source:         &claircore.Package{Name: \"rpm\", Version: \"4.14.2-9.el8\", Kind: claircore.SOURCE},",
          "1551:    RepositoryHint: \"hash:sha256:e1afb8156d811bdaeb6fc3185584a0cd5f5657be011f9a94bc4bb86fb26eeecf|key:05b555b38483c65d\",",
          "1552:   },",
          "1554:    Name:           \"dnf\",",
          "1555:    Version:        \"4.0.9.2-5.el8\",",
          "1556:    Arch:           \"noarch\",",
          "1557:    Kind:           claircore.BINARY,",
          "1558:    Source:         &claircore.Package{Name: \"dnf\", Version: \"4.0.9.2-5.el8\", Kind: claircore.SOURCE},",
          "1560:    RepositoryHint: \"hash:sha256:f181fecf80dbb41748774e6d2eff24f0497f29f1bc5be4a85cdbfed9c7a45a8f|key:05b555b38483c65d\",",
          "1561:   },",
          "1563:    Name:           \"kexec-tools\",",
          "1564:    Version:        \"2.0.17-28.el8\",",
          "1565:    Arch:           \"x86_64\",",
          "1566:    Kind:           claircore.BINARY,",
          "1567:    Source:         &claircore.Package{Name: \"kexec-tools\", Version: \"2.0.17-28.el8\", Kind: claircore.SOURCE},",
          "1569:    RepositoryHint: \"hash:sha256:8d30b05d73c50d584dedd2795787309ece57fa908f8f3fad1d7d060c5827accb|key:05b555b38483c65d\",",
          "1570:   },",
          "1572:    Name:           \"tar\",",
          "1573:    Version:        \"2:1.30-4.el8\",",
          "1574:    Arch:           \"x86_64\",",
          "1575:    Kind:           claircore.BINARY,",
          "1576:    Source:         &claircore.Package{Name: \"tar\", Version: \"1.30-4.el8\", Kind: claircore.SOURCE},",
          "1578:    RepositoryHint: \"hash:sha256:38c5c9ba7c090fdbd9d68c0aa30bc8fa82800fa5651d7d5a9e23195f90596b2e|key:05b555b38483c65d\",",
          "1579:   },",
          "1581:    Name:           \"hostname\",",
          "1582:    Version:        \"3.20-6.el8\",",
          "1583:    Arch:           \"x86_64\",",
          "1584:    Kind:           claircore.BINARY,",
          "1585:    Source:         &claircore.Package{Name: \"hostname\", Version: \"3.20-6.el8\", Kind: claircore.SOURCE},",
          "1587:    RepositoryHint: \"hash:sha256:923455b73c2fdb3dd5bfb805e00ba058c6654c1b1a69a73d79c85fea83832ae2|key:05b555b38483c65d\",",
          "1588:   },",
          "1590:    Name:           \"langpacks-en\",",
          "1591:    Version:        \"1.0-12.el8\",",
          "1592:    Arch:           \"noarch\",",
          "1593:    Kind:           claircore.BINARY,",
          "1594:    Source:         &claircore.Package{Name: \"langpacks\", Version: \"1.0-12.el8\", Kind: claircore.SOURCE},",
          "1596:    RepositoryHint: \"hash:sha256:3c320217c4867e58178cf01c1e2d31629e794b1ee5c1473a5d6bf31c56d7d76c|key:05b555b38483c65d\",",
          "1597:   },",
          "1598:  }",
          "1606:   }",
          "1639: }",
          "1641: func TestRelPath(t *testing.T) {",
          "",
          "[Removed Lines]",
          "32:   &claircore.Package{",
          "38:    PackageDB:      \"/var/lib/rpm\",",
          "41:   &claircore.Package{",
          "47:    PackageDB:      \"/var/lib/rpm\",",
          "50:   &claircore.Package{",
          "56:    PackageDB:      \"/var/lib/rpm\",",
          "59:   &claircore.Package{",
          "65:    PackageDB:      \"/var/lib/rpm\",",
          "68:   &claircore.Package{",
          "74:    PackageDB:      \"/var/lib/rpm\",",
          "77:   &claircore.Package{",
          "83:    PackageDB:      \"/var/lib/rpm\",",
          "86:   &claircore.Package{",
          "92:    PackageDB:      \"/var/lib/rpm\",",
          "95:   &claircore.Package{",
          "101:    PackageDB:      \"/var/lib/rpm\",",
          "104:   &claircore.Package{",
          "110:    PackageDB:      \"/var/lib/rpm\",",
          "113:   &claircore.Package{",
          "119:    PackageDB:      \"/var/lib/rpm\",",
          "122:   &claircore.Package{",
          "128:    PackageDB:      \"/var/lib/rpm\",",
          "131:   &claircore.Package{",
          "137:    PackageDB:      \"/var/lib/rpm\",",
          "140:   &claircore.Package{",
          "146:    PackageDB:      \"/var/lib/rpm\",",
          "149:   &claircore.Package{",
          "155:    PackageDB:      \"/var/lib/rpm\",",
          "158:   &claircore.Package{",
          "164:    PackageDB:      \"/var/lib/rpm\",",
          "167:   &claircore.Package{",
          "173:    PackageDB:      \"/var/lib/rpm\",",
          "176:   &claircore.Package{",
          "182:    PackageDB:      \"/var/lib/rpm\",",
          "185:   &claircore.Package{",
          "191:    PackageDB:      \"/var/lib/rpm\",",
          "194:   &claircore.Package{",
          "200:    PackageDB:      \"/var/lib/rpm\",",
          "203:   &claircore.Package{",
          "209:    PackageDB:      \"/var/lib/rpm\",",
          "212:   &claircore.Package{",
          "218:    PackageDB:      \"/var/lib/rpm\",",
          "221:   &claircore.Package{",
          "227:    PackageDB:      \"/var/lib/rpm\",",
          "230:   &claircore.Package{",
          "236:    PackageDB:      \"/var/lib/rpm\",",
          "239:   &claircore.Package{",
          "245:    PackageDB:      \"/var/lib/rpm\",",
          "248:   &claircore.Package{",
          "254:    PackageDB:      \"/var/lib/rpm\",",
          "257:   &claircore.Package{",
          "263:    PackageDB:      \"/var/lib/rpm\",",
          "266:   &claircore.Package{",
          "272:    PackageDB:      \"/var/lib/rpm\",",
          "275:   &claircore.Package{",
          "281:    PackageDB:      \"/var/lib/rpm\",",
          "284:   &claircore.Package{",
          "290:    PackageDB:      \"/var/lib/rpm\",",
          "293:   &claircore.Package{",
          "299:    PackageDB:      \"/var/lib/rpm\",",
          "302:   &claircore.Package{",
          "308:    PackageDB:      \"/var/lib/rpm\",",
          "311:   &claircore.Package{",
          "317:    PackageDB:      \"/var/lib/rpm\",",
          "320:   &claircore.Package{",
          "326:    PackageDB:      \"/var/lib/rpm\",",
          "329:   &claircore.Package{",
          "335:    PackageDB:      \"/var/lib/rpm\",",
          "338:   &claircore.Package{",
          "344:    PackageDB:      \"/var/lib/rpm\",",
          "347:   &claircore.Package{",
          "353:    PackageDB:      \"/var/lib/rpm\",",
          "356:   &claircore.Package{",
          "362:    PackageDB:      \"/var/lib/rpm\",",
          "365:   &claircore.Package{",
          "371:    PackageDB:      \"/var/lib/rpm\",",
          "374:   &claircore.Package{",
          "380:    PackageDB:      \"/var/lib/rpm\",",
          "383:   &claircore.Package{",
          "389:    PackageDB:      \"/var/lib/rpm\",",
          "392:   &claircore.Package{",
          "398:    PackageDB:      \"/var/lib/rpm\",",
          "401:   &claircore.Package{",
          "407:    PackageDB:      \"/var/lib/rpm\",",
          "410:   &claircore.Package{",
          "416:    PackageDB:      \"/var/lib/rpm\",",
          "419:   &claircore.Package{",
          "425:    PackageDB:      \"/var/lib/rpm\",",
          "428:   &claircore.Package{",
          "434:    PackageDB:      \"/var/lib/rpm\",",
          "437:   &claircore.Package{",
          "443:    PackageDB:      \"/var/lib/rpm\",",
          "446:   &claircore.Package{",
          "452:    PackageDB:      \"/var/lib/rpm\",",
          "455:   &claircore.Package{",
          "461:    PackageDB:      \"/var/lib/rpm\",",
          "464:   &claircore.Package{",
          "470:    PackageDB:      \"/var/lib/rpm\",",
          "473:   &claircore.Package{",
          "479:    PackageDB:      \"/var/lib/rpm\",",
          "482:   &claircore.Package{",
          "488:    PackageDB:      \"/var/lib/rpm\",",
          "491:   &claircore.Package{",
          "497:    PackageDB:      \"/var/lib/rpm\",",
          "500:   &claircore.Package{",
          "506:    PackageDB:      \"/var/lib/rpm\",",
          "509:   &claircore.Package{",
          "515:    PackageDB:      \"/var/lib/rpm\",",
          "518:   &claircore.Package{",
          "524:    PackageDB:      \"/var/lib/rpm\",",
          "527:   &claircore.Package{",
          "533:    PackageDB:      \"/var/lib/rpm\",",
          "536:   &claircore.Package{",
          "542:    PackageDB:      \"/var/lib/rpm\",",
          "545:   &claircore.Package{",
          "551:    PackageDB:      \"/var/lib/rpm\",",
          "554:   &claircore.Package{",
          "560:    PackageDB:      \"/var/lib/rpm\",",
          "563:   &claircore.Package{",
          "569:    PackageDB:      \"/var/lib/rpm\",",
          "572:   &claircore.Package{",
          "578:    PackageDB:      \"/var/lib/rpm\",",
          "581:   &claircore.Package{",
          "587:    PackageDB:      \"/var/lib/rpm\",",
          "590:   &claircore.Package{",
          "596:    PackageDB:      \"/var/lib/rpm\",",
          "599:   &claircore.Package{",
          "605:    PackageDB:      \"/var/lib/rpm\",",
          "608:   &claircore.Package{",
          "614:    PackageDB:      \"/var/lib/rpm\",",
          "617:   &claircore.Package{",
          "623:    PackageDB:      \"/var/lib/rpm\",",
          "626:   &claircore.Package{",
          "632:    PackageDB:      \"/var/lib/rpm\",",
          "635:   &claircore.Package{",
          "641:    PackageDB:      \"/var/lib/rpm\",",
          "644:   &claircore.Package{",
          "650:    PackageDB:      \"/var/lib/rpm\",",
          "653:   &claircore.Package{",
          "659:    PackageDB:      \"/var/lib/rpm\",",
          "662:   &claircore.Package{",
          "668:    PackageDB:      \"/var/lib/rpm\",",
          "671:   &claircore.Package{",
          "677:    PackageDB:      \"/var/lib/rpm\",",
          "680:   &claircore.Package{",
          "686:    PackageDB:      \"/var/lib/rpm\",",
          "689:   &claircore.Package{",
          "695:    PackageDB:      \"/var/lib/rpm\",",
          "698:   &claircore.Package{",
          "704:    PackageDB:      \"/var/lib/rpm\",",
          "707:   &claircore.Package{",
          "713:    PackageDB:      \"/var/lib/rpm\",",
          "716:   &claircore.Package{",
          "722:    PackageDB:      \"/var/lib/rpm\",",
          "725:   &claircore.Package{",
          "731:    PackageDB:      \"/var/lib/rpm\",",
          "734:   &claircore.Package{",
          "740:    PackageDB:      \"/var/lib/rpm\",",
          "743:   &claircore.Package{",
          "749:    PackageDB:      \"/var/lib/rpm\",",
          "752:   &claircore.Package{",
          "758:    PackageDB:      \"/var/lib/rpm\",",
          "761:   &claircore.Package{",
          "767:    PackageDB:      \"/var/lib/rpm\",",
          "770:   &claircore.Package{",
          "776:    PackageDB:      \"/var/lib/rpm\",",
          "779:   &claircore.Package{",
          "785:    PackageDB:      \"/var/lib/rpm\",",
          "788:   &claircore.Package{",
          "794:    PackageDB:      \"/var/lib/rpm\",",
          "797:   &claircore.Package{",
          "803:    PackageDB:      \"/var/lib/rpm\",",
          "806:   &claircore.Package{",
          "812:    PackageDB:      \"/var/lib/rpm\",",
          "815:   &claircore.Package{",
          "821:    PackageDB:      \"/var/lib/rpm\",",
          "824:   &claircore.Package{",
          "830:    PackageDB:      \"/var/lib/rpm\",",
          "833:   &claircore.Package{",
          "839:    PackageDB:      \"/var/lib/rpm\",",
          "842:   &claircore.Package{",
          "848:    PackageDB:      \"/var/lib/rpm\",",
          "851:   &claircore.Package{",
          "857:    PackageDB:      \"/var/lib/rpm\",",
          "860:   &claircore.Package{",
          "866:    PackageDB:      \"/var/lib/rpm\",",
          "869:   &claircore.Package{",
          "875:    PackageDB:      \"/var/lib/rpm\",",
          "878:   &claircore.Package{",
          "884:    PackageDB:      \"/var/lib/rpm\",",
          "887:   &claircore.Package{",
          "893:    PackageDB:      \"/var/lib/rpm\",",
          "896:   &claircore.Package{",
          "902:    PackageDB:      \"/var/lib/rpm\",",
          "905:   &claircore.Package{",
          "911:    PackageDB:      \"/var/lib/rpm\",",
          "914:   &claircore.Package{",
          "920:    PackageDB:      \"/var/lib/rpm\",",
          "923:   &claircore.Package{",
          "929:    PackageDB:      \"/var/lib/rpm\",",
          "932:   &claircore.Package{",
          "938:    PackageDB:      \"/var/lib/rpm\",",
          "941:   &claircore.Package{",
          "947:    PackageDB:      \"/var/lib/rpm\",",
          "950:   &claircore.Package{",
          "956:    PackageDB:      \"/var/lib/rpm\",",
          "959:   &claircore.Package{",
          "965:    PackageDB:      \"/var/lib/rpm\",",
          "968:   &claircore.Package{",
          "974:    PackageDB:      \"/var/lib/rpm\",",
          "977:   &claircore.Package{",
          "983:    PackageDB:      \"/var/lib/rpm\",",
          "986:   &claircore.Package{",
          "992:    PackageDB:      \"/var/lib/rpm\",",
          "995:   &claircore.Package{",
          "1001:    PackageDB:      \"/var/lib/rpm\",",
          "1004:   &claircore.Package{",
          "1010:    PackageDB:      \"/var/lib/rpm\",",
          "1013:   &claircore.Package{",
          "1019:    PackageDB:      \"/var/lib/rpm\",",
          "1022:   &claircore.Package{",
          "1028:    PackageDB:      \"/var/lib/rpm\",",
          "1031:   &claircore.Package{",
          "1037:    PackageDB:      \"/var/lib/rpm\",",
          "1040:   &claircore.Package{",
          "1046:    PackageDB:      \"/var/lib/rpm\",",
          "1049:   &claircore.Package{",
          "1055:    PackageDB:      \"/var/lib/rpm\",",
          "1058:   &claircore.Package{",
          "1064:    PackageDB:      \"/var/lib/rpm\",",
          "1067:   &claircore.Package{",
          "1073:    PackageDB:      \"/var/lib/rpm\",",
          "1076:   &claircore.Package{",
          "1082:    PackageDB:      \"/var/lib/rpm\",",
          "1085:   &claircore.Package{",
          "1091:    PackageDB:      \"/var/lib/rpm\",",
          "1094:   &claircore.Package{",
          "1100:    PackageDB:      \"/var/lib/rpm\",",
          "1103:   &claircore.Package{",
          "1109:    PackageDB:      \"/var/lib/rpm\",",
          "1112:   &claircore.Package{",
          "1118:    PackageDB:      \"/var/lib/rpm\",",
          "1121:   &claircore.Package{",
          "1127:    PackageDB:      \"/var/lib/rpm\",",
          "1130:   &claircore.Package{",
          "1136:    PackageDB:      \"/var/lib/rpm\",",
          "1139:   &claircore.Package{",
          "1145:    PackageDB:      \"/var/lib/rpm\",",
          "1148:   &claircore.Package{",
          "1154:    PackageDB:      \"/var/lib/rpm\",",
          "1157:   &claircore.Package{",
          "1163:    PackageDB:      \"/var/lib/rpm\",",
          "1166:   &claircore.Package{",
          "1172:    PackageDB:      \"/var/lib/rpm\",",
          "1175:   &claircore.Package{",
          "1181:    PackageDB:      \"/var/lib/rpm\",",
          "1184:   &claircore.Package{",
          "1190:    PackageDB:      \"/var/lib/rpm\",",
          "1193:   &claircore.Package{",
          "1199:    PackageDB:      \"/var/lib/rpm\",",
          "1202:   &claircore.Package{",
          "1208:    PackageDB:      \"/var/lib/rpm\",",
          "1211:   &claircore.Package{",
          "1217:    PackageDB:      \"/var/lib/rpm\",",
          "1220:   &claircore.Package{",
          "1226:    PackageDB:      \"/var/lib/rpm\",",
          "1229:   &claircore.Package{",
          "1235:    PackageDB:      \"/var/lib/rpm\",",
          "1238:   &claircore.Package{",
          "1244:    PackageDB:      \"/var/lib/rpm\",",
          "1247:   &claircore.Package{",
          "1253:    PackageDB:      \"/var/lib/rpm\",",
          "1256:   &claircore.Package{",
          "1262:    PackageDB:      \"/var/lib/rpm\",",
          "1265:   &claircore.Package{",
          "1271:    PackageDB:      \"/var/lib/rpm\",",
          "1274:   &claircore.Package{",
          "1280:    PackageDB:      \"/var/lib/rpm\",",
          "1283:   &claircore.Package{",
          "1289:    PackageDB:      \"/var/lib/rpm\",",
          "1292:   &claircore.Package{",
          "1298:    PackageDB:      \"/var/lib/rpm\",",
          "1301:   &claircore.Package{",
          "1307:    PackageDB:      \"/var/lib/rpm\",",
          "1310:   &claircore.Package{",
          "1316:    PackageDB:      \"/var/lib/rpm\",",
          "1319:   &claircore.Package{",
          "1325:    PackageDB:      \"/var/lib/rpm\",",
          "1328:   &claircore.Package{",
          "1334:    PackageDB:      \"/var/lib/rpm\",",
          "1337:   &claircore.Package{",
          "1343:    PackageDB:      \"/var/lib/rpm\",",
          "1346:   &claircore.Package{",
          "1352:    PackageDB:      \"/var/lib/rpm\",",
          "1355:   &claircore.Package{",
          "1361:    PackageDB:      \"/var/lib/rpm\",",
          "1364:   &claircore.Package{",
          "1370:    PackageDB:      \"/var/lib/rpm\",",
          "1373:   &claircore.Package{",
          "1379:    PackageDB:      \"/var/lib/rpm\",",
          "1382:   &claircore.Package{",
          "1388:    PackageDB:      \"/var/lib/rpm\",",
          "1391:   &claircore.Package{",
          "1397:    PackageDB:      \"/var/lib/rpm\",",
          "1400:   &claircore.Package{",
          "1406:    PackageDB:      \"/var/lib/rpm\",",
          "1409:   &claircore.Package{",
          "1415:    PackageDB:      \"/var/lib/rpm\",",
          "1418:   &claircore.Package{",
          "1424:    PackageDB:      \"/var/lib/rpm\",",
          "1427:   &claircore.Package{",
          "1433:    PackageDB:      \"/var/lib/rpm\",",
          "1436:   &claircore.Package{",
          "1442:    PackageDB:      \"/var/lib/rpm\",",
          "1445:   &claircore.Package{",
          "1451:    PackageDB:      \"/var/lib/rpm\",",
          "1454:   &claircore.Package{",
          "1460:    PackageDB:      \"/var/lib/rpm\",",
          "1463:   &claircore.Package{",
          "1469:    PackageDB:      \"/var/lib/rpm\",",
          "1472:   &claircore.Package{",
          "1478:    PackageDB:      \"/var/lib/rpm\",",
          "1481:   &claircore.Package{",
          "1487:    PackageDB:      \"/var/lib/rpm\",",
          "1490:   &claircore.Package{",
          "1496:    PackageDB:      \"/var/lib/rpm\",",
          "1499:   &claircore.Package{",
          "1505:    PackageDB:      \"/var/lib/rpm\",",
          "1508:   &claircore.Package{",
          "1514:    PackageDB:      \"/var/lib/rpm\",",
          "1517:   &claircore.Package{",
          "1523:    PackageDB:      \"/var/lib/rpm\",",
          "1526:   &claircore.Package{",
          "1532:    PackageDB:      \"/var/lib/rpm\",",
          "1535:   &claircore.Package{",
          "1541:    PackageDB:      \"/var/lib/rpm\",",
          "1544:   &claircore.Package{",
          "1550:    PackageDB:      \"/var/lib/rpm\",",
          "1553:   &claircore.Package{",
          "1559:    PackageDB:      \"/var/lib/rpm\",",
          "1562:   &claircore.Package{",
          "1568:    PackageDB:      \"/var/lib/rpm\",",
          "1571:   &claircore.Package{",
          "1577:    PackageDB:      \"/var/lib/rpm\",",
          "1580:   &claircore.Package{",
          "1586:    PackageDB:      \"/var/lib/rpm\",",
          "1589:   &claircore.Package{",
          "1595:    PackageDB:      \"/var/lib/rpm\",",
          "1601:  for _, exe := range []string{",
          "1602:   \"tar\", \"rpm\",",
          "1603:  } {",
          "1604:   if _, err := exec.LookPath(exe); err != nil {",
          "1605:    t.Skipf(\"skipping test: missing needed utility %q (%v)\", exe, err)",
          "1607:  }",
          "1608:  ctx := zlog.Test(context.Background(), t)",
          "1609:  l := &claircore.Layer{",
          "1610:   Hash: hash,",
          "1611:  }",
          "1613:  tctx, done := context.WithTimeout(ctx, 2*time.Minute)",
          "1614:  defer done()",
          "1615:  n, err := fetch.Layer(tctx, t, http.DefaultClient, \"docker.io\", \"library/centos\", hash)",
          "1616:  if err != nil {",
          "1617:   t.Fatal(err)",
          "1618:  }",
          "1619:  defer n.Close()",
          "1620:  l.SetLocal(n.Name())",
          "1622:  s := &Scanner{}",
          "1623:  got, err := s.Scan(ctx, l)",
          "1624:  if err != nil {",
          "1625:   t.Fatal(err)",
          "1626:  }",
          "1627:  t.Logf(\"found %d packages\", len(got))",
          "1628:  if !cmp.Equal(got, want) {",
          "1629:   t.Fatal(cmp.Diff(got, want))",
          "1630:  }",
          "1632:  ms, err := filepath.Glob(pat)",
          "1633:  if err != nil {",
          "1634:   t.Error(err)",
          "1635:  }",
          "1636:  if got, want := ms, prevs; !cmp.Equal(got, want) {",
          "1637:   t.Error(cmp.Diff(got, want))",
          "1638:  }",
          "",
          "[Added Lines]",
          "33:   {",
          "39:    PackageDB:      \"bdb:var/lib/rpm\",",
          "42:   {",
          "48:    PackageDB:      \"bdb:var/lib/rpm\",",
          "51:   {",
          "57:    PackageDB:      \"bdb:var/lib/rpm\",",
          "60:   {",
          "66:    PackageDB:      \"bdb:var/lib/rpm\",",
          "69:   {",
          "75:    PackageDB:      \"bdb:var/lib/rpm\",",
          "78:   {",
          "84:    PackageDB:      \"bdb:var/lib/rpm\",",
          "87:   {",
          "93:    PackageDB:      \"bdb:var/lib/rpm\",",
          "96:   {",
          "102:    PackageDB:      \"bdb:var/lib/rpm\",",
          "105:   {",
          "111:    PackageDB:      \"bdb:var/lib/rpm\",",
          "114:   {",
          "120:    PackageDB:      \"bdb:var/lib/rpm\",",
          "123:   {",
          "129:    PackageDB:      \"bdb:var/lib/rpm\",",
          "132:   {",
          "138:    PackageDB:      \"bdb:var/lib/rpm\",",
          "141:   {",
          "147:    PackageDB:      \"bdb:var/lib/rpm\",",
          "150:   {",
          "156:    PackageDB:      \"bdb:var/lib/rpm\",",
          "159:   {",
          "165:    PackageDB:      \"bdb:var/lib/rpm\",",
          "168:   {",
          "174:    PackageDB:      \"bdb:var/lib/rpm\",",
          "177:   {",
          "183:    PackageDB:      \"bdb:var/lib/rpm\",",
          "186:   {",
          "192:    PackageDB:      \"bdb:var/lib/rpm\",",
          "195:   {",
          "201:    PackageDB:      \"bdb:var/lib/rpm\",",
          "204:   {",
          "210:    PackageDB:      \"bdb:var/lib/rpm\",",
          "213:   {",
          "219:    PackageDB:      \"bdb:var/lib/rpm\",",
          "222:   {",
          "228:    PackageDB:      \"bdb:var/lib/rpm\",",
          "231:   {",
          "237:    PackageDB:      \"bdb:var/lib/rpm\",",
          "240:   {",
          "246:    PackageDB:      \"bdb:var/lib/rpm\",",
          "249:   {",
          "255:    PackageDB:      \"bdb:var/lib/rpm\",",
          "258:   {",
          "264:    PackageDB:      \"bdb:var/lib/rpm\",",
          "267:   {",
          "273:    PackageDB:      \"bdb:var/lib/rpm\",",
          "276:   {",
          "282:    PackageDB:      \"bdb:var/lib/rpm\",",
          "285:   {",
          "291:    PackageDB:      \"bdb:var/lib/rpm\",",
          "294:   {",
          "300:    PackageDB:      \"bdb:var/lib/rpm\",",
          "303:   {",
          "309:    PackageDB:      \"bdb:var/lib/rpm\",",
          "312:   {",
          "318:    PackageDB:      \"bdb:var/lib/rpm\",",
          "321:   {",
          "327:    PackageDB:      \"bdb:var/lib/rpm\",",
          "330:   {",
          "336:    PackageDB:      \"bdb:var/lib/rpm\",",
          "339:   {",
          "345:    PackageDB:      \"bdb:var/lib/rpm\",",
          "348:   {",
          "354:    PackageDB:      \"bdb:var/lib/rpm\",",
          "357:   {",
          "363:    PackageDB:      \"bdb:var/lib/rpm\",",
          "366:   {",
          "372:    PackageDB:      \"bdb:var/lib/rpm\",",
          "375:   {",
          "381:    PackageDB:      \"bdb:var/lib/rpm\",",
          "384:   {",
          "390:    PackageDB:      \"bdb:var/lib/rpm\",",
          "393:   {",
          "399:    PackageDB:      \"bdb:var/lib/rpm\",",
          "402:   {",
          "408:    PackageDB:      \"bdb:var/lib/rpm\",",
          "411:   {",
          "417:    PackageDB:      \"bdb:var/lib/rpm\",",
          "420:   {",
          "426:    PackageDB:      \"bdb:var/lib/rpm\",",
          "429:   {",
          "435:    PackageDB:      \"bdb:var/lib/rpm\",",
          "438:   {",
          "444:    PackageDB:      \"bdb:var/lib/rpm\",",
          "447:   {",
          "453:    PackageDB:      \"bdb:var/lib/rpm\",",
          "456:   {",
          "462:    PackageDB:      \"bdb:var/lib/rpm\",",
          "465:   {",
          "471:    PackageDB:      \"bdb:var/lib/rpm\",",
          "474:   {",
          "480:    PackageDB:      \"bdb:var/lib/rpm\",",
          "483:   {",
          "489:    PackageDB:      \"bdb:var/lib/rpm\",",
          "492:   {",
          "498:    PackageDB:      \"bdb:var/lib/rpm\",",
          "501:   {",
          "507:    PackageDB:      \"bdb:var/lib/rpm\",",
          "510:   {",
          "516:    PackageDB:      \"bdb:var/lib/rpm\",",
          "519:   {",
          "525:    PackageDB:      \"bdb:var/lib/rpm\",",
          "528:   {",
          "534:    PackageDB:      \"bdb:var/lib/rpm\",",
          "537:   {",
          "543:    PackageDB:      \"bdb:var/lib/rpm\",",
          "546:   {",
          "552:    PackageDB:      \"bdb:var/lib/rpm\",",
          "555:   {",
          "561:    PackageDB:      \"bdb:var/lib/rpm\",",
          "564:   {",
          "570:    PackageDB:      \"bdb:var/lib/rpm\",",
          "573:   {",
          "579:    PackageDB:      \"bdb:var/lib/rpm\",",
          "582:   {",
          "588:    PackageDB:      \"bdb:var/lib/rpm\",",
          "591:   {",
          "597:    PackageDB:      \"bdb:var/lib/rpm\",",
          "600:   {",
          "606:    PackageDB:      \"bdb:var/lib/rpm\",",
          "609:   {",
          "615:    PackageDB:      \"bdb:var/lib/rpm\",",
          "618:   {",
          "624:    PackageDB:      \"bdb:var/lib/rpm\",",
          "627:   {",
          "633:    PackageDB:      \"bdb:var/lib/rpm\",",
          "636:   {",
          "642:    PackageDB:      \"bdb:var/lib/rpm\",",
          "645:   {",
          "651:    PackageDB:      \"bdb:var/lib/rpm\",",
          "654:   {",
          "660:    PackageDB:      \"bdb:var/lib/rpm\",",
          "663:   {",
          "669:    PackageDB:      \"bdb:var/lib/rpm\",",
          "672:   {",
          "678:    PackageDB:      \"bdb:var/lib/rpm\",",
          "681:   {",
          "687:    PackageDB:      \"bdb:var/lib/rpm\",",
          "690:   {",
          "696:    PackageDB:      \"bdb:var/lib/rpm\",",
          "699:   {",
          "705:    PackageDB:      \"bdb:var/lib/rpm\",",
          "708:   {",
          "714:    PackageDB:      \"bdb:var/lib/rpm\",",
          "717:   {",
          "723:    PackageDB:      \"bdb:var/lib/rpm\",",
          "726:   {",
          "732:    PackageDB:      \"bdb:var/lib/rpm\",",
          "735:   {",
          "741:    PackageDB:      \"bdb:var/lib/rpm\",",
          "744:   {",
          "750:    PackageDB:      \"bdb:var/lib/rpm\",",
          "753:   {",
          "759:    PackageDB:      \"bdb:var/lib/rpm\",",
          "762:   {",
          "768:    PackageDB:      \"bdb:var/lib/rpm\",",
          "771:   {",
          "777:    PackageDB:      \"bdb:var/lib/rpm\",",
          "780:   {",
          "786:    PackageDB:      \"bdb:var/lib/rpm\",",
          "789:   {",
          "795:    PackageDB:      \"bdb:var/lib/rpm\",",
          "798:   {",
          "804:    PackageDB:      \"bdb:var/lib/rpm\",",
          "807:   {",
          "813:    PackageDB:      \"bdb:var/lib/rpm\",",
          "816:   {",
          "822:    PackageDB:      \"bdb:var/lib/rpm\",",
          "825:   {",
          "831:    PackageDB:      \"bdb:var/lib/rpm\",",
          "834:   {",
          "840:    PackageDB:      \"bdb:var/lib/rpm\",",
          "843:   {",
          "849:    PackageDB:      \"bdb:var/lib/rpm\",",
          "852:   {",
          "858:    PackageDB:      \"bdb:var/lib/rpm\",",
          "861:   {",
          "867:    PackageDB:      \"bdb:var/lib/rpm\",",
          "870:   {",
          "876:    PackageDB:      \"bdb:var/lib/rpm\",",
          "879:   {",
          "885:    PackageDB:      \"bdb:var/lib/rpm\",",
          "888:   {",
          "894:    PackageDB:      \"bdb:var/lib/rpm\",",
          "897:   {",
          "903:    PackageDB:      \"bdb:var/lib/rpm\",",
          "906:   {",
          "912:    PackageDB:      \"bdb:var/lib/rpm\",",
          "915:   {",
          "921:    PackageDB:      \"bdb:var/lib/rpm\",",
          "924:   {",
          "930:    PackageDB:      \"bdb:var/lib/rpm\",",
          "933:   {",
          "939:    PackageDB:      \"bdb:var/lib/rpm\",",
          "942:   {",
          "948:    PackageDB:      \"bdb:var/lib/rpm\",",
          "951:   {",
          "957:    PackageDB:      \"bdb:var/lib/rpm\",",
          "960:   {",
          "966:    PackageDB:      \"bdb:var/lib/rpm\",",
          "969:   {",
          "975:    PackageDB:      \"bdb:var/lib/rpm\",",
          "978:   {",
          "984:    PackageDB:      \"bdb:var/lib/rpm\",",
          "987:   {",
          "993:    PackageDB:      \"bdb:var/lib/rpm\",",
          "996:   {",
          "1002:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1005:   {",
          "1011:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1014:   {",
          "1020:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1023:   {",
          "1029:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1032:   {",
          "1038:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1041:   {",
          "1047:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1050:   {",
          "1056:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1059:   {",
          "1065:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1068:   {",
          "1074:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1077:   {",
          "1083:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1086:   {",
          "1092:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1095:   {",
          "1101:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1104:   {",
          "1110:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1113:   {",
          "1119:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1122:   {",
          "1128:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1131:   {",
          "1137:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1140:   {",
          "1146:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1149:   {",
          "1155:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1158:   {",
          "1164:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1167:   {",
          "1173:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1176:   {",
          "1182:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1185:   {",
          "1191:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1194:   {",
          "1200:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1203:   {",
          "1209:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1212:   {",
          "1218:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1221:   {",
          "1227:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1230:   {",
          "1236:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1239:   {",
          "1245:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1248:   {",
          "1254:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1257:   {",
          "1263:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1266:   {",
          "1272:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1275:   {",
          "1281:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1284:   {",
          "1290:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1293:   {",
          "1299:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1302:   {",
          "1308:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1311:   {",
          "1317:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1320:   {",
          "1326:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1329:   {",
          "1335:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1338:   {",
          "1344:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1347:   {",
          "1353:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1356:   {",
          "1362:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1365:   {",
          "1371:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1374:   {",
          "1380:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1383:   {",
          "1389:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1392:   {",
          "1398:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1401:   {",
          "1407:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1410:   {",
          "1416:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1419:   {",
          "1425:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1428:   {",
          "1434:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1437:   {",
          "1443:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1446:   {",
          "1452:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1455:   {",
          "1461:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1464:   {",
          "1470:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1473:   {",
          "1479:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1482:   {",
          "1488:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1491:   {",
          "1497:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1500:   {",
          "1506:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1509:   {",
          "1515:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1518:   {",
          "1524:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1527:   {",
          "1533:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1536:   {",
          "1542:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1545:   {",
          "1551:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1554:   {",
          "1560:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1563:   {",
          "1569:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1572:   {",
          "1578:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1581:   {",
          "1587:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1590:   {",
          "1596:    PackageDB:      \"bdb:var/lib/rpm\",",
          "1601:  t.Run(\"BDB\", func(t *testing.T) {",
          "1603:   for _, exe := range []string{",
          "1604:    \"tar\", \"rpm\",",
          "1605:   } {",
          "1606:    if _, err := exec.LookPath(exe); err != nil {",
          "1607:     t.Skipf(\"skipping test: missing needed utility %q (%v)\", exe, err)",
          "1608:    }",
          "1609:   }",
          "1610:   ctx := zlog.Test(context.Background(), t)",
          "1611:   l := &claircore.Layer{",
          "1612:    Hash: hash,",
          "1615:   tctx, done := context.WithTimeout(ctx, 2*time.Minute)",
          "1616:   defer done()",
          "1617:   n, err := fetch.Layer(tctx, t, http.DefaultClient, \"docker.io\", \"library/centos\", hash)",
          "1618:   if err != nil {",
          "1619:    t.Fatal(err)",
          "1620:   }",
          "1621:   defer n.Close()",
          "1622:   l.SetLocal(n.Name())",
          "1624:   s := &Scanner{}",
          "1625:   got, err := s.Scan(ctx, l)",
          "1626:   if err != nil {",
          "1627:    t.Fatal(err)",
          "1628:   }",
          "1629:   t.Logf(\"found %d packages\", len(got))",
          "1630:   if !cmp.Equal(got, want) {",
          "1631:    t.Fatal(cmp.Diff(got, want))",
          "1632:   }",
          "1634:   ms, err := filepath.Glob(pat)",
          "1635:   if err != nil {",
          "1636:    t.Error(err)",
          "1637:   }",
          "1638:   if got, want := ms, prevs; !cmp.Equal(got, want) {",
          "1639:    t.Error(cmp.Diff(got, want))",
          "1640:   }",
          "1641:  })",
          "1643:  t.Run(\"SQLite\", func(t *testing.T) {",
          "1646:   hash := claircore.MustParseDigest(`sha256:6505b024e539929a1909c8820535221fe70806ce5467b5f30aef8d45a4a97da7`)",
          "1647:   l := claircore.Layer{Hash: hash}",
          "1648:   ctx := zlog.Test(context.Background(), t)",
          "1649:   n, err := fetch.Layer(ctx, t, http.DefaultClient, \"registry.access.redhat.com\", \"ubi9/ubi\", hash)",
          "1650:   if err != nil {",
          "1651:    t.Fatal(err)",
          "1652:   }",
          "1653:   defer n.Close()",
          "1654:   l.SetLocal(n.Name())",
          "1655:   wf, err := os.Open(\"testdata/sqlite.rpm-manifest.json\")",
          "1656:   if err != nil {",
          "1657:    t.Fatal(err)",
          "1658:   }",
          "1659:   defer wf.Close()",
          "1660:   want := rpmtest.PackagesFromRPMManifest(t, wf)",
          "1662:   s := &Scanner{}",
          "1663:   got, err := s.Scan(ctx, &l)",
          "1664:   if err != nil {",
          "1665:    t.Error(err)",
          "1666:   }",
          "1667:   t.Logf(\"found %d packages\", len(got))",
          "1668:   if !cmp.Equal(got, want, rpmtest.Options) {",
          "1669:    t.Fatal(cmp.Diff(got, want, rpmtest.Options))",
          "1670:   }",
          "1671:  })",
          "",
          "---------------"
        ],
        "rpm/sqlite.go||rpm/sqlite.go": [
          "File: rpm/sqlite.go -> rpm/sqlite.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package rpm",
          "3: import (",
          "4:  \"bytes\"",
          "5:  \"context\"",
          "6:  \"fmt\"",
          "7:  \"runtime/trace\"",
          "8:  \"strconv\"",
          "9:  \"strings\"",
          "11:  \"github.com/quay/zlog\"",
          "12:  \"golang.org/x/crypto/openpgp/packet\"",
          "14:  \"github.com/quay/claircore\"",
          "15:  \"github.com/quay/claircore/rpm/sqlite\"",
          "16: )",
          "18: func packagesFromInfos(ctx context.Context, db string, infos []sqlite.Info) ([]*claircore.Package, error) {",
          "19:  defer trace.StartRegion(ctx, \"packagesFromInfos\").End()",
          "21:  ps := make([]claircore.Package, 0, len(infos))",
          "22:  pkgs := make([]*claircore.Package, 0, len(infos))",
          "23:  srcs := make([]claircore.Package, 0, len(infos)) // Worst-case size.",
          "24:  src := make(map[string]*claircore.Package)",
          "25:  src[\"(none)\"] = nil",
          "26:  var b strings.Builder",
          "28:  for i := range infos {",
          "29:   info := &infos[i]",
          "30:   idx := len(ps)",
          "31:   ps = append(ps, claircore.Package{",
          "32:    Kind:      claircore.BINARY,",
          "33:    Name:      info.Name,",
          "34:    Arch:      info.Arch,",
          "35:    PackageDB: db,",
          "36:   })",
          "37:   p := &ps[idx]",
          "38:   if strings.Contains(info.Module, \":\") {",
          "39:    p.Module = info.Module",
          "40:   }",
          "41:   p.Version = constructEVR(&b, info)",
          "42:   p.RepositoryHint = constructHint(&b, info)",
          "44:   if s, ok := src[info.SourceNEVR]; ok {",
          "45:    p.Source = s",
          "46:   } else {",
          "47:    s := strings.TrimSuffix(info.SourceNEVR, \".src.rpm\")",
          "48:    pos := len(s)",
          "49:    for i := 0; i < 2; i++ {",
          "50:     pos = strings.LastIndexByte(s[:pos], '-')",
          "51:     if pos == -1 {",
          "52:      return nil, fmt.Errorf(\"malformed NEVR: %q\", info.SourceNEVR)",
          "53:     }",
          "54:    }",
          "56:    idx := len(srcs)",
          "57:    srcs = append(srcs, claircore.Package{",
          "58:     Kind:    claircore.SOURCE,",
          "59:     Name:    s[:pos],",
          "60:     Version: strings.TrimPrefix(s[pos+1:], \"0:\"),",
          "61:    })",
          "62:    pkg := &srcs[idx]",
          "63:    src[info.SourceNEVR] = pkg",
          "64:    p.Source = pkg",
          "65:    if info.Epoch != 0 {",
          "66:     pkg.Version = strconv.Itoa(info.Epoch) + \":\" + pkg.Version",
          "67:    }",
          "68:    if strings.Contains(info.Module, \":\") {",
          "69:     pkg.Module = info.Module",
          "70:    }",
          "71:   }",
          "73:   pkgs = append(pkgs, p)",
          "74:  }",
          "75:  zlog.Debug(ctx).",
          "76:   Int(\"packages\", len(pkgs)).",
          "77:   Int(\"sources\", len(srcs)).",
          "78:   Msg(\"processed sqlite db\")",
          "79:  return pkgs, nil",
          "80: }",
          "82: func constructEVR(b *strings.Builder, info *sqlite.Info) string {",
          "83:  b.Reset()",
          "84:  if info.Epoch != 0 {",
          "85:   fmt.Fprintf(b, \"%d:\", info.Epoch)",
          "86:  }",
          "87:  b.WriteString(info.Version)",
          "88:  b.WriteByte('-')",
          "89:  b.WriteString(info.Release)",
          "90:  return b.String()",
          "91: }",
          "93: func constructHint(b *strings.Builder, info *sqlite.Info) string {",
          "94:  b.Reset()",
          "95:  if info.Digest != \"\" {",
          "96:   b.WriteString(\"hash:\")",
          "97:   switch info.DigestAlgo {",
          "98:   case 8:",
          "99:    b.WriteString(\"sha256:\")",
          "100:    b.WriteString(info.Digest)",
          "101:   }",
          "102:  }",
          "103:  if len(info.Signature) != 0 {",
          "104:   prd := packet.NewReader(bytes.NewReader(info.Signature))",
          "105:   p, err := prd.Next()",
          "106:   for ; err == nil; p, err = prd.Next() {",
          "107:    switch p := p.(type) {",
          "108:    case *packet.SignatureV3:",
          "109:     if p.SigType != 0 {",
          "110:      continue",
          "111:     }",
          "112:     if b.Len() != 0 {",
          "113:      b.WriteByte('|')",
          "114:     }",
          "115:     fmt.Fprintf(b, \"key:%x\", p.IssuerKeyId)",
          "116:    }",
          "117:   }",
          "118:  }",
          "119:  return b.String()",
          "120: }",
          "",
          "---------------"
        ]
      }
    }
  ]
}