{
  "cve_id": "CVE-2024-12678",
  "cve_desc": "Nomad Community and Nomad Enterprise (\"Nomad\") allocations are vulnerable to privilege escalation within a namespace through unredacted workload identity tokens. This vulnerability, identified as CVE-2024-12678, is fixed in Nomad Community Edition 1.9.4 and Nomad Enterprise 1.9.4, 1.8.8, and 1.7.16.",
  "repo": "hashicorp/nomad",
  "patch_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
  "patch_info": {
    "commit_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "repo": "hashicorp/nomad",
    "commit_url": "https://github.com/hashicorp/nomad/commit/359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "files": [
      ".changelog/24683.txt",
      "command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go",
      "nomad/structs/structs.go"
    ],
    "message": "Backport of sec: fix alloc workload identity namespace permission into release/1.9.x (#24685)\n\nCo-authored-by: Deniz Onur Duzgun <59659739+dduzgun-security@users.noreply.github.com>",
    "before_after_code_files": [
      "command/agent/node_endpoint.go||command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go",
      "nomad/structs/structs.go||nomad/structs/structs.go"
    ]
  },
  "patch_diff": {
    "command/agent/node_endpoint.go||command/agent/node_endpoint.go": [
      "File: command/agent/node_endpoint.go -> command/agent/node_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "105:   out.Allocs = make([]*structs.Allocation, 0)",
      "106:  }",
      "107:  for _, alloc := range out.Allocs {",
      "108:   alloc.SetEventDisplayMessages()",
      "109:  }",
      "110:  return out.Allocs, nil",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108:   alloc = alloc.Sanitize()",
      "",
      "---------------"
    ],
    "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go": [
      "File: nomad/alloc_endpoint.go -> nomad/alloc_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "172:    }",
      "176:    if out != nil {",
      "178:     if !aclObj.AllowClientOp() && !allowNsOp(aclObj, out.Namespace) {",
      "179:      return structs.NewErrUnknownAllocation(args.AllocID)",
      "",
      "[Removed Lines]",
      "175:    reply.Alloc = out",
      "",
      "[Added Lines]",
      "176:     out = out.Sanitize()",
      "177:     reply.Alloc = out",
      "",
      "---------------"
    ],
    "nomad/structs/structs.go||nomad/structs/structs.go": [
      "File: nomad/structs/structs.go -> nomad/structs/structs.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "11199:  return a.ID",
      "11200: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11205: func (a *Allocation) Sanitize() *Allocation {",
      "11206:  if a == nil {",
      "11207:   return nil",
      "11208:  }",
      "11210:  if a.SignedIdentities == nil {",
      "11211:   return a",
      "11212:  }",
      "11214:  clean := a.Copy()",
      "11215:  clean.SignedIdentities = nil",
      "11216:  return clean",
      "11217: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e3a7caf53b39165d20e429c7c830fae04cc34a88",
      "candidate_info": {
        "commit_hash": "e3a7caf53b39165d20e429c7c830fae04cc34a88",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/e3a7caf53b39165d20e429c7c830fae04cc34a88",
        "files": [
          ".changelog/24723.txt",
          "ui/app/models/agent.js",
          "ui/app/routes/clients.js",
          "ui/app/routes/servers.js",
          "ui/app/services/system.js",
          "ui/app/styles/core/table.scss",
          "ui/app/templates/components/server-agent-row.hbs",
          "ui/mirage/config.js",
          "ui/mirage/factories/agent.js",
          "ui/mirage/scenarios/default.js",
          "ui/tests/acceptance/servers-list-test.js"
        ],
        "message": "backport of commit ab39f198ff9da49ee83a1f67ec7cc3198c02755f (#24799)\n\nCo-authored-by: Phil Renaud <phil.renaud@hashicorp.com>",
        "before_after_code_files": [
          "ui/app/models/agent.js||ui/app/models/agent.js",
          "ui/app/routes/clients.js||ui/app/routes/clients.js",
          "ui/app/routes/servers.js||ui/app/routes/servers.js",
          "ui/app/services/system.js||ui/app/services/system.js",
          "ui/app/styles/core/table.scss||ui/app/styles/core/table.scss",
          "ui/app/templates/components/server-agent-row.hbs||ui/app/templates/components/server-agent-row.hbs",
          "ui/mirage/config.js||ui/mirage/config.js",
          "ui/mirage/factories/agent.js||ui/mirage/factories/agent.js",
          "ui/mirage/scenarios/default.js||ui/mirage/scenarios/default.js",
          "ui/tests/acceptance/servers-list-test.js||ui/tests/acceptance/servers-list-test.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ui/app/models/agent.js||ui/app/models/agent.js": [
          "File: ui/app/models/agent.js -> ui/app/models/agent.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: import { computed } from '@ember/object';",
          "8: import Model from '@ember-data/model';",
          "9: import { attr } from '@ember-data/model';",
          "11: import formatHost from 'nomad-ui/utils/format-host';",
          "14: export default class Agent extends Model {",
          "15:   @service system;",
          "",
          "[Removed Lines]",
          "10: import classic from 'ember-classic-decorator';",
          "13: @classic",
          "",
          "[Added Lines]",
          "10: import { tracked } from '@glimmer/tracking';",
          "11: import { action } from '@ember/object';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:     return formatHost(address, rpcPort);",
          "30:   }",
          "35:   }",
          "37:   @computed('tags.build')",
          "",
          "[Removed Lines]",
          "32:   @computed('rpcAddr', 'system.leader.rpcAddr')",
          "33:   get isLeader() {",
          "34:     return this.get('system.leader.rpcAddr') === this.rpcAddr;",
          "",
          "[Added Lines]",
          "32:   @tracked isLeader = false;",
          "34:   @action async checkForLeadership() {",
          "35:     const leaders = await this.system.leaders;",
          "36:     this.isLeader = leaders.includes(this.rpcAddr);",
          "37:     return this.isLeader;",
          "",
          "---------------"
        ],
        "ui/app/routes/clients.js||ui/app/routes/clients.js": [
          "File: ui/app/routes/clients.js -> ui/app/routes/clients.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: @classic",
          "14: export default class ClientsRoute extends Route.extend(WithForbiddenState) {",
          "15:   @service store;",
          "22:   model() {",
          "23:     return RSVP.hash({",
          "",
          "[Removed Lines]",
          "16:   @service system;",
          "18:   beforeModel() {",
          "19:     return this.get('system.leader');",
          "20:   }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ui/app/routes/servers.js||ui/app/routes/servers.js": [
          "File: ui/app/routes/servers.js -> ui/app/routes/servers.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "15:   @service store;",
          "16:   @service system;",
          "20:   }",
          "23:     return RSVP.hash({",
          "24:       nodes: this.store.findAll('node'),",
          "26:     }).catch(notifyForbidden(this));",
          "27:   }",
          "28: }",
          "",
          "[Removed Lines]",
          "18:   beforeModel() {",
          "19:     return this.get('system.leader');",
          "22:   model() {",
          "25:       agents: this.store.findAll('agent'),",
          "",
          "[Added Lines]",
          "18:   async beforeModel() {",
          "19:     await this.system.leaders;",
          "22:   async model() {",
          "23:     const agents = await this.store.findAll('agent');",
          "24:     await Promise.all(agents.map((agent) => agent.checkForLeadership()));",
          "27:       agents,",
          "",
          "---------------"
        ],
        "ui/app/services/system.js||ui/app/services/system.js": [
          "File: ui/app/services/system.js -> ui/app/services/system.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: import jsonWithDefault from '../utils/json-with-default';",
          "13: import classic from 'ember-classic-decorator';",
          "14: import { task } from 'ember-concurrency';",
          "16: @classic",
          "17: export default class SystemService extends Service {",
          "18:   @service token;",
          "19:   @service store;",
          "36:   }",
          "38:   @computed",
          "",
          "[Removed Lines]",
          "21:   @computed('activeRegion')",
          "22:   get leader() {",
          "23:     const token = this.token;",
          "25:     return PromiseObject.create({",
          "26:       promise: token",
          "27:         .authorizedRequest(`/${namespace}/status/leader`)",
          "28:         .then((res) => res.json())",
          "29:         .then((rpcAddr) => ({ rpcAddr }))",
          "30:         .then((leader) => {",
          "32:           this.notifyPropertyChange('leader.rpcAddr');",
          "33:           return leader;",
          "34:         }),",
          "35:     });",
          "",
          "[Added Lines]",
          "23:   @computed('regions.[]')",
          "24:   get leaders() {",
          "25:     return Promise.all(",
          "26:       this.regions.map((region) => {",
          "27:         return this.token",
          "28:           .authorizedRequest(`/${namespace}/status/leader?region=${region}`)",
          "29:           .then((res) => res.json());",
          "30:       })",
          "31:     );",
          "",
          "---------------"
        ],
        "ui/app/styles/core/table.scss||ui/app/styles/core/table.scss": [
          "File: ui/app/styles/core/table.scss -> ui/app/styles/core/table.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "110:       white-space: nowrap;",
          "111:     }",
          "114:       .hds-badge__text {",
          "115:         white-space: nowrap;",
          "116:       }",
          "",
          "[Removed Lines]",
          "113:     &.node-status-badges {",
          "",
          "[Added Lines]",
          "113:     &.node-status-badges,",
          "114:     &.server-status-badges {",
          "",
          "---------------"
        ],
        "ui/app/templates/components/server-agent-row.hbs||ui/app/templates/components/server-agent-row.hbs": [
          "File: ui/app/templates/components/server-agent-row.hbs -> ui/app/templates/components/server-agent-row.hbs",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: ~}}",
          "6: <td data-test-server-name",
          "8:     enumerated=true",
          "9:     action=(action this.goToAgent)",
          "10:   }}",
          "",
          "[Removed Lines]",
          "7:   {{keyboard-shortcut",
          "",
          "[Added Lines]",
          "7:   {{keyboard-shortcut",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "16:       @size=\"large\"",
          "17:     />",
          "18:   </span></td>",
          "27: </td>",
          "28: <td data-test-server-address class=\"is-200px is-truncatable\">{{this.agent.address}}</td>",
          "29: <td data-test-server-port>{{this.agent.serfPort}}</td>",
          "",
          "[Removed Lines]",
          "19: <td data-test-server-is-leader>",
          "21:     <Hds::Badge",
          "22:       @text={{if this.agent.isLeader \"True\" \"False\"}}",
          "23:       @icon={{if this.agent.isLeader \"check-circle\" \"\"}}",
          "24:       @color={{if this.agent.isLeader \"success\" \"neutral\"}}",
          "25:       @size=\"large\"",
          "26:     />",
          "",
          "[Added Lines]",
          "19: <td data-test-server-is-leader class=\"server-status-badges\">",
          "20:   <Hds::Badge",
          "21:     @text={{if",
          "22:       this.agent.isLeader",
          "23:       (if",
          "24:         this.agent.system.shouldShowRegions",
          "25:         (concat \"True\" \" (\" this.agent.region \")\")",
          "26:         \"True\"",
          "27:       )",
          "28:       \"False\"",
          "29:     }}",
          "30:     @icon={{if this.agent.isLeader \"check-circle\" \"\"}}",
          "31:     @color={{if this.agent.isLeader \"success\" \"neutral\"}}",
          "32:     @size=\"large\"",
          "33:     class=\"no-wrap\"",
          "34:   />",
          "",
          "---------------"
        ],
        "ui/mirage/config.js||ui/mirage/config.js": [
          "File: ui/mirage/config.js -> ui/mirage/config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: import formatHost from 'nomad-ui/utils/format-host';",
          "14: import faker from 'nomad-ui/mirage/faker';",
          "18:   return formatHost(agent.member.Address, agent.member.Tags.port);",
          "19: }",
          "",
          "[Removed Lines]",
          "16: export function findLeader(schema) {",
          "17:   const agent = schema.agents.first();",
          "",
          "[Added Lines]",
          "16: export function findLeader(schema, region = null) {",
          "17:   let agent;",
          "18:   let agents = schema.agents.all().models;",
          "19:   if (region) {",
          "20:     agent = agents.find((agent) => agent.member?.Tags?.region === region);",
          "21:   } else {",
          "22:     agent = agents[0];",
          "23:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "741:     return logEncode(logFrames, logFrames.length - 1);",
          "742:   });",
          "746:   });",
          "748:   this.get('/acl/tokens', function ({ tokens }, req) {",
          "",
          "[Removed Lines]",
          "744:   this.get('/status/leader', function (schema) {",
          "745:     return JSON.stringify(findLeader(schema));",
          "",
          "[Added Lines]",
          "750:   this.get('/status/leader', function (schema, { queryParams: { region } }) {",
          "751:     let leader = JSON.stringify(findLeader(schema, region));",
          "752:     return leader;",
          "",
          "---------------"
        ],
        "ui/mirage/factories/agent.js||ui/mirage/factories/agent.js": [
          "File: ui/mirage/factories/agent.js -> ui/mirage/factories/agent.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "90:       rpcPortCandidate === serfPort ? rpcPortCandidate + 1 : rpcPortCandidate,",
          "91:     dc: faker.helpers.randomize(DATACENTERS),",
          "92:     build: faker.helpers.randomize(AGENT_BUILDS),",
          "93:   };",
          "94: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "93:     region: 'global',",
          "",
          "---------------"
        ],
        "ui/mirage/scenarios/default.js||ui/mirage/scenarios/default.js": [
          "File: ui/mirage/scenarios/default.js -> ui/mirage/scenarios/default.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:   server.create('feature', { name: 'Dynamic Application Sizing' });",
          "93:   server.create('feature', { name: 'Sentinel Policies' });",
          "94:   server.createList('agent', 3, 'withConsulLink', 'withVaultLink');",
          "95:   server.createList('node-pool', 2);",
          "96:   server.createList('node', 5);",
          "97:   server.create(",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95:   if (withRegions) {",
          "96:     server.db.agents[0].member.Tags.region = server.db.regions[0].id;",
          "97:   }",
          "",
          "---------------"
        ],
        "ui/tests/acceptance/servers-list-test.js||ui/tests/acceptance/servers-list-test.js": [
          "File: ui/tests/acceptance/servers-list-test.js -> ui/tests/acceptance/servers-list-test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "35:   setupApplicationTest(hooks);",
          "36:   setupMirage(hooks);",
          "38:   test('it passes an accessibility audit', async function (assert) {",
          "39:     minimumSetup();",
          "40:     await ServersList.visit();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38:   hooks.beforeEach(function () {",
          "39:     server.create('region', { id: 'global' });",
          "40:   });",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "116:     await ServersList.error.seekHelp();",
          "117:     assert.equal(currentURL(), '/settings/tokens');",
          "118:   });",
          "119: });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "123:   test('multiple regions should each show leadership values', async function (assert) {",
          "124:     server.createList('node-pool', 1);",
          "125:     server.createList('node', 1);",
          "126:     server.create('region', { id: 'global' });",
          "127:     server.create('region', { id: 'galactic' });",
          "128:     server.createList('agent', 3);",
          "129:     server.db.agents[0].member.Tags.region = 'global';",
          "130:     server.db.agents[1].member.Tags.region = 'galactic';",
          "131:     server.db.agents[2].member.Tags.region = 'galactic';",
          "132:     await ServersList.visit();",
          "133:     assert.equal(",
          "134:       ServersList.servers.objectAt(0).leader,",
          "135:       'True (galactic)',",
          "136:       'Leadership is shown for the galactic region'",
          "137:     );",
          "138:     assert.equal(",
          "139:       ServersList.servers.objectAt(1).leader,",
          "140:       'True (global)',",
          "141:       'Leadership is shown for the global region'",
          "142:     );",
          "143:     assert.equal(",
          "144:       ServersList.servers.objectAt(2).leader,",
          "145:       'False',",
          "146:       'Non-leader servers are shown'",
          "147:     );",
          "148:   });",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "43c82b39a331c10a2d047c017778dff71ba71c3e",
      "candidate_info": {
        "commit_hash": "43c82b39a331c10a2d047c017778dff71ba71c3e",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/43c82b39a331c10a2d047c017778dff71ba71c3e",
        "files": [
          ".changelog/24383.txt",
          "nomad/encrypter.go",
          "nomad/encrypter_test.go"
        ],
        "message": "keyring: Fix a panic when decrypting aead with empty RSA block. (#24391)\n\nClusters that have gone through several upgrades have be found to\ninclude keyring material which has an empty RSA block.\n\nIn more recent versions of Nomad, an empty RSA block is omitted\nfrom being written to disk. This results in the panic not being\npresent. Older versions, however, did not have this struct tag\nmeaning we wrote an empty JSON block which is not accounted for\nin the current version.\n\nCo-authored-by: James Rasell <jrasell@users.noreply.github.com>",
        "before_after_code_files": [
          "nomad/encrypter.go||nomad/encrypter.go",
          "nomad/encrypter_test.go||nomad/encrypter_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "nomad/encrypter.go||nomad/encrypter.go": [
          "File: nomad/encrypter.go -> nomad/encrypter.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "807:  var rsaKey []byte",
          "809:   rsaKey, err = wrapper.Decrypt(e.srv.shutdownCtx, kekWrapper.WrappedRSAKey)",
          "810:   if err != nil {",
          "811:    return nil, fmt.Errorf(\"%w (rsa key): %w\", ErrDecryptFailed, err)",
          "",
          "[Removed Lines]",
          "808:  if kekWrapper.WrappedRSAKey != nil {",
          "",
          "[Added Lines]",
          "808:  if kekWrapper.WrappedRSAKey != nil && len(kekWrapper.WrappedRSAKey.Ciphertext) > 0 {",
          "",
          "---------------"
        ],
        "nomad/encrypter_test.go||nomad/encrypter_test.go": [
          "File: nomad/encrypter_test.go -> nomad/encrypter_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "121: }",
          "125: func TestEncrypter_Restore(t *testing.T) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: func TestEncrypter_loadKeyFromStore_emptyRSA(t *testing.T) {",
          "126:  ci.Parallel(t)",
          "128:  srv := &Server{",
          "129:   logger: testlog.HCLogger(t),",
          "130:   config: &Config{},",
          "131:  }",
          "133:  tmpDir := t.TempDir()",
          "135:  key, err := structs.NewUnwrappedRootKey(structs.EncryptionAlgorithmAES256GCM)",
          "136:  must.NoError(t, err)",
          "138:  encrypter, err := NewEncrypter(srv, tmpDir)",
          "139:  must.NoError(t, err)",
          "141:  wrappedKey, err := encrypter.encryptDEK(key, &structs.KEKProviderConfig{})",
          "142:  must.NotNil(t, wrappedKey)",
          "143:  must.NoError(t, err)",
          "146:  kek, err := json.Marshal(wrappedKey.KeyEncryptionKey)",
          "147:  must.NoError(t, err)",
          "149:  wrappedDEKCipher, err := json.Marshal(wrappedKey.WrappedDataEncryptionKey.Ciphertext)",
          "150:  must.NoError(t, err)",
          "152:  testData := fmt.Sprintf(`",
          "153:  {",
          "154:   \"Meta\": {",
          "155:     \"KeyID\": %q,",
          "156:     \"Algorithm\": \"aes256-gcm\",",
          "157:     \"CreateTime\": 1730000000000000000,",
          "158:     \"CreateIndex\": 1555555,",
          "159:     \"ModifyIndex\": 1555555,",
          "160:     \"State\": \"active\",",
          "161:     \"PublishTime\": 0",
          "162:   },",
          "163:   \"ProviderID\": \"aead\",",
          "164:   \"WrappedDEK\": {",
          "165:     \"ciphertext\": %s,",
          "166:     \"key_info\": {",
          "167:       \"key_id\": %q",
          "168:     }",
          "169:   },",
          "170:   \"WrappedRSAKey\": {},",
          "171:   \"KEK\": %s",
          "172:  }",
          "173:  `, key.Meta.KeyID, wrappedDEKCipher, key.Meta.KeyID, kek)",
          "175:  path := filepath.Join(tmpDir, key.Meta.KeyID+\".nks.json\")",
          "176:  err = os.WriteFile(path, []byte(testData), 0o600)",
          "177:  must.NoError(t, err)",
          "179:  unwrappedKey, err := encrypter.loadKeyFromStore(path)",
          "180:  must.NoError(t, err)",
          "181:  must.NotNil(t, unwrappedKey)",
          "182: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b7410b015c4579db67d1c38b22ec623c1888c212",
      "candidate_info": {
        "commit_hash": "b7410b015c4579db67d1c38b22ec623c1888c212",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/b7410b015c4579db67d1c38b22ec623c1888c212",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "backport of commit 21ad3ed938a8c48fbf47afd7a7ec15d02e0a4b35 (#25135)\n\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  github.com/hashicorp/consul/api v1.30.0",
          "52:  github.com/hashicorp/consul/sdk v0.16.1",
          "53:  github.com/hashicorp/cronexpr v1.1.2",
          "55:  github.com/hashicorp/go-checkpoint v0.5.0",
          "56:  github.com/hashicorp/go-cleanhttp v0.5.2",
          "57:  github.com/hashicorp/go-connlimit v0.3.0",
          "",
          "[Removed Lines]",
          "54:  github.com/hashicorp/go-bexpr v0.1.13",
          "",
          "[Added Lines]",
          "54:  github.com/hashicorp/go-bexpr v0.1.14",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "1169: github.com/hashicorp/errwrap v1.0.0/go.mod h1:YH+1FKiLXxHSkmPseP+kNlulaMuP3n2brvKWEqk/Jc4=",
          "1170: github.com/hashicorp/errwrap v1.1.0 h1:OxrOeh75EUXMY8TBjag2fzXGZ40LB6IKw45YeGUDY2I=",
          "1171: github.com/hashicorp/errwrap v1.1.0/go.mod h1:YH+1FKiLXxHSkmPseP+kNlulaMuP3n2brvKWEqk/Jc4=",
          "1174: github.com/hashicorp/go-checkpoint v0.5.0 h1:MFYpPZCnQqQTE18jFwSII6eUQrD/oxMFp3mlgcqk5mU=",
          "1175: github.com/hashicorp/go-checkpoint v0.5.0/go.mod h1:7nfLNL10NsxqO4iWuW6tWW0HjZuDrwkBuEQsVcpCOgg=",
          "1176: github.com/hashicorp/go-cleanhttp v0.5.0/go.mod h1:JpRdi6/HCYpAwUzNwuwqhbovhLtngrth3wmdIIUrZ80=",
          "",
          "[Removed Lines]",
          "1172: github.com/hashicorp/go-bexpr v0.1.13 h1:HNwp7vZrMpRq8VZXj8VF90LbZpRjQQpim1oJF0DgSwg=",
          "1173: github.com/hashicorp/go-bexpr v0.1.13/go.mod h1:gN7hRKB3s7yT+YvTdnhZVLTENejvhlkZ8UE4YVBS+Q8=",
          "",
          "[Added Lines]",
          "1172: github.com/hashicorp/go-bexpr v0.1.14 h1:uKDeyuOhWhT1r5CiMTjdVY4Aoxdxs6EtwgTGnlosyp4=",
          "1173: github.com/hashicorp/go-bexpr v0.1.14/go.mod h1:gN7hRKB3s7yT+YvTdnhZVLTENejvhlkZ8UE4YVBS+Q8=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a703be3959b7f8d6c3c87771780eeb1d12d38692",
      "candidate_info": {
        "commit_hash": "a703be3959b7f8d6c3c87771780eeb1d12d38692",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/a703be3959b7f8d6c3c87771780eeb1d12d38692",
        "files": [
          "ui/package.json",
          "ui/yarn.lock"
        ],
        "message": "backport of commit 3aaf6d8791adbfcb64398131a6363e3fc9694ddb (#24251)\n\nCo-authored-by: Phil Renaud <phil.renaud@hashicorp.com>",
        "before_after_code_files": [
          "ui/yarn.lock||ui/yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ui/yarn.lock||ui/yarn.lock": [
          "File: ui/yarn.lock -> ui/yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "2694:   resolved \"https://registry.yarnpkg.com/@oddbird/popover-polyfill/-/popover-polyfill-0.4.3.tgz#310d61c8fc7ee12d8dba05cdfa8bd7e5d5a281a3\"",
          "2695:   integrity sha512-kBS0ZAwH8kZqFl0mV89KPK4cLYl2ZoKSfYngK4dz1eLAhKzTK0yu4LrvLdMeM7JhjWK6GxBtiY+cl1s6vR2pUg==",
          "2701:   dependencies:",
          "2709:   dependencies:",
          "2716:   dependencies:",
          "2725:   dependencies:",
          "2732:   dependencies:",
          "2734:     cross-spawn \"^7.0.3\"",
          "2735:     which \"^2.0.2\"",
          "2741:   dependencies:",
          "2743:     yaml \"^2.0.0\"",
          "2749:   dependencies:",
          "2751:     fast-glob \"^3.2.11\"",
          "2752:     image-size \"^1.0.0\"",
          "2776:     pako \"^2.1.0\"",
          "2782:   dependencies:",
          "2784:     ajv \"^8.6.2\"",
          "2785:     cosmiconfig \"^8.0.0\"",
          "2786:     yaml \"^2.0.0\"",
          "2792:   dependencies:",
          "2798:     content-disposition \"^0.5.4\"",
          "2799:     cross-spawn \"^7.0.3\"",
          "2800:     extract-zip \"^2.0.1\"",
          "2801:     fast-glob \"^3.2.11\"",
          "2803:     mime-types \"^2.1.34\"",
          "2804:     pako \"^2.1.0\"",
          "2806:     rimraf \"^3.0.2\"",
          "2808:     yaml \"^2.4.1\"",
          "2819:   dependencies:",
          "2821:     ember-cli-babel \"^7.26.11\"",
          "2827:   dependencies:",
          "2844:   dependencies:",
          "2848: \"@popperjs/core@^2.9.0\":",
          "2849:   version \"2.11.8\"",
          "",
          "[Removed Lines]",
          "2697: \"@percy/cli-app@1.28.7\":",
          "2698:   version \"1.28.7\"",
          "2699:   resolved \"https://registry.yarnpkg.com/@percy/cli-app/-/cli-app-1.28.7.tgz#0b77c98a6f0fc87321015b0b7709148719f23f4e\"",
          "2700:   integrity sha512-5Dgtx3m+eX2NPYrt11gOAhH0q4UYFORzOTkocELQZ6+9naKOi0PD9e9/T8A6yRQ5dbfMoNfi/xQ9tLoxCPcM5g==",
          "2702:     \"@percy/cli-command\" \"1.28.7\"",
          "2703:     \"@percy/cli-exec\" \"1.28.7\"",
          "2705: \"@percy/cli-build@1.28.7\":",
          "2706:   version \"1.28.7\"",
          "2707:   resolved \"https://registry.yarnpkg.com/@percy/cli-build/-/cli-build-1.28.7.tgz#8a7aa9ba464aefdf070d7bb013704273e350b4a4\"",
          "2708:   integrity sha512-LXDXbE3G994K1Wovivukjbzj7wqENPa/A3WvveVdLqfTLepTcJZ3LvPV79BsgJgIMN2vksaeCxwIgjMn1vT8mQ==",
          "2710:     \"@percy/cli-command\" \"1.28.7\"",
          "2712: \"@percy/cli-command@1.28.7\":",
          "2713:   version \"1.28.7\"",
          "2714:   resolved \"https://registry.yarnpkg.com/@percy/cli-command/-/cli-command-1.28.7.tgz#673b859fa4585ea72551a03fa82ba2dca900d14d\"",
          "2715:   integrity sha512-Rs66JVZLdb4D/+hPXNdd9Qi9+FA9xCgrzpmdKak8HzstcfsRdJ999J5exQZc7dM1N3Th76wrA5d4woCgDskYDQ==",
          "2717:     \"@percy/config\" \"1.28.7\"",
          "2718:     \"@percy/core\" \"1.28.7\"",
          "2719:     \"@percy/logger\" \"1.28.7\"",
          "2721: \"@percy/cli-config@1.28.7\":",
          "2722:   version \"1.28.7\"",
          "2723:   resolved \"https://registry.yarnpkg.com/@percy/cli-config/-/cli-config-1.28.7.tgz#c3a4f11d4c23d4773c61c4835708429d35903280\"",
          "2724:   integrity sha512-26Wo9EYQt2uDROSjNyYMX8XuJ30IPIwR4JsNKO0DbQUBqq071to5AiaROXs2QLH0m2KGFyYavLxHJ54ZCDbMQQ==",
          "2726:     \"@percy/cli-command\" \"1.28.7\"",
          "2728: \"@percy/cli-exec@1.28.7\":",
          "2729:   version \"1.28.7\"",
          "2730:   resolved \"https://registry.yarnpkg.com/@percy/cli-exec/-/cli-exec-1.28.7.tgz#aae8b21b20736baf5d1bbca3d4fe3ef4ab59d480\"",
          "2731:   integrity sha512-0HEOmMNexRbn09Ju3Etd5agEhBtgqNrT3eiRMcX4ThbQgOFkAQIll6IFfVqafujJHNL1SF+HjcyZmyoEF9tJOw==",
          "2733:     \"@percy/cli-command\" \"1.28.7\"",
          "2737: \"@percy/cli-snapshot@1.28.7\":",
          "2738:   version \"1.28.7\"",
          "2739:   resolved \"https://registry.yarnpkg.com/@percy/cli-snapshot/-/cli-snapshot-1.28.7.tgz#0fd99733cb9fa2199133c0b429fb9fd310a6d733\"",
          "2740:   integrity sha512-nWk2/sjIh8Vy6+T7BNwSVdtXUdR0cYpXJrbO1hfxRB56pUf8KFcG7GqUzOZ7QDHqlyQGH/posAjAoPmy8okyAQ==",
          "2742:     \"@percy/cli-command\" \"1.28.7\"",
          "2745: \"@percy/cli-upload@1.28.7\":",
          "2746:   version \"1.28.7\"",
          "2747:   resolved \"https://registry.yarnpkg.com/@percy/cli-upload/-/cli-upload-1.28.7.tgz#ab8f178f0001ec5e66fc5bcade0efffcf5e5bd91\"",
          "2748:   integrity sha512-hcIe9RGHDk+G+lanlLy1IrDRgODsTYzjmtPex9wEg4yo/JzubVwkF3r/0iQuT+srkELKUcTSJ1iX7/d0kK61uQ==",
          "2750:     \"@percy/cli-command\" \"1.28.7\"",
          "2754: \"@percy/cli@^1.6.1\":",
          "2755:   version \"1.28.7\"",
          "2756:   resolved \"https://registry.yarnpkg.com/@percy/cli/-/cli-1.28.7.tgz#4608d5347da6858d4f11720dc15947ee14d17024\"",
          "2757:   integrity sha512-FvvyTFTGuIiBsSs8epENGq2U62oKnzfXW6F80JFShaZ5ZjMc2t6riVq4EPEsBANstql+j4Y853tYe2aGVX9pbw==",
          "2758:   dependencies:",
          "2759:     \"@percy/cli-app\" \"1.28.7\"",
          "2760:     \"@percy/cli-build\" \"1.28.7\"",
          "2761:     \"@percy/cli-command\" \"1.28.7\"",
          "2762:     \"@percy/cli-config\" \"1.28.7\"",
          "2763:     \"@percy/cli-exec\" \"1.28.7\"",
          "2764:     \"@percy/cli-snapshot\" \"1.28.7\"",
          "2765:     \"@percy/cli-upload\" \"1.28.7\"",
          "2766:     \"@percy/client\" \"1.28.7\"",
          "2767:     \"@percy/logger\" \"1.28.7\"",
          "2769: \"@percy/client@1.28.7\":",
          "2770:   version \"1.28.7\"",
          "2771:   resolved \"https://registry.yarnpkg.com/@percy/client/-/client-1.28.7.tgz#7baced7a2b2cb82de294f9943d749f8bc440e1f3\"",
          "2772:   integrity sha512-3ocKEej268Xj3q98seUi88mtFcTYNy3F/zMTwk+pdnoWc1QVOGsCQ3elIS2X35hhBFgYw2i1bbuzmt7UdOK79A==",
          "2773:   dependencies:",
          "2774:     \"@percy/env\" \"1.28.7\"",
          "2775:     \"@percy/logger\" \"1.28.7\"",
          "2778: \"@percy/config@1.28.7\":",
          "2779:   version \"1.28.7\"",
          "2780:   resolved \"https://registry.yarnpkg.com/@percy/config/-/config-1.28.7.tgz#b304fd2bb8da08b05046605645583870d4a1887e\"",
          "2781:   integrity sha512-N8fZAj8ejgddxz4lzNIK9cCQdoIuISK7a/JyGAD5vY+CuZutCBM0zuN9g/Higv/LI78Sct69Qpik/+rLIyBZxA==",
          "2783:     \"@percy/logger\" \"1.28.7\"",
          "2788: \"@percy/core@1.28.7\":",
          "2789:   version \"1.28.7\"",
          "2790:   resolved \"https://registry.yarnpkg.com/@percy/core/-/core-1.28.7.tgz#7576ecf1f69b45e160c59bb5f8adbb8af139eb2d\"",
          "2791:   integrity sha512-OOTVMHU+0O7Qh3TIL21fxX9H5ctRWPIG03IJsFpIXIIh2Wni5nf8tSUWroFwSSneZihxaA8ETQxCtJXBVe+JUA==",
          "2793:     \"@percy/client\" \"1.28.7\"",
          "2794:     \"@percy/config\" \"1.28.7\"",
          "2795:     \"@percy/dom\" \"1.28.7\"",
          "2796:     \"@percy/logger\" \"1.28.7\"",
          "2797:     \"@percy/webdriver-utils\" \"1.28.7\"",
          "2802:     micromatch \"^4.0.4\"",
          "2805:     path-to-regexp \"^6.2.0\"",
          "2807:     ws \"^8.0.0\"",
          "2810: \"@percy/dom@1.28.7\":",
          "2811:   version \"1.28.7\"",
          "2812:   resolved \"https://registry.yarnpkg.com/@percy/dom/-/dom-1.28.7.tgz#6d07e96ee630ac3762e1e94804d94a1d038f8558\"",
          "2813:   integrity sha512-aYm/xTqNWaLodRdmWqiA0zekaUMkE8boJ1ApljO8KTKihv7eJWpgSDJT7m73xOd/JAplER5LSGjrUpnWLOTDYQ==",
          "2815: \"@percy/ember@^3.0.0\":",
          "2816:   version \"3.0.1\"",
          "2817:   resolved \"https://registry.yarnpkg.com/@percy/ember/-/ember-3.0.1.tgz#2f1f74993db8b327391ff657316d3083a8e27ecb\"",
          "2818:   integrity sha512-TOTwai5AsjtpAUWnCijKp8djfsWXfo4eUfF0Wc4QUjba+d3rk9FzvcppjJSmDPSJplyBlAyv1bxO1NMIfr80WQ==",
          "2820:     \"@percy/sdk-utils\" \"^1.6.4\"",
          "2823: \"@percy/env@1.28.7\":",
          "2824:   version \"1.28.7\"",
          "2825:   resolved \"https://registry.yarnpkg.com/@percy/env/-/env-1.28.7.tgz#3dc71ff9e30e53681618f8ab389721acc1f734a4\"",
          "2826:   integrity sha512-ExpCDSm2bMwTlF7LOuE6dDB0QFa2VzpuFF/t9O0TyUgBgaiDZzcdsMQrLxDlUbuqjA8vc+vo8931x0i2sN5LBQ==",
          "2828:     \"@percy/logger\" \"1.28.7\"",
          "2830: \"@percy/logger@1.28.7\":",
          "2831:   version \"1.28.7\"",
          "2832:   resolved \"https://registry.yarnpkg.com/@percy/logger/-/logger-1.28.7.tgz#3ef2e35cefdc717ace4918fb9e42ef6e60a4beb4\"",
          "2833:   integrity sha512-OktqjykPT3FMUKkwyafjQdRWMQ8jnXOOcSkvyVIT9P7cbU1USeRUWw8Z6+W1cLk50RdsimChnab6F/GRWRdBew==",
          "2835: \"@percy/sdk-utils@1.28.7\", \"@percy/sdk-utils@^1.6.4\":",
          "2836:   version \"1.28.7\"",
          "2837:   resolved \"https://registry.yarnpkg.com/@percy/sdk-utils/-/sdk-utils-1.28.7.tgz#22393f76d69ffee2f4def79aa41f15a7369f7503\"",
          "2838:   integrity sha512-LIhfHnkcS0fyIdo3gvKn7rwodZjbEtyLkgiDRSRulcBOatI2mhn2Bh269sXXiiFTyAW2BDQjyE3DWc4hkGbsbQ==",
          "2840: \"@percy/webdriver-utils@1.28.7\":",
          "2841:   version \"1.28.7\"",
          "2842:   resolved \"https://registry.yarnpkg.com/@percy/webdriver-utils/-/webdriver-utils-1.28.7.tgz#b17573f8e42f2830c4ca95a388dcc41d9f8351b5\"",
          "2843:   integrity sha512-BviRMj/oHgdniHoz1nzInpIXl4JTk4vZ0+9azWntGCThITc/HhQE1sLDcHhZGYvviY+NQ4ofCcBSzZRu1z1GcQ==",
          "2845:     \"@percy/config\" \"1.28.7\"",
          "2846:     \"@percy/sdk-utils\" \"1.28.7\"",
          "",
          "[Added Lines]",
          "2697: \"@percy/cli-app@1.30.0\":",
          "2698:   version \"1.30.0\"",
          "2699:   resolved \"https://registry.yarnpkg.com/@percy/cli-app/-/cli-app-1.30.0.tgz#d9b0058514766bcfd0c36887c062a2824f0362f9\"",
          "2700:   integrity sha512-omBN3mwZVlOv06pIL1sHfN18iQ6fJcyJtWVtPS82idSHBm0xWe4ulcAAXAJAI31opKUIh1dM1LDxFDJBQEA1Tw==",
          "2702:     \"@percy/cli-command\" \"1.30.0\"",
          "2703:     \"@percy/cli-exec\" \"1.30.0\"",
          "2705: \"@percy/cli-build@1.30.0\":",
          "2706:   version \"1.30.0\"",
          "2707:   resolved \"https://registry.yarnpkg.com/@percy/cli-build/-/cli-build-1.30.0.tgz#257bdc430c94cece9e900cd5091e157f8d087cb5\"",
          "2708:   integrity sha512-VEdKQQCdfdjZHLBjQMXILSeiCEwuKaGvfi9TQqE+4ZPWzOUorjf/Knpnm5+FvvpJYcB3TgNIZ7H/jQE9LokChg==",
          "2710:     \"@percy/cli-command\" \"1.30.0\"",
          "2712: \"@percy/cli-command@1.30.0\":",
          "2713:   version \"1.30.0\"",
          "2714:   resolved \"https://registry.yarnpkg.com/@percy/cli-command/-/cli-command-1.30.0.tgz#4f6069d6ea488cd06aa6bc779d484d2fa6969187\"",
          "2715:   integrity sha512-5gUZfUaYY4O4UdS4yAKCkVuEQov8ZmBRez2oE9wZti1kCavcRJ3cps31qMiXWyRBzAru+MdDxpoDD40KGK5m5g==",
          "2717:     \"@percy/config\" \"1.30.0\"",
          "2718:     \"@percy/core\" \"1.30.0\"",
          "2719:     \"@percy/logger\" \"1.30.0\"",
          "2721: \"@percy/cli-config@1.30.0\":",
          "2722:   version \"1.30.0\"",
          "2723:   resolved \"https://registry.yarnpkg.com/@percy/cli-config/-/cli-config-1.30.0.tgz#b6535d771d6180f97299ca9ab97df2c50f24fad5\"",
          "2724:   integrity sha512-LUVrQZMjswTS5bifrpbU/vL/fFCx+Pl8FG+rRA5f8tnVBnLxnMpGeOFhKf8mmkg32YJxGhmmXn//pR4aupN4oA==",
          "2726:     \"@percy/cli-command\" \"1.30.0\"",
          "2728: \"@percy/cli-exec@1.30.0\":",
          "2729:   version \"1.30.0\"",
          "2730:   resolved \"https://registry.yarnpkg.com/@percy/cli-exec/-/cli-exec-1.30.0.tgz#57d6f6f9a2d23db188763763b262bc3497532be7\"",
          "2731:   integrity sha512-9uSrPY+VhRXmuIiPO0+XoZNJcwrfdZqmCcR8nZdSlLvgoGbm/4/gzMNnlazzgY+NHkMSVpZyE6tTiAePjweuIA==",
          "2733:     \"@percy/cli-command\" \"1.30.0\"",
          "2734:     \"@percy/logger\" \"1.30.0\"",
          "2738: \"@percy/cli-snapshot@1.30.0\":",
          "2739:   version \"1.30.0\"",
          "2740:   resolved \"https://registry.yarnpkg.com/@percy/cli-snapshot/-/cli-snapshot-1.30.0.tgz#543ff190b416e0e36848c97c2c5d2cb0763f23f0\"",
          "2741:   integrity sha512-EdCnZUcq7O5SDymmzzdJSuoAvWa25fZtAn7ji4W7moWDAY3r62Q4S8ZC4NfMbvihbBa1FJTzbgOHbfS3gSgbkQ==",
          "2743:     \"@percy/cli-command\" \"1.30.0\"",
          "2746: \"@percy/cli-upload@1.30.0\":",
          "2747:   version \"1.30.0\"",
          "2748:   resolved \"https://registry.yarnpkg.com/@percy/cli-upload/-/cli-upload-1.30.0.tgz#f8ad4ed542073b287f14a5115f1b07978b616670\"",
          "2749:   integrity sha512-vtgQU6JbnDUUe/+8teN2E0vfHS/NeRRe0n9Nc/e8MgMXWXhgZEWWPC8jlwwIliCFgkiWl+zWXD6OAbSlyoBtYw==",
          "2751:     \"@percy/cli-command\" \"1.30.0\"",
          "2755: \"@percy/cli@^1.30.0\":",
          "2756:   version \"1.30.0\"",
          "2757:   resolved \"https://registry.yarnpkg.com/@percy/cli/-/cli-1.30.0.tgz#33f59e5e368961c1e3b504e02a62027a82dcdc0b\"",
          "2758:   integrity sha512-d5mJQkhYJdL/fOZGuk2sBymYSYCncM+adpOrI3kINVLSXH7CAvYfrnJNLZ5Ib2xQDS85QeCFIb9noivPqXtkPw==",
          "2759:   dependencies:",
          "2760:     \"@percy/cli-app\" \"1.30.0\"",
          "2761:     \"@percy/cli-build\" \"1.30.0\"",
          "2762:     \"@percy/cli-command\" \"1.30.0\"",
          "2763:     \"@percy/cli-config\" \"1.30.0\"",
          "2764:     \"@percy/cli-exec\" \"1.30.0\"",
          "2765:     \"@percy/cli-snapshot\" \"1.30.0\"",
          "2766:     \"@percy/cli-upload\" \"1.30.0\"",
          "2767:     \"@percy/client\" \"1.30.0\"",
          "2768:     \"@percy/logger\" \"1.30.0\"",
          "2770: \"@percy/client@1.30.0\":",
          "2771:   version \"1.30.0\"",
          "2772:   resolved \"https://registry.yarnpkg.com/@percy/client/-/client-1.30.0.tgz#7204eb27f0c0e92d1d57eb1fe0b83f15da974382\"",
          "2773:   integrity sha512-kNAoa07QtlIHvail0+vjd0xfvO4OxI97fV73pefe6PtJ1u3Cze+q4DEFPWxcJ39wjUD4C2f3TgJ2CzhEm53yiw==",
          "2774:   dependencies:",
          "2775:     \"@percy/env\" \"1.30.0\"",
          "2776:     \"@percy/logger\" \"1.30.0\"",
          "2779: \"@percy/config@1.30.0\":",
          "2780:   version \"1.30.0\"",
          "2781:   resolved \"https://registry.yarnpkg.com/@percy/config/-/config-1.30.0.tgz#bb1b2ec5d7bce505ecdda7f34d31b77692fa7464\"",
          "2782:   integrity sha512-mOhLn9fqQTMgXA8Li1UxjZCcLQcokeQtsedlCXdzzt2QbS9DFcV3koMyooabOO6MsCNh4wI7J/zcXu08c4H9Vw==",
          "2784:     \"@percy/logger\" \"1.30.0\"",
          "2789: \"@percy/core@1.30.0\":",
          "2790:   version \"1.30.0\"",
          "2791:   resolved \"https://registry.yarnpkg.com/@percy/core/-/core-1.30.0.tgz#51525255bc64bbba32ab421f2ffa17160207fefe\"",
          "2792:   integrity sha512-MeAhFWCf97xVvx8c6XsSpC+uWRbM0RE5llXmC7U5JH2cYZXoyzul2eZacYUmQJPVzEaWduXLDCukYIa0nDo1+A==",
          "2794:     \"@percy/client\" \"1.30.0\"",
          "2795:     \"@percy/config\" \"1.30.0\"",
          "2796:     \"@percy/dom\" \"1.30.0\"",
          "2797:     \"@percy/logger\" \"1.30.0\"",
          "2798:     \"@percy/webdriver-utils\" \"1.30.0\"",
          "2803:     micromatch \"^4.0.8\"",
          "2806:     path-to-regexp \"^6.3.0\"",
          "2808:     ws \"^8.17.1\"",
          "2811: \"@percy/dom@1.30.0\":",
          "2812:   version \"1.30.0\"",
          "2813:   resolved \"https://registry.yarnpkg.com/@percy/dom/-/dom-1.30.0.tgz#69838a0cac541e9451dccf2145dbd497e0d21590\"",
          "2814:   integrity sha512-i3uHFDAzXCLAeI0oTDDWIaRq1wiGwoRknS1QfIfy7usAia+ipeWhWb+m3sXtfg/g6WyBzcg3OtG1tIB8TO7/4g==",
          "2816: \"@percy/ember@^4.2.0\":",
          "2817:   version \"4.2.0\"",
          "2818:   resolved \"https://registry.yarnpkg.com/@percy/ember/-/ember-4.2.0.tgz#b6fdeec46a88ae80da9d8a1c689b5bb67bf5992e\"",
          "2819:   integrity sha512-D/WckDD2tQetdn8uq46nQA1rOVgov8jsZG4uN7snAq6SrOpxNxacONg37QPwczmICBc7o/NlipCAUteukmtKzg==",
          "2821:     \"@percy/sdk-utils\" \"^1.18.0\"",
          "2824: \"@percy/env@1.30.0\":",
          "2825:   version \"1.30.0\"",
          "2826:   resolved \"https://registry.yarnpkg.com/@percy/env/-/env-1.30.0.tgz#e3f226c9b2d372523a22c2316d08f3d066061327\"",
          "2827:   integrity sha512-+h7c0lxB01bnymTZfM24RrjMIL28rQWeT4aQ/BJVlvAELstZaYwl0vv8RrAtBUKnSZaXUkNIOWZtgFiuer/y0g==",
          "2829:     \"@percy/logger\" \"1.30.0\"",
          "2831: \"@percy/logger@1.30.0\":",
          "2832:   version \"1.30.0\"",
          "2833:   resolved \"https://registry.yarnpkg.com/@percy/logger/-/logger-1.30.0.tgz#34ba131e8c4f369b05ed92f9e04eb7a28649e617\"",
          "2834:   integrity sha512-p5ZxD9fFRjCiMF630xIDRv2hPH70TI20r9yIyHgjmCM4ES0Cfu+61gaRpiSaay0DWKfG6iwpmUhZsKafRMSYCw==",
          "2836: \"@percy/sdk-utils@1.30.0\", \"@percy/sdk-utils@^1.18.0\":",
          "2837:   version \"1.30.0\"",
          "2838:   resolved \"https://registry.yarnpkg.com/@percy/sdk-utils/-/sdk-utils-1.30.0.tgz#0a634d530d46729606b9866e0c558a4e9d46362e\"",
          "2839:   integrity sha512-GPEexJ0gxiFXqjFpL8EtILZo/arrwdz96oyZMsCeRu9bVSQ8ZvptFlwO8hYKtXvZcY7CJfGnUyOcza8CYPxM3g==",
          "2841: \"@percy/webdriver-utils@1.30.0\":",
          "2842:   version \"1.30.0\"",
          "2843:   resolved \"https://registry.yarnpkg.com/@percy/webdriver-utils/-/webdriver-utils-1.30.0.tgz#3af84df647c956b69de401703cde5630c3d58d9e\"",
          "2844:   integrity sha512-93S0U1enM9mHR99iEjPSekrZc3/DI+GYYXicvM8nFD9FHlXuMbykHCU0hKJAZF/IvlucVnH04s3yomn/58cXAw==",
          "2846:     \"@percy/config\" \"1.30.0\"",
          "2847:     \"@percy/sdk-utils\" \"1.30.0\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11065:     braces \"^3.0.3\"",
          "11066:     picomatch \"^2.3.1\"",
          "11068: mime-db@1.52.0, \"mime-db@>= 1.43.0 < 2\":",
          "11069:   version \"1.52.0\"",
          "11070:   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.52.0.tgz#bbabcdc02859f4987301c856e3387ce5ec43bf70\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11069: micromatch@^4.0.8:",
          "11070:   version \"4.0.8\"",
          "11071:   resolved \"https://registry.yarnpkg.com/micromatch/-/micromatch-4.0.8.tgz#d66fa18f3a47076789320b9b1af32bd86d9fa202\"",
          "11072:   integrity sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
          "11073:   dependencies:",
          "11074:     braces \"^3.0.3\"",
          "11075:     picomatch \"^2.3.1\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11846:   dependencies:",
          "11847:     isarray \"0.0.1\"",
          "11854: path-type@^3.0.0:",
          "11855:   version \"3.0.0\"",
          "",
          "[Removed Lines]",
          "11849: path-to-regexp@^6.2.0:",
          "11850:   version \"6.2.2\"",
          "11851:   resolved \"https://registry.yarnpkg.com/path-to-regexp/-/path-to-regexp-6.2.2.tgz#324377a83e5049cbecadc5554d6a63a9a4866b36\"",
          "11852:   integrity sha512-GQX3SSMokngb36+whdpRXE+3f9V8UzyAorlYvOGx87ufGHehNTn5lCxrKtLyZ4Yl/wEKnNnr98ZzOwwDZV5ogw==",
          "",
          "[Added Lines]",
          "11858: path-to-regexp@^6.3.0:",
          "11859:   version \"6.3.0\"",
          "11860:   resolved \"https://registry.yarnpkg.com/path-to-regexp/-/path-to-regexp-6.3.0.tgz#2b6a26a337737a8e1416f9272ed0766b1c0389f4\"",
          "11861:   integrity sha512-Yhpw4T9C6hPpgPeA28us07OJeqZ5EzQTkbfwuhsUg0c237RomFoETJgmp2sa3F/41gfLE6G5cqcYwznmeEeOlQ==",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "14539:   resolved \"https://registry.yarnpkg.com/ws/-/ws-7.5.10.tgz#58b5c20dc281633f6c19113f39b349bd8bd558d9\"",
          "14540:   integrity sha512-+dbF1tHwZpXcbOJdVOkzLDxZP1ailvSxM6ZweXTegylPny803bFhA+vqBYw4s31NSAk4S2Qz+AKXK9a4wkdjcQ==",
          "14547: ws@~8.11.0:",
          "14548:   version \"8.11.0\"",
          "",
          "[Removed Lines]",
          "14542: ws@^8.0.0:",
          "14543:   version \"8.17.1\"",
          "14544:   resolved \"https://registry.yarnpkg.com/ws/-/ws-8.17.1.tgz#9293da530bb548febc95371d90f9c878727d919b\"",
          "14545:   integrity sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ==",
          "",
          "[Added Lines]",
          "14551: ws@^8.17.1:",
          "14552:   version \"8.18.0\"",
          "14553:   resolved \"https://registry.yarnpkg.com/ws/-/ws-8.18.0.tgz#0d7505a6eafe2b0e712d232b42279f53bc289bbc\"",
          "14554:   integrity sha512-8VbfWfHLbbwu3+N6OKsOMpBdT4kXPDDB9cJk2bJ6mh9ucxdlnNvH1e+roYkKmN9Nxw2yjz7VzeO9oOz2zJ04Pw==",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6c073da7340e64fbc69f82754b45c9e58ead4335",
      "candidate_info": {
        "commit_hash": "6c073da7340e64fbc69f82754b45c9e58ead4335",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/6c073da7340e64fbc69f82754b45c9e58ead4335",
        "files": [
          ".changelog/24649.txt",
          "client/rpc.go",
          "client/rpc_test.go"
        ],
        "message": "Backport of discovery: correctly handle IPv6 addresses from go-discover into release/1.9.x (#24704)\n\nCo-authored-by: Tim Gross <tgross@hashicorp.com>",
        "before_after_code_files": [
          "client/rpc.go||client/rpc.go",
          "client/rpc_test.go||client/rpc_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "client/rpc.go||client/rpc.go": [
          "File: client/rpc.go -> client/rpc.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "446: func resolveServer(s string) (net.Addr, error) {",
          "447:  const defaultClientPort = \"4647\" // default client RPC port",
          "448:  host, port, err := net.SplitHostPort(s)",
          "449:  if err != nil {",
          "454:    return resolveServer(s + \":\" + defaultClientPort)",
          "456:    return nil, err",
          "457:   }",
          "458:  } else if port == \"\" {",
          "",
          "[Removed Lines]",
          "450:   if strings.Contains(err.Error(), \"missing port\") {",
          "455:   } else {",
          "",
          "[Added Lines]",
          "451:   switch {",
          "452:   case strings.Contains(err.Error(), \"missing port\"):",
          "457:   case strings.Contains(err.Error(), \"too many colons\"):",
          "463:    ip := net.ParseIP(s)",
          "464:    if ip.To4() == nil && ip.To16() != nil {",
          "465:     if !strings.HasPrefix(s, \"[\") {",
          "466:      return resolveServer(\"[\" + s + \"]:\" + defaultClientPort)",
          "467:     }",
          "468:    }",
          "469:    return nil, err",
          "471:   default:",
          "",
          "---------------"
        ],
        "client/rpc_test.go||client/rpc_test.go": [
          "File: client/rpc_test.go -> client/rpc_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:   expectErr string",
          "131:  }{",
          "132:   {",
          "136:   },",
          "137:   {",
          "138:    name:   \"ipv6 no port\",",
          "",
          "[Removed Lines]",
          "133:    name:      \"ipv6 no brackets\",",
          "134:    addr:      \"2001:db8::1\",",
          "135:    expectErr: \"address 2001:db8::1: too many colons in address\",",
          "",
          "[Added Lines]",
          "133:    name:   \"ipv6 no brackets\",",
          "134:    addr:   \"2001:db8::1\",",
          "135:    expect: \"[2001:db8::1]:4647\",",
          "136:   },",
          "137:   {",
          "139:    name:   \"ambiguous ipv6 no brackets with port\",",
          "140:    addr:   \"2001:db8::1:4647\",",
          "141:    expect: \"[2001:db8::1:4647]:4647\",",
          "",
          "---------------"
        ]
      }
    }
  ]
}