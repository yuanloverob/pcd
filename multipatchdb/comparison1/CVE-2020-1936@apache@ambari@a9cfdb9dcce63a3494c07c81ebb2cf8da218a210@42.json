{
  "cve_id": "CVE-2020-1936",
  "cve_desc": "A cross-site scripting issue was found in Apache Ambari Views. This was addressed in Apache Ambari 2.7.4.",
  "repo": "apache/ambari",
  "patch_hash": "a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
  "patch_info": {
    "commit_hash": "a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
    "repo": "apache/ambari",
    "commit_url": "https://github.com/apache/ambari/pull/3040/commits/a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
    "files": [
      "ambari-web/app/views/common/breadcrumbs_view.js"
    ],
    "message": "AMBARI-25329. Ambari breadcrumbs xss vulnerability",
    "before_after_code_files": [
      "ambari-web/app/views/common/breadcrumbs_view.js||ambari-web/app/views/common/breadcrumbs_view.js"
    ]
  },
  "patch_diff": {
    "ambari-web/app/views/common/breadcrumbs_view.js||ambari-web/app/views/common/breadcrumbs_view.js": [
      "File: ambari-web/app/views/common/breadcrumbs_view.js -> ambari-web/app/views/common/breadcrumbs_view.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "149:   createLabel() {",
      "150:     let label = this.get('label');",
      "151:     let labelBindingPath = this.get('labelBindingPath');",
      "154:     this.set('formattedLabel', this.labelPostFormat(formattedLabel));",
      "155:   },",
      "",
      "[Removed Lines]",
      "153:     let formattedLabel = labelBindingPath ? App.get(_getLabelPathWithoutApp(labelBindingPath)) : label;",
      "",
      "[Added Lines]",
      "152:     let formattedLabel;",
      "154:     if (labelBindingPath) {",
      "155:       formattedLabel = Ember.Handlebars.Utils.escapeExpression(App.get(_getLabelPathWithoutApp(labelBindingPath)));",
      "156:     } else{",
      "157:       formattedLabel = label;",
      "158:     }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "216:       }",
      "217:       currentState = currentState.get('parentState');",
      "218:     }",
      "220:     if (items.length) {",
      "221:       items.get('lastObject').setProperties({",
      "222:         disabled: true,",
      "",
      "[Removed Lines]",
      "219:     items = items.reverse().map(item => App.BreadcrumbItem.extend(item).create());",
      "",
      "[Added Lines]",
      "227:     items.reverse();",
      "228:     items.slice(1).forEach(item => item.label = Ember.Handlebars.Utils.escapeExpression(item.label));",
      "229:     items = items.map(item => App.BreadcrumbItem.extend(item).create());",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "dd6ef5f14bdc8016e21f6d67161f49d5ba2b9637",
      "candidate_info": {
        "commit_hash": "dd6ef5f14bdc8016e21f6d67161f49d5ba2b9637",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/dd6ef5f14bdc8016e21f6d67161f49d5ba2b9637",
        "files": [
          "ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js"
        ],
        "message": "AMBARI-25379 Upgrade AMS Grafana version to 6.4.2\n\nMinor change in datasource.js:\n- Implement codereview suggestion to have a getMetrics() function to sanitize\n  getting App metrics from 'allMetrics'.\n- Null checks were added several places with getMetrics() function.\n\nChange-Id: I59c4a5a453df1054bcbefcc71904f8c052e29035",
        "before_after_code_files": [
          "ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js||ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js||ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js": [
          "File: ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js -> ambari-metrics/ambari-metrics-grafana/ambari-metrics/datasource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "712:           if(interpolated === \"hbase-users\") {",
          "713:             return this.initMetricAppidMapping()",
          "714:               .then(function () {",
          "716:                 var extractUsers = hbaseUsers.filter(/./.test.bind(new RegExp(\"regionserver.Users.\", 'g')));",
          "717:                 var removeUser = \"regionserver.Users.numUsers\";",
          "718:                 var i = extractUsers.indexOf(removeUser);",
          "",
          "[Removed Lines]",
          "715:                 var hbaseUsers = allMetrics[\"hbase\"];",
          "",
          "[Added Lines]",
          "715:                 var hbaseUsers = getMetrics(allMetrics, \"hbase\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "737:           if(interpolated === \"hbase-tables\") {",
          "738:             return this.initMetricAppidMapping()",
          "739:               .then(function () {",
          "741:                 var extractTables = hbaseTables.filter(/./.test.bind(new RegExp(\"regionserver.Tables.\", 'g')));",
          "742:                 var removeTable = \"regionserver.Tables.numTables\";",
          "743:                 var i = extractTables.indexOf(removeTable);",
          "",
          "[Removed Lines]",
          "740:                 var hbaseTables = allMetrics[\"hbase\"];",
          "",
          "[Added Lines]",
          "740:                 var hbaseTables = getMetrics(allMetrics, \"hbase\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "762:           if(interpolated === \"kafka-topics\") {",
          "763:             return this.initMetricAppidMapping()",
          "764:               .then(function () {",
          "766:                 var extractTopics = kafkaTopics.filter(/./.test.bind(new RegExp(\"\\\\b.log.Log.\\\\b\", 'g')));",
          "767:                 var topics =_.map(extractTopics, function (topic) {",
          "768:                   var topicPrefix = \"topic.\";",
          "",
          "[Removed Lines]",
          "765:                 var kafkaTopics = allMetrics[\"kafka_broker\"];",
          "",
          "[Added Lines]",
          "765:                 var kafkaTopics = getMetrics(allMetrics, \"kafka_broker\");",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "783:           if(interpolated === \"callers\") {",
          "784:             return this.initMetricAppidMapping()",
          "785:               .then(function () {",
          "787:                 var extractCallers = nnCallers.filter(/./.test.bind(new",
          "788:                   RegExp(\"ipc.client.org.apache.hadoop.ipc.DecayRpcScheduler.Caller\", 'g')));",
          "789:                 var callers = _.sortBy(_.uniq(_.map(extractCallers, function(caller) {",
          "",
          "[Removed Lines]",
          "786:                 var nnCallers = allMetrics[\"namenode\"];",
          "",
          "[Added Lines]",
          "786:                 var nnCallers = getMetrics(allMetrics, \"namenode\");",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "801:           if (interpolated === \"infra_solr_core\") {",
          "802:             return this.initMetricAppidMapping()",
          "803:               .then(function () {",
          "808:                 var extractCores = solrMetrics.filter(/./.test.bind(new",
          "809:                 RegExp(\"^infra.solr.core.\", 'g')));",
          "810:                 _.map(extractCores, function (core) {",
          "",
          "[Removed Lines]",
          "804:                 var solrMetrics = [];",
          "805:                 if (allMetrics[\"ambari-infra-solr\"]) {",
          "806:                   var solrMetrics = allMetrics[\"ambari-infra-solr\"];",
          "807:                 }",
          "",
          "[Added Lines]",
          "804:                 var solrMetrics = getMetrics(allMetrics, \"ambari-infra-solr\");",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "829:           if (interpolated === \"infra_solr_collection\") {",
          "830:             return this.initMetricAppidMapping()",
          "831:               .then(function () {",
          "836:                 var extractCollections = solrMetrics.filter(/./.test.bind(new",
          "837:                 RegExp(\"^infra.solr.core.\", 'g')));",
          "838:                 _.map(extractCollections, function (core) {",
          "",
          "[Removed Lines]",
          "832:                 var solrMetrics = [];",
          "833:                 if (allMetrics[\"ambari-infra-solr\"]) {",
          "834:                   var solrMetrics = allMetrics[\"ambari-infra-solr\"];",
          "835:                 }",
          "",
          "[Added Lines]",
          "829:                 var solrMetrics = getMetrics(allMetrics, \"ambari-infra-solr\");",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "856:           if(interpolated === \"topologies\") {",
          "857:             return this.initMetricAppidMapping()",
          "858:                 .then(function () {",
          "863:                   var extractTopologies = storm.filter(/./.test.bind(new",
          "864:                       RegExp(\"^topology.\", 'g')));",
          "865:                   _.map(extractTopologies, function(topology){",
          "",
          "[Removed Lines]",
          "859:                   var storm = [];",
          "860:                   if(allMetrics[\"nimbus\"]) {",
          "861:                     storm = allMetrics[\"nimbus\"];",
          "862:                   }",
          "",
          "[Added Lines]",
          "853:                   var storm = getMetrics(allMetrics, \"nimbus\");",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "883:             var componentName = interpolated.substring(0,interpolated.indexOf('.'));",
          "884:             return this.initMetricAppidMapping()",
          "885:                 .then(function () {",
          "890:                   var extractTopologies = storm.filter(/./.test.bind(new",
          "891:                       RegExp(\"^topology.\", 'g')));",
          "892:                   _.map(extractTopologies, function(topology){",
          "",
          "[Removed Lines]",
          "886:                   var storm = [];",
          "887:                   if(allMetrics[\"nimbus\"]) {",
          "888:                     storm = allMetrics[\"nimbus\"];",
          "889:                   }",
          "",
          "[Added Lines]",
          "877:                   var storm = getMetrics(allMetrics, \"nimbus\");",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "913:           this.getStormEntities = function () {",
          "914:             return this.initMetricAppidMapping()",
          "915:                 .then(function () {",
          "920:                   var extractTopologies = storm.filter(/./.test.bind(new",
          "921:                       RegExp(\"partition\", 'g')));",
          "922:                   _.map(extractTopologies, function(topology){",
          "",
          "[Removed Lines]",
          "916:                   var storm = [];",
          "917:                   if(allMetrics[\"nimbus\"]) {",
          "918:                     storm = allMetrics[\"nimbus\"];",
          "919:                   }",
          "",
          "[Added Lines]",
          "904:                   var storm = getMetrics(allMetrics, \"nimbus\");",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "966:           if(interpolated === \"yarnqueues\") {",
          "967:             return this.initMetricAppidMapping()",
          "968:               .then(function () {",
          "970:                 var extractQueues = yarnqueues.filter(/./.test.bind(new RegExp(\".=root\", 'g')));",
          "971:                 var queues = _.map(extractQueues, function(metric) {",
          "972:                   return metric.substring(\"yarn.QueueMetrics.Queue=\".length);",
          "",
          "[Removed Lines]",
          "969:                 var yarnqueues = allMetrics[\"resourcemanager\"];",
          "",
          "[Added Lines]",
          "954:                 var yarnqueues = getMetrics(allMetrics, \"resourcemanager\");",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "988:           if(interpolated === \"druidServices\") {",
          "989:             return this.initMetricAppidMapping()",
          "990:               .then(function () {",
          "996:                 var extractNodeTypes = druidMetrics.filter(/./.test.bind(new RegExp(\"jvm/gc/time\", 'g')));",
          "997:                 var nodeTypes = _.map(extractNodeTypes, function(metricName) {",
          "",
          "[Removed Lines]",
          "991:                 var druidMetrics = [];",
          "992:                 if(allMetrics[\"druid\"]) {",
          "993:                   druidMetrics = allMetrics[\"druid\"];",
          "994:                 }",
          "",
          "[Added Lines]",
          "976:                 var druidMetrics = getMetrics(allMetrics, \"druid\");",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1011:           if(interpolated === \"druidDataSources\") {",
          "1012:             return this.initMetricAppidMapping()",
          "1013:               .then(function () {",
          "1019:                 var extractDataSources = druidMetrics.filter(/./.test.bind(new RegExp(\"query/time\", 'g')));",
          "1020:                 var dataSources = _.map(extractDataSources, function(metricName) {",
          "",
          "[Removed Lines]",
          "1014:                 var druidMetrics = [];",
          "1015:                 if(allMetrics[\"druid\"]) {",
          "1016:                   druidMetrics = allMetrics[\"druid\"];",
          "1017:                 }",
          "",
          "[Added Lines]",
          "996:                 var druidMetrics = getMetrics(allMetrics, \"druid\");",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1034:           if(interpolated === \"druidQueryTypes\") {",
          "1035:             return this.initMetricAppidMapping()",
          "1036:               .then(function () {",
          "1042:                 var extractQueryTypes = druidMetrics.filter(/./.test.bind(new RegExp(\"query/time\", 'g')));",
          "1043:                 var queryTypes = _.map(extractQueryTypes, function(metricName) {",
          "",
          "[Removed Lines]",
          "1037:                 var druidMetrics = [];",
          "1038:                 if(allMetrics[\"druid\"]) {",
          "1039:                   druidMetrics = allMetrics[\"druid\"];",
          "1040:                 }",
          "",
          "[Added Lines]",
          "1016:                 var druidMetrics = getMetrics(allMetrics, \"druid\");",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1176:         return index > 0 && (options[0].selected || item.selected);",
          "1177:       }",
          "1178:     });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1155:       function getMetrics(allmetrics, appname) {",
          "1156:         var metrics = allmetrics[appname];",
          "1157:         if(!metrics) {",
          "1158:             metrics = [];",
          "1159:         }",
          "1160:         return metrics;",
          "1161:       }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ab83d7439732a9fba0373659b8b019b69f472bdf",
      "candidate_info": {
        "commit_hash": "ab83d7439732a9fba0373659b8b019b69f472bdf",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/ab83d7439732a9fba0373659b8b019b69f472bdf",
        "files": [
          "ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js",
          "ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html"
        ],
        "message": "AMBARI-25303 Cluster Information Page URL is broken - additional patch. (ababiichuk)",
        "before_after_code_files": [
          "ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js||ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js",
          "ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js||ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html||ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html||ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html||ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html",
          "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js||ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js -> ambari-admin/src/main/resources/ui/admin-web/app/scripts/directives/linkToDir.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:       id: '@'",
          "29:     },",
          "32:     controller: ['$scope', 'ROUTES', function($scope, ROUTES) {",
          "33:       var route = ROUTES;",
          "34:       angular.forEach($scope.route.split('.'), function(routeObj) {",
          "",
          "[Removed Lines]",
          "31:     template: '<a ng-href=\"#!{{href}}\" ng-transclude></a>',",
          "",
          "[Added Lines]",
          "31:     template: '<a ng-href=\"#{{href}}\" ng-transclude></a>',",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js||ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js -> ambari-admin/src/main/resources/ui/admin-web/app/scripts/routes.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "147:   }",
          "148: })",
          "149: .config(['$routeProvider', '$locationProvider', 'ROUTES', function ($routeProvider, $locationProvider, ROUTES) {",
          "150:   var createRoute = function (routeObj) {",
          "151:     if (routeObj.url) {",
          "152:       $routeProvider.when(routeObj.url, routeObj);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "150:   $locationProvider.hashPrefix('');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "157:   var rootUrl = ROUTES['clusters']['clusterInformation'].url;",
          "158:   angular.forEach(ROUTES, createRoute);",
          "159:   $routeProvider.otherwise({",
          "163:   });",
          "164: }])",
          "165: .run(['$rootScope', 'ROUTES', 'Settings', function ($rootScope, ROUTES, Settings) {",
          "",
          "[Removed Lines]",
          "160:     redirectTo: function () {",
          "161:       return rootUrl;",
          "162:     }",
          "",
          "[Added Lines]",
          "161:     redirectTo: rootUrl",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/edit.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: -->",
          "18: <div class=\"clearfix\">",
          "19:   <ol class=\"breadcrumb pull-left\">",
          "21:     <li class=\"active\">{{instance.ViewInstanceInfo.label}}",
          "22:       <a class=\"gotoinstance\" ng-show=\"instance.ViewInstanceInfo.visible\"",
          "23:          href=\"{{fromSiteRoot('/#/main/views/' + viewUrl)}}\" target=\"_blank\">",
          "",
          "[Removed Lines]",
          "20:     <li><a href=\"#!/views\">{{'common.views' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "20:     <li><a href=\"#/views\">{{'common.views' | translate}}</a></li>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "94:           </div>",
          "95:             <div ng-if=\"!settings.shortUrl\">",
          "96:               <p ng-hide=\"!editDetailsSettingsDisabled\" class=\"form-control-static\">",
          "98:               </p>",
          "99:               <p class=\"form-control-static\" ng-hide=\"editDetailsSettingsDisabled\">",
          "101:               </p>",
          "102:             </div>",
          "103:           </div>",
          "",
          "[Removed Lines]",
          "97:                 <a href=\"#!/urls/link/{{instance.ViewInstanceInfo.view_name}}/{{instance.ViewInstanceInfo.version}}/{{instance.ViewInstanceInfo.instance_name}}\">{{'urls.createNewUrl' | translate}}</a>",
          "100:                 <a href=\"#!/urls/link/{{instance.ViewInstanceInfo.view_name}}/{{instance.ViewInstanceInfo.version}}/{{instance.ViewInstanceInfo.instance_name}}\">{{'urls.createNewUrl' | translate}}</a>",
          "",
          "[Added Lines]",
          "97:                 <a href=\"#/urls/link/{{instance.ViewInstanceInfo.view_name}}/{{instance.ViewInstanceInfo.version}}/{{instance.ViewInstanceInfo.instance_name}}\">{{'urls.createNewUrl' | translate}}</a>",
          "100:                 <a href=\"#/urls/link/{{instance.ViewInstanceInfo.view_name}}/{{instance.ViewInstanceInfo.version}}/{{instance.ViewInstanceInfo.instance_name}}\">{{'urls.createNewUrl' | translate}}</a>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html||ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/ambariViews/viewsList.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "88:                 </span>",
          "90:                 <span ng-switch-when=\"DEPLOYED\">",
          "92:                         <i class=\"fa fa-pencil\"></i>",
          "93:                     </a>",
          "94:                     <a href ng-click=\"cloneInstance(instance);\">",
          "",
          "[Removed Lines]",
          "91:                     <a  href=\"#!/views/{{instance.view_name}}/versions/{{instance.version}}/instances/{{instance.instance_name}}/edit\">",
          "",
          "[Added Lines]",
          "91:                     <a href=\"#/views/{{instance.view_name}}/versions/{{instance.version}}/instances/{{instance.instance_name}}/edit\">",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/editRemoteClusterPage.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: -->",
          "18: <div class=\"clearfix\">",
          "19:   <ol class=\"breadcrumb pull-left\">",
          "21:     <li class=\"active\">{{cluster.cluster_name}}</li>",
          "22:   </ol>",
          "23:   <div class=\"pull-right top-margin-4\">",
          "",
          "[Removed Lines]",
          "20:     <li><a href=\"#!/remoteClusters\">{{'common.remoteClusters' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "20:     <li><a href=\"#/remoteClusters\">{{'common.remoteClusters' | translate}}</a></li>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/list.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div class=\"users-pane\">",
          "20:   <div class=\"clearfix\">",
          "21:     <div class=\"pull-right\">",
          "23:         {{'views.registerRemoteCluster' | translate}}",
          "24:       </a>",
          "25:     </div>",
          "",
          "[Removed Lines]",
          "22:       <a href=\"#!/remoteClusters/create\" class=\"btn btn-default\">",
          "",
          "[Added Lines]",
          "22:       <a href=\"#/remoteClusters/create\" class=\"btn btn-default\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "50:     </thead>",
          "51:     <tbody>",
          "52:     <tr ng-repeat=\"remoteCluster in remoteClusters  | filter : { isShowed: true }\">",
          "54:       <td class=\"col-sm-9\">",
          "55:         <span ng-repeat=\"service in remoteCluster.ClusterInfo.services\" ng-if=\"remoteCluster.ClusterInfo.services.length > 0\">{{ service }}{{$last ? '' : ','}} </span>",
          "56:         <span ng-if=\"remoteCluster.ClusterInfo.services.length == 0\">--</span>",
          "",
          "[Removed Lines]",
          "53:       <td class=\"col-sm-3\"><a href=\"#!/remoteClusters/{{remoteCluster.ClusterInfo.name}}/edit\">{{ remoteCluster.clusterName }}</a></td>",
          "",
          "[Added Lines]",
          "53:       <td class=\"col-sm-3\"><a href=\"#/remoteClusters/{{remoteCluster.ClusterInfo.name}}/edit\">{{ remoteCluster.clusterName }}</a></td>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/remoteClusters/remoteClusterPage.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: -->",
          "18: <ol class=\"breadcrumb\">",
          "20:   <li class=\"active\">{{'common.register' | translate}}</li>",
          "21: </ol>",
          "22: <hr>",
          "",
          "[Removed Lines]",
          "19:   <li><a href=\"#!/remoteClusters\">{{'common.remoteClusters' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "19:   <li><a href=\"#/remoteClusters\">{{'common.remoteClusters' | translate}}</a></li>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html||ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/sideNav.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "47:         </a>",
          "48:         <ul class=\"sub-menu nav nav-pills nav-stacked\">",
          "49:           <li class=\"submenu-li\" ng-class=\"{active: isActive('clusters.clusterInformation')}\">",
          "51:               {{'common.clusterInformation' | translate}}",
          "52:             </a>",
          "53:           </li>",
          "54:           <li class=\"submenu-li\"  ng-class=\"{active: isActive('stackVersions.list')}\" ng-show=\"cluster && totalRepos > 0\">",
          "56:           </li>",
          "57:           <li class=\"submenu-li\" ng-class=\"{active: isActive('remoteClusters.list')}\">",
          "59:           </li>",
          "60:         </ul>",
          "61:       </li>",
          "",
          "[Removed Lines]",
          "50:             <a href=\"#!/clusterInformation\" class=\"clusterInformation\">",
          "55:             <a href=\"#!/stackVersions\">{{'common.versions' | translate}}</a>",
          "58:             <a href=\"#!/remoteClusters\">{{'common.remoteClusters' | translate}}</a>",
          "",
          "[Added Lines]",
          "50:             <a href=\"#/clusterInformation\" class=\"clusterInformation\">",
          "55:             <a href=\"#/stackVersions\">{{'common.versions' | translate}}</a>",
          "58:             <a href=\"#/remoteClusters\">{{'common.remoteClusters' | translate}}</a>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html||ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/list.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div id=\"stack-versions\">",
          "20:   <div class=\"clearfix\">",
          "21:     <div class=\"pull-right\">",
          "23:         {{'versions.register.title' | translate}}",
          "24:       </a>",
          "25:     </div>",
          "",
          "[Removed Lines]",
          "22:       <a href=\"#!/stackVersions/create\" class=\"btn btn-default\">",
          "",
          "[Added Lines]",
          "22:       <a href=\"#/stackVersions/create\" class=\"btn btn-default\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "63:         <span>{{repo.stack_name}}-{{repo.stack_version}}</span>",
          "64:       </td>",
          "65:       <td class=\"col-medium\">",
          "67:           {{repo.display_name}}",
          "68:         </a>",
          "69:       </td>",
          "",
          "[Removed Lines]",
          "66:         <a href=\"#!/stackVersions/{{repo.stack_name}}/{{repo.repository_version}}/edit\">",
          "",
          "[Added Lines]",
          "66:         <a href=\"#/stackVersions/{{repo.stack_name}}/{{repo.repository_version}}/edit\">",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html||ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/stackVersions/stackVersionPage.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div class=\"clearfix\">",
          "20:   <ol class=\"breadcrumb pull-left\">",
          "22:     <li class=\"active\" ng-if=\"editController\">",
          "23:       {{displayName}}&nbsp;",
          "24:       <span class=\"sub-text\">({{repoVersionFullName}})</span>",
          "",
          "[Removed Lines]",
          "21:     <li><a href=\"#!/stackVersions\">{{'common.versions' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "21:     <li><a href=\"#/stackVersions\">{{'common.versions' | translate}}</a></li>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/groupEdit.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div id=\"group-edit\">",
          "20:   <div class=\"clearfix\">",
          "21:     <ol class=\"breadcrumb pull-left\">",
          "23:       <li class=\"active\">{{group.group_name}}</li>",
          "24:     </ol>",
          "25:   </div>",
          "",
          "[Removed Lines]",
          "22:       <li><a href=\"#!/userManagement?tab=groups\">{{'common.groups' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "22:       <li><a href=\"#/userManagement?tab=groups\">{{'common.groups' | translate}}</a></li>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "66:           <tr ng-repeat=\"(name, privilege) in privileges.clusters\">",
          "67:             <td>",
          "68:               <span class=\"glyphicon glyphicon-cloud\"></span>",
          "70:             </td>",
          "71:             <td>",
          "72:               <span tooltip=\"{{item}}\" ng-repeat=\"item in privilege\">{{item | translate}}{{$last ? '' : ', '}}</span>",
          "",
          "[Removed Lines]",
          "69:               <a href=\"#!/clusters/{{name}}/manageAccess\">{{name}}</a>",
          "",
          "[Added Lines]",
          "69:               <a href=\"#/clusters/{{name}}/manageAccess\">{{name}}</a>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "86:           <tr ng-repeat=\"(name, privilege) in privileges.views\">",
          "87:             <td>",
          "88:               <span class=\"glyphicon glyphicon-th\"></span>",
          "90:             </td>",
          "91:             <td>",
          "92:               <span tooltip=\"{{item}}\" ng-repeat=\"item in privilege.privileges\">{{item | translate}}{{$last ? '' : ', '}}</span>",
          "",
          "[Removed Lines]",
          "89:               <a href=\"#!/views/{{privilege.view_name}}/versions/{{privilege.version}}/instances/{{name}}/edit\">{{name}}</a>",
          "",
          "[Added Lines]",
          "89:               <a href=\"#/views/{{privilege.view_name}}/versions/{{privilege.version}}/instances/{{name}}/edit\">{{name}}</a>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/main.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div id=\"user-management\">",
          "20:   <ul class=\"nav nav-tabs\">",
          "21:     <li ng-class=\"{active: activeTab === 'USERS'}\">",
          "23:     </li>",
          "24:     <li ng-class=\"{active: activeTab === 'GROUPS'}\">",
          "26:     </li>",
          "27:   </ul>",
          "28:   <div>",
          "",
          "[Removed Lines]",
          "22:       <a href=\"#!/userManagement?tab=users\" >{{'common.users' | translate}}</a>",
          "25:       <a href=\"#!/userManagement?tab=groups\" >{{'common.groups' | translate}}</a>",
          "",
          "[Added Lines]",
          "22:       <a href=\"#/userManagement?tab=users\" >{{'common.users' | translate}}</a>",
          "25:       <a href=\"#/userManagement?tab=groups\" >{{'common.groups' | translate}}</a>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/userEdit.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: <div ng-show=\"user\" id=\"user-edit\">",
          "20:   <div class=\"clearfix\">",
          "21:     <ol class=\"breadcrumb pull-left\">",
          "23:       <li class=\"active\">{{user.user_name}}</li>",
          "24:     </ol>",
          "25:   </div>",
          "",
          "[Removed Lines]",
          "22:       <li><a href=\"#!/userManagement?tab=users\">{{'common.users' | translate}}</a></li>",
          "",
          "[Added Lines]",
          "22:       <li><a href=\"#/userManagement?tab=users\">{{'common.users' | translate}}</a></li>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "96:             <tr ng-repeat=\"(name, privilege) in privilegesView.clusters\">",
          "97:               <td>",
          "98:                 <span class=\"glyphicon glyphicon-cloud\"></span>",
          "100:               </td>",
          "101:               <td>",
          "102:                 <span tooltip=\"{{privilege.permission_label}}\">{{privilege.permission_label}}</span>",
          "",
          "[Removed Lines]",
          "99:                 <a href=\"#!/clusters/{{name}}/manageAccess\">{{name}}</a>",
          "",
          "[Added Lines]",
          "99:                 <a href=\"#/clusters/{{name}}/manageAccess\">{{name}}</a>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "116:             <tr ng-repeat=\"(name, privilege) in privilegesView.views\">",
          "117:               <td>",
          "118:                 <span class=\"glyphicon glyphicon-th\"></span>",
          "120:               </td>",
          "121:               <td>",
          "122:                 <span tooltip=\"{{item}}\" ng-repeat=\"item in privilege.privileges track by $index\">{{item | translate}}{{$last ? '' : ', '}}</span>",
          "",
          "[Removed Lines]",
          "119:                 <a href=\"#!/views/{{privilege.view_name}}/versions/{{privilege.version}}/instances/{{name}}/edit\">{{name}}</a>",
          "",
          "[Added Lines]",
          "119:                 <a href=\"#/views/{{privilege.view_name}}/versions/{{privilege.version}}/instances/{{name}}/edit\">{{name}}</a>",
          "",
          "---------------"
        ],
        "ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html||ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html": [
          "File: ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html -> ambari-admin/src/main/resources/ui/admin-web/app/views/userManagement/usersList.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "74:         <td><span>{{user.Users.userTypeName}}</span></td>",
          "75:         <td><span>{{user.Users.groups.length ? user.Users.groups.join(' ') : '-'}}</span></td>",
          "76:         <td class=\"entity-actions\">",
          "78:             <i class=\"fa fa-pencil\"></i>",
          "79:           </a>",
          "80:           <a href ng-click=\"deleteUser(user.Users)\" ng-disabled=\"!user.Users.isDeletable\">",
          "",
          "[Removed Lines]",
          "77:           <a href=\"#!/users/{{user.Users.encodedName}}/edit\">",
          "",
          "[Added Lines]",
          "77:           <a href=\"#/users/{{user.Users.encodedName}}/edit\">",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5e12c139dfbc8e0fe89f9a5224b1391bde958ad9",
      "candidate_info": {
        "commit_hash": "5e12c139dfbc8e0fe89f9a5224b1391bde958ad9",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/5e12c139dfbc8e0fe89f9a5224b1391bde958ad9",
        "files": [
          "ambari-web/app/utils/configs/move_rm_config_initializer.js"
        ],
        "message": "AMBARI-25214. Moving resource manager does not update yarn.resourcemanager.address property",
        "before_after_code_files": [
          "ambari-web/app/utils/configs/move_rm_config_initializer.js||ambari-web/app/utils/configs/move_rm_config_initializer.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-web/app/utils/configs/move_rm_config_initializer.js||ambari-web/app/utils/configs/move_rm_config_initializer.js": [
          "File: ambari-web/app/utils/configs/move_rm_config_initializer.js -> ambari-web/app/utils/configs/move_rm_config_initializer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "58:     'yarn.resourcemanager.webapp.address.{{suffix}}': getRmHaDependedConfig(true),",
          "59:     'yarn.resourcemanager.webapp.https.address.{{suffix}}': getRmHaDependedConfig(true),",
          "60:     'yarn.resourcemanager.resource-tracker.address.{{suffix}}': getRmHaDependedConfig(true),",
          "61:     'yarn.resourcemanager.ha': getRmHaHawqConfig(true),",
          "62:     'yarn.resourcemanager.scheduler.ha': getRmHaHawqConfig(true)",
          "63:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61:     'yarn.resourcemanager.address.{{suffix}}': getRmHaDependedConfig(true),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "296a13713d757a555a79e1cb597d0a9461d40037",
      "candidate_info": {
        "commit_hash": "296a13713d757a555a79e1cb597d0a9461d40037",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/296a13713d757a555a79e1cb597d0a9461d40037",
        "files": [
          "ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java",
          "ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java"
        ],
        "message": "[AMBARI-25240] : Dynamically update Rolling Upgrade Batch size (#2927)\n\n* [AMBARI-25240] : Dynamically update Rolling Upgrade Batch size\n\n* minor code change",
        "before_after_code_files": [
          "ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java||ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java",
          "ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java||ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java||ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java -> ambari-server/src/main/java/org/apache/ambari/server/stack/MasterHostResolver.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "313:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "322:   public String getValueFromDesiredConfigurations(final String configType, final String propertyName) {",
          "323:     return m_configHelper.getValueFromDesiredConfigurations(m_cluster, configType, propertyName);",
          "324:   }",
          "",
          "---------------"
        ],
        "ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java||ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java -> ambari-server/src/main/java/org/apache/ambari/server/state/stack/upgrade/Grouping.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: import org.apache.ambari.server.AmbariException;",
          "34: import org.apache.ambari.server.stack.HostsType;",
          "35: import org.apache.ambari.server.state.UpgradeContext;",
          "36: import org.apache.ambari.server.state.stack.UpgradePack;",
          "37: import org.apache.ambari.server.state.stack.UpgradePack.OrderService;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: import org.apache.ambari.server.state.ConfigHelper;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "226:       for (TaskWrapper tw : tasks) {",
          "229:         if (m_grouping.parallelScheduler != null) {",
          "230:           int taskParallelism = m_grouping.parallelScheduler.maxDegreeOfParallelism;",
          "231:           if (taskParallelism == Integer.MAX_VALUE) {",
          "232:             taskParallelism = ctx.getDefaultMaxDegreeOfParallelism();",
          "233:           }",
          "",
          "[Removed Lines]",
          "227:         List<Set<String>> hostSets = null;",
          "",
          "[Added Lines]",
          "228:         List<Set<String>> hostSets;",
          "231:           String maxDegreeFromClusterEnv = ctx.getResolver()",
          "232:                   .getValueFromDesiredConfigurations(ConfigHelper.CLUSTER_ENV, \"max_degree_parallelism\");",
          "233:           if (StringUtils.isNotEmpty(maxDegreeFromClusterEnv) && StringUtils.isNumeric(maxDegreeFromClusterEnv)) {",
          "234:             taskParallelism = Integer.parseInt(maxDegreeFromClusterEnv);",
          "235:           }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "033079ebf6731df734dd8ecdfec56c4d861c0e1d",
      "candidate_info": {
        "commit_hash": "033079ebf6731df734dd8ecdfec56c4d861c0e1d",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/033079ebf6731df734dd8ecdfec56c4d861c0e1d",
        "files": [
          "ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py"
        ],
        "message": "AMBARI-24527. Unable to Add ZooKeeper-Only Host To Cluster With Hadoop (aonishuk)",
        "before_after_code_files": [
          "ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py||ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py||ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py": [
          "File: ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py -> ambari-server/src/main/resources/stack-hooks/before-START/scripts/shared_initialization.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "106:            mode=0644,",
          "107:            content=StaticFile(\"fast-hdfs-resource.jar\")",
          "108:            )",
          "122:     if params.dfs_type == 'HCFS' and params.has_core_site and 'ECS_CLIENT' in params.component_list:",
          "123:       create_dirs()",
          "",
          "[Removed Lines]",
          "109:     if params.hadoop_metrics2_properties_content:",
          "110:       File(os.path.join(params.hadoop_conf_dir, \"hadoop-metrics2.properties\"),",
          "111:            owner=params.hdfs_user,",
          "112:            group=params.user_group,",
          "113:            content=InlineTemplate(params.hadoop_metrics2_properties_content)",
          "114:            )",
          "115:     else:",
          "116:       File(os.path.join(params.hadoop_conf_dir, \"hadoop-metrics2.properties\"),",
          "117:            owner=params.hdfs_user,",
          "118:            group=params.user_group,",
          "119:            content=Template(\"hadoop-metrics2.properties.j2\")",
          "120:            )",
          "",
          "[Added Lines]",
          "109:     if os.path.exists(params.hadoop_conf_dir):",
          "110:       if params.hadoop_metrics2_properties_content:",
          "111:         File(os.path.join(params.hadoop_conf_dir, \"hadoop-metrics2.properties\"),",
          "112:              owner=params.hdfs_user,",
          "113:              group=params.user_group,",
          "114:              content=InlineTemplate(params.hadoop_metrics2_properties_content)",
          "115:              )",
          "116:       else:",
          "117:         File(os.path.join(params.hadoop_conf_dir, \"hadoop-metrics2.properties\"),",
          "118:              owner=params.hdfs_user,",
          "119:              group=params.user_group,",
          "120:              content=Template(\"hadoop-metrics2.properties.j2\")",
          "121:              )",
          "",
          "---------------"
        ]
      }
    }
  ]
}