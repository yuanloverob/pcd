{
  "cve_id": "CVE-2022-44543",
  "cve_desc": "The femanager extension before 5.5.2, 6.x before 6.3.3, and 7.x before 7.0.1 for TYPO3 allows creation of frontend users in restricted groups (if there is a usergroup field on the registration form). This occurs because the usergroup.inList protection mechanism is mishandled.",
  "repo": "in2code-de/femanager",
  "patch_hash": "827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
  "patch_info": {
    "commit_hash": "827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
    "repo": "in2code-de/femanager",
    "commit_url": "https://github.com/in2code-de/femanager/commit/827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
    "files": [
      "Classes/Domain/Validator/AbstractValidator.php",
      "Classes/Domain/Validator/ServersideValidator.php",
      "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
    ],
    "message": "[BUGFIX] Broken Access Control in Usergroup Validation\n\nhttps://projekte.in2code.de/issues/53603",
    "before_after_code_files": [
      "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
      "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
      "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
    ]
  },
  "patch_diff": {
    "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
      "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "365:     protected function validateInList($value, $validationSettingList)",
      "366:     {",
      "367:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
      "369:     }",
      "",
      "[Removed Lines]",
      "368:         return in_array($value, $validationSettings);",
      "",
      "[Added Lines]",
      "367:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
      "369:         $diff = array_diff($valueList, $validationSettings);",
      "371:         return empty($diff);",
      "",
      "---------------"
    ],
    "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php": [
      "File: Classes/Domain/Validator/ServersideValidator.php -> Classes/Domain/Validator/ServersideValidator.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "7: use In2code\\Femanager\\Domain\\Model\\User;",
      "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
      "9: use TYPO3\\CMS\\Extbase\\Domain\\Model\\FileReference;",
      "10: use TYPO3\\CMS\\Extbase\\Reflection\\ObjectAccess;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "10: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "306:     protected function getValue($user, $fieldName)",
      "307:     {",
      "308:         $value = $this->getValueFromProperty($user, $fieldName);",
      "309:         if (is_object($value)) {",
      "310:             if (method_exists($value, 'getUid')) {",
      "311:                 $value = $value->getUid();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "311:         if ($value instanceof ObjectStorage) {",
      "312:             $values = [];",
      "314:             foreach ($value as $object) {",
      "315:                 if (method_exists($object, 'getUid')) {",
      "316:                     $values[] = $object->getUid();",
      "317:                 }",
      "318:             }",
      "320:             return implode(',', $values);",
      "321:         }",
      "",
      "---------------"
    ],
    "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
      "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "732:                 'a',",
      "733:                 true",
      "734:             ],",
      "735:             [",
      "736:                 '23',",
      "737:                 '1,234,3',",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "735:             [",
      "736:                 '1,2',",
      "737:                 '1,2,3',",
      "738:                 true",
      "739:             ],",
      "740:             [",
      "741:                 '1,2',",
      "742:                 '3,2,1',",
      "743:                 true",
      "744:             ],",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "752:                 'bac',",
      "753:                 false",
      "754:             ],",
      "755:         ];",
      "756:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "765:             [",
      "766:                 '1,2,3',",
      "767:                 '1,2',",
      "768:                 false",
      "769:             ],",
      "770:             [",
      "771:                 '1,2,3',",
      "772:                 '2,1',",
      "773:                 false",
      "774:             ]",
      "",
      "---------------"
    ],
    "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
      "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <?php",
      "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
      "5: use In2code\\Femanager\\Domain\\Model\\User;",
      "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
      "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
      "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
      "14: class ServersideValidatorTest extends UnitTestCase",
      "15: {",
      "20:     protected $generalValidatorMock;",
      "25:     public function setUp(): void",
      "26:     {",
      "27:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
      "28:     }",
      "33:     public function tearDown(): void",
      "34:     {",
      "35:         unset($this->generalValidatorMock);",
      "36:     }",
      "41:     public function testGetValueForObjectStorage(): void",
      "42:     {",
      "43:         $user = new User();",
      "45:         $usergroup1 = $this->getUserGroupMock(1);",
      "46:         $usergroup2 = $this->getUserGroupMock(2);",
      "48:         $user->addUsergroup($usergroup1);",
      "49:         $user->addUsergroup($usergroup2);",
      "51:         $fieldName = 'usergroup';",
      "53:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
      "55:         self::assertSame('1,2', $result);",
      "56:     }",
      "61:     public function testGetValueForObject(): void",
      "62:     {",
      "63:         $user = new User('testuser');",
      "65:         $fieldName = 'username';",
      "67:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
      "69:         self::assertSame('testuser', $result);",
      "70:     }",
      "76:     protected function getUserGroupMock(int $uid = 1)",
      "77:     {",
      "78:         $mockClass = $this->getMockBuilder(UserGroup::class)",
      "79:             ->disableOriginalConstructor()",
      "80:             ->getMock();",
      "82:         $mockClass->method('getUid')->willReturn($uid);",
      "84:         return $mockClass;",
      "85:     }",
      "86: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "61424cba9051d0849aa78fc850120fa0a8f95b71",
      "candidate_info": {
        "commit_hash": "61424cba9051d0849aa78fc850120fa0a8f95b71",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/61424cba9051d0849aa78fc850120fa0a8f95b71",
        "files": [
          "Classes/Domain/Validator/AbstractValidator.php",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php"
        ],
        "message": "[TASK] Corrects UnitTests for Domain Classes",
        "before_after_code_files": [
          "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php||Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
          "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "313:     {",
          "316:         $diff = array_diff($valueList, $validationSettings);",
          "318:         return empty($diff);",
          "",
          "[Removed Lines]",
          "312:     protected function validateInList(string $value, string $validationSettingList): bool",
          "314:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
          "315:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
          "",
          "[Added Lines]",
          "312:     protected function validateInList(mixed $value, mixed $validationSettingList): bool",
          "314:         $valueList = GeneralUtility::trimExplode(',', (string)$value, true);",
          "315:         $validationSettings = GeneralUtility::trimExplode(',', (string)$validationSettingList, true);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "325:     {",
          "326:         if ($value === $value2) {",
          "327:             return true;",
          "",
          "[Removed Lines]",
          "324:     protected function validateSameAs(string $value, string $value2): bool",
          "",
          "[Added Lines]",
          "324:     protected function validateSameAs(mixed $value, mixed $value2): bool",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Tests\\Unit\\Fixture\\Domain\\Validator\\AbstractValidator;",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6: use PHPUnit\\Framework\\MockObject\\MockObject;",
          "7: use TYPO3\\TestingFramework\\Core\\AccessibleObjectInterface;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "12: class AbstractValidatorTest extends UnitTestCase",
          "13: {",
          "22:     public function setUp(): void",
          "23:     {",
          "26:     }",
          "",
          "[Removed Lines]",
          "17:     protected $generalValidatorMock;",
          "24:         var_dump('foo');",
          "25:         $this->generalValidatorMock = $this->getAccessibleMock(AbstractValidator::class, ['dummy']);",
          "",
          "[Added Lines]",
          "16:     protected AccessibleObjectInterface|MockObject|AbstractValidator|\\In2code\\Femanager\\Domain\\Validator\\AbstractValidator $generalValidatorMock;",
          "23:         $this->generalValidatorMock = $this->getAccessibleMock(",
          "24:             AbstractValidator::class,",
          "25:             null",
          "26:         );",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     {",
          "43:         return [",
          "44:             [",
          "",
          "[Removed Lines]",
          "41:     public static function validateRequiredReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "42:     public static function validateRequiredReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "85:     }",
          "94:     {",
          "96:     }",
          "",
          "[Removed Lines]",
          "93:     public function testValidateRequiredReturnsBool($value, $expectedResult)",
          "95:         self::assertSame($expectedResult, $this->generalValidatorMock->_callRef('validateRequired', $value));",
          "",
          "[Added Lines]",
          "92:     public function testValidateRequiredReturnsBool(mixed $value, bool $expectedResult)",
          "94:         self::assertSame($expectedResult, $this->generalValidatorMock->_call('validateRequired', $value));",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "104:     {",
          "105:         return [",
          "106:             [",
          "",
          "[Removed Lines]",
          "103:     public static function validateEmailReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "102:     public static function validateEmailReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "135:     }",
          "144:     {",
          "146:     }",
          "",
          "[Removed Lines]",
          "143:     public function testValidateEmailReturnsBool($value, $expectedResult)",
          "145:         self::assertSame($expectedResult, $this->generalValidatorMock->_callRef('validateEmail', $value));",
          "",
          "[Added Lines]",
          "140:     public function testValidateEmailReturnsBool(string $value, bool $expectedResult)",
          "142:         self::assertSame($expectedResult, $this->generalValidatorMock->_call('validateEmail', $value));",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "154:     {",
          "155:         return [",
          "156:             [",
          "",
          "[Removed Lines]",
          "153:     public static function validateMinReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "150:     public static function validateMinReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "182:     }",
          "192:     {",
          "193:         self::assertSame(",
          "194:             $expectedResult,",
          "196:         );",
          "197:     }",
          "",
          "[Removed Lines]",
          "191:     public function testValidateMinReturnsBool($value, $allowedLength, $expectedResult)",
          "195:             $this->generalValidatorMock->_callRef('validateMin', $value, $allowedLength)",
          "",
          "[Added Lines]",
          "185:     public function testValidateMinReturnsBool(string $value, int $allowedLength, bool $expectedResult)",
          "189:             $this->generalValidatorMock->_call('validateMin', $value, $allowedLength)",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "205:     {",
          "206:         return [",
          "207:             [",
          "",
          "[Removed Lines]",
          "204:     public static function validateMaxReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "198:     public static function validateMaxReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "238:     }",
          "248:     {",
          "249:         self::assertSame(",
          "250:             $expectedResult,",
          "252:         );",
          "253:     }",
          "",
          "[Removed Lines]",
          "247:     public function testValidateMaxReturnsBool($value, $allowedLength, $expectedResult)",
          "251:             $this->generalValidatorMock->_callRef('validateMax', $value, $allowedLength)",
          "",
          "[Added Lines]",
          "238:     public function testValidateMaxReturnsBool(string $value, int $allowedLength, bool $expectedResult)",
          "242:             $this->generalValidatorMock->_call('validateMax', $value, $allowedLength)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "261:     {",
          "262:         return [",
          "263:             [",
          "",
          "[Removed Lines]",
          "260:     public static function validateIntReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "251:     public static function validateIntReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "286:             ],",
          "287:             [",
          "288:                 '3 ',",
          "290:             ]",
          "291:         ];",
          "292:     }",
          "301:     {",
          "303:     }",
          "",
          "[Removed Lines]",
          "289:                 (PHP_MAJOR_VERSION >= 8) ? true : false",
          "300:     public function testValidateIntReturnsBool($value, $expectedResult)",
          "302:         self::assertSame($expectedResult, $this->generalValidatorMock->_callRef('validateInt', $value));",
          "",
          "[Added Lines]",
          "280:                 PHP_MAJOR_VERSION >= 8",
          "289:     public function testValidateIntReturnsBool(string $value, bool $expectedResult)",
          "291:         self::assertSame($expectedResult, $this->generalValidatorMock->_call('validateInt', $value));",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "311:     {",
          "312:         return [",
          "313:             [",
          "",
          "[Removed Lines]",
          "310:     public static function validateLettersReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "299:     public static function validateLettersReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "346:     {",
          "347:         return [",
          "348:             [",
          "",
          "[Removed Lines]",
          "345:     public static function validateUnicodeLettersReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "334:     public static function validateUnicodeLettersReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "377:     }",
          "386:     {",
          "388:     }",
          "397:     {",
          "399:     }",
          "407:     {",
          "408:         return [",
          "409:             [",
          "410:                 'in2code.de',",
          "411:                 'number,letter,special',",
          "413:             ],",
          "414:             [",
          "415:                 'in2code.de ',",
          "416:                 'number,letter,special,space',",
          "418:             ],",
          "419:             [",
          "420:                 'in2code.de',",
          "421:                 'number,  special',",
          "423:             ],",
          "424:             [",
          "425:                 'in2code.de',",
          "426:                 '   special  ,   letter ',",
          "428:             ],",
          "429:             [",
          "430:                 'in2code',",
          "431:                 'number,letter',",
          "433:             ],",
          "434:             [",
          "435:                 'in2code',",
          "438:             ],",
          "439:             [",
          "440:                 'in2code#',",
          "441:                 'special',",
          "443:             ],",
          "444:             [",
          "446:                 'special',",
          "447:                 true",
          "448:             ],",
          "449:             [",
          "450:                 'in2code',",
          "451:                 'number',",
          "453:             ],",
          "454:             [",
          "455:                 'incode.',",
          "456:                 'number,letter',",
          "457:                 false",
          "458:             ],",
          "459:             [",
          "460:                 'in2 code',",
          "461:                 'number,letter',",
          "463:             ],",
          "464:             [",
          "465:                 'in code',",
          "466:                 'letter',",
          "468:             ],",
          "469:             [",
          "470:                 '1 2',",
          "471:                 'number',",
          "473:             ],",
          "474:             [",
          "475:                 '2',",
          "476:                 'number',",
          "478:             ],",
          "479:             [",
          "480:                 '1 2',",
          "481:                 'space',",
          "483:             ],",
          "484:             [",
          "485:                 '132',",
          "486:                 'space',",
          "488:             ],",
          "489:             [",
          "490:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "491:                 'space',",
          "493:             ],",
          "494:             [",
          "495:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "496:                 'letter,number,special,space',",
          "498:             ],",
          "499:             [",
          "500:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "501:                 'special,space',",
          "507:                 false",
          "508:             ],",
          "509:             [",
          "511:                 'uppercase',",
          "512:                 true",
          "513:             ],",
          "514:             [",
          "516:                 'uppercase',",
          "518:             ],",
          "519:             [",
          "520:                 'in2codE',",
          "521:                 'uppercase',",
          "528:             ],",
          "529:             [",
          "533:             ],",
          "560:             [",
          "561:                 'in2code.de',",
          "562:                 'number,letter,special',",
          "564:             ],",
          "565:             [",
          "566:                 'in2code.de ',",
          "567:                 'number,letter,special,space',",
          "569:             ],",
          "570:             [",
          "571:                 'in2code.de',",
          "572:                 'number,  special',",
          "574:             ],",
          "575:             [",
          "576:                 'in2code.de',",
          "577:                 '   special  ,   letter ',",
          "579:             ],",
          "580:             [",
          "581:                 'in2code',",
          "582:                 'number,letter',",
          "584:             ],",
          "585:             [",
          "586:                 'in2code',",
          "589:             ],",
          "590:             [",
          "591:                 'in2code#',",
          "592:                 'special',",
          "594:             ],",
          "595:             [",
          "597:                 'special',",
          "598:                 true",
          "599:             ],",
          "600:             [",
          "601:                 'in2code',",
          "602:                 'number',",
          "604:             ],",
          "605:             [",
          "606:                 'incode.',",
          "607:                 'number,letter',",
          "608:                 false",
          "609:             ],",
          "610:             [",
          "611:                 'in2 code',",
          "612:                 'number,letter',",
          "614:             ],",
          "615:             [",
          "616:                 'in code',",
          "617:                 'letter',",
          "619:             ],",
          "620:             [",
          "621:                 '1 2',",
          "622:                 'number',",
          "624:             ],",
          "625:             [",
          "626:                 '2',",
          "627:                 'number',",
          "629:             ],",
          "630:             [",
          "631:                 '1 2',",
          "632:                 'space',",
          "634:             ],",
          "635:             [",
          "636:                 '132',",
          "637:                 'space',",
          "639:             ],",
          "640:             [",
          "641:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "642:                 'space',",
          "644:             ],",
          "645:             [",
          "646:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "647:                 'letter,number,special,space',",
          "649:             ],",
          "650:             [",
          "651:                 'a;#/%\u00e4\u00df\u00b4^\u00e1 3',",
          "652:                 'special,space',",
          "654:             ],",
          "655:             [",
          "656:                 'in2code',",
          "657:                 'uppercase',",
          "659:             ],",
          "660:             [",
          "661:                 'In2code',",
          "662:                 'uppercase',",
          "664:             ],",
          "665:             [",
          "667:                 'uppercase',",
          "669:             ],",
          "670:             [",
          "672:                 'uppercase',",
          "674:             ],",
          "675:         ];",
          "676:     }",
          "687:         self::assertSame(",
          "688:             $expectedResult,",
          "690:         );",
          "691:     }",
          "",
          "[Removed Lines]",
          "385:     public function testValidateLettersReturnsBool($value, $expectedResult)",
          "387:         self::assertSame($expectedResult, $this->generalValidatorMock->_callRef('validateLetters', $value));",
          "396:     public function testUnicodeValidateLettersReturnsBool($value, $expectedResult)",
          "398:         self::assertSame($expectedResult, $this->generalValidatorMock->_callRef('validateUnicodeLetters', $value));",
          "406:     public static function validateMustIncludeReturnsBoolDataProvider()",
          "412:                 true",
          "417:                 true",
          "422:                 true",
          "427:                 true",
          "432:                 true",
          "436:                 'special,letter',",
          "437:                 false",
          "442:                 true",
          "445:                 'in2co de',",
          "452:                 true",
          "462:                 true",
          "467:                 true",
          "472:                 true",
          "477:                 true",
          "482:                 true",
          "487:                 false",
          "492:                 true",
          "497:                 true",
          "502:                 true",
          "503:             ],",
          "504:             [",
          "505:                 'in2code',",
          "506:                 'uppercase',",
          "510:                 'In2code',",
          "515:                 'in2Code',",
          "517:                 true",
          "522:                 true",
          "523:             ],",
          "524:             [",
          "525:                 'In2code',",
          "526:                 'number,uppercase',",
          "527:                 true",
          "530:                 'I n2code',",
          "531:                 'number,uppercase,space',",
          "532:                 true",
          "534:         ];",
          "535:     }",
          "544:     public function testValidateMustIncludeReturnsBool($value, $configuration, $expectedResult)",
          "545:     {",
          "546:         self::assertSame(",
          "547:             $expectedResult,",
          "548:             $this->generalValidatorMock->_callRef('validateMustInclude', $value, $configuration)",
          "549:         );",
          "550:     }",
          "557:     public static function validateMustNotIncludeReturnsBoolDataProvider()",
          "558:     {",
          "559:         return [",
          "563:                 false",
          "568:                 false",
          "573:                 false",
          "578:                 false",
          "583:                 false",
          "587:                 'special,space',",
          "588:                 true",
          "593:                 false",
          "596:                 'in2co3de',",
          "603:                 false",
          "613:                 false",
          "618:                 false",
          "623:                 false",
          "628:                 false",
          "633:                 false",
          "638:                 true",
          "643:                 false",
          "648:                 false",
          "653:                 false",
          "658:                 true",
          "663:                 false",
          "666:                 'in2codE',",
          "668:                 false",
          "671:                 'in2Code',",
          "673:                 false",
          "685:     public function testValidateMustNotIncludeReturnsBool($value, $configuration, $expectedResult)",
          "686:     {",
          "689:             $this->generalValidatorMock->_callRef('validateMustNotInclude', $value, $configuration)",
          "",
          "[Added Lines]",
          "372:     public function testValidateLettersReturnsBool(string $value, bool $expectedResult)",
          "374:         self::assertSame($expectedResult, $this->generalValidatorMock->_call('validateLetters', $value));",
          "381:     public function testUnicodeValidateLettersReturnsBool(string $value, bool $expectedResult)",
          "383:         self::assertSame($expectedResult, $this->generalValidatorMock->_call('validateUnicodeLetters', $value));",
          "386:     public static function validateStringReturnsBoolDataProvider(): array",
          "392:                 false,",
          "393:                 false",
          "398:                 false,",
          "399:                 false",
          "404:                 false,",
          "405:                 false",
          "410:                 false,",
          "411:                 false",
          "416:                 false,",
          "417:                 false",
          "421:                 'special,space',",
          "422:                 false,",
          "423:                 true",
          "428:                 false,",
          "429:                 false",
          "432:                 'in2co3de',",
          "434:                 false,",
          "440:                 false,",
          "441:                 false",
          "446:                 false,",
          "452:                 false,",
          "453:                 false",
          "458:                 false,",
          "459:                 false",
          "464:                 false,",
          "465:                 false",
          "470:                 false,",
          "471:                 false",
          "476:                 false,",
          "477:                 false",
          "482:                 false,",
          "483:                 true",
          "488:                 false,",
          "489:                 false",
          "494:                 false,",
          "495:                 false",
          "500:                 false,",
          "504:                 'in2code',",
          "506:                 false,",
          "510:                 'In2code',",
          "512:                 false,",
          "513:                 false",
          "518:                 false,",
          "519:                 false",
          "522:                 'in2Code',",
          "523:                 'uppercase',",
          "524:                 false,",
          "525:                 false",
          "530:                 true,",
          "531:                 true",
          "536:                 true,",
          "537:                 true",
          "542:                 true,",
          "543:                 true",
          "548:                 true,",
          "549:                 true",
          "554:                 true,",
          "555:                 true",
          "559:                 'special,letter',",
          "560:                 true,",
          "561:                 false",
          "566:                 true,",
          "567:                 true",
          "570:                 'in2co de',",
          "572:                 true,",
          "578:                 true,",
          "579:                 true",
          "584:                 true,",
          "590:                 true,",
          "591:                 true",
          "596:                 true,",
          "597:                 true",
          "602:                 true,",
          "603:                 true",
          "608:                 true,",
          "609:                 true",
          "614:                 true,",
          "615:                 true",
          "620:                 true,",
          "621:                 false",
          "626:                 true,",
          "627:                 true",
          "632:                 true,",
          "633:                 true",
          "638:                 true,",
          "639:                 true",
          "644:                 true,",
          "645:                 false",
          "650:                 true,",
          "651:                 true",
          "654:                 'in2Code',",
          "656:                 true,",
          "657:                 true",
          "660:                 'in2codE',",
          "662:                 true,",
          "663:                 true",
          "664:             ],",
          "665:             [",
          "666:                 'In2code',",
          "667:                 'number,uppercase',",
          "668:                 true,",
          "669:                 true",
          "670:             ],",
          "671:             [",
          "672:                 'I n2code',",
          "673:                 'number,uppercase,space',",
          "674:                 true,",
          "675:                 true",
          "684:     public function testValidateStringReturnsBool(",
          "685:         string $value,",
          "686:         string $configuration,",
          "687:         bool $mustInclude,",
          "688:         bool $expectedResult",
          "689:     ) {",
          "692:             $this->generalValidatorMock->_call(",
          "693:                 'validateString',",
          "694:                 $value,",
          "695:                 $configuration,",
          "696:                 $mustInclude",
          "697:             )",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "699:     {",
          "700:         return [",
          "701:             [",
          "",
          "[Removed Lines]",
          "698:     public static function validateInListReturnsBoolDataProvider()",
          "",
          "[Added Lines]",
          "706:     public static function validateInListReturnsBoolDataProvider(): array",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "777:     }",
          "787:     {",
          "788:         self::assertSame(",
          "789:             $expectedResult,",
          "791:         );",
          "792:     }",
          "",
          "[Removed Lines]",
          "786:     public function testValidateInListReturnsBool($value, $configuration, $expectedResult)",
          "790:             $this->generalValidatorMock->_callRef('validateInList', $value, $configuration)",
          "",
          "[Added Lines]",
          "791:     public function testValidateInListReturnsBool(mixed $value, mixed $configuration, bool $expectedResult)",
          "795:             $this->generalValidatorMock->_call('validateInList', $value, $configuration)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "800:     {",
          "801:         return [",
          "802:             [",
          "",
          "[Removed Lines]",
          "799:     public static function validateSameAsReturnsBoolDateProvider()",
          "",
          "[Added Lines]",
          "804:     public static function validateSameAsReturnsBoolDateProvider(): array",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "833:     }",
          "843:     {",
          "846:     }",
          "847: }",
          "",
          "[Removed Lines]",
          "842:     public function testValidateSameAsReturnsBool($value, $value2, $result)",
          "844:         $test = $this->generalValidatorMock->_callRef('validateSameAs', $value, $value2);",
          "845:         self::assertSame($result, $test);",
          "",
          "[Added Lines]",
          "844:     public function testValidateSameAsReturnsBool(mixed $value, mixed $value2, bool $expectedResult)",
          "846:         $test = $this->generalValidatorMock->_call('validateSameAs', $value, $value2);",
          "847:         self::assertSame($expectedResult, $test);",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "8: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "9: use PHPUnit\\Framework\\MockObject\\MockObject;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: use TYPO3\\TestingFramework\\Core\\AccessibleObjectInterface;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "15: class ServersideValidatorTest extends UnitTestCase",
          "16: {",
          "25:     public function setUp(): void",
          "26:     {",
          "28:     }",
          "",
          "[Removed Lines]",
          "20:     protected $generalValidatorMock;",
          "27:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
          "",
          "[Added Lines]",
          "18:     protected ServersideValidator|AccessibleObjectInterface|MockObject $generalValidatorMock;",
          "25:         $this->generalValidatorMock = $this->getAccessibleMock(",
          "26:             ServersideValidator::class,",
          "27:             null",
          "28:         );",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     {",
          "43:         $user = new User();",
          "46:         $usergroup2 = $this->getUserGroupMock(2);",
          "48:         $user->addUsergroup($usergroup1);",
          "",
          "[Removed Lines]",
          "45:         $usergroup1 = $this->getUserGroupMock(1);",
          "",
          "[Added Lines]",
          "46:         $usergroup1 = $this->getUserGroupMock();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "51:         $fieldName = 'usergroup';",
          "55:         self::assertSame('1,2', $result);",
          "56:     }",
          "",
          "[Removed Lines]",
          "53:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "",
          "[Added Lines]",
          "54:         $result = $this->generalValidatorMock->_call('getValue', $user, $fieldName);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "65:         $fieldName = 'username';",
          "69:         self::assertSame('testuser', $result);",
          "70:     }",
          "",
          "[Removed Lines]",
          "67:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "",
          "[Added Lines]",
          "68:         $result = $this->generalValidatorMock->_call('getValue', $user, $fieldName);",
          "",
          "---------------"
        ],
        "Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php||Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php": [
          "File: Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php -> Tests/Unit/Fixture/Domain/Validator/AbstractValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: class AbstractValidator extends AbstractValidatorFemanager",
          "13: {",
          "15:     {",
          "17:     }",
          "18: }",
          "",
          "[Removed Lines]",
          "14:     public function isValid($value): void",
          "16:         parent::isValid($value);",
          "",
          "[Added Lines]",
          "15:     protected function isValid(mixed $value): void",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b581078d4d31bf8180c08f4c79c82434a2cadedf",
      "candidate_info": {
        "commit_hash": "b581078d4d31bf8180c08f4c79c82434a2cadedf",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/b581078d4d31bf8180c08f4c79c82434a2cadedf",
        "files": [
          "Classes/Controller/AbstractController.php",
          "Classes/Controller/AbstractFrontendController.php",
          "Classes/Controller/EditController.php",
          "Classes/Controller/InvitationController.php",
          "Classes/Controller/NewController.php",
          "Classes/Domain/Repository/UserRepository.php",
          "Classes/Domain/Service/FinisherService.php",
          "Classes/Finisher/FinisherRunner.php",
          "Classes/Finisher/SaveToAnyTableFinisher.php",
          "Classes/Finisher/SendParametersFinisher.php",
          "Classes/Utility/ObjectUtility.php",
          "Classes/Utility/UserUtility.php",
          "Configuration/Extbase/Persistence/Classes.php",
          "Configuration/TCA/Overrides/fe_users.php",
          "Configuration/TCA/Overrides/sys_template.php",
          "Configuration/TCA/Overrides/tt_content.php",
          "Tests/Scripts/UserLinks.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ],
        "message": "[TASK] Use name import for shorter class names",
        "before_after_code_files": [
          "Classes/Controller/AbstractController.php||Classes/Controller/AbstractController.php",
          "Classes/Controller/AbstractFrontendController.php||Classes/Controller/AbstractFrontendController.php",
          "Classes/Controller/EditController.php||Classes/Controller/EditController.php",
          "Classes/Controller/InvitationController.php||Classes/Controller/InvitationController.php",
          "Classes/Controller/NewController.php||Classes/Controller/NewController.php",
          "Classes/Domain/Repository/UserRepository.php||Classes/Domain/Repository/UserRepository.php",
          "Classes/Domain/Service/FinisherService.php||Classes/Domain/Service/FinisherService.php",
          "Classes/Finisher/FinisherRunner.php||Classes/Finisher/FinisherRunner.php",
          "Classes/Finisher/SaveToAnyTableFinisher.php||Classes/Finisher/SaveToAnyTableFinisher.php",
          "Classes/Finisher/SendParametersFinisher.php||Classes/Finisher/SendParametersFinisher.php",
          "Classes/Utility/ObjectUtility.php||Classes/Utility/ObjectUtility.php",
          "Classes/Utility/UserUtility.php||Classes/Utility/UserUtility.php",
          "Configuration/Extbase/Persistence/Classes.php||Configuration/Extbase/Persistence/Classes.php",
          "Configuration/TCA/Overrides/fe_users.php||Configuration/TCA/Overrides/fe_users.php",
          "Configuration/TCA/Overrides/sys_template.php||Configuration/TCA/Overrides/sys_template.php",
          "Configuration/TCA/Overrides/tt_content.php||Configuration/TCA/Overrides/tt_content.php",
          "Tests/Scripts/UserLinks.php||Tests/Scripts/UserLinks.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Controller/AbstractController.php||Classes/Controller/AbstractController.php": [
          "File: Classes/Controller/AbstractController.php -> Classes/Controller/AbstractController.php"
        ],
        "Classes/Controller/AbstractFrontendController.php||Classes/Controller/AbstractFrontendController.php": [
          "File: Classes/Controller/AbstractFrontendController.php -> Classes/Controller/AbstractFrontendController.php"
        ],
        "Classes/Controller/EditController.php||Classes/Controller/EditController.php": [
          "File: Classes/Controller/EditController.php -> Classes/Controller/EditController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: declare(strict_types=1);",
          "4: namespace In2code\\Femanager\\Controller;",
          "6: use In2code\\Femanager\\Domain\\Model\\Log;",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6: use TYPO3\\CMS\\Extbase\\Annotation\\Validate;",
          "",
          "---------------"
        ],
        "Classes/Controller/InvitationController.php||Classes/Controller/InvitationController.php": [
          "File: Classes/Controller/InvitationController.php -> Classes/Controller/InvitationController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: declare(strict_types=1);",
          "4: namespace In2code\\Femanager\\Controller;",
          "6: use In2code\\Femanager\\Domain\\Model\\Log;",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use In2code\\Femanager\\Event\\InviteUserConfirmedEvent;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6: use TYPO3\\CMS\\Extbase\\Annotation\\Validate;",
          "",
          "---------------"
        ],
        "Classes/Controller/NewController.php||Classes/Controller/NewController.php": [
          "File: Classes/Controller/NewController.php -> Classes/Controller/NewController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: namespace In2code\\Femanager\\Controller;",
          "7: use In2code\\Femanager\\Domain\\Model\\Log;",
          "8: use In2code\\Femanager\\Domain\\Model\\User;",
          "9: use In2code\\Femanager\\Domain\\Service\\AutoAdminConfirmationService;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: use TYPO3\\CMS\\Extbase\\Annotation\\Validate;",
          "8: use TYPO3\\CMS\\Extbase\\Mvc\\Exception\\StopActionException;",
          "",
          "---------------"
        ],
        "Classes/Domain/Repository/UserRepository.php||Classes/Domain/Repository/UserRepository.php": [
          "File: Classes/Domain/Repository/UserRepository.php -> Classes/Domain/Repository/UserRepository.php"
        ],
        "Classes/Domain/Service/FinisherService.php||Classes/Domain/Service/FinisherService.php": [
          "File: Classes/Domain/Service/FinisherService.php -> Classes/Domain/Service/FinisherService.php"
        ],
        "Classes/Finisher/FinisherRunner.php||Classes/Finisher/FinisherRunner.php": [
          "File: Classes/Finisher/FinisherRunner.php -> Classes/Finisher/FinisherRunner.php"
        ],
        "Classes/Finisher/SaveToAnyTableFinisher.php||Classes/Finisher/SaveToAnyTableFinisher.php": [
          "File: Classes/Finisher/SaveToAnyTableFinisher.php -> Classes/Finisher/SaveToAnyTableFinisher.php"
        ],
        "Classes/Finisher/SendParametersFinisher.php||Classes/Finisher/SendParametersFinisher.php": [
          "File: Classes/Finisher/SendParametersFinisher.php -> Classes/Finisher/SendParametersFinisher.php"
        ],
        "Classes/Utility/ObjectUtility.php||Classes/Utility/ObjectUtility.php": [
          "File: Classes/Utility/ObjectUtility.php -> Classes/Utility/ObjectUtility.php"
        ],
        "Classes/Utility/UserUtility.php||Classes/Utility/UserUtility.php": [
          "File: Classes/Utility/UserUtility.php -> Classes/Utility/UserUtility.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: namespace In2code\\Femanager\\Utility;",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "9: use In2code\\Femanager\\Domain\\Repository\\UserRepository;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: use TYPO3\\CMS\\Core\\Crypto\\PasswordHashing\\InvalidPasswordHashException;",
          "",
          "---------------"
        ],
        "Configuration/Extbase/Persistence/Classes.php||Configuration/Extbase/Persistence/Classes.php": [
          "File: Configuration/Extbase/Persistence/Classes.php -> Configuration/Extbase/Persistence/Classes.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: declare(strict_types=1);",
          "5: return [",
          "8:         'properties' => [",
          "9:             'terms' => [",
          "10:                 'fieldName' => 'tx_femanager_terms'",
          "",
          "[Removed Lines]",
          "6:     \\In2code\\Femanager\\Domain\\Model\\User::class => [",
          "7:         'tableName' => \\In2code\\Femanager\\Domain\\Model\\User::TABLE_NAME,",
          "",
          "[Added Lines]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "9:     User::class => [",
          "10:         'tableName' => User::TABLE_NAME,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14:             ]",
          "15:         ]",
          "16:     ],",
          "18:         'tableName' => 'fe_groups'",
          "19:     ]",
          "20: ];",
          "",
          "[Removed Lines]",
          "17:     \\In2code\\Femanager\\Domain\\Model\\UserGroup::class => [",
          "",
          "[Added Lines]",
          "20:     UserGroup::class => [",
          "",
          "---------------"
        ],
        "Configuration/TCA/Overrides/fe_users.php||Configuration/TCA/Overrides/fe_users.php": [
          "File: Configuration/TCA/Overrides/fe_users.php -> Configuration/TCA/Overrides/fe_users.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
          "4: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "5: use TYPO3\\CMS\\Core\\Configuration\\ExtensionConfiguration;",
          "6: use In2code\\Femanager\\Utility\\ConfigurationUtility;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "110:     ],",
          "111: ];",
          "114: if ($staticInfoTablesIsLoaded) {",
          "115:     $feUsersColumns['state'] = [",
          "116:         'label' => 'LLL:EXT:femanager/Resources/Private/Language/locallang_db.xlf:' .",
          "",
          "[Removed Lines]",
          "113: $staticInfoTablesIsLoaded = \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::isLoaded('static_info_tables');",
          "",
          "[Added Lines]",
          "117: $staticInfoTablesIsLoaded = ExtensionManagementUtility::isLoaded('static_info_tables');",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "127:         ]",
          "128:     ];",
          "129: }",
          "132: );",
          "133: if ($extConf->get('femanager', 'overrideFeUserCountryFieldWithSelect')) {",
          "134:     $GLOBALS['TCA']['fe_users']['columns']['country']['config'] = [",
          "",
          "[Removed Lines]",
          "130: $extConf = \\TYPO3\\CMS\\Core\\Utility\\GeneralUtility::makeInstance(",
          "131:     \\TYPO3\\CMS\\Core\\Configuration\\ExtensionConfiguration::class",
          "",
          "[Added Lines]",
          "134: $extConf = GeneralUtility::makeInstance(",
          "135:     ExtensionConfiguration::class",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "145: $fields = 'crdate, tstamp, tx_femanager_confirmedbyuser, tx_femanager_confirmedbyadmin, tx_femanager_terms, ' .",
          "146:     'tx_femanager_terms_date_of_acceptance';",
          "149:     $feUsersColumns['tx_femanager_log'] = [",
          "150:         'exclude' => 1,",
          "151:         'label' => 'LLL:EXT:femanager/Resources/Private/Language/locallang_db.xlf:fe_users.log',",
          "",
          "[Removed Lines]",
          "148: if (!\\In2code\\Femanager\\Utility\\ConfigurationUtility::isDisableLogActive()) {",
          "",
          "[Added Lines]",
          "152: if (!ConfigurationUtility::isDisableLogActive()) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "177: ];",
          "178: $fields .= ', tx_femanager_changerequest';",
          "181:     'fe_users',",
          "182:     'gender, date_of_birth',",
          "183:     '',",
          "",
          "[Removed Lines]",
          "180: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addToAllTCAtypes(",
          "",
          "[Added Lines]",
          "184: ExtensionManagementUtility::addToAllTCAtypes(",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "186: if ($staticInfoTablesIsLoaded) {",
          "187:     $GLOBALS['TCA']['fe_users']['columns']['country']['onChange'] = 'reload';",
          "188:     $fields .= ',state';",
          "190:         'fe_users',",
          "191:         'state',",
          "192:         '',",
          "193:         'after:country'",
          "194:     );",
          "195: }",
          "198:     'fe_users',",
          "199:     '--div--;LLL:EXT:femanager/Resources/Private/Language/locallang_db.xlf:fe_users.tab, ' . $fields",
          "200: );",
          "",
          "[Removed Lines]",
          "189:     \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addToAllTCAtypes(",
          "196: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addTCAcolumns('fe_users', $feUsersColumns);",
          "197: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addToAllTCAtypes(",
          "",
          "[Added Lines]",
          "193:     ExtensionManagementUtility::addToAllTCAtypes(",
          "200: ExtensionManagementUtility::addTCAcolumns('fe_users', $feUsersColumns);",
          "201: ExtensionManagementUtility::addToAllTCAtypes(",
          "",
          "---------------"
        ],
        "Configuration/TCA/Overrides/sys_template.php||Configuration/TCA/Overrides/sys_template.php": [
          "File: Configuration/TCA/Overrides/sys_template.php -> Configuration/TCA/Overrides/sys_template.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php",
          "3: defined('TYPO3') or die();",
          "9:     'femanager',",
          "10:     'Configuration/TypoScript/Main',",
          "11:     'Main Settings'",
          "12: );",
          "14:     'femanager',",
          "15:     'Configuration/TypoScript/Layout',",
          "16:     'Add Layout CSS'",
          "",
          "[Removed Lines]",
          "8: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addStaticFile(",
          "13: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addStaticFile(",
          "",
          "[Added Lines]",
          "3: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
          "9: ExtensionManagementUtility::addStaticFile(",
          "14: ExtensionManagementUtility::addStaticFile(",
          "",
          "---------------"
        ],
        "Configuration/TCA/Overrides/tt_content.php||Configuration/TCA/Overrides/tt_content.php": [
          "File: Configuration/TCA/Overrides/tt_content.php -> Configuration/TCA/Overrides/tt_content.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php",
          "3: defined('TYPO3') or die();",
          "13: $pluginSignature = str_replace('_', '', 'femanager') . '_pi1';",
          "14: $GLOBALS['TCA']['tt_content']['types']['list']['subtypes_addlist'][$pluginSignature] = 'pi_flexform';",
          "16:     $pluginSignature,",
          "17:     'FILE:EXT:femanager/Configuration/FlexForms/FlexFormPi1.xml'",
          "18: );",
          "",
          "[Removed Lines]",
          "8: \\TYPO3\\CMS\\Extbase\\Utility\\ExtensionUtility::registerPlugin('femanager', 'Pi1', 'FE_Manager');",
          "15: \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::addPiFlexFormValue(",
          "",
          "[Added Lines]",
          "3: use TYPO3\\CMS\\Extbase\\Utility\\ExtensionUtility;",
          "4: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
          "10: ExtensionUtility::registerPlugin('femanager', 'Pi1', 'FE_Manager');",
          "17: ExtensionManagementUtility::addPiFlexFormValue(",
          "",
          "---------------"
        ],
        "Tests/Scripts/UserLinks.php||Tests/Scripts/UserLinks.php": [
          "File: Tests/Scripts/UserLinks.php -> Tests/Scripts/UserLinks.php"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use PHPUnit\\Framework\\MockObject\\MockObject;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "75d33f6955d5bdaed6e22a58a8f8a73e28a8ef7f",
      "candidate_info": {
        "commit_hash": "75d33f6955d5bdaed6e22a58a8f8a73e28a8ef7f",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/75d33f6955d5bdaed6e22a58a8f8a73e28a8ef7f",
        "files": [
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ],
        "message": "[BUGFIX] Coding style",
        "before_after_code_files": [
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ]
      }
    },
    {
      "candidate_hash": "87f242cfe9840426d7eae9f16422eff8f4b042a5",
      "candidate_info": {
        "commit_hash": "87f242cfe9840426d7eae9f16422eff8f4b042a5",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/87f242cfe9840426d7eae9f16422eff8f4b042a5",
        "files": [
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "Tests/Unit/UnitTestsBootstrap.php",
          "Tests/Unit/Utility/AbstractUtilityTest.php",
          "Tests/Unit/Utility/BackendUserUtilityTest.php",
          "Tests/Unit/Utility/BackendUtilityTest.php",
          "Tests/Unit/Utility/ConfigurationUtilityTest.php",
          "Tests/Unit/Utility/FileUtilityTest.php",
          "Tests/Unit/Utility/FrontendUtilityTest.php",
          "Tests/Unit/Utility/HashUtilityTest.php",
          "Tests/Unit/Utility/ObjectUtilityTest.php",
          "Tests/Unit/Utility/StringUtilityTest.php",
          "Tests/Unit/ViewHelpers/Form/GetCountriesTest.php",
          "Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php",
          "Tests/Unit/bootstrap.php",
          "composer.json",
          "phpunit.xml.dist"
        ],
        "message": "[TASK] Replace Nimut testing Framework with TYPO3 testing framework",
        "before_after_code_files": [
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "Tests/Unit/UnitTestsBootstrap.php||Tests/Unit/UnitTestsBootstrap.php",
          "Tests/Unit/Utility/AbstractUtilityTest.php||Tests/Unit/Utility/AbstractUtilityTest.php",
          "Tests/Unit/Utility/BackendUserUtilityTest.php||Tests/Unit/Utility/BackendUserUtilityTest.php",
          "Tests/Unit/Utility/BackendUtilityTest.php||Tests/Unit/Utility/BackendUtilityTest.php",
          "Tests/Unit/Utility/ConfigurationUtilityTest.php||Tests/Unit/Utility/ConfigurationUtilityTest.php",
          "Tests/Unit/Utility/FileUtilityTest.php||Tests/Unit/Utility/FileUtilityTest.php",
          "Tests/Unit/Utility/FrontendUtilityTest.php||Tests/Unit/Utility/FrontendUtilityTest.php",
          "Tests/Unit/Utility/HashUtilityTest.php||Tests/Unit/Utility/HashUtilityTest.php",
          "Tests/Unit/Utility/ObjectUtilityTest.php||Tests/Unit/Utility/ObjectUtilityTest.php",
          "Tests/Unit/Utility/StringUtilityTest.php||Tests/Unit/Utility/StringUtilityTest.php",
          "Tests/Unit/ViewHelpers/Form/GetCountriesTest.php||Tests/Unit/ViewHelpers/Form/GetCountriesTest.php",
          "Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php||Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php",
          "Tests/Unit/bootstrap.php||Tests/Unit/bootstrap.php",
          "phpunit.xml.dist||phpunit.xml.dist"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Tests\\Unit\\Fixture\\Domain\\Validator\\AbstractValidator;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:     public function setUp(): void",
          "23:     {",
          "24:         $this->generalValidatorMock = $this->getAccessibleMock(AbstractValidator::class, ['dummy']);",
          "25:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "24:         var_dump('foo');",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "9: use PHPUnit\\Framework\\MockObject\\MockObject;",
          "",
          "[Removed Lines]",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "8: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/UnitTestsBootstrap.php||Tests/Unit/UnitTestsBootstrap.php": [
          "File: Tests/Unit/UnitTestsBootstrap.php -> Tests/Unit/UnitTestsBootstrap.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: use TYPO3\\CMS\\Core\\Core\\Environment;",
          "32: (static function () {",
          "33:     $testbase = new \\TYPO3\\TestingFramework\\Core\\Testbase();",
          "42:     if (!getenv('TYPO3_PATH_ROOT')) {",
          "43:         putenv('TYPO3_PATH_ROOT=' . rtrim($testbase->getWebRoot(), '/'));",
          "44:     }",
          "45:     if (!getenv('TYPO3_PATH_WEB')) {",
          "46:         putenv('TYPO3_PATH_WEB=' . rtrim($testbase->getWebRoot(), '/'));",
          "47:     }",
          "49:     $testbase->defineSitePath();",
          "53:     $requestType = \\TYPO3\\CMS\\Core\\Core\\SystemEnvironmentBuilder::REQUESTTYPE_BE | \\TYPO3\\CMS\\Core\\Core\\SystemEnvironmentBuilder::REQUESTTYPE_CLI;",
          "54:     \\TYPO3\\TestingFramework\\Core\\SystemEnvironmentBuilder::run(0, $requestType);",
          "55:     Environment::initialize(",
          "56:         Environment::getContext(),",
          "57:         Environment::isCli(),",
          "58:         defined('TYPO3_COMPOSER_MODE') && TYPO3_COMPOSER_MODE === true,",
          "59:         Environment::getProjectPath(),",
          "60:         Environment::getPublicPath(),",
          "61:         Environment::getVarPath(),",
          "62:         Environment::getConfigPath(),",
          "63:         Environment::getCurrentScript(),",
          "64:         Environment::isWindows() ? 'WINDOWS' : 'UNIX'",
          "65:     );",
          "67:     $testbase->createDirectory(\\TYPO3\\CMS\\Core\\Core\\Environment::getPublicPath() . '/typo3conf/ext');",
          "68:     $testbase->createDirectory(\\TYPO3\\CMS\\Core\\Core\\Environment::getPublicPath() . '/typo3temp/assets');",
          "69:     $testbase->createDirectory(\\TYPO3\\CMS\\Core\\Core\\Environment::getPublicPath() . '/typo3temp/var/tests');",
          "70:     $testbase->createDirectory(\\TYPO3\\CMS\\Core\\Core\\Environment::getPublicPath() . '/typo3temp/var/transient');",
          "73:     $classLoader = require $testbase->getPackagesPath() . '/autoload.php';",
          "74:     \\TYPO3\\CMS\\Core\\Core\\Bootstrap::initializeClassLoader($classLoader);",
          "77:     $configurationManager = new \\TYPO3\\CMS\\Core\\Configuration\\ConfigurationManager();",
          "78:     $GLOBALS['TYPO3_CONF_VARS'] = $configurationManager->getDefaultConfiguration();",
          "80:     $cache = new \\TYPO3\\CMS\\Core\\Cache\\Frontend\\PhpFrontend(",
          "81:         'core',",
          "82:         new \\TYPO3\\CMS\\Core\\Cache\\Backend\\NullBackend('production', [])",
          "83:     );",
          "84:     $packageManager = \\TYPO3\\CMS\\Core\\Core\\Bootstrap::createPackageManager(",
          "85:         \\TYPO3\\CMS\\Core\\Package\\UnitTestPackageManager::class,",
          "86:         \\TYPO3\\CMS\\Core\\Core\\Bootstrap::createPackageCache($cache)",
          "87:     );",
          "89:     \\TYPO3\\CMS\\Core\\Utility\\GeneralUtility::setSingletonInstance(\\TYPO3\\CMS\\Core\\Package\\PackageManager::class, $packageManager);",
          "90:     \\TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility::setPackageManager($packageManager);",
          "92:     $testbase->dumpClassLoadingInformation();",
          "94:     \\TYPO3\\CMS\\Core\\Utility\\GeneralUtility::purgeInstances();",
          "95: })();",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/AbstractUtilityTest.php||Tests/Unit/Utility/AbstractUtilityTest.php": [
          "File: Tests/Unit/Utility/AbstractUtilityTest.php -> Tests/Unit/Utility/AbstractUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Utility;",
          "5: use In2code\\Femanager\\Tests\\Unit\\Fixture\\Utility\\AbstractUtility;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "12: class AbstractUtilityTest extends UnitTestCase",
          "13: {",
          "",
          "[Removed Lines]",
          "17:     protected $testFilesToDelete = [];",
          "",
          "[Added Lines]",
          "14:     protected array $testFilesToDelete = [];",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/BackendUserUtilityTest.php||Tests/Unit/Utility/BackendUserUtilityTest.php": [
          "File: Tests/Unit/Utility/BackendUserUtilityTest.php -> Tests/Unit/Utility/BackendUserUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Utility;",
          "5: use In2code\\Femanager\\Utility\\BackendUserUtility;",
          "7: use TYPO3\\CMS\\Core\\Authentication\\BackendUserAuthentication;",
          "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "21:     public function setUp(): void",
          "22:     {",
          "",
          "[Removed Lines]",
          "19:     protected $testFilesToDelete = [];",
          "",
          "[Added Lines]",
          "19:     protected array $testFilesToDelete = [];",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/BackendUtilityTest.php||Tests/Unit/Utility/BackendUtilityTest.php": [
          "File: Tests/Unit/Utility/BackendUtilityTest.php -> Tests/Unit/Utility/BackendUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Tests\\Helper\\TestingHelper;",
          "6: use In2code\\Femanager\\Tests\\Unit\\Fixture\\Utility\\BackendUtility as BackendUtilityFixture;",
          "7: use In2code\\Femanager\\Utility\\BackendUtility;",
          "9: use TYPO3\\CMS\\Core\\Core\\SystemEnvironmentBuilder;",
          "10: use TYPO3\\CMS\\Core\\Http\\ServerRequest;",
          "",
          "[Removed Lines]",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "8: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/ConfigurationUtilityTest.php||Tests/Unit/Utility/ConfigurationUtilityTest.php": [
          "File: Tests/Unit/Utility/ConfigurationUtilityTest.php -> Tests/Unit/Utility/ConfigurationUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Utility;",
          "5: use In2code\\Femanager\\Utility\\ConfigurationUtility;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/FileUtilityTest.php||Tests/Unit/Utility/FileUtilityTest.php": [
          "File: Tests/Unit/Utility/FileUtilityTest.php -> Tests/Unit/Utility/FileUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Tests\\Helper\\TestingHelper;",
          "6: use In2code\\Femanager\\Utility\\FileUtility;",
          "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "",
          "[Removed Lines]",
          "7: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "7: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/FrontendUtilityTest.php||Tests/Unit/Utility/FrontendUtilityTest.php": [
          "File: Tests/Unit/Utility/FrontendUtilityTest.php -> Tests/Unit/Utility/FrontendUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Tests\\Helper\\TestingHelper;",
          "7: use In2code\\Femanager\\Utility\\FrontendUtility;",
          "",
          "[Removed Lines]",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "8: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/HashUtilityTest.php||Tests/Unit/Utility/HashUtilityTest.php": [
          "File: Tests/Unit/Utility/HashUtilityTest.php -> Tests/Unit/Utility/HashUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Utility\\HashUtility;",
          "",
          "[Removed Lines]",
          "7: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "7: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/ObjectUtilityTest.php||Tests/Unit/Utility/ObjectUtilityTest.php": [
          "File: Tests/Unit/Utility/ObjectUtilityTest.php -> Tests/Unit/Utility/ObjectUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Utility\\ObjectUtility;",
          "8: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
          "",
          "[Removed Lines]",
          "7: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "7: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/Utility/StringUtilityTest.php||Tests/Unit/Utility/StringUtilityTest.php": [
          "File: Tests/Unit/Utility/StringUtilityTest.php -> Tests/Unit/Utility/StringUtilityTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Utility;",
          "5: use In2code\\Femanager\\Utility\\StringUtility;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/ViewHelpers/Form/GetCountriesTest.php||Tests/Unit/ViewHelpers/Form/GetCountriesTest.php": [
          "File: Tests/Unit/ViewHelpers/Form/GetCountriesTest.php -> Tests/Unit/ViewHelpers/Form/GetCountriesTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\ViewHelpers\\Form;",
          "5: use In2code\\Femanager\\ViewHelpers\\Form\\GetCountriesViewHelper;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php||Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php": [
          "File: Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php -> Tests/Unit/ViewHelpers/Misc/RequestViewHelperTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace In2code\\Femanager\\ViewHelpers\\Request;",
          "5: use In2code\\Femanager\\ViewHelpers\\Misc\\RequestViewHelper;",
          "",
          "[Removed Lines]",
          "6: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "",
          "[Added Lines]",
          "6: use TYPO3\\TestingFramework\\Core\\Unit\\UnitTestCase;",
          "",
          "---------------"
        ],
        "Tests/Unit/bootstrap.php||Tests/Unit/bootstrap.php": [
          "File: Tests/Unit/bootstrap.php -> Tests/Unit/bootstrap.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: $bootstrapLoaded = false;",
          "17: $bootstrap = $webRoot . '/typo3/sysext/core/Build/UnitTestsBootstrap.php';",
          "19: if (file_exists($bootstrap)) {",
          "20:     require($bootstrap);",
          "21:     $bootstrapLoaded = true;",
          "24:     $bootstrapLoaded = true;",
          "25: }",
          "26: if ($bootstrapLoaded === false) {",
          "",
          "[Removed Lines]",
          "18: $bootstrapNimut = $buildRoot . '/vendor/nimut/testing-framework/res/Configuration/UnitTestsBootstrap.php';",
          "22: } elseif (file_exists($bootstrapNimut)) {",
          "23:     require($bootstrapNimut);",
          "",
          "[Added Lines]",
          "18: $bootstrapTypo3 = __DIR__ . '/UnitTestsBootstrap.php';",
          "22: } elseif (file_exists($bootstrapTypo3)) {",
          "23:     require($bootstrapTypo3);",
          "",
          "---------------"
        ],
        "phpunit.xml.dist||phpunit.xml.dist": [
          "File: phpunit.xml.dist -> phpunit.xml.dist",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?xml version=\"1.0\"?>",
          "23:   <coverage includeUncoveredFiles=\"false\" processUncoveredFiles=\"false\">",
          "24:     <include>",
          "25:       <directory suffix=\".php\">Classes/</directory>",
          "",
          "[Removed Lines]",
          "2: <phpunit",
          "3:     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"",
          "4:     xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/9.3/phpunit.xsd\"",
          "5:     backupGlobals=\"true\"",
          "6:     backupStaticAttributes=\"false\"",
          "7:     colors=\"true\"",
          "8:     bootstrap=\"Tests/Unit/bootstrap.php\"",
          "9:     convertErrorsToExceptions=\"true\"",
          "10:     convertNoticesToExceptions=\"true\"",
          "11:     convertWarningsToExceptions=\"true\"",
          "12:     forceCoversAnnotation=\"true\"",
          "13:     processIsolation=\"false\"",
          "14:     stopOnError=\"false\"",
          "15:     stopOnFailure=\"false\"",
          "16:     stopOnIncomplete=\"false\"",
          "17:     stopOnSkipped=\"false\"",
          "18:     stopOnRisky=\"false\"",
          "19:     timeoutForSmallTests=\"1\"",
          "20:     timeoutForMediumTests=\"10\"",
          "21:     timeoutForLargeTests=\"60\"",
          "22:     verbose=\"false\">",
          "",
          "[Added Lines]",
          "2: <phpunit xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/9.3/phpunit.xsd\" backupGlobals=\"true\" backupStaticAttributes=\"false\" colors=\"true\" bootstrap=\"Tests/Unit/bootstrap.php\" convertErrorsToExceptions=\"true\" convertNoticesToExceptions=\"true\" convertWarningsToExceptions=\"true\" forceCoversAnnotation=\"true\" processIsolation=\"false\" stopOnError=\"false\" stopOnFailure=\"false\" stopOnIncomplete=\"false\" stopOnSkipped=\"false\" stopOnRisky=\"false\" timeoutForSmallTests=\"1\" timeoutForMediumTests=\"10\" timeoutForLargeTests=\"60\" verbose=\"false\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "30:     <ini name=\"intl.default_locale\" value=\"en\"/>",
          "31:     <ini name=\"intl.error_level\" value=\"0\"/>",
          "32:     <ini name=\"memory_limit\" value=\"-1\"/>",
          "33:   </php>",
          "34:   <testsuites>",
          "35:     <testsuite name=\"femanager Core Test Suite\">",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13:     <ini name=\"display_errors\" value=\"true\"/>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c241a82ef8e4f1c9c9a11dae56234f94e5e27717",
      "candidate_info": {
        "commit_hash": "c241a82ef8e4f1c9c9a11dae56234f94e5e27717",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/c241a82ef8e4f1c9c9a11dae56234f94e5e27717",
        "files": [
          "Classes/Controller/AbstractController.php",
          "Classes/Controller/NewController.php",
          "Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php",
          "Documentation/Changelog/Index.rst",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ],
        "message": "[BUGFIX] Broken Access Control in Usergroup Validation",
        "before_after_code_files": [
          "Classes/Controller/AbstractController.php||Classes/Controller/AbstractController.php",
          "Classes/Controller/NewController.php||Classes/Controller/NewController.php",
          "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Controller/AbstractController.php||Classes/Controller/AbstractController.php": [
          "File: Classes/Controller/AbstractController.php -> Classes/Controller/AbstractController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "259:         $this->loginPreflight($user, $login);",
          "260:         $variables = ['user' => $user, 'settings' => $this->settings, 'hash' => HashUtility::createHashForUser($user)];",
          "261:         if (ConfigurationUtility::getValue(",
          "265:             $this->sendMailService->send(",
          "266:                 'createUserNotify',",
          "267:                 StringUtility::makeEmailArray($user->getEmail(), $user->getFirstName() . ' ' . $user->getLastName()),",
          "",
          "[Removed Lines]",
          "262:                 'new./email./createUserNotify./sender./email./value',",
          "263:                 $this->config",
          "264:             ) && ConfigurationUtility::getValue('new./email./createUserNotify./sender./name./value', $this->config)) {",
          "",
          "[Added Lines]",
          "262:             'new./email./createUserNotify./sender./email./value',",
          "263:             $this->config",
          "264:         ) && ConfigurationUtility::getValue('new./email./createUserNotify./sender./name./value', $this->config)) {",
          "",
          "---------------"
        ],
        "Classes/Controller/NewController.php||Classes/Controller/NewController.php": [
          "File: Classes/Controller/NewController.php -> Classes/Controller/NewController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "66:             $this->redirect('createStatus');",
          "67:         }",
          "68:         $user = UserUtility::overrideUserGroup($user, $this->settings);",
          "70:         $user = UserUtility::fallbackUsernameAndPassword($user);",
          "71:         $user = UserUtility::takeEmailAsUsername($user, $this->settings);",
          "",
          "[Removed Lines]",
          "69:         $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./beforeAnyConfirmation.',$this->config));",
          "",
          "[Added Lines]",
          "69:         $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./beforeAnyConfirmation.', $this->config));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "171:                 $this->redirect('new');",
          "172:             }",
          "175:             $user->setTxFemanagerConfirmedbyuser(true);",
          "176:             $this->userRepository->update($user);",
          "177:             $this->persistenceManager->persistAll();",
          "",
          "[Removed Lines]",
          "174:             $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./onUserConfirmation.',$this->config));",
          "",
          "[Added Lines]",
          "174:             $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./onUserConfirmation.', $this->config));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "232:                 $this->redirect('new');",
          "233:             }",
          "236:             $user->setTxFemanagerConfirmedbyadmin(true);",
          "237:             $user->setDisable(false);",
          "238:             $this->userRepository->update($user);",
          "",
          "[Removed Lines]",
          "235:             $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./onAdminConfirmation.',$this->config));",
          "",
          "[Added Lines]",
          "235:             $user = FrontendUtility::forceValues($user, ConfigurationUtility::getValue('new./forceValues./onAdminConfirmation.', $this->config));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "271:                     ['sender@femanager.org' => 'Sender Name'],",
          "272:                     'Your profile was refused',",
          "273:                     ['user' => $user],",
          "275:                 );",
          "276:             }",
          "277:             $this->userRepository->remove($user);",
          "",
          "[Removed Lines]",
          "274:                     ConfigurationUtility::getValue('new./email./createUserNotifyRefused.',$this->config)",
          "",
          "[Added Lines]",
          "274:                     ConfigurationUtility::getValue('new./email./createUserNotifyRefused.', $this->config)",
          "",
          "---------------"
        ],
        "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
          "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "364:     protected function validateInList($value, $validationSettingList)",
          "365:     {",
          "366:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
          "368:     }",
          "",
          "[Removed Lines]",
          "367:         return in_array($value, $validationSettings);",
          "",
          "[Added Lines]",
          "366:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
          "368:         $diff = array_diff($valueList, $validationSettings);",
          "370:         return empty($diff);",
          "",
          "---------------"
        ],
        "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php": [
          "File: Classes/Domain/Validator/ServersideValidator.php -> Classes/Domain/Validator/ServersideValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "9: use TYPO3\\CMS\\Extbase\\Domain\\Model\\FileReference;",
          "10: use TYPO3\\CMS\\Extbase\\Reflection\\ObjectAccess;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "306:     protected function getValue($user, $fieldName)",
          "307:     {",
          "308:         $value = $this->getValueFromProperty($user, $fieldName);",
          "309:         if (is_object($value)) {",
          "310:             if (method_exists($value, 'getUid')) {",
          "311:                 $value = $value->getUid();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "311:         if ($value instanceof ObjectStorage) {",
          "312:             $values = [];",
          "314:             foreach ($value as $object) {",
          "315:                 if (method_exists($object, 'getUid')) {",
          "316:                     $values[] = $object->getUid();",
          "317:                 }",
          "318:             }",
          "320:             return implode(',', $values);",
          "321:         }",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "732:                 'a',",
          "733:                 true",
          "734:             ],",
          "735:             [",
          "736:                 '23',",
          "737:                 '1,234,3',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "735:             [",
          "736:                 '1,2',",
          "737:                 '1,2,3',",
          "738:                 true",
          "739:             ],",
          "740:             [",
          "741:                 '1,2',",
          "742:                 '3,2,1',",
          "743:                 true",
          "744:             ],",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "752:                 'bac',",
          "753:                 false",
          "754:             ],",
          "755:         ];",
          "756:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "765:             [",
          "766:                 '1,2,3',",
          "767:                 '1,2',",
          "768:                 false",
          "769:             ],",
          "770:             [",
          "771:                 '1,2,3',",
          "772:                 '2,1',",
          "773:                 false",
          "774:             ]",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "14: class ServersideValidatorTest extends UnitTestCase",
          "15: {",
          "19:     protected $generalValidatorMock;",
          "24:     public function setUp(): void",
          "25:     {",
          "26:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
          "27:     }",
          "32:     public function tearDown(): void",
          "33:     {",
          "34:         unset($this->generalValidatorMock);",
          "35:     }",
          "40:     public function testGetValueForObjectStorage(): void",
          "41:     {",
          "42:         $user = new User();",
          "44:         $usergroup1 = $this->getUserGroupMock(1);",
          "45:         $usergroup2 = $this->getUserGroupMock(2);",
          "47:         $user->addUsergroup($usergroup1);",
          "48:         $user->addUsergroup($usergroup2);",
          "50:         $fieldName = 'usergroup';",
          "52:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "54:         self::assertSame('1,2', $result);",
          "55:     }",
          "60:     public function testGetValueForObject(): void",
          "61:     {",
          "62:         $user = new User('testuser');",
          "64:         $fieldName = 'username';",
          "66:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "68:         self::assertSame('testuser', $result);",
          "69:     }",
          "75:     protected function getUserGroupMock(int $uid = 1)",
          "76:     {",
          "77:         $mockClass = $this->getMockBuilder(UserGroup::class)",
          "78:             ->disableOriginalConstructor()",
          "79:             ->getMock();",
          "81:         $mockClass->method('getUid')->willReturn($uid);",
          "83:         return $mockClass;",
          "84:     }",
          "85: }",
          "",
          "---------------"
        ]
      }
    }
  ]
}