{
  "cve_id": "CVE-2012-2094",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the refresh mechanism in the log viewer in horizon/static/horizon/js/horizon.js in OpenStack Dashboard (Horizon) folsom-1 and 2012.1 and earlier allows remote attackers to inject arbitrary web script or HTML via the guest console.",
  "repo": "openstack/horizon",
  "patch_hash": "7f8c788aa70db98ac904f37fa4197fcabb802942",
  "patch_info": {
    "commit_hash": "7f8c788aa70db98ac904f37fa4197fcabb802942",
    "repo": "openstack/horizon",
    "commit_url": "https://github.com/openstack/horizon/commit/7f8c788aa70db98ac904f37fa4197fcabb802942",
    "files": [
      "horizon/static/horizon/js/horizon.js"
    ],
    "message": "html escape the console log in refresh\n\nfixes bug 977944\n\n(cherry picked from commit ab2e27522aaeb0268fcc121bd3eff5a4485f313c)\n\nChange-Id: Ic6135ebc58b6c45d6336f0833717086e43d7cccb",
    "before_after_code_files": [
      "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
    ]
  },
  "patch_diff": {
    "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js": [
      "File: horizon/static/horizon/js/horizon.js -> horizon/static/horizon/js/horizon.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "284:         data: data,",
      "285:         method: 'get',",
      "286:         success: function(response_body) {",
      "288:         },",
      "289:         error: function(response) {",
      "290:           if(via_user_submit) {",
      "",
      "[Removed Lines]",
      "287:           $('pre.logs').html(response_body);",
      "",
      "[Added Lines]",
      "287:           $('pre.logs').text(response_body);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ab2e27522aaeb0268fcc121bd3eff5a4485f313c",
      "candidate_info": {
        "commit_hash": "ab2e27522aaeb0268fcc121bd3eff5a4485f313c",
        "repo": "openstack/horizon",
        "commit_url": "https://github.com/openstack/horizon/commit/ab2e27522aaeb0268fcc121bd3eff5a4485f313c",
        "files": [
          "horizon/static/horizon/js/horizon.js"
        ],
        "message": "html escape the console log in refresh\n\nfixes bug 977944\n\nChange-Id: I89089155d1083332d02ae9039898227cbab42d07",
        "before_after_code_files": [
          "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
          ],
          "candidate": [
            "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
          ]
        }
      },
      "candidate_diff": {
        "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js": [
          "File: horizon/static/horizon/js/horizon.js -> horizon/static/horizon/js/horizon.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "284:         data: data,",
          "285:         method: 'get',",
          "286:         success: function(response_body) {",
          "288:         },",
          "289:         error: function(response) {",
          "290:           if(via_user_submit) {",
          "",
          "[Removed Lines]",
          "287:           $('pre.logs').html(response_body);",
          "",
          "[Added Lines]",
          "287:           $('pre.logs').text(response_body);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7f8c788aa70db98ac904f37fa4197fcabb802942",
      "candidate_info": {
        "commit_hash": "7f8c788aa70db98ac904f37fa4197fcabb802942",
        "repo": "openstack/horizon",
        "commit_url": "https://github.com/openstack/horizon/commit/7f8c788aa70db98ac904f37fa4197fcabb802942",
        "files": [
          "horizon/static/horizon/js/horizon.js"
        ],
        "message": "html escape the console log in refresh\n\nfixes bug 977944\n\n(cherry picked from commit ab2e27522aaeb0268fcc121bd3eff5a4485f313c)\n\nChange-Id: Ic6135ebc58b6c45d6336f0833717086e43d7cccb",
        "before_after_code_files": [
          "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
          ],
          "candidate": [
            "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js"
          ]
        }
      },
      "candidate_diff": {
        "horizon/static/horizon/js/horizon.js||horizon/static/horizon/js/horizon.js": [
          "File: horizon/static/horizon/js/horizon.js -> horizon/static/horizon/js/horizon.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "284:         data: data,",
          "285:         method: 'get',",
          "286:         success: function(response_body) {",
          "288:         },",
          "289:         error: function(response) {",
          "290:           if(via_user_submit) {",
          "",
          "[Removed Lines]",
          "287:           $('pre.logs').html(response_body);",
          "",
          "[Added Lines]",
          "287:           $('pre.logs').text(response_body);",
          "",
          "---------------"
        ]
      }
    }
  ]
}