{
  "cve_id": "CVE-2022-41711",
  "cve_desc": "Badaso version 2.6.0 allows an unauthenticated remote attacker to execute arbitrary code remotely on the server. This is possible because the application does not properly validate the data uploaded by users.",
  "repo": "uasoft-indonesia/badaso",
  "patch_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
  "patch_info": {
    "commit_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
    "repo": "uasoft-indonesia/badaso",
    "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/22250eca7c364d991ce9e0a723941eae4889d6f9",
    "files": [
      "src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue"
    ],
    "message": "Merge pull request #807 from uasoft-indonesia/bugfix/v2/filter-mimeType\n\nBugfix[v2] add filter mimeType",
    "before_after_code_files": [
      "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue"
    ]
  },
  "patch_diff": {
    "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue": [
      "File: src/resources/js/components/BadasoUploadFile.vue -> src/resources/js/components/BadasoUploadFile.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "336:           });",
      "337:           return;",
      "338:         }",
      "340:         this.uploadFile(files[0]);",
      "341:       }",
      "342:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "339:         if (!this.availableMimetypes.file.validMime.includes(files[0].type)) {",
      "340:           this.$vs.notify({",
      "341:             title: this.$t(\"alert.danger\"),",
      "342:             text: \"File type not allowed\",",
      "343:             color: \"danger\",",
      "344:           });",
      "345:           return;",
      "346:         }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadFileMultiple.vue -> src/resources/js/components/BadasoUploadFileMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             });",
      "368:             return;",
      "369:           }",
      "371:           this.uploadFile(file);",
      "372:         }",
      "373:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:           if (!this.availableMimetypes.file.validMime.includes(file.type)) {",
      "371:             this.$vs.notify({",
      "372:               title: this.$t(\"alert.danger\"),",
      "373:               text: \"File type not allowed\",",
      "374:               color: \"danger\",",
      "375:             });",
      "376:             return;",
      "377:           }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue": [
      "File: src/resources/js/components/BadasoUploadImage.vue -> src/resources/js/components/BadasoUploadImage.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "380:           });",
      "381:           return;",
      "382:         }",
      "384:         this.uploadImage(files[0]);",
      "385:       }",
      "386:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "383:         if (!this.availableMimetypes.image.validMime.includes(files[0].type)){",
      "384:           this.$vs.notify({",
      "385:             title: this.$t(\"alert.danger\"),",
      "386:             text: \"File type not allowed\",",
      "387:             color: \"danger\",",
      "388:           });",
      "389:           return;",
      "390:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:     uploadImage(file) {",
      "422:       const files = new FormData();",
      "423:       files.append(\"upload\", file);",
      "425:       files.append(\"working_dir\", this.getActiveFolder);",
      "426:       this.$api.badasoFile",
      "427:         .uploadUsingLfm(files)",
      "",
      "[Removed Lines]",
      "424:       files.append(\"type\", \"image\");",
      "",
      "[Added Lines]",
      "431:       files.append(\"type\", file.type);",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadImageMultiple.vue -> src/resources/js/components/BadasoUploadImageMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "395:             });",
      "396:             return;",
      "397:           }",
      "399:           this.uploadImage(file);",
      "400:         }",
      "401:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "398:           if (!this.availableMimetypes.image.validMime.includes(file.type)) {",
      "399:             this.$vs.notify({",
      "400:               title: this.$t(\"alert.danger\"),",
      "401:               text: \"File type not allowed\",",
      "402:               color: \"danger\",",
      "403:             });",
      "404:             return;",
      "405:           }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "00021f347f9da058c384e617624c22e3a6089540",
      "candidate_info": {
        "commit_hash": "00021f347f9da058c384e617624c22e3a6089540",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/00021f347f9da058c384e617624c22e3a6089540",
        "files": [
          "src/Controllers/BadasoMenuController.php"
        ],
        "message": "fix filter permission menu items",
        "before_after_code_files": [
          "src/Controllers/BadasoMenuController.php||src/Controllers/BadasoMenuController.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Controllers/BadasoMenuController.php||src/Controllers/BadasoMenuController.php": [
          "File: src/Controllers/BadasoMenuController.php -> src/Controllers/BadasoMenuController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "52:                         $menu_item_id = $request->menu_item_id;",
          "53:                         $menu_item = MenuItem::find($menu_item_id);",
          "56:                         $menu_item->is_expand = $is_expand;",
          "57:                         $menu_item->save();",
          "58:                         break;",
          "",
          "[Removed Lines]",
          "55:                         $is_expand = $request->get('is_expand', ! $menu_item->is_expand);",
          "",
          "[Added Lines]",
          "55:                         $is_expand = $request->get('is_expand', !$menu_item->is_expand);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "65:                         $menu_id = $request->menu_id;",
          "66:                         $menu = Menu::find($menu_id);",
          "69:                         $menu->is_expand = $is_expand;",
          "70:                         $menu->save();",
          "71:                         break;",
          "",
          "[Removed Lines]",
          "68:                         $is_expand = $request->get('is_expand', ! $menu->is_expand);",
          "",
          "[Added Lines]",
          "68:                         $is_expand = $request->get('is_expand', !$menu->is_expand);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "76:                 ]);",
          "78:                 $menu = Menu::find($request->menu_id);",
          "80:                 $menu->save();",
          "81:             }",
          "",
          "[Removed Lines]",
          "79:                 $menu->is_show_header = ! $menu->is_show_header;",
          "",
          "[Added Lines]",
          "79:                 $menu->is_show_header = !$menu->is_show_header;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "97:             $menu_items = MenuItem::where('menu_id', $request->menu_id)",
          "98:                 ->orderBy('order', 'asc')",
          "100:                 ->get();",
          "102:             $menu_items = $this->getChildMenuItems($menu_items);",
          "",
          "[Removed Lines]",
          "99:                 ->whereNull($prefix.'menu_items.parent_id')",
          "",
          "[Added Lines]",
          "99:                 ->whereNull($prefix . 'menu_items.parent_id')",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "152:             $prefix = config('badaso.database.prefix');",
          "153:             $menu = Menu::where('key', $request->menu_key)->first();",
          "160:                 ->get();",
          "161:             $menu_items = [];",
          "162:             foreach ($all_menu_items as $menu_item) {",
          "",
          "[Removed Lines]",
          "155:             $all_menu_items = MenuItem::join($prefix.'menus', $prefix.'menus.id', $prefix.'menu_items.menu_id')",
          "156:                 ->where($prefix.'menus.key', $request->menu_key)",
          "157:                 ->whereNull($prefix.'menu_items.parent_id')",
          "158:                 ->select($prefix.'menu_items.*')",
          "159:                 ->orderBy($prefix.'menu_items.order', 'asc')",
          "",
          "[Added Lines]",
          "155:             $all_menu_items = MenuItem::join($prefix . 'menus', $prefix . 'menus.id', $prefix . 'menu_items.menu_id')",
          "156:                 ->where($prefix . 'menus.key', $request->menu_key)",
          "157:                 ->whereNull($prefix . 'menu_items.parent_id')",
          "158:                 ->select($prefix . 'menu_items.*')",
          "159:                 ->orderBy($prefix . 'menu_items.order', 'asc')",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "188:                 foreach ($menu_keys as $key => $menu_key) {",
          "189:                     $menu = Menu::where('key', $menu_key)->first();",
          "196:                         ->get();",
          "197:                     $menu_items = [];",
          "198:                     foreach ($all_menu_items as $menu_item) {",
          "",
          "[Removed Lines]",
          "191:                     $all_menu_items = MenuItem::join($prefix.'menus', $prefix.'menus.id', $prefix.'menu_items.menu_id')",
          "192:                         ->where($prefix.'menus.key', $menu_key)",
          "193:                         ->whereNull($prefix.'menu_items.parent_id')",
          "194:                         ->select($prefix.'menu_items.*')",
          "195:                         ->orderBy($prefix.'menu_items.order', 'asc')",
          "",
          "[Added Lines]",
          "191:                     $all_menu_items = MenuItem::join($prefix . 'menus', $prefix . 'menus.id', $prefix . 'menu_items.menu_id')",
          "192:                         ->where($prefix . 'menus.key', $menu_key)",
          "193:                         ->whereNull($prefix . 'menu_items.parent_id')",
          "194:                         ->select($prefix . 'menu_items.*')",
          "195:                         ->orderBy($prefix . 'menu_items.order', 'asc')",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "209:                 $data = collect($data)->toArray();",
          "210:             } else {",
          "212:                     ->get();",
          "213:                 $menus = Menu::orderBy('order')->get();",
          "",
          "[Removed Lines]",
          "211:                 $all_menu_items = MenuItem::orderBy($prefix.'menu_items.order', 'asc')",
          "",
          "[Added Lines]",
          "211:                 $all_menu_items = MenuItem::orderBy($prefix . 'menu_items.order', 'asc')",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "225:                         }",
          "227:                         return $item;",
          "228:                     });",
          "229:                 };",
          "230:                 foreach ($menus as $index => $menu) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "228:                     })->filter(function ($menu_item) {",
          "229:                         $allowed = AuthenticatedUser::isAllowedTo($menu_item->permissions);",
          "230:                         return $allowed;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "312:             $url = $request->get('url');",
          "313:             if (filter_var($url, FILTER_VALIDATE_URL) === false) {",
          "315:             }",
          "317:             $new_menu_item = new MenuItem();",
          "",
          "[Removed Lines]",
          "314:                 $url = substr($request->get('url'), 0, 1) != '/' ? '/'.$request->get('url') : $request->get('url');",
          "",
          "[Added Lines]",
          "317:                 $url = substr($request->get('url'), 0, 1) != '/' ? '/' . $request->get('url') : $request->get('url');",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "378:             $url = $request->get('url');",
          "379:             if (filter_var($url, FILTER_VALIDATE_URL) === false) {",
          "381:             }",
          "383:             $menu_item = MenuItem::find($request->menu_item_id);",
          "",
          "[Removed Lines]",
          "380:                 $url = substr($request->get('url'), 0, 1) != '/' ? '/'.$request->get('url') : $request->get('url');",
          "",
          "[Added Lines]",
          "383:                 $url = substr($request->get('url'), 0, 1) != '/' ? '/' . $request->get('url') : $request->get('url');",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6e17cc1f9554797c1620374fba6080f57dfc3f50",
      "candidate_info": {
        "commit_hash": "6e17cc1f9554797c1620374fba6080f57dfc3f50",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/6e17cc1f9554797c1620374fba6080f57dfc3f50",
        "files": [
          "src/Config/badaso.php"
        ],
        "message": "update config for maintenance",
        "before_after_code_files": [
          "src/Config/badaso.php||src/Config/badaso.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Config/badaso.php||src/Config/badaso.php": [
          "File: src/Config/badaso.php -> src/Config/badaso.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:     'default_menu' => env('MIX_DEFAULT_MENU', 'general'),",
          "7:     'api_route_prefix' => env('MIX_API_ROUTE_PREFIX', 'badaso-api'),",
          "8:     'secret_login_prefix' => env('MIX_BADASO_SECRET_LOGIN_PREFIX'),",
          "9:     'license_key' => env('BADASO_LICENSE_KEY'),",
          "10:     'database' => [",
          "11:         'prefix' => env('BADASO_TABLE_PREFIX', 'badaso_'),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9:     'badaso_maintenance' => env('MIX_BADASO_MAINTENANCE'),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a9808cd6edc7a535a6948d56a99ba17f25fc8404",
      "candidate_info": {
        "commit_hash": "a9808cd6edc7a535a6948d56a99ba17f25fc8404",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/a9808cd6edc7a535a6948d56a99ba17f25fc8404",
        "files": [
          "composer.json",
          "src/Commands/BadasoSetup.php",
          "src/Config/lfm.php",
          "src/Controllers/BadasoConfigurationsController.php",
          "src/Controllers/BadasoMaintenanceController.php",
          "src/Helpers/Redis/ConfigurationRedis.php",
          "src/Models/Configuration.php",
          "src/resources/js/app.js",
          "src/resources/js/router/router.js"
        ],
        "message": "maintenance mode to get data from redis",
        "before_after_code_files": [
          "src/Commands/BadasoSetup.php||src/Commands/BadasoSetup.php",
          "src/Config/lfm.php||src/Config/lfm.php",
          "src/Controllers/BadasoConfigurationsController.php||src/Controllers/BadasoConfigurationsController.php",
          "src/Controllers/BadasoMaintenanceController.php||src/Controllers/BadasoMaintenanceController.php",
          "src/Helpers/Redis/ConfigurationRedis.php||src/Helpers/Redis/ConfigurationRedis.php",
          "src/Models/Configuration.php||src/Models/Configuration.php",
          "src/resources/js/app.js||src/resources/js/app.js",
          "src/resources/js/router/router.js||src/resources/js/router/router.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Commands/BadasoSetup.php||src/Commands/BadasoSetup.php": [
          "File: src/Commands/BadasoSetup.php -> src/Commands/BadasoSetup.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "288:             'MIX_API_DOCUMENTATION_ROUTE' => 'api-docs',",
          "289:             'BADASO_TABLE_PREFIX' => 'badaso_',",
          "290:             'OCTANE_SERVER' => 'roadrunner',",
          "291:         ];",
          "292:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "291:             'REDIS_CLIENT' => 'predis',",
          "",
          "---------------"
        ],
        "src/Config/lfm.php||src/Config/lfm.php": [
          "File: src/Config/lfm.php -> src/Config/lfm.php"
        ],
        "src/Controllers/BadasoConfigurationsController.php||src/Controllers/BadasoConfigurationsController.php": [
          "File: src/Controllers/BadasoConfigurationsController.php -> src/Controllers/BadasoConfigurationsController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: use Illuminate\\Support\\Str;",
          "11: use Uasoft\\Badaso\\Exceptions\\SingleException;",
          "12: use Uasoft\\Badaso\\Helpers\\ApiResponse;",
          "13: use Uasoft\\Badaso\\Models\\Configuration;",
          "14: use Uasoft\\Badaso\\Traits\\FileHandler;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13: use Uasoft\\Badaso\\Helpers\\Redis\\ConfigurationRedis;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "173:                 }",
          "174:             }",
          "176:             DB::commit();",
          "178:             return ApiResponse::success();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "179:             ConfigurationRedis::save();",
          "181:             ConfigurationRedis::get();",
          "",
          "---------------"
        ],
        "src/Controllers/BadasoMaintenanceController.php||src/Controllers/BadasoMaintenanceController.php": [
          "File: src/Controllers/BadasoMaintenanceController.php -> src/Controllers/BadasoMaintenanceController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: use Illuminate\\Contracts\\Foundation\\Application;",
          "7: use Illuminate\\Http\\Request;",
          "8: use Uasoft\\Badaso\\Helpers\\ApiResponse;",
          "9: use Uasoft\\Badaso\\Models\\Configuration;",
          "11: class BadasoMaintenanceController extends Controller",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9: use Uasoft\\Badaso\\Helpers\\Redis\\ConfigurationRedis;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "82:     private function isUnderMaintenance()",
          "83:     {",
          "86:         return $maintenance->value === '1' ? true : false;",
          "87:     }",
          "",
          "[Removed Lines]",
          "84:         $maintenance = Configuration::where('key', 'maintenance')->firstOrFail();",
          "",
          "[Added Lines]",
          "85:         $configuration_model = ConfigurationRedis::get();",
          "86:         $maintenance = $configuration_model->where('key', 'maintenance')->firstOrFail();",
          "",
          "---------------"
        ],
        "src/Helpers/Redis/ConfigurationRedis.php||src/Helpers/Redis/ConfigurationRedis.php": [
          "File: src/Helpers/Redis/ConfigurationRedis.php -> src/Helpers/Redis/ConfigurationRedis.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace Uasoft\\Badaso\\Helpers\\Redis;",
          "5: use Illuminate\\Support\\Facades\\Redis;",
          "6: use Uasoft\\Badaso\\Models\\Configuration;",
          "8: class ConfigurationRedis",
          "9: {",
          "11:     public static $badaso_configuration_redis_key = 'badaso_configuration_redis_key';",
          "14:     public static function save()",
          "15:     {",
          "16:         $model_configurations = Configuration::all();",
          "17:         try {",
          "18:             Redis::set(self::$badaso_configuration_redis_key, serialize($model_configurations));",
          "19:         } catch (\\Exception $th) {",
          "21:         }",
          "22:     }",
          "25:     public static function get()",
          "26:     {",
          "27:         $result = [];",
          "28:         try {",
          "29:             $configuration_from_redis = Redis::get(self::$badaso_configuration_redis_key);",
          "30:             $result = unserialize($configuration_from_redis);",
          "31:         } catch (\\Exception $th) {",
          "32:             $result = Configuration::all();",
          "33:         }",
          "35:         return $result;",
          "36:     }",
          "37: }",
          "",
          "---------------"
        ],
        "src/Models/Configuration.php||src/Models/Configuration.php": [
          "File: src/Models/Configuration.php -> src/Models/Configuration.php"
        ],
        "src/resources/js/app.js||src/resources/js/app.js": [
          "File: src/resources/js/app.js -> src/resources/js/app.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "251:   : \"badaso-dashboard\";",
          "252: Vue.prototype.$baseUrl = \"/\" + baseUrl;",
          "255:   try {",
          "256:     this.$root.$children[0].openLoader(payload);",
          "257:   } catch (error) {",
          "",
          "[Removed Lines]",
          "254: Vue.prototype.$openLoader = function(payload) {",
          "",
          "[Added Lines]",
          "254: Vue.prototype.$openLoader = function (payload) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "259:   }",
          "260: };",
          "263:   try {",
          "264:     this.$root.$children[0].closeLoader();",
          "265:   } catch (error) {",
          "",
          "[Removed Lines]",
          "262: Vue.prototype.$closeLoader = function() {",
          "",
          "[Added Lines]",
          "262: Vue.prototype.$closeLoader = function () {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "267:   }",
          "268: };",
          "271:   try {",
          "272:     this.$root.$children[0].syncLoader(statusSyncLoader);",
          "273:   } catch (error) {",
          "",
          "[Removed Lines]",
          "270: Vue.prototype.$syncLoader = function(statusSyncLoader) {",
          "",
          "[Added Lines]",
          "270: Vue.prototype.$syncLoader = function (statusSyncLoader) {",
          "",
          "---------------"
        ],
        "src/resources/js/router/router.js||src/resources/js/router/router.js": [
          "File: src/resources/js/router/router.js -> src/resources/js/router/router.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: import PageNotFound from \"./../pages/error/PageNotFound.vue\";",
          "9: import Maintenance from \"./../pages/maintenance.vue\";",
          "13: const prefix = process.env.MIX_ADMIN_PANEL_ROUTE_PREFIX",
          "14:   ? \"/\" + process.env.MIX_ADMIN_PANEL_ROUTE_PREFIX",
          "",
          "[Removed Lines]",
          "11: import api from '../api/index'",
          "",
          "[Added Lines]",
          "11: import api from \"../api/index\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "54:   if (pluginsEnv) {",
          "56:     if (plugins && plugins.length > 0) {",
          "59:         let plugin = plugins[index];",
          "60:         let routes = require(\"../../../../../\" +",
          "61:           plugin +",
          "",
          "[Removed Lines]",
          "55:     const plugins = process.env.MIX_BADASO_MODULES.split(',');",
          "58:       for(let index in plugins){",
          "",
          "[Added Lines]",
          "55:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "57:       for (let index in plugins) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "78:               break;",
          "79:           }",
          "80:         });",
          "86:       }",
          "88:     }",
          "89:   }",
          "90: } catch (error) {",
          "",
          "[Removed Lines]",
          "82:         _pluginRouters[\"AdminContainer\"] = [..._pluginRouters[\"AdminContainer\"], ...adminRouters];",
          "83:         _pluginRouters[\"AuthContainer\"] = [..._pluginRouters[\"AuthContainer\"], ...authRouters];",
          "84:         _pluginRouters[\"LandingPageContainer\"] = [..._pluginRouters[\"LandingPageContainer\"], ...landingPageRouters];",
          "",
          "[Added Lines]",
          "81:         _pluginRouters[\"AdminContainer\"] = [",
          "82:           ..._pluginRouters[\"AdminContainer\"],",
          "83:           ...adminRouters,",
          "84:         ];",
          "85:         _pluginRouters[\"AuthContainer\"] = [",
          "86:           ..._pluginRouters[\"AuthContainer\"],",
          "87:           ...authRouters,",
          "88:         ];",
          "89:         _pluginRouters[\"LandingPageContainer\"] = [",
          "90:           ..._pluginRouters[\"LandingPageContainer\"],",
          "91:           ...landingPageRouters,",
          "92:         ];",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "144:       meta: {",
          "145:         guest: true,",
          "146:       },",
          "151:     },",
          "152:     {",
          "153:       path: \"\",",
          "",
          "[Removed Lines]",
          "147:       children: [",
          "148:         ..._authRouters,",
          "149:         ..._pluginRouters['AuthContainer']",
          "150:       ],",
          "",
          "[Added Lines]",
          "153:       children: [..._authRouters, ..._pluginRouters[\"AuthContainer\"]],",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "156:       meta: {",
          "157:         guest: true,",
          "158:       },",
          "163:     },",
          "164:     {",
          "165:       path: \"\",",
          "",
          "[Removed Lines]",
          "159:       children: [",
          "160:         ..._publicRouters,",
          "161:         ..._pluginRouters['LandingPageContainer']",
          "162:       ],",
          "",
          "[Added Lines]",
          "162:       children: [..._publicRouters, ..._pluginRouters[\"LandingPageContainer\"]],",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "168:       meta: {",
          "169:         authenticatedUser: true,",
          "170:       },",
          "175:     },",
          "176:     ..._otherRouters,",
          "177:     {",
          "",
          "[Removed Lines]",
          "171:       children: [",
          "172:         ..._adminRouters,",
          "173:         ..._pluginRouters['AdminContainer']",
          "174:       ],",
          "",
          "[Added Lines]",
          "171:       children: [..._adminRouters, ..._pluginRouters[\"AdminContainer\"]],",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "204: router.beforeEach((to, from, next) => {",
          "205:   document.title = to.meta.title ? to.meta.title : to.name;",
          "206:   if (to.matched.some((record) => record.name !== \"Maintenance\")) {",
          "228:         }",
          "229:       }",
          "231:   } else {",
          "232:     next();",
          "233:   }",
          "",
          "[Removed Lines]",
          "207:     api.badasoMaintenance.maintenance({",
          "208:       path: to.path",
          "209:     })",
          "210:     .then((res) => {",
          "211:       if (res.data.maintenance) {",
          "212:         next({ name: \"Maintenance\" });",
          "213:       } else {",
          "214:         if (to.matched.some((record) => record.meta.authenticatedUser)) {",
          "215:           if (localStorage.getItem(\"token\") == null) {",
          "216:             next({ name: \"AuthLogin\" });",
          "217:           } else {",
          "218:             next();",
          "219:           }",
          "220:         } else if (to.matched.some((record) => record.meta.guest)) {",
          "221:           if (localStorage.getItem(\"token\") == null) {",
          "222:             next();",
          "223:           } else {",
          "224:             next({ name: \"Home\" });",
          "225:           }",
          "226:         } else {",
          "227:           next();",
          "230:     }).catch((err) => {});",
          "",
          "[Added Lines]",
          "204:     api.badasoMaintenance",
          "205:       .maintenance({",
          "206:         path: to.path,",
          "207:       })",
          "208:       .then((res) => {",
          "209:         if (res.data.maintenance) {",
          "210:           next({ name: \"Maintenance\" });",
          "212:       })",
          "213:       .catch((err) => {});",
          "215:     if (to.matched.some((record) => record.meta.authenticatedUser)) {",
          "216:       if (localStorage.getItem(\"token\") == null) {",
          "217:         next({ name: \"AuthLogin\" });",
          "218:       } else {",
          "219:         next();",
          "220:       }",
          "221:     } else if (to.matched.some((record) => record.meta.guest)) {",
          "222:       if (localStorage.getItem(\"token\") == null) {",
          "223:         next();",
          "224:       } else {",
          "225:         next({ name: \"Home\" });",
          "227:     } else {",
          "228:       next();",
          "229:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "eb2c9fcab855b12b68cedabb0aaee94d8209fac6",
      "candidate_info": {
        "commit_hash": "eb2c9fcab855b12b68cedabb0aaee94d8209fac6",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/eb2c9fcab855b12b68cedabb0aaee94d8209fac6",
        "files": [
          "src/Controllers/BadasoMenuController.php",
          "src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "src/resources/js/pages/file-manager/browse.vue",
          "src/resources/js/pages/image-manager/browse.vue",
          "src/resources/js/pages/index.vue",
          "src/resources/js/router/admin/configuration-router.js",
          "src/resources/js/store/modules/badaso.js"
        ],
        "message": "update file manager",
        "before_after_code_files": [
          "src/Controllers/BadasoMenuController.php||src/Controllers/BadasoMenuController.php",
          "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "src/resources/js/pages/file-manager/browse.vue||src/resources/js/pages/file-manager/browse.vue",
          "src/resources/js/pages/image-manager/browse.vue||src/resources/js/pages/image-manager/browse.vue",
          "src/resources/js/pages/index.vue||src/resources/js/pages/index.vue",
          "src/resources/js/router/admin/configuration-router.js||src/resources/js/router/admin/configuration-router.js",
          "src/resources/js/store/modules/badaso.js||src/resources/js/store/modules/badaso.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Controllers/BadasoMenuController.php||src/Controllers/BadasoMenuController.php": [
          "File: src/Controllers/BadasoMenuController.php -> src/Controllers/BadasoMenuController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "193:                 $data = [];",
          "194:                 foreach ($menus as $index => $menu) {",
          "196:                         ->where('menu_id', $menu->id)->map(function ($item) use ($all_menu_items) {",
          "197:                             $children = array_values($all_menu_items->where('parent_id', $item->id)->toArray());",
          "",
          "[Removed Lines]",
          "195:                     $menu_items = $all_menu_items->whereNull($prefix.'menu_items.parent_id')",
          "",
          "[Added Lines]",
          "195:                     $menu_items = $all_menu_items",
          "196:                         ->where(\"parent_id\", null)",
          "",
          "---------------"
        ],
        "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php": [
          "File: src/Seeder/Configurations/FixedMenuItemSeeder.php -> src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Database\\Seeders\\Badaso;",
          "6: use Uasoft\\Badaso\\Models\\Menu;",
          "7: use Uasoft\\Badaso\\Models\\MenuItem;",
          "9: class FixedMenuItemSeeder extends Seeder",
          "",
          "[Removed Lines]",
          "5: use Illuminate\\Database\\Seeder;",
          "",
          "[Added Lines]",
          "6: use Illuminate\\Database\\Seeder;",
          "7: use Illuminate\\Support\\Facades\\DB;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "135:                 9 => [",
          "136:                     'id' => 10,",
          "137:                     'menu_id' => $menu_core,",
          "140:                     'target' => '_self',",
          "142:                     'color' => '',",
          "143:                     'parent_id' => null,",
          "146:                 ],",
          "147:                 10 => [",
          "148:                     'id' => 11,",
          "149:                     'menu_id' => $menu_core,",
          "152:                     'target' => '_self',",
          "154:                     'color' => '',",
          "155:                     'parent_id' => null,",
          "158:                 ],",
          "161:                 11 => [",
          "162:                     'id' => 12,",
          "163:                     'menu_id' => $menu_general,",
          "164:                     'title' => 'Dashboard',",
          "165:                     'url' => '/home',",
          "",
          "[Removed Lines]",
          "138:                     'title' => 'File Manager',",
          "139:                     'url' => '/file-manager',",
          "141:                     'icon_class' => 'perm_media',",
          "144:                     'order' => 8,",
          "145:                     'permissions' => 'browse_file_manager',",
          "150:                     'title' => 'API Documentation',",
          "151:                     'url' => '/api-docs',",
          "153:                     'icon_class' => 'menu_book',",
          "156:                     'order' => 9,",
          "157:                     'permissions' => 'browse_apidocs',",
          "",
          "[Added Lines]",
          "139:                     'title' => 'API Documentation',",
          "140:                     'url' => '/api-docs',",
          "142:                     'icon_class' => 'menu_book',",
          "145:                     'order' => 9,",
          "146:                     'permissions' => 'browse_apidocs',",
          "153:                     'title' => 'Media Manager',",
          "154:                     'url' => '#',",
          "156:                     'icon_class' => '',",
          "159:                     'order' => 10,",
          "160:                     'permissions' => '',",
          "164:                     'menu_id' => $menu_core,",
          "165:                     'title' => 'Files',",
          "166:                     'url' => '/file-manager',",
          "167:                     'target' => '_self',",
          "168:                     'icon_class' => 'folder',",
          "169:                     'color' => '',",
          "170:                     'parent_id' => 11,",
          "171:                     'order' => 1,",
          "172:                     'permissions' => 'browse_file_manager',",
          "173:                 ],",
          "174:                 12 => [",
          "175:                     'id' => 13,",
          "176:                     'menu_id' => $menu_core,",
          "177:                     'title' => 'Images',",
          "178:                     'url' => '/image-manager',",
          "179:                     'target' => '_self',",
          "180:                     'icon_class' => 'perm_media',",
          "181:                     'color' => '',",
          "182:                     'parent_id' => 11,",
          "183:                     'order' => 2,",
          "184:                     'permissions' => 'browse_file_manager',",
          "185:                 ],",
          "188:                 13 => [",
          "189:                     'id' => 14,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "182:                     continue;",
          "183:                 }",
          "186:             }",
          "189:             \\DB::rollBack();",
          "190:         }",
          "",
          "[Removed Lines]",
          "185:                 MenuItem::create($value);",
          "187:         } catch (Exception $e) {",
          "188:             throw new Exception('Exception occur '.$e);",
          "",
          "[Added Lines]",
          "212:                 $menu_item = MenuItem::find($value['id']);",
          "213:                 if (isset($menu_item)) {",
          "214:                     $menu_item->update($value);",
          "215:                 } else {",
          "216:                     $menu_item = MenuItem::create($value);",
          "217:                 }",
          "219:         } catch (\\Exception $e) {",
          "220:             throw new \\Exception('Exception occur ' . $e);",
          "",
          "---------------"
        ],
        "src/resources/js/pages/file-manager/browse.vue||src/resources/js/pages/file-manager/browse.vue": [
          "File: src/resources/js/pages/file-manager/browse.vue -> src/resources/js/pages/file-manager/browse.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:     urlFileManager() {",
          "77:       let host = window.location.origin;",
          "78:       let token = localStorage.getItem(\"token\");",
          "80:       return url;",
          "81:     },",
          "82:   },",
          "",
          "[Removed Lines]",
          "79:       let url = `${host}/filemanager?token=${token}`;",
          "",
          "[Added Lines]",
          "79:       let url = `${host}/filemanager?type=Files&token=${token}`;",
          "",
          "---------------"
        ],
        "src/resources/js/pages/image-manager/browse.vue||src/resources/js/pages/image-manager/browse.vue": [
          "File: src/resources/js/pages/image-manager/browse.vue -> src/resources/js/pages/image-manager/browse.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <template>",
          "2:   <div>",
          "3:     <badaso-breadcrumb-row>",
          "4:       <template slot=\"action\"> </template>",
          "5:     </badaso-breadcrumb-row>",
          "6:     <vs-row v-if=\"$helper.isAllowed('browse_file_manager')\">",
          "7:       <vs-col vs-lg=\"12\">",
          "8:         <vs-card>",
          "9:           <div slot=\"header\">",
          "10:             <h3>{{ $t(\"fileManager.title\") }}</h3>",
          "11:           </div>",
          "12:           <iframe",
          "13:             v-if=\"isShow\"",
          "14:             :src=\"urlIframe\"",
          "15:             class=\"file-manager__iframe\"",
          "16:           />",
          "17:           <div v-else>",
          "18:             {{ message }}",
          "19:           </div>",
          "20:         </vs-card>",
          "21:       </vs-col>",
          "22:     </vs-row>",
          "23:     <vs-row v-else>",
          "24:       <vs-col vs-lg=\"12\">",
          "25:         <vs-card>",
          "26:           <vs-row>",
          "27:             <vs-col vs-lg=\"12\">",
          "28:               <h3>{{ $t(\"fileManager.warning.notAllowedToBrowse\") }}</h3>",
          "29:             </vs-col>",
          "30:           </vs-row>",
          "31:         </vs-card>",
          "32:       </vs-col>",
          "33:     </vs-row>",
          "34:   </div>",
          "35: </template>",
          "36: <script>",
          "37: export default {",
          "38:   name: \"ImageManagerBrowse\",",
          "39:   components: {},",
          "40:   data() {",
          "41:     return {",
          "42:       statusCode: null,",
          "43:       message: null,",
          "44:       isShow: true,",
          "45:       urlIframe: null,",
          "46:     };",
          "47:   },",
          "48:   async created() {",
          "49:     await this.requestCheckPageIFrame();",
          "50:   },",
          "51:   methods: {",
          "52:     async requestCheckPageIFrame() {",
          "53:       this.$openLoader();",
          "55:       this.$resource",
          "56:         .get(this.urlFileManager)",
          "57:         .then((result) => {",
          "58:           this.urlIframe = this.urlFileManager;",
          "59:           this.isShow = true;",
          "60:         })",
          "61:         .catch((error) => {",
          "62:           let { message } = error;",
          "63:           this.$vs.notify({",
          "64:             title: this.$t(\"alert.danger\"),",
          "65:             text: message,",
          "66:             color: \"danger\",",
          "67:           });",
          "68:           this.isShow = false;",
          "69:         })",
          "70:         .finally(() => {",
          "71:           this.$closeLoader();",
          "72:         });",
          "73:     },",
          "74:   },",
          "75:   computed: {",
          "76:     urlFileManager() {",
          "77:       let host = window.location.origin;",
          "78:       let token = localStorage.getItem(\"token\");",
          "79:       let url = `${host}/filemanager?type=Images&token=${token}`;",
          "80:       return url;",
          "81:     },",
          "82:   },",
          "83: };",
          "84: </script>",
          "",
          "---------------"
        ],
        "src/resources/js/pages/index.vue||src/resources/js/pages/index.vue": [
          "File: src/resources/js/pages/index.vue -> src/resources/js/pages/index.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: import UserManagementAdd from \"./user-management/add\";",
          "54: import UserManagementRoles from \"./user-management/roles\";",
          "55: import FileManagerBrowse from \"./file-manager/browse\";",
          "56: import LogViewerBrowse from './log-viewer/browse';",
          "57: import NotificationBrowse from './notification/browse';",
          "58: import DataPendingAddBrowse from './data-pending-add/browse';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "56: import ImageManagerBrowse from \"./image-manager/browse\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "110:     DataPendingAddBrowse,",
          "111:     DataPendingEditRead,",
          "112:     ApiDocsBrowse,",
          "113:   },",
          "114:   name: \"ActivityLogIndex\",",
          "115:   data: () => ({",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "114:     ImageManagerBrowse,",
          "",
          "---------------"
        ],
        "src/resources/js/router/admin/configuration-router.js||src/resources/js/router/admin/configuration-router.js": [
          "File: src/resources/js/router/admin/configuration-router.js -> src/resources/js/router/admin/configuration-router.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "274:     name: \"FileManagerBrowse\",",
          "275:     component: Pages,",
          "276:     meta: {",
          "278:     },",
          "279:   },",
          "280:   {",
          "",
          "[Removed Lines]",
          "277:       title: \"File Manager\",",
          "",
          "[Added Lines]",
          "277:       title: \"Files\",",
          "278:     },",
          "279:   },",
          "280:   {",
          "281:     path: prefix + \"/image-manager\",",
          "282:     name: \"ImageManagerBrowse\",",
          "283:     component: Pages,",
          "284:     meta: {",
          "285:       title: \"Images\",",
          "",
          "---------------"
        ],
        "src/resources/js/store/modules/badaso.js||src/resources/js/store/modules/badaso.js": [
          "File: src/resources/js/store/modules/badaso.js -> src/resources/js/store/modules/badaso.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "54:           state.menu = data.map((menu) => {",
          "55:             menu.menuItems.map((menuItem) => {",
          "56:               menuItem.url = \"/\" + prefix + menuItem.url;",
          "57:               return menuItem;",
          "58:             });",
          "59:             return menu;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "57:               if (menuItem.children) {",
          "58:                 menuItem.children = menuItem.children.map((menuChildren) => {",
          "59:                   menuChildren.url = \"/\" + prefix + menuChildren.url;",
          "60:                   return menuChildren;",
          "61:                 });",
          "62:               }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9599f0d6d7f8aad0ab987db2618b3fec13994134",
      "candidate_info": {
        "commit_hash": "9599f0d6d7f8aad0ab987db2618b3fec13994134",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/9599f0d6d7f8aad0ab987db2618b3fec13994134",
        "files": [
          "tests/Feature/BadasoApiCrudManagementTest.php"
        ],
        "message": "commit",
        "before_after_code_files": [
          "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php": [
          "File: tests/Feature/BadasoApiCrudManagementTest.php -> tests/Feature/BadasoApiCrudManagementTest.php"
        ]
      }
    }
  ]
}