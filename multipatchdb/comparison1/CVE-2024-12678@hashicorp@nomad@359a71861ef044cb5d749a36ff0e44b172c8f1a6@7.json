{
  "cve_id": "CVE-2024-12678",
  "cve_desc": "Nomad Community and Nomad Enterprise (\"Nomad\") allocations are vulnerable to privilege escalation within a namespace through unredacted workload identity tokens. This vulnerability, identified as CVE-2024-12678, is fixed in Nomad Community Edition 1.9.4 and Nomad Enterprise 1.9.4, 1.8.8, and 1.7.16.",
  "repo": "hashicorp/nomad",
  "patch_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
  "patch_info": {
    "commit_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "repo": "hashicorp/nomad",
    "commit_url": "https://github.com/hashicorp/nomad/commit/359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "files": [
      ".changelog/24683.txt",
      "command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go",
      "nomad/structs/structs.go"
    ],
    "message": "Backport of sec: fix alloc workload identity namespace permission into release/1.9.x (#24685)\n\nCo-authored-by: Deniz Onur Duzgun <59659739+dduzgun-security@users.noreply.github.com>",
    "before_after_code_files": [
      "command/agent/node_endpoint.go||command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go",
      "nomad/structs/structs.go||nomad/structs/structs.go"
    ]
  },
  "patch_diff": {
    "command/agent/node_endpoint.go||command/agent/node_endpoint.go": [
      "File: command/agent/node_endpoint.go -> command/agent/node_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "105:   out.Allocs = make([]*structs.Allocation, 0)",
      "106:  }",
      "107:  for _, alloc := range out.Allocs {",
      "108:   alloc.SetEventDisplayMessages()",
      "109:  }",
      "110:  return out.Allocs, nil",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108:   alloc = alloc.Sanitize()",
      "",
      "---------------"
    ],
    "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go": [
      "File: nomad/alloc_endpoint.go -> nomad/alloc_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "172:    }",
      "176:    if out != nil {",
      "178:     if !aclObj.AllowClientOp() && !allowNsOp(aclObj, out.Namespace) {",
      "179:      return structs.NewErrUnknownAllocation(args.AllocID)",
      "",
      "[Removed Lines]",
      "175:    reply.Alloc = out",
      "",
      "[Added Lines]",
      "176:     out = out.Sanitize()",
      "177:     reply.Alloc = out",
      "",
      "---------------"
    ],
    "nomad/structs/structs.go||nomad/structs/structs.go": [
      "File: nomad/structs/structs.go -> nomad/structs/structs.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "11199:  return a.ID",
      "11200: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11205: func (a *Allocation) Sanitize() *Allocation {",
      "11206:  if a == nil {",
      "11207:   return nil",
      "11208:  }",
      "11210:  if a.SignedIdentities == nil {",
      "11211:   return a",
      "11212:  }",
      "11214:  clean := a.Copy()",
      "11215:  clean.SignedIdentities = nil",
      "11216:  return clean",
      "11217: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "eca6e3da72ac50afbc5c4dfbcf6235b40c9ae547",
      "candidate_info": {
        "commit_hash": "eca6e3da72ac50afbc5c4dfbcf6235b40c9ae547",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/eca6e3da72ac50afbc5c4dfbcf6235b40c9ae547",
        "files": [
          "tools/go.mod",
          "tools/go.sum"
        ],
        "message": "deps: Update tool dependencies (#25301)\n\nbackport of commit 17fcee561454126cd2dcf09b445a9df4cd0410d2\n\nCo-authored-by: James Rasell <jrasell@users.noreply.github.com>",
        "before_after_code_files": [
          "tools/go.mod||tools/go.mod",
          "tools/go.sum||tools/go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/go.mod||tools/go.mod": [
          "File: tools/go.mod -> tools/go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: go 1.23",
          "5: require (",
          "8: )",
          "",
          "[Removed Lines]",
          "6:  github.com/hashicorp/go-set/v3 v3.0.0-alpha.1",
          "7:  github.com/shoenig/test v1.8.2",
          "10: require github.com/google/go-cmp v0.6.0 // indirect",
          "",
          "[Added Lines]",
          "6:  github.com/hashicorp/go-set/v3 v3.0.0",
          "7:  github.com/shoenig/test v1.12.1",
          "10: require github.com/google/go-cmp v0.7.0 // indirect",
          "",
          "---------------"
        ],
        "tools/go.sum||tools/go.sum": [
          "File: tools/go.sum -> tools/go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: github.com/google/go-cmp v0.6.0 h1:ofyhxvXcZhMsU5ulbFiLKl/XBFqE1GSq7atu8tAmTRI=",
          "2: github.com/google/go-cmp v0.6.0/go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=",
          "3: github.com/hashicorp/go-set/v3 v3.0.0-alpha.1 h1:dPUtuqKJGgxtF7YO42oE+NdUONXi5nfLMKH2NpBffIM=",
          "4: github.com/hashicorp/go-set/v3 v3.0.0-alpha.1/go.mod h1:7bJRgsF3EL3AtRTzcKXdjAFbYGSef+1gHXhglGGO52k=",
          "5: github.com/shoenig/test v1.8.2 h1:WDlty8UBqJRdmgdJX8lMwvCq97tiN7Um/GZD2vBDuug=",
          "6: github.com/shoenig/test v1.8.2/go.mod h1:UxJ6u/x2v/TNs/LoLxBNJRV9DiwBBKYxXSyczsBHFoI=",
          "",
          "[Added Lines]",
          "1: github.com/google/go-cmp v0.7.0 h1:wk8382ETsv4JYUZwIsn6YpYiWiBsYLSJiTsyBybVuN8=",
          "2: github.com/google/go-cmp v0.7.0/go.mod h1:pXiqmnSA92OHEEa9HXL2W4E7lf9JzCmGVUdgjX3N/iU=",
          "3: github.com/hashicorp/go-set/v3 v3.0.0 h1:CaJBQvQCOWoftrBcDt7Nwgo0kdpmrKxar/x2o6pV9JA=",
          "4: github.com/hashicorp/go-set/v3 v3.0.0/go.mod h1:IEghM2MpE5IaNvL+D7X480dfNtxjRXZ6VMpK3C8s2ok=",
          "5: github.com/shoenig/test v1.12.1 h1:mLHfnMv7gmhhP44WrvT+nKSxKkPDiNkIuHGdIGI9RLU=",
          "6: github.com/shoenig/test v1.12.1/go.mod h1:UxJ6u/x2v/TNs/LoLxBNJRV9DiwBBKYxXSyczsBHFoI=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "22e7876e9a0713174448aeef5d704cedab958d5a",
      "candidate_info": {
        "commit_hash": "22e7876e9a0713174448aeef5d704cedab958d5a",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/22e7876e9a0713174448aeef5d704cedab958d5a",
        "files": [
          ".changelog/24494.txt",
          "drivers/shared/executor/procstats/list_test.go",
          "drivers/shared/executor/procstats/list_windows.go",
          "drivers/shared/executor/procstats/procstats.go"
        ],
        "message": "backport of commit dd396a3900cf78c6f79bb008ebdb3dd4766e8ce9 (#24520)\n\nCo-authored-by: Seth Hoenig <shoenig@duck.com>",
        "before_after_code_files": [
          "drivers/shared/executor/procstats/list_test.go||drivers/shared/executor/procstats/list_test.go",
          "drivers/shared/executor/procstats/list_windows.go||drivers/shared/executor/procstats/list_windows.go",
          "drivers/shared/executor/procstats/procstats.go||drivers/shared/executor/procstats/procstats.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "drivers/shared/executor/procstats/list_test.go||drivers/shared/executor/procstats/list_test.go": [
          "File: drivers/shared/executor/procstats/list_test.go -> drivers/shared/executor/procstats/list_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "63:   name     string",
          "64:   needles  int",
          "65:   haystack int",
          "67:  }{",
          "68:   {",
          "69:    name:     \"minimal\",",
          "70:    needles:  2,",
          "71:    haystack: 10,",
          "73:   },",
          "74:   {",
          "75:    name:     \"small needles small haystack\",",
          "76:    needles:  5,",
          "77:    haystack: 200,",
          "79:   },",
          "80:   {",
          "81:    name:     \"small needles large haystack\",",
          "82:    needles:  10,",
          "83:    haystack: 1000,",
          "85:   },",
          "86:   {",
          "87:    name:     \"moderate needles giant haystack\",",
          "88:    needles:  20,",
          "89:    haystack: 2000,",
          "91:   },",
          "92:  }",
          "",
          "[Removed Lines]",
          "66:   expect   int",
          "72:    expect:   16,",
          "78:    expect:   212,",
          "84:    expect:   1022,",
          "90:    expect:   2042,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "100:     return procs, nil",
          "101:    }",
          "104:    must.SliceContainsAll(t, expect, result.Slice(),",
          "105:     must.Sprintf(\"exp: %v; got: %v\", expect, result),",
          "106:    )",
          "108:   })",
          "109:  }",
          "110: }",
          "",
          "[Removed Lines]",
          "103:    result, examined := list(executorPID, lister)",
          "107:    must.Eq(t, tc.expect, examined)",
          "",
          "[Added Lines]",
          "98:    result := list(executorPID, lister)",
          "",
          "---------------"
        ],
        "drivers/shared/executor/procstats/list_windows.go||drivers/shared/executor/procstats/list_windows.go": [
          "File: drivers/shared/executor/procstats/list_windows.go -> drivers/shared/executor/procstats/list_windows.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: func List(executorPID int) set.Collection[ProcessID] {",
          "30:  return procs",
          "31: }",
          "",
          "[Removed Lines]",
          "29:  procs, _ := list(executorPID, ps.Processes)",
          "",
          "[Added Lines]",
          "29:  procs := list(executorPID, ps.Processes)",
          "",
          "---------------"
        ],
        "drivers/shared/executor/procstats/procstats.go||drivers/shared/executor/procstats/procstats.go": [
          "File: drivers/shared/executor/procstats/procstats.go -> drivers/shared/executor/procstats/procstats.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:  }",
          "83: }",
          "89:  if err != nil {",
          "91:  }",
          "109:  }",
          "127:    }",
          "128:   }",
          "129:  }",
          "132: }",
          "",
          "[Removed Lines]",
          "85: func list(executorPID int, processes func() ([]ps.Process, error)) (set.Collection[ProcessID], int) {",
          "86:  family := set.From([]int{executorPID})",
          "88:  all, err := processes()",
          "90:   return family, 0",
          "93:  parents, examined := mapping(all)",
          "94:  examined += gather(family, parents, executorPID)",
          "96:  return family, examined",
          "97: }",
          "99: func gather(family set.Collection[int], parents map[int]set.Collection[int], parent int) int {",
          "100:  examined := 0",
          "101:  candidates, ok := parents[parent]",
          "102:  if !ok {",
          "103:   return examined",
          "104:  }",
          "105:  for _, candidate := range candidates.Slice() {",
          "106:   examined++",
          "107:   family.Insert(candidate)",
          "108:   examined += gather(family, parents, candidate)",
          "111:  return examined",
          "112: }",
          "115: func mapping(all []ps.Process) (map[int]set.Collection[int], int) {",
          "117:  parents := map[int]set.Collection[int]{}",
          "118:  examined := 0",
          "120:  for _, candidate := range all {",
          "121:   if candidate != nil {",
          "122:    examined++",
          "123:    if children, ok := parents[candidate.PPid()]; ok {",
          "124:     children.Insert(candidate.Pid())",
          "125:    } else {",
          "126:     parents[candidate.PPid()] = set.From([]int{candidate.Pid()})",
          "131:  return parents, examined",
          "",
          "[Added Lines]",
          "85: func list(executorPID int, processes func() ([]ps.Process, error)) set.Collection[ProcessID] {",
          "86:  processFamily := set.From([]ProcessID{executorPID})",
          "88:  allPids, err := processes()",
          "90:   return processFamily",
          "95:  pidsRemaining := make(map[int]int, len(allPids))",
          "96:  for _, pid := range allPids {",
          "97:   pidsRemaining[pid.Pid()] = pid.PPid()",
          "100:  for {",
          "102:   foundNewPid := false",
          "104:   for pid, ppid := range pidsRemaining {",
          "105:    childPid := processFamily.Contains(ppid)",
          "108:    if childPid {",
          "109:     processFamily.Insert(pid)",
          "110:     delete(pidsRemaining, pid)",
          "111:     foundNewPid = true",
          "115:   if !foundNewPid {",
          "116:    break",
          "117:   }",
          "120:  return processFamily",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "32778714f263bbfa1e57c3d85c551b0f369796d9",
      "candidate_info": {
        "commit_hash": "32778714f263bbfa1e57c3d85c551b0f369796d9",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/32778714f263bbfa1e57c3d85c551b0f369796d9",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "backport of commit b293e6a82ad5d5a880c878c6b225642c51e3fabe (#24576)\n\nCo-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "86:  github.com/hashicorp/raft-autopilot v0.1.6",
          "87:  github.com/hashicorp/raft-boltdb/v2 v2.3.0",
          "88:  github.com/hashicorp/serf v0.10.2-0.20240320153621-5d32001edfaa",
          "90:  github.com/hashicorp/yamux v0.1.2",
          "91:  github.com/hpcloud/tail v1.0.1-0.20170814160653-37f427138745",
          "92:  github.com/klauspost/cpuid/v2 v2.2.8",
          "",
          "[Removed Lines]",
          "89:  github.com/hashicorp/vault/api v1.10.0",
          "",
          "[Added Lines]",
          "89:  github.com/hashicorp/vault/api v1.15.0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "180:  github.com/bgentry/speakeasy v0.1.0 // indirect",
          "181:  github.com/bmatcuk/doublestar v1.1.5 // indirect",
          "182:  github.com/boltdb/bolt v1.3.1 // indirect",
          "184:  github.com/cespare/xxhash/v2 v2.3.0 // indirect",
          "185:  github.com/checkpoint-restore/go-criu/v5 v5.3.0 // indirect",
          "186:  github.com/cheggaaa/pb/v3 v3.0.5 // indirect",
          "",
          "[Removed Lines]",
          "183:  github.com/cenkalti/backoff/v3 v3.2.2 // indirect",
          "",
          "[Added Lines]",
          "183:  github.com/cenkalti/backoff/v4 v4.3.0 // indirect",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "310: github.com/bufbuild/protocompile v0.4.0 h1:LbFKd2XowZvQ/kajzguUp2DC9UEIQhIq77fZZlaQsNA=",
          "311: github.com/bufbuild/protocompile v0.4.0/go.mod h1:3v93+mbWn/v3xzN+31nwkJfrEpAUwp+BagBSZWx+TP8=",
          "312: github.com/cenkalti/backoff/v3 v3.0.0/go.mod h1:cIeZDE3IrqwwJl6VUwCN6trj1oXrTS4rc0ij+ULvLYs=",
          "316: github.com/cenkalti/backoff/v4 v4.1.2/go.mod h1:scbssz8iZGpm3xbr14ovlUdkxfGXNInqkPWOWmG2CLw=",
          "317: github.com/census-instrumentation/opencensus-proto v0.2.1/go.mod h1:f6KPmirojxKA12rnyqOA5BBL4O983OfeGPqjHWSTneU=",
          "318: github.com/cespare/xxhash v1.1.0/go.mod h1:XrSqR1VqqWfGrhpAt58auRo0WTKS1nRRg3ghfAqPWnc=",
          "319: github.com/cespare/xxhash/v2 v2.1.1/go.mod h1:VGX0DQ3Q6kWi7AoAeZDth3/j3BFtOZR5XLFGgcrjCOs=",
          "",
          "[Removed Lines]",
          "313: github.com/cenkalti/backoff/v3 v3.2.2 h1:cfUAAO3yvKMYKPrvhDuHSwQnhZNk/RMHKdZqKTxfm6M=",
          "314: github.com/cenkalti/backoff/v3 v3.2.2/go.mod h1:cIeZDE3IrqwwJl6VUwCN6trj1oXrTS4rc0ij+ULvLYs=",
          "315: github.com/cenkalti/backoff/v4 v4.1.2 h1:6Yo7N8UP2K6LWZnW94DLVSSrbobcWdVzAYOisuDPIFo=",
          "",
          "[Added Lines]",
          "314: github.com/cenkalti/backoff/v4 v4.3.0 h1:MyRJ/UdXutAwSAT+s3wNd7MfTIcy71VQueUuFK343L8=",
          "315: github.com/cenkalti/backoff/v4 v4.3.0/go.mod h1:Y3VNntkOUPxTVeUxJ/G5vcM//AlwfmyYozVcomhLiZE=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "759: github.com/hashicorp/raft-boltdb/v2 v2.3.0/go.mod h1:YHukhB04ChJsLHLJEUD6vjFyLX2L3dsX3wPBZcX4tmc=",
          "760: github.com/hashicorp/serf v0.10.2-0.20240320153621-5d32001edfaa h1:UXgK+AZPfeQ1vOXXXfBj7C7mZpWUgRFcMAKpyyYrYgU=",
          "761: github.com/hashicorp/serf v0.10.2-0.20240320153621-5d32001edfaa/go.mod h1:RiISHML4PEb0ZN6S6uNW04TO8D6EUtTIOpCzzDnZeGk=",
          "763: github.com/hashicorp/vault/api v1.10.0/go.mod h1:jo5Y/ET+hNyz+JnKDt8XLAdKs+AM0G5W0Vp1IrFI8N8=",
          "764: github.com/hashicorp/vault/api/auth/kubernetes v0.5.0 h1:CXO0fD7M3iCGovP/UApeHhPcH4paDFKcu7AjEXi94rI=",
          "765: github.com/hashicorp/vault/api/auth/kubernetes v0.5.0/go.mod h1:afrElBIO9Q4sHFVuVWgNevG4uAs1bT2AZFA9aEiI608=",
          "766: github.com/hashicorp/vic v1.5.1-0.20190403131502-bbfe86ec9443 h1:O/pT5C1Q3mVXMyuqg7yuAWUg/jMZR1/0QTzTRdNR6Uw=",
          "",
          "[Removed Lines]",
          "762: github.com/hashicorp/vault/api v1.10.0 h1:/US7sIjWN6Imp4o/Rj1Ce2Nr5bki/AXi9vAW3p2tOJQ=",
          "",
          "[Added Lines]",
          "762: github.com/hashicorp/vault/api v1.15.0 h1:O24FYQCWwhwKnF7CuSqP30S51rTV7vz1iACXE/pj5DA=",
          "763: github.com/hashicorp/vault/api v1.15.0/go.mod h1:+5YTO09JGn0u+b6ySD/LLVf8WkJCPLAL2Vkmrn2+CM8=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8ea802a9724bd7f9b87ab3e83299fad5c75123c5",
      "candidate_info": {
        "commit_hash": "8ea802a9724bd7f9b87ab3e83299fad5c75123c5",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/8ea802a9724bd7f9b87ab3e83299fad5c75123c5",
        "files": [
          ".changelog/24169.txt",
          "client/fingerprint/env_gce.go",
          "client/fingerprint/env_gce_test.go"
        ],
        "message": "fingerprint gce: collect preemptibility",
        "before_after_code_files": [
          "client/fingerprint/env_gce.go||client/fingerprint/env_gce.go",
          "client/fingerprint/env_gce_test.go||client/fingerprint/env_gce_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "client/fingerprint/env_gce.go||client/fingerprint/env_gce.go": [
          "File: client/fingerprint/env_gce.go -> client/fingerprint/env_gce.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "160:   \"cpu-platform\":                   false,",
          "161:   \"scheduling/automatic-restart\":   false,",
          "162:   \"scheduling/on-host-maintenance\": false,",
          "163:  }",
          "165:  for k, unique := range keys {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:   \"scheduling/preemptible\":         false,",
          "",
          "---------------"
        ],
        "client/fingerprint/env_gce_test.go||client/fingerprint/env_gce_test.go": [
          "File: client/fingerprint/env_gce_test.go -> client/fingerprint/env_gce_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "149:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.scheduling.automatic-restart\", \"TRUE\")",
          "150:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.scheduling.on-host-maintenance\", \"MIGRATE\")",
          "151:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.cpu-platform\", \"Intel Ivy Bridge\")",
          "152:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.tag.abc\", \"true\")",
          "153:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.tag.def\", \"true\")",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "151:  assertNodeAttributeEquals(t, response.Attributes, \"platform.gce.scheduling.preemptible\", \"FALSE\")",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "200:       \"content-type\": \"text/plain\",",
          "201:       \"body\": \"MIGRATE\"",
          "202:     },",
          "203:     {",
          "204:       \"uri\": \"/computeMetadata/v1/instance/cpu-platform\",",
          "205:       \"content-type\": \"text/plain\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "204:     {",
          "205:       \"uri\": \"/computeMetadata/v1/instance/scheduling/preemptible\",",
          "206:       \"content-type\": \"text/plain\",",
          "207:       \"body\": \"FALSE\"",
          "208:     },",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "44a84583202400029c0f184cd060ae87218a43ff",
      "candidate_info": {
        "commit_hash": "44a84583202400029c0f184cd060ae87218a43ff",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/44a84583202400029c0f184cd060ae87218a43ff",
        "files": [
          ".release/ci.hcl",
          "GNUmakefile",
          "client/structs/structs.generated.go",
          "nomad/structs/structs.generated.go",
          "version/version.go"
        ],
        "message": "Prepare for next release",
        "before_after_code_files": [
          ".release/ci.hcl||.release/ci.hcl",
          "client/structs/structs.generated.go||client/structs/structs.generated.go",
          "nomad/structs/structs.generated.go||nomad/structs/structs.generated.go",
          "version/version.go||version/version.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        ".release/ci.hcl||.release/ci.hcl": [
          "File: .release/ci.hcl -> .release/ci.hcl",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:   team = \"nomad\"",
          "9:   slack {",
          "11:   }",
          "13:   github {",
          "",
          "[Removed Lines]",
          "10:     notification_channel = \"CUYKT2A73\"",
          "",
          "[Added Lines]",
          "10:     notification_channel = \"C03B5EWFW01\"",
          "",
          "---------------"
        ],
        "client/structs/structs.generated.go||client/structs/structs.generated.go": [
          "File: client/structs/structs.generated.go -> client/structs/structs.generated.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "nomad/structs/structs.generated.go||nomad/structs/structs.generated.go": [
          "File: nomad/structs/structs.generated.go -> nomad/structs/structs.generated.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "version/version.go||version/version.go": [
          "File: version/version.go -> version/version.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:  GitDescribe string",
          "30:  VersionMetadata = \"\"",
          "",
          "[Removed Lines]",
          "22:  Version = \"1.9.3\"",
          "27:  VersionPrerelease = \"\"",
          "",
          "[Added Lines]",
          "22:  Version = \"1.9.4\"",
          "27:  VersionPrerelease = \"dev\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}