{
  "cve_id": "CVE-2022-41711",
  "cve_desc": "Badaso version 2.6.0 allows an unauthenticated remote attacker to execute arbitrary code remotely on the server. This is possible because the application does not properly validate the data uploaded by users.",
  "repo": "uasoft-indonesia/badaso",
  "patch_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
  "patch_info": {
    "commit_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
    "repo": "uasoft-indonesia/badaso",
    "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/22250eca7c364d991ce9e0a723941eae4889d6f9",
    "files": [
      "src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue"
    ],
    "message": "Merge pull request #807 from uasoft-indonesia/bugfix/v2/filter-mimeType\n\nBugfix[v2] add filter mimeType",
    "before_after_code_files": [
      "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue"
    ]
  },
  "patch_diff": {
    "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue": [
      "File: src/resources/js/components/BadasoUploadFile.vue -> src/resources/js/components/BadasoUploadFile.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "336:           });",
      "337:           return;",
      "338:         }",
      "340:         this.uploadFile(files[0]);",
      "341:       }",
      "342:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "339:         if (!this.availableMimetypes.file.validMime.includes(files[0].type)) {",
      "340:           this.$vs.notify({",
      "341:             title: this.$t(\"alert.danger\"),",
      "342:             text: \"File type not allowed\",",
      "343:             color: \"danger\",",
      "344:           });",
      "345:           return;",
      "346:         }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadFileMultiple.vue -> src/resources/js/components/BadasoUploadFileMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             });",
      "368:             return;",
      "369:           }",
      "371:           this.uploadFile(file);",
      "372:         }",
      "373:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:           if (!this.availableMimetypes.file.validMime.includes(file.type)) {",
      "371:             this.$vs.notify({",
      "372:               title: this.$t(\"alert.danger\"),",
      "373:               text: \"File type not allowed\",",
      "374:               color: \"danger\",",
      "375:             });",
      "376:             return;",
      "377:           }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue": [
      "File: src/resources/js/components/BadasoUploadImage.vue -> src/resources/js/components/BadasoUploadImage.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "380:           });",
      "381:           return;",
      "382:         }",
      "384:         this.uploadImage(files[0]);",
      "385:       }",
      "386:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "383:         if (!this.availableMimetypes.image.validMime.includes(files[0].type)){",
      "384:           this.$vs.notify({",
      "385:             title: this.$t(\"alert.danger\"),",
      "386:             text: \"File type not allowed\",",
      "387:             color: \"danger\",",
      "388:           });",
      "389:           return;",
      "390:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:     uploadImage(file) {",
      "422:       const files = new FormData();",
      "423:       files.append(\"upload\", file);",
      "425:       files.append(\"working_dir\", this.getActiveFolder);",
      "426:       this.$api.badasoFile",
      "427:         .uploadUsingLfm(files)",
      "",
      "[Removed Lines]",
      "424:       files.append(\"type\", \"image\");",
      "",
      "[Added Lines]",
      "431:       files.append(\"type\", file.type);",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadImageMultiple.vue -> src/resources/js/components/BadasoUploadImageMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "395:             });",
      "396:             return;",
      "397:           }",
      "399:           this.uploadImage(file);",
      "400:         }",
      "401:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "398:           if (!this.availableMimetypes.image.validMime.includes(file.type)) {",
      "399:             this.$vs.notify({",
      "400:               title: this.$t(\"alert.danger\"),",
      "401:               text: \"File type not allowed\",",
      "402:               color: \"danger\",",
      "403:             });",
      "404:             return;",
      "405:           }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8926b9d96eb04928c319b89b6bc29727a0c667ee",
      "candidate_info": {
        "commit_hash": "8926b9d96eb04928c319b89b6bc29727a0c667ee",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/8926b9d96eb04928c319b89b6bc29727a0c667ee",
        "files": [
          "src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "src/Seeder/Configurations/MenusSeeder.php",
          "src/Seeder/Configurations/RolesSeeder.php"
        ],
        "message": "Apply fixes from StyleCI",
        "before_after_code_files": [
          "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "src/Seeder/Configurations/MenusSeeder.php||src/Seeder/Configurations/MenusSeeder.php",
          "src/Seeder/Configurations/RolesSeeder.php||src/Seeder/Configurations/RolesSeeder.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php": [
          "File: src/Seeder/Configurations/FixedMenuItemSeeder.php -> src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "197:                 }",
          "198:             }",
          "199:         } catch (\\Exception $e) {",
          "201:             \\DB::rollBack();",
          "202:         }",
          "",
          "[Removed Lines]",
          "200:             throw new \\Exception('Exception occur ' . $e);",
          "",
          "[Added Lines]",
          "200:             throw new \\Exception('Exception occur '.$e);",
          "",
          "---------------"
        ],
        "src/Seeder/Configurations/MenusSeeder.php||src/Seeder/Configurations/MenusSeeder.php": [
          "File: src/Seeder/Configurations/MenusSeeder.php -> src/Seeder/Configurations/MenusSeeder.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "40:                 }",
          "41:             }",
          "42:         } catch (Exception $e) {",
          "44:             \\DB::rollBack();",
          "45:         }",
          "",
          "[Removed Lines]",
          "43:             throw new Exception('Exception occur ' . $e);",
          "",
          "[Added Lines]",
          "43:             throw new Exception('Exception occur '.$e);",
          "",
          "---------------"
        ],
        "src/Seeder/Configurations/RolesSeeder.php||src/Seeder/Configurations/RolesSeeder.php": [
          "File: src/Seeder/Configurations/RolesSeeder.php -> src/Seeder/Configurations/RolesSeeder.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:             \\DB::commit();",
          "44:         } catch (Exception $e) {",
          "46:             \\DB::rollBack();",
          "47:         }",
          "48:     }",
          "",
          "[Removed Lines]",
          "45:             throw new Exception('Exception occur ' . $e);",
          "",
          "[Added Lines]",
          "45:             throw new Exception('Exception occur '.$e);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "47b02fc110dff60451f5abaad1924411fc5c95a9",
      "candidate_info": {
        "commit_hash": "47b02fc110dff60451f5abaad1924411fc5c95a9",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/47b02fc110dff60451f5abaad1924411fc5c95a9",
        "files": [
          "src/Controllers/Controller.php"
        ],
        "message": "Apply fixes from StyleCI",
        "before_after_code_files": [
          "src/Controllers/Controller.php||src/Controllers/Controller.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Controllers/Controller.php||src/Controllers/Controller.php": [
          "File: src/Controllers/Controller.php -> src/Controllers/Controller.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "369:                             }",
          "370:                         }",
          "371:                     }",
          "373:                 }",
          "374:             }",
          "375:             DB::table($data_type->name)->where('id', $id)->update($new_data);",
          "",
          "[Removed Lines]",
          "372:                     $new_data[$key] = $this->getContentByType($data_type, $data_row, $value) != null ?  $this->getContentByType($data_type, $data_row, $value) : '';",
          "",
          "[Added Lines]",
          "372:                     $new_data[$key] = $this->getContentByType($data_type, $data_row, $value) != null ? $this->getContentByType($data_type, $data_row, $value) : '';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d1386d1e33a7b08998ce8c362c5ccea0be597da6",
      "candidate_info": {
        "commit_hash": "d1386d1e33a7b08998ce8c362c5ccea0be597da6",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/d1386d1e33a7b08998ce8c362c5ccea0be597da6",
        "files": [
          "src/Commands/BadasoSetup.php",
          "src/resources/js/api/index.js",
          "src/resources/js/app.js",
          "src/resources/js/lang/index.js",
          "src/resources/js/router/router.js",
          "src/resources/js/store/store.js"
        ],
        "message": "rename MIX_BADASO_MODULES -> MIX_BADASO_PLUGINS",
        "before_after_code_files": [
          "src/Commands/BadasoSetup.php||src/Commands/BadasoSetup.php",
          "src/resources/js/api/index.js||src/resources/js/api/index.js",
          "src/resources/js/app.js||src/resources/js/app.js",
          "src/resources/js/lang/index.js||src/resources/js/lang/index.js",
          "src/resources/js/router/router.js||src/resources/js/router/router.js",
          "src/resources/js/store/store.js||src/resources/js/store/store.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Commands/BadasoSetup.php||src/Commands/BadasoSetup.php": [
          "File: src/Commands/BadasoSetup.php -> src/Commands/BadasoSetup.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "253:             'BADASO_AUTH_TOKEN_LIFETIME' => '',",
          "254:             'BADASO_LICENSE_KEY' => '',",
          "255:             'ARCANEDEV_LOGVIEWER_MIDDLEWARE' => '',",
          "256:             'MIX_DEFAULT_MENU' => 'general',",
          "257:             'MIX_BADASO_MENU' => '${MIX_DEFAULT_MENU}',",
          "258:             'MIX_ADMIN_PANEL_ROUTE_PREFIX' => 'badaso-dashboard',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "256:             'MIX_BADASO_PLUGINS' => '',",
          "",
          "---------------"
        ],
        "src/resources/js/api/index.js||src/resources/js/api/index.js": [
          "File: src/resources/js/api/index.js -> src/resources/js/api/index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: const exported = {};",
          "5:   : null;",
          "",
          "[Removed Lines]",
          "3: const pluginsEnv = process.env.MIX_BADASO_MODULES",
          "4:   ? process.env.MIX_BADASO_MODULES",
          "",
          "[Added Lines]",
          "3: const pluginsEnv = process.env.MIX_BADASO_PLUGINS",
          "4:   ? process.env.MIX_BADASO_PLUGINS",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "64: try {",
          "65:   if (pluginsEnv) {",
          "67:     if (plugins && plugins.length > 0) {",
          "68:       plugins.forEach((plugin) => {",
          "69:         const modules = require(\"../../../../../\" +",
          "",
          "[Removed Lines]",
          "66:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "66:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------"
        ],
        "src/resources/js/app.js||src/resources/js/app.js": [
          "File: src/resources/js/app.js -> src/resources/js/app.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: }",
          "47:   : null;",
          "",
          "[Removed Lines]",
          "45: const pluginsEnv = process.env.MIX_BADASO_MODULES",
          "46:   ? process.env.MIX_BADASO_MODULES",
          "",
          "[Added Lines]",
          "45: const pluginsEnv = process.env.MIX_BADASO_PLUGINS",
          "46:   ? process.env.MIX_BADASO_PLUGINS",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "54: try {",
          "55:   if (pluginsEnv) {",
          "57:     if (plugins && plugins.length > 0) {",
          "58:       plugins.forEach((plugin) => {",
          "59:         const router = require(\"../../../../\" +",
          "",
          "[Removed Lines]",
          "56:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "56:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "212: try {",
          "213:   if (pluginsEnv) {",
          "215:     if (plugins && plugins.length > 0) {",
          "216:       plugins.forEach((plugin) => {",
          "217:         const fileName = require(\"../../../../\" +",
          "",
          "[Removed Lines]",
          "214:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "214:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------"
        ],
        "src/resources/js/lang/index.js||src/resources/js/lang/index.js": [
          "File: src/resources/js/lang/index.js -> src/resources/js/lang/index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: const exported = {};",
          "4: const languages = [];",
          "8:   : null;",
          "",
          "[Removed Lines]",
          "6: const pluginsEnv = process.env.MIX_BADASO_MODULES",
          "7:   ? process.env.MIX_BADASO_MODULES",
          "",
          "[Added Lines]",
          "6: const pluginsEnv = process.env.MIX_BADASO_PLUGINS",
          "7:   ? process.env.MIX_BADASO_PLUGINS",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "83: try {",
          "84:   if (pluginsEnv) {",
          "86:     if (plugins && plugins.length > 0) {",
          "87:       plugins.forEach((plugin) => {",
          "88:         const modules = require(\"../../../../../\" +",
          "",
          "[Removed Lines]",
          "85:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "85:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------"
        ],
        "src/resources/js/router/router.js||src/resources/js/router/router.js": [
          "File: src/resources/js/router/router.js -> src/resources/js/router/router.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:   ? \"/\" + process.env.MIX_ADMIN_PANEL_ROUTE_PREFIX",
          "15:   : \"/badaso-dashboard\";",
          "19:   : null;",
          "21: let _authRouters = [];",
          "",
          "[Removed Lines]",
          "17: const pluginsEnv = process.env.MIX_BADASO_MODULES",
          "18:   ? process.env.MIX_BADASO_MODULES",
          "",
          "[Added Lines]",
          "17: const pluginsEnv = process.env.MIX_BADASO_PLUGINS",
          "18:   ? process.env.MIX_BADASO_PLUGINS",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "54:   if (pluginsEnv) {",
          "56:     if (plugins && plugins.length > 0) {",
          "57:       for (const index in plugins) {",
          "58:         const plugin = plugins[index];",
          "",
          "[Removed Lines]",
          "55:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "55:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------"
        ],
        "src/resources/js/store/store.js||src/resources/js/store/store.js": [
          "File: src/resources/js/store/store.js -> src/resources/js/store/store.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: const exported = {};",
          "9:   : null;",
          "",
          "[Removed Lines]",
          "7: const pluginsEnv = process.env.MIX_BADASO_MODULES",
          "8:   ? process.env.MIX_BADASO_MODULES",
          "",
          "[Added Lines]",
          "7: const pluginsEnv = process.env.MIX_BADASO_PLUGINS",
          "8:   ? process.env.MIX_BADASO_PLUGINS",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "68: try {",
          "69:   if (pluginsEnv) {",
          "71:     if (plugins && plugins.length > 0) {",
          "72:       plugins.forEach((plugin) => {",
          "73:         const modules = require(\"../../../../../\" +",
          "",
          "[Removed Lines]",
          "70:     const plugins = process.env.MIX_BADASO_MODULES.split(\",\");",
          "",
          "[Added Lines]",
          "70:     const plugins = process.env.MIX_BADASO_PLUGINS.split(\",\");",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "041f2ea42a10960abb2d8cce334a795bb872f6a2",
      "candidate_info": {
        "commit_hash": "041f2ea42a10960abb2d8cce334a795bb872f6a2",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/041f2ea42a10960abb2d8cce334a795bb872f6a2",
        "files": [
          "src/Config/lfm.php"
        ],
        "message": "Apply fixes from StyleCI",
        "before_after_code_files": [
          "src/Config/lfm.php||src/Config/lfm.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Config/lfm.php||src/Config/lfm.php": [
          "File: src/Config/lfm.php -> src/Config/lfm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "188:     'middleware' => [",
          "189:         'web',",
          "190:         'auth',",
          "192:     ],",
          "193: ];",
          "",
          "[Removed Lines]",
          "191:         BadasoCheckPermissions::class . ':browse_file_manager',",
          "",
          "[Added Lines]",
          "191:         BadasoCheckPermissions::class.':browse_file_manager',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aff0c6f5de9de0fc86db40a5a385913764981c38",
      "candidate_info": {
        "commit_hash": "aff0c6f5de9de0fc86db40a5a385913764981c38",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/aff0c6f5de9de0fc86db40a5a385913764981c38",
        "files": [
          "phpstan-baseline.neon"
        ],
        "message": "test1",
        "before_after_code_files": [
          "phpstan-baseline.neon||phpstan-baseline.neon"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "phpstan-baseline.neon||phpstan-baseline.neon": [
          "File: phpstan-baseline.neon -> phpstan-baseline.neon",
          "--- Hunk 1 ---",
          "[Context before]",
          "34:     - '#Call to an undefined static method Illuminate\\\\Support\\\\Facades\\\\Redis::[a-zA-Z0-9-()\\_]+.#'",
          "35:     - '#Class App\\\\Http\\\\Controllers\\\\Controller not found.#'",
          "36:     - '#Parameter $test_case of method Uasoft\\\\Badaso\\\\Helpers\\\\CallHelperTest::[a-zA-Z0-9-()\\_]+ has invalid type Tests\\\\TestCase.#'",
          "38:     - '#Call to static method [a-zA-Z0-9-()\\_]+ on an unknown class Route.#'",
          "39:     - '#Result of method [a-zA-Z0-9\\\\_]+::[a-zA-Z0-9-()\\_]+ [a-zA-Z0-9-()\\_]+ is used.#'",
          "40:     - '#Method [a-zA-Z0-9\\\\_]+::[a-zA-Z0-9-()\\_]+ should return int but return statement is missing.#'",
          "",
          "[Removed Lines]",
          "37:     - '#Method Uasoft\\Badaso\\Helpers\\CallHelperTest::[a-zA-Z0-9-()\\_]+ has invalid return type Tests\\\\TestCase. #'",
          "",
          "[Added Lines]",
          "37:     - '#Method Uasoft\\\\Badaso\\\\Helpers\\\\CallHelperTest::[a-zA-Z0-9-()\\_]+ has invalid return type Tests\\\\TestCase. #'",
          "",
          "---------------"
        ]
      }
    }
  ]
}