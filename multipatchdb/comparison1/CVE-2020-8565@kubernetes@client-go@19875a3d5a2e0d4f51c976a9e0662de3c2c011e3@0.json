{
  "cve_id": "CVE-2020-8565",
  "cve_desc": "In Kubernetes, if the logging level is set to at least 9, authorization and bearer tokens will be written to log files. This can occur both in API server logs and client tool output like kubectl. This affects <= v1.19.3, <= v1.18.10, <= v1.17.13, < v1.20.0-alpha2.",
  "repo": "kubernetes/client-go",
  "patch_hash": "19875a3d5a2e0d4f51c976a9e0662de3c2c011e3",
  "patch_info": {
    "commit_hash": "19875a3d5a2e0d4f51c976a9e0662de3c2c011e3",
    "repo": "kubernetes/client-go",
    "commit_url": "https://github.com/kubernetes/client-go/commit/19875a3d5a2e0d4f51c976a9e0662de3c2c011e3",
    "files": [
      "transport/round_trippers.go"
    ],
    "message": "Mask bearer token in logs when logLevel >= 9\n\nKubernetes-commit: 27f5d24017078154d39ccd258bd83562c911fed8",
    "before_after_code_files": [
      "transport/round_trippers.go||transport/round_trippers.go"
    ]
  },
  "patch_diff": {
    "transport/round_trippers.go||transport/round_trippers.go": [
      "File: transport/round_trippers.go -> transport/round_trippers.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "340:  headers := \"\"",
      "341:  for key, values := range r.RequestHeaders {",
      "342:   for _, value := range values {",
      "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
      "344:   }",
      "345:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "343:    value = maskValue(key, value)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "44e1a07f2d513e375c4b6ee6e890040b47befe86",
      "candidate_info": {
        "commit_hash": "44e1a07f2d513e375c4b6ee6e890040b47befe86",
        "repo": "kubernetes/client-go",
        "commit_url": "https://github.com/kubernetes/client-go/commit/44e1a07f2d513e375c4b6ee6e890040b47befe86",
        "files": [
          "transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9\n\nKubernetes-commit: 5d1b08e4cd270d84152fdde0b13d643b1bca0576",
        "before_after_code_files": [
          "transport/round_trippers.go||transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ],
          "candidate": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "transport/round_trippers.go||transport/round_trippers.go": [
          "File: transport/round_trippers.go -> transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1b8383fc150c9b816b0072032cca75754c2734d0",
      "candidate_info": {
        "commit_hash": "1b8383fc150c9b816b0072032cca75754c2734d0",
        "repo": "kubernetes/client-go",
        "commit_url": "https://github.com/kubernetes/client-go/commit/1b8383fc150c9b816b0072032cca75754c2734d0",
        "files": [
          "transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9\n\nKubernetes-commit: f5bf592fc0d60fe2f135bcea30a61b7ee6d8f2b9",
        "before_after_code_files": [
          "transport/round_trippers.go||transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ],
          "candidate": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "transport/round_trippers.go||transport/round_trippers.go": [
          "File: transport/round_trippers.go -> transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e8f871a2e5fadf90fc114565abc0963967f1a373",
      "candidate_info": {
        "commit_hash": "e8f871a2e5fadf90fc114565abc0963967f1a373",
        "repo": "kubernetes/client-go",
        "commit_url": "https://github.com/kubernetes/client-go/commit/e8f871a2e5fadf90fc114565abc0963967f1a373",
        "files": [
          "transport/round_trippers.go"
        ],
        "message": "Mask bearer token in logs when logLevel >= 9\n\nKubernetes-commit: f0f52255412cbc6834bd225a59608ebb4a0d399b",
        "before_after_code_files": [
          "transport/round_trippers.go||transport/round_trippers.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ],
          "candidate": [
            "transport/round_trippers.go||transport/round_trippers.go"
          ]
        }
      },
      "candidate_diff": {
        "transport/round_trippers.go||transport/round_trippers.go": [
          "File: transport/round_trippers.go -> transport/round_trippers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  headers := \"\"",
          "341:  for key, values := range r.RequestHeaders {",
          "342:   for _, value := range values {",
          "343:    headers += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))",
          "344:   }",
          "345:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343:    value = maskValue(key, value)",
          "",
          "---------------"
        ]
      }
    }
  ]
}