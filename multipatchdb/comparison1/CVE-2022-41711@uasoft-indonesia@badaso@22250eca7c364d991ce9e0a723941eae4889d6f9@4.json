{
  "cve_id": "CVE-2022-41711",
  "cve_desc": "Badaso version 2.6.0 allows an unauthenticated remote attacker to execute arbitrary code remotely on the server. This is possible because the application does not properly validate the data uploaded by users.",
  "repo": "uasoft-indonesia/badaso",
  "patch_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
  "patch_info": {
    "commit_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
    "repo": "uasoft-indonesia/badaso",
    "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/22250eca7c364d991ce9e0a723941eae4889d6f9",
    "files": [
      "src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue"
    ],
    "message": "Merge pull request #807 from uasoft-indonesia/bugfix/v2/filter-mimeType\n\nBugfix[v2] add filter mimeType",
    "before_after_code_files": [
      "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue"
    ]
  },
  "patch_diff": {
    "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue": [
      "File: src/resources/js/components/BadasoUploadFile.vue -> src/resources/js/components/BadasoUploadFile.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "336:           });",
      "337:           return;",
      "338:         }",
      "340:         this.uploadFile(files[0]);",
      "341:       }",
      "342:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "339:         if (!this.availableMimetypes.file.validMime.includes(files[0].type)) {",
      "340:           this.$vs.notify({",
      "341:             title: this.$t(\"alert.danger\"),",
      "342:             text: \"File type not allowed\",",
      "343:             color: \"danger\",",
      "344:           });",
      "345:           return;",
      "346:         }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadFileMultiple.vue -> src/resources/js/components/BadasoUploadFileMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             });",
      "368:             return;",
      "369:           }",
      "371:           this.uploadFile(file);",
      "372:         }",
      "373:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:           if (!this.availableMimetypes.file.validMime.includes(file.type)) {",
      "371:             this.$vs.notify({",
      "372:               title: this.$t(\"alert.danger\"),",
      "373:               text: \"File type not allowed\",",
      "374:               color: \"danger\",",
      "375:             });",
      "376:             return;",
      "377:           }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue": [
      "File: src/resources/js/components/BadasoUploadImage.vue -> src/resources/js/components/BadasoUploadImage.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "380:           });",
      "381:           return;",
      "382:         }",
      "384:         this.uploadImage(files[0]);",
      "385:       }",
      "386:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "383:         if (!this.availableMimetypes.image.validMime.includes(files[0].type)){",
      "384:           this.$vs.notify({",
      "385:             title: this.$t(\"alert.danger\"),",
      "386:             text: \"File type not allowed\",",
      "387:             color: \"danger\",",
      "388:           });",
      "389:           return;",
      "390:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:     uploadImage(file) {",
      "422:       const files = new FormData();",
      "423:       files.append(\"upload\", file);",
      "425:       files.append(\"working_dir\", this.getActiveFolder);",
      "426:       this.$api.badasoFile",
      "427:         .uploadUsingLfm(files)",
      "",
      "[Removed Lines]",
      "424:       files.append(\"type\", \"image\");",
      "",
      "[Added Lines]",
      "431:       files.append(\"type\", file.type);",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadImageMultiple.vue -> src/resources/js/components/BadasoUploadImageMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "395:             });",
      "396:             return;",
      "397:           }",
      "399:           this.uploadImage(file);",
      "400:         }",
      "401:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "398:           if (!this.availableMimetypes.image.validMime.includes(file.type)) {",
      "399:             this.$vs.notify({",
      "400:               title: this.$t(\"alert.danger\"),",
      "401:               text: \"File type not allowed\",",
      "402:               color: \"danger\",",
      "403:             });",
      "404:             return;",
      "405:           }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3fc20025258061a92d555055343aa4be0e9459af",
      "candidate_info": {
        "commit_hash": "3fc20025258061a92d555055343aa4be0e9459af",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/3fc20025258061a92d555055343aa4be0e9459af",
        "files": [
          "src/Config/l5-swagger.php"
        ],
        "message": "Apply fixes from StyleCI",
        "before_after_code_files": [
          "src/Config/l5-swagger.php||src/Config/l5-swagger.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Config/l5-swagger.php||src/Config/l5-swagger.php": [
          "File: src/Config/l5-swagger.php -> src/Config/l5-swagger.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "240:         'constants' => [",
          "242:         ],",
          "243:     ],",
          "244: ];",
          "",
          "[Removed Lines]",
          "241:             'L5_SWAGGER_CONST_HOST' => env('APP_URL') . '/' . env('MIX_API_ROUTE_PREFIX'),",
          "",
          "[Added Lines]",
          "241:             'L5_SWAGGER_CONST_HOST' => env('APP_URL').'/'.env('MIX_API_ROUTE_PREFIX'),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8996335d4c126d799d4e21b38c0db0a22b91806d",
      "candidate_info": {
        "commit_hash": "8996335d4c126d799d4e21b38c0db0a22b91806d",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/8996335d4c126d799d4e21b38c0db0a22b91806d",
        "files": [
          "composer.json",
          "src/resources/js/pages/configuration/browse.vue"
        ],
        "message": "bug fix role registatrion v2",
        "before_after_code_files": [
          "src/resources/js/pages/configuration/browse.vue||src/resources/js/pages/configuration/browse.vue"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/pages/configuration/browse.vue||src/resources/js/pages/configuration/browse.vue": [
          "File: src/resources/js/pages/configuration/browse.vue -> src/resources/js/pages/configuration/browse.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "347:               if (data.type === \"hidden\") {",
          "348:                 data.value = data.details.value ? data.details.value : \"\";",
          "349:               }",
          "351:                  data.details.items = this.role",
          "352:               }",
          "353:               if (data.type === \"switch\") {",
          "",
          "[Removed Lines]",
          "350:               if(data.details.key === 'defaultRoleRegistration' ){",
          "",
          "[Added Lines]",
          "350:               if(data.key === 'defaultRoleRegistration' ){",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fc6f3695426665bcce63ed227c6e743a3566b5c1",
      "candidate_info": {
        "commit_hash": "fc6f3695426665bcce63ed227c6e743a3566b5c1",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/fc6f3695426665bcce63ed227c6e743a3566b5c1",
        "files": [
          "phpstan-baseline.neon"
        ],
        "message": "update phpstan",
        "before_after_code_files": [
          "phpstan-baseline.neon||phpstan-baseline.neon"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "phpstan-baseline.neon||phpstan-baseline.neon": [
          "File: phpstan-baseline.neon -> phpstan-baseline.neon",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: parameters:",
          "2:     ignoreErrors:",
          "25:     - '#Result of method [a-zA-Z0-9\\\\_]+::[a-zA-Z0-9-()\\_]+ [a-zA-Z0-9-()\\_]+ is used.#'",
          "26:     - '#Method [a-zA-Z0-9\\\\_]+::[a-zA-Z0-9-()\\_]+ should return int but return statement is missing.#'",
          "27:     - '#Call to sprintf contains 1 placeholder, 0 values given.#'",
          "35:     - '#Access to an undefined property Uasoft\\\\Badaso\\\\Models\\\\MenuItem::\\$[a-zA-Z0-9-()\\_]+.#'",
          "37:     - '#Instantiated class Database\\\\Seeders\\\\Badaso\\\\Exception not found.#'",
          "",
          "[Removed Lines]",
          "3:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\Role::[a-zA-Z0-9-()\\_]+.#'",
          "4:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\User::[a-zA-Z0-9-()\\_]+.#'",
          "5:     - '#Call to an undefined static method Spatie\\\\Activitylog\\\\Models\\\\Activity::[a-zA-Z0-9-()\\_]+.#'",
          "6:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\UserVerification::[a-zA-Z0-9-()\\_]+.#'",
          "7:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\PasswordReset::[a-zA-Z0-9-()\\_]+.#'",
          "8:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\EmailReset::[a-zA-Z0-9-()\\_]+.#'",
          "9:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\DataType::[a-zA-Z0-9-()\\_]+.#'",
          "10:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Facades\\\\Badaso::[a-zA-Z0-9-()\\_]+.#'",
          "11:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\DataRow::[a-zA-Z0-9-()\\_]+.#'",
          "12:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\MenuItem::[a-zA-Z0-9-()\\_]+.#'",
          "13:     - '#Call to an undefined method Uasoft\\\\Badaso\\\\Models\\\\MenuItem::[a-zA-Z0-9-()\\_]+.#'",
          "14:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\Configuration::[a-zA-Z0-9-()\\_]+.#'",
          "15:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\FirebaseCloudMessages::[a-zA-Z0-9-()\\_]+.#'",
          "16:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\Menu::[a-zA-Z0-9-()\\_]+.#'",
          "17:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\Permission::[a-zA-Z0-9-()\\_]+.#'",
          "18:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\Notification::[a-zA-Z0-9-()\\_]+.#'",
          "19:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\RolePermission::[a-zA-Z0-9-()\\_]+.#'",
          "20:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Models\\\\UserRole::[a-zA-Z0-9-()\\_]+.#'",
          "21:     - '#Call to an undefined static method Uasoft\\\\Badaso\\\\Database\\\\Schema\\\\SchemaManager::[a-zA-Z0-9-()\\_]+.#'",
          "22:     - '#Call to an undefined static method Illuminate\\\\Support\\\\Facades\\\\DB::[a-zA-Z0-9-()\\_]+.#'",
          "23:     - '#Call to an undefined static method Illuminate\\\\Support\\\\Facades\\\\Redis::[a-zA-Z0-9-()\\_]+.#'",
          "24:     - '#Call to static method [a-zA-Z0-9-()\\_]+ on an unknown class Route.#'",
          "28:     - '#Variable \\$custom_permissions might not be defined.#'",
          "29:     - '#Call to static method debug[()]+ on an unknown class Log.#'",
          "30:     - '#Call to static method first[()]+ on an unknown class Uasoft\\\\Badaso\\\\Models\\\\FirebaseServices.#'",
          "31:     - '#Call to static method user[()]+ on an unknown class JWTAuth.#'",
          "32:     - '#Function call_protected_method not found.#'",
          "33:     - '#Function get_protected_property not found.#'",
          "34:     - '#Variable \\$data in isset[()]+ always exists and is not nullable.#'",
          "36:     - '#Call to static method [a-zA-Z0-9-()\\_]+ on an unknown class DB.#'",
          "38:     - '#Caught class Database\\\\Seeders\\\\Badaso\\\\Exception not found.#'",
          "39:     - '#Call to static method disk[()]+ on an unknown class Storage.#'",
          "40:     - '#Variable \\$altered_current_fields might not be defined.#'",
          "41:     - '#Variable \\$altered_modified_fields might not be defined.#'",
          "42:     - '#Variable \\$[a-zA-Z0-9-()\\_]+ in isset[()]+ always exists and is not nullable.#'",
          "",
          "[Added Lines]",
          "3:     - '#Call to an undefined static method [a-zA-Z0-9-()\\\\_]+::[a-zA-Z0-9-()\\_]+.#'",
          "4:     - '#Call to an undefined method [a-zA-Z0-9-()\\\\_]+::[a-zA-Z0-9-()\\_]+.#'",
          "5:     - '#Call to static method [a-zA-Z0-9-()\\_]+ on an unknown class [a-zA-Z0-9-()\\_]+.#'",
          "6:     - '#Call to static method [a-zA-Z0-9-()\\_]+ on an unknown class $[a-zA-Z0-9-()\\\\_]+.#'",
          "10:     - '#Function [a-zA-Z0-9-()\\_]+ not found.#'",
          "11:     - '#Variable \\$[a-zA-Z0-9-()\\_]+ in isset[()]+ always exists and is not nullable.#'",
          "14:     - '#Caught class [a-zA-Z0-9-()\\\\_]+ not found.#'",
          "15:     - '#Variable \\$[a-zA-Z0-9\\\\_]+ might not be defined.#'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a9c6453a0e4715c3867b2a87de92da64a091bc96",
      "candidate_info": {
        "commit_hash": "a9c6453a0e4715c3867b2a87de92da64a091bc96",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/a9c6453a0e4715c3867b2a87de92da64a091bc96",
        "files": [
          "src/Seeder/Configurations/FixedMenuItemSeeder.php"
        ],
        "message": "update file manager",
        "before_after_code_files": [
          "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Seeder/Configurations/FixedMenuItemSeeder.php||src/Seeder/Configurations/FixedMenuItemSeeder.php": [
          "File: src/Seeder/Configurations/FixedMenuItemSeeder.php -> src/Seeder/Configurations/FixedMenuItemSeeder.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "139:                 10 => [",
          "140:                     'menu_id' => $menu_core,",
          "141:                     'title' => 'Media Manager',",
          "143:                     'target' => '_self',",
          "147:                     'order' => 10,",
          "149:                 ],",
          "150:                 11 => [",
          "151:                     'menu_id' => $menu_core,",
          "",
          "[Removed Lines]",
          "142:                     'url' => '#',",
          "144:                     'icon_class' => '',",
          "145:                     'color' => '',",
          "146:                     'parent_id' => null,",
          "148:                     'permissions' => '',",
          "",
          "[Added Lines]",
          "142:                     'url' => '/#',",
          "144:                     'icon_class' => 'folder_open',",
          "145:                     'color' => NULL,",
          "146:                     'parent_id' => NULL,",
          "148:                     'is_expand' => 1,",
          "149:                     'permissions' => NULL,",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b98eb0491c09f6faaccd136d2263a8650b952802",
      "candidate_info": {
        "commit_hash": "b98eb0491c09f6faaccd136d2263a8650b952802",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/b98eb0491c09f6faaccd136d2263a8650b952802",
        "files": [
          "CONTRIBUTING.md",
          "composer.json",
          "src/Controllers/BadasoAuthController.php",
          "src/Models/User.php"
        ],
        "message": "update laravel v9",
        "before_after_code_files": [
          "src/Controllers/BadasoAuthController.php||src/Controllers/BadasoAuthController.php",
          "src/Models/User.php||src/Models/User.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Controllers/BadasoAuthController.php||src/Controllers/BadasoAuthController.php": [
          "File: src/Controllers/BadasoAuthController.php -> src/Controllers/BadasoAuthController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: use Illuminate\\Support\\Facades\\Hash;",
          "10: use Illuminate\\Support\\Facades\\Mail;",
          "11: use stdClass;",
          "13: use Uasoft\\Badaso\\Exceptions\\SingleException;",
          "14: use Uasoft\\Badaso\\Facades\\Badaso;",
          "15: use Uasoft\\Badaso\\Helpers\\ApiResponse;",
          "",
          "[Removed Lines]",
          "12: use Tymon\\JWTAuth\\Exceptions\\JWTException;",
          "",
          "[Added Lines]",
          "12: use PHPOpenSourceSaver\\JWTAuth\\Exceptions\\JWTException;",
          "",
          "---------------"
        ],
        "src/Models/User.php||src/Models/User.php": [
          "File: src/Models/User.php -> src/Models/User.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: use Illuminate\\Foundation\\Auth\\User as Authenticatable;",
          "7: use Illuminate\\Notifications\\Notifiable;",
          "8: use Laravel\\Sanctum\\HasApiTokens;",
          "9: use Spatie\\Activitylog\\LogOptions;",
          "10: use Spatie\\Activitylog\\Traits\\LogsActivity;",
          "13: {",
          "15:     use HasApiTokens, HasFactory, Notifiable, LogsActivity;",
          "",
          "[Removed Lines]",
          "12: class User extends Authenticatable",
          "",
          "[Added Lines]",
          "9: use PHPOpenSourceSaver\\JWTAuth\\Contracts\\JWTSubject;",
          "13: class User extends Authenticatable implements JWTSubject",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88:     public function getActivitylogOptions(): LogOptions {",
          "89:         return LogOptions::defaults();",
          "90:     }",
          "91: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "98:     public function getJWTIdentifier()",
          "99:     {",
          "100:         return $this->getKey();",
          "101:     }",
          "108:     public function getJWTCustomClaims()",
          "109:     {",
          "110:         return [];",
          "111:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}