{
  "cve_id": "CVE-2021-27906",
  "cve_desc": "A carefully crafted PDF file can trigger an OutOfMemory-Exception while loading the file. This issue affects Apache PDFBox version 2.0.22 and prior 2.0.x versions.",
  "repo": "apache/pdfbox",
  "patch_hash": "8c47be1011c11dc47300faecffd8ab32fba3646f",
  "patch_info": {
    "commit_hash": "8c47be1011c11dc47300faecffd8ab32fba3646f",
    "repo": "apache/pdfbox",
    "commit_url": "https://github.com/apache/pdfbox/commit/8c47be1011c11dc47300faecffd8ab32fba3646f",
    "files": [
      "pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java"
    ],
    "message": "PDFBOX-5112: SonarCube fix, throw NoSuchElementException if no more elements are available\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1887295 13f79535-47bb-0310-9956-ffa450edef68",
    "before_after_code_files": [
      "pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java||pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java"
    ]
  },
  "patch_diff": {
    "pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java||pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java": [
      "File: pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java -> pdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFXrefStreamParser.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: import java.io.IOException;",
      "20: import java.util.Arrays;",
      "21: import java.util.Iterator;",
      "23: import org.apache.pdfbox.cos.COSArray;",
      "24: import org.apache.pdfbox.cos.COSBase;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "22: import java.util.NoSuchElementException;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "212:         @Override",
      "213:         public Long next()",
      "214:         {",
      "215:             if (currentNumber < currentEnd)",
      "216:             {",
      "217:                 return currentNumber++;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "216:             if (currentNumber >= maxValue)",
      "217:             {",
      "218:                 throw new NoSuchElementException();",
      "219:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "581b27f7c0e9d26388b27b5d7826c4d42a8c2fea",
      "candidate_info": {
        "commit_hash": "581b27f7c0e9d26388b27b5d7826c4d42a8c2fea",
        "repo": "apache/pdfbox",
        "commit_url": "https://github.com/apache/pdfbox/commit/581b27f7c0e9d26388b27b5d7826c4d42a8c2fea",
        "files": [
          "pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java",
          "pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java"
        ],
        "message": "PDFBOX-5046: catch more empty dates\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1884415 13f79535-47bb-0310-9956-ffa450edef68",
        "before_after_code_files": [
          "pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java||pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java",
          "pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java||pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/pdfbox/pull/104"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java||pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java": [
          "File: pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java -> pdfbox/src/main/java/org/apache/pdfbox/util/DateConverter.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "616:     private static Calendar parseDate(String text, ParsePosition initialWhere)",
          "617:     {",
          "619:         {",
          "620:             return null;",
          "621:         }",
          "",
          "[Removed Lines]",
          "618:         if (text == null || text.isEmpty())",
          "",
          "[Added Lines]",
          "618:         if (text == null || text.isEmpty() || \"D:\".equals(text.trim()))",
          "",
          "---------------"
        ],
        "pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java||pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java": [
          "File: pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java -> pdfbox/src/test/java/org/apache/pdfbox/util/TestDateUtil.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:         assertNull(DateConverter.toCalendar((COSString) null));",
          "341:         assertNull(DateConverter.toCalendar((String) null));",
          "343:         checkToString(2013, 8, 28, 3, 14, 15, tzPgh, -4, 0);",
          "344:         checkToString(2014, 2, 28, 3, 14, 15, tzPgh, -5, 0);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "342:         assertNull(DateConverter.toCalendar(\"D:    \"));",
          "343:         assertNull(DateConverter.toCalendar(\"D:\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9ce22324af6e0a16f10ef0363e94454ee64171f0",
      "candidate_info": {
        "commit_hash": "9ce22324af6e0a16f10ef0363e94454ee64171f0",
        "repo": "apache/pdfbox",
        "commit_url": "https://github.com/apache/pdfbox/commit/9ce22324af6e0a16f10ef0363e94454ee64171f0",
        "files": [
          "pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java"
        ],
        "message": "PDFBOX-5190: remove test due to reverting the changes on COSName\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1889734 13f79535-47bb-0310-9956-ffa450edef68",
        "before_after_code_files": [
          "pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java||pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/pdfbox/pull/104"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java||pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java": [
          "File: pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java -> pdfbox/src/test/java/org/apache/pdfbox/cos/TestCOSName.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "50:         document.close();",
          "51:     }",
          "60: }",
          "",
          "[Removed Lines]",
          "53:     @Test",
          "54:     public void testEmptyName()",
          "55:     {",
          "56:         assertNull(null);",
          "57:         assertNull(COSName.getPDFName(\"\"));",
          "58:     }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9458ff5154d75a3a8866ab6327c3bd68ec5b61cf",
      "candidate_info": {
        "commit_hash": "9458ff5154d75a3a8866ab6327c3bd68ec5b61cf",
        "repo": "apache/pdfbox",
        "commit_url": "https://github.com/apache/pdfbox/commit/9458ff5154d75a3a8866ab6327c3bd68ec5b61cf",
        "files": [
          "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java"
        ],
        "message": "PDFBOX-4892: improve javadoc\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1891510 13f79535-47bb-0310-9956-ffa450edef68",
        "before_after_code_files": [
          "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java||pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/pdfbox/pull/104"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java||pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java": [
          "File: pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java -> pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PageLayout.java"
        ]
      }
    },
    {
      "candidate_hash": "bef32ecfa20e36967b8c8e48d223a4e9cadfa08b",
      "candidate_info": {
        "commit_hash": "bef32ecfa20e36967b8c8e48d223a4e9cadfa08b",
        "repo": "apache/pdfbox",
        "commit_url": "https://github.com/apache/pdfbox/commit/bef32ecfa20e36967b8c8e48d223a4e9cadfa08b",
        "files": [
          "preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java"
        ],
        "message": "PDFBOX-4892: fix typo, as suggested by valerybokov\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1891929 13f79535-47bb-0310-9956-ffa450edef68",
        "before_after_code_files": [
          "preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java||preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/pdfbox/pull/104"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java||preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java": [
          "File: preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java -> preflight/src/main/java/org/apache/pdfbox/preflight/PreflightConfiguration.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:     public static final String GRAPHIC_PROCESS = \"graphic-process\";",
          "77:     public static final String FONT_PROCESS = \"font-process\";",
          "78:     public static final String EXTGSTATE_PROCESS = \"extgstate-process\";",
          "80:     public static final String TILING_PATTERN_PROCESS = \"tiling-pattern-process\";",
          "81:     public static final String DESTINATION_PROCESS = \"destination-process\";",
          "",
          "[Removed Lines]",
          "79:     public static final String SHADING_PATTERN_PROCESS = \"shadding-pattern-process\";",
          "",
          "[Added Lines]",
          "79:     public static final String SHADING_PATTERN_PROCESS = \"shading-pattern-process\";",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "259a90c0f8458cf067cd6344d832e3e1a300b87a",
      "candidate_info": {
        "commit_hash": "259a90c0f8458cf067cd6344d832e3e1a300b87a",
        "repo": "apache/pdfbox",
        "commit_url": "https://github.com/apache/pdfbox/commit/259a90c0f8458cf067cd6344d832e3e1a300b87a",
        "files": [
          "examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java"
        ],
        "message": "PDFBOX-4297: remove unused import\n\ngit-svn-id: https://svn.apache.org/repos/asf/pdfbox/branches/2.0@1882388 13f79535-47bb-0310-9956-ffa450edef68",
        "before_after_code_files": [
          "examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java||examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/pdfbox/pull/104"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java||examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java": [
          "File: examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java -> examples/src/test/java/org/apache/pdfbox/examples/pdmodel/TestCreateSignature.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "54: import org.apache.pdfbox.cos.COSInputStream;",
          "55: import org.apache.pdfbox.cos.COSName;",
          "56: import org.apache.pdfbox.cos.COSStream;",
          "58: import org.apache.pdfbox.examples.interactive.form.CreateSimpleForm;",
          "59: import org.apache.pdfbox.examples.signature.CreateEmbeddedTimeStamp;",
          "60: import org.apache.pdfbox.examples.signature.CreateEmptySignatureForm;",
          "",
          "[Removed Lines]",
          "57: import org.apache.pdfbox.cos.COSString;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}