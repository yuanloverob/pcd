{
  "cve_id": "CVE-2024-1726",
  "cve_desc": "A flaw was discovered in the RESTEasy Reactive implementation in Quarkus. Due to security checks for some JAX-RS endpoints being performed after serialization, more processing resources are consumed while the HTTP request is checked. In certain configurations, if an attacker has knowledge of any POST, PUT, or PATCH request paths, they can potentially identify vulnerable endpoints and trigger excessive resource usage as the endpoints process the requests. This can result in a denial of service.",
  "repo": "quarkusio/quarkus",
  "patch_hash": "34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
  "patch_info": {
    "commit_hash": "34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
    "repo": "quarkusio/quarkus",
    "commit_url": "https://github.com/quarkusio/quarkus/commit/34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
    "files": [
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
    ],
    "message": "Perform security checks eagerly in RR on inherited endpoints\n\n(cherry picked from commit 37834cb44a0bc5101cdf60922c8dd0301efac822)",
    "before_after_code_files": [
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
    ]
  },
  "patch_diff": {
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "91:         assertStatus(path, 403, 401);",
      "92:     }",
      "94:     @Test",
      "95:     public void shouldDenyUnannotatedOnInterface() {",
      "96:         String path = \"/unsecured/defaultSecurityInterface\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "94:     @Test",
      "95:     public void shouldAllowAnnotatedParentEndpoint() {",
      "97:         String path = \"/unsecured/parent-annotated\";",
      "98:         assertStatus(path, 200, 401);",
      "99:     }",
      "101:     @Test",
      "102:     public void shouldAllowAnnotatedEndpointOnInterface() {",
      "104:         String path = \"/unsecured/interface-annotated\";",
      "105:         assertStatus(path, 200, 401);",
      "106:     }",
      "108:     @Test",
      "109:     public void shouldDenyUnannotatedOverriddenOnInterfaceImplementor() {",
      "111:         String path = \"/unsecured/interface-overridden-declared-on-implementor\";",
      "112:         assertStatus(path, 403, 401);",
      "113:     }",
      "115:     @Test",
      "116:     public void shouldAllowAnnotatedOverriddenEndpointDeclaredOnInterface() {",
      "118:         String path = \"/unsecured/interface-overridden-declared-on-interface\";",
      "119:         assertStatus(path, 200, 401);",
      "121:         given().auth().preemptive()",
      "122:                 .basic(\"admin\", \"admin\").get(path)",
      "123:                 .then()",
      "124:                 .body(Matchers.is(\"implementor-response\"));",
      "125:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: package io.quarkus.resteasy.reactive.server.test.security;",
      "3: import jakarta.ws.rs.GET;",
      "4: import jakarta.ws.rs.Path;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: import jakarta.annotation.security.RolesAllowed;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11:         return \"defaultSecurityParent\";",
      "12:     }",
      "14: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "15:     @RolesAllowed({ \"admin\", \"user\" })",
      "16:     @GET",
      "17:     @Path(\"/parent-annotated\")",
      "18:     public String parentAnnotated() {",
      "19:         return \"parent-annotated\";",
      "20:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "57:     public UnsecuredSubResource permitAllSub() {",
      "58:         return new UnsecuredSubResource();",
      "59:     }",
      "60: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61:     @Override",
      "62:     public String interfaceOverriddenDeclaredOnInterface() {",
      "63:         return \"implementor-response\";",
      "64:     }",
      "66:     @GET",
      "67:     @Path(\"/interface-overridden-declared-on-implementor\")",
      "68:     @Override",
      "69:     public String interfaceOverriddenDeclaredOnImplementor() {",
      "70:         return \"implementor-response\";",
      "71:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: package io.quarkus.resteasy.reactive.server.test.security;",
      "3: import jakarta.ws.rs.GET;",
      "4: import jakarta.ws.rs.Path;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: import jakarta.annotation.security.RolesAllowed;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11:         return \"defaultSecurityInterface\";",
      "12:     }",
      "14: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "15:     @RolesAllowed({ \"admin\", \"user\" })",
      "16:     @GET",
      "17:     @Path(\"/interface-annotated\")",
      "18:     default String interfaceAnnotated() {",
      "19:         return \"interface-annotated\";",
      "20:     }",
      "22:     @RolesAllowed({ \"admin\", \"user\" })",
      "23:     @GET",
      "24:     @Path(\"/interface-overridden-declared-on-interface\")",
      "25:     default String interfaceOverriddenDeclaredOnInterface() {",
      "27:         return \"interface-overridden-declared-on-interface\";",
      "28:     }",
      "30:     @RolesAllowed({ \"admin\", \"user\" })",
      "31:     @GET",
      "32:     @Path(\"/interface-overridden-declared-on-implementor\")",
      "33:     default String interfaceOverriddenDeclaredOnImplementor() {",
      "35:         return \"interface-overridden-declared-on-implementor\";",
      "36:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "187:     }",
      "189:     static MethodDescription lazyMethodToMethodDescription(ResteasyReactiveResourceInfo lazyMethod) {",
      "191:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
      "192:     }",
      "",
      "[Removed Lines]",
      "190:         return new MethodDescription(lazyMethod.getResourceClass().getName(),",
      "",
      "[Added Lines]",
      "190:         return new MethodDescription(lazyMethod.getActualDeclaringClassName(),",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java": [
      "File: independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java -> independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "183:             }",
      "184:         }",
      "185:         serverResourceMethod.setHandlerChainCustomizers(methodCustomizers);",
      "186:         return serverResourceMethod;",
      "187:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "186:         serverResourceMethod.setActualDeclaringClassName(methodInfo.declaringClass().name().toString());",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "190:         ResteasyReactiveResourceInfo lazyMethod = new ResteasyReactiveResourceInfo(method.getName(), resourceClass,",
      "191:                 parameterDeclaredUnresolvedTypes, classAnnotationNames, method.getMethodAnnotationNames(),",
      "194:         RuntimeInterceptorDeployment.MethodInterceptorContext interceptorDeployment = runtimeInterceptorDeployment",
      "195:                 .forMethod(method, lazyMethod);",
      "",
      "[Removed Lines]",
      "192:                 !defaultBlocking && !method.isBlocking());",
      "",
      "[Added Lines]",
      "192:                 !defaultBlocking && !method.isBlocking(), method.getActualDeclaringClassName());",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "19:     private List<HandlerChainCustomizer> handlerChainCustomizers = new ArrayList<>();",
      "20:     private ParameterExtractor customerParameterExtractor;",
      "22:     public ServerResourceMethod() {",
      "23:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "21:     private String actualDeclaringClassName;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "70:         this.customerParameterExtractor = customerParameterExtractor;",
      "71:         return this;",
      "72:     }",
      "73: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "75:     public String getActualDeclaringClassName() {",
      "76:         return actualDeclaringClassName;",
      "77:     }",
      "79:     public void setActualDeclaringClassName(String actualDeclaringClassName) {",
      "80:         this.actualDeclaringClassName = actualDeclaringClassName;",
      "81:     }",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "28:     public final boolean isNonBlocking;",
      "30:     private volatile Annotation[] classAnnotations;",
      "31:     private volatile Method method;",
      "32:     private volatile Annotation[] annotations;",
      "33:     private volatile Type returnType;",
      "34:     private volatile String methodId;",
      "36:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
      "37:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking) {",
      "38:         this.name = name;",
      "39:         this.declaringClass = declaringClass;",
      "40:         this.parameterTypes = parameterTypes;",
      "41:         this.classAnnotationNames = classAnnotationNames;",
      "42:         this.methodAnnotationNames = methodAnnotationNames;",
      "43:         this.isNonBlocking = isNonBlocking;",
      "44:     }",
      "46:     public String getName() {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32:     private final String actualDeclaringClassName;",
      "39:     @Deprecated",
      "42:         this(name, declaringClass, parameterTypes, classAnnotationNames, methodAnnotationNames, isNonBlocking,",
      "43:                 declaringClass.getName());",
      "44:     }",
      "46:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
      "47:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking,",
      "48:             String actualDeclaringClassName) {",
      "55:         this.actualDeclaringClassName = actualDeclaringClassName;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "119:         }",
      "120:         return methodId;",
      "121:     }",
      "122: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "135:     public String getActualDeclaringClassName() {",
      "136:         return actualDeclaringClassName;",
      "137:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "37834cb44a0bc5101cdf60922c8dd0301efac822",
      "candidate_info": {
        "commit_hash": "37834cb44a0bc5101cdf60922c8dd0301efac822",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/37834cb44a0bc5101cdf60922c8dd0301efac822",
        "files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ],
        "message": "Perform security checks eagerly in RR on inherited endpoints",
        "before_after_code_files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_cherry_pick": 1,
        "olp_code_files": {
          "patch": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ],
          "candidate": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ]
        }
      },
      "candidate_diff": {
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "91:         assertStatus(path, 403, 401);",
          "92:     }",
          "94:     @Test",
          "95:     public void shouldDenyUnannotatedOnInterface() {",
          "96:         String path = \"/unsecured/defaultSecurityInterface\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "94:     @Test",
          "95:     public void shouldAllowAnnotatedParentEndpoint() {",
          "97:         String path = \"/unsecured/parent-annotated\";",
          "98:         assertStatus(path, 200, 401);",
          "99:     }",
          "101:     @Test",
          "102:     public void shouldAllowAnnotatedEndpointOnInterface() {",
          "104:         String path = \"/unsecured/interface-annotated\";",
          "105:         assertStatus(path, 200, 401);",
          "106:     }",
          "108:     @Test",
          "109:     public void shouldDenyUnannotatedOverriddenOnInterfaceImplementor() {",
          "111:         String path = \"/unsecured/interface-overridden-declared-on-implementor\";",
          "112:         assertStatus(path, 403, 401);",
          "113:     }",
          "115:     @Test",
          "116:     public void shouldAllowAnnotatedOverriddenEndpointDeclaredOnInterface() {",
          "118:         String path = \"/unsecured/interface-overridden-declared-on-interface\";",
          "119:         assertStatus(path, 200, 401);",
          "121:         given().auth().preemptive()",
          "122:                 .basic(\"admin\", \"admin\").get(path)",
          "123:                 .then()",
          "124:                 .body(Matchers.is(\"implementor-response\"));",
          "125:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import jakarta.ws.rs.GET;",
          "4: import jakarta.ws.rs.Path;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import jakarta.annotation.security.RolesAllowed;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11:         return \"defaultSecurityParent\";",
          "12:     }",
          "14: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/parent-annotated\")",
          "18:     public String parentAnnotated() {",
          "19:         return \"parent-annotated\";",
          "20:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:     public UnsecuredSubResource permitAllSub() {",
          "58:         return new UnsecuredSubResource();",
          "59:     }",
          "60: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61:     @Override",
          "62:     public String interfaceOverriddenDeclaredOnInterface() {",
          "63:         return \"implementor-response\";",
          "64:     }",
          "66:     @GET",
          "67:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "68:     @Override",
          "69:     public String interfaceOverriddenDeclaredOnImplementor() {",
          "70:         return \"implementor-response\";",
          "71:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import jakarta.ws.rs.GET;",
          "4: import jakarta.ws.rs.Path;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import jakarta.annotation.security.RolesAllowed;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11:         return \"defaultSecurityInterface\";",
          "12:     }",
          "14: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/interface-annotated\")",
          "18:     default String interfaceAnnotated() {",
          "19:         return \"interface-annotated\";",
          "20:     }",
          "22:     @RolesAllowed({ \"admin\", \"user\" })",
          "23:     @GET",
          "24:     @Path(\"/interface-overridden-declared-on-interface\")",
          "25:     default String interfaceOverriddenDeclaredOnInterface() {",
          "27:         return \"interface-overridden-declared-on-interface\";",
          "28:     }",
          "30:     @RolesAllowed({ \"admin\", \"user\" })",
          "31:     @GET",
          "32:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "33:     default String interfaceOverriddenDeclaredOnImplementor() {",
          "35:         return \"interface-overridden-declared-on-implementor\";",
          "36:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "187:     }",
          "189:     static MethodDescription lazyMethodToMethodDescription(ResteasyReactiveResourceInfo lazyMethod) {",
          "191:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
          "192:     }",
          "",
          "[Removed Lines]",
          "190:         return new MethodDescription(lazyMethod.getResourceClass().getName(),",
          "",
          "[Added Lines]",
          "190:         return new MethodDescription(lazyMethod.getActualDeclaringClassName(),",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java": [
          "File: independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java -> independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "183:             }",
          "184:         }",
          "185:         serverResourceMethod.setHandlerChainCustomizers(methodCustomizers);",
          "186:         return serverResourceMethod;",
          "187:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "186:         serverResourceMethod.setActualDeclaringClassName(methodInfo.declaringClass().name().toString());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "190:         ResteasyReactiveResourceInfo lazyMethod = new ResteasyReactiveResourceInfo(method.getName(), resourceClass,",
          "191:                 parameterDeclaredUnresolvedTypes, classAnnotationNames, method.getMethodAnnotationNames(),",
          "194:         RuntimeInterceptorDeployment.MethodInterceptorContext interceptorDeployment = runtimeInterceptorDeployment",
          "195:                 .forMethod(method, lazyMethod);",
          "",
          "[Removed Lines]",
          "192:                 !defaultBlocking && !method.isBlocking());",
          "",
          "[Added Lines]",
          "192:                 !defaultBlocking && !method.isBlocking(), method.getActualDeclaringClassName());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     private List<HandlerChainCustomizer> handlerChainCustomizers = new ArrayList<>();",
          "20:     private ParameterExtractor customerParameterExtractor;",
          "22:     public ServerResourceMethod() {",
          "23:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21:     private String actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "70:         this.customerParameterExtractor = customerParameterExtractor;",
          "71:         return this;",
          "72:     }",
          "73: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75:     public String getActualDeclaringClassName() {",
          "76:         return actualDeclaringClassName;",
          "77:     }",
          "79:     public void setActualDeclaringClassName(String actualDeclaringClassName) {",
          "80:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "81:     }",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:     public final boolean isNonBlocking;",
          "30:     private volatile Annotation[] classAnnotations;",
          "31:     private volatile Method method;",
          "32:     private volatile Annotation[] annotations;",
          "33:     private volatile Type returnType;",
          "34:     private volatile String methodId;",
          "36:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "37:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking) {",
          "38:         this.name = name;",
          "39:         this.declaringClass = declaringClass;",
          "40:         this.parameterTypes = parameterTypes;",
          "41:         this.classAnnotationNames = classAnnotationNames;",
          "42:         this.methodAnnotationNames = methodAnnotationNames;",
          "43:         this.isNonBlocking = isNonBlocking;",
          "44:     }",
          "46:     public String getName() {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:     private final String actualDeclaringClassName;",
          "39:     @Deprecated",
          "42:         this(name, declaringClass, parameterTypes, classAnnotationNames, methodAnnotationNames, isNonBlocking,",
          "43:                 declaringClass.getName());",
          "44:     }",
          "46:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "47:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking,",
          "48:             String actualDeclaringClassName) {",
          "55:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "119:         }",
          "120:         return methodId;",
          "121:     }",
          "122: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "135:     public String getActualDeclaringClassName() {",
          "136:         return actualDeclaringClassName;",
          "137:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7de30572eb49c10fab6e55222d4ef0d4cb0254b3",
      "candidate_info": {
        "commit_hash": "7de30572eb49c10fab6e55222d4ef0d4cb0254b3",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/7de30572eb49c10fab6e55222d4ef0d4cb0254b3",
        "files": [
          "extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java",
          "extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java",
          "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java",
          "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java"
        ],
        "message": "Propagate Vert.x context on all ExecutorService methods for VirtualThreadExecutor\n\n(cherry picked from commit 1ea93ccfd20089fc9e5781749fe9fb9184cfa984)",
        "before_after_code_files": [
          "extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java||extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java",
          "extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java||extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java",
          "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java||integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java",
          "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java||integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/quarkusio/quarkus/pull/38864"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java||extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java": [
          "File: extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java -> extensions/virtual-threads/runtime/src/main/java/io/quarkus/virtual/threads/ContextPreservingExecutorService.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import java.util.Collection;",
          "4: import java.util.List;",
          "5: import java.util.concurrent.Callable;",
          "6: import java.util.concurrent.ExecutionException;",
          "7: import java.util.concurrent.ExecutorService;",
          "8: import java.util.concurrent.Future;",
          "9: import java.util.concurrent.TimeUnit;",
          "10: import java.util.concurrent.TimeoutException;",
          "12: import io.vertx.core.Vertx;",
          "13: import io.vertx.core.impl.ContextInternal;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: import java.util.Objects;",
          "9: import java.util.concurrent.Executors;",
          "13: import java.util.stream.Collectors;",
          "15: import io.vertx.core.Context;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:         this.delegate = delegate;",
          "23:     }",
          "40:                 }",
          "42:         }",
          "43:     }",
          "45:     public boolean isShutdown() {",
          "46:         return delegate.isShutdown();",
          "47:     }",
          "",
          "[Removed Lines]",
          "25:     public void execute(final Runnable command) {",
          "26:         var context = Vertx.currentContext();",
          "27:         if (!(context instanceof ContextInternal)) {",
          "28:             delegate.execute(command);",
          "29:         } else {",
          "30:             ContextInternal contextInternal = (ContextInternal) context;",
          "31:             delegate.execute(new Runnable() {",
          "32:                 @Override",
          "33:                 public void run() {",
          "34:                     final var previousContext = contextInternal.beginDispatch();",
          "35:                     try {",
          "36:                         command.run();",
          "37:                     } finally {",
          "38:                         contextInternal.endDispatch(previousContext);",
          "39:                     }",
          "41:             });",
          "",
          "[Added Lines]",
          "29:     private static final class ContextPreservingRunnable implements Runnable {",
          "31:         private final Runnable task;",
          "32:         private final Context context;",
          "34:         public ContextPreservingRunnable(Runnable task) {",
          "35:             this.task = task;",
          "36:             this.context = Vertx.currentContext();",
          "37:         }",
          "39:         @Override",
          "40:         public void run() {",
          "41:             if (context instanceof ContextInternal) {",
          "42:                 ContextInternal contextInternal = (ContextInternal) context;",
          "43:                 final var previousContext = contextInternal.beginDispatch();",
          "44:                 try {",
          "45:                     task.run();",
          "46:                 } finally {",
          "47:                     contextInternal.endDispatch(previousContext);",
          "48:                 }",
          "49:             } else {",
          "50:                 task.run();",
          "51:             }",
          "52:         }",
          "53:     }",
          "55:     private static final class ContextPreservingCallable<T> implements Callable<T> {",
          "57:         private final Callable<T> task;",
          "58:         private final Context context;",
          "60:         public ContextPreservingCallable(Callable<T> task) {",
          "61:             this.task = task;",
          "62:             this.context = Vertx.currentContext();",
          "63:         }",
          "65:         @Override",
          "66:         public T call() throws Exception {",
          "67:             if (context instanceof ContextInternal) {",
          "68:                 ContextInternal contextInternal = (ContextInternal) context;",
          "69:                 final var previousContext = contextInternal.beginDispatch();",
          "70:                 try {",
          "71:                     return task.call();",
          "72:                 } finally {",
          "73:                     contextInternal.endDispatch(previousContext);",
          "75:             } else {",
          "76:                 return task.call();",
          "77:             }",
          "81:     private static Runnable decorate(Runnable command) {",
          "82:         Objects.requireNonNull(command);",
          "83:         return new ContextPreservingRunnable(command);",
          "84:     }",
          "86:     private static <T> Callable<T> decorate(Callable<T> task) {",
          "87:         Objects.requireNonNull(task);",
          "88:         return new ContextPreservingCallable<>(task);",
          "89:     }",
          "91:     private static <T> Collection<? extends Callable<T>> decorateAll(Collection<? extends Callable<T>> tasks) {",
          "92:         Objects.requireNonNull(tasks);",
          "93:         return tasks.stream().map(ContextPreservingExecutorService::decorate).collect(Collectors.toList());",
          "94:     }",
          "96:     public void execute(final Runnable command) {",
          "97:         delegate.execute(decorate(command));",
          "98:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "57:     @Override",
          "58:     public <T> Future<T> submit(Callable<T> task) {",
          "60:     }",
          "62:     @Override",
          "63:     public <T> Future<T> submit(Runnable task, T result) {",
          "65:     }",
          "67:     @Override",
          "68:     public Future<?> submit(Runnable task) {",
          "70:     }",
          "72:     @Override",
          "73:     public <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks) throws InterruptedException {",
          "75:     }",
          "77:     @Override",
          "78:     public <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)",
          "79:             throws InterruptedException {",
          "81:     }",
          "83:     @Override",
          "84:     public <T> T invokeAny(Collection<? extends Callable<T>> tasks) throws InterruptedException, ExecutionException {",
          "86:     }",
          "88:     @Override",
          "89:     public <T> T invokeAny(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)",
          "90:             throws InterruptedException, ExecutionException, TimeoutException {",
          "92:     }",
          "94:     public void shutdown() {",
          "",
          "[Removed Lines]",
          "59:         return delegate.submit(task);",
          "64:         return delegate.submit(task, result);",
          "69:         return delegate.submit(task);",
          "74:         return delegate.invokeAll(tasks);",
          "80:         return delegate.invokeAll(tasks, timeout, unit);",
          "85:         return delegate.invokeAny(tasks);",
          "91:         return delegate.invokeAny(tasks, timeout, unit);",
          "",
          "[Added Lines]",
          "114:         return delegate.submit(decorate(task));",
          "119:         return submit(Executors.callable(task, result));",
          "124:         return delegate.submit(decorate(task));",
          "129:         return delegate.invokeAll(decorateAll(tasks));",
          "135:         return delegate.invokeAll(decorateAll(tasks), timeout, unit);",
          "140:         return delegate.invokeAny(decorateAll(tasks));",
          "146:         return delegate.invokeAny(decorateAll(tasks), timeout, unit);",
          "",
          "---------------"
        ],
        "extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java||extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java": [
          "File: extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java -> extensions/virtual-threads/runtime/src/test/java/io/quarkus/virtual/threads/VirtualThreadExecutorSupplierTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: import java.lang.reflect.InvocationTargetException;",
          "6: import java.lang.reflect.Method;",
          "7: import java.time.Duration;",
          "8: import java.util.concurrent.Executor;",
          "10: import org.junit.jupiter.api.Test;",
          "11: import org.junit.jupiter.api.condition.EnabledForJreRange;",
          "12: import org.junit.jupiter.api.condition.JRE;",
          "14: import io.smallrye.mutiny.Uni;",
          "15: import io.smallrye.mutiny.helpers.test.UniAssertSubscriber;",
          "17: class VirtualThreadExecutorSupplierTest {",
          "19:     @Test",
          "20:     @EnabledForJreRange(min = JRE.JAVA_20, disabledReason = \"Virtual Threads are a preview feature starting from Java 20\")",
          "21:     void virtualThreadCustomScheduler()",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: import java.util.List;",
          "9: import java.util.Optional;",
          "10: import java.util.concurrent.Callable;",
          "11: import java.util.concurrent.CompletableFuture;",
          "12: import java.util.concurrent.ExecutionException;",
          "14: import java.util.concurrent.ExecutorService;",
          "15: import java.util.concurrent.Future;",
          "17: import org.junit.jupiter.api.BeforeEach;",
          "24: import io.vertx.core.Context;",
          "25: import io.vertx.core.Vertx;",
          "29:     @BeforeEach",
          "30:     void configRecorder() {",
          "31:         VirtualThreadsRecorder.config = new VirtualThreadsConfig();",
          "32:         VirtualThreadsRecorder.config.enabled = true;",
          "33:         VirtualThreadsRecorder.config.namePrefix = Optional.empty();",
          "34:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "44:         assertSubscriber.awaitItem(Duration.ofSeconds(1)).assertCompleted();",
          "45:     }",
          "47:     public static void assertThatItRunsOnVirtualThread() {",
          "49:         try {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "64:     @Test",
          "65:     @EnabledForJreRange(min = JRE.JAVA_20, disabledReason = \"Virtual Threads are a preview feature starting from Java 20\")",
          "66:     void executePropagatesVertxContext() throws ExecutionException, InterruptedException {",
          "67:         ExecutorService executorService = VirtualThreadsRecorder.getCurrent();",
          "68:         Vertx vertx = Vertx.vertx();",
          "69:         CompletableFuture<Context> future = new CompletableFuture<>();",
          "70:         vertx.executeBlocking(() -> {",
          "71:             executorService.execute(() -> {",
          "72:                 assertThatItRunsOnVirtualThread();",
          "73:                 future.complete(Vertx.currentContext());",
          "74:             });",
          "75:             return null;",
          "76:         }).toCompletionStage().toCompletableFuture().get();",
          "77:         assertThat(future.get()).isNotNull();",
          "78:     }",
          "80:     @Test",
          "81:     @EnabledForJreRange(min = JRE.JAVA_20, disabledReason = \"Virtual Threads are a preview feature starting from Java 20\")",
          "82:     void executePropagatesVertxContextMutiny() {",
          "83:         ExecutorService executorService = VirtualThreadsRecorder.getCurrent();",
          "84:         Vertx vertx = Vertx.vertx();",
          "85:         var assertSubscriber = Uni.createFrom().voidItem()",
          "86:                 .runSubscriptionOn(command -> vertx.executeBlocking(() -> {",
          "87:                     command.run();",
          "88:                     return null;",
          "89:                 }))",
          "90:                 .emitOn(executorService)",
          "91:                 .map(x -> {",
          "92:                     assertThatItRunsOnVirtualThread();",
          "93:                     return Vertx.currentContext();",
          "94:                 })",
          "95:                 .subscribe().withSubscriber(UniAssertSubscriber.create());",
          "96:         assertThat(assertSubscriber.awaitItem().assertCompleted().getItem()).isNotNull();",
          "97:     }",
          "99:     @Test",
          "100:     @EnabledForJreRange(min = JRE.JAVA_20, disabledReason = \"Virtual Threads are a preview feature starting from Java 20\")",
          "101:     void submitPropagatesVertxContext() throws ExecutionException, InterruptedException {",
          "102:         ExecutorService executorService = VirtualThreadsRecorder.getCurrent();",
          "103:         Vertx vertx = Vertx.vertx();",
          "104:         CompletableFuture<Context> future = new CompletableFuture<>();",
          "105:         vertx.executeBlocking(() -> {",
          "106:             executorService.submit(() -> {",
          "107:                 assertThatItRunsOnVirtualThread();",
          "108:                 future.complete(Vertx.currentContext());",
          "109:             });",
          "110:             return null;",
          "111:         }).toCompletionStage().toCompletableFuture().get();",
          "112:         assertThat(future.get()).isNotNull();",
          "113:     }",
          "115:     @Test",
          "116:     @EnabledForJreRange(min = JRE.JAVA_20, disabledReason = \"Virtual Threads are a preview feature starting from Java 20\")",
          "117:     void invokeAllPropagatesVertxContext() throws ExecutionException, InterruptedException {",
          "118:         ExecutorService executorService = VirtualThreadsRecorder.getCurrent();",
          "119:         Vertx vertx = Vertx.vertx();",
          "120:         List<Future<Context>> futures = vertx.executeBlocking(() -> {",
          "121:             return executorService.invokeAll(List.of((Callable<Context>) () -> {",
          "122:                 assertThatItRunsOnVirtualThread();",
          "123:                 return Vertx.currentContext();",
          "124:             }, (Callable<Context>) () -> {",
          "125:                 assertThatItRunsOnVirtualThread();",
          "126:                 return Vertx.currentContext();",
          "127:             }));",
          "128:         }).toCompletionStage().toCompletableFuture().get();",
          "129:         assertThat(futures).allSatisfy(contextFuture -> assertThat(contextFuture.get()).isNotNull());",
          "130:     }",
          "",
          "---------------"
        ],
        "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java||integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java": [
          "File: integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java -> integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/FilteredResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.virtual.rr;",
          "3: import jakarta.inject.Inject;",
          "4: import jakarta.ws.rs.GET;",
          "5: import jakarta.ws.rs.Path;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import java.util.concurrent.CompletableFuture;",
          "4: import java.util.concurrent.ExecutionException;",
          "5: import java.util.concurrent.ExecutorService;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "8: import org.jboss.logmanager.MDC;",
          "10: import io.quarkus.test.vertx.VirtualThreadsAssertions;",
          "11: import io.smallrye.common.annotation.RunOnVirtualThread;",
          "12: import io.vertx.core.Vertx;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: import io.quarkus.arc.Arc;",
          "16: import io.quarkus.virtual.threads.VirtualThreads;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "17:     @Inject",
          "18:     Counter counter;",
          "20:     @GET",
          "21:     @RunOnVirtualThread",
          "23:         VirtualThreadsAssertions.assertEverything();",
          "26:         assert counter.increment() == 2;",
          "29:         assert Vertx.currentContext().getLocal(\"filter\").equals(\"test\");",
          "30:         Vertx.currentContext().putLocal(\"test\", \"test test\");",
          "",
          "[Removed Lines]",
          "22:     public Response filtered() {",
          "",
          "[Added Lines]",
          "26:     @Inject",
          "27:     @VirtualThreads",
          "28:     ExecutorService vt;",
          "32:     public Response filtered() throws ExecutionException, InterruptedException {",
          "39:         assert vt.submit(() -> counter.increment()).get() == 3;",
          "42:         assert Arc.container().requestContext().isActive();",
          "43:         assert vt.submit(() -> Arc.container().requestContext().isActive()).get();",
          "45:         CompletableFuture<Boolean> requestContextActive = new CompletableFuture<>();",
          "46:         vt.execute(() -> requestContextActive.complete(Arc.container().requestContext().isActive()));",
          "47:         assert requestContextActive.get();",
          "",
          "---------------"
        ],
        "integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java||integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java": [
          "File: integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java -> integration-tests/virtual-threads/resteasy-reactive-virtual-threads/src/main/java/io/quarkus/virtual/rr/Filters.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:         if (responseContext.getHeaders().get(\"X-filter\") != null) {",
          "28:             VirtualThreadsAssertions.assertEverything();",
          "31:             assert Vertx.currentContext().getLocal(\"test\").equals(\"test test\");",
          "32:             assert MDC.get(\"mdc\").equals(\"test test\");",
          "33:         }",
          "",
          "[Removed Lines]",
          "30:             assert CDI.current().select(Counter.class).get().increment() == 3;",
          "",
          "[Added Lines]",
          "30:             assert CDI.current().select(Counter.class).get().increment() == 4;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "659e474197d4f1ece17acdda0001077d6128b440",
      "candidate_info": {
        "commit_hash": "659e474197d4f1ece17acdda0001077d6128b440",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/659e474197d4f1ece17acdda0001077d6128b440",
        "files": [
          "extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java"
        ],
        "message": "Make registration of OAuthBearerValidatorCallbackHandler conditional\n\n`org.apache.kafka.common.security.oauthbearer.OAuthBearerValidatorCallbackHandler`\ndepends on the optional\n`org.jose4j.keys.resolvers.VerificationKeyResolver` so it should only be\nregistered when the latter is present, similarly to\n`org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerValidatorCallbackHandler`\n\nCloses https://github.com/quarkusio/quarkus/issues/38851\n\n(cherry picked from commit d88e0bda8f67e8ab2fcd2894d92c8f1843f1a97e)",
        "before_after_code_files": [
          "extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java||extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/quarkusio/quarkus/pull/38864"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java||extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java": [
          "File: extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java -> extensions/kafka-client/deployment/src/main/java/io/quarkus/kafka/client/deployment/KafkaProcessor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "415:         reflectiveClassCondition.produce(new ReflectiveClassConditionBuildItem(",
          "416:                 \"org.apache.kafka.common.security.oauthbearer.secured.OAuthBearerValidatorCallbackHandler\",",
          "417:                 \"org.jose4j.keys.resolvers.VerificationKeyResolver\"));",
          "418:     }",
          "420:     private void registerJDKLoginModules(BuildProducer<ReflectiveClassBuildItem> reflectiveClass) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "418:         reflectiveClassCondition.produce(new ReflectiveClassConditionBuildItem(",
          "419:                 \"org.apache.kafka.common.security.oauthbearer.OAuthBearerValidatorCallbackHandler\",",
          "420:                 \"org.jose4j.keys.resolvers.VerificationKeyResolver\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "145404fe5aa4bc3e4d1f1e92f2ee8406e5d3078b",
      "candidate_info": {
        "commit_hash": "145404fe5aa4bc3e4d1f1e92f2ee8406e5d3078b",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/145404fe5aa4bc3e4d1f1e92f2ee8406e5d3078b",
        "files": [
          "extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java",
          "extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java"
        ],
        "message": "Fail early if OIDC client password grant OIDC UserInfo access is misconfigured\n\n(cherry picked from commit 4d591f02bf6ac8e23d14f4df3d15ed21b8e8a3de)",
        "before_after_code_files": [
          "extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java||extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java",
          "extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java||extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/quarkusio/quarkus/pull/38864"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java||extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java": [
          "File: extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java -> extensions/oidc-client/deployment/src/test/java/io/quarkus/oidc/client/OidcClientPasswordGrantSecretIsMissingTestCase.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.oidc.client;",
          "3: import static org.junit.jupiter.api.Assertions.assertNotNull;",
          "4: import static org.junit.jupiter.api.Assertions.assertTrue;",
          "6: import org.jboss.shrinkwrap.api.asset.StringAsset;",
          "7: import org.junit.jupiter.api.Assertions;",
          "8: import org.junit.jupiter.api.Test;",
          "9: import org.junit.jupiter.api.extension.RegisterExtension;",
          "11: import io.quarkus.runtime.configuration.ConfigurationException;",
          "12: import io.quarkus.test.QuarkusUnitTest;",
          "14: public class OidcClientPasswordGrantSecretIsMissingTestCase {",
          "16:     @RegisterExtension",
          "17:     static final QuarkusUnitTest test = new QuarkusUnitTest()",
          "18:             .withApplicationRoot((jar) -> jar",
          "19:                     .addAsResource(new StringAsset(",
          "20:                             \"quarkus.oidc-client.token-path=http://localhost:8180/oidc/tokens\\n\"",
          "21:                                     + \"quarkus.oidc-client.client-id=quarkus\\n\"",
          "22:                                     + \"quarkus.oidc-client.credentials.secret=secret\\n\"",
          "23:                                     + \"quarkus.oidc-client.grant.type=password\\n\"",
          "24:                                     + \"quarkus.oidc-client.grant-options.password.user=alice\\n\"),",
          "25:                             \"application.properties\"))",
          "26:             .assertException(t -> {",
          "27:                 Throwable e = t;",
          "28:                 ConfigurationException te = null;",
          "29:                 while (e != null) {",
          "30:                     if (e instanceof ConfigurationException) {",
          "31:                         te = (ConfigurationException) e;",
          "32:                         break;",
          "33:                     }",
          "34:                     e = e.getCause();",
          "35:                 }",
          "36:                 assertNotNull(te);",
          "37:                 assertTrue(",
          "38:                         te.getMessage()",
          "39:                                 .contains(\"Username and password must be set when a password grant is used\"),",
          "40:                         te.getMessage());",
          "41:             });",
          "43:     @Test",
          "44:     public void test() {",
          "45:         Assertions.fail();",
          "46:     }",
          "48: }",
          "",
          "---------------"
        ],
        "extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java||extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java": [
          "File: extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java -> extensions/oidc-client/runtime/src/main/java/io/quarkus/oidc/client/runtime/OidcClientRecorder.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import java.util.HashMap;",
          "5: import java.util.List;",
          "6: import java.util.Map;",
          "7: import java.util.function.BiFunction;",
          "8: import java.util.function.Function;",
          "9: import java.util.function.Supplier;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: import java.util.Set;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "177:                                         for (Map.Entry<String, String> entry : grantOptions.entrySet()) {",
          "178:                                             if (!OidcConstants.PASSWORD_GRANT_USERNAME.equals(entry.getKey())",
          "179:                                                     && !OidcConstants.PASSWORD_GRANT_PASSWORD.equals(entry.getKey())) {",
          "",
          "[Removed Lines]",
          "173:                                         tokenGrantParams.add(OidcConstants.PASSWORD_GRANT_USERNAME,",
          "174:                                                 grantOptions.get(OidcConstants.PASSWORD_GRANT_USERNAME));",
          "175:                                         tokenGrantParams.add(OidcConstants.PASSWORD_GRANT_PASSWORD,",
          "176:                                                 grantOptions.get(OidcConstants.PASSWORD_GRANT_PASSWORD));",
          "",
          "[Added Lines]",
          "174:                                         final String userName = grantOptions.get(OidcConstants.PASSWORD_GRANT_USERNAME);",
          "175:                                         final String userPassword = grantOptions.get(OidcConstants.PASSWORD_GRANT_PASSWORD);",
          "176:                                         if (userName == null || userPassword == null) {",
          "177:                                             throw new ConfigurationException(",
          "178:                                                     \"Username and password must be set when a password grant is used\",",
          "179:                                                     Set.of(\"quarkus.oidc-client.grant.type\",",
          "180:                                                             \"quarkus.oidc-client.grant-options\"));",
          "181:                                         }",
          "182:                                         tokenGrantParams.add(OidcConstants.PASSWORD_GRANT_USERNAME, userName);",
          "183:                                         tokenGrantParams.add(OidcConstants.PASSWORD_GRANT_PASSWORD, userPassword);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a563de4daa9cf587131bd30709d8f296d12a3df5",
      "candidate_info": {
        "commit_hash": "a563de4daa9cf587131bd30709d8f296d12a3df5",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/a563de4daa9cf587131bd30709d8f296d12a3df5",
        "files": [
          "independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java"
        ],
        "message": "Adds an implementation note about @VirtualThreadUnit limitations\n\nCloses #38721\n\n(cherry picked from commit 2b3e0717e47fa2ed9e33b315b7cc7bbfa4bf3f14)",
        "before_after_code_files": [
          "independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java||independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/quarkusio/quarkus/pull/38864"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java||independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java": [
          "File: independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java -> independent-projects/junit5-virtual-threads/src/main/java/io/quarkus/test/junit5/virtual/VirtualThreadUnit.java"
        ]
      }
    }
  ]
}