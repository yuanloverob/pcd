{
  "cve_id": "CVE-2024-45409",
  "cve_desc": "The Ruby SAML library is for implementing the client side of a SAML authorization. Ruby-SAML in <= 12.2 and 1.13.0 <= 1.16.0 does not properly verify the signature of the SAML Response. An unauthenticated attacker with access to any signed saml document (by the IdP) can thus forge a SAML Response/Assertion with arbitrary contents. This would allow the attacker to log in as arbitrary user within the vulnerable system. This vulnerability is fixed in 1.17.0 and 1.12.3.",
  "repo": "omniauth/omniauth-saml",
  "patch_hash": "4274e9d57e65f2dcaae4aa3b2accf831494f2ddd",
  "patch_info": {
    "commit_hash": "4274e9d57e65f2dcaae4aa3b2accf831494f2ddd",
    "repo": "omniauth/omniauth-saml",
    "commit_url": "https://github.com/omniauth/omniauth-saml/commit/4274e9d57e65f2dcaae4aa3b2accf831494f2ddd",
    "files": [
      "CHANGELOG.md",
      "lib/omniauth-saml/version.rb"
    ],
    "message": "feat: new release 2.2.0",
    "before_after_code_files": [
      "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
    ]
  },
  "patch_diff": {
    "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb": [
      "File: lib/omniauth-saml/version.rb -> lib/omniauth-saml/version.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: module OmniAuth",
      "2:   module SAML",
      "4:   end",
      "5: end",
      "",
      "[Removed Lines]",
      "3:     VERSION = '2.1.1'",
      "",
      "[Added Lines]",
      "3:     VERSION = '2.2.0'",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e17f460bf272589a569bf0efe37ba97087c2bb8c",
      "candidate_info": {
        "commit_hash": "e17f460bf272589a569bf0efe37ba97087c2bb8c",
        "repo": "omniauth/omniauth-saml",
        "commit_url": "https://github.com/omniauth/omniauth-saml/commit/e17f460bf272589a569bf0efe37ba97087c2bb8c",
        "files": [
          "omniauth-saml.gemspec"
        ],
        "message": "chore: use semantic versioning for ruby-saml as per gem build hints",
        "before_after_code_files": [
          "omniauth-saml.gemspec||omniauth-saml.gemspec"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/omniauth/omniauth-saml/pull/225"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "omniauth-saml.gemspec||omniauth-saml.gemspec": [
          "File: omniauth-saml.gemspec -> omniauth-saml.gemspec",
          "--- Hunk 1 ---",
          "[Context before]",
          "13:   gem.required_ruby_version = '>= 3.1'",
          "15:   gem.add_runtime_dependency 'omniauth', '~> 2.1'",
          "18:   gem.add_development_dependency 'rake', '~> 13.2'",
          "19:   gem.add_development_dependency 'rspec', '~> 3.13'",
          "",
          "[Removed Lines]",
          "16:   gem.add_runtime_dependency 'ruby-saml', '>= 1.17'",
          "",
          "[Added Lines]",
          "16:   gem.add_runtime_dependency 'ruby-saml', '~> 1.17'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b4a6016fc47b2808c410d05676f93df50d00f73b",
      "candidate_info": {
        "commit_hash": "b4a6016fc47b2808c410d05676f93df50d00f73b",
        "repo": "omniauth/omniauth-saml",
        "commit_url": "https://github.com/omniauth/omniauth-saml/commit/b4a6016fc47b2808c410d05676f93df50d00f73b",
        "files": [
          "CHANGELOG.md",
          "lib/omniauth-saml/version.rb"
        ],
        "message": "fix: file permissions for version.rb and CHANGELOG\n\nCloses #226",
        "before_after_code_files": [
          "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ],
          "candidate": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb": [
          "File: lib/omniauth-saml/version.rb -> lib/omniauth-saml/version.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module OmniAuth",
          "2:   module SAML",
          "4:   end",
          "5: end",
          "",
          "[Removed Lines]",
          "3:     VERSION = '2.2.0'",
          "",
          "[Added Lines]",
          "3:     VERSION = '2.2.1'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "34eb3541248e4ee56fa2189bd7b47f4748fe2f78",
      "candidate_info": {
        "commit_hash": "34eb3541248e4ee56fa2189bd7b47f4748fe2f78",
        "repo": "omniauth/omniauth-saml",
        "commit_url": "https://github.com/omniauth/omniauth-saml/commit/34eb3541248e4ee56fa2189bd7b47f4748fe2f78",
        "files": [
          "CHANGELOG.md",
          "lib/omniauth-saml/version.rb"
        ],
        "message": "feat: new release 2.2.3\n\n* Fix GHSA-hw46-3hmr-x9xv\n\nSigned-off-by: Roger Meier <r.meier@siemens.com>",
        "before_after_code_files": [
          "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ],
          "candidate": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb": [
          "File: lib/omniauth-saml/version.rb -> lib/omniauth-saml/version.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module OmniAuth",
          "2:   module SAML",
          "4:   end",
          "5: end",
          "",
          "[Removed Lines]",
          "3:     VERSION = '2.2.2'",
          "",
          "[Added Lines]",
          "3:     VERSION = '2.2.3'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b2530473d5dfb59649b543e5581bac8d3615a394",
      "candidate_info": {
        "commit_hash": "b2530473d5dfb59649b543e5581bac8d3615a394",
        "repo": "omniauth/omniauth-saml",
        "commit_url": "https://github.com/omniauth/omniauth-saml/commit/b2530473d5dfb59649b543e5581bac8d3615a394",
        "files": [
          "CHANGELOG.md",
          "lib/omniauth-saml/version.rb"
        ],
        "message": "feat: new release 2.2.2",
        "before_after_code_files": [
          "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ],
          "candidate": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb": [
          "File: lib/omniauth-saml/version.rb -> lib/omniauth-saml/version.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module OmniAuth",
          "2:   module SAML",
          "4:   end",
          "5: end",
          "",
          "[Removed Lines]",
          "3:     VERSION = '2.2.1'",
          "",
          "[Added Lines]",
          "3:     VERSION = '2.2.2'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a5d4e926318c9e8c8577b6f6017fa72a526adf45",
      "candidate_info": {
        "commit_hash": "a5d4e926318c9e8c8577b6f6017fa72a526adf45",
        "repo": "omniauth/omniauth-saml",
        "commit_url": "https://github.com/omniauth/omniauth-saml/commit/a5d4e926318c9e8c8577b6f6017fa72a526adf45",
        "files": [
          "CHANGELOG.md",
          "lib/omniauth-saml/version.rb"
        ],
        "message": "feat: new release 2.1.0",
        "before_after_code_files": [
          "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ],
          "candidate": [
            "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/omniauth-saml/version.rb||lib/omniauth-saml/version.rb": [
          "File: lib/omniauth-saml/version.rb -> lib/omniauth-saml/version.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module OmniAuth",
          "2:   module SAML",
          "4:   end",
          "5: end",
          "",
          "[Removed Lines]",
          "3:     VERSION = '2.1.0'",
          "",
          "[Added Lines]",
          "3:     VERSION = '2.1.1'",
          "",
          "---------------"
        ]
      }
    }
  ]
}