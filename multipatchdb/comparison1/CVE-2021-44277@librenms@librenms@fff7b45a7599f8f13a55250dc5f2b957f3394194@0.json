{
  "cve_id": "CVE-2021-44277",
  "cve_desc": "Librenms 21.11.0 is affected by a Cross Site Scripting (XSS) vulnerability in includes/html/common/alert-log.inc.php.",
  "repo": "librenms/librenms",
  "patch_hash": "fff7b45a7599f8f13a55250dc5f2b957f3394194",
  "patch_info": {
    "commit_hash": "fff7b45a7599f8f13a55250dc5f2b957f3394194",
    "repo": "librenms/librenms",
    "commit_url": "https://github.com/librenms/librenms/pull/13554/commits/fff7b45a7599f8f13a55250dc5f2b957f3394194",
    "files": [
      "includes/html/pages/alerts.inc.php",
      "includes/html/pages/device/alerts.inc.php"
    ],
    "message": "fix XSS vulnerabilities in alerts.inc.php",
    "before_after_code_files": [
      "includes/html/pages/alerts.inc.php||includes/html/pages/alerts.inc.php",
      "includes/html/pages/device/alerts.inc.php||includes/html/pages/device/alerts.inc.php"
    ]
  },
  "patch_diff": {
    "includes/html/pages/alerts.inc.php||includes/html/pages/alerts.inc.php": [
      "File: includes/html/pages/alerts.inc.php -> includes/html/pages/alerts.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "28:     require_once 'includes/html/modal/alert_notes.inc.php';",
      "29:     require_once 'includes/html/modal/alert_ack.inc.php';",
      "30:     require_once 'includes/html/common/alerts.inc.php';",
      "32:     unset($device['device_id']);",
      "33:     ?>",
      "34: </div>",
      "",
      "[Removed Lines]",
      "31:     echo implode('', $common_output);",
      "",
      "[Added Lines]",
      "31:     echo htmlspecialchars(implode('', $common_output));",
      "",
      "---------------"
    ],
    "includes/html/pages/device/alerts.inc.php||includes/html/pages/device/alerts.inc.php": [
      "File: includes/html/pages/device/alerts.inc.php -> includes/html/pages/device/alerts.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "51:         include 'includes/html/modal/alert_notes.inc.php';",
      "52:         include 'includes/html/modal/alert_ack.inc.php';",
      "53:         include 'includes/html/common/alerts.inc.php';",
      "55:         break;",
      "56:     case 'alert-log':",
      "57:         $vars['fromdevice'] = true;",
      "58:         $device_id = (int) $vars['device'];",
      "59:         include 'includes/html/modal/alert_details.php';",
      "60:         include 'includes/html/common/alert-log.inc.php';",
      "62:         break;",
      "64:     default:",
      "",
      "[Removed Lines]",
      "54:         echo implode('', $common_output);",
      "61:         echo implode('', $common_output);",
      "",
      "[Added Lines]",
      "54:         echo htmlspecialchars(implode('', $common_output));",
      "61:         echo htmlspecialchars(implode('', $common_output));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "35a69050922692e3aa69dae74bff981f30ee7689",
      "candidate_info": {
        "commit_hash": "35a69050922692e3aa69dae74bff981f30ee7689",
        "repo": "librenms/librenms",
        "commit_url": "https://github.com/librenms/librenms/commit/35a69050922692e3aa69dae74bff981f30ee7689",
        "files": [
          "includes/html/common/alert-log.inc.php",
          "includes/html/forms/poller-groups.inc.php",
          "includes/html/forms/rediscover-device.inc.php",
          "includes/html/forms/reset-port-state.inc.php",
          "includes/html/forms/sensor-alert-update.inc.php",
          "includes/html/pages/adduser.inc.php",
          "includes/html/pages/api-access.inc.php",
          "includes/html/pages/bill.inc.php",
          "includes/html/pages/delhost.inc.php",
          "includes/html/pages/device/showconfig.inc.php",
          "includes/html/pages/inventory.inc.php",
          "includes/html/pages/search/arp.inc.php",
          "includes/html/pages/search/mac.inc.php",
          "includes/html/pages/search/packages.inc.php",
          "includes/html/pages/tools/oxidized-cfg-check.inc.php",
          "includes/html/print-alert-rules.php",
          "includes/html/print-customoid.php"
        ],
        "message": "Fix security vuls (#13554)\n\n* Fix XSS vulnerabilities\n\n* fix XSS vulnerabilities in alerts.inc.php\n\n* fix XSS vulnerability in poller-groups.inc.php\n\n* small fix for the integration\n\n* another fix for the inegration\n\n* another fix for the inegration\n\n* change the sanitizer at sources instead of json_encode sinks\n\n* another change sanitizer at sources instead of json_encode sinks\n\n* another change sanitizer at sources instead of common_output and current_config sinks\n\n* fix path manipulation vulnerability",
        "before_after_code_files": [
          "includes/html/common/alert-log.inc.php||includes/html/common/alert-log.inc.php",
          "includes/html/forms/poller-groups.inc.php||includes/html/forms/poller-groups.inc.php",
          "includes/html/forms/rediscover-device.inc.php||includes/html/forms/rediscover-device.inc.php",
          "includes/html/forms/reset-port-state.inc.php||includes/html/forms/reset-port-state.inc.php",
          "includes/html/forms/sensor-alert-update.inc.php||includes/html/forms/sensor-alert-update.inc.php",
          "includes/html/pages/adduser.inc.php||includes/html/pages/adduser.inc.php",
          "includes/html/pages/api-access.inc.php||includes/html/pages/api-access.inc.php",
          "includes/html/pages/bill.inc.php||includes/html/pages/bill.inc.php",
          "includes/html/pages/delhost.inc.php||includes/html/pages/delhost.inc.php",
          "includes/html/pages/device/showconfig.inc.php||includes/html/pages/device/showconfig.inc.php",
          "includes/html/pages/inventory.inc.php||includes/html/pages/inventory.inc.php",
          "includes/html/pages/search/arp.inc.php||includes/html/pages/search/arp.inc.php",
          "includes/html/pages/search/mac.inc.php||includes/html/pages/search/mac.inc.php",
          "includes/html/pages/search/packages.inc.php||includes/html/pages/search/packages.inc.php",
          "includes/html/pages/tools/oxidized-cfg-check.inc.php||includes/html/pages/tools/oxidized-cfg-check.inc.php",
          "includes/html/print-alert-rules.php||includes/html/print-alert-rules.php",
          "includes/html/print-customoid.php||includes/html/print-customoid.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/librenms/librenms/pull/13554"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "includes/html/common/alert-log.inc.php||includes/html/common/alert-log.inc.php": [
          "File: includes/html/common/alert-log.inc.php -> includes/html/common/alert-log.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "62:     $_POST['device_id'] = $device_id;",
          "63: }",
          "64: if (isset($_POST['state'])) {",
          "66:     $selected_state .= array_search((int) $_POST['state'], $alert_states) . '</option>';",
          "67: } else {",
          "68:     $selected_state = '';",
          "69:     $_POST['state'] = -1;",
          "70: }",
          "71: if (isset($_POST['min_severity'])) {",
          "73:     $selected_min_severity .= array_search((int) $_POST['min_severity'], $alert_severities) . '</option>';",
          "74: } else {",
          "75:     $selected_min_severity = '';",
          "",
          "[Removed Lines]",
          "65:     $selected_state = '<option value=\"' . $_POST['state'] . '\" selected=\"selected\">';",
          "72:     $selected_min_severity = '<option value=\"' . $_POST['min_severity'] . '\" selected=\"selected\">';",
          "",
          "[Added Lines]",
          "65:     $selected_state = '<option value=\"' . htmlspecialchars($_POST['state']) . '\" selected=\"selected\">';",
          "72:     $selected_min_severity = '<option value=\"' . htmlspecialchars($_POST['min_severity']) . '\" selected=\"selected\">';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167:         max = high - low;",
          "168:         search = $(\\'.search-field\\').val();",
          "172:         grid.find(\".incident-toggle\").each(function () {",
          "173:             $(this).parent().addClass(\\'incident-toggle-td\\');",
          "",
          "[Removed Lines]",
          "170:         $(\".pdf-export\").html(\"<a href=\\'pdf.php?report=alert-log&device_id=' . $_POST['device_id'] . '&string=\" + search + \"&results=\" + max + \"&start=\" + low + \"\\'><i class=\\'fa fa-heartbeat fa-lg icon-theme\\' aria-hidden=\\'true\\'></i> Export to pdf</a>\");",
          "",
          "[Added Lines]",
          "170:         $(\".pdf-export\").html(\"<a href=\\'pdf.php?report=alert-log&device_id=' . htmlspecialchars($_POST['device_id']) . '&string=\" + search + \"&results=\" + max + \"&start=\" + low + \"\\'><i class=\\'fa fa-heartbeat fa-lg icon-theme\\' aria-hidden=\\'true\\'></i> Export to pdf</a>\");",
          "",
          "---------------"
        ],
        "includes/html/forms/poller-groups.inc.php||includes/html/forms/poller-groups.inc.php": [
          "File: includes/html/forms/poller-groups.inc.php -> includes/html/forms/poller-groups.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "44: if (! empty($ok)) {",
          "45:     exit(\"$ok\");",
          "46: } else {",
          "48: }",
          "",
          "[Removed Lines]",
          "47:     exit(\"ERROR: $error\");",
          "",
          "[Added Lines]",
          "47:     exit('ERROR: ' . htmlspecialchars($error));",
          "",
          "---------------"
        ],
        "includes/html/forms/rediscover-device.inc.php||includes/html/forms/rediscover-device.inc.php": [
          "File: includes/html/forms/rediscover-device.inc.php -> includes/html/forms/rediscover-device.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:         if (! empty($update) || $update == '0') {",
          "50:             $status = 'ok';",
          "52:         } else {",
          "53:             $status = 'error';",
          "55:         }",
          "56:     }",
          "57: } else {",
          "",
          "[Removed Lines]",
          "51:             $message = 'Devices of group ' . $_POST['device_group_id'] . ' will be rediscovered';",
          "54:             $message = 'Error rediscovering devices of group ' . $_POST['device_group_id'];",
          "",
          "[Added Lines]",
          "51:             $message = 'Devices of group ' . htmlspecialchars($_POST['device_group_id']) . ' will be rediscovered';",
          "54:             $message = 'Error rediscovering devices of group ' . htmlspecialchars($_POST['device_group_id']);",
          "",
          "---------------"
        ],
        "includes/html/forms/reset-port-state.inc.php||includes/html/forms/reset-port-state.inc.php": [
          "File: includes/html/forms/reset-port-state.inc.php -> includes/html/forms/reset-port-state.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: if (isset($_POST['device_id'])) {",
          "39:     if (! is_numeric($_POST['device_id'])) {",
          "40:         $status = 'error';",
          "42:     } else {",
          "43:         $device = Device::find($_POST['device_id']);",
          "",
          "[Removed Lines]",
          "41:         $message = 'Invalid device id ' . $_POST['device_id'];",
          "",
          "[Added Lines]",
          "41:         $message = 'Invalid device id ' . htmlspecialchars($_POST['device_id']);",
          "",
          "---------------"
        ],
        "includes/html/forms/sensor-alert-update.inc.php||includes/html/forms/sensor-alert-update.inc.php": [
          "File: includes/html/forms/sensor-alert-update.inc.php -> includes/html/forms/sensor-alert-update.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:         }",
          "50:         if (dbUpdate(['sensor_alert' => $state], 'sensors', '`sensor_id` = ? AND `device_id` = ?', [$_POST['sensor_id'], $_POST['device_id']]) >= 0) {",
          "51:             $status = ($state == 0) ? 'info' : 'ok';",
          "53:         } else {",
          "54:             $status = 'error';",
          "56:         }",
          "57:     }",
          "58: }",
          "",
          "[Removed Lines]",
          "52:             $message = 'Alerts ' . $state_string . ' for sensor ' . $_POST['sensor_desc'];",
          "55:             $message = 'Couldn\\'t ' . substr($state_string, 0, -1) . ' alerts for sensor ' . $_POST['sensor_desc'] . '. Enable debug and check librenms.log';",
          "",
          "[Added Lines]",
          "52:             $message = 'Alerts ' . $state_string . ' for sensor ' . htmlspecialchars($_POST['sensor_desc']);",
          "55:             $message = 'Couldn\\'t ' . substr($state_string, 0, -1) . ' alerts for sensor ' . htmlspecialchars($_POST['sensor_desc']) . '. Enable debug and check librenms.log';",
          "",
          "---------------"
        ],
        "includes/html/pages/adduser.inc.php||includes/html/pages/adduser.inc.php": [
          "File: includes/html/pages/adduser.inc.php -> includes/html/pages/adduser.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:                     if (LegacyAuth::get()->addUser($_POST['new_username'], $_POST['new_password'], $_POST['new_level'], $_POST['new_email'], $_POST['new_realname'], $_POST['can_modify_passwd'])) {",
          "30:                     }",
          "31:                 } else {",
          "32:                     echo '<div class=\"red\">User with this name already exists!</div>';",
          "",
          "[Removed Lines]",
          "29:                         echo '<span class=info>User ' . $_POST['new_username'] . ' added!</span>';",
          "",
          "[Added Lines]",
          "29:                         echo '<span class=info>User ' . htmlspecialchars($_POST['new_username']) . ' added!</span>';",
          "",
          "---------------"
        ],
        "includes/html/pages/api-access.inc.php||includes/html/pages/api-access.inc.php": [
          "File: includes/html/pages/api-access.inc.php -> includes/html/pages/api-access.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "67:             <div class=\"form-group\">",
          "68:               <label for=\"token\" class=\"col-sm-2 control-label\">Token: </label>",
          "69:               <div class=\"col-sm-8\">",
          "71:               </div>",
          "72:               <div class=\"col-sm-2\">",
          "73:               </div>",
          "",
          "[Removed Lines]",
          "70:                 <input type=\"text\" class=\"form-control\" id=\"token\" name=\"token\" value=\"<?php echo $_POST['token']; ?>\" readonly>",
          "",
          "[Added Lines]",
          "70:                 <input type=\"text\" class=\"form-control\" id=\"token\" name=\"token\" value=\"<?php echo htmlspecialchars($_POST['token']); ?>\" readonly>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75:             <div class=\"form-group\">",
          "76:               <label for=\"description\" class=\"col-sm-2 control-label\">Descr: </label>",
          "77:               <div class=\"col-sm-10\">",
          "79:               </div>",
          "80:             </div>",
          "81:         </div>",
          "",
          "[Removed Lines]",
          "78:                 <input type=\"text\" class=\"form-control\" id=\"description\" name=\"description\" value=\"<?php echo $_POST['description']; ?>\">",
          "",
          "[Added Lines]",
          "78:                 <input type=\"text\" class=\"form-control\" id=\"description\" name=\"description\" value=\"<?php echo htmlspecialchars($_POST['description']); ?>\">",
          "",
          "---------------"
        ],
        "includes/html/pages/bill.inc.php||includes/html/pages/bill.inc.php": [
          "File: includes/html/pages/bill.inc.php -> includes/html/pages/bill.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "211:         $rightnow = date('U');",
          "213:         if ($vars['view'] == 'accurate') {",
          "215:             $bi .= '&amp;from=' . $unixfrom . '&amp;to=' . $unixto;",
          "216:             $bi .= '&amp;x=1190&amp;y=250';",
          "217:             $bi .= \"$type'>\";",
          "",
          "[Removed Lines]",
          "214:             $bi = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . $_GET['bill_code'];",
          "",
          "[Added Lines]",
          "214:             $bi = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . htmlspecialchars($_GET['bill_code']);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "221:             $li .= '&amp;x=1190&amp;y=250';",
          "222:             $li .= \"$type'>\";",
          "225:             $di .= '&amp;from=' . \\LibreNMS\\Config::get('time.day') . '&amp;to=' . \\LibreNMS\\Config::get('time.now');",
          "226:             $di .= '&amp;x=1190&amp;y=250';",
          "227:             $di .= \"$type'>\";",
          "230:             $mi .= '&amp;from=' . $lastmonth . '&amp;to=' . $rightnow;",
          "231:             $mi .= '&amp;x=1190&amp;y=250';",
          "232:             $mi .= \"$type'>\";",
          "",
          "[Removed Lines]",
          "224:             $di = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . $_GET['bill_code'];",
          "229:             $mi = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . $_GET['bill_code'];",
          "",
          "[Added Lines]",
          "224:             $di = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . htmlspecialchars($_GET['bill_code']);",
          "229:             $mi = \"<img src='billing-graph.php?bill_id=\" . $bill_id . '&amp;bill_code=' . htmlspecialchars($_GET['bill_code']);",
          "",
          "---------------"
        ],
        "includes/html/pages/delhost.inc.php||includes/html/pages/delhost.inc.php": [
          "File: includes/html/pages/delhost.inc.php -> includes/html/pages/delhost.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:   <form name=\"form1\" method=\"post\" action=\"\" class=\"form-horizontal\" role=\"form\">",
          "28:             <?php echo csrf_field() ?>",
          "29:     <div class=\"form-group\">",
          "31:       <input type=\"hidden\" name=\"confirm\" value=\"1\" />",
          "33:       <button type=\"submit\" class=\"btn btn-danger\">Confirm device deletion</button>",
          "34:     </div>",
          "35:   </form>",
          "",
          "[Removed Lines]",
          "30:       <input type=\"hidden\" name=\"id\" value=\"<?php echo $_REQUEST['id'] ?>\" />",
          "32:       <!--<input type=\"hidden\" name=\"remove_rrd\" value=\"<?php echo $_POST['remove_rrd']; ?>\">-->",
          "",
          "[Added Lines]",
          "30:       <input type=\"hidden\" name=\"id\" value=\"<?php echo htmlspecialchars($_REQUEST['id']) ?>\" />",
          "32:       <!--<input type=\"hidden\" name=\"remove_rrd\" value=\"<?php echo htmlspecialchars($_POST['remove_rrd']); ?>\">-->",
          "",
          "---------------"
        ],
        "includes/html/pages/device/showconfig.inc.php||includes/html/pages/device/showconfig.inc.php": [
          "File: includes/html/pages/device/showconfig.inc.php -> includes/html/pages/device/showconfig.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "166:         if ($config_total > 1) {",
          "168:             if (isset($_POST['config'])) {",
          "170:                 $current_config = ['oid'=>$oid, 'date'=>$date, 'version'=>$version];",
          "171:             } else { // no version selected",
          "172:                 $current_config = ['oid' => $config_versions[0]['oid'], 'date' => $config_versions[0]['date'], 'version' => $config_total];",
          "",
          "[Removed Lines]",
          "169:                 [$oid,$date,$version] = explode('|', $_POST['config']);",
          "",
          "[Added Lines]",
          "169:                 [$oid,$date,$version] = explode('|', htmlspecialchars($_POST['config']));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "197:                 if (! empty($node_info['group'])) {",
          "198:                     $url .= '&group=' . $node_info['group'];",
          "199:                 }",
          "202:                 $text = file_get_contents($url); // fetch diff",
          "203:             } else {",
          "206:             }",
          "207:         } else {  // just fetch the only version",
          "208:             $text = file_get_contents(Config::get('oxidized.url') . '/node/fetch/' . (! empty($node_info['group']) ? $node_info['group'] . '/' : '') . $oxidized_hostname);",
          "",
          "[Removed Lines]",
          "200:                 $url .= '&oid=' . $current_config['oid'] . '&date=' . urlencode($current_config['date']) . '&num=' . $current_config['version'] . '&oid2=' . $previous_config['oid'] . '&format=text';",
          "205:                 $text = file_get_contents(Config::get('oxidized.url') . '/node/version/view?node=' . $oxidized_hostname . (! empty($node_info['group']) ? '&group=' . $node_info['group'] : '') . '&oid=' . $current_config['oid'] . '&date=' . urlencode($current_config['date']) . '&num=' . $current_config['version'] . '&format=text');",
          "",
          "[Added Lines]",
          "200:                 $url .= '&oid=' . urlencode($current_config['oid']) . '&date=' . urlencode($current_config['date']) . '&num=' . urlencode($current_config['version']) . '&oid2=' . $previous_config['oid'] . '&format=text';",
          "205:                 $text = file_get_contents(Config::get('oxidized.url') . '/node/version/view?node=' . $oxidized_hostname . (! empty($node_info['group']) ? '&group=' . $node_info['group'] : '') . '&oid=' . urlencode($current_config['oid']) . '&date=' . urlencode($current_config['date']) . '&num=' . urlencode($current_config['version']) . '&format=text');",
          "",
          "---------------"
        ],
        "includes/html/pages/inventory.inc.php||includes/html/pages/inventory.inc.php": [
          "File: includes/html/pages/inventory.inc.php -> includes/html/pages/inventory.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "31:                 \"<div class=\\\"col-sm-9 actionBar\\\"><span class=\\\"pull-left\\\"><form method=\\\"post\\\" action=\\\"\\\" class=\\\"form-inline\\\" role=\\\"form\\\">\"+",
          "32:                 \"<?php echo addslashes(csrf_field()) ?>\"+",
          "33:                 \"<div class=\\\"form-group\\\">\"+",
          "35:                 \"</div>\"+",
          "36:                 \"<div class=\\\"form-group\\\">\"+",
          "37:                 \"<strong>&nbsp;Part No&nbsp;</strong>\"+",
          "",
          "[Removed Lines]",
          "34:                 \"<input type=\\\"text\\\" name=\\\"string\\\" id=\\\"string\\\" value=\\\"<?php echo $_POST['string']; ?>\\\" placeholder=\\\"Description\\\" class=\\\"form-control input-sm\\\" />\"+",
          "",
          "[Added Lines]",
          "34:                 \"<input type=\\\"text\\\" name=\\\"string\\\" id=\\\"string\\\" value=\\\"<?php echo htmlspecialchars($_POST['string']); ?>\\\" placeholder=\\\"Description\\\" class=\\\"form-control input-sm\\\" />\"+",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "50:                  \"</select>\"+",
          "51:                  \"</div>\"+",
          "52:                  \"<div class=\\\"form-group\\\">\"+",
          "54:                  \"</div>\"+",
          "55:                  \"<div class=\\\"form-group\\\">\"+",
          "56:                  \"<strong>&nbsp;Device&nbsp;</strong>\"+",
          "",
          "[Removed Lines]",
          "53:                  \"<input type=\\\"text\\\" name=\\\"serial\\\" id=\\\"serial\\\" value=\\\"<?php echo $_POST['serial']; ?>\\\" placeholder=\\\"Serial\\\" class=\\\"form-control input-sm\\\"/>\"+",
          "",
          "[Added Lines]",
          "53:                  \"<input type=\\\"text\\\" name=\\\"serial\\\" id=\\\"serial\\\" value=\\\"<?php echo htmlspecialchars($_POST['serial']); ?>\\\" placeholder=\\\"Serial\\\" class=\\\"form-control input-sm\\\"/>\"+",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "74:                  \"<input type=\\\"text\\\" size=24 name=\\\"device_string\\\" id=\\\"device_string\\\" value=\\\"\"+",
          "75:                     <?php",
          "76:                     if ($_POST['device_string']) {",
          "78:                     }",
          "79:                     ?>",
          "80:                  \"\\\" placeholder=\\\"Description\\\" class=\\\"form-control input-sm\\\"/>\"+",
          "",
          "[Removed Lines]",
          "77:                         echo $_POST['device_string'];",
          "",
          "[Added Lines]",
          "77:                         echo htmlspecialchars($_POST['device_string']);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "88:         return {",
          "89:             id: \"inventory\",",
          "90:             device: '<?php echo htmlspecialchars($_POST['device']); ?>',",
          "95:         };",
          "96:     },",
          "97:     url: \"ajax_table.php\"",
          "",
          "[Removed Lines]",
          "91:             string: '<?php echo $_POST['string']; ?>',",
          "92:             device_string: '<?php echo $_POST['device_string']; ?>',",
          "93:             part: '<?php echo $_POST['part']; ?>',",
          "94:             serial: '<?php echo $_POST['serial']; ?>'",
          "",
          "[Added Lines]",
          "91:             string: '<?php echo htmlspecialchars($_POST['string']); ?>',",
          "92:             device_string: '<?php echo htmlspecialchars($_POST['device_string']); ?>',",
          "93:             part: '<?php echo htmlspecialchars($_POST['part']); ?>',",
          "94:             serial: '<?php echo htmlspecialchars($_POST['serial']); ?>'",
          "",
          "---------------"
        ],
        "includes/html/pages/search/arp.inc.php||includes/html/pages/search/arp.inc.php": [
          "File: includes/html/pages/search/arp.inc.php -> includes/html/pages/search/arp.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "77:                 \"<div class=\\\"form-group\\\">\"+",
          "78:                 \"<input type=\\\"text\\\" name=\\\"searchPhrase\\\" id=\\\"address\\\" value=\\\"\"+",
          "79: <?php",
          "81: ?>",
          "83:                 \"\\\" class=\\\"form-control input-sm\\\" placeholder=\\\"Address\\\" />\"+",
          "",
          "[Removed Lines]",
          "80: echo '\"' . $_POST['searchPhrase'] . '\"+';",
          "",
          "[Added Lines]",
          "80: echo '\"' . htmlspecialchars($_POST['searchPhrase']) . '\"+';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "91:         return {",
          "92:             id: \"arp-search\",",
          "93:             device_id: '<?php echo htmlspecialchars($_POST['device_id']); ?>',",
          "96:         };",
          "97:     },",
          "98:     url: \"ajax_table.php\",",
          "",
          "[Removed Lines]",
          "94:             searchby: '<?php echo $_POST['searchby']; ?>',",
          "95:             searchPhrase: '<?php echo $_POST['searchPhrase']; ?>'",
          "",
          "[Added Lines]",
          "94:             searchby: '<?php echo htmlspecialchars($_POST['searchby']); ?>',",
          "95:             searchPhrase: '<?php echo htmlspecialchars($_POST['searchPhrase']); ?>'",
          "",
          "---------------"
        ],
        "includes/html/pages/search/mac.inc.php||includes/html/pages/search/mac.inc.php": [
          "File: includes/html/pages/search/mac.inc.php -> includes/html/pages/search/mac.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "77:                \"<div class=\\\"form-group\\\">\"+",
          "78:                \"<input type=\\\"text\\\" name=\\\"address\\\" id=\\\"address\\\" value=\\\"\"+",
          "79: <?php",
          "81: ?>",
          "83:                \"\\\" class=\\\"form-control input-sm\\\" placeholder=\\\"Mac Address\\\"/>\"+",
          "",
          "[Removed Lines]",
          "80: echo '\"' . $_POST['address'] . '\"+';",
          "",
          "[Added Lines]",
          "80: echo '\"' . htmlspecialchars($_POST['address']) . '\"+';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "92:             id: \"address-search\",",
          "93:             search_type: \"mac\",",
          "94:             device_id: '<?php echo htmlspecialchars($_POST['device_id']); ?>',",
          "97:         };",
          "98:     },",
          "99:     url: \"ajax_table.php\",",
          "",
          "[Removed Lines]",
          "95:             interface: '<?php echo $_POST['interface']; ?>',",
          "96:             address: '<?php echo $_POST['address']; ?>'",
          "",
          "[Added Lines]",
          "95:             interface: '<?php echo htmlspecialchars($_POST['interface']); ?>',",
          "96:             address: '<?php echo htmlspecialchars($_POST['address']); ?>'",
          "",
          "---------------"
        ],
        "includes/html/pages/search/packages.inc.php||includes/html/pages/search/packages.inc.php": [
          "File: includes/html/pages/search/packages.inc.php -> includes/html/pages/search/packages.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:     <?php echo csrf_field() ?>",
          "28:     <div class=\"form-group\">",
          "29:         <label for=\"package\">Package</label>",
          "31:     </div>",
          "32:     <div class=\"form-group\">",
          "33:         <label for=\"version\">Version</label>",
          "35:     </div>",
          "36:     <div class=\"form-group\">",
          "37:         <label for=\"version\">Arch</label>",
          "39:     </div>",
          "40:     <button type=\"submit\" class=\"btn btn-default input-sm\">Search</button>",
          "41: </form>",
          "",
          "[Removed Lines]",
          "30:         <input type=\"text\" name=\"package\" id=\"package\" size=20 value=\"<?php echo $_POST['package']; ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "34:         <input type=\"text\" name=\"version\" id=\"version\" size=20 value=\"<?php echo $_POST['version']; ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "38:         <input type=\"text\" name=\"arch\" id=\"arch\" size=20 value=\"<?php echo $_POST['arch']; ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "",
          "[Added Lines]",
          "30:         <input type=\"text\" name=\"package\" id=\"package\" size=20 value=\"<?php echo htmlspecialchars($_POST['package']); ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "34:         <input type=\"text\" name=\"version\" id=\"version\" size=20 value=\"<?php echo htmlspecialchars($_POST['version']); ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "38:         <input type=\"text\" name=\"arch\" id=\"arch\" size=20 value=\"<?php echo htmlspecialchars($_POST['arch']); ?>\" class=\"form-control input-sm\" placeholder=\"Any\" />",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "172: ?>",
          "174:     </table>",
          "180: </form>",
          "181: <script type=\"text/javascript\">",
          "182:     function updateResults(results) {",
          "",
          "[Removed Lines]",
          "175:     <input type=\"hidden\" name=\"page_number\" id=\"page_number\" value=\"<?php echo $page_number; ?>\">",
          "176:     <input type=\"hidden\" name=\"results_amount\" id=\"results_amount\" value=\"<?php echo $results; ?>\">",
          "177:     <input type=\"hidden\" name=\"package\" id=\"results_packages\" value=\"<?php echo $_POST['package']; ?>\">",
          "178:     <input type=\"hidden\" name=\"version\" id=\"results_version\" value=\"<?php echo $_POST['version']; ?>\">",
          "179:     <input type=\"hidden\" name=\"arch\" id=\"results_arch\" value=\"<?php echo $_POST['arch']; ?>\">",
          "",
          "[Added Lines]",
          "175:     <input type=\"hidden\" name=\"page_number\" id=\"page_number\" value=\"<?php echo htmlspecialchars($page_number); ?>\">",
          "176:     <input type=\"hidden\" name=\"results_amount\" id=\"results_amount\" value=\"<?php echo htmlspecialchars($results); ?>\">",
          "177:     <input type=\"hidden\" name=\"package\" id=\"results_packages\" value=\"<?php echo htmlspecialchars($_POST['package']); ?>\">",
          "178:     <input type=\"hidden\" name=\"version\" id=\"results_version\" value=\"<?php echo htmlspecialchars($_POST['version']); ?>\">",
          "179:     <input type=\"hidden\" name=\"arch\" id=\"results_arch\" value=\"<?php echo htmlspecialchars($_POST['arch']); ?>\">",
          "",
          "---------------"
        ],
        "includes/html/pages/tools/oxidized-cfg-check.inc.php||includes/html/pages/tools/oxidized-cfg-check.inc.php": [
          "File: includes/html/pages/tools/oxidized-cfg-check.inc.php -> includes/html/pages/tools/oxidized-cfg-check.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:         <?php echo csrf_field() ?>",
          "24:         <div class=\"form-group\">",
          "25:             <label for=\"exampleInputEmail1\">Paste your Oxidized yaml config:</label>",
          "27:         </div>",
          "28:         <button type=\"submit\" class=\"btn btn-default btn-primary\">Validate YAML</button>",
          "29:     </form>",
          "",
          "[Removed Lines]",
          "26:             <textarea name=\"config\" value=\"config\" rows=\"20\" class=\"form-control\" placeholder=\"Paste your Oxidized yaml config\"><?php echo $_POST['config']; ?></textarea>",
          "",
          "[Added Lines]",
          "26:             <textarea name=\"config\" value=\"config\" rows=\"20\" class=\"form-control\" placeholder=\"Paste your Oxidized yaml config\"><?php echo htmlspecialchars($_POST['config']); ?></textarea>",
          "",
          "---------------"
        ],
        "includes/html/print-alert-rules.php||includes/html/print-alert-rules.php": [
          "File: includes/html/print-alert-rules.php -> includes/html/print-alert-rules.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "446:     echo '</div>';",
          "447: }",
          "451:     </form>';",
          "453: if ($count < 1) {",
          "",
          "[Removed Lines]",
          "449: echo '<input type=\"hidden\" name=\"page_number\" id=\"page_number\" value=\"' . $page_number . '\">",
          "450:     <input type=\"hidden\" name=\"results_amount\" id=\"results_amount\" value=\"' . $results . '\">",
          "",
          "[Added Lines]",
          "449: echo '<input type=\"hidden\" name=\"page_number\" id=\"page_number\" value=\"' . htmlspecialchars($page_number) . '\">",
          "450:     <input type=\"hidden\" name=\"results_amount\" id=\"results_amount\" value=\"' . htmlspecialchars($results) . '\">",
          "",
          "---------------"
        ],
        "includes/html/print-customoid.php||includes/html/print-customoid.php": [
          "File: includes/html/print-customoid.php -> includes/html/print-customoid.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "112: echo '</table>",
          "113: </div>",
          "116: </form>';",
          "118: ?>",
          "",
          "[Removed Lines]",
          "114: <input type=\"hidden\" name=\"page_num\" id=\"page_num\" value=\"' . $page_num . '\">",
          "115: <input type=\"hidden\" name=\"num_of_rows\" id=\"num_of_rows\" value=\"' . $rows . '\">",
          "",
          "[Added Lines]",
          "114: <input type=\"hidden\" name=\"page_num\" id=\"page_num\" value=\"' . htmlspecialchars($page_num) . '\">",
          "115: <input type=\"hidden\" name=\"num_of_rows\" id=\"num_of_rows\" value=\"' . htmlspecialchars($rows) . '\">",
          "",
          "---------------"
        ]
      }
    }
  ]
}