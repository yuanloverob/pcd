{
  "cve_id": "CVE-2020-36641",
  "cve_desc": "A vulnerability classified as problematic was found in gturri aXMLRPC up to 1.12.0. This vulnerability affects the function ResponseParser of the file src/main/java/de/timroes/axmlrpc/ResponseParser.java. The manipulation leads to xml external entity reference. Upgrading to version 1.14.0 is able to address this issue. The patch is identified as 456752ebc1ef4c0db980cb5b01a0b3cd0a9e0bae. It is recommended to upgrade the affected component. VDB-217450 is the identifier assigned to this vulnerability.",
  "repo": "gturri/aXMLRPC",
  "patch_hash": "ad6615b3ec41353e614f6ea5fdd5b046442a832b",
  "patch_info": {
    "commit_hash": "ad6615b3ec41353e614f6ea5fdd5b046442a832b",
    "repo": "gturri/aXMLRPC",
    "commit_url": "https://github.com/gturri/aXMLRPC/commit/ad6615b3ec41353e614f6ea5fdd5b046442a832b",
    "files": [
      "Changelog",
      "src/main/java/de/timroes/axmlrpc/ResponseParser.java"
    ],
    "message": "Fix CWE-611\n\nThis commit fixes the issue described on\nhttps://cwe.mitre.org/data/definitions/611.html\n\ntest",
    "before_after_code_files": [
      "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java"
    ]
  },
  "patch_diff": {
    "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java": [
      "File: src/main/java/de/timroes/axmlrpc/ResponseParser.java -> src/main/java/de/timroes/axmlrpc/ResponseParser.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: import javax.xml.parsers.DocumentBuilder;",
      "12: import javax.xml.parsers.DocumentBuilderFactory;",
      "13: import javax.xml.transform.OutputKeys;",
      "14: import javax.xml.transform.Transformer;",
      "15: import javax.xml.transform.TransformerException;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13: import javax.xml.parsers.ParserConfigurationException;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "45:  public Object parse(SerializerHandler serializerHandler, InputStream response, boolean debugMode) throws XMLRPCException {",
      "47:   try {",
      "49:    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
      "50:    factory.setNamespaceAware(true);",
      "51:    DocumentBuilder builder = factory.newDocumentBuilder();",
      "52:    Document dom = builder.parse(response);",
      "53:    if (debugMode ){",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "53:    factory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
      "54:    factory.setExpandEntityReferences(false);",
      "56:    factory.setXIncludeAware(false);",
      "57:    factory.setExpandEntityReferences(false);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1532363c6d3a06174a88d395b93df58811de5445",
      "candidate_info": {
        "commit_hash": "1532363c6d3a06174a88d395b93df58811de5445",
        "repo": "gturri/aXMLRPC",
        "commit_url": "https://github.com/gturri/aXMLRPC/commit/1532363c6d3a06174a88d395b93df58811de5445",
        "files": [
          "Changelog",
          "src/main/java/de/timroes/axmlrpc/ResponseParser.java"
        ],
        "message": "Revert to last known working state\n\nThe latest commits seem to have brough some regressions, in\nparticular #108 and #109 (and some NonImplementedExceptions\nhave been observed in some other tests).\n\nThis revert is made in order to fix those issues before a better fix\nis done.",
        "before_after_code_files": [
          "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java"
          ],
          "candidate": [
            "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/de/timroes/axmlrpc/ResponseParser.java||src/main/java/de/timroes/axmlrpc/ResponseParser.java": [
          "File: src/main/java/de/timroes/axmlrpc/ResponseParser.java -> src/main/java/de/timroes/axmlrpc/ResponseParser.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: import javax.xml.parsers.DocumentBuilder;",
          "12: import javax.xml.parsers.DocumentBuilderFactory;",
          "14: import javax.xml.transform.OutputKeys;",
          "15: import javax.xml.transform.Transformer;",
          "16: import javax.xml.transform.TransformerException;",
          "",
          "[Removed Lines]",
          "13: import javax.xml.parsers.ParserConfigurationException;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "46:  public Object parse(SerializerHandler serializerHandler, InputStream response, boolean debugMode) throws XMLRPCException {",
          "48:   try {",
          "55:    factory.setNamespaceAware(true);",
          "60:    DocumentBuilder builder = factory.newDocumentBuilder();",
          "61:    Document dom = builder.parse(response);",
          "62:    if (debugMode ){",
          "",
          "[Removed Lines]",
          "49:    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
          "53:    factory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
          "54:    factory.setExpandEntityReferences(false);",
          "56:    factory.setXIncludeAware(false);",
          "57:    factory.setExpandEntityReferences(false);",
          "",
          "[Added Lines]",
          "49:    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
          "",
          "---------------"
        ]
      }
    }
  ]
}