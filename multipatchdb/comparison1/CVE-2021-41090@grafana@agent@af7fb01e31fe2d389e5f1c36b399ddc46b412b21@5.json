{
  "cve_id": "CVE-2021-41090",
  "cve_desc": "Grafana Agent is a telemetry collector for sending metrics, logs, and trace data to the opinionated Grafana observability stack. Prior to versions 0.20.1 and 0.21.2, inline secrets defined within a metrics instance config are exposed in plaintext over two endpoints: metrics instance configs defined in the base YAML file are exposed at `/-/config` and metrics instance configs defined for the scraping service are exposed at `/agent/api/v1/configs/:key`. Inline secrets will be exposed to anyone being able to reach these endpoints. If HTTPS with client authentication is not configured, these endpoints are accessible to unauthenticated users. Secrets found in these sections are used for delivering metrics to a Prometheus Remote Write system, authenticating against a system for discovering Prometheus targets, and authenticating against a system for collecting metrics. This does not apply for non-inlined secrets, such as `*_file` based secrets. This issue is patched in Grafana Agent versions 0.20.1 and 0.21.2. A few workarounds are available. Users who cannot upgrade should use non-inline secrets where possible. Users may also desire to restrict API access to Grafana Agent with some combination of restricting the network interfaces Grafana Agent listens on through `http_listen_address` in the `server` block, configuring Grafana Agent to use HTTPS with client authentication, and/or using firewall rules to restrict external access to Grafana Agent's API.",
  "repo": "grafana/agent",
  "patch_hash": "af7fb01e31fe2d389e5f1c36b399ddc46b412b21",
  "patch_info": {
    "commit_hash": "af7fb01e31fe2d389e5f1c36b399ddc46b412b21",
    "repo": "grafana/agent",
    "commit_url": "https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21",
    "files": [
      "CHANGELOG.md",
      "docs/configuration/integrations/node-exporter-config.md",
      "docs/configuration/integrations/process-exporter-config.md",
      "docs/getting-started/_index.md",
      "docs/operator/custom-resource-quickstart.md",
      "docs/operator/getting-started.md",
      "docs/upgrade-guide/_index.md",
      "pkg/operator/defaults.go",
      "production/README.md",
      "production/grafanacloud-install.sh",
      "production/kubernetes/agent-bare.yaml",
      "production/kubernetes/agent-loki.yaml",
      "production/kubernetes/agent-traces.yaml",
      "production/kubernetes/build/lib/version.libsonnet",
      "production/kubernetes/install-bare.sh",
      "production/tanka/grafana-agent/v1/main.libsonnet",
      "production/tanka/grafana-agent/v2/internal/base.libsonnet",
      "production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
    ],
    "message": "announce patch releases for cve-2021-41090 (#1152)",
    "before_after_code_files": [
      "pkg/operator/defaults.go||pkg/operator/defaults.go",
      "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
      "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
      "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
      "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
      "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
      "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
    ]
  },
  "patch_diff": {
    "pkg/operator/defaults.go||pkg/operator/defaults.go": [
      "File: pkg/operator/defaults.go -> pkg/operator/defaults.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "15:   \"v0.18.4\",",
      "16:   \"v0.19.0\",",
      "17:   \"v0.20.0\",",
      "18:   \"v0.21.0\",",
      "19:   \"v0.21.1\",",
      "22:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "18:   \"v0.20.1\",",
      "21:   \"v0.21.2\",",
      "",
      "---------------"
    ],
    "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
      "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
      "--- Hunk 1 ---",
      "[Context before]",
      "50: #",
      "51: # Global constants.",
      "52: #",
      "55: RELEASE_URL=\"https://github.com/grafana/agent/releases/download/v${RELEASE_VERSION}\"",
      "56: DEB_URL=\"${RELEASE_URL}/grafana-agent-${RELEASE_VERSION}-1.${ARCH}.deb\"",
      "",
      "[Removed Lines]",
      "53: RELEASE_VERSION=\"0.21.1\"",
      "",
      "[Added Lines]",
      "53: RELEASE_VERSION=\"0.21.2\"",
      "",
      "---------------"
    ],
    "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
      "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1: 'grafana/agent:v0.21.1'",
      "",
      "[Added Lines]",
      "1: 'grafana/agent:v0.21.2'",
      "",
      "---------------"
    ],
    "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
      "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
      "--- Hunk 1 ---",
      "[Context before]",
      "25: check_installed curl",
      "26: check_installed envsubst",
      "29: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
      "30: NAMESPACE=${NAMESPACE:-default}",
      "",
      "[Removed Lines]",
      "28: MANIFEST_BRANCH=v0.21.1",
      "",
      "[Added Lines]",
      "28: MANIFEST_BRANCH=v0.21.2",
      "",
      "---------------"
    ],
    "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
      "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
      "--- Hunk 1 ---",
      "[Context before]",
      "15: (import './lib/traces.libsonnet') +",
      "16: {",
      "17:   _images:: {",
      "20:   },",
      "",
      "[Removed Lines]",
      "18:     agent: 'grafana/agent:v0.21.1',",
      "19:     agentctl: 'grafana/agentctl:v0.21.1',",
      "",
      "[Added Lines]",
      "18:     agent: 'grafana/agent:v0.21.2',",
      "19:     agentctl: 'grafana/agentctl:v0.21.2',",
      "",
      "---------------"
    ],
    "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet": [
      "File: production/tanka/grafana-agent/v2/internal/base.libsonnet -> production/tanka/grafana-agent/v2/internal/base.libsonnet",
      "--- Hunk 1 ---",
      "[Context before]",
      "10:   local this = self,",
      "12:   _images:: {",
      "15:   },",
      "16:   _config:: {",
      "17:     name: name,",
      "",
      "[Removed Lines]",
      "13:     agent: 'grafana/agent:v0.21.1',",
      "14:     agentctl: 'grafana/agentctl:v0.21.1',",
      "",
      "[Added Lines]",
      "13:     agent: 'grafana/agent:v0.21.2',",
      "14:     agentctl: 'grafana/agentctl:v0.21.2',",
      "",
      "---------------"
    ],
    "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet": [
      "File: production/tanka/grafana-agent/v2/internal/syncer.libsonnet -> production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
      "--- Hunk 1 ---",
      "[Context before]",
      "14: ) {",
      "15:   local _config = {",
      "16:     api: error 'api must be set',",
      "18:     schedule: '*/5 * * * *',",
      "19:     configs: [],",
      "20:   } + config,",
      "",
      "[Removed Lines]",
      "17:     image: 'grafana/agentctl:v0.21.1',",
      "",
      "[Added Lines]",
      "17:     image: 'grafana/agentctl:v0.21.2',",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7c68a9c2fb0763872a091ce7e411f9df3163db7d",
      "candidate_info": {
        "commit_hash": "7c68a9c2fb0763872a091ce7e411f9df3163db7d",
        "repo": "grafana/agent",
        "commit_url": "https://github.com/grafana/agent/commit/7c68a9c2fb0763872a091ce7e411f9df3163db7d",
        "files": [
          "CHANGELOG.md",
          "docs/configuration-reference.md",
          "docs/getting-started.md",
          "docs/migration-guide.md",
          "production/README.md",
          "production/grafanacloud-install.sh",
          "production/kubernetes/agent-bare.yaml",
          "production/kubernetes/agent-loki.yaml",
          "production/kubernetes/agent-sigv4.yaml",
          "production/kubernetes/agent-tempo.yaml",
          "production/kubernetes/agent.yaml",
          "production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh",
          "production/kubernetes/install-loki.sh",
          "production/kubernetes/install-sigv4.sh",
          "production/kubernetes/install-tempo.sh",
          "production/kubernetes/install.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet"
        ],
        "message": "Prepare for 0.14.0 release (#596)\n\n* prepare for 0.14.0 release\n\n* remove breaking change that only applied between release candidates\n\n* remove FreeBSD warning",
        "before_after_code_files": [
          "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
          "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
          "production/kubernetes/install-loki.sh||production/kubernetes/install-loki.sh",
          "production/kubernetes/install-sigv4.sh||production/kubernetes/install-sigv4.sh",
          "production/kubernetes/install-tempo.sh||production/kubernetes/install-tempo.sh",
          "production/kubernetes/install.sh||production/kubernetes/install.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
          ],
          "candidate": [
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
          ]
        }
      },
      "candidate_diff": {
        "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
          "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: #",
          "48: # Global constants.",
          "49: #",
          "52: RELEASE_URL=\"https://github.com/grafana/agent/releases/download/v${RELEASE_VERSION}\"",
          "53: DEB_URL=\"${RELEASE_URL}/grafana-agent-${RELEASE_VERSION}-1.${ARCH}.deb\"",
          "",
          "[Removed Lines]",
          "50: RELEASE_VERSION=\"0.13.1\"",
          "",
          "[Added Lines]",
          "50: RELEASE_VERSION=\"0.14.0\"",
          "",
          "---------------"
        ],
        "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
          "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 'grafana/agent:v0.13.1'",
          "",
          "[Added Lines]",
          "1: 'grafana/agent:v0.14.0'",
          "",
          "---------------"
        ],
        "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
          "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: check_installed curl",
          "18: check_installed envsubst",
          "21: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
          "22: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "20: MANIFEST_BRANCH=v0.13.1",
          "",
          "[Added Lines]",
          "20: MANIFEST_BRANCH=v0.14.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-loki.sh||production/kubernetes/install-loki.sh": [
          "File: production/kubernetes/install-loki.sh -> production/kubernetes/install-loki.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: check_installed curl",
          "32: check_installed envsubst",
          "35: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-loki.yaml}",
          "36: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "34: MANIFEST_BRANCH=v0.13.1",
          "",
          "[Added Lines]",
          "34: MANIFEST_BRANCH=v0.14.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-sigv4.sh||production/kubernetes/install-sigv4.sh": [
          "File: production/kubernetes/install-sigv4.sh -> production/kubernetes/install-sigv4.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: check_installed curl",
          "31: check_installed envsubst",
          "34: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-sigv4.yaml}",
          "35: NAMESPACE=${NAMESPACE:-default}",
          "36: ROLE_ARN=${ROLE_ARN:-}",
          "",
          "[Removed Lines]",
          "33: MANIFEST_BRANCH=v0.13.1",
          "",
          "[Added Lines]",
          "33: MANIFEST_BRANCH=v0.14.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-tempo.sh||production/kubernetes/install-tempo.sh": [
          "File: production/kubernetes/install-tempo.sh -> production/kubernetes/install-tempo.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: check_installed curl",
          "32: check_installed envsubst",
          "35: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-tempo.yaml}",
          "36: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "34: MANIFEST_BRANCH=v0.13.1",
          "",
          "[Added Lines]",
          "34: MANIFEST_BRANCH=v0.14.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install.sh||production/kubernetes/install.sh": [
          "File: production/kubernetes/install.sh -> production/kubernetes/install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: check_installed curl",
          "33: check_installed envsubst",
          "36: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent.yaml}",
          "37: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "35: MANIFEST_BRANCH=v0.13.1",
          "",
          "[Added Lines]",
          "35: MANIFEST_BRANCH=v0.14.0",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
          "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: (import './lib/tempo.libsonnet') +",
          "16: {",
          "17:   _images:: {",
          "20:   },",
          "",
          "[Removed Lines]",
          "18:     agent: 'grafana/agent:v0.13.1',",
          "19:     agentctl: 'grafana/agentctl:v0.13.1',",
          "",
          "[Added Lines]",
          "18:     agent: 'grafana/agent:v0.14.0',",
          "19:     agentctl: 'grafana/agentctl:v0.14.0',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b2957de6bd48413d597523f29122b4825ef4e4c2",
      "candidate_info": {
        "commit_hash": "b2957de6bd48413d597523f29122b4825ef4e4c2",
        "repo": "grafana/agent",
        "commit_url": "https://github.com/grafana/agent/commit/b2957de6bd48413d597523f29122b4825ef4e4c2",
        "files": [
          ".drone/drone.yml",
          "CHANGELOG.md",
          "cmd/agent-operator/Dockerfile",
          "cmd/agent/Dockerfile",
          "cmd/agentctl/Dockerfile",
          "docs/sources/configuration/integrations/node-exporter-config.md",
          "docs/sources/configuration/integrations/process-exporter-config.md",
          "docs/sources/operator/custom-resource-quickstart.md",
          "docs/sources/operator/getting-started.md",
          "docs/sources/set-up/install-agent-docker.md",
          "pkg/operator/defaults.go",
          "production/grafanacloud-install.sh",
          "production/kubernetes/agent-bare.yaml",
          "production/kubernetes/agent-loki.yaml",
          "production/kubernetes/agent-traces.yaml",
          "production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/build/templates/operator/main.jsonnet",
          "production/kubernetes/install-bare.sh",
          "production/operator/templates/agent-operator.yaml",
          "production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
          "tools/ci/docker-containers",
          "tools/crow/Dockerfile",
          "tools/make/packaging.mk",
          "tools/release",
          "tools/release-note.md",
          "tools/smoke/Dockerfile"
        ],
        "message": "Merge branch release-v0.28 into main (#2210)\n\n* prepare for v0.28.0-rc.0 release (#2204)\n\n* prepare for v0.28.0-rc.0 release\n\n* alphabetize contributors to Flow\n\n* fix invalid GOOS when generating release assets\n\n* tools/ci: s/VERISON/VERSION\n\n* s/VERISON/VERSION\n\n* tools/release: print commands\n\n* fix generation of github release draft\n\n* update github release draft note\n\n* update release script to pass drone tag directly\n\n* fix bad path for release note",
        "before_after_code_files": [
          "pkg/operator/defaults.go||pkg/operator/defaults.go",
          "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
          "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/build/templates/operator/main.jsonnet||production/kubernetes/build/templates/operator/main.jsonnet",
          "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
          "tools/make/packaging.mk||tools/make/packaging.mk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ],
          "candidate": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ]
        }
      },
      "candidate_diff": {
        "pkg/operator/defaults.go||pkg/operator/defaults.go": [
          "File: pkg/operator/defaults.go -> pkg/operator/defaults.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:   \"v0.26.1\",",
          "31:   \"v0.27.0\",",
          "32:   \"v0.27.1\",",
          "34:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33:   \"v0.28.0-rc.0\",",
          "",
          "---------------"
        ],
        "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
          "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: #",
          "51: # Global constants.",
          "52: #",
          "55: # The DEB and RPM urls don't include the `v` version prefix in the file names,",
          "56: # so we trim it out using ${RELEASE_VERSION#v} below.",
          "",
          "[Removed Lines]",
          "53: RELEASE_VERSION=\"v0.27.1\"",
          "",
          "[Added Lines]",
          "53: RELEASE_VERSION=\"v0.28.0-rc.0\"",
          "",
          "---------------"
        ],
        "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
          "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 'grafana/agent:v0.27.1'",
          "",
          "[Added Lines]",
          "1: 'grafana/agent:v0.28.0-rc.0'",
          "",
          "---------------"
        ],
        "production/kubernetes/build/templates/operator/main.jsonnet||production/kubernetes/build/templates/operator/main.jsonnet": [
          "File: production/kubernetes/build/templates/operator/main.jsonnet -> production/kubernetes/build/templates/operator/main.jsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: local op = import 'grafana-agent-operator/operator.libsonnet';",
          "13: local ga_util = import 'grafana-agent-operator/util/grafana-agent.libsonnet';",
          "15: local li_util = import 'grafana-agent-operator/util/logsinstance.libsonnet';",
          "16: local pl_util = import 'grafana-agent-operator/util/k8slogs.libsonnet';",
          "17: local mon_util = import 'grafana-agent-operator/util/k8smonitors.libsonnet';",
          "",
          "[Removed Lines]",
          "14: local mi_util =  import 'grafana-agent-operator/util/metricsinstance.libsonnet';",
          "",
          "[Added Lines]",
          "14: local mi_util = import 'grafana-agent-operator/util/metricsinstance.libsonnet';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23:   local this = self,",
          "25:   _images:: {",
          "29:   },",
          "31:   _config:: {",
          "",
          "[Removed Lines]",
          "26:     agent: 'grafana/agent:v0.27.1',",
          "27:     agent_operator: 'grafana/agent-operator:v0.27.1',",
          "28:     ksm: 'registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.5.0'",
          "",
          "[Added Lines]",
          "26:     agent: 'grafana/agent:v0.28.0-rc.0',",
          "27:     agent_operator: 'grafana/agent-operator:v0.28.0-rc.0',",
          "28:     ksm: 'registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.5.0',",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "36:     logs_url: '${LOGS_URL}',",
          "37:     logs_user: '${LOGS_USER}',",
          "38:     logs_key: '${LOGS_KEY}',",
          "40:     kubelet_job: 'kubelet',",
          "41:     cadvisor_job: 'cadvisor',",
          "42:     ksm_job: 'kube-state-metrics',",
          "",
          "[Removed Lines]",
          "39:     cluster_label: {cluster: '${CLUSTER}'},",
          "",
          "[Added Lines]",
          "39:     cluster_label: { cluster: '${CLUSTER}' },",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "46:   operator:",
          "47:     op.new(name='grafana-agent-operator', namespace=this._config.namespace, image=this._images.agent_operator, serviceAccount='grafana-agent-operator') +",
          "48:     op.withRbac(name='grafana-agent-operator', namespace=this._config.namespace),",
          "50:   grafana_agent:",
          "51:     ga.new(name='grafana-agent') +",
          "52:     ga.metadata.withNamespace(this._config.namespace) +",
          "53:     ga.spec.withServiceAccountName('grafana-agent') +",
          "54:     ga.spec.withImage(this._images.agent) +",
          "62:   metrics_instance:",
          "63:     mi.new(name='grafana-agent-metrics') +",
          "64:     mi.metadata.withNamespace(this._config.namespace) +",
          "67:     mi_util.withRemoteWrite(secretName='metrics-secret', metricsUrl=this._config.metrics_url) +",
          "68:     mi_util.withNilServiceMonitorNamespace(),",
          "76:   logs_instance:",
          "77:     li.new(name='grafana-agent-logs') +",
          "78:     li.metadata.withNamespace(this._config.namespace) +",
          "81:     li_util.withLogsClient(secretName='logs-secret', logsUrl=this._config.logs_url, externalLabels=this._config.cluster_label) +",
          "82:     li_util.withNilPodLogsNamespace(),",
          "90:   pod_logs:",
          "91:     pl.new('kubernetes-logs') +",
          "92:     pl.metadata.withNamespace(this._config.namespace) +",
          "94:     pl.spec.withPipelineStages(pl.spec.pipelineStages.withCri({})) +",
          "95:     pl.spec.namespaceSelector.withAny(true) +",
          "96:     pl.spec.selector.withMatchLabels({}) +",
          "",
          "[Removed Lines]",
          "55:     ga.spec.metrics.instanceSelector.withMatchLabels({agent: 'grafana-agent'}) +",
          "56:     ga.spec.logs.instanceSelector.withMatchLabels({agent: 'grafana-agent'}) +",
          "57:     ga.spec.integrations.selector.withMatchLabels({agent: 'grafana-agent'}) +",
          "58:     ga.spec.metrics.withExternalLabels(this._config.cluster_label),",
          "59:     rbac:",
          "60:       ga_util.withRbac(name='grafana-agent', namespace=this._config.namespace),",
          "65:     mi.metadata.withLabels({agent: 'grafana-agent'}) +",
          "66:     mi.spec.serviceMonitorSelector.withMatchLabels({instance: 'primary'}) +",
          "69:     metrics_secret:",
          "70:       secret.new('metrics-secret', {}) +",
          "71:       secret.withStringData({",
          "72:           username: this._config.metrics_user,",
          "73:           password: this._config.metrics_key,",
          "74:       }) + secret.mixin.metadata.withNamespace(this._config.namespace),",
          "79:     li.metadata.withLabels({agent: 'grafana-agent'}) +",
          "80:     li.spec.podLogsSelector.withMatchLabels({instance: 'primary'}) +",
          "83:     logs_secret:",
          "84:       secret.new('logs-secret', {}) +",
          "85:       secret.withStringData({",
          "86:           username: this._config.logs_user,",
          "87:           password: this._config.logs_key,",
          "88:       }) + secret.mixin.metadata.withNamespace(this._config.namespace),",
          "93:     pl.metadata.withLabels({instance: 'primary'}) +",
          "",
          "[Added Lines]",
          "55:     ga.spec.metrics.instanceSelector.withMatchLabels({ agent: 'grafana-agent' }) +",
          "56:     ga.spec.logs.instanceSelector.withMatchLabels({ agent: 'grafana-agent' }) +",
          "57:     ga.spec.integrations.selector.withMatchLabels({ agent: 'grafana-agent' }) +",
          "58:     ga.spec.metrics.withExternalLabels(this._config.cluster_label),",
          "59:   rbac:",
          "60:     ga_util.withRbac(name='grafana-agent', namespace=this._config.namespace),",
          "65:     mi.metadata.withLabels({ agent: 'grafana-agent' }) +",
          "66:     mi.spec.serviceMonitorSelector.withMatchLabels({ instance: 'primary' }) +",
          "69:   metrics_secret:",
          "70:     secret.new('metrics-secret', {}) +",
          "71:     secret.withStringData({",
          "72:       username: this._config.metrics_user,",
          "73:       password: this._config.metrics_key,",
          "74:     }) + secret.mixin.metadata.withNamespace(this._config.namespace),",
          "79:     li.metadata.withLabels({ agent: 'grafana-agent' }) +",
          "80:     li.spec.podLogsSelector.withMatchLabels({ instance: 'primary' }) +",
          "83:   logs_secret:",
          "84:     secret.new('logs-secret', {}) +",
          "85:     secret.withStringData({",
          "86:       username: this._config.logs_user,",
          "87:       password: this._config.logs_key,",
          "88:     }) + secret.mixin.metadata.withNamespace(this._config.namespace),",
          "93:     pl.metadata.withLabels({ instance: 'primary' }) +",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "99:   k8s_monitors: [",
          "100:     mon_util.newKubernetesMonitor(",
          "104:       targetNamespace=this._config.namespace,",
          "106:       jobLabel=this._config.kubelet_job,",
          "107:       metricsPath='/metrics',",
          "110:     mon_util.newKubernetesMonitor(",
          "114:       targetNamespace=this._config.namespace,",
          "116:       jobLabel=this._config.cadvisor_job,",
          "117:       metricsPath='/metrics/cadvisor',",
          "120:     mon_util.newServiceMonitor(",
          "121:       name='ksm-monitor',",
          "126:       jobLabel=this._config.ksm_job,",
          "127:       metricsPath='/metrics',",
          "130:   ],",
          "132:   kube_state_metrics:",
          "133:     ksm {",
          "134:       name:: 'kube-state-metrics',",
          "",
          "[Removed Lines]",
          "101:       name='kubelet-monitor',",
          "102:       namespace=this._config.namespace,",
          "103:       monitorLabels={instance: 'primary'},",
          "105:       targetLabels={'app.kubernetes.io/name': 'kubelet'},",
          "108:       allowlist=false,",
          "109:       allowlistMetrics=[]),",
          "111:       name='cadvisor-monitor',",
          "112:       namespace='default',",
          "113:       monitorLabels={instance: 'primary'},",
          "115:       targetLabels={'app.kubernetes.io/name': 'kubelet'},",
          "118:       allowlist=false,",
          "119:       allowlistMetrics=[]),",
          "122:       namespace=this._config.namespace,",
          "123:       monitorLabels={instance: 'primary'},",
          "124:       targetNamespace=this._config.namespace,",
          "125:       targetLabels={'app.kubernetes.io/name': 'kube-state-metrics'},",
          "128:       allowlist=false,",
          "129:       allowlistMetrics=[]),",
          "",
          "[Added Lines]",
          "101:       name='kubelet-monitor',",
          "102:       namespace=this._config.namespace,",
          "103:       monitorLabels={ instance: 'primary' },",
          "105:       targetLabels={ 'app.kubernetes.io/name': 'kubelet' },",
          "108:       allowlist=false,",
          "109:       allowlistMetrics=[]",
          "110:     ),",
          "112:       name='cadvisor-monitor',",
          "113:       namespace='default',",
          "114:       monitorLabels={ instance: 'primary' },",
          "116:       targetLabels={ 'app.kubernetes.io/name': 'kubelet' },",
          "119:       allowlist=false,",
          "120:       allowlistMetrics=[]",
          "121:     ),",
          "124:       namespace=this._config.namespace,",
          "125:       monitorLabels={ instance: 'primary' },",
          "126:       targetNamespace=this._config.namespace,",
          "127:       targetLabels={ 'app.kubernetes.io/name': 'kube-state-metrics' },",
          "130:       allowlist=false,",
          "131:       allowlistMetrics=[]",
          "132:     ),",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "140:   events:",
          "141:     int.new('agent-eventhandler') +",
          "142:     int.metadata.withNamespace(this._config.namespace) +",
          "145:     int.spec.type.withUnique(true) +",
          "146:     int.spec.withConfig({",
          "149:     }) +",
          "150:     int_util.withPVC('agent-eventhandler'),",
          "157: }",
          "",
          "[Removed Lines]",
          "143:     int.metadata.withLabels({agent: 'grafana-agent'}) +",
          "144:     int.spec.withName(\"eventhandler\") +",
          "147:         logs_instance: this._config.namespace + '/' + 'grafana-agent-logs',",
          "148:         cache_path: '/etc/eventhandler/eventhandler.cache',",
          "151:     pvc:",
          "152:       pvc.new('agent-eventhandler') +",
          "153:       pvc.mixin.metadata.withNamespace(this._config.namespace) +",
          "154:       pvc.mixin.spec.withAccessModes('ReadWriteOnce') +",
          "155:       pvc.mixin.spec.resources.withRequests({ storage: '1Gi' }),",
          "",
          "[Added Lines]",
          "146:     int.metadata.withLabels({ agent: 'grafana-agent' }) +",
          "147:     int.spec.withName('eventhandler') +",
          "150:       logs_instance: this._config.namespace + '/' + 'grafana-agent-logs',",
          "151:       cache_path: '/etc/eventhandler/eventhandler.cache',",
          "154:   pvc:",
          "155:     pvc.new('agent-eventhandler') +",
          "156:     pvc.mixin.metadata.withNamespace(this._config.namespace) +",
          "157:     pvc.mixin.spec.withAccessModes('ReadWriteOnce') +",
          "158:     pvc.mixin.spec.resources.withRequests({ storage: '1Gi' }),",
          "",
          "---------------"
        ],
        "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
          "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: check_installed curl",
          "26: check_installed envsubst",
          "29: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
          "30: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "28: MANIFEST_BRANCH=v0.27.1",
          "",
          "[Added Lines]",
          "28: MANIFEST_BRANCH=v0.28.0-rc.0",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
          "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: (import './lib/traces.libsonnet') +",
          "16: {",
          "17:   _images:: {",
          "20:   },",
          "",
          "[Removed Lines]",
          "18:     agent: 'grafana/agent:v0.27.1',",
          "19:     agentctl: 'grafana/agentctl:v0.27.1',",
          "",
          "[Added Lines]",
          "18:     agent: 'grafana/agent:v0.28.0-rc.0',",
          "19:     agentctl: 'grafana/agentctl:v0.28.0-rc.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/base.libsonnet -> production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:   local this = self,",
          "13:   _images:: {",
          "16:   },",
          "17:   _config:: {",
          "18:     name: name,",
          "",
          "[Removed Lines]",
          "14:     agent: 'grafana/agent:v0.27.1',",
          "15:     agentctl: 'grafana/agentctl:v0.27.1',",
          "",
          "[Added Lines]",
          "14:     agent: 'grafana/agent:v0.28.0-rc.0',",
          "15:     agentctl: 'grafana/agentctl:v0.28.0-rc.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/syncer.libsonnet -> production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: ) {",
          "15:   local _config = {",
          "16:     api: error 'api must be set',",
          "18:     schedule: '*/5 * * * *',",
          "19:     configs: [],",
          "20:   } + config,",
          "",
          "[Removed Lines]",
          "17:     image: 'grafana/agentctl:v0.27.1',",
          "",
          "[Added Lines]",
          "17:     image: 'grafana/agentctl:v0.28.0-rc.0',",
          "",
          "---------------"
        ],
        "tools/make/packaging.mk||tools/make/packaging.mk": [
          "File: tools/make/packaging.mk -> tools/make/packaging.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "74:  $(PACKAGING_VARS) AGENT_BINARY=$@ $(MAKE) -f $(PARENT_MAKEFILE) agent",
          "76: dist/agent-windows-amd64.exe: GO_TAGS += builtinassets",
          "78: dist/agent-windows-amd64.exe: GOARCH  := amd64",
          "79: dist/agent-windows-amd64.exe: generate-ui",
          "80:  $(PACKAGING_VARS) AGENT_BINARY=$@ $(MAKE) -f $(PARENT_MAKEFILE) agent",
          "",
          "[Removed Lines]",
          "77: dist/agent-windows-amd64.exe: GOOS    := windows builtinassets",
          "",
          "[Added Lines]",
          "77: dist/agent-windows-amd64.exe: GOOS    := windows",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8c6e7be403044be7d54344d8bda00c44d2349be0",
      "candidate_info": {
        "commit_hash": "8c6e7be403044be7d54344d8bda00c44d2349be0",
        "repo": "grafana/agent",
        "commit_url": "https://github.com/grafana/agent/commit/8c6e7be403044be7d54344d8bda00c44d2349be0",
        "files": [
          "CHANGELOG.md",
          "docs/user/configuration/integrations/node-exporter-config.md",
          "docs/user/configuration/integrations/process-exporter-config.md",
          "docs/user/getting-started/_index.md",
          "docs/user/operator/custom-resource-quickstart.md",
          "docs/user/operator/getting-started.md",
          "docs/user/upgrade-guide/_index.md",
          "pkg/operator/defaults.go",
          "production/README.md",
          "production/grafanacloud-install.sh",
          "production/kubernetes/agent-bare.yaml",
          "production/kubernetes/agent-loki.yaml",
          "production/kubernetes/agent-traces.yaml",
          "production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
        ],
        "message": "release v0.24.0 (#1574) (#1577)\n\n(cherry picked from commit 4ec400bf3cc81b0df939bf835cb0be16e5a16714)",
        "before_after_code_files": [
          "pkg/operator/defaults.go||pkg/operator/defaults.go",
          "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
          "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ],
          "candidate": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ]
        }
      },
      "candidate_diff": {
        "pkg/operator/defaults.go||pkg/operator/defaults.go": [
          "File: pkg/operator/defaults.go -> pkg/operator/defaults.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "21:   \"v0.21.2\",",
          "22:   \"v0.22.0\",",
          "23:   \"v0.23.0\",",
          "27:  }",
          "",
          "[Removed Lines]",
          "24:   \"v0.24.0-rc.0\",",
          "",
          "[Added Lines]",
          "24:   \"v0.24.0\",",
          "",
          "---------------"
        ],
        "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
          "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: #",
          "51: # Global constants.",
          "52: #",
          "55: RELEASE_URL=\"https://github.com/grafana/agent/releases/download/v${RELEASE_VERSION}\"",
          "56: DEB_URL=\"${RELEASE_URL}/grafana-agent-${RELEASE_VERSION}-1.${ARCH}.deb\"",
          "",
          "[Removed Lines]",
          "53: RELEASE_VERSION=\"0.24.0-rc.0\"",
          "",
          "[Added Lines]",
          "53: RELEASE_VERSION=\"0.24.0\"",
          "",
          "---------------"
        ],
        "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
          "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 'grafana/agent:v0.24.0-rc.0'",
          "",
          "[Added Lines]",
          "1: 'grafana/agent:v0.24.0'",
          "",
          "---------------"
        ],
        "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
          "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: check_installed curl",
          "26: check_installed envsubst",
          "29: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
          "30: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "28: MANIFEST_BRANCH=v0.24.0-rc.0",
          "",
          "[Added Lines]",
          "28: MANIFEST_BRANCH=v0.24.0",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
          "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: (import './lib/traces.libsonnet') +",
          "16: {",
          "17:   _images:: {",
          "20:   },",
          "",
          "[Removed Lines]",
          "18:     agent: 'grafana/agent:v0.24.0-rc.0',",
          "19:     agentctl: 'grafana/agentctl:v0.24.0-rc.0',",
          "",
          "[Added Lines]",
          "18:     agent: 'grafana/agent:v0.24.0',",
          "19:     agentctl: 'grafana/agentctl:v0.24.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/base.libsonnet -> production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:   local this = self,",
          "13:   _images:: {",
          "16:   },",
          "17:   _config:: {",
          "18:     name: name,",
          "",
          "[Removed Lines]",
          "14:     agent: 'grafana/agent:v0.24.0-rc.0',",
          "15:     agentctl: 'grafana/agentctl:v0.24.0-rc.0',",
          "",
          "[Added Lines]",
          "14:     agent: 'grafana/agent:v0.24.0',",
          "15:     agentctl: 'grafana/agentctl:v0.24.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/syncer.libsonnet -> production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: ) {",
          "15:   local _config = {",
          "16:     api: error 'api must be set',",
          "18:     schedule: '*/5 * * * *',",
          "19:     configs: [],",
          "20:   } + config,",
          "",
          "[Removed Lines]",
          "17:     image: 'grafana/agentctl:v0.24.0-rc.0',",
          "",
          "[Added Lines]",
          "17:     image: 'grafana/agentctl:v0.24.0',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1cacbe26d0f51d64b786b9ddae41479e6844807f",
      "candidate_info": {
        "commit_hash": "1cacbe26d0f51d64b786b9ddae41479e6844807f",
        "repo": "grafana/agent",
        "commit_url": "https://github.com/grafana/agent/commit/1cacbe26d0f51d64b786b9ddae41479e6844807f",
        "files": [
          ".github/workflows/force_release.yml",
          "CHANGELOG.md",
          "docs/configuration-reference.md",
          "docs/getting-started.md",
          "docs/migration-guide.md",
          "production/README.md",
          "production/grafanacloud-install.sh",
          "production/kubernetes/agent-bare.yaml",
          "production/kubernetes/agent-loki.yaml",
          "production/kubernetes/agent-sigv4.yaml",
          "production/kubernetes/agent-tempo.yaml",
          "production/kubernetes/agent.yaml",
          "production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh",
          "production/kubernetes/install-loki.sh",
          "production/kubernetes/install-sigv4.sh",
          "production/kubernetes/install-tempo.sh",
          "production/kubernetes/install.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet"
        ],
        "message": "Prepare for 0.15.0 (#626)\n\n* prepare for 0.15.0\n\n- cut changelog\n- fix date of 0.14.0 release\n- add force_release.yml back to workflows to perform the release\n\n* add missing space",
        "before_after_code_files": [
          "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
          "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
          "production/kubernetes/install-loki.sh||production/kubernetes/install-loki.sh",
          "production/kubernetes/install-sigv4.sh||production/kubernetes/install-sigv4.sh",
          "production/kubernetes/install-tempo.sh||production/kubernetes/install-tempo.sh",
          "production/kubernetes/install.sh||production/kubernetes/install.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
          ],
          "candidate": [
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet"
          ]
        }
      },
      "candidate_diff": {
        "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
          "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: #",
          "48: # Global constants.",
          "49: #",
          "52: RELEASE_URL=\"https://github.com/grafana/agent/releases/download/v${RELEASE_VERSION}\"",
          "53: DEB_URL=\"${RELEASE_URL}/grafana-agent-${RELEASE_VERSION}-1.${ARCH}.deb\"",
          "",
          "[Removed Lines]",
          "50: RELEASE_VERSION=\"0.14.0\"",
          "",
          "[Added Lines]",
          "50: RELEASE_VERSION=\"0.15.0\"",
          "",
          "---------------"
        ],
        "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
          "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 'grafana/agent:v0.14.0'",
          "",
          "[Added Lines]",
          "1: 'grafana/agent:v0.15.0'",
          "",
          "---------------"
        ],
        "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
          "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: check_installed curl",
          "18: check_installed envsubst",
          "21: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
          "22: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "20: MANIFEST_BRANCH=v0.14.0",
          "",
          "[Added Lines]",
          "20: MANIFEST_BRANCH=v0.15.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-loki.sh||production/kubernetes/install-loki.sh": [
          "File: production/kubernetes/install-loki.sh -> production/kubernetes/install-loki.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: check_installed curl",
          "32: check_installed envsubst",
          "35: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-loki.yaml}",
          "36: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "34: MANIFEST_BRANCH=v0.14.0",
          "",
          "[Added Lines]",
          "34: MANIFEST_BRANCH=v0.15.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-sigv4.sh||production/kubernetes/install-sigv4.sh": [
          "File: production/kubernetes/install-sigv4.sh -> production/kubernetes/install-sigv4.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: check_installed curl",
          "31: check_installed envsubst",
          "34: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-sigv4.yaml}",
          "35: NAMESPACE=${NAMESPACE:-default}",
          "36: ROLE_ARN=${ROLE_ARN:-}",
          "",
          "[Removed Lines]",
          "33: MANIFEST_BRANCH=v0.14.0",
          "",
          "[Added Lines]",
          "33: MANIFEST_BRANCH=v0.15.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install-tempo.sh||production/kubernetes/install-tempo.sh": [
          "File: production/kubernetes/install-tempo.sh -> production/kubernetes/install-tempo.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: check_installed curl",
          "32: check_installed envsubst",
          "35: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-tempo.yaml}",
          "36: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "34: MANIFEST_BRANCH=v0.14.0",
          "",
          "[Added Lines]",
          "34: MANIFEST_BRANCH=v0.15.0",
          "",
          "---------------"
        ],
        "production/kubernetes/install.sh||production/kubernetes/install.sh": [
          "File: production/kubernetes/install.sh -> production/kubernetes/install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: check_installed curl",
          "33: check_installed envsubst",
          "36: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent.yaml}",
          "37: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "35: MANIFEST_BRANCH=v0.14.0",
          "",
          "[Added Lines]",
          "35: MANIFEST_BRANCH=v0.15.0",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
          "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: (import './lib/tempo.libsonnet') +",
          "16: {",
          "17:   _images:: {",
          "20:   },",
          "",
          "[Removed Lines]",
          "18:     agent: 'grafana/agent:v0.14.0',",
          "19:     agentctl: 'grafana/agentctl:v0.14.0',",
          "",
          "[Added Lines]",
          "18:     agent: 'grafana/agent:v0.15.0',",
          "19:     agentctl: 'grafana/agentctl:v0.15.0',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b43fff98c345dde8612de35cf5a62876be9e40ec",
      "candidate_info": {
        "commit_hash": "b43fff98c345dde8612de35cf5a62876be9e40ec",
        "repo": "grafana/agent",
        "commit_url": "https://github.com/grafana/agent/commit/b43fff98c345dde8612de35cf5a62876be9e40ec",
        "files": [
          "CHANGELOG.md",
          "docs/sources/configuration/integrations/node-exporter-config.md",
          "docs/sources/configuration/integrations/process-exporter-config.md",
          "docs/sources/operator/api.md",
          "docs/sources/operator/custom-resource-quickstart.md",
          "docs/sources/operator/getting-started.md",
          "docs/sources/set-up/install-agent-docker.md",
          "example/docker-compose/grafana/dashboards/agent-operational.json",
          "pkg/operator/defaults.go",
          "production/grafanacloud-install.sh",
          "production/kubernetes/agent-bare.yaml",
          "production/kubernetes/agent-loki.yaml",
          "production/kubernetes/agent-traces.yaml",
          "production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/build/templates/operator/main.jsonnet",
          "production/kubernetes/install-bare.sh",
          "production/operator/templates/agent-operator.yaml",
          "production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
        ],
        "message": "v0.29 rc.0 release prep (#2474)",
        "before_after_code_files": [
          "pkg/operator/defaults.go||pkg/operator/defaults.go",
          "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
          "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
          "production/kubernetes/build/templates/operator/main.jsonnet||production/kubernetes/build/templates/operator/main.jsonnet",
          "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
          "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
          "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ],
          "candidate": [
            "pkg/operator/defaults.go||pkg/operator/defaults.go",
            "production/grafanacloud-install.sh||production/grafanacloud-install.sh",
            "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet",
            "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh",
            "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet",
            "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet",
            "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet"
          ]
        }
      },
      "candidate_diff": {
        "pkg/operator/defaults.go||pkg/operator/defaults.go": [
          "File: pkg/operator/defaults.go -> pkg/operator/defaults.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "32:   \"v0.27.1\",",
          "33:   \"v0.28.0\",",
          "34:   \"v0.28.1\",",
          "36:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35:   \"v0.29.0-rc.0\",",
          "",
          "---------------"
        ],
        "production/grafanacloud-install.sh||production/grafanacloud-install.sh": [
          "File: production/grafanacloud-install.sh -> production/grafanacloud-install.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: #",
          "51: # Global constants.",
          "52: #",
          "55: # The DEB and RPM urls don't include the `v` version prefix in the file names,",
          "56: # so we trim it out using ${RELEASE_VERSION#v} below.",
          "",
          "[Removed Lines]",
          "53: RELEASE_VERSION=\"v0.28.1\"",
          "",
          "[Added Lines]",
          "53: RELEASE_VERSION=\"v0.29.0-rc.0\"",
          "",
          "---------------"
        ],
        "production/kubernetes/build/lib/version.libsonnet||production/kubernetes/build/lib/version.libsonnet": [
          "File: production/kubernetes/build/lib/version.libsonnet -> production/kubernetes/build/lib/version.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 'grafana/agent:v0.28.1'",
          "",
          "[Added Lines]",
          "1: 'grafana/agent:v0.29.0-rc.0'",
          "",
          "---------------"
        ],
        "production/kubernetes/build/templates/operator/main.jsonnet||production/kubernetes/build/templates/operator/main.jsonnet": [
          "File: production/kubernetes/build/templates/operator/main.jsonnet -> production/kubernetes/build/templates/operator/main.jsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:   local this = self,",
          "25:   _images:: {",
          "28:     ksm: 'registry.k8s.io/kube-state-metrics/kube-state-metrics:v2.5.0',",
          "29:   },",
          "",
          "[Removed Lines]",
          "26:     agent: 'grafana/agent:v0.28.1',",
          "27:     agent_operator: 'grafana/agent-operator:v0.28.1',",
          "",
          "[Added Lines]",
          "26:     agent: 'grafana/agent:v0.29.0-rc.0',",
          "27:     agent_operator: 'grafana/agent-operator:v0.29.0-rc.0',",
          "",
          "---------------"
        ],
        "production/kubernetes/install-bare.sh||production/kubernetes/install-bare.sh": [
          "File: production/kubernetes/install-bare.sh -> production/kubernetes/install-bare.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: check_installed curl",
          "26: check_installed envsubst",
          "29: MANIFEST_URL=${MANIFEST_URL:-https://raw.githubusercontent.com/grafana/agent/${MANIFEST_BRANCH}/production/kubernetes/agent-bare.yaml}",
          "30: NAMESPACE=${NAMESPACE:-default}",
          "",
          "[Removed Lines]",
          "28: MANIFEST_BRANCH=v0.28.1",
          "",
          "[Added Lines]",
          "28: MANIFEST_BRANCH=v0.29.0-rc.0",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v1/main.libsonnet||production/tanka/grafana-agent/v1/main.libsonnet": [
          "File: production/tanka/grafana-agent/v1/main.libsonnet -> production/tanka/grafana-agent/v1/main.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: (import './lib/traces.libsonnet') +",
          "16: {",
          "17:   _images:: {",
          "20:   },",
          "",
          "[Removed Lines]",
          "18:     agent: 'grafana/agent:v0.28.1',",
          "19:     agentctl: 'grafana/agentctl:v0.28.1',",
          "",
          "[Added Lines]",
          "18:     agent: 'grafana/agent:v0.29.0-rc.0',",
          "19:     agentctl: 'grafana/agentctl:v0.29.0-rc.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/base.libsonnet||production/tanka/grafana-agent/v2/internal/base.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/base.libsonnet -> production/tanka/grafana-agent/v2/internal/base.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:   local this = self,",
          "13:   _images:: {",
          "16:   },",
          "17:   _config:: {",
          "18:     name: name,",
          "",
          "[Removed Lines]",
          "14:     agent: 'grafana/agent:v0.28.1',",
          "15:     agentctl: 'grafana/agentctl:v0.28.1',",
          "",
          "[Added Lines]",
          "14:     agent: 'grafana/agent:v0.29.0-rc.0',",
          "15:     agentctl: 'grafana/agentctl:v0.29.0-rc.0',",
          "",
          "---------------"
        ],
        "production/tanka/grafana-agent/v2/internal/syncer.libsonnet||production/tanka/grafana-agent/v2/internal/syncer.libsonnet": [
          "File: production/tanka/grafana-agent/v2/internal/syncer.libsonnet -> production/tanka/grafana-agent/v2/internal/syncer.libsonnet",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: ) {",
          "15:   local _config = {",
          "16:     api: error 'api must be set',",
          "18:     schedule: '*/5 * * * *',",
          "19:     configs: [],",
          "20:   } + config,",
          "",
          "[Removed Lines]",
          "17:     image: 'grafana/agentctl:v0.28.1',",
          "",
          "[Added Lines]",
          "17:     image: 'grafana/agentctl:v0.29.0-rc.0',",
          "",
          "---------------"
        ]
      }
    }
  ]
}