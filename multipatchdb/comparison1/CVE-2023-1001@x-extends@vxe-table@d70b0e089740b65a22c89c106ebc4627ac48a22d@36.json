{
  "cve_id": "CVE-2023-1001",
  "cve_desc": "A vulnerability, which was classified as problematic, has been found in xuliangzhan vxe-table up to 3.7.9. This issue affects the function export of the file packages/textarea/src/textarea.js of the component vxe-textarea. The manipulation of the argument inputValue leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 3.7.10 is able to address this issue. The patch is named d70b0e089740b65a22c89c106ebc4627ac48a22d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-266123.",
  "repo": "x-extends/vxe-table",
  "patch_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
  "patch_info": {
    "commit_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "repo": "x-extends/vxe-table",
    "commit_url": "https://github.com/x-extends/vxe-table/commit/d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "files": [
      "packages/table/src/body.js",
      "packages/textarea/src/textarea.js"
    ],
    "message": "textarea \u4fee\u590d\u6ce8\u5165xss\u95ee\u9898 #I8O21R",
    "before_after_code_files": [
      "packages/table/src/body.js||packages/table/src/body.js",
      "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js"
    ]
  },
  "patch_diff": {
    "packages/table/src/body.js||packages/table/src/body.js": [
      "File: packages/table/src/body.js -> packages/table/src/body.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "499:     elemStore[`${prefix}xSpace`] = $refs.xSpace",
      "500:     elemStore[`${prefix}ySpace`] = $refs.ySpace",
      "501:     elemStore[`${prefix}emptyBlock`] = $refs.emptyBlock",
      "504:   },",
      "505:   beforeDestroy () {",
      "506:     clearTimeout(this.wheelTime)",
      "",
      "[Removed Lines]",
      "502:     this.$el.onscroll = this.scrollEvent",
      "503:     this.$el._onscroll = this.scrollEvent",
      "",
      "[Added Lines]",
      "502:     if (this.$el) {",
      "503:       this.$el.onscroll = this.scrollEvent",
      "504:       this.$el._onscroll = this.scrollEvent",
      "505:     }",
      "",
      "---------------"
    ],
    "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js": [
      "File: packages/textarea/src/textarea.js -> packages/textarea/src/textarea.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "188:         autoTxtElem.className = ['vxe-textarea--autosize', size ? `size--${size}` : ''].join(' ')",
      "189:         autoTxtElem.style.width = `${textElem.clientWidth}px`",
      "190:         autoTxtElem.style.padding = textStyle.padding",
      "192:       }",
      "193:     },",
      "194:     handleResize () {",
      "",
      "[Removed Lines]",
      "191:         autoTxtElem.innerHTML = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "[Added Lines]",
      "191:         autoTxtElem.innerText = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e7dd90c5a7ab8c5c09c1a72bc582bdd129088dff",
      "candidate_info": {
        "commit_hash": "e7dd90c5a7ab8c5c09c1a72bc582bdd129088dff",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/e7dd90c5a7ab8c5c09c1a72bc582bdd129088dff",
        "files": [
          "package.json",
          "packages/tools/event.js"
        ],
        "message": "fix \u4fee\u590d\u7279\u6b8a\u573a\u666f\u4e8b\u4ef6\u65e0\u6cd5\u89e6\u53d1\u95ee\u9898",
        "before_after_code_files": [
          "packages/tools/event.js||packages/tools/event.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/tools/event.js||packages/tools/event.js": [
          "File: packages/tools/event.js -> packages/tools/event.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "70: if (browse.isDoc) {",
          "71:   if (!browse.msie) {",
          "75:   }",
          "76:   document.addEventListener('keydown', GlobalEvent.trigger, false)",
          "77:   document.addEventListener('contextmenu', GlobalEvent.trigger, false)",
          "",
          "[Removed Lines]",
          "72:     document.addEventListener('copy', GlobalEvent.trigger, false)",
          "73:     document.addEventListener('cut', GlobalEvent.trigger, false)",
          "74:     document.addEventListener('paste', GlobalEvent.trigger, false)",
          "",
          "[Added Lines]",
          "72:     window.addEventListener('copy', GlobalEvent.trigger, false)",
          "73:     window.addEventListener('cut', GlobalEvent.trigger, false)",
          "74:     window.addEventListener('paste', GlobalEvent.trigger, false)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "52c41baa7c8b9d4d51aba9defe42bb53571e9b56",
      "candidate_info": {
        "commit_hash": "52c41baa7c8b9d4d51aba9defe42bb53571e9b56",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/52c41baa7c8b9d4d51aba9defe42bb53571e9b56",
        "files": [
          "package.json",
          "packages/table/src/methods.js",
          "styles/form.scss"
        ],
        "message": "\u589e\u52a0 setRow \u65b9\u6cd5",
        "before_after_code_files": [
          "packages/table/src/methods.js||packages/table/src/methods.js",
          "styles/form.scss||styles/form.scss"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/src/methods.js||packages/table/src/methods.js": [
          "File: packages/table/src/methods.js -> packages/table/src/methods.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "518:         return this.recalculate()",
          "519:       })",
          "520:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "524:   setRow (rows, record) {",
          "525:     if (record) {",
          "526:       let rest = rows",
          "527:       if (!XEUtils.isArray(rows)) {",
          "528:         rest = [rows]",
          "529:       }",
          "530:       rest.forEach(item => Object.assign(item, record))",
          "531:     }",
          "532:     return this.$nextTick()",
          "533:   },",
          "",
          "---------------"
        ],
        "styles/form.scss||styles/form.scss": [
          "File: styles/form.scss -> styles/form.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "160:       flex-direction: column;",
          "161:       align-items: initial;",
          "162:       .vxe-form--item-title {",
          "165:         padding-right: 0;",
          "166:         max-width: none;",
          "167:       }",
          "",
          "[Removed Lines]",
          "163:         height: 2.2em;",
          "164:         line-height: 2.2em;",
          "",
          "[Added Lines]",
          "163:         height: 2.5em;",
          "164:         line-height: 2.3em;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "194b3f31fc7736eab798fa273076557173764f1c",
      "candidate_info": {
        "commit_hash": "194b3f31fc7736eab798fa273076557173764f1c",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/194b3f31fc7736eab798fa273076557173764f1c",
        "files": [
          "package.json",
          "packages/table/src/table.ts",
          "styles/components/table.scss"
        ],
        "message": "releases 3.11.5",
        "before_after_code_files": [
          "packages/table/src/table.ts||packages/table/src/table.ts",
          "styles/components/table.scss||styles/components/table.scss"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/src/table.ts||packages/table/src/table.ts": [
          "File: packages/table/src/table.ts -> packages/table/src/table.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "1123:     const VxeUITooltipComponent = VxeUI.getComponent<VxeTooltipComponent>('VxeTooltip')",
          "1125:     const $xeTable = this",
          "1127:     const {",
          "1128:       _e,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1126:     const $xeGrid = $xeTable.$xeGrid",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1170:       editRules",
          "1171:     } = $xeTable",
          "1172:     const { leftList, rightList } = columnStore",
          "1173:     const currLoading = this._isLoading || loading",
          "1174:     const vSize = computeSize",
          "1175:     const virtualScrollBars = $xeTable.computeVirtualScrollBars",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1174:     const loadingSlot = $scopedSlots.loading",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1357:             icon: loadingOpts.icon,",
          "1358:             text: loadingOpts.text",
          "1359:           }",
          "",
          "[Removed Lines]",
          "1360:         }, this.callSlot($scopedSlots.loading, {}, h))",
          "1361:         : _e(),",
          "",
          "[Added Lines]",
          "1362:         }, $xeTable.callSlot(loadingSlot, { $table: $xeTable, $grid: $xeGrid, loading: currLoading }, h))",
          "1363:         : loadingSlot",
          "1364:           ? h('div', {",
          "1365:             class: ['vxe-loading--custom-wrapper', {",
          "1366:               'is--visible': currLoading",
          "1367:             }]",
          "1368:           }, $xeTable.callSlot(loadingSlot, { $table: $xeTable, $grid: $xeGrid, loading: currLoading }, h))",
          "1369:           : renderEmptyElement($xeTable),",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1370:             customStore",
          "1371:           }",
          "1372:         })",
          "",
          "[Removed Lines]",
          "1373:         : _e(),",
          "",
          "[Added Lines]",
          "1381:         : renderEmptyElement($xeTable),",
          "",
          "---------------"
        ],
        "styles/components/table.scss||styles/components/table.scss": [
          "File: styles/components/table.scss -> styles/components/table.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:   outline: 0;",
          "46: }",
          "49: .vxe-cell,",
          "50: .vxe-table--filter-template {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "48: .vxe-loading--custom-wrapper {",
          "49:   display: none;",
          "50:   position: absolute;",
          "51:   width: 100%;",
          "52:   height: 100%;",
          "53:   top: 0;",
          "54:   left: 0;",
          "55:   z-index: 99;",
          "56:   user-select: none;",
          "57:   &.is--visible {",
          "58:     display: block;",
          "59:   }",
          "60: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e27ff2c8f02cd9db13f900e318e621abfea839f1",
      "candidate_info": {
        "commit_hash": "e27ff2c8f02cd9db13f900e318e621abfea839f1",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/e27ff2c8f02cd9db13f900e318e621abfea839f1",
        "files": [
          "lib_temp/demo.html",
          "lib_temp/index.css",
          "lib_temp/index.umd.js"
        ],
        "message": "fix \u56fa\u5b9a\u5217\u65e0\u6cd5\u663e\u793a\u95ee\u9898",
        "before_after_code_files": [
          "lib_temp/demo.html||lib_temp/demo.html",
          "lib_temp/index.css||lib_temp/index.css",
          "lib_temp/index.umd.js||lib_temp/index.umd.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib_temp/demo.html||lib_temp/demo.html": [
          "File: lib_temp/demo.html -> lib_temp/demo.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib_temp/index.css||lib_temp/index.css": [
          "File: lib_temp/index.css -> lib_temp/index.css",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib_temp/index.umd.js||lib_temp/index.umd.js": [
          "File: lib_temp/index.umd.js -> lib_temp/index.umd.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8067c0086cab401ff95ea38ffe0c69cc4a152098",
      "candidate_info": {
        "commit_hash": "8067c0086cab401ff95ea38ffe0c69cc4a152098",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/8067c0086cab401ff95ea38ffe0c69cc4a152098",
        "files": [
          "package.json",
          "packages/edit/src/mixin.js"
        ],
        "message": "fix",
        "before_after_code_files": [
          "packages/edit/src/mixin.js||packages/edit/src/mixin.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/edit/src/mixin.js||packages/edit/src/mixin.js": [
          "File: packages/edit/src/mixin.js -> packages/edit/src/mixin.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "29:       }",
          "30:       parentChilds[funcName](item)",
          "31:       mapChilds[funcName](item)",
          "33:       fullDataRowIdData[rowid] = rest",
          "34:       fullAllDataRowIdData[rowid] = rest",
          "35:     } else {",
          "",
          "[Removed Lines]",
          "32:       const rest = { row: item, rowid, seq: -1, index: -1, _index: -1, $index: -1, items: parentChilds, parent, level: parentLevel + 1 }",
          "",
          "[Added Lines]",
          "32:       const rest = { row: item, rowid, seq: -1, index: -1, _index: -1, $index: -1, items: parentChilds, parent: parentRow, level: parentLevel + 1 }",
          "",
          "---------------"
        ]
      }
    }
  ]
}