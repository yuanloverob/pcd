{
  "cve_id": "CVE-2024-43803",
  "cve_desc": "The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The `BareMetalHost` (BMH) CRD allows the `userData`, `metaData`, and `networkData` for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the `Name` and `Namespace` of the Secret, meaning that versions of the baremetal-operator prior to 0.8.0, 0.6.2, and 0.5.2 will read a `Secret` from any namespace. A user with access to create or edit a `BareMetalHost` can thus exfiltrate a `Secret` from another namespace by using it as e.g. the `userData` for provisioning some host (note that this need not be a real host, it could be a VM somewhere).\n\nBMO will only read a key with the name `value` (or `userData`, `metaData`, or `networkData`), so that limits the exposure somewhat. `value` is probably a pretty common key though. Secrets used by _other_ `BareMetalHost`s in different namespaces are always vulnerable. It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a `BareMetalHost`. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.\n\nThe patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only. The problem is patched in BMO releases v0.7.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets. As a workaround, an operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.",
  "repo": "metal3-io/baremetal-operator",
  "patch_hash": "c2b5a557641bc273367635124047d6c958aa15f7",
  "patch_info": {
    "commit_hash": "c2b5a557641bc273367635124047d6c958aa15f7",
    "repo": "metal3-io/baremetal-operator",
    "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7",
    "files": [
      "controllers/metal3.io/baremetalhost_controller_test.go",
      "controllers/metal3.io/host_config_data.go",
      "controllers/metal3.io/host_config_data_test.go"
    ],
    "message": "Merge pull request #1929 from Nordix/tuomo/ghsa-pqfh-xh7w-7h3p\n\n\ud83d\udc1b Disallow fetching secrets from namespaces different from the host's one",
    "before_after_code_files": [
      "controllers/metal3.io/baremetalhost_controller_test.go||controllers/metal3.io/baremetalhost_controller_test.go",
      "controllers/metal3.io/host_config_data.go||controllers/metal3.io/host_config_data.go",
      "controllers/metal3.io/host_config_data_test.go||controllers/metal3.io/host_config_data_test.go"
    ]
  },
  "patch_diff": {
    "controllers/metal3.io/baremetalhost_controller_test.go||controllers/metal3.io/baremetalhost_controller_test.go": [
      "File: controllers/metal3.io/baremetalhost_controller_test.go -> controllers/metal3.io/baremetalhost_controller_test.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "37: )",
      "39: func newSecret(name string, data map[string]string) *corev1.Secret {",
      "40:  secretData := make(map[string][]byte)",
      "41:  for k, v := range data {",
      "42:   secretData[k] = []byte(base64.StdEncoding.EncodeToString([]byte(v)))",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "40:  return newSecretInNamespace(name, namespace, data)",
      "41: }",
      "43: func newSecretInNamespace(name, namespace string, data map[string]string) *corev1.Secret {",
      "",
      "---------------"
    ],
    "controllers/metal3.io/host_config_data.go||controllers/metal3.io/host_config_data.go": [
      "File: controllers/metal3.io/host_config_data.go -> controllers/metal3.io/host_config_data.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "4:  \"github.com/go-logr/logr\"",
      "5:  metal3api \"github.com/metal3-io/baremetal-operator/apis/metal3.io/v1alpha1\"",
      "6:  \"github.com/metal3-io/baremetal-operator/pkg/secretutils\"",
      "7:  corev1 \"k8s.io/api/core/v1\"",
      "8:  \"k8s.io/apimachinery/pkg/types\"",
      "9: )",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7:  \"github.com/pkg/errors\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "22: func (hcd *hostConfigData) getSecretData(name, namespace, dataKey string) (string, error) {",
      "23:  key := types.NamespacedName{",
      "24:   Name:      name,",
      "25:   Namespace: namespace,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "24:  if namespace != hcd.host.Namespace {",
      "25:   return \"\", errors.Errorf(\"%s secret must be in same namespace as host %s/%s\", dataKey, hcd.host.Namespace, hcd.host.Name)",
      "26:  }",
      "",
      "---------------"
    ],
    "controllers/metal3.io/host_config_data_test.go||controllers/metal3.io/host_config_data_test.go": [
      "File: controllers/metal3.io/host_config_data_test.go -> controllers/metal3.io/host_config_data_test.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "323:    ExpectedNetworkData: \"\",",
      "324:    ErrNetworkData:      true,",
      "325:   },",
      "326:  }",
      "328:  for _, tc := range testCases {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "326:   {",
      "327:    Scenario: \"user-data secret in different namespace\",",
      "328:    Host: newHost(\"host-user-data\",",
      "329:     &metal3api.BareMetalHostSpec{",
      "330:      BMC: metal3api.BMCDetails{",
      "331:       Address:         \"ipmi://192.168.122.1:6233\",",
      "332:       CredentialsName: defaultSecretName,",
      "333:      },",
      "334:      UserData: &corev1.SecretReference{",
      "335:       Name:      \"user-data\",",
      "336:       Namespace: \"other-namespace\",",
      "337:      },",
      "338:     }),",
      "339:    UserDataSecret: newSecretInNamespace(\"user-data\", \"other-namespace\", map[string]string{\"userData\": \"somedata\"}),",
      "340:    ErrUserData:    true,",
      "341:   },",
      "342:   {",
      "343:    Scenario: \"meta-data secret in different namespace\",",
      "344:    Host: newHost(\"host-user-data\",",
      "345:     &metal3api.BareMetalHostSpec{",
      "346:      BMC: metal3api.BMCDetails{",
      "347:       Address:         \"ipmi://192.168.122.1:6233\",",
      "348:       CredentialsName: defaultSecretName,",
      "349:      },",
      "350:      MetaData: &corev1.SecretReference{",
      "351:       Name:      \"meta-data\",",
      "352:       Namespace: \"other-namespace\",",
      "353:      },",
      "354:     }),",
      "355:    NetworkDataSecret: newSecretInNamespace(\"meta-data\", \"other-namespace\", map[string]string{\"metaData\": \"key: value\"}),",
      "356:    ErrMetaData:       true,",
      "357:   },",
      "358:   {",
      "359:    Scenario: \"network-data secret in different namespace\",",
      "360:    Host: newHost(\"host-user-data\",",
      "361:     &metal3api.BareMetalHostSpec{",
      "362:      BMC: metal3api.BMCDetails{",
      "363:       Address:         \"ipmi://192.168.122.1:6233\",",
      "364:       CredentialsName: defaultSecretName,",
      "365:      },",
      "366:      NetworkData: &corev1.SecretReference{",
      "367:       Name:      \"net-data\",",
      "368:       Namespace: \"other-namespace\",",
      "369:      },",
      "370:     }),",
      "371:    NetworkDataSecret: newSecretInNamespace(\"net-data\", \"other-namespace\", map[string]string{\"networkData\": \"key: value\"}),",
      "372:    ErrNetworkData:    true,",
      "373:   },",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "378:    }",
      "380:    if actualMetaData != tc.ExpectedMetaData {",
      "382:    }",
      "383:   })",
      "384:  }",
      "",
      "[Removed Lines]",
      "381:     t.Fatal(fmt.Errorf(\"Failed to assert MetaData. Expected '%s' got '%s'\", actualMetaData, tc.ExpectedMetaData))",
      "",
      "[Added Lines]",
      "429:     t.Fatal(fmt.Errorf(\"Failed to assert MetaData. Expected '%s' got '%s'\", tc.ExpectedMetaData, actualMetaData))",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8bc6ff3bf303a50cc1729ccb32dbe2ca2412d6e2",
      "candidate_info": {
        "commit_hash": "8bc6ff3bf303a50cc1729ccb32dbe2ca2412d6e2",
        "repo": "metal3-io/baremetal-operator",
        "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/8bc6ff3bf303a50cc1729ccb32dbe2ca2412d6e2",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": ":seedling: Bump github.com/prometheus/client_golang\n\nBumps [github.com/prometheus/client_golang](https://github.com/prometheus/client_golang) from 1.20.4 to 1.20.5.\n- [Release notes](https://github.com/prometheus/client_golang/releases)\n- [Changelog](https://github.com/prometheus/client_golang/blob/main/CHANGELOG.md)\n- [Commits](https://github.com/prometheus/client_golang/compare/v1.20.4...v1.20.5)\n\n---\nupdated-dependencies:\n- dependency-name: github.com/prometheus/client_golang\n  dependency-type: direct:production\n  update-type: version-update:semver-patch\n...\n\nSigned-off-by: dependabot[bot] <support@github.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/metal3-io/baremetal-operator/pull/2423"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:  github.com/metal3-io/baremetal-operator/pkg/hardwareutils v0.5.1",
          "11:  github.com/onsi/gomega v1.34.2",
          "12:  github.com/pkg/errors v0.9.1",
          "14:  github.com/stretchr/testify v1.9.0",
          "15:  go.etcd.io/etcd/client/pkg/v3 v3.5.16",
          "16:  go.uber.org/zap v1.27.0",
          "",
          "[Removed Lines]",
          "13:  github.com/prometheus/client_golang v1.20.4",
          "",
          "[Added Lines]",
          "13:  github.com/prometheus/client_golang v1.20.5",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "89: github.com/pkg/errors v0.9.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=",
          "90: github.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM=",
          "91: github.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=",
          "94: github.com/prometheus/client_model v0.6.1 h1:ZKSh/rekM+n3CeS952MLRAdFwIKqeY8b62p8ais2e9E=",
          "95: github.com/prometheus/client_model v0.6.1/go.mod h1:OrxVMOVHjw3lKMa8+x6HeMGkHMQyHDk9E3jmP2AmGiY=",
          "96: github.com/prometheus/common v0.55.0 h1:KEi6DK7lXW/m7Ig5i47x0vRzuBsHuvJdi5ee6Y3G1dc=",
          "",
          "[Removed Lines]",
          "92: github.com/prometheus/client_golang v1.20.4 h1:Tgh3Yr67PaOv/uTqloMsCEdeuFTatm5zIq5+qNN23vI=",
          "93: github.com/prometheus/client_golang v1.20.4/go.mod h1:PIEt8X02hGcP8JWbeHyeZ53Y/jReSnHgO035n//V5WE=",
          "",
          "[Added Lines]",
          "92: github.com/prometheus/client_golang v1.20.5 h1:cxppBPuYhUnsO6yo/aoRol4L7q7UFfdm+bR9r+8l63Y=",
          "93: github.com/prometheus/client_golang v1.20.5/go.mod h1:PIEt8X02hGcP8JWbeHyeZ53Y/jReSnHgO035n//V5WE=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4a269d1c7decf386fd16f32ae6caf432b76fc4aa",
      "candidate_info": {
        "commit_hash": "4a269d1c7decf386fd16f32ae6caf432b76fc4aa",
        "repo": "metal3-io/baremetal-operator",
        "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/4a269d1c7decf386fd16f32ae6caf432b76fc4aa",
        "files": [
          "apis/go.mod",
          "apis/go.sum",
          "go.mod",
          "go.sum",
          "hack/tools/go.mod",
          "hack/tools/go.sum",
          "test/go.mod",
          "test/go.sum"
        ],
        "message": "bump x/net, x/crypto and x/oauth2\n\nBump some mods to get rid of called/uncalled vulnerabilities.\n\nSigned-off-by: Tuomo Tanskanen <tuomo.tanskanen@est.tech>",
        "before_after_code_files": [
          "apis/go.mod||apis/go.mod",
          "apis/go.sum||apis/go.sum",
          "go.mod||go.mod",
          "go.sum||go.sum",
          "hack/tools/go.mod||hack/tools/go.mod",
          "hack/tools/go.sum||hack/tools/go.sum",
          "test/go.mod||test/go.mod",
          "test/go.sum||test/go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/metal3-io/baremetal-operator/pull/2423"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apis/go.mod||apis/go.mod": [
          "File: apis/go.mod -> apis/go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module github.com/metal3-io/baremetal-operator/apis",
          "5: require (",
          "6:  github.com/google/uuid v1.6.0",
          "",
          "[Removed Lines]",
          "3: go 1.22",
          "",
          "[Added Lines]",
          "3: go 1.23.0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "36:  github.com/prometheus/client_model v0.5.0 // indirect",
          "37:  github.com/prometheus/common v0.45.0 // indirect",
          "38:  github.com/prometheus/procfs v0.12.0 // indirect",
          "44:  golang.org/x/time v0.3.0 // indirect",
          "45:  gomodules.xyz/jsonpatch/v2 v2.4.0 // indirect",
          "47:  google.golang.org/protobuf v1.33.0 // indirect",
          "48:  gopkg.in/inf.v0 v0.9.1 // indirect",
          "49:  gopkg.in/yaml.v2 v2.4.0 // indirect",
          "",
          "[Removed Lines]",
          "39:  golang.org/x/net v0.34.0 // indirect",
          "40:  golang.org/x/oauth2 v0.12.0 // indirect",
          "41:  golang.org/x/sys v0.29.0 // indirect",
          "42:  golang.org/x/term v0.28.0 // indirect",
          "43:  golang.org/x/text v0.21.0 // indirect",
          "46:  google.golang.org/appengine v1.6.7 // indirect",
          "",
          "[Added Lines]",
          "39:  golang.org/x/net v0.36.0 // indirect",
          "40:  golang.org/x/oauth2 v0.27.0 // indirect",
          "41:  golang.org/x/sys v0.30.0 // indirect",
          "42:  golang.org/x/term v0.29.0 // indirect",
          "43:  golang.org/x/text v0.22.0 // indirect",
          "",
          "---------------"
        ],
        "apis/go.sum||apis/go.sum": [
          "File: apis/go.sum -> apis/go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: github.com/gogo/protobuf v1.3.2/go.mod h1:P1XiOD3dCwIKUDQYPy72D8LYyHL2YPYrpS2s69NZV8Q=",
          "28: github.com/golang/groupcache v0.0.0-20210331224755-41bb18bfe9da h1:oI5xCqsCo564l8iNU+DwB5epxmsaqB+rhGL0m5jtYqE=",
          "29: github.com/golang/groupcache v0.0.0-20210331224755-41bb18bfe9da/go.mod h1:cIg4eruTrX1D+g88fzRXU5OdNfaM+9IcxsU14FzY7Hc=",
          "31: github.com/golang/protobuf v1.5.4 h1:i7eJL8qZTpSEXOPTxNKhASYpMn+8e5Q6AdndVa1dWek=",
          "32: github.com/golang/protobuf v1.5.4/go.mod h1:lnTiLA8Wa4RWRcIUkrtSVa5nRhsEGBg48fD6rSs7xps=",
          "33: github.com/google/gnostic-models v0.6.8 h1:yo/ABAfM5IMRsS1VnXjTBvUb61tFIHozhlYvRgGre9I=",
          "",
          "[Removed Lines]",
          "30: github.com/golang/protobuf v1.3.1/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "107: golang.org/x/mod v0.2.0/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=",
          "108: golang.org/x/mod v0.3.0/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=",
          "109: golang.org/x/net v0.0.0-20190404232315-eb5bcb51f2a3/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=",
          "111: golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "112: golang.org/x/net v0.0.0-20200226121028-0de0cce0169b/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "113: golang.org/x/net v0.0.0-20201021035429-f5854403a974/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=",
          "118: golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "119: golang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "120: golang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "121: golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "122: golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "123: golang.org/x/sys v0.0.0-20200930185726-fdedc70b468f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "128: golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=",
          "130: golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=",
          "133: golang.org/x/time v0.3.0 h1:rg5rLMjNzMS1RkNLzCG38eapWhnYLFYXDXj2gOlr8j4=",
          "134: golang.org/x/time v0.3.0/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=",
          "135: golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
          "",
          "[Removed Lines]",
          "110: golang.org/x/net v0.0.0-20190603091049-60506f45cf65/go.mod h1:HSz+uSET+XFnRR8LxR5pz3Of3rY3CfYBVs4xY44aLks=",
          "114: golang.org/x/net v0.34.0 h1:Mb7Mrk043xzHgnRM88suvJFwzVrRfHEHJEl5/71CKw0=",
          "115: golang.org/x/net v0.34.0/go.mod h1:di0qlW3YNM5oh6GqDGQr92MyTozJPmybPK4Ev/Gm31k=",
          "116: golang.org/x/oauth2 v0.12.0 h1:smVPGxink+n1ZI5pkQa8y6fZT0RW0MgCO5bFpepy4B4=",
          "117: golang.org/x/oauth2 v0.12.0/go.mod h1:A74bZ3aGXgCY0qaIC9Ahg6Lglin4AMAco8cIv9baba4=",
          "124: golang.org/x/sys v0.29.0 h1:TPYlXGxvx1MGTn2GiZDhnjPA9wZzZeGKHHmKhHYvgaU=",
          "125: golang.org/x/sys v0.29.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "126: golang.org/x/term v0.28.0 h1:/Ts8HFuMR2E6IP/jlo7QVLZHggjKQbhu/7H0LJFr3Gg=",
          "127: golang.org/x/term v0.28.0/go.mod h1:Sw/lC2IAUZ92udQNf3WodGtn4k/XoLyZoh8v/8uiwek=",
          "129: golang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=",
          "131: golang.org/x/text v0.21.0 h1:zyQAAkrwaneQ066sspRyJaG9VNi/YJ1NfzcGB3hZ/qo=",
          "132: golang.org/x/text v0.21.0/go.mod h1:4IBbMaMmOPCJ8SecivzSH54+73PCFmPWxNTLm+vZkEQ=",
          "",
          "[Added Lines]",
          "112: golang.org/x/net v0.36.0 h1:vWF2fRbw4qslQsQzgFqZff+BItCvGFQqKzKIzx1rmoA=",
          "113: golang.org/x/net v0.36.0/go.mod h1:bFmbeoIPfrw4sMHNhb4J9f6+tPziuGjq7Jk/38fxi1I=",
          "114: golang.org/x/oauth2 v0.27.0 h1:da9Vo7/tDv5RH/7nZDz1eMGS/q1Vv1N/7FCrBhI9I3M=",
          "115: golang.org/x/oauth2 v0.27.0/go.mod h1:onh5ek6nERTohokkhCD/y2cV4Do3fxFHFuAejCkRWT8=",
          "122: golang.org/x/sys v0.30.0 h1:QjkSwP/36a20jFYWkSue1YwXzLmsV5Gfq7Eiy72C1uc=",
          "123: golang.org/x/sys v0.30.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "124: golang.org/x/term v0.29.0 h1:L6pJp37ocefwRRtYPKSWOWzOtWSxVajvz2ldH/xi3iU=",
          "125: golang.org/x/term v0.29.0/go.mod h1:6bl4lRlvVuDgSf3179VpIxBF0o10JUpXWOnI7nErv7s=",
          "128: golang.org/x/text v0.22.0 h1:bofq7m3/HAFvbF51jz3Q9wLg3jkvSPuiZu/pD1XwgtM=",
          "129: golang.org/x/text v0.22.0/go.mod h1:YRoo4H8PVmsu+E3Ou7cqLVH8oXWIHVoX0jqUWALQhfY=",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "144: golang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=",
          "145: gomodules.xyz/jsonpatch/v2 v2.4.0 h1:Ci3iUJyx9UeRx7CeFN8ARgGbkESwJK+KB9lLcWxY/Zw=",
          "146: gomodules.xyz/jsonpatch/v2 v2.4.0/go.mod h1:AH3dM2RI6uoBZxn3LVrfvJ3E0/9dG4cSrbuBJT4moAY=",
          "149: google.golang.org/protobuf v1.33.0 h1:uNO2rsAINq/JlFpSdYEKIZ0uKD/R9cpdv0T+yoGwGmI=",
          "150: google.golang.org/protobuf v1.33.0/go.mod h1:c6P6GXX6sHbq/GpV6MGZEdwhWPcYBgnhAHhKbcUYpos=",
          "151: gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=",
          "",
          "[Removed Lines]",
          "147: google.golang.org/appengine v1.6.7 h1:FZR1q0exgwxzPzp/aF+VccGrSfxfPpkBqjIIEq3ru6c=",
          "148: google.golang.org/appengine v1.6.7/go.mod h1:8WjMMxjGQR8xUklV/ARdw2HLXBOI7O7uCIDZVag1xfc=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "77:  go.opentelemetry.io/proto/otlp v1.0.0 // indirect",
          "78:  go.uber.org/multierr v1.11.0 // indirect",
          "79:  golang.org/x/exp v0.0.0-20240719175910-8a7402abbf56 // indirect",
          "83:  golang.org/x/sys v0.30.0 // indirect",
          "86:  golang.org/x/time v0.3.0 // indirect",
          "87:  gomodules.xyz/jsonpatch/v2 v2.4.0 // indirect",
          "88:  google.golang.org/genproto/googleapis/api v0.0.0-20230726155614-23370e0ffb3e // indirect",
          "",
          "[Removed Lines]",
          "80:  golang.org/x/net v0.34.0 // indirect",
          "81:  golang.org/x/oauth2 v0.21.0 // indirect",
          "82:  golang.org/x/sync v0.10.0 // indirect",
          "84:  golang.org/x/term v0.28.0 // indirect",
          "85:  golang.org/x/text v0.21.0 // indirect",
          "",
          "[Added Lines]",
          "80:  golang.org/x/net v0.36.0 // indirect",
          "81:  golang.org/x/oauth2 v0.27.0 // indirect",
          "82:  golang.org/x/sync v0.11.0 // indirect",
          "84:  golang.org/x/term v0.29.0 // indirect",
          "85:  golang.org/x/text v0.22.0 // indirect",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "170: golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "171: golang.org/x/net v0.0.0-20200226121028-0de0cce0169b/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "172: golang.org/x/net v0.0.0-20201021035429-f5854403a974/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=",
          "177: golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "178: golang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "179: golang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "182: golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "183: golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "184: golang.org/x/sys v0.0.0-20200930185726-fdedc70b468f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "185: golang.org/x/sys v0.30.0 h1:QjkSwP/36a20jFYWkSue1YwXzLmsV5Gfq7Eiy72C1uc=",
          "186: golang.org/x/sys v0.30.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "189: golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=",
          "190: golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=",
          "193: golang.org/x/time v0.3.0 h1:rg5rLMjNzMS1RkNLzCG38eapWhnYLFYXDXj2gOlr8j4=",
          "194: golang.org/x/time v0.3.0/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=",
          "195: golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
          "",
          "[Removed Lines]",
          "173: golang.org/x/net v0.34.0 h1:Mb7Mrk043xzHgnRM88suvJFwzVrRfHEHJEl5/71CKw0=",
          "174: golang.org/x/net v0.34.0/go.mod h1:di0qlW3YNM5oh6GqDGQr92MyTozJPmybPK4Ev/Gm31k=",
          "175: golang.org/x/oauth2 v0.21.0 h1:tsimM75w1tF/uws5rbeHzIWxEqElMehnc+iW793zsZs=",
          "176: golang.org/x/oauth2 v0.21.0/go.mod h1:XYTD2NtWslqkgxebSiOHnXEap4TF09sJSc7H1sXbhtI=",
          "180: golang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=",
          "181: golang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "187: golang.org/x/term v0.28.0 h1:/Ts8HFuMR2E6IP/jlo7QVLZHggjKQbhu/7H0LJFr3Gg=",
          "188: golang.org/x/term v0.28.0/go.mod h1:Sw/lC2IAUZ92udQNf3WodGtn4k/XoLyZoh8v/8uiwek=",
          "191: golang.org/x/text v0.21.0 h1:zyQAAkrwaneQ066sspRyJaG9VNi/YJ1NfzcGB3hZ/qo=",
          "192: golang.org/x/text v0.21.0/go.mod h1:4IBbMaMmOPCJ8SecivzSH54+73PCFmPWxNTLm+vZkEQ=",
          "",
          "[Added Lines]",
          "173: golang.org/x/net v0.36.0 h1:vWF2fRbw4qslQsQzgFqZff+BItCvGFQqKzKIzx1rmoA=",
          "174: golang.org/x/net v0.36.0/go.mod h1:bFmbeoIPfrw4sMHNhb4J9f6+tPziuGjq7Jk/38fxi1I=",
          "175: golang.org/x/oauth2 v0.27.0 h1:da9Vo7/tDv5RH/7nZDz1eMGS/q1Vv1N/7FCrBhI9I3M=",
          "176: golang.org/x/oauth2 v0.27.0/go.mod h1:onh5ek6nERTohokkhCD/y2cV4Do3fxFHFuAejCkRWT8=",
          "180: golang.org/x/sync v0.11.0 h1:GGz8+XQP4FvTTrjZPzNKTMFtSXH80RAzG+5ghFPgK9w=",
          "181: golang.org/x/sync v0.11.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "187: golang.org/x/term v0.29.0 h1:L6pJp37ocefwRRtYPKSWOWzOtWSxVajvz2ldH/xi3iU=",
          "188: golang.org/x/term v0.29.0/go.mod h1:6bl4lRlvVuDgSf3179VpIxBF0o10JUpXWOnI7nErv7s=",
          "191: golang.org/x/text v0.22.0 h1:bofq7m3/HAFvbF51jz3Q9wLg3jkvSPuiZu/pD1XwgtM=",
          "192: golang.org/x/text v0.22.0/go.mod h1:YRoo4H8PVmsu+E3Ou7cqLVH8oXWIHVoX0jqUWALQhfY=",
          "",
          "---------------"
        ],
        "hack/tools/go.mod||hack/tools/go.mod": [
          "File: hack/tools/go.mod -> hack/tools/go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module github.com/metal3-io/baremetal-operator/tooling",
          "5: require (",
          "6:  sigs.k8s.io/controller-tools v0.12.1",
          "7:  sigs.k8s.io/kustomize/kustomize/v5 v5.4.3",
          "8: )",
          "12: require (",
          "13:  github.com/blang/semver/v4 v4.0.0 // indirect",
          "",
          "[Removed Lines]",
          "3: go 1.22",
          "10: require golang.org/x/sync v0.10.0 // indirect",
          "",
          "[Added Lines]",
          "3: go 1.23.0",
          "10: require golang.org/x/sync v0.11.0 // indirect",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41:  github.com/xlab/treeprint v1.2.0 // indirect",
          "42:  go.starlark.net v0.0.0-20200306205701-8dd3e2ee1dd5 // indirect",
          "43:  golang.org/x/mod v0.17.0 // indirect",
          "47:  golang.org/x/tools v0.21.1-0.20240508182429-e35e4ccd0d2d // indirect",
          "48:  google.golang.org/protobuf v1.33.0 // indirect",
          "49:  gopkg.in/evanphx/json-patch.v4 v4.12.0 // indirect",
          "",
          "[Removed Lines]",
          "44:  golang.org/x/net v0.34.0 // indirect",
          "45:  golang.org/x/sys v0.29.0 // indirect",
          "46:  golang.org/x/text v0.21.0 // indirect",
          "",
          "[Added Lines]",
          "44:  golang.org/x/net v0.36.0 // indirect",
          "45:  golang.org/x/sys v0.30.0 // indirect",
          "46:  golang.org/x/text v0.22.0 // indirect",
          "",
          "---------------"
        ],
        "hack/tools/go.sum||hack/tools/go.sum": [
          "File: hack/tools/go.sum -> hack/tools/go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "122: golang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "123: golang.org/x/net v0.0.0-20200226121028-0de0cce0169b/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=",
          "124: golang.org/x/net v0.0.0-20201021035429-f5854403a974/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=",
          "127: golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "128: golang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "129: golang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "132: golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "133: golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "134: golang.org/x/sys v0.0.0-20191002063906-3421d5a6bb1c/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "135: golang.org/x/sys v0.0.0-20200930185726-fdedc70b468f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "136: golang.org/x/sys v0.0.0-20220811171246-fbc7d0a398ab/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=",
          "139: golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=",
          "140: golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=",
          "143: golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
          "144: golang.org/x/tools v0.0.0-20191119224855-298f0cb1881e/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=",
          "145: golang.org/x/tools v0.0.0-20200619180055-7c47624df98f/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=",
          "",
          "[Removed Lines]",
          "125: golang.org/x/net v0.34.0 h1:Mb7Mrk043xzHgnRM88suvJFwzVrRfHEHJEl5/71CKw0=",
          "126: golang.org/x/net v0.34.0/go.mod h1:di0qlW3YNM5oh6GqDGQr92MyTozJPmybPK4Ev/Gm31k=",
          "130: golang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=",
          "131: golang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "137: golang.org/x/sys v0.29.0 h1:TPYlXGxvx1MGTn2GiZDhnjPA9wZzZeGKHHmKhHYvgaU=",
          "138: golang.org/x/sys v0.29.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "141: golang.org/x/text v0.21.0 h1:zyQAAkrwaneQ066sspRyJaG9VNi/YJ1NfzcGB3hZ/qo=",
          "142: golang.org/x/text v0.21.0/go.mod h1:4IBbMaMmOPCJ8SecivzSH54+73PCFmPWxNTLm+vZkEQ=",
          "",
          "[Added Lines]",
          "125: golang.org/x/net v0.36.0 h1:vWF2fRbw4qslQsQzgFqZff+BItCvGFQqKzKIzx1rmoA=",
          "126: golang.org/x/net v0.36.0/go.mod h1:bFmbeoIPfrw4sMHNhb4J9f6+tPziuGjq7Jk/38fxi1I=",
          "130: golang.org/x/sync v0.11.0 h1:GGz8+XQP4FvTTrjZPzNKTMFtSXH80RAzG+5ghFPgK9w=",
          "131: golang.org/x/sync v0.11.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "137: golang.org/x/sys v0.30.0 h1:QjkSwP/36a20jFYWkSue1YwXzLmsV5Gfq7Eiy72C1uc=",
          "138: golang.org/x/sys v0.30.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "141: golang.org/x/text v0.22.0 h1:bofq7m3/HAFvbF51jz3Q9wLg3jkvSPuiZu/pD1XwgtM=",
          "142: golang.org/x/text v0.22.0/go.mod h1:YRoo4H8PVmsu+E3Ou7cqLVH8oXWIHVoX0jqUWALQhfY=",
          "",
          "---------------"
        ],
        "test/go.mod||test/go.mod": [
          "File: test/go.mod -> test/go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module github.com/metal3-io/baremetal-operator/test",
          "5: require (",
          "6:  github.com/cert-manager/cert-manager v1.12.16",
          "",
          "[Removed Lines]",
          "3: go 1.22",
          "",
          "[Added Lines]",
          "3: go 1.23.0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10:  github.com/onsi/ginkgo/v2 v2.20.2",
          "11:  github.com/onsi/gomega v1.34.2",
          "12:  github.com/pkg/errors v0.9.1",
          "14:  gopkg.in/yaml.v2 v2.4.0",
          "15:  k8s.io/api v0.29.14",
          "16:  k8s.io/apimachinery v0.29.14",
          "",
          "[Removed Lines]",
          "13:  golang.org/x/crypto v0.32.0",
          "",
          "[Added Lines]",
          "13:  golang.org/x/crypto v0.36.0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "119:  go.uber.org/multierr v1.11.0 // indirect",
          "120:  golang.org/x/exp v0.0.0-20240719175910-8a7402abbf56 // indirect",
          "121:  golang.org/x/mod v0.20.0 // indirect",
          "128:  golang.org/x/time v0.5.0 // indirect",
          "129:  golang.org/x/tools v0.24.0 // indirect",
          "130:  gomodules.xyz/jsonpatch/v2 v2.4.0 // indirect",
          "132:  google.golang.org/genproto/googleapis/api v0.0.0-20231106174013-bbf56f31fb17 // indirect",
          "133:  google.golang.org/genproto/googleapis/rpc v0.0.0-20231120223509-83a465c0220f // indirect",
          "134:  google.golang.org/protobuf v1.34.1 // indirect",
          "",
          "[Removed Lines]",
          "122:  golang.org/x/net v0.34.0 // indirect",
          "123:  golang.org/x/oauth2 v0.18.0 // indirect",
          "124:  golang.org/x/sync v0.10.0 // indirect",
          "125:  golang.org/x/sys v0.29.0 // indirect",
          "126:  golang.org/x/term v0.28.0 // indirect",
          "127:  golang.org/x/text v0.21.0 // indirect",
          "131:  google.golang.org/appengine v1.6.8 // indirect",
          "",
          "[Added Lines]",
          "122:  golang.org/x/net v0.36.0 // indirect",
          "123:  golang.org/x/oauth2 v0.27.0 // indirect",
          "124:  golang.org/x/sync v0.12.0 // indirect",
          "125:  golang.org/x/sys v0.31.0 // indirect",
          "126:  golang.org/x/term v0.30.0 // indirect",
          "127:  golang.org/x/text v0.23.0 // indirect",
          "",
          "---------------"
        ],
        "test/go.sum||test/go.sum": [
          "File: test/go.sum -> test/go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "121: github.com/golang/protobuf v1.4.0-rc.4.0.20200313231945-b860323f09d0/go.mod h1:WU3c8KckQ9AFe+yFwt9sWVRKCVIyN9cPHBJSNnbL67w=",
          "122: github.com/golang/protobuf v1.4.0/go.mod h1:jodUvKwWbYaEsadDk5Fwe5c77LiNKVO9IDvqG2KuDX0=",
          "123: github.com/golang/protobuf v1.4.1/go.mod h1:U8fpvMrcmy5pZrNK1lt4xCsGvpyWQ/VVv6QDs8UjoX8=",
          "126: github.com/golang/protobuf v1.5.4 h1:i7eJL8qZTpSEXOPTxNKhASYpMn+8e5Q6AdndVa1dWek=",
          "127: github.com/golang/protobuf v1.5.4/go.mod h1:lnTiLA8Wa4RWRcIUkrtSVa5nRhsEGBg48fD6rSs7xps=",
          "128: github.com/google/cel-go v0.17.7 h1:6ebJFzu1xO2n7TLtN+UBqShGBhlD85bhvglh5DpcfqQ=",
          "",
          "[Removed Lines]",
          "124: github.com/golang/protobuf v1.5.0/go.mod h1:FsONVRAS9T7sI+LIUmWTfcYkHO4aIWwzhcaSAoJOfIk=",
          "125: github.com/golang/protobuf v1.5.2/go.mod h1:XVQd3VNwM+JqD3oG2Ue2ip4fOMUkwXdXDdiuN0vRsmY=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "136: github.com/google/go-cmp v0.5.0/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=",
          "137: github.com/google/go-cmp v0.5.1/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=",
          "138: github.com/google/go-cmp v0.5.2/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=",
          "140: github.com/google/go-cmp v0.5.9/go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=",
          "141: github.com/google/go-cmp v0.6.0 h1:ofyhxvXcZhMsU5ulbFiLKl/XBFqE1GSq7atu8tAmTRI=",
          "142: github.com/google/go-cmp v0.6.0/go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=",
          "",
          "[Removed Lines]",
          "139: github.com/google/go-cmp v0.5.5/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "331: golang.org/x/crypto v0.0.0-20200622213623-75b288015ac9/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=",
          "332: golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc=",
          "333: golang.org/x/crypto v0.3.0/go.mod h1:hebNnKkNXi2UzZN1eVRvBB7co0a+JxK6XbPiWVs/3J4=",
          "336: golang.org/x/exp v0.0.0-20190121172915-509febef88a4/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=",
          "337: golang.org/x/exp v0.0.0-20240719175910-8a7402abbf56 h1:2dVuKD2vS7b0QIHQbpyTISPd0LeHDbnYEryqj5Q1ug8=",
          "338: golang.org/x/exp v0.0.0-20240719175910-8a7402abbf56/go.mod h1:M4RDyNAINzryxdtnbRXRL/OHtkFuWGRjvuhBJpk2IlY=",
          "",
          "[Removed Lines]",
          "334: golang.org/x/crypto v0.32.0 h1:euUpcYgM8WcP71gNpTqQCn6rC2t6ULUPiOzfWaXVVfc=",
          "335: golang.org/x/crypto v0.32.0/go.mod h1:ZnnJkOaASj8g0AjIduWNlq2NRxL0PlBrbKVyZ6V/Ugc=",
          "",
          "[Added Lines]",
          "331: golang.org/x/crypto v0.36.0 h1:AnAEvhDddvBdpY+uR+MyHmuZzzNqXSe/GvuDeob5L34=",
          "332: golang.org/x/crypto v0.36.0/go.mod h1:Y4J0ReaxCR1IMaabaSMugxJES1EpwhBHhv2bDHklZvc=",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "355: golang.org/x/net v0.0.0-20210226172049-e18ecbb05110/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=",
          "356: golang.org/x/net v0.0.0-20220722155237-a158d28d115b/go.mod h1:XRhObCWvk6IyKnWLug+ECip1KBveYUHfp+8e9klMJ9c=",
          "357: golang.org/x/net v0.2.0/go.mod h1:KqCZLdyyvdV855qA2rE3GC2aiw5xGR5TEjj8smXukLY=",
          "360: golang.org/x/oauth2 v0.0.0-20180821212333-d2e6202438be/go.mod h1:N/0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U=",
          "363: golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "364: golang.org/x/sync v0.0.0-20181108010431-42b317875d0f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "365: golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "366: golang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "367: golang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "368: golang.org/x/sync v0.0.0-20220722155255-886fb9371eb4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=",
          "371: golang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "372: golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=",
          "373: golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
          "",
          "[Removed Lines]",
          "358: golang.org/x/net v0.34.0 h1:Mb7Mrk043xzHgnRM88suvJFwzVrRfHEHJEl5/71CKw0=",
          "359: golang.org/x/net v0.34.0/go.mod h1:di0qlW3YNM5oh6GqDGQr92MyTozJPmybPK4Ev/Gm31k=",
          "361: golang.org/x/oauth2 v0.18.0 h1:09qnuIAgzdx1XplqJvW6CQqMCtGZykZWcXzPMPUusvI=",
          "362: golang.org/x/oauth2 v0.18.0/go.mod h1:Wf7knwG0MPoWIMMBgFlEaSUDaKskp0dCfrlJRJXbBi8=",
          "369: golang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=",
          "370: golang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=",
          "",
          "[Added Lines]",
          "355: golang.org/x/net v0.36.0 h1:vWF2fRbw4qslQsQzgFqZff+BItCvGFQqKzKIzx1rmoA=",
          "356: golang.org/x/net v0.36.0/go.mod h1:bFmbeoIPfrw4sMHNhb4J9f6+tPziuGjq7Jk/38fxi1I=",
          "358: golang.org/x/oauth2 v0.27.0 h1:da9Vo7/tDv5RH/7nZDz1eMGS/q1Vv1N/7FCrBhI9I3M=",
          "359: golang.org/x/oauth2 v0.27.0/go.mod h1:onh5ek6nERTohokkhCD/y2cV4Do3fxFHFuAejCkRWT8=",
          "366: golang.org/x/sync v0.12.0 h1:MHc5BpPuC30uJk597Ri8TV3CNZcTLu6B6z4lJy+g6Jw=",
          "367: golang.org/x/sync v0.12.0/go.mod h1:1dzgHSNfp02xaA81J2MS99Qcpr2w7fw1gpm99rleRqA=",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "381: golang.org/x/sys v0.0.0-20220722155257-8c9f86f7a55f/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=",
          "382: golang.org/x/sys v0.2.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=",
          "383: golang.org/x/sys v0.6.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=",
          "386: golang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=",
          "387: golang.org/x/term v0.0.0-20210927222741-03fcf44c2211/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=",
          "388: golang.org/x/term v0.0.0-20220526004731-065cf7ba2467/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=",
          "389: golang.org/x/term v0.2.0/go.mod h1:TVmDHMZPmdnySmBfhjOoOdhjzdE1h4u1VwSiw2l1Nuc=",
          "392: golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=",
          "393: golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=",
          "394: golang.org/x/text v0.3.7/go.mod h1:u+2+/6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=",
          "396: golang.org/x/text v0.4.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8=",
          "399: golang.org/x/time v0.5.0 h1:o7cqy6amK/52YcAKIPlM3a+Fpj35zvRj2TP+e1xFSfk=",
          "400: golang.org/x/time v0.5.0/go.mod h1:3BpzKBy/shNhVucY/MWOyx10tF3SFh9QdLuxbVysPQM=",
          "401: golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
          "",
          "[Removed Lines]",
          "384: golang.org/x/sys v0.29.0 h1:TPYlXGxvx1MGTn2GiZDhnjPA9wZzZeGKHHmKhHYvgaU=",
          "385: golang.org/x/sys v0.29.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=",
          "390: golang.org/x/term v0.28.0 h1:/Ts8HFuMR2E6IP/jlo7QVLZHggjKQbhu/7H0LJFr3Gg=",
          "391: golang.org/x/term v0.28.0/go.mod h1:Sw/lC2IAUZ92udQNf3WodGtn4k/XoLyZoh8v/8uiwek=",
          "395: golang.org/x/text v0.3.8/go.mod h1:E6s5w1FMmriuDzIBO73fBruAKo1PCIq6d2Q6DHfQ8WQ=",
          "397: golang.org/x/text v0.21.0 h1:zyQAAkrwaneQ066sspRyJaG9VNi/YJ1NfzcGB3hZ/qo=",
          "398: golang.org/x/text v0.21.0/go.mod h1:4IBbMaMmOPCJ8SecivzSH54+73PCFmPWxNTLm+vZkEQ=",
          "",
          "[Added Lines]",
          "381: golang.org/x/sys v0.31.0 h1:ioabZlmFYtWhL+TRYpcnNlLwhyxaM9kWTDEmfnprqik=",
          "382: golang.org/x/sys v0.31.0/go.mod h1:BJP2sWEmIv4KK5OTEluFJCKSidICx8ciO85XgH3Ak8k=",
          "387: golang.org/x/term v0.30.0 h1:PQ39fJZ+mfadBm0y5WlL4vlM7Sx1Hgf13sMIY2+QS9Y=",
          "388: golang.org/x/term v0.30.0/go.mod h1:NYYFdzHoI5wRh/h5tDMdMqCqPJZEuNqVR5xJLd/n67g=",
          "393: golang.org/x/text v0.23.0 h1:D71I7dUrlY+VX0gQShAThNGHFxZ13dGLBHQLVl1mJlY=",
          "394: golang.org/x/text v0.23.0/go.mod h1:/BLNzu4aZCJ1+kcD0DNRotWKage4q2rGVAg4o22unh4=",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "417: gomodules.xyz/jsonpatch/v2 v2.4.0/go.mod h1:AH3dM2RI6uoBZxn3LVrfvJ3E0/9dG4cSrbuBJT4moAY=",
          "418: google.golang.org/appengine v1.1.0/go.mod h1:EbEs0AVv82hx2wNQdGPgUI5lhzA/G0D9YwlJXL52JkM=",
          "419: google.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=",
          "422: google.golang.org/genproto v0.0.0-20180817151627-c66870c02cf8/go.mod h1:JiN7NxoALGmiZfu7CAH4rXhgtRTLTxftemlI0sWmxmc=",
          "423: google.golang.org/genproto v0.0.0-20190819201941-24fa4b261c55/go.mod h1:DMBHOl98Agz4BDEuKkezgsaosCRResVns1a3J2ZsMNc=",
          "424: google.golang.org/genproto v0.0.0-20200526211855-cb27e3aa2013/go.mod h1:NbSheEEYHJ7i3ixzK3sjbqSGDJWnxyFXZblF3eUsNvo=",
          "",
          "[Removed Lines]",
          "420: google.golang.org/appengine v1.6.8 h1:IhEN5q69dyKagZPYMSdIjS2HqprW324FRQZJcGqPAsM=",
          "421: google.golang.org/appengine v1.6.8/go.mod h1:1jJ3jBArFh5pcgW8gCtRJnepW8FzD1V44FJffLiz/Ds=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "441: google.golang.org/protobuf v1.22.0/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=",
          "442: google.golang.org/protobuf v1.23.1-0.20200526195155-81db48ad09cc/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=",
          "443: google.golang.org/protobuf v1.25.0/go.mod h1:9JNX74DMeImyA3h4bdi1ymwjUzf21/xIlbajtzgsN7c=",
          "446: google.golang.org/protobuf v1.34.1 h1:9ddQBjfCyZPOHPUiPxpYESBLc+T8P3E+Vo4IbKZgFWg=",
          "447: google.golang.org/protobuf v1.34.1/go.mod h1:c6P6GXX6sHbq/GpV6MGZEdwhWPcYBgnhAHhKbcUYpos=",
          "448: gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=",
          "",
          "[Removed Lines]",
          "444: google.golang.org/protobuf v1.26.0-rc.1/go.mod h1:jlhhOSvTdKEhbULTjvd4ARK9grFBp09yW+WbY/TyQbw=",
          "445: google.golang.org/protobuf v1.26.0/go.mod h1:9q0QmTI4eRPtz6boOQmLYwt+qCgq0jsYwAQnmE0givc=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c8a36259cd1ced02735e6b9a9eb062f7bbeb510f",
      "candidate_info": {
        "commit_hash": "c8a36259cd1ced02735e6b9a9eb062f7bbeb510f",
        "repo": "metal3-io/baremetal-operator",
        "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/c8a36259cd1ced02735e6b9a9eb062f7bbeb510f",
        "files": [
          "hack/ci-e2e.sh"
        ],
        "message": "Fix minikube restart in e2e by trying in a loop\n\nThis is a workaround for a long existing issue in minikube which we opened long ago but it seems it has not gone away. Here is the issue for more detail https://github.com/kubernetes/minikube/issues/14456\n\nSigned-off-by: Kashif Khan <kashif.khan@est.tech>",
        "before_after_code_files": [
          "hack/ci-e2e.sh||hack/ci-e2e.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/metal3-io/baremetal-operator/pull/2423"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "hack/ci-e2e.sh||hack/ci-e2e.sh": [
          "File: hack/ci-e2e.sh -> hack/ci-e2e.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "71: # Restart minikube to apply the changes",
          "72: minikube stop",
          "75: # Load the BMO e2e image into it",
          "76: # minikube image load quay.io/metal3-io/baremetal-operator:e2e",
          "",
          "[Removed Lines]",
          "73: minikube start",
          "",
          "[Added Lines]",
          "73: ## Following loop is to avoid minikube restart issue",
          "74: ## https://github.com/kubernetes/minikube/issues/14456",
          "75: while ! minikube start; do sleep 30; done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "700b069f36a870cc7763e6965e85aae44c505ea2",
      "candidate_info": {
        "commit_hash": "700b069f36a870cc7763e6965e85aae44c505ea2",
        "repo": "metal3-io/baremetal-operator",
        "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/700b069f36a870cc7763e6965e85aae44c505ea2",
        "files": [
          "go.mod"
        ],
        "message": "clean off toolchain directive the main go.mod\n\nSigned-off-by: Tuomo Tanskanen <tuomo.tanskanen@est.tech>",
        "before_after_code_files": [
          "go.mod||go.mod"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/metal3-io/baremetal-operator/pull/2423"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: module github.com/metal3-io/baremetal-operator",
          "7: require (",
          "8:  github.com/go-logr/logr v1.4.2",
          "",
          "[Removed Lines]",
          "3: go 1.23.0",
          "5: toolchain go1.23.7",
          "",
          "[Added Lines]",
          "3: go 1.23.7",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "280188e95605ced2e7223b0f9aedebe845ff544d",
      "candidate_info": {
        "commit_hash": "280188e95605ced2e7223b0f9aedebe845ff544d",
        "repo": "metal3-io/baremetal-operator",
        "commit_url": "https://github.com/metal3-io/baremetal-operator/commit/280188e95605ced2e7223b0f9aedebe845ff544d",
        "files": [
          "apis/metal3.io/v1alpha1/bmceventsubscription_validation.go",
          "apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go",
          "controllers/metal3.io/bmceventsubscription_controller.go",
          "controllers/metal3.io/bmceventsubscription_controller_test.go"
        ],
        "message": "Only accept HTTPHeadersRef in same namespace\n\nThe BMCEventSubscription spec uses a Secret reference for the\nHTTPHeadersRef field. This allows the user to specify any namespace. To\nprevent leaking Secrets, this commit restricts the namespace to the same\nnamespace that the BMCEventSubscription is in.\n\nSigned-off-by: Lennart Jern <lennart.jern@est.tech>",
        "before_after_code_files": [
          "apis/metal3.io/v1alpha1/bmceventsubscription_validation.go||apis/metal3.io/v1alpha1/bmceventsubscription_validation.go",
          "apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go||apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go",
          "controllers/metal3.io/bmceventsubscription_controller.go||controllers/metal3.io/bmceventsubscription_controller.go",
          "controllers/metal3.io/bmceventsubscription_controller_test.go||controllers/metal3.io/bmceventsubscription_controller_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/metal3-io/baremetal-operator/pull/2423"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apis/metal3.io/v1alpha1/bmceventsubscription_validation.go||apis/metal3.io/v1alpha1/bmceventsubscription_validation.go": [
          "File: apis/metal3.io/v1alpha1/bmceventsubscription_validation.go -> apis/metal3.io/v1alpha1/bmceventsubscription_validation.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "29:   errs = append(errs, errors.New(\"hostName cannot be empty\"))",
          "30:  }",
          "32:  if s.Spec.Destination == \"\" {",
          "33:   errs = append(errs, errors.New(\"destination cannot be empty\"))",
          "34:  } else {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:  if s.Spec.HTTPHeadersRef != nil {",
          "33:   if s.Spec.HTTPHeadersRef.Namespace != s.Namespace {",
          "34:    errs = append(errs, errors.New(\"httpHeadersRef secret must be in the same namespace as the BMCEventSubscription\"))",
          "35:   }",
          "36:  }",
          "",
          "---------------"
        ],
        "apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go||apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go": [
          "File: apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go -> apis/metal3.io/v1alpha1/bmceventsubscription_validation_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import (",
          "4:  \"testing\"",
          "6:  metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"",
          "7: )",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "6:  corev1 \"k8s.io/api/core/v1\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69:    oldS:      nil,",
          "70:    wantedErr: \"hostname-only destination must have a trailing slash\",",
          "71:   },",
          "72:  }",
          "74:  for _, tt := range tests {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "73:   {",
          "74:    name: \"httpHeadersRef valid\",",
          "75:    newS: &BMCEventSubscription{",
          "76:     TypeMeta:   tm,",
          "77:     ObjectMeta: om,",
          "78:     Spec: BMCEventSubscriptionSpec{HostName: \"worker-01\", Destination: \"http://localhost/abc/abc.php\",",
          "79:      HTTPHeadersRef: &corev1.SecretReference{Namespace: om.Namespace, Name: \"headers\"}},",
          "80:    },",
          "81:    oldS:      nil,",
          "82:    wantedErr: \"\",",
          "83:   },",
          "84:   {",
          "85:    name: \"httpHeadersRef in different namespace\",",
          "86:    newS: &BMCEventSubscription{",
          "87:     TypeMeta:   tm,",
          "88:     ObjectMeta: om,",
          "89:     Spec: BMCEventSubscriptionSpec{HostName: \"worker-01\", Destination: \"http://localhost/abc/abc.php\",",
          "90:      HTTPHeadersRef: &corev1.SecretReference{Namespace: \"different\", Name: \"headers\"}},",
          "91:    },",
          "92:    oldS:      nil,",
          "93:    wantedErr: \"httpHeadersRef secret must be in the same namespace as the BMCEventSubscription\",",
          "94:   },",
          "",
          "---------------"
        ],
        "controllers/metal3.io/bmceventsubscription_controller.go||controllers/metal3.io/bmceventsubscription_controller.go": [
          "File: controllers/metal3.io/bmceventsubscription_controller.go -> controllers/metal3.io/bmceventsubscription_controller.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "243:   return headers, nil",
          "244:  }",
          "246:  secret := &corev1.Secret{}",
          "247:  secretKey := types.NamespacedName{",
          "248:   Name:      subscription.Spec.HTTPHeadersRef.Name,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "246:  if subscription.Spec.HTTPHeadersRef.Namespace != subscription.Namespace {",
          "247:   return headers, errors.New(\"httpHeadersRef secret must be in the same namespace as the BMCEventSubscription\")",
          "248:  }",
          "",
          "---------------"
        ],
        "controllers/metal3.io/bmceventsubscription_controller_test.go||controllers/metal3.io/bmceventsubscription_controller_test.go": [
          "File: controllers/metal3.io/bmceventsubscription_controller_test.go -> controllers/metal3.io/bmceventsubscription_controller_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "139:   })",
          "140:  }",
          "141: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "143: func TestGetHTTPHeaders(t *testing.T) {",
          "146:  host := newDefaultHost(t)",
          "147:  subscription := newDefaultSubscription(t)",
          "148:  r := newBMCTestReconciler(subscription, host)",
          "150:  for _, tc := range []struct {",
          "151:   Scenario      string",
          "152:   Subscription  *metal3api.BMCEventSubscription",
          "153:   Secret        *corev1.Secret",
          "154:   ExpectedError bool",
          "155:  }{",
          "156:   {",
          "157:    Scenario:     \"Secret exists and has some content\",",
          "158:    Subscription: subscription,",
          "160:    Secret:        nil,",
          "161:    ExpectedError: false,",
          "162:   },",
          "163:   {",
          "164:    Scenario: \"Secret does not exist\",",
          "165:    Subscription: &metal3api.BMCEventSubscription{",
          "166:     ObjectMeta: metav1.ObjectMeta{",
          "167:      Name:      \"test-subscription\",",
          "168:      Namespace: namespace,",
          "169:     },",
          "170:     Spec: metal3api.BMCEventSubscriptionSpec{",
          "171:      HostName: host.Name,",
          "172:      HTTPHeadersRef: &corev1.SecretReference{",
          "173:       Name:      \"non-existent-secret\",",
          "174:       Namespace: namespace,",
          "175:      },",
          "176:     },",
          "177:    },",
          "178:    Secret:        nil,",
          "179:    ExpectedError: true,",
          "180:   },",
          "181:   {",
          "182:    Scenario: \"Secret in wrong namespace\",",
          "183:    Subscription: &metal3api.BMCEventSubscription{",
          "184:     ObjectMeta: metav1.ObjectMeta{",
          "185:      Name:      \"test-subscription\",",
          "186:      Namespace: namespace,",
          "187:     },",
          "188:     Spec: metal3api.BMCEventSubscriptionSpec{",
          "189:      HostName: host.Name,",
          "190:      HTTPHeadersRef: &corev1.SecretReference{",
          "191:       Name:      \"test\",",
          "192:       Namespace: \"separate-namespace\",",
          "193:      },",
          "194:     },",
          "195:    },",
          "196:    Secret:        nil,",
          "197:    ExpectedError: true,",
          "198:   },",
          "199:  } {",
          "200:   t.Run(tc.Scenario, func(t *testing.T) {",
          "201:    if tc.Secret != nil {",
          "202:     err := r.Create(context.Background(), tc.Secret)",
          "203:     if err != nil {",
          "204:      t.Fatal(err)",
          "205:     }",
          "206:    }",
          "208:    headers, err := r.getHTTPHeaders(context.Background(), *tc.Subscription)",
          "209:    if tc.ExpectedError && err == nil {",
          "210:     t.Error(\"Expected error but got none\")",
          "211:    }",
          "212:    if !tc.ExpectedError {",
          "213:     if err != nil {",
          "214:      t.Errorf(\"Expected no error but got: %v\", err)",
          "215:     }",
          "216:     if len(headers) == 0 {",
          "217:      t.Error(\"Expected headers but got none\")",
          "218:     }",
          "219:    }",
          "220:   })",
          "221:  }",
          "222: }",
          "",
          "---------------"
        ]
      }
    }
  ]
}