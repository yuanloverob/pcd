{
  "cve_id": "CVE-2022-24877",
  "cve_desc": "Flux is an open and extensible continuous delivery solution for Kubernetes. Path Traversal in the kustomize-controller via a malicious `kustomization.yaml` allows an attacker to expose sensitive data from the controller\u2019s pod filesystem and possibly privilege escalation in multi-tenancy deployments. Workarounds include automated tooling in the user's CI/CD pipeline to validate `kustomization.yaml` files conform with specific policies. This vulnerability is fixed in kustomize-controller v0.24.0 and included in flux2 v0.29.0.",
  "repo": "fluxcd/kustomize-controller",
  "patch_hash": "f4528fb25d611da94e491346bea056d5c5c3611f",
  "patch_info": {
    "commit_hash": "f4528fb25d611da94e491346bea056d5c5c3611f",
    "repo": "fluxcd/kustomize-controller",
    "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/f4528fb25d611da94e491346bea056d5c5c3611f",
    "files": [
      "controllers/kustomization_controller.go",
      "controllers/kustomization_decryptor.go",
      "controllers/kustomization_generator.go",
      "go.mod",
      "go.sum"
    ],
    "message": "controllers: use own Kustomize FS implementation\n\nFor details, see: https://github.com/fluxcd/pkg/pull/262\n\nSigned-off-by: Hidde Beydals <hello@hidde.co>",
    "before_after_code_files": [
      "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
      "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go",
      "controllers/kustomization_generator.go||controllers/kustomization_generator.go",
      "go.mod||go.mod",
      "go.sum||go.sum"
    ]
  },
  "patch_diff": {
    "controllers/kustomization_controller.go||controllers/kustomization_controller.go": [
      "File: controllers/kustomization_controller.go -> controllers/kustomization_controller.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "52:  \"sigs.k8s.io/controller-runtime/pkg/predicate\"",
      "53:  \"sigs.k8s.io/controller-runtime/pkg/reconcile\"",
      "54:  \"sigs.k8s.io/controller-runtime/pkg/source\"",
      "57:  apiacl \"github.com/fluxcd/pkg/apis/acl\"",
      "58:  \"github.com/fluxcd/pkg/apis/meta\"",
      "",
      "[Removed Lines]",
      "55:  \"sigs.k8s.io/kustomize/kyaml/filesys\"",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "357:  }",
      "361:  if err != nil {",
      "362:   return kustomizev1.KustomizationNotReady(",
      "363:    kustomization,",
      "",
      "[Removed Lines]",
      "360:  err = r.generate(kustomization, dirPath)",
      "",
      "[Added Lines]",
      "359:  err = r.generate(kustomization, tmpDir, dirPath)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "629:  return source, nil",
      "630: }",
      "634:  return gen.WriteFile(dirPath)",
      "635: }",
      "",
      "[Removed Lines]",
      "632: func (r *KustomizationReconciler) generate(kustomization kustomizev1.Kustomization, dirPath string) error {",
      "633:  gen := NewGenerator(kustomization)",
      "",
      "[Added Lines]",
      "631: func (r *KustomizationReconciler) generate(kustomization kustomizev1.Kustomization, workDir string, dirPath string) error {",
      "632:  gen := NewGenerator(workDir, kustomization)",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "641:  }",
      "642:  defer cleanup()",
      "645:  if err := dec.ImportKeys(ctx); err != nil {",
      "646:   return nil, err",
      "647:  }",
      "655:  }",
      "657:  if err != nil {",
      "658:   return nil, fmt.Errorf(\"kustomize build failed: %w\", err)",
      "659:  }",
      "",
      "[Removed Lines]",
      "649:  fs := filesys.MakeFsOnDisk()",
      "651:  if kustomization.Spec.Decryption != nil {",
      "652:   if err = dec.DecryptEnvSources(dirPath); err != nil {",
      "653:    return nil, fmt.Errorf(\"error decrypting .env file: %w\", err)",
      "654:   }",
      "656:  m, err := buildKustomization(fs, dirPath)",
      "",
      "[Added Lines]",
      "649:  if err = dec.DecryptEnvSources(dirPath); err != nil {",
      "650:   return nil, fmt.Errorf(\"error decrypting env sources: %w\", err)",
      "653:  m, err := secureBuildKustomization(workDir, dirPath)",
      "",
      "---------------"
    ],
    "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go": [
      "File: controllers/kustomization_decryptor.go -> controllers/kustomization_decryptor.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "360: func (d *KustomizeDecryptor) DecryptEnvSources(path string) error {",
      "362:   return nil",
      "363:  }",
      "",
      "[Removed Lines]",
      "361:  if d.kustomization.Spec.Decryption.Provider != DecryptionProviderSOPS {",
      "",
      "[Added Lines]",
      "361:  if d.kustomization.Spec.Decryption == nil || d.kustomization.Spec.Decryption.Provider != DecryptionProviderSOPS {",
      "",
      "---------------"
    ],
    "controllers/kustomization_generator.go||controllers/kustomization_generator.go": [
      "File: controllers/kustomization_generator.go -> controllers/kustomization_generator.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "29:  \"sigs.k8s.io/kustomize/api/provider\"",
      "30:  \"sigs.k8s.io/kustomize/api/resmap\"",
      "31:  kustypes \"sigs.k8s.io/kustomize/api/types\"",
      "33:  \"sigs.k8s.io/yaml\"",
      "36:  \"github.com/fluxcd/pkg/apis/kustomize\"",
      "37: )",
      "39: type KustomizeGenerator struct {",
      "40:  kustomization kustomizev1.Kustomization",
      "41: }",
      "44:  return &KustomizeGenerator{",
      "45:   kustomization: kustomization,",
      "46:  }",
      "47: }",
      "",
      "[Removed Lines]",
      "32:  \"sigs.k8s.io/kustomize/kyaml/filesys\"",
      "35:  kustomizev1 \"github.com/fluxcd/kustomize-controller/api/v1beta2\"",
      "43: func NewGenerator(kustomization kustomizev1.Kustomization) *KustomizeGenerator {",
      "",
      "[Added Lines]",
      "35:  securefs \"github.com/fluxcd/pkg/kustomize/filesys\"",
      "37:  kustomizev1 \"github.com/fluxcd/kustomize-controller/api/v1beta2\"",
      "41:  root          string",
      "45: func NewGenerator(root string, kustomization kustomizev1.Kustomization) *KustomizeGenerator {",
      "47:   root:          root,",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "127: }",
      "129: func (kg *KustomizeGenerator) generateKustomization(dirPath string) error {",
      "",
      "[Removed Lines]",
      "130:  fs := filesys.MakeFsOnDisk()",
      "",
      "[Added Lines]",
      "133:  fs, err := securefs.MakeFsOnDiskSecure(kg.root)",
      "134:  if err != nil {",
      "135:   return err",
      "136:  }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "235: var kustomizeBuildMutex sync.Mutex",
      "243:  kustomizeBuildMutex.Lock()",
      "244:  defer kustomizeBuildMutex.Unlock()",
      "",
      "[Removed Lines]",
      "240: func buildKustomization(fs filesys.FileSystem, dirPath string) (resmap.ResMap, error) {",
      "",
      "[Added Lines]",
      "248: func secureBuildKustomization(root, dirPath string) (resmap.ResMap, error) {",
      "250:  fs, err := securefs.MakeFsOnDiskSecure(root)",
      "251:  if err != nil {",
      "252:   return nil, err",
      "253:  }",
      "",
      "---------------"
    ],
    "go.mod||go.mod": [
      "File: go.mod -> go.mod",
      "--- Hunk 1 ---",
      "[Context before]",
      "16:  github.com/fluxcd/pkg/apis/acl v0.0.3",
      "17:  github.com/fluxcd/pkg/apis/kustomize v0.3.2",
      "18:  github.com/fluxcd/pkg/apis/meta v0.12.1",
      "19:  github.com/fluxcd/pkg/runtime v0.13.3",
      "20:  github.com/fluxcd/pkg/ssa v0.15.1",
      "21:  github.com/fluxcd/pkg/testserver v0.2.0",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "19:  github.com/fluxcd/pkg/kustomize v0.2.0",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "29:  go.mozilla.org/sops/v3 v3.7.2",
      "30:  golang.org/x/net v0.0.0-20220225172249-27dd8689420f",
      "31:  google.golang.org/grpc v1.45.0",
      "36:  sigs.k8s.io/cli-utils v0.29.3",
      "38:  sigs.k8s.io/kustomize/api v0.11.4",
      "40:  sigs.k8s.io/yaml v1.3.0",
      "41: )",
      "",
      "[Removed Lines]",
      "32:  k8s.io/api v0.23.4",
      "33:  k8s.io/apiextensions-apiserver v0.23.4",
      "34:  k8s.io/apimachinery v0.23.4",
      "35:  k8s.io/client-go v0.23.4",
      "37:  sigs.k8s.io/controller-runtime v0.11.1",
      "39:  sigs.k8s.io/kustomize/kyaml v0.13.6",
      "",
      "[Added Lines]",
      "33:  k8s.io/api v0.23.5",
      "34:  k8s.io/apiextensions-apiserver v0.23.5",
      "35:  k8s.io/apimachinery v0.23.5",
      "36:  k8s.io/client-go v0.23.5",
      "38:  sigs.k8s.io/controller-runtime v0.11.2",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "199:  gopkg.in/yaml.v2 v2.4.0 // indirect",
      "200:  gopkg.in/yaml.v3 v3.0.0-20210107192922-496545a6307b // indirect",
      "201:  k8s.io/cli-runtime v0.23.2 // indirect",
      "203:  k8s.io/klog/v2 v2.50.0 // indirect",
      "204:  k8s.io/kube-openapi v0.0.0-20211115234752-e816edb12b65 // indirect",
      "205:  k8s.io/kubectl v0.23.2 // indirect",
      "206:  k8s.io/utils v0.0.0-20220210201930-3a6ce19ff2f9 // indirect",
      "207:  sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2 // indirect",
      "208:  sigs.k8s.io/structured-merge-diff/v4 v4.2.1 // indirect",
      "209: )",
      "",
      "[Removed Lines]",
      "202:  k8s.io/component-base v0.23.4 // indirect",
      "",
      "[Added Lines]",
      "202:  k8s.io/component-base v0.23.5 // indirect",
      "208:  sigs.k8s.io/kustomize/kyaml v0.13.6 // indirect",
      "",
      "---------------"
    ],
    "go.sum||go.sum": [
      "File: go.sum -> go.sum",
      "--- Hunk 1 ---",
      "[Context before]",
      "276: github.com/fluxcd/pkg/apis/kustomize v0.3.2/go.mod h1:p8iAH5TeqMBnnxkkpCNNDvWYfKlNRx89a6WKOo+hJHA=",
      "277: github.com/fluxcd/pkg/apis/meta v0.12.1 h1:m5PfKAqbqWBvGp9+JRj1sv+xNkGsHwUVf+3rJ8wm6SE=",
      "278: github.com/fluxcd/pkg/apis/meta v0.12.1/go.mod h1:f8YVt70/KAhqzZ7xxhjvqyzKubOYx2pAbakb/FfCEg8=",
      "279: github.com/fluxcd/pkg/runtime v0.13.3 h1:k0Xun+RoEC/F6iuAPTA6rQb+I4B4oecBx6pOcodX11A=",
      "280: github.com/fluxcd/pkg/runtime v0.13.3/go.mod h1:dzWNKqFzFXeittbpFcJzR3cdC9CWlbzw+pNOgaVvF/0=",
      "281: github.com/fluxcd/pkg/ssa v0.15.1 h1:HXAT+K6c9Yy8Evxdyk3DU0KTk3yZ+fwgTEEzU1W/1V8=",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "279: github.com/fluxcd/pkg/kustomize v0.2.0 h1:twiGAFJctt2tyH8vHxL1uqb6BlU3B9ZqG8uSlluuioM=",
      "280: github.com/fluxcd/pkg/kustomize v0.2.0/go.mod h1:Qczvl7vNY9NJBpyaFrldsxfGjj6uaMcMmKGsSJ6hcxc=",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1440: honnef.co/go/tools v0.0.1-2020.1.3/go.mod h1:X/FiERA/W4tHapMX5mGpAtMSVEeEUOyHaw9vFzvIQ3k=",
      "1441: honnef.co/go/tools v0.0.1-2020.1.4/go.mod h1:X/FiERA/W4tHapMX5mGpAtMSVEeEUOyHaw9vFzvIQ3k=",
      "1442: k8s.io/api v0.23.2/go.mod h1:sYuDb3flCtRPI8ghn6qFrcK5ZBu2mhbElxRE95qpwlI=",
      "1447: k8s.io/apimachinery v0.23.2/go.mod h1:zDqeV0AK62LbCI0CI7KbWCAYdLg+E+8UXJ0rIz5gmS8=",
      "1451: k8s.io/cli-runtime v0.23.2 h1:4zOZX78mFSakwe4gef81XDBu94Yu0th6bfveTOx8ZQk=",
      "1452: k8s.io/cli-runtime v0.23.2/go.mod h1:Ag70akCDvwux4HxY+nH2J3UqE2e6iwSSdG1HE6p1VTU=",
      "1453: k8s.io/client-go v0.23.2/go.mod h1:k3YbsWg6GWdHF1THHTQP88X9RhB1DWPo3Dq7KfU/D1c=",
      "1456: k8s.io/code-generator v0.23.2/go.mod h1:S0Q1JVA+kSzTI1oUvbKAxZY/DYbA/ZUb4Uknog12ETk=",
      "1458: k8s.io/component-base v0.23.2/go.mod h1:wS9Z03MO3oJ0RU8bB/dbXTiluGju+SC/F5i660gxB8c=",
      "1461: k8s.io/component-helpers v0.23.2/go.mod h1:J6CMwiaf0izLoNwiLl2OymB4+rGTsTpWp6PL/AqOM4U=",
      "1462: k8s.io/gengo v0.0.0-20200413195148-3a45101e95ac/go.mod h1:ezvh/TsK7cY6rbqRK0oQQ8IAqLxYwwyPxAX1Pzy0ii0=",
      "1463: k8s.io/gengo v0.0.0-20210813121822-485abfe95c7c/go.mod h1:FiNAH4ZV3gBg2Kwh89tzAEV2be7d5xI0vBa/VySYy3E=",
      "",
      "[Removed Lines]",
      "1443: k8s.io/api v0.23.4 h1:85gnfXQOWbJa1SiWGpE9EEtHs0UVvDyIsSMpEtl2D4E=",
      "1444: k8s.io/api v0.23.4/go.mod h1:i77F4JfyNNrhOjZF7OwwNJS5Y1S9dpwvb9iYRYRczfI=",
      "1445: k8s.io/apiextensions-apiserver v0.23.4 h1:AFDUEu/yEf0YnuZhqhIFhPLPhhcQQVuR1u3WCh0rveU=",
      "1446: k8s.io/apiextensions-apiserver v0.23.4/go.mod h1:TWYAKymJx7nLMxWCgWm2RYGXHrGlVZnxIlGnvtfYu+g=",
      "1448: k8s.io/apimachinery v0.23.4 h1:fhnuMd/xUL3Cjfl64j5ULKZ1/J9n8NuQEgNL+WXWfdM=",
      "1449: k8s.io/apimachinery v0.23.4/go.mod h1:BEuFMMBaIbcOqVIJqNZJXGFTP4W6AycEpb5+m/97hrM=",
      "1450: k8s.io/apiserver v0.23.4/go.mod h1:A6l/ZcNtxGfPSqbFDoxxOjEjSKBaQmE+UTveOmMkpNc=",
      "1454: k8s.io/client-go v0.23.4 h1:YVWvPeerA2gpUudLelvsolzH7c2sFoXXR5wM/sWqNFU=",
      "1455: k8s.io/client-go v0.23.4/go.mod h1:PKnIL4pqLuvYUK1WU7RLTMYKPiIh7MYShLshtRY9cj0=",
      "1457: k8s.io/code-generator v0.23.4/go.mod h1:S0Q1JVA+kSzTI1oUvbKAxZY/DYbA/ZUb4Uknog12ETk=",
      "1459: k8s.io/component-base v0.23.4 h1:SziYh48+QKxK+ykJ3Ejqd98XdZIseVBG7sBaNLPqy6M=",
      "1460: k8s.io/component-base v0.23.4/go.mod h1:8o3Gg8i2vnUXGPOwciiYlkSaZT+p+7gA9Scoz8y4W4E=",
      "",
      "[Added Lines]",
      "1445: k8s.io/api v0.23.5 h1:zno3LUiMubxD/V1Zw3ijyKO3wxrhbUF1Ck+VjBvfaoA=",
      "1446: k8s.io/api v0.23.5/go.mod h1:Na4XuKng8PXJ2JsploYYrivXrINeTaycCGcYgF91Xm8=",
      "1447: k8s.io/apiextensions-apiserver v0.23.5 h1:5SKzdXyvIJKu+zbfPc3kCbWpbxi+O+zdmAJBm26UJqI=",
      "1448: k8s.io/apiextensions-apiserver v0.23.5/go.mod h1:ntcPWNXS8ZPKN+zTXuzYMeg731CP0heCTl6gYBxLcuQ=",
      "1450: k8s.io/apimachinery v0.23.5 h1:Va7dwhp8wgkUPWsEXk6XglXWU4IKYLKNlv8VkX7SDM0=",
      "1451: k8s.io/apimachinery v0.23.5/go.mod h1:BEuFMMBaIbcOqVIJqNZJXGFTP4W6AycEpb5+m/97hrM=",
      "1452: k8s.io/apiserver v0.23.5/go.mod h1:7wvMtGJ42VRxzgVI7jkbKvMbuCbVbgsWFT7RyXiRNTw=",
      "1456: k8s.io/client-go v0.23.5 h1:zUXHmEuqx0RY4+CsnkOn5l0GU+skkRXKGJrhmE2SLd8=",
      "1457: k8s.io/client-go v0.23.5/go.mod h1:flkeinTO1CirYgzMPRWxUCnV0G4Fbu2vLhYCObnt/r4=",
      "1459: k8s.io/code-generator v0.23.5/go.mod h1:S0Q1JVA+kSzTI1oUvbKAxZY/DYbA/ZUb4Uknog12ETk=",
      "1461: k8s.io/component-base v0.23.5 h1:8qgP5R6jG1BBSXmRYW+dsmitIrpk8F/fPEvgDenMCCE=",
      "1462: k8s.io/component-base v0.23.5/go.mod h1:c5Nq44KZyt1aLl0IpHX82fhsn84Sb0jjzwjpcA42bY0=",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1480: rsc.io/binaryregexp v0.2.0/go.mod h1:qTv7/COck+e2FymRvadv62gMdZztPaShugOCi3I+8D8=",
      "1481: rsc.io/quote/v3 v3.1.0/go.mod h1:yEA65RcK8LyAZtP9Kv3t0HmxON59tX3rD+tICJqUlj0=",
      "1482: rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA=",
      "1484: sigs.k8s.io/cli-utils v0.29.3 h1:4QRB9ayCd5pd9M/D3q2KQgr+nYrvRaw3suW+rcOutvk=",
      "1485: sigs.k8s.io/cli-utils v0.29.3/go.mod h1:WDVRa5/eQBKntG++uyKdyT+xU7MLdCR4XsgseqL5uX4=",
      "1488: sigs.k8s.io/json v0.0.0-20211020170558-c049b76a60c6/go.mod h1:p4QtZmO4uMYipTQNzagwnNoseA6OxSUutVw05NhYDRs=",
      "1489: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2 h1:kDi4JBNAsJWfz1aEXhO8Jg87JJaPNLh5tIzYHgStQ9Y=",
      "1490: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2/go.mod h1:B+TnT182UBxE84DiCz4CVE26eOSDAeYCpfDnC2kdKMY=",
      "",
      "[Removed Lines]",
      "1483: sigs.k8s.io/apiserver-network-proxy/konnectivity-client v0.0.27/go.mod h1:tq2nT0Kx7W+/f2JVE+zxYtUhdjuELJkVpNz+x/QN5R4=",
      "1486: sigs.k8s.io/controller-runtime v0.11.1 h1:7YIHT2QnHJArj/dk9aUkYhfqfK5cIxPOX5gPECfdZLU=",
      "1487: sigs.k8s.io/controller-runtime v0.11.1/go.mod h1:KKwLiTooNGu+JmLZGn9Sl3Gjmfj66eMbCQznLP5zcqA=",
      "",
      "[Added Lines]",
      "1485: sigs.k8s.io/apiserver-network-proxy/konnectivity-client v0.0.30/go.mod h1:fEO7lRTdivWO2qYVCVG7dEADOMo/MLDCVr8So2g88Uw=",
      "1488: sigs.k8s.io/controller-runtime v0.11.2 h1:H5GTxQl0Mc9UjRJhORusqfJCIjBO8UtUxGggCwL1rLA=",
      "1489: sigs.k8s.io/controller-runtime v0.11.2/go.mod h1:P6QCzrEjLaZGqHsfd+os7JQ+WFZhvB8MRFsn4dWF7O4=",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b6cb225b9b42f4fc27f2326af0e64322b83020df",
      "candidate_info": {
        "commit_hash": "b6cb225b9b42f4fc27f2326af0e64322b83020df",
        "repo": "fluxcd/kustomize-controller",
        "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/b6cb225b9b42f4fc27f2326af0e64322b83020df",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "Update controller to kustomize v4.5.4\n\nSigned-off-by: Stefan Prodan <stefan.prodan@gmail.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:  k8s.io/client-go v0.23.4",
          "37:  sigs.k8s.io/cli-utils v0.29.3",
          "38:  sigs.k8s.io/controller-runtime v0.11.1",
          "41:  sigs.k8s.io/yaml v1.3.0",
          "42: )",
          "45: replace (",
          "48: )",
          "",
          "[Removed Lines]",
          "39:  sigs.k8s.io/kustomize/api v0.11.3",
          "40:  sigs.k8s.io/kustomize/kyaml v0.13.4",
          "46:  sigs.k8s.io/kustomize/api => sigs.k8s.io/kustomize/api v0.11.3",
          "47:  sigs.k8s.io/kustomize/kyaml => sigs.k8s.io/kustomize/kyaml v0.13.4",
          "",
          "[Added Lines]",
          "39:  sigs.k8s.io/kustomize/api v0.11.4",
          "40:  sigs.k8s.io/kustomize/kyaml v0.13.6",
          "46:  sigs.k8s.io/kustomize/api => sigs.k8s.io/kustomize/api v0.11.4",
          "47:  sigs.k8s.io/kustomize/kyaml => sigs.k8s.io/kustomize/kyaml v0.13.6",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "393: github.com/google/btree v1.0.1/go.mod h1:xXMiIv4Fb/0kKde4SpL7qlzvu5cMJDRkFDxJfI9uaxA=",
          "394: github.com/google/cel-go v0.9.0/go.mod h1:U7ayypeSkw23szu4GaQTPJGx66c20mx8JklMSxrmI1w=",
          "395: github.com/google/cel-spec v0.6.0/go.mod h1:Nwjgxy5CbjlPrtCWjeDjUyKMl8w41YBYGjsyDdqk0xA=",
          "396: github.com/google/go-cmp v0.2.0/go.mod h1:oXzfMopK8JAjlY9xF4vHSVASa0yLyX7SntLO5aqRK0M=",
          "397: github.com/google/go-cmp v0.3.0/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=",
          "398: github.com/google/go-cmp v0.3.1/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "396: github.com/google/gnostic v0.5.7-v3refs h1:FhTMOKj2VhjpouxvWJAV1TL304uMlb9zcDqkl6cEI54=",
          "397: github.com/google/gnostic v0.5.7-v3refs/go.mod h1:73MKFl6jIHelAJNaBGFzt3SPtZULs9dYrGFt8OiIsHQ=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1489: sigs.k8s.io/json v0.0.0-20211020170558-c049b76a60c6/go.mod h1:p4QtZmO4uMYipTQNzagwnNoseA6OxSUutVw05NhYDRs=",
          "1490: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2 h1:kDi4JBNAsJWfz1aEXhO8Jg87JJaPNLh5tIzYHgStQ9Y=",
          "1491: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2/go.mod h1:B+TnT182UBxE84DiCz4CVE26eOSDAeYCpfDnC2kdKMY=",
          "1494: sigs.k8s.io/kustomize/cmd/config v0.10.2/go.mod h1:K2aW7nXJ0AaT+VA/eO0/dzFLxmpFcTzudmAgDwPY1HQ=",
          "1495: sigs.k8s.io/kustomize/kustomize/v4 v4.4.1/go.mod h1:qOKJMMz2mBP+vcS7vK+mNz4HBLjaQSWRY22EF6Tb7Io=",
          "1498: sigs.k8s.io/structured-merge-diff/v4 v4.0.2/go.mod h1:bJZC9H9iH24zzfZ/41RGcq60oK1F7G282QMXDPYydCw=",
          "1499: sigs.k8s.io/structured-merge-diff/v4 v4.2.1 h1:bKCqE9GvQ5tiVHn5rfn1r+yao3aLQEaLzkkmAkf+A6Y=",
          "1500: sigs.k8s.io/structured-merge-diff/v4 v4.2.1/go.mod h1:j/nl6xW8vLS49O8YvXW1ocPhZawJtm+Yrr7PPRQ0Vg4=",
          "",
          "[Removed Lines]",
          "1492: sigs.k8s.io/kustomize/api v0.11.3 h1:zSfqBnm2eWKtBt1bJdeb8vdFn6RCACjkJBJXD4ewT2A=",
          "1493: sigs.k8s.io/kustomize/api v0.11.3/go.mod h1:+pqeIrqlbShZpegTsFiJtZ6aI8awf8D+9CeO7k7iSFQ=",
          "1496: sigs.k8s.io/kustomize/kyaml v0.13.4 h1:UP4niyzHP8yBDZTJu3OyZMCbJUfT6PIj0fJZFcn8gQw=",
          "1497: sigs.k8s.io/kustomize/kyaml v0.13.4/go.mod h1:/ya3Gk4diiQzlE4mBh7wykyLRFZNvqlbh+JnwQ9Vhrc=",
          "",
          "[Added Lines]",
          "1494: sigs.k8s.io/kustomize/api v0.11.4 h1:/0Mr3kfBBNcNPOW5Qwk/3eb8zkswCwnqQxxKtmrTkRo=",
          "1495: sigs.k8s.io/kustomize/api v0.11.4/go.mod h1:k+8RsqYbgpkIrJ4p9jcdPqe8DprLxFUUO0yNOq8C+xI=",
          "1498: sigs.k8s.io/kustomize/kyaml v0.13.6 h1:eF+wsn4J7GOAXlvajv6OknSunxpcOBQQqsnPxObtkGs=",
          "1499: sigs.k8s.io/kustomize/kyaml v0.13.6/go.mod h1:yHP031rn1QX1lr/Xd934Ri/xdVNG8BE2ECa78Ht/kEg=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f29ae5e833fc5fd0cf65b8a9259c25ffc2f3a382",
      "candidate_info": {
        "commit_hash": "f29ae5e833fc5fd0cf65b8a9259c25ffc2f3a382",
        "repo": "fluxcd/kustomize-controller",
        "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/f29ae5e833fc5fd0cf65b8a9259c25ffc2f3a382",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "Update controller to kustomize v4.5.2\n\nSigned-off-by: Stefan Prodan <stefan.prodan@gmail.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "32:  k8s.io/client-go v0.23.1",
          "33:  sigs.k8s.io/cli-utils v0.27.0",
          "34:  sigs.k8s.io/controller-runtime v0.11.0",
          "36:  sigs.k8s.io/kustomize/kyaml v0.13.3",
          "37:  sigs.k8s.io/yaml v1.3.0",
          "38: )",
          "",
          "[Removed Lines]",
          "35:  sigs.k8s.io/kustomize/api v0.11.1",
          "",
          "[Added Lines]",
          "35:  sigs.k8s.io/kustomize/api v0.11.2",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "185:  sigs.k8s.io/structured-merge-diff/v4 v4.2.0 // indirect",
          "186: )",
          "189: replace (",
          "191:  sigs.k8s.io/kustomize/kyaml => sigs.k8s.io/kustomize/kyaml v0.13.3",
          "192: )",
          "",
          "[Removed Lines]",
          "190:  sigs.k8s.io/kustomize/api => sigs.k8s.io/kustomize/api v0.11.1",
          "",
          "[Added Lines]",
          "190:  sigs.k8s.io/kustomize/api => sigs.k8s.io/kustomize/api v0.11.2",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "1407: sigs.k8s.io/json v0.0.0-20211020170558-c049b76a60c6/go.mod h1:p4QtZmO4uMYipTQNzagwnNoseA6OxSUutVw05NhYDRs=",
          "1408: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2 h1:kDi4JBNAsJWfz1aEXhO8Jg87JJaPNLh5tIzYHgStQ9Y=",
          "1409: sigs.k8s.io/json v0.0.0-20211208200746-9f7c6b3444d2/go.mod h1:B+TnT182UBxE84DiCz4CVE26eOSDAeYCpfDnC2kdKMY=",
          "1412: sigs.k8s.io/kustomize/cmd/config v0.9.13/go.mod h1:7547FLF8W/lTaDf0BDqFTbZxM9zqwEJqCKN9sSR0xSs=",
          "1413: sigs.k8s.io/kustomize/kustomize/v4 v4.2.0/go.mod h1:MOkR6fmhwG7hEDRXBYELTi5GSFcLwfqwzTRHW3kv5go=",
          "1414: sigs.k8s.io/kustomize/kyaml v0.13.3 h1:tNNQIC+8cc+aXFTVg+RtQAOsjwUdYBZRAgYOVI3RBc4=",
          "",
          "[Removed Lines]",
          "1410: sigs.k8s.io/kustomize/api v0.11.1 h1:/Vutu+gAqVo8skw1xCZrsZD39SN4Adg+z7FrSTw9pds=",
          "1411: sigs.k8s.io/kustomize/api v0.11.1/go.mod h1:GZuhith5YcqxIDe0GnRJNx5xxPTjlwaLTt/e+ChUtJA=",
          "",
          "[Added Lines]",
          "1410: sigs.k8s.io/kustomize/api v0.11.2 h1:6YvCJHFDwsLwAX7zNHBxMZi3k7dGIXI8G9l0saYQI0E=",
          "1411: sigs.k8s.io/kustomize/api v0.11.2/go.mod h1:GZuhith5YcqxIDe0GnRJNx5xxPTjlwaLTt/e+ChUtJA=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3090eff7348ffdaa2920ef1422d02fa5315745b7",
      "candidate_info": {
        "commit_hash": "3090eff7348ffdaa2920ef1422d02fa5315745b7",
        "repo": "fluxcd/kustomize-controller",
        "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/3090eff7348ffdaa2920ef1422d02fa5315745b7",
        "files": [
          "controllers/kustomization_controller.go",
          "controllers/kustomization_decryptor_test.go",
          "controllers/kustomization_fetcher.go",
          "controllers/kustomization_transformer_test.go",
          "controllers/kustomization_validation_test.go",
          "controllers/suite_test.go",
          "go.mod",
          "go.sum"
        ],
        "message": "Refactor: Acquire artifacts with `fluxcd/pkg/http/fetch`\n\nSigned-off-by: Stefan Prodan <stefan.prodan@gmail.com>",
        "before_after_code_files": [
          "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
          "controllers/kustomization_decryptor_test.go||controllers/kustomization_decryptor_test.go",
          "controllers/kustomization_fetcher.go||controllers/kustomization_fetcher.go",
          "controllers/kustomization_transformer_test.go||controllers/kustomization_transformer_test.go",
          "controllers/kustomization_validation_test.go||controllers/kustomization_validation_test.go",
          "controllers/suite_test.go||controllers/suite_test.go",
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "controllers/kustomization_controller.go||controllers/kustomization_controller.go": [
          "File: controllers/kustomization_controller.go -> controllers/kustomization_controller.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  apiacl \"github.com/fluxcd/pkg/apis/acl\"",
          "52:  \"github.com/fluxcd/pkg/apis/meta\"",
          "53:  \"github.com/fluxcd/pkg/runtime/acl\"",
          "54:  runtimeClient \"github.com/fluxcd/pkg/runtime/client\"",
          "55:  \"github.com/fluxcd/pkg/runtime/events\"",
          "56:  \"github.com/fluxcd/pkg/runtime/metrics\"",
          "57:  \"github.com/fluxcd/pkg/runtime/predicates\"",
          "58:  \"github.com/fluxcd/pkg/ssa\"",
          "59:  sourcev1 \"github.com/fluxcd/source-controller/api/v1beta2\"",
          "61:  kustomizev1 \"github.com/fluxcd/kustomize-controller/api/v1beta2\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "53:  \"github.com/fluxcd/pkg/http/fetch\"",
          "60:  \"github.com/fluxcd/pkg/tar\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75: type KustomizationReconciler struct {",
          "76:  client.Client",
          "78:  requeueDependency     time.Duration",
          "79:  Scheme                *runtime.Scheme",
          "80:  EventRecorder         kuberecorder.EventRecorder",
          "",
          "[Removed Lines]",
          "77:  artifactFetcher       *ArtifactFetcher",
          "",
          "[Added Lines]",
          "79:  artifactFetcher       *fetch.ArchiveFetcher",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "125:  r.requeueDependency = opts.DependencyRequeueInterval",
          "126:  r.statusManager = fmt.Sprintf(\"gotk-%s\", r.ControllerName)",
          "129:  return ctrl.NewControllerManagedBy(mgr).",
          "130:   For(&kustomizev1.Kustomization{}, builder.WithPredicates(",
          "",
          "[Removed Lines]",
          "127:  r.artifactFetcher = NewArtifactFetcher(opts.HTTPRetry)",
          "",
          "[Added Lines]",
          "129:  r.artifactFetcher = fetch.NewArchiveFetcher(opts.HTTPRetry, tar.UnlimitedUntarSize, os.Getenv(\"SOURCE_CONTROLLER_LOCALHOST\"))",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "270:  reconciledKustomization, reconcileErr := r.reconcile(ctx, *kustomization.DeepCopy(), source)",
          "274:   msg := fmt.Sprintf(\"Source is not ready, artifact not found, retrying in %s\", r.requeueDependency.String())",
          "275:   log.Info(msg)",
          "276:   if err := r.patchStatus(ctx, req, kustomizev1.KustomizationProgressing(kustomization, msg).Status); err != nil {",
          "",
          "[Removed Lines]",
          "273:  if reconcileErr == ArtifactNotFoundError {",
          "",
          "[Added Lines]",
          "275:  if reconcileErr == fetch.FileNotFoundError {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "332:  defer os.RemoveAll(tmpDir)",
          "336:  if err != nil {",
          "337:   return kustomizev1.KustomizationNotReady(",
          "338:    kustomization,",
          "",
          "[Removed Lines]",
          "335:  err = r.artifactFetcher.Fetch(source.GetArtifact(), tmpDir)",
          "",
          "[Added Lines]",
          "337:  err = r.artifactFetcher.Fetch(source.GetArtifact().URL, source.GetArtifact().Checksum, tmpDir)",
          "",
          "---------------"
        ],
        "controllers/kustomization_decryptor_test.go||controllers/kustomization_decryptor_test.go": [
          "File: controllers/kustomization_decryptor_test.go -> controllers/kustomization_decryptor_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "66:  g.Expect(err).NotTo(HaveOccurred(), \"failed to create kubeconfig secret\")",
          "68:  artifactName := \"sops-\" + randStringRunes(5)",
          "70:  g.Expect(err).ToNot(HaveOccurred())",
          "72:  overlayArtifactName := \"sops-\" + randStringRunes(5)",
          "74:  g.Expect(err).ToNot(HaveOccurred())",
          "76:  repositoryName := types.NamespacedName{",
          "",
          "[Removed Lines]",
          "69:  artifactChecksum, err := createArtifact(testServer, \"testdata/sops\", artifactName)",
          "73:  overlayChecksum, err := createArtifact(testServer, \"testdata/test-dotenv\", overlayArtifactName)",
          "",
          "[Added Lines]",
          "69:  artifactChecksum, err := testServer.ArtifactFromDir(\"testdata/sops\", artifactName)",
          "73:  overlayChecksum, err := testServer.ArtifactFromDir(\"testdata/test-dotenv\", overlayArtifactName)",
          "",
          "---------------"
        ],
        "controllers/kustomization_fetcher.go||controllers/kustomization_fetcher.go": [
          "File: controllers/kustomization_fetcher.go -> controllers/kustomization_fetcher.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "controllers/kustomization_transformer_test.go||controllers/kustomization_transformer_test.go": [
          "File: controllers/kustomization_transformer_test.go -> controllers/kustomization_transformer_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "50:  g.Expect(err).NotTo(HaveOccurred())",
          "52:  artifactFile := \"patch-\" + randStringRunes(5)",
          "54:  g.Expect(err).ToNot(HaveOccurred())",
          "56:  repositoryName := types.NamespacedName{",
          "",
          "[Removed Lines]",
          "53:  artifactChecksum, err := createArtifact(testServer, \"testdata/transformers\", artifactFile)",
          "",
          "[Added Lines]",
          "53:  artifactChecksum, err := testServer.ArtifactFromDir(\"testdata/transformers\", artifactFile)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "173:  g.Expect(err).NotTo(HaveOccurred())",
          "175:  artifactFile := \"patch-\" + randStringRunes(5)",
          "177:  g.Expect(err).ToNot(HaveOccurred())",
          "179:  repositoryName := types.NamespacedName{",
          "",
          "[Removed Lines]",
          "176:  artifactChecksum, err := createArtifact(testServer, \"testdata/file-transformer\", artifactFile)",
          "",
          "[Added Lines]",
          "176:  artifactChecksum, err := testServer.ArtifactFromDir(\"testdata/file-transformer\", artifactFile)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "292:  g.Expect(err).NotTo(HaveOccurred(), \"failed to create kubeconfig secret\")",
          "294:  artifactFile := \"patch-\" + randStringRunes(5)",
          "296:  g.Expect(err).ToNot(HaveOccurred())",
          "298:  repositoryName := types.NamespacedName{",
          "",
          "[Removed Lines]",
          "295:  artifactChecksum, err := createArtifact(testServer, \"testdata/patch\", artifactFile)",
          "",
          "[Added Lines]",
          "295:  artifactChecksum, err := testServer.ArtifactFromDir(\"testdata/patch\", artifactFile)",
          "",
          "---------------"
        ],
        "controllers/kustomization_validation_test.go||controllers/kustomization_validation_test.go": [
          "File: controllers/kustomization_validation_test.go -> controllers/kustomization_validation_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:  g.Expect(err).NotTo(HaveOccurred(), \"failed to create kubeconfig secret\")",
          "45:  artifactName := \"val-\" + randStringRunes(5)",
          "47:  g.Expect(err).ToNot(HaveOccurred())",
          "49:  overlayArtifactName := \"val-\" + randStringRunes(5)",
          "51:  g.Expect(err).ToNot(HaveOccurred())",
          "53:  repositoryName := types.NamespacedName{",
          "",
          "[Removed Lines]",
          "46:  artifactChecksum, err := createArtifact(testServer, \"testdata/invalid/plain\", artifactName)",
          "50:  overlayChecksum, err := createArtifact(testServer, \"testdata/invalid/overlay\", overlayArtifactName)",
          "",
          "[Added Lines]",
          "46:  artifactChecksum, err := testServer.ArtifactFromDir(\"testdata/invalid/plain\", artifactName)",
          "50:  overlayChecksum, err := testServer.ArtifactFromDir(\"testdata/invalid/overlay\", overlayArtifactName)",
          "",
          "---------------"
        ],
        "controllers/suite_test.go||controllers/suite_test.go": [
          "File: controllers/suite_test.go -> controllers/suite_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: package controllers",
          "19: import (",
          "22:  \"context\"",
          "24:  \"crypto/sha256\"",
          "25:  \"fmt\"",
          "27:  \"math/rand\"",
          "28:  \"os\"",
          "29:  \"path/filepath\"",
          "31:  \"testing\"",
          "32:  \"time\"",
          "",
          "[Removed Lines]",
          "20:  \"archive/tar\"",
          "21:  \"compress/gzip\"",
          "23:  \"crypto/sha1\"",
          "26:  \"io\"",
          "30:  \"strings\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "288:  return nil",
          "289: }",
          "380: func createVaultTestInstance() (*dockertest.Pool, *dockertest.Resource, error) {",
          "382:  pool, err := dockertest.NewPool(\"\")",
          "",
          "[Removed Lines]",
          "291: func createArtifact(artifactServer *testserver.ArtifactServer, fixture, path string) (string, error) {",
          "292:  if f, err := os.Stat(fixture); os.IsNotExist(err) || !f.IsDir() {",
          "293:   return \"\", fmt.Errorf(\"invalid fixture path: %s\", fixture)",
          "294:  }",
          "295:  f, err := os.Create(filepath.Join(artifactServer.Root(), path))",
          "296:  if err != nil {",
          "297:   return \"\", err",
          "298:  }",
          "299:  defer func() {",
          "300:   if err != nil {",
          "301:    os.Remove(f.Name())",
          "302:   }",
          "303:  }()",
          "305:  h := sha1.New()",
          "307:  mw := io.MultiWriter(h, f)",
          "308:  gw := gzip.NewWriter(mw)",
          "309:  tw := tar.NewWriter(gw)",
          "311:  if err = filepath.Walk(fixture, func(p string, fi os.FileInfo, err error) error {",
          "312:   if err != nil {",
          "313:    return err",
          "314:   }",
          "317:   if !fi.Mode().IsRegular() {",
          "318:    return nil",
          "319:   }",
          "322:   if strings.HasPrefix(fi.Name(), \".\") {",
          "323:    return nil",
          "324:   }",
          "326:   header, err := tar.FileInfoHeader(fi, p)",
          "327:   if err != nil {",
          "328:    return err",
          "329:   }",
          "333:   relFilePath := p",
          "334:   if filepath.IsAbs(fixture) {",
          "335:    relFilePath, err = filepath.Rel(fixture, p)",
          "336:    if err != nil {",
          "337:     return err",
          "338:    }",
          "339:   }",
          "340:   header.Name = relFilePath",
          "342:   if err := tw.WriteHeader(header); err != nil {",
          "343:    return err",
          "344:   }",
          "346:   f, err := os.Open(p)",
          "347:   if err != nil {",
          "348:    f.Close()",
          "349:    return err",
          "350:   }",
          "351:   if _, err := io.Copy(tw, f); err != nil {",
          "352:    f.Close()",
          "353:    return err",
          "354:   }",
          "355:   return f.Close()",
          "356:  }); err != nil {",
          "357:   return \"\", err",
          "358:  }",
          "360:  if err := tw.Close(); err != nil {",
          "361:   gw.Close()",
          "362:   f.Close()",
          "363:   return \"\", err",
          "364:  }",
          "365:  if err := gw.Close(); err != nil {",
          "366:   f.Close()",
          "367:   return \"\", err",
          "368:  }",
          "369:  if err := f.Close(); err != nil {",
          "370:   return \"\", err",
          "371:  }",
          "373:  if err := os.Chmod(f.Name(), 0644); err != nil {",
          "374:   return \"\", err",
          "375:  }",
          "377:  return fmt.Sprintf(\"%x\", h.Sum(nil)), nil",
          "378: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "24:  github.com/fluxcd/pkg/apis/acl v0.1.0",
          "25:  github.com/fluxcd/pkg/apis/kustomize v0.6.0",
          "26:  github.com/fluxcd/pkg/apis/meta v0.17.0",
          "27:  github.com/fluxcd/pkg/kustomize v0.8.0",
          "28:  github.com/fluxcd/pkg/runtime v0.20.0",
          "29:  github.com/fluxcd/pkg/ssa v0.21.0",
          "32:  github.com/fluxcd/source-controller/api v0.30.0",
          "34:  github.com/hashicorp/vault/api v1.8.0",
          "36:  github.com/ory/dockertest v3.3.5+incompatible",
          "37:  github.com/otiai10/copy v1.7.0",
          "38:  github.com/spf13/pflag v1.0.5",
          "",
          "[Removed Lines]",
          "30:  github.com/fluxcd/pkg/testserver v0.3.0",
          "31:  github.com/fluxcd/pkg/untar v0.2.0",
          "33:  github.com/hashicorp/go-retryablehttp v0.7.1",
          "35:  github.com/onsi/gomega v1.20.2",
          "",
          "[Added Lines]",
          "27:  github.com/fluxcd/pkg/http/fetch v0.1.0",
          "31:  github.com/fluxcd/pkg/tar v0.1.0",
          "32:  github.com/fluxcd/pkg/testserver v0.4.0",
          "35:  github.com/onsi/gomega v1.21.1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "150:  github.com/hashicorp/go-immutable-radix v1.3.1 // indirect",
          "151:  github.com/hashicorp/go-multierror v1.1.1 // indirect",
          "152:  github.com/hashicorp/go-plugin v1.4.3 // indirect",
          "153:  github.com/hashicorp/go-rootcerts v1.0.2 // indirect",
          "154:  github.com/hashicorp/go-secure-stdlib/mlock v0.1.2 // indirect",
          "155:  github.com/hashicorp/go-secure-stdlib/parseutil v0.1.6 // indirect",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "153:  github.com/hashicorp/go-retryablehttp v0.7.1 // indirect",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "290: github.com/fluxcd/pkg/apis/kustomize v0.6.0/go.mod h1:iY0zSpK6eUiPfNt/yR6g0q/wQP+wH+Ax/L7KBOx5x2M=",
          "291: github.com/fluxcd/pkg/apis/meta v0.17.0 h1:Y2dfo1syHZDb9Mexjr2SWdcj1FnxnRXm015hEnhl6wU=",
          "292: github.com/fluxcd/pkg/apis/meta v0.17.0/go.mod h1:GrOVzWXiu22XjLNgLLe2EBYhQPqZetes5SIADb4bmHE=",
          "293: github.com/fluxcd/pkg/kustomize v0.8.0 h1:8AdEvp6y38ISZzoi0H82Si5zkmLXClbeX10W7HevB00=",
          "294: github.com/fluxcd/pkg/kustomize v0.8.0/go.mod h1:zGtCZF6V3hMWcf46SqrQc10fS9yUlKzi2UcFUeabDAE=",
          "295: github.com/fluxcd/pkg/runtime v0.20.0 h1:F9q9wap0BhjQszboUroJrYOB1C831zkQwTAk2tlMIQc=",
          "296: github.com/fluxcd/pkg/runtime v0.20.0/go.mod h1:KVHNQMhccuLTjMDFVCr/SF+4Z554bcMH1LncC4sQf8o=",
          "297: github.com/fluxcd/pkg/ssa v0.21.0 h1:aeoTohPNf5x7jQjHidyLJAOHw3EyHOQoQN3mN2i+4cc=",
          "298: github.com/fluxcd/pkg/ssa v0.21.0/go.mod h1:jumyhUbEMDnduN7anSlKfxl2fEoyeyv+Ta5hWCbxI5Q=",
          "303: github.com/fluxcd/source-controller/api v0.30.0 h1:rPVPpwXcYG2n0DTRcRagfGDiccvCib5S09K5iMjlpRU=",
          "304: github.com/fluxcd/source-controller/api v0.30.0/go.mod h1:UkjAqQ6QAXNNesNQDTArTeiTp+UuhOUIA+JyFhGP/+Q=",
          "305: github.com/form3tech-oss/jwt-go v3.2.2+incompatible/go.mod h1:pbq4aXjuKjdthFRnoDwaVPLA+WlJuPGy+QneDUgJi2k=",
          "",
          "[Removed Lines]",
          "299: github.com/fluxcd/pkg/testserver v0.3.0 h1:oyZW6YWHVZR7FRVNu7lN9F5H808TD2jCzBm8CenFoi0=",
          "300: github.com/fluxcd/pkg/testserver v0.3.0/go.mod h1:gjOKX41okmrGYOa4oOF2fiLedDAfPo1XaG/EzrUUGBI=",
          "301: github.com/fluxcd/pkg/untar v0.2.0 h1:sJXU+FbJcNUb2ffLJNjeR3hwt3X2loVpOMlCUjyFw6E=",
          "302: github.com/fluxcd/pkg/untar v0.2.0/go.mod h1:33AyoWaPpjX/xXpczcfhQh2AkB63TFwiR2YwROtv23E=",
          "",
          "[Added Lines]",
          "293: github.com/fluxcd/pkg/http/fetch v0.1.0 h1:Ig/kZuM0+jHBJnwHn5UUseTKIYD5w8X4bInJyuyOZKI=",
          "294: github.com/fluxcd/pkg/http/fetch v0.1.0/go.mod h1:1CjOSfn7aOeHf2ZRA2+GTKHg442zN6X/fSys3a0KLC0=",
          "301: github.com/fluxcd/pkg/tar v0.1.0 h1:ObyUml8NJtGQtz/cRgexd7HU2mQsTmgjz2dtX4xdnng=",
          "302: github.com/fluxcd/pkg/tar v0.1.0/go.mod h1:w0/TOC7kwBJhnSJn7TCABkc/I7ib1f2Yz6vOsbLBnhw=",
          "303: github.com/fluxcd/pkg/testserver v0.4.0 h1:pDZ3gistqYhwlf3sAjn1Q8NzN4Qe6I1BEmHMHi46lMg=",
          "304: github.com/fluxcd/pkg/testserver v0.4.0/go.mod h1:gjOKX41okmrGYOa4oOF2fiLedDAfPo1XaG/EzrUUGBI=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "676: github.com/onsi/gomega v0.0.0-20170829124025-dcabb60a477c/go.mod h1:C1qb7wdrVGGVU+Z6iS04AVkA3Q65CEZX59MT0QO5uiA=",
          "677: github.com/onsi/gomega v1.7.1/go.mod h1:XdKZgCCFLUoM/7CFJVPcG8C1xQ1AJ0vpAezJrB7JYyY=",
          "678: github.com/onsi/gomega v1.10.1/go.mod h1:iN09h71vgCQne3DLsj+A5owkum+a2tYe+TOCB1ybHNo=",
          "681: github.com/opencontainers/go-digest v1.0.0 h1:apOUWs51W5PlhuyGyz9FCeeBIOUDA/6nW8Oi/yOhh5U=",
          "682: github.com/opencontainers/go-digest v1.0.0/go.mod h1:0JzlMkj0TRzQZfJkVvzbP0HBR3IKzErnv2BNG4W4MAM=",
          "683: github.com/opencontainers/image-spec v1.0.2 h1:9yCKha/T5XdGtO0q9Q9a6T5NUCsTn/DrBg0D7ufOcFM=",
          "",
          "[Removed Lines]",
          "679: github.com/onsi/gomega v1.20.2 h1:8uQq0zMgLEfa0vRrrBgaJF2gyW9Da9BmfGV+OyUzfkY=",
          "680: github.com/onsi/gomega v1.20.2/go.mod h1:iYAIXgPSaDHak0LCMA+AWBpIKBr8WZicMxnE8luStNc=",
          "",
          "[Added Lines]",
          "681: github.com/onsi/gomega v1.21.1 h1:OB/euWYIExnPBohllTicTHmGTrMaqJ67nIu80j0/uEM=",
          "682: github.com/onsi/gomega v1.21.1/go.mod h1:iYAIXgPSaDHak0LCMA+AWBpIKBr8WZicMxnE8luStNc=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "84a88d58787f58e5adbe012d82f622ebdc6f5d22",
      "candidate_info": {
        "commit_hash": "84a88d58787f58e5adbe012d82f622ebdc6f5d22",
        "repo": "fluxcd/kustomize-controller",
        "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/84a88d58787f58e5adbe012d82f622ebdc6f5d22",
        "files": [
          "controllers/kustomization_controller.go",
          "controllers/kustomization_decryptor.go",
          "controllers/kustomization_decryptor_test.go",
          "controllers/testdata/sops/month/kustomization.yaml",
          "controllers/testdata/sops/month/unencrypted-year.env",
          "controllers/testdata/sops/month/year.env",
          "controllers/testdata/test-dotenv/bases/kustomization.yaml",
          "controllers/testdata/test-dotenv/bases/secrets/year2.txt",
          "controllers/testdata/test-dotenv/overlays/kustomization.yaml",
          "controllers/testdata/test-dotenv/overlays/year1.env"
        ],
        "message": "Decrypt dotenv files\n\nSigned-off-by: Somtochi Onyekwere <somtochionyekwere@gmail.com>",
        "before_after_code_files": [
          "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
          "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go",
          "controllers/kustomization_decryptor_test.go||controllers/kustomization_decryptor_test.go",
          "controllers/testdata/sops/month/unencrypted-year.env||controllers/testdata/sops/month/unencrypted-year.env",
          "controllers/testdata/sops/month/year.env||controllers/testdata/sops/month/year.env",
          "controllers/testdata/test-dotenv/overlays/year1.env||controllers/testdata/test-dotenv/overlays/year1.env"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
            "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go"
          ],
          "candidate": [
            "controllers/kustomization_controller.go||controllers/kustomization_controller.go",
            "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go"
          ]
        }
      },
      "candidate_diff": {
        "controllers/kustomization_controller.go||controllers/kustomization_controller.go": [
          "File: controllers/kustomization_controller.go -> controllers/kustomization_controller.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "563:  }",
          "565:  fs := filesys.MakeFsOnDisk()",
          "566:  m, err := buildKustomization(fs, dirPath)",
          "567:  if err != nil {",
          "568:   return nil, fmt.Errorf(\"kustomize build failed: %w\", err)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "567:  if kustomization.Spec.Decryption != nil {",
          "568:   if err = dec.decryptDotEnvFiles(dirPath); err != nil {",
          "569:    return nil, fmt.Errorf(\"error decrypting .env file: %w\", err)",
          "570:   }",
          "571:  }",
          "",
          "---------------"
        ],
        "controllers/kustomization_decryptor.go||controllers/kustomization_decryptor.go": [
          "File: controllers/kustomization_decryptor.go -> controllers/kustomization_decryptor.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "35:  corev1 \"k8s.io/api/core/v1\"",
          "36:  \"k8s.io/apimachinery/pkg/types\"",
          "37:  \"sigs.k8s.io/controller-runtime/pkg/client\"",
          "38:  \"sigs.k8s.io/kustomize/api/resource\"",
          "39:  \"sigs.k8s.io/yaml\"",
          "41:  kustomizev1 \"github.com/fluxcd/kustomize-controller/api/v1beta2\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38:  \"sigs.k8s.io/kustomize/api/konfig\"",
          "40:  kustypes \"sigs.k8s.io/kustomize/api/types\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "77:  }",
          "79:  if kd.kustomization.Spec.Decryption != nil && kd.kustomization.Spec.Decryption.Provider == DecryptionProviderSOPS {",
          "81:   if bytes.Contains(out, []byte(\"sops:\")) && bytes.Contains(out, []byte(\"mac: ENC[\")) {",
          "107:    if err != nil {",
          "109:    }",
          "111:    jsonData, err := yaml.YAMLToJSON(data)",
          "",
          "[Removed Lines]",
          "82:    store := common.StoreForFormat(formats.Yaml)",
          "84:    tree, err := store.LoadEncryptedFile(out)",
          "85:    if err != nil {",
          "86:     return nil, fmt.Errorf(\"LoadEncryptedFile: %w\", err)",
          "87:    }",
          "89:    key, err := tree.Metadata.GetDataKeyWithKeyServices(",
          "90:     []keyservice.KeyServiceClient{",
          "91:      intkeyservice.NewLocalClient(intkeyservice.NewServer(false, kd.homeDir, kd.ageIdentities)),",
          "92:     },",
          "93:    )",
          "94:    if err != nil {",
          "95:     if userErr, ok := err.(sops.UserError); ok {",
          "96:      err = fmt.Errorf(userErr.UserError())",
          "97:     }",
          "98:     return nil, fmt.Errorf(\"GetDataKey: %w\", err)",
          "99:    }",
          "101:    cipher := aes.NewCipher()",
          "102:    if _, err := tree.Decrypt(key, cipher); err != nil {",
          "103:     return nil, fmt.Errorf(\"AES decrypt: %w\", err)",
          "104:    }",
          "106:    data, err := store.EmitPlainFile(tree.Branches)",
          "108:     return nil, fmt.Errorf(\"EmitPlainFile: %w\", err)",
          "",
          "[Added Lines]",
          "83:    data, err := kd.DataWithFormat(out, formats.Yaml, formats.Yaml)",
          "85:     return nil, fmt.Errorf(\"DataWithFormat: %w\", err)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "131:     }",
          "133:     if bytes.Contains(data, []byte(\"sops\")) && bytes.Contains(data, []byte(\"ENC[\")) {",
          "163:      if err != nil {",
          "165:      }",
          "167:      dataMap[key] = base64.StdEncoding.EncodeToString(out)",
          "",
          "[Removed Lines]",
          "135:      store := common.StoreForFormat(formats.Yaml)",
          "137:      tree, err := store.LoadEncryptedFile(data)",
          "138:      if err != nil {",
          "139:       return nil, fmt.Errorf(\"LoadEncryptedFile: %w\", err)",
          "140:      }",
          "142:      metadataKey, err := tree.Metadata.GetDataKeyWithKeyServices(",
          "143:       []keyservice.KeyServiceClient{",
          "144:        intkeyservice.NewLocalClient(intkeyservice.NewServer(false, kd.homeDir, kd.ageIdentities)),",
          "145:       },",
          "146:      )",
          "148:      if err != nil {",
          "149:       if userErr, ok := err.(sops.UserError); ok {",
          "150:        err = fmt.Errorf(userErr.UserError())",
          "151:       }",
          "152:       return nil, fmt.Errorf(\"GetDataKey: %w\", err)",
          "153:      }",
          "155:      cipher := aes.NewCipher()",
          "156:      if _, err := tree.Decrypt(metadataKey, cipher); err != nil {",
          "157:       return nil, fmt.Errorf(\"AES decrypt: %w\", err)",
          "158:      }",
          "160:      outputStore := common.DefaultStoreForPath(key)",
          "162:      out, err := outputStore.EmitPlainFile(tree.Branches)",
          "164:       return nil, fmt.Errorf(\"EmitPlainFile: %w\", err)",
          "",
          "[Added Lines]",
          "111:      outputFormat := formats.FormatForPath(key)",
          "112:      out, err := kd.DataWithFormat(data, formats.Yaml, outputFormat)",
          "114:       return nil, fmt.Errorf(\"DataWithFormat: %w\", err)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "231:  }",
          "232:  return nil",
          "233: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "185: func (kd *KustomizeDecryptor) decryptDotEnvFiles(dirpath string) error {",
          "186:  kustomizePath := filepath.Join(dirpath, konfig.DefaultKustomizationFileName())",
          "187:  ksData, err := ioutil.ReadFile(kustomizePath)",
          "188:  if err != nil {",
          "189:   return nil",
          "190:  }",
          "192:  kus := kustypes.Kustomization{",
          "193:   TypeMeta: kustypes.TypeMeta{",
          "194:    APIVersion: kustypes.KustomizationVersion,",
          "195:    Kind:       kustypes.KustomizationKind,",
          "196:   },",
          "197:  }",
          "199:  if err := yaml.Unmarshal(ksData, &kus); err != nil {",
          "200:   return err",
          "201:  }",
          "204:  for _, rsrc := range kus.Resources {",
          "205:   rsrcPath := filepath.Join(dirpath, rsrc)",
          "206:   isDir, err := isDir(rsrcPath)",
          "207:   if err == nil && isDir {",
          "208:    err := kd.decryptDotEnvFiles(rsrcPath)",
          "209:    if err != nil {",
          "210:     return fmt.Errorf(\"error decrypting .env files in dir '%s': %w\",",
          "211:      rsrcPath, err)",
          "212:    }",
          "213:   }",
          "214:  }",
          "216:  secretGens := kus.SecretGenerator",
          "217:  for _, gen := range secretGens {",
          "218:   for _, envFile := range gen.EnvSources {",
          "219:    filepath := filepath.Join(dirpath, envFile)",
          "220:    data, err := ioutil.ReadFile(filepath)",
          "221:    if err != nil {",
          "222:     return err",
          "223:    }",
          "225:    if bytes.Contains(data, []byte(\"sops_mac=ENC[\")) {",
          "226:     out, err := kd.DataWithFormat(data, formats.Dotenv, formats.Dotenv)",
          "227:     if err != nil {",
          "228:      return nil",
          "229:     }",
          "231:     err = ioutil.WriteFile(filepath, out, 0644)",
          "232:     if err != nil {",
          "233:      return fmt.Errorf(\"error writing to file: %w\", err)",
          "234:     }",
          "235:    }",
          "236:   }",
          "237:  }",
          "239:  return nil",
          "240: }",
          "242: func (kd KustomizeDecryptor) DataWithFormat(data []byte, inputFormat, outputFormat formats.Format) ([]byte, error) {",
          "243:  store := common.StoreForFormat(inputFormat)",
          "245:  tree, err := store.LoadEncryptedFile(data)",
          "246:  if err != nil {",
          "247:   return nil, fmt.Errorf(\"LoadEncryptedFile: %w\", err)",
          "248:  }",
          "250:  metadataKey, err := tree.Metadata.GetDataKeyWithKeyServices(",
          "251:   []keyservice.KeyServiceClient{",
          "252:    intkeyservice.NewLocalClient(intkeyservice.NewServer(false, kd.homeDir, kd.ageIdentities)),",
          "253:   },",
          "254:  )",
          "255:  if err != nil {",
          "256:   if userErr, ok := err.(sops.UserError); ok {",
          "257:    err = fmt.Errorf(userErr.UserError())",
          "258:   }",
          "259:   return nil, fmt.Errorf(\"GetDataKey: %w\", err)",
          "260:  }",
          "262:  cipher := aes.NewCipher()",
          "263:  if _, err := tree.Decrypt(metadataKey, cipher); err != nil {",
          "264:   return nil, fmt.Errorf(\"AES decrypt: %w\", err)",
          "265:  }",
          "267:  outputStore := common.StoreForFormat(outputFormat)",
          "269:  out, err := outputStore.EmitPlainFile(tree.Branches)",
          "270:  if err != nil {",
          "271:   return nil, fmt.Errorf(\"EmitPlainFile: %w\", err)",
          "272:  }",
          "274:  return out, err",
          "275: }",
          "277: func isDir(path string) (bool, error) {",
          "278:  fileInfo, err := os.Stat(path)",
          "279:  if err != nil {",
          "280:   return false, err",
          "281:  }",
          "283:  return fileInfo.IsDir(), nil",
          "284: }",
          "",
          "---------------"
        ],
        "controllers/kustomization_decryptor_test.go||controllers/kustomization_decryptor_test.go": [
          "File: controllers/kustomization_decryptor_test.go -> controllers/kustomization_decryptor_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  artifactURL, err := testServer.URLForFile(artifactFile)",
          "50:  g.Expect(err).ToNot(HaveOccurred())",
          "52:  repositoryName := types.NamespacedName{",
          "53:   Name:      fmt.Sprintf(\"sops-%s\", randStringRunes(5)),",
          "54:   Namespace: id,",
          "55:  }",
          "57:  err = applyGitRepository(repositoryName, artifactURL, \"main/\"+artifactChecksum, artifactChecksum)",
          "58:  g.Expect(err).NotTo(HaveOccurred())",
          "60:  pgpKey, err := ioutil.ReadFile(\"testdata/sops/pgp.asc\")",
          "61:  g.Expect(err).ToNot(HaveOccurred())",
          "62:  ageKey, err := ioutil.ReadFile(\"testdata/sops/age.txt\")",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:  overlayArtifactFile := \"sops-\" + randStringRunes(5)",
          "53:  overlayChecksum, err := createArtifact(testServer, \"testdata/test-dotenv\", overlayArtifactFile)",
          "54:  g.Expect(err).ToNot(HaveOccurred())",
          "55:  overlayArtifactUrl, err := testServer.URLForFile(overlayArtifactFile)",
          "56:  g.Expect(err).ToNot(HaveOccurred())",
          "63:  overlayRepositoryName := types.NamespacedName{",
          "64:   Name:      fmt.Sprintf(\"sops-%s\", randStringRunes(5)),",
          "65:   Namespace: id,",
          "66:  }",
          "71:  err = applyGitRepository(overlayRepositoryName, overlayArtifactUrl, \"main/\"+overlayChecksum, overlayChecksum)",
          "72:  g.Expect(err).NotTo(HaveOccurred())",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "111:    TargetNamespace: id,",
          "112:   },",
          "113:  }",
          "115:  g.Expect(k8sClient.Create(context.TODO(), kustomization)).To(Succeed())",
          "117:  g.Eventually(func() bool {",
          "118:   var obj kustomizev1.Kustomization",
          "119:   _ = k8sClient.Get(context.Background(), client.ObjectKeyFromObject(kustomization), &obj)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "130:  overlayKustomizationName := fmt.Sprintf(\"sops-%s\", randStringRunes(5))",
          "131:  overlayKs := kustomization.DeepCopy()",
          "132:  overlayKs.ResourceVersion = \"\"",
          "133:  overlayKs.Name = overlayKustomizationName",
          "134:  overlayKs.Spec.SourceRef.Name = overlayRepositoryName.Name",
          "135:  overlayKs.Spec.SourceRef.Namespace = overlayRepositoryName.Namespace",
          "136:  overlayKs.Spec.Path = \"./testdata/test-dotenv/overlays\"",
          "138:  g.Expect(k8sClient.Create(context.TODO(), overlayKs)).To(Succeed())",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "133:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"sops-day\", Namespace: id}, &daySecret)).To(Succeed())",
          "134:   g.Expect(string(daySecret.Data[\"secret\"])).To(Equal(\"day=Tuesday\\n\"))",
          "136:   var encodedSecret corev1.Secret",
          "137:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"sops-month\", Namespace: id}, &encodedSecret)).To(Succeed())",
          "138:   g.Expect(string(encodedSecret.Data[\"month.yaml\"])).To(Equal(\"month: May\\n\"))",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "159:   var yearSecret corev1.Secret",
          "160:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"sops-year\", Namespace: id}, &yearSecret)).To(Succeed())",
          "161:   g.Expect(string(yearSecret.Data[\"year\"])).To(Equal(\"2017\"))",
          "163:   var unencryptedSecret corev1.Secret",
          "164:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"unencrypted-sops-year\", Namespace: id}, &unencryptedSecret)).To(Succeed())",
          "165:   g.Expect(string(unencryptedSecret.Data[\"year\"])).To(Equal(\"2021\"))",
          "167:   var year1Secret corev1.Secret",
          "168:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"sops-year1\", Namespace: id}, &year1Secret)).To(Succeed())",
          "169:   g.Expect(string(year1Secret.Data[\"year\"])).To(Equal(\"year1\"))",
          "171:   var year2Secret corev1.Secret",
          "172:   g.Expect(k8sClient.Get(context.TODO(), types.NamespacedName{Name: \"sops-year2\", Namespace: id}, &year2Secret)).To(Succeed())",
          "173:   g.Expect(string(year2Secret.Data[\"year\"])).To(Equal(\"year2\"))",
          "",
          "---------------"
        ],
        "controllers/testdata/sops/month/unencrypted-year.env||controllers/testdata/sops/month/unencrypted-year.env": [
          "File: controllers/testdata/sops/month/unencrypted-year.env -> controllers/testdata/sops/month/unencrypted-year.env",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: year=2021",
          "",
          "---------------"
        ],
        "controllers/testdata/sops/month/year.env||controllers/testdata/sops/month/year.env": [
          "File: controllers/testdata/sops/month/year.env -> controllers/testdata/sops/month/year.env",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: year=ENC[AES256_GCM,data:EfNnlA==,iv:pBaHDmjQ1d6JrA0Rk19giCQon7CP37hZ0dEQTkJEw1U=,tag:J29CEN9S6pSie8tsAD2REA==,type:str]",
          "2: sops_age__list_0__map_enc=-----BEGIN AGE ENCRYPTED FILE-----\\nYWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB3NHYyMHdNcXhMS2x6aXJq\\nTHVhbUYrcW8waFduN1NoWUIyTWFuMmNEVGpzCjUxb05zUndSdnpiQng2VnZ2SkNF\\nbnlzY0VmaVd1Z0xZR2FKdDRPQlhKSE0KLS0tIDlEaGgwT3VHcUg5QzFpenZNOTBk\\nbUZ5QkRnY0kwMFpYanFLYTlvc0FXdXMKb32CnEO8yg91kkUMFXhBL5Sfz32dNOJT\\ntNGdKcOGVBzOJVgU1RquB+5OcJdbuwdV7GCq8KvXqh5fypTI00hZeg==\\n-----END AGE ENCRYPTED FILE-----\\n",
          "3: sops_age__list_0__map_recipient=age1l44xcng8dqj32nlv6d930qvvrny05hglzcv9qpc7kxjc6902ma4qufys29",
          "4: sops_lastmodified=2021-10-14T15:35:45Z",
          "5: sops_mac=ENC[AES256_GCM,data:brSfy5j0wETn6YT7p8qoCSuI6bevGwrxBbtcqBSYRJ+GgLAr9a7rtwHK8/BnKCi1C1H/zGa1gEERqz2j6Zw0uS4V5lejvtDtfRn9DwYWQ2Aqo2zi4crfNhljerwQVa/Hy9pq2falIZyyhoDX30WOoLe+2eZWQXLtFlVkx4x7U1s=,iv:wr4szytKCN9j6dqccZZl0bkDUHsOtFSvDXjdpuZwTbA=,tag:N1uQ25uLS+E6yQPzXJRiNw==,type:str]",
          "6: sops_version=3.7.1",
          "7: sops_unencrypted_suffix=_unencrypted",
          "",
          "---------------"
        ],
        "controllers/testdata/test-dotenv/overlays/year1.env||controllers/testdata/test-dotenv/overlays/year1.env": [
          "File: controllers/testdata/test-dotenv/overlays/year1.env -> controllers/testdata/test-dotenv/overlays/year1.env",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: year=ENC[AES256_GCM,data:tV/GLTE=,iv:AtEKKSUa4BiTnDzGMtpGrO78NuR0wMXzjKrQScbtX24=,tag:zAzcBzQ6ORO+NhcY3idHcA==,type:str]",
          "2: sops_lastmodified=2021-10-15T11:08:51Z",
          "3: sops_unencrypted_suffix=_unencrypted",
          "4: sops_age__list_0__map_enc=-----BEGIN AGE ENCRYPTED FILE-----\\nYWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBFU29oWEh2ckRjaCs3d1FJ\\nYTkxN0dqY1lsc1dEUmZ4OGN0N1BHK0xxQld3CmpTL2Z2VDloQStCYnRmYnJ0SDFj\\nVU9USmszbU44YUxzRi95Q0sxY2t0bkUKLS0tIC80Ulh1RWJPeUFqbUFNSjFOeGIy\\nY001MzMwbnRsQXlsN1VVY2xLY20yazQKYhZQGZpay9J1cnGiHCKBY6DtYMCSIBo7\\nAP41GiVukT6M4LT83TpWzWgbR/xNgreKdNpweYcw+Fp+wJHVeR3+fg==\\n-----END AGE ENCRYPTED FILE-----\\n",
          "5: sops_mac=ENC[AES256_GCM,data:rw8vAq+8nqa5/V8p/ICuVKXNQCeTIFExF33qy1YEbc8f4kePDhTlGqxluEytbWOhk+hzCd4POk+zY8bWBY2QSiq0lle2rCtE2WT3I04/+bHzX74yMBuadYLqiUFEhkra/58FXD404PPJBUrOy8mAPgWVczcqMexYhzz//tPdGMY=,iv:yk3CsyGigCSHonvMBTQvjg+kgNssf87KqlKeR6FE8sk=,tag:dCaOhh97ebJWNT5v35n6Iw==,type:str]",
          "6: sops_version=3.7.1",
          "7: sops_age__list_0__map_recipient=age1l44xcng8dqj32nlv6d930qvvrny05hglzcv9qpc7kxjc6902ma4qufys29",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0c8a51b41b8d495242c1ed5da8b77244cd037009",
      "candidate_info": {
        "commit_hash": "0c8a51b41b8d495242c1ed5da8b77244cd037009",
        "repo": "fluxcd/kustomize-controller",
        "commit_url": "https://github.com/fluxcd/kustomize-controller/commit/0c8a51b41b8d495242c1ed5da8b77244cd037009",
        "files": [
          "api/go.mod",
          "api/go.sum",
          "config/default/kustomization.yaml",
          "go.mod",
          "go.sum"
        ],
        "message": "Update source-controller/api to v0.34.0\n\nSigned-off-by: Stefan Prodan <stefan.prodan@gmail.com>",
        "before_after_code_files": [
          "api/go.mod||api/go.mod",
          "api/go.sum||api/go.sum",
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "api/go.mod||api/go.mod": [
          "File: api/go.mod -> api/go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:  github.com/fluxcd/pkg/apis/meta v0.19.0",
          "8:  k8s.io/apiextensions-apiserver v0.26.1",
          "9:  k8s.io/apimachinery v0.26.1",
          "11: )",
          "",
          "[Removed Lines]",
          "10:  sigs.k8s.io/controller-runtime v0.14.1",
          "",
          "[Added Lines]",
          "10:  sigs.k8s.io/controller-runtime v0.14.2",
          "",
          "---------------"
        ],
        "api/go.sum||api/go.sum": [
          "File: api/go.sum -> api/go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "96: k8s.io/klog/v2 v2.80.1/go.mod h1:y1WjHnz7Dj687irZUWR/WLkLc5N1YHtjLdmgWjndZn0=",
          "97: k8s.io/utils v0.0.0-20221128185143-99ec85e7a448 h1:KTgPnR10d5zhztWptI952TNtt/4u5h3IzDXkdIMuo2Y=",
          "98: k8s.io/utils v0.0.0-20221128185143-99ec85e7a448/go.mod h1:OLgZIPagt7ERELqWJFomSt595RzquPNLL48iOWgYOg0=",
          "101: sigs.k8s.io/json v0.0.0-20221116044647-bc3834ca7abd h1:EDPBXCAspyGV4jQlpZSudPeMmr1bNJefnuqLsRAsHZo=",
          "102: sigs.k8s.io/json v0.0.0-20221116044647-bc3834ca7abd/go.mod h1:B8JuhiUyNFVKdsE8h686QcCxMaH6HrOAZj4vswFpcB0=",
          "103: sigs.k8s.io/structured-merge-diff/v4 v4.2.3 h1:PRbqxJClWWYMNV1dhaG4NsibJbArud9kFxnAMREiWFE=",
          "",
          "[Removed Lines]",
          "99: sigs.k8s.io/controller-runtime v0.14.1 h1:vThDes9pzg0Y+UbCPY3Wj34CGIYPgdmspPm2GIpxpzM=",
          "100: sigs.k8s.io/controller-runtime v0.14.1/go.mod h1:GaRkrY8a7UZF0kqFFbUKG7n9ICiTY5T55P1RiE3UZlU=",
          "",
          "[Added Lines]",
          "99: sigs.k8s.io/controller-runtime v0.14.2 h1:P6IwDhbsRWsBClt/8/h8Zy36bCuGuW5Op7MHpFrN/60=",
          "100: sigs.k8s.io/controller-runtime v0.14.2/go.mod h1:WqIdsAY6JBsjfc/CqO0CORmNtoCtE4S6qbPc9s68h+0=",
          "",
          "---------------"
        ],
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:  github.com/Azure/azure-sdk-for-go/sdk/azcore v1.3.0",
          "12:  github.com/Azure/azure-sdk-for-go/sdk/azidentity v1.2.1",
          "13:  github.com/Azure/azure-sdk-for-go/sdk/keyvault/azkeys v0.9.0",
          "15:  github.com/aws/aws-sdk-go-v2 v1.17.3",
          "16:  github.com/aws/aws-sdk-go-v2/config v1.18.10",
          "17:  github.com/aws/aws-sdk-go-v2/credentials v1.13.10",
          "",
          "[Removed Lines]",
          "14:  github.com/aws/aws-sdk-go v1.44.188",
          "",
          "[Added Lines]",
          "14:  github.com/aws/aws-sdk-go v1.44.191",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "30:  github.com/fluxcd/pkg/ssa v0.23.0",
          "31:  github.com/fluxcd/pkg/tar v0.2.0",
          "32:  github.com/fluxcd/pkg/testserver v0.4.0",
          "34:  github.com/hashicorp/vault/api v1.8.3",
          "35:  github.com/onsi/gomega v1.26.0",
          "36:  github.com/ory/dockertest/v3 v3.9.1",
          "37:  github.com/spf13/pflag v1.0.5",
          "38:  go.mozilla.org/sops/v3 v3.7.3",
          "39:  golang.org/x/net v0.5.0",
          "42:  google.golang.org/grpc v1.52.3",
          "43:  google.golang.org/protobuf v1.28.1",
          "44:  k8s.io/api v0.26.1",
          "",
          "[Removed Lines]",
          "33:  github.com/fluxcd/source-controller/api v0.33.0",
          "40:  google.golang.org/api v0.108.0",
          "41:  google.golang.org/genproto v0.0.0-20230125152338-dcaf20b6aeaa",
          "",
          "[Added Lines]",
          "33:  github.com/fluxcd/source-controller/api v0.34.0",
          "40:  google.golang.org/api v0.109.0",
          "41:  google.golang.org/genproto v0.0.0-20230131230820-1c016267d619",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "46:  k8s.io/apimachinery v0.26.1",
          "47:  k8s.io/client-go v0.26.1",
          "48:  sigs.k8s.io/cli-utils v0.34.0",
          "50:  sigs.k8s.io/kustomize/api v0.12.1",
          "51:  sigs.k8s.io/yaml v1.3.0",
          "52: )",
          "",
          "[Removed Lines]",
          "49:  sigs.k8s.io/controller-runtime v0.14.1",
          "",
          "[Added Lines]",
          "49:  sigs.k8s.io/controller-runtime v0.14.2",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "110: github.com/armon/go-radix v1.0.0 h1:F4z6KzEeeQIMeLFa97iZU6vupzoecKdU5TX24SNppXI=",
          "111: github.com/armon/go-radix v1.0.0/go.mod h1:ufUuZ+zHj4x4TnLV4JWEpy2hxWSpsRywHrMgIH9cCH8=",
          "112: github.com/armon/go-socks5 v0.0.0-20160902184237-e75332964ef5 h1:0CwZNZbxp69SHPdPJAN/hZIm0C4OItdklCFmMRWYpio=",
          "115: github.com/aws/aws-sdk-go-v2 v1.17.3 h1:shN7NlnVzvDUgPQ+1rLMSxY8OWRNDRYtiqe0p/PgrhY=",
          "116: github.com/aws/aws-sdk-go-v2 v1.17.3/go.mod h1:uzbQtefpm44goOPmdKyAlXSNcwlRgF3ePWVW6EtJvvw=",
          "117: github.com/aws/aws-sdk-go-v2/config v1.18.10 h1:Znce11DWswdh+5kOsIp+QaNfY9igp1QUN+fZHCKmeCI=",
          "",
          "[Removed Lines]",
          "113: github.com/aws/aws-sdk-go v1.44.188 h1:NCN6wFDWKU72Ka+f7cCk3HRj1KxkEXhRdr7lO8oBRRQ=",
          "114: github.com/aws/aws-sdk-go v1.44.188/go.mod h1:aVsgQcEevwlmQ7qHE9I3h+dtQgpqhFB+i8Phjh7fkwI=",
          "",
          "[Added Lines]",
          "113: github.com/aws/aws-sdk-go v1.44.191 h1:GnbkalCx/AgobaorDMFCa248acmk+91+aHBQOk7ljzU=",
          "114: github.com/aws/aws-sdk-go v1.44.191/go.mod h1:aVsgQcEevwlmQ7qHE9I3h+dtQgpqhFB+i8Phjh7fkwI=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "238: github.com/fluxcd/pkg/tar v0.2.0/go.mod h1:w0/TOC7kwBJhnSJn7TCABkc/I7ib1f2Yz6vOsbLBnhw=",
          "239: github.com/fluxcd/pkg/testserver v0.4.0 h1:pDZ3gistqYhwlf3sAjn1Q8NzN4Qe6I1BEmHMHi46lMg=",
          "240: github.com/fluxcd/pkg/testserver v0.4.0/go.mod h1:gjOKX41okmrGYOa4oOF2fiLedDAfPo1XaG/EzrUUGBI=",
          "243: github.com/frankban/quicktest v1.11.3/go.mod h1:wRf/ReqHper53s+kmmSZizM8NamnL3IM0I9ntUbOk+k=",
          "244: github.com/frankban/quicktest v1.13.0 h1:yNZif1OkDfNoDfb9zZa9aXIpejNR4F23Wely0c+Qdqk=",
          "245: github.com/fsnotify/fsnotify v1.6.0 h1:n+5WquG0fcWoWp6xPWfHdbskMCQaFnG6PfBrh1Ky4HY=",
          "",
          "[Removed Lines]",
          "241: github.com/fluxcd/source-controller/api v0.33.0 h1:NZYU3+MNf9puyrTbBa7AJbBDlN7tmt0uw8lyye++5fE=",
          "242: github.com/fluxcd/source-controller/api v0.33.0/go.mod h1:+DiGND4WSNdGkS7loPUroSarif6dHU4VlVgtLMRKCR8=",
          "",
          "[Added Lines]",
          "241: github.com/fluxcd/source-controller/api v0.34.0 h1:M2kD95IdpmHcDNy78K6T6p7niC38LGwSrKq8XAZEJY0=",
          "242: github.com/fluxcd/source-controller/api v0.34.0/go.mod h1:w3PDdR+FZyq3zyyUDxz6vY3CKByZfYAjkzJUxuUXCuc=",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "885: google.golang.org/api v0.28.0/go.mod h1:lIXQywCXRcnZPGlsd8NbLnOjtAoL6em04bJ9+z0MncE=",
          "886: google.golang.org/api v0.29.0/go.mod h1:Lcubydp8VUV7KeIHD9z2Bys/sm/vGKnG1UHuDBSrHWM=",
          "887: google.golang.org/api v0.30.0/go.mod h1:QGmEvQ87FHZNiUVJkT14jQNYJ4ZJjdRF23ZXz5138Fc=",
          "890: google.golang.org/appengine v1.1.0/go.mod h1:EbEs0AVv82hx2wNQdGPgUI5lhzA/G0D9YwlJXL52JkM=",
          "891: google.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=",
          "892: google.golang.org/appengine v1.5.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=",
          "",
          "[Removed Lines]",
          "888: google.golang.org/api v0.108.0 h1:WVBc/faN0DkKtR43Q/7+tPny9ZoLZdIiAyG5Q9vFClg=",
          "889: google.golang.org/api v0.108.0/go.mod h1:2Ts0XTHNVWxypznxWOYUeI4g3WdP9Pk2Qk58+a/O9MY=",
          "",
          "[Added Lines]",
          "888: google.golang.org/api v0.109.0 h1:sW9hgHyX497PP5//NUM7nqfV8D0iDfBApqq7sOh1XR8=",
          "889: google.golang.org/api v0.109.0/go.mod h1:2Ts0XTHNVWxypznxWOYUeI4g3WdP9Pk2Qk58+a/O9MY=",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "926: google.golang.org/genproto v0.0.0-20200804131852-c06518451d9c/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=",
          "927: google.golang.org/genproto v0.0.0-20200825200019-8632dd797987/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=",
          "928: google.golang.org/genproto v0.0.0-20220107163113-42d7afdf6368/go.mod h1:5CzLGKJ67TSI2B9POpiiyGha0AjJvZIUgRMt1dSmuhc=",
          "931: google.golang.org/grpc v1.19.0/go.mod h1:mqu4LbDTu4XGKhr4mRzUsmM4RtVoemTSY81AxZiDr8c=",
          "932: google.golang.org/grpc v1.20.1/go.mod h1:10oTOabMzJvdu6/UiuZezV6QK5dSlG84ov/aaiqXj38=",
          "933: google.golang.org/grpc v1.21.1/go.mod h1:oYelfM1adQP15Ek0mdvEgi9Df8B9CZIaU1084ijfRaM=",
          "",
          "[Removed Lines]",
          "929: google.golang.org/genproto v0.0.0-20230125152338-dcaf20b6aeaa h1:qQPhfbPO23fwm/9lQr91L1u62Zo6cm+zI+slZT+uf+o=",
          "930: google.golang.org/genproto v0.0.0-20230125152338-dcaf20b6aeaa/go.mod h1:RGgjbofJ8xD9Sq1VVhDM1Vok1vRONV+rg+CjzG4SZKM=",
          "",
          "[Added Lines]",
          "929: google.golang.org/genproto v0.0.0-20230131230820-1c016267d619 h1:p0kMzw6AG0JEzd7Z+kXqOiLhC6gjUQTbtS2zR0Q3DbI=",
          "930: google.golang.org/genproto v0.0.0-20230131230820-1c016267d619/go.mod h1:RGgjbofJ8xD9Sq1VVhDM1Vok1vRONV+rg+CjzG4SZKM=",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1020: rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA=",
          "1021: sigs.k8s.io/cli-utils v0.34.0 h1:zCUitt54f0/MYj/ajVFnG6XSXMhpZ72O/3RewIchW8w=",
          "1022: sigs.k8s.io/cli-utils v0.34.0/go.mod h1:EXyMwPMu9OL+LRnj0JEMsGG/fRvbgFadcVlSnE8RhFs=",
          "1025: sigs.k8s.io/json v0.0.0-20221116044647-bc3834ca7abd h1:EDPBXCAspyGV4jQlpZSudPeMmr1bNJefnuqLsRAsHZo=",
          "1026: sigs.k8s.io/json v0.0.0-20221116044647-bc3834ca7abd/go.mod h1:B8JuhiUyNFVKdsE8h686QcCxMaH6HrOAZj4vswFpcB0=",
          "1027: sigs.k8s.io/kustomize/api v0.12.1 h1:7YM7gW3kYBwtKvoY216ZzY+8hM+lV53LUayghNRJ0vM=",
          "",
          "[Removed Lines]",
          "1023: sigs.k8s.io/controller-runtime v0.14.1 h1:vThDes9pzg0Y+UbCPY3Wj34CGIYPgdmspPm2GIpxpzM=",
          "1024: sigs.k8s.io/controller-runtime v0.14.1/go.mod h1:GaRkrY8a7UZF0kqFFbUKG7n9ICiTY5T55P1RiE3UZlU=",
          "",
          "[Added Lines]",
          "1023: sigs.k8s.io/controller-runtime v0.14.2 h1:P6IwDhbsRWsBClt/8/h8Zy36bCuGuW5Op7MHpFrN/60=",
          "1024: sigs.k8s.io/controller-runtime v0.14.2/go.mod h1:WqIdsAY6JBsjfc/CqO0CORmNtoCtE4S6qbPc9s68h+0=",
          "",
          "---------------"
        ]
      }
    }
  ]
}