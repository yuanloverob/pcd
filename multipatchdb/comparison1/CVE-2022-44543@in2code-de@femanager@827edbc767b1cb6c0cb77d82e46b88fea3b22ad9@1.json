{
  "cve_id": "CVE-2022-44543",
  "cve_desc": "The femanager extension before 5.5.2, 6.x before 6.3.3, and 7.x before 7.0.1 for TYPO3 allows creation of frontend users in restricted groups (if there is a usergroup field on the registration form). This occurs because the usergroup.inList protection mechanism is mishandled.",
  "repo": "in2code-de/femanager",
  "patch_hash": "827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
  "patch_info": {
    "commit_hash": "827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
    "repo": "in2code-de/femanager",
    "commit_url": "https://github.com/in2code-de/femanager/commit/827edbc767b1cb6c0cb77d82e46b88fea3b22ad9",
    "files": [
      "Classes/Domain/Validator/AbstractValidator.php",
      "Classes/Domain/Validator/ServersideValidator.php",
      "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
    ],
    "message": "[BUGFIX] Broken Access Control in Usergroup Validation\n\nhttps://projekte.in2code.de/issues/53603",
    "before_after_code_files": [
      "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
      "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
      "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
    ]
  },
  "patch_diff": {
    "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
      "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "365:     protected function validateInList($value, $validationSettingList)",
      "366:     {",
      "367:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
      "369:     }",
      "",
      "[Removed Lines]",
      "368:         return in_array($value, $validationSettings);",
      "",
      "[Added Lines]",
      "367:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
      "369:         $diff = array_diff($valueList, $validationSettings);",
      "371:         return empty($diff);",
      "",
      "---------------"
    ],
    "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php": [
      "File: Classes/Domain/Validator/ServersideValidator.php -> Classes/Domain/Validator/ServersideValidator.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "7: use In2code\\Femanager\\Domain\\Model\\User;",
      "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
      "9: use TYPO3\\CMS\\Extbase\\Domain\\Model\\FileReference;",
      "10: use TYPO3\\CMS\\Extbase\\Reflection\\ObjectAccess;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "10: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "306:     protected function getValue($user, $fieldName)",
      "307:     {",
      "308:         $value = $this->getValueFromProperty($user, $fieldName);",
      "309:         if (is_object($value)) {",
      "310:             if (method_exists($value, 'getUid')) {",
      "311:                 $value = $value->getUid();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "311:         if ($value instanceof ObjectStorage) {",
      "312:             $values = [];",
      "314:             foreach ($value as $object) {",
      "315:                 if (method_exists($object, 'getUid')) {",
      "316:                     $values[] = $object->getUid();",
      "317:                 }",
      "318:             }",
      "320:             return implode(',', $values);",
      "321:         }",
      "",
      "---------------"
    ],
    "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
      "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "732:                 'a',",
      "733:                 true",
      "734:             ],",
      "735:             [",
      "736:                 '23',",
      "737:                 '1,234,3',",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "735:             [",
      "736:                 '1,2',",
      "737:                 '1,2,3',",
      "738:                 true",
      "739:             ],",
      "740:             [",
      "741:                 '1,2',",
      "742:                 '3,2,1',",
      "743:                 true",
      "744:             ],",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "752:                 'bac',",
      "753:                 false",
      "754:             ],",
      "755:         ];",
      "756:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "765:             [",
      "766:                 '1,2,3',",
      "767:                 '1,2',",
      "768:                 false",
      "769:             ],",
      "770:             [",
      "771:                 '1,2,3',",
      "772:                 '2,1',",
      "773:                 false",
      "774:             ]",
      "",
      "---------------"
    ],
    "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
      "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <?php",
      "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
      "5: use In2code\\Femanager\\Domain\\Model\\User;",
      "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
      "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
      "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
      "14: class ServersideValidatorTest extends UnitTestCase",
      "15: {",
      "20:     protected $generalValidatorMock;",
      "25:     public function setUp(): void",
      "26:     {",
      "27:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
      "28:     }",
      "33:     public function tearDown(): void",
      "34:     {",
      "35:         unset($this->generalValidatorMock);",
      "36:     }",
      "41:     public function testGetValueForObjectStorage(): void",
      "42:     {",
      "43:         $user = new User();",
      "45:         $usergroup1 = $this->getUserGroupMock(1);",
      "46:         $usergroup2 = $this->getUserGroupMock(2);",
      "48:         $user->addUsergroup($usergroup1);",
      "49:         $user->addUsergroup($usergroup2);",
      "51:         $fieldName = 'usergroup';",
      "53:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
      "55:         self::assertSame('1,2', $result);",
      "56:     }",
      "61:     public function testGetValueForObject(): void",
      "62:     {",
      "63:         $user = new User('testuser');",
      "65:         $fieldName = 'username';",
      "67:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
      "69:         self::assertSame('testuser', $result);",
      "70:     }",
      "76:     protected function getUserGroupMock(int $uid = 1)",
      "77:     {",
      "78:         $mockClass = $this->getMockBuilder(UserGroup::class)",
      "79:             ->disableOriginalConstructor()",
      "80:             ->getMock();",
      "82:         $mockClass->method('getUid')->willReturn($uid);",
      "84:         return $mockClass;",
      "85:     }",
      "86: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "cc40e78876647d1e76cfe7d9040d1704515b6003",
      "candidate_info": {
        "commit_hash": "cc40e78876647d1e76cfe7d9040d1704515b6003",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/cc40e78876647d1e76cfe7d9040d1704515b6003",
        "files": [
          "Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php",
          "Documentation/Changelog/Index.rst",
          "Documentation/Index.rst",
          "Documentation/Settings.yml",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "ext_emconf.php",
          "readme.md"
        ],
        "message": "[BUGFIX] Security Update please update as soon as possible",
        "before_after_code_files": [
          "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "ext_emconf.php||ext_emconf.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
          "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "341:     protected function validateInList($value, $validationSettingList)",
          "342:     {",
          "343:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
          "345:     }",
          "",
          "[Removed Lines]",
          "344:         return in_array($value, $validationSettings);",
          "",
          "[Added Lines]",
          "343:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
          "345:         $diff = array_diff($valueList, $validationSettings);",
          "347:         return empty($diff);",
          "",
          "---------------"
        ],
        "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php": [
          "File: Classes/Domain/Validator/ServersideValidator.php -> Classes/Domain/Validator/ServersideValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "9: use TYPO3\\CMS\\Extbase\\Domain\\Model\\FileReference;",
          "10: use TYPO3\\CMS\\Extbase\\Reflection\\ObjectAccess;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "307:     protected function getValue($user, $fieldName)",
          "308:     {",
          "309:         $value = $this->getValueFromProperty($user, $fieldName);",
          "310:         if (is_object($value)) {",
          "311:             if (method_exists($value, 'getUid')) {",
          "312:                 $value = $value->getUid();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "312:         if ($value instanceof ObjectStorage) {",
          "313:             $values = [];",
          "315:             foreach ($value as $object) {",
          "316:                 if (method_exists($object, 'getUid')) {",
          "317:                     $values[] = $object->getUid();",
          "318:                 }",
          "319:             }",
          "321:             return implode(',', $values);",
          "322:         }",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "732:                 'a',",
          "733:                 true",
          "734:             ],",
          "735:             [",
          "736:                 '23',",
          "737:                 '1,234,3',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "735:             [",
          "736:                 '1,2',",
          "737:                 '1,2,3',",
          "738:                 true",
          "739:             ],",
          "740:             [",
          "741:                 '1,2',",
          "742:                 '3,2,1',",
          "743:                 true",
          "744:             ],",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "752:                 'bac',",
          "753:                 false",
          "754:             ],",
          "755:         ];",
          "756:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "765:             [",
          "766:                 '1,2,3',",
          "767:                 '1,2',",
          "768:                 false",
          "769:             ],",
          "770:             [",
          "771:                 '1,2,3',",
          "772:                 '2,1',",
          "773:                 false",
          "774:             ]",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "14: class ServersideValidatorTest extends UnitTestCase",
          "15: {",
          "20:     protected $generalValidatorMock;",
          "25:     public function setUp(): void",
          "26:     {",
          "27:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
          "28:     }",
          "33:     public function tearDown(): void",
          "34:     {",
          "35:         unset($this->generalValidatorMock);",
          "36:     }",
          "41:     public function testGetValueForObjectStorage(): void",
          "42:     {",
          "43:         $user = new User();",
          "45:         $usergroup1 = $this->getUserGroupMock(1);",
          "46:         $usergroup2 = $this->getUserGroupMock(2);",
          "48:         $user->addUsergroup($usergroup1);",
          "49:         $user->addUsergroup($usergroup2);",
          "51:         $fieldName = 'usergroup';",
          "53:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "55:         self::assertSame('1,2', $result);",
          "56:     }",
          "61:     public function testGetValueForObject(): void",
          "62:     {",
          "63:         $user = new User('testuser');",
          "65:         $fieldName = 'username';",
          "67:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "69:         self::assertSame('testuser', $result);",
          "70:     }",
          "76:     protected function getUserGroupMock(int $uid = 1)",
          "77:     {",
          "78:         $mockClass = $this->getMockBuilder(UserGroup::class)",
          "79:             ->disableOriginalConstructor()",
          "80:             ->getMock();",
          "82:         $mockClass->method('getUid')->willReturn($uid);",
          "84:         return $mockClass;",
          "85:     }",
          "86: }",
          "",
          "---------------"
        ],
        "ext_emconf.php||ext_emconf.php": [
          "File: ext_emconf.php -> ext_emconf.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:     'modify_tables' => '',",
          "24:     'clearCacheOnLoad' => 0,",
          "25:     'lockType' => '',",
          "27:     'constraints' => [",
          "28:         'depends' => [",
          "29:             'typo3' => '10.0.0-10.4.99',",
          "",
          "[Removed Lines]",
          "26:     'version' => '6.3.2',",
          "",
          "[Added Lines]",
          "26:     'version' => '6.3.3',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "166ea2116d6669b8fde34362ba52d6e30f8231db",
      "candidate_info": {
        "commit_hash": "166ea2116d6669b8fde34362ba52d6e30f8231db",
        "repo": "in2code-de/femanager",
        "commit_url": "https://github.com/in2code-de/femanager/commit/166ea2116d6669b8fde34362ba52d6e30f8231db",
        "files": [
          "Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php",
          "Documentation/Changelog/Index.rst",
          "Documentation/Index.rst",
          "Documentation/Settings.yml",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "ext_emconf.php"
        ],
        "message": "[BUGFIX] Security Update please update as soon as possible\n\nBroken Access Control in Usergroup Validation (Andreas Nedbal - in2code) - thx to TYPO3 Security Team",
        "before_after_code_files": [
          "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
          "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
          "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "ext_emconf.php||ext_emconf.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ],
          "candidate": [
            "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php",
            "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php",
            "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
            "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Domain/Validator/AbstractValidator.php||Classes/Domain/Validator/AbstractValidator.php": [
          "File: Classes/Domain/Validator/AbstractValidator.php -> Classes/Domain/Validator/AbstractValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "327:     protected function validateInList($value, $validationSettingList)",
          "328:     {",
          "329:         $validationSettings = GeneralUtility::trimExplode(',', $validationSettingList, true);",
          "331:     }",
          "",
          "[Removed Lines]",
          "330:         return in_array($value, $validationSettings);",
          "",
          "[Added Lines]",
          "329:         $valueList = GeneralUtility::trimExplode(',', $value, true);",
          "331:         $diff = array_diff($valueList, $validationSettings);",
          "333:         return empty($diff);",
          "",
          "---------------"
        ],
        "Classes/Domain/Validator/ServersideValidator.php||Classes/Domain/Validator/ServersideValidator.php": [
          "File: Classes/Domain/Validator/ServersideValidator.php -> Classes/Domain/Validator/ServersideValidator.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: use In2code\\Femanager\\Domain\\Model\\User;",
          "8: use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;",
          "9: use TYPO3\\CMS\\Extbase\\Reflection\\ObjectAccess;",
          "11: use function array_key_exists;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9: use TYPO3\\CMS\\Extbase\\Persistence\\ObjectStorage;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "307:     protected function getValue($user, $fieldName)",
          "308:     {",
          "309:         $value = $this->getValueFromProperty($user, $fieldName);",
          "310:         if (is_object($value)) {",
          "311:             if (method_exists($value, 'getUid')) {",
          "312:                 $value = $value->getUid();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "312:         if ($value instanceof ObjectStorage) {",
          "313:             $values = [];",
          "315:             foreach ($value as $object) {",
          "316:                 if (method_exists($object, 'getUid')) {",
          "317:                     $values[] = $object->getUid();",
          "318:                 }",
          "319:             }",
          "321:             return implode(',', $values);",
          "322:         }",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/AbstractValidatorTest.php||Tests/Unit/Domain/Validator/AbstractValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/AbstractValidatorTest.php -> Tests/Unit/Domain/Validator/AbstractValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "692:                 'a',",
          "693:                 true",
          "694:             ],",
          "695:             [",
          "696:                 '23',",
          "697:                 '1,234,3',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "695:             [",
          "696:                 '1,2',",
          "697:                 '1,2,3',",
          "698:                 true",
          "699:             ],",
          "700:             [",
          "701:                 '1,2',",
          "702:                 '3,2,1',",
          "703:                 true",
          "704:             ],",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "712:                 'bac',",
          "713:                 false",
          "714:             ],",
          "715:         ];",
          "716:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "725:             [",
          "726:                 '1,2,3',",
          "727:                 '1,2',",
          "728:                 false",
          "729:             ],",
          "730:             [",
          "731:                 '1,2,3',",
          "732:                 '2,1',",
          "733:                 false",
          "734:             ]",
          "",
          "---------------"
        ],
        "Tests/Unit/Domain/Validator/ServersideValidatorTest.php||Tests/Unit/Domain/Validator/ServersideValidatorTest.php": [
          "File: Tests/Unit/Domain/Validator/ServersideValidatorTest.php -> Tests/Unit/Domain/Validator/ServersideValidatorTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace In2code\\Femanager\\Tests\\Unit\\Domain\\Validator;",
          "5: use In2code\\Femanager\\Domain\\Model\\User;",
          "6: use In2code\\Femanager\\Domain\\Model\\UserGroup;",
          "7: use In2code\\Femanager\\Domain\\Validator\\ServersideValidator;",
          "8: use Nimut\\TestingFramework\\TestCase\\UnitTestCase;",
          "14: class ServersideValidatorTest extends UnitTestCase",
          "15: {",
          "20:     protected $generalValidatorMock;",
          "25:     public function setUp(): void",
          "26:     {",
          "27:         $this->generalValidatorMock = $this->getAccessibleMock(ServersideValidator::class, ['dummy']);",
          "28:     }",
          "33:     public function tearDown(): void",
          "34:     {",
          "35:         unset($this->generalValidatorMock);",
          "36:     }",
          "41:     public function testGetValueForObjectStorage(): void",
          "42:     {",
          "43:         $user = new User();",
          "45:         $usergroup1 = $this->getUserGroupMock(1);",
          "46:         $usergroup2 = $this->getUserGroupMock(2);",
          "48:         $user->addUsergroup($usergroup1);",
          "49:         $user->addUsergroup($usergroup2);",
          "51:         $fieldName = 'usergroup';",
          "53:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "55:         self::assertSame('1,2', $result);",
          "56:     }",
          "61:     public function testGetValueForObject(): void",
          "62:     {",
          "63:         $user = new User('testuser');",
          "65:         $fieldName = 'username';",
          "67:         $result = $this->generalValidatorMock->_callRef('getValue', $user, $fieldName);",
          "69:         self::assertSame('testuser', $result);",
          "70:     }",
          "76:     protected function getUserGroupMock(int $uid = 1)",
          "77:     {",
          "78:         $mockClass = $this->getMockBuilder(UserGroup::class)",
          "79:             ->disableOriginalConstructor()",
          "80:             ->getMock();",
          "82:         $mockClass->method('getUid')->willReturn($uid);",
          "84:         return $mockClass;",
          "85:     }",
          "86: }",
          "",
          "---------------"
        ],
        "ext_emconf.php||ext_emconf.php": [
          "File: ext_emconf.php -> ext_emconf.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:     'modify_tables' => '',",
          "24:     'clearCacheOnLoad' => 0,",
          "25:     'lockType' => '',",
          "27:     'constraints' => [",
          "28:         'depends' => [",
          "29:             'typo3' => '8.7.0-9.5.99',",
          "",
          "[Removed Lines]",
          "26:     'version' => '5.5.1',",
          "",
          "[Added Lines]",
          "26:     'version' => '5.5.2',",
          "",
          "---------------"
        ]
      }
    }
  ]
}