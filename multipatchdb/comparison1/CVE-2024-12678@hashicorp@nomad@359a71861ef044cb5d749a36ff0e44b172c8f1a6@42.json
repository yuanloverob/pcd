{
  "cve_id": "CVE-2024-12678",
  "cve_desc": "Nomad Community and Nomad Enterprise (\"Nomad\") allocations are vulnerable to privilege escalation within a namespace through unredacted workload identity tokens. This vulnerability, identified as CVE-2024-12678, is fixed in Nomad Community Edition 1.9.4 and Nomad Enterprise 1.9.4, 1.8.8, and 1.7.16.",
  "repo": "hashicorp/nomad",
  "patch_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
  "patch_info": {
    "commit_hash": "359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "repo": "hashicorp/nomad",
    "commit_url": "https://github.com/hashicorp/nomad/commit/359a71861ef044cb5d749a36ff0e44b172c8f1a6",
    "files": [
      ".changelog/24683.txt",
      "command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go",
      "nomad/structs/structs.go"
    ],
    "message": "Backport of sec: fix alloc workload identity namespace permission into release/1.9.x (#24685)\n\nCo-authored-by: Deniz Onur Duzgun <59659739+dduzgun-security@users.noreply.github.com>",
    "before_after_code_files": [
      "command/agent/node_endpoint.go||command/agent/node_endpoint.go",
      "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go",
      "nomad/structs/structs.go||nomad/structs/structs.go"
    ]
  },
  "patch_diff": {
    "command/agent/node_endpoint.go||command/agent/node_endpoint.go": [
      "File: command/agent/node_endpoint.go -> command/agent/node_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "105:   out.Allocs = make([]*structs.Allocation, 0)",
      "106:  }",
      "107:  for _, alloc := range out.Allocs {",
      "108:   alloc.SetEventDisplayMessages()",
      "109:  }",
      "110:  return out.Allocs, nil",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108:   alloc = alloc.Sanitize()",
      "",
      "---------------"
    ],
    "nomad/alloc_endpoint.go||nomad/alloc_endpoint.go": [
      "File: nomad/alloc_endpoint.go -> nomad/alloc_endpoint.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "172:    }",
      "176:    if out != nil {",
      "178:     if !aclObj.AllowClientOp() && !allowNsOp(aclObj, out.Namespace) {",
      "179:      return structs.NewErrUnknownAllocation(args.AllocID)",
      "",
      "[Removed Lines]",
      "175:    reply.Alloc = out",
      "",
      "[Added Lines]",
      "176:     out = out.Sanitize()",
      "177:     reply.Alloc = out",
      "",
      "---------------"
    ],
    "nomad/structs/structs.go||nomad/structs/structs.go": [
      "File: nomad/structs/structs.go -> nomad/structs/structs.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "11199:  return a.ID",
      "11200: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11205: func (a *Allocation) Sanitize() *Allocation {",
      "11206:  if a == nil {",
      "11207:   return nil",
      "11208:  }",
      "11210:  if a.SignedIdentities == nil {",
      "11211:   return a",
      "11212:  }",
      "11214:  clean := a.Copy()",
      "11215:  clean.SignedIdentities = nil",
      "11216:  return clean",
      "11217: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "034e563c17202d0ef78a2d057143bc282749c431",
      "candidate_info": {
        "commit_hash": "034e563c17202d0ef78a2d057143bc282749c431",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/034e563c17202d0ef78a2d057143bc282749c431",
        "files": [
          ".changelog/24232.txt",
          "command/asset/connect.nomad.hcl",
          "command/asset/example.nomad.hcl"
        ],
        "message": "backport of commit e440e1d1db7574dea4c50d669a6f41f9e989a66a (#24247)\n\nCo-authored-by: Michael Schurter <mschurter@hashicorp.com>",
        "before_after_code_files": [
          "command/asset/connect.nomad.hcl||command/asset/connect.nomad.hcl",
          "command/asset/example.nomad.hcl||command/asset/example.nomad.hcl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "command/asset/connect.nomad.hcl||command/asset/connect.nomad.hcl": [
          "File: command/asset/connect.nomad.hcl -> command/asset/connect.nomad.hcl",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: # should run. Jobs have a globally unique name, one or many task groups, which",
          "7: # are themselves collections of one or many tasks.",
          "8: #",
          "11: #",
          "13: #",
          "14: job \"countdash\" {",
          "55:   #",
          "58:   #",
          "60:   #",
          "102:   }",
          "134:   #",
          "137:   #",
          "139:   #",
          "140:   group \"api\" {",
          "243:     # The \"network\" block for a group creates a network namespace shared",
          "244:     # by all tasks within the group.",
          "",
          "[Removed Lines]",
          "9: # For more information and examples on the \"job\" block, please see",
          "10: # the online documentation at:",
          "12: #     https://developer.hashicorp.com/nomad/docs/job-specification/job.html",
          "15:   # The \"region\" parameter specifies the region in which to execute the job. If",
          "16:   # omitted, this inherits the default region name of \"global\".",
          "17:   # region = \"global\"",
          "18:   #",
          "19:   # The \"datacenters\" parameter specifies the list of datacenters which should",
          "20:   # be considered when placing this task. This accepts wildcards and defaults",
          "21:   # allowing placement on all datacenters.",
          "22:   datacenters = [\"*\"]",
          "24:   # The \"type\" parameter controls the type of job, which impacts the scheduler's",
          "25:   # decision on placement. This configuration is optional and defaults to",
          "26:   # \"service\". For a full list of job types and their differences, please see",
          "27:   # the online documentation.",
          "28:   #",
          "29:   # For more information, please see the online documentation at:",
          "30:   #",
          "31:   #     https://developer.hashicorp.com/nomad/docs/jobspec/schedulers.html",
          "32:   #",
          "33:   type = \"service\"",
          "35:   # The \"constraint\" block defines additional constraints for placing this job,",
          "36:   # in addition to any resource or driver constraints. This block may be placed",
          "37:   # at the \"job\", \"group\", or \"task\" level, and supports variable interpolation.",
          "38:   #",
          "39:   # For more information and examples on the \"constraint\" block, please see",
          "40:   # the online documentation at:",
          "41:   #",
          "42:   #     https://developer.hashicorp.com/nomad/docs/job-specification/constraint.html",
          "43:   #",
          "44:   # constraint {",
          "45:   #   attribute = \"${attr.kernel.name}\"",
          "46:   #   value     = \"linux\"",
          "47:   # }",
          "49:   # The \"update\" block specifies the update strategy of task groups. The update",
          "50:   # strategy is used to control things like rolling upgrades, canaries, and",
          "51:   # blue/green deployments. If omitted, no update strategy is enforced. The",
          "52:   # \"update\" block may be placed at the job or task group. When placed at the",
          "53:   # job, it applies to all groups within the job. When placed at both the job and",
          "54:   # group level, the blocks are merged with the group's taking precedence.",
          "56:   # For more information and examples on the \"update\" block, please see",
          "57:   # the online documentation at:",
          "59:   #     https://developer.hashicorp.com/nomad/docs/job-specification/update.html",
          "61:   update {",
          "62:     # The \"max_parallel\" parameter specifies the maximum number of updates to",
          "63:     # perform in parallel. In this case, this specifies to update a single task",
          "64:     # at a time.",
          "65:     max_parallel = 1",
          "67:     # The \"min_healthy_time\" parameter specifies the minimum time the allocation",
          "68:     # must be in the healthy state before it is marked as healthy and unblocks",
          "69:     # further allocations from being updated.",
          "70:     min_healthy_time = \"10s\"",
          "72:     # The \"healthy_deadline\" parameter specifies the deadline in which the",
          "73:     # allocation must be marked as healthy after which the allocation is",
          "74:     # automatically transitioned to unhealthy. Transitioning to unhealthy will",
          "75:     # fail the deployment and potentially roll back the job if \"auto_revert\" is",
          "76:     # set to true.",
          "77:     healthy_deadline = \"3m\"",
          "79:     # The \"progress_deadline\" parameter specifies the deadline in which an",
          "80:     # allocation must be marked as healthy. The deadline begins when the first",
          "81:     # allocation for the deployment is created and is reset whenever an allocation",
          "82:     # as part of the deployment transitions to a healthy state. If no allocation",
          "83:     # transitions to the healthy state before the progress deadline, the",
          "84:     # deployment is marked as failed.",
          "85:     progress_deadline = \"10m\"",
          "87:     # The \"auto_revert\" parameter specifies if the job should auto-revert to the",
          "88:     # last stable job on deployment failure. A job is marked as stable if all the",
          "89:     # allocations as part of its deployment were marked healthy.",
          "90:     auto_revert = false",
          "92:     # The \"canary\" parameter specifies that changes to the job that would result",
          "93:     # in destructive updates should create the specified number of canaries",
          "94:     # without stopping any previous allocations. Once the operator determines the",
          "95:     # canaries are healthy, they can be promoted which unblocks a rolling update",
          "96:     # of the remaining allocations at a rate of \"max_parallel\".",
          "97:     #",
          "98:     # Further, setting \"canary\" equal to the count of the task group allows",
          "99:     # blue/green deployments. When the job is updated, a full set of the new",
          "100:     # version is deployed and upon promotion the old version is stopped.",
          "101:     canary = 0",
          "103:   # The migrate block specifies the group's strategy for migrating off of",
          "104:   # draining nodes. If omitted, a default migration strategy is applied.",
          "105:   #",
          "106:   # For more information on the \"migrate\" block, please see",
          "107:   # the online documentation at:",
          "108:   #",
          "109:   #     https://developer.hashicorp.com/nomad/docs/job-specification/migrate.html",
          "110:   #",
          "111:   migrate {",
          "112:     # Specifies the number of task groups that can be migrated at the same",
          "113:     # time. This number must be less than the total count for the group as",
          "114:     # (count - max_parallel) will be left running during migrations.",
          "115:     max_parallel = 1",
          "117:     # Specifies the mechanism in which allocations health is determined. The",
          "118:     # potential values are \"checks\" or \"task_states\".",
          "119:     health_check = \"checks\"",
          "121:     # Specifies the minimum time the allocation must be in the healthy state",
          "122:     # before it is marked as healthy and unblocks further allocations from being",
          "123:     # migrated. This is specified using a label suffix like \"30s\" or \"15m\".",
          "124:     min_healthy_time = \"10s\"",
          "126:     # Specifies the deadline in which the allocation must be marked as healthy",
          "127:     # after which the allocation is automatically transitioned to unhealthy. This",
          "128:     # is specified using a label suffix like \"2m\" or \"1h\".",
          "129:     healthy_deadline = \"5m\"",
          "130:   }",
          "131:   # The \"group\" block defines a series of tasks that should be co-located on",
          "132:   # the same Nomad client. Any task within a group will be placed on the same",
          "133:   # client.",
          "135:   # For more information and examples on the \"group\" block, please see",
          "136:   # the online documentation at:",
          "138:   #     https://developer.hashicorp.com/nomad/docs/job-specification/group.html",
          "141:     # The \"count\" parameter specifies the number of the task groups that should",
          "142:     # be running under this group. This value must be non-negative and defaults",
          "143:     # to 1.",
          "144:     count = 1",
          "146:     # The \"restart\" block configures a group's behavior on task failure. If",
          "147:     # left unspecified, a default restart policy is used based on the job type.",
          "148:     #",
          "149:     # For more information and examples on the \"restart\" block, please see",
          "150:     # the online documentation at:",
          "151:     #",
          "152:     #     https://developer.hashicorp.com/nomad/docs/job-specification/restart.html",
          "153:     #",
          "154:     restart {",
          "155:       # The number of attempts to run the job within the specified interval.",
          "156:       attempts = 2",
          "157:       interval = \"30m\"",
          "159:       # The \"delay\" parameter specifies the duration to wait before restarting",
          "160:       # a task after it has failed.",
          "161:       delay = \"15s\"",
          "163:       # The \"mode\" parameter controls what happens when a task has restarted",
          "164:       # \"attempts\" times within the interval. \"delay\" mode delays the next",
          "165:       # restart until the next interval. \"fail\" mode does not restart the task",
          "166:       # if \"attempts\" has been hit within the interval.",
          "167:       mode = \"fail\"",
          "168:     }",
          "170:     # The \"ephemeral_disk\" block instructs Nomad to utilize an ephemeral disk",
          "171:     # instead of a hard disk requirement. Clients using this block should",
          "172:     # not specify disk requirements in the resources block of the task. All",
          "173:     # tasks in this group will share the same ephemeral disk.",
          "174:     #",
          "175:     # For more information and examples on the \"ephemeral_disk\" block, please",
          "176:     # see the online documentation at:",
          "177:     #",
          "178:     #     https://developer.hashicorp.com/nomad/docs/job-specification/ephemeral_disk.html",
          "179:     #",
          "180:     ephemeral_disk {",
          "181:       # When sticky is true and the task group is updated, the scheduler",
          "182:       # will prefer to place the updated allocation on the same node and",
          "183:       # will migrate the data. This is useful for tasks that store data",
          "184:       # that should persist across allocation updates.",
          "185:       # sticky = true",
          "186:       #",
          "187:       # Setting migrate to true results in the allocation directory of a",
          "188:       # sticky allocation directory to be migrated.",
          "189:       # migrate = true",
          "190:       #",
          "191:       # The \"size\" parameter specifies the size in MB of shared ephemeral disk",
          "192:       # between tasks in the group.",
          "193:       size = 300",
          "194:     }",
          "196:     # The \"affinity\" block enables operators to express placement preferences",
          "197:     # based on node attributes or metadata.",
          "198:     #",
          "199:     # For more information and examples on the \"affinity\" block, please",
          "200:     # see the online documentation at:",
          "201:     #",
          "202:     #     https://developer.hashicorp.com/nomad/docs/job-specification/affinity.html",
          "203:     #",
          "204:     # affinity {",
          "205:     #   # attribute specifies the name of a node attribute or metadata",
          "206:     #   attribute = \"${node.datacenter}\"",
          "207:     #",
          "208:     #   # value specifies the desired attribute value. In this example Nomad",
          "209:     #   # will prefer placement in the \"us-west1\" datacenter.",
          "210:     #   value = \"us-west1\"",
          "211:     #",
          "212:     #   # weight can be used to indicate relative preference",
          "213:     #   # when the job has more than one affinity. It defaults to 50 if not set.",
          "214:     #   weight = 100",
          "215:     # }",
          "218:     # The \"spread\" block allows operators to increase the failure tolerance of",
          "219:     # their applications by specifying a node attribute that allocations",
          "220:     # should be spread over.",
          "221:     #",
          "222:     # For more information and examples on the \"spread\" block, please",
          "223:     # see the online documentation at:",
          "224:     #",
          "225:     #     https://developer.hashicorp.com/nomad/docs/job-specification/spread.html",
          "226:     #",
          "227:     # spread {",
          "228:     #   # attribute specifies the name of a node attribute or metadata",
          "229:     #   attribute = \"${node.datacenter}\"",
          "230:     # }",
          "232:     # targets can be used to define desired percentages of allocations",
          "233:     # for each targeted attribute value.",
          "234:     #",
          "235:     #   target \"us-east1\" {",
          "236:     #     percent = 60",
          "237:     #   }",
          "238:     #   target \"us-west1\" {",
          "239:     #     percent = 40",
          "240:     #   }",
          "241:     #  }",
          "",
          "[Added Lines]",
          "9: # For more information and examples on the \"job\" block, refer to",
          "11: #     https://developer.hashicorp.com/nomad/docs/job-specification/job",
          "15:   # The \"ui\" block provides options to modify the presentation of the Job index",
          "16:   # page in Nomad's Web UI.",
          "18:   # For more information on the \"ui\" block, refer to:",
          "20:   #   https://developer.hashicorp.com/nomad/docs/job-specification/ui",
          "22:   ui {",
          "23:     description = \"Sample Consul Service Mesh Job\"",
          "24:     link {",
          "25:       label = \"Learn more about Nomad\"",
          "26:       url   = \"https://developer.hashicorp.com/nomad\"",
          "27:     }",
          "28:     link {",
          "29:       label = \"Learn more about Consul\"",
          "30:       url   = \"https://developer.hashicorp.com/consul\"",
          "31:     }",
          "34:   # The \"group\" block defines tasks that should be co-located on the same Nomad",
          "35:   # client. Nomad places any task within a group onto the same client.",
          "37:   # For more information and examples on the \"group\" block, refer to:",
          "39:   #     https://developer.hashicorp.com/nomad/docs/job-specification/group",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "296:         sidecar_service {}",
          "297:       }",
          "298:     }",
          "299:     # The \"task\" block creates an individual unit of work, such as a Docker",
          "300:     # container, web application, or batch processing.",
          "301:     #",
          "304:     #",
          "306:     #",
          "307:     task \"web\" {",
          "308:       # The \"driver\" parameter specifies the task driver that should be used to",
          "",
          "[Removed Lines]",
          "302:     # For more information and examples on the \"task\" block, please see",
          "303:     # the online documentation at:",
          "305:     #     https://developer.hashicorp.com/nomad/docs/job-specification/task.html",
          "",
          "[Added Lines]",
          "103:     # For more information and examples on the \"task\" block, refer to:",
          "105:     #     https://developer.hashicorp.com/nomad/docs/job-specification/task",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "322:         auth_soft_fail = true",
          "323:       }",
          "367:       # The \"resources\" block describes the requirements a task needs to",
          "371:       #",
          "374:       #",
          "376:       #",
          "377:       resources {",
          "378:         cpu    = 500 # 500 MHz",
          "",
          "[Removed Lines]",
          "325:       # The \"artifact\" block instructs Nomad to download an artifact from a",
          "326:       # remote source prior to starting the task. This provides a convenient",
          "327:       # mechanism for downloading configuration files or data needed to run the",
          "328:       # task. It is possible to specify the \"artifact\" block multiple times to",
          "329:       # download multiple artifacts.",
          "330:       #",
          "331:       # For more information and examples on the \"artifact\" block, please see",
          "332:       # the online documentation at:",
          "333:       #",
          "334:       #     https://developer.hashicorp.com/nomad/docs/job-specification/artifact.html",
          "335:       #",
          "336:       # artifact {",
          "337:       #   source = \"http://foo.com/artifact.tar.gz\"",
          "338:       #   options {",
          "339:       #     checksum = \"md5:c4aa853ad2215426eb7d70a21922e794\"",
          "340:       #   }",
          "341:       # }",
          "344:       # The \"logs\" block instructs the Nomad client on how many log files and",
          "345:       # the maximum size of those logs files to retain. Logging is enabled by",
          "346:       # default, but the \"logs\" block allows for finer-grained control over",
          "347:       # the log rotation and storage configuration.",
          "348:       #",
          "349:       # For more information and examples on the \"logs\" block, please see",
          "350:       # the online documentation at:",
          "351:       #",
          "352:       #     https://developer.hashicorp.com/nomad/docs/job-specification/logs.html",
          "353:       #",
          "354:       # logs {",
          "355:       #   max_files     = 10",
          "356:       #   max_file_size = 15",
          "357:       # }",
          "359:       # The \"identity\" block instructs Nomad to expose the task's workload",
          "360:       # identity token as an environment variable and in the file",
          "361:       # secrets/nomad_token.",
          "362:       # identity {",
          "363:       #   env  = true",
          "364:       #   file = true",
          "365:       # }",
          "368:       # execute. Resource requirements include memory, network, cpu, and more.",
          "369:       # This ensures the task will execute on a machine that contains enough",
          "370:       # resource capacity.",
          "372:       # For more information and examples on the \"resources\" block, please see",
          "373:       # the online documentation at:",
          "375:       #     https://developer.hashicorp.com/nomad/docs/job-specification/resources.html",
          "",
          "[Added Lines]",
          "126:       # execute. Resource requirements include attributes such as memory, cpu,",
          "127:       # cores, and devices.",
          "129:       # For a complete list of supported resources and examples on the",
          "130:       # \"resources\" block, refer to:",
          "132:       #     https://developer.hashicorp.com/nomad/docs/job-specification/resources",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "415:     #   }",
          "416:     # }",
          "417:   }",
          "418:   # This job has a second \"group\" block to define tasks that might be placed",
          "419:   # on a separate Nomad client from the group above.",
          "421:   group \"dashboard\" {",
          "422:     network {",
          "423:       mode = \"bridge\"",
          "",
          "[Removed Lines]",
          "420:   #",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "command/asset/example.nomad.hcl||command/asset/example.nomad.hcl": [
          "File: command/asset/example.nomad.hcl -> command/asset/example.nomad.hcl",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: # should run. Jobs have a globally unique name, one or many task groups, which",
          "7: # are themselves collections of one or many tasks.",
          "8: #",
          "11: #",
          "12: #     https://developer.hashicorp.com/nomad/docs/job-specification/job",
          "13: #",
          "",
          "[Removed Lines]",
          "9: # For more information and examples on the \"job\" block, please see",
          "10: # the online documentation at:",
          "",
          "[Added Lines]",
          "9: # For more information and examples on the \"job\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "24:   # The \"type\" parameter controls the type of job, which impacts the scheduler's",
          "25:   # decision on placement. This configuration is optional and defaults to",
          "28:   #",
          "30:   #",
          "31:   #     https://developer.hashicorp.com/nomad/docs/schedulers",
          "32:   #",
          "33:   type = \"service\"",
          "35:   # The \"constraint\" block defines additional constraints for placing this job,",
          "38:   #",
          "41:   #",
          "42:   #     https://developer.hashicorp.com/nomad/docs/job-specification/constraint",
          "43:   #",
          "",
          "[Removed Lines]",
          "26:   # \"service\". For a full list of job types and their differences, please see",
          "27:   # the online documentation.",
          "29:   # For more information, please see the online documentation at:",
          "36:   # in addition to any resource or driver constraints. This block may be placed",
          "37:   # at the \"job\", \"group\", or \"task\" level, and supports variable interpolation.",
          "39:   # For more information and examples on the \"constraint\" block, please see",
          "40:   # the online documentation at:",
          "",
          "[Added Lines]",
          "25:   # \"service\".",
          "27:   # For a full list of job types and their differences, refer to:",
          "34:   # in addition to any resource or driver constraints. You may place this block",
          "35:   # at the \"job\", \"group\", or \"task\" level, and it supports variable interpolation.",
          "37:   # For more information and examples on the \"constraint\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "51:   # blue/green deployments. If omitted, no update strategy is enforced. The",
          "52:   # \"update\" block may be placed at the job or task group. When placed at the",
          "53:   # job, it applies to all groups within the job. When placed at both the job and",
          "55:   #",
          "58:   #",
          "59:   #     https://developer.hashicorp.com/nomad/docs/job-specification/update",
          "60:   #",
          "",
          "[Removed Lines]",
          "54:   # group level, the blocks are merged with the group's taking precedence.",
          "56:   # For more information and examples on the \"update\" block, please see",
          "57:   # the online documentation at:",
          "",
          "[Added Lines]",
          "51:   # group level, the blocks are merged with the groups taking precedence.",
          "53:   # For more information and examples on the \"update\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "100:     # version is deployed and upon promotion the old version is stopped.",
          "101:     canary = 0",
          "102:   }",
          "103:   # The migrate block specifies the group's strategy for migrating off of",
          "105:   #",
          "108:   #",
          "109:   #     https://developer.hashicorp.com/nomad/docs/job-specification/migrate",
          "110:   #",
          "",
          "[Removed Lines]",
          "104:   # draining nodes. If omitted, a default migration strategy is applied.",
          "106:   # For more information on the \"migrate\" block, please see",
          "107:   # the online documentation at:",
          "",
          "[Added Lines]",
          "101:   # draining nodes. If omitted, Nomad applies a default migration strategy.",
          "103:   # For more information on the \"migrate\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "128:     # is specified using a label suffix like \"2m\" or \"1h\".",
          "129:     healthy_deadline = \"5m\"",
          "130:   }",
          "134:   #",
          "137:   #",
          "138:   #     https://developer.hashicorp.com/nomad/docs/job-specification/group",
          "139:   #",
          "140:   group \"cache\" {",
          "144:     count = 1",
          "148:     #",
          "151:     #",
          "152:     #     https://developer.hashicorp.com/nomad/docs/job-specification/network",
          "153:     #",
          "",
          "[Removed Lines]",
          "131:   # The \"group\" block defines a series of tasks that should be co-located on",
          "132:   # the same Nomad client. Any task within a group will be placed on the same",
          "133:   # client.",
          "135:   # For more information and examples on the \"group\" block, please see",
          "136:   # the online documentation at:",
          "141:     # The \"count\" parameter specifies the number of the task groups that should",
          "142:     # be running under this group. This value must be non-negative and defaults",
          "143:     # to 1.",
          "146:     # The \"network\" block specifies the network configuration for the allocation",
          "147:     # including requesting port bindings.",
          "149:     # For more information and examples on the \"network\" block, please see",
          "150:     # the online documentation at:",
          "",
          "[Added Lines]",
          "128:   # The \"ui\" block provides options to modify the presentation of the Job index",
          "129:   # page in Nomad's Web UI.",
          "130:   #",
          "131:   # For more information on the \"ui\" block, refer to:",
          "132:   #",
          "133:   #   https://developer.hashicorp.com/nomad/docs/job-specification/ui",
          "134:   #",
          "135:   ui {",
          "136:     description = \"Nomad **Example** Job\"",
          "137:     link {",
          "138:       label = \"Learn more about Nomad\"",
          "139:       url   = \"https://developer.hashicorp.com/nomad\"",
          "140:     }",
          "141:   }",
          "143:   # The \"group\" block defines tasks that should be co-located on the same Nomad",
          "144:   # client. Nomad places any task within a group onto the same client.",
          "146:   # For more information and examples on the \"group\" block, refer to:",
          "151:     # The \"count\" parameter specifies the number of this task group. This value",
          "152:     # must be non-negative and defaults to 1.",
          "155:     # The \"network\" block specifies the network configuration for the task",
          "156:     # group including requesting port bindings.",
          "158:     # For more information and examples on the \"network\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "162:     # will make the service discoverable after Nomad has placed it on a host and",
          "163:     # port.",
          "164:     #",
          "167:     #",
          "168:     #     https://developer.hashicorp.com/nomad/docs/job-specification/service",
          "169:     #",
          "",
          "[Removed Lines]",
          "165:     # For more information and examples on the \"service\" block, please see",
          "166:     # the online documentation at:",
          "",
          "[Added Lines]",
          "173:     # For more information and examples on the \"service\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "173:       port     = \"db\"",
          "174:       provider = \"nomad\"",
          "181:       # check {",
          "182:       #   name     = \"alive\"",
          "",
          "[Removed Lines]",
          "176:       # The \"check\" block instructs Nomad to create a Consul health check for",
          "177:       # this service. A sample check is provided here for your convenience;",
          "178:       # uncomment it to enable it. The \"check\" block is documented in the",
          "179:       # \"service\" block documentation.",
          "",
          "[Added Lines]",
          "183:       # The \"check\" block instructs Nomad to create a health check for",
          "184:       # this service. Uncomment the sample check below to enable it.",
          "185:       #",
          "186:       # For more information and examples on the \"check\" block, refer to:",
          "187:       #",
          "188:       #   https://developer.hashicorp.com/nomad/docs/job-specification/check",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "188:     }",
          "190:     # The \"restart\" block configures a group's behavior on task failure. If",
          "192:     #",
          "195:     #",
          "196:     #     https://developer.hashicorp.com/nomad/docs/job-specification/restart",
          "197:     #",
          "198:     restart {",
          "200:       attempts = 2",
          "201:       interval = \"30m\"",
          "",
          "[Removed Lines]",
          "191:     # left unspecified, a default restart policy is used based on the job type.",
          "193:     # For more information and examples on the \"restart\" block, please see",
          "194:     # the online documentation at:",
          "199:       # The number of attempts to run the job within the specified interval.",
          "",
          "[Added Lines]",
          "200:     # left unspecified, Nomad uses a default restart policy based on the job type.",
          "202:     # For more information and examples on the \"restart\" block, refer to:",
          "207:       # The number of attempts to run within the specified interval.",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "211:       mode = \"fail\"",
          "212:     }",
          "218:     #",
          "221:     #",
          "222:     #     https://developer.hashicorp.com/nomad/docs/job-specification/ephemeral_disk",
          "223:     #",
          "224:     ephemeral_disk {",
          "225:       # When sticky is true and the task group is updated, the scheduler",
          "229:       # sticky = true",
          "233:       # migrate = true",
          "235:       # The \"size\" parameter specifies the size in MB of shared ephemeral disk",
          "236:       # between tasks in the group.",
          "237:       size = 300",
          "238:     }",
          "241:     # based on node attributes or metadata.",
          "242:     #",
          "245:     #",
          "246:     #     https://developer.hashicorp.com/nomad/docs/job-specification/affinity",
          "247:     #",
          "248:     # affinity {",
          "266:     # should be spread over.",
          "267:     #",
          "270:     #",
          "271:     #     https://developer.hashicorp.com/nomad/docs/job-specification/spread",
          "272:     #",
          "273:     # spread {",
          "281:     #   target \"us-east1\" {",
          "282:     #     percent = 60",
          "283:     #   }",
          "",
          "[Removed Lines]",
          "214:     # The \"ephemeral_disk\" block instructs Nomad to utilize an ephemeral disk",
          "215:     # instead of a hard disk requirement. Clients using this block should",
          "216:     # not specify disk requirements in the resources block of the task. All",
          "217:     # tasks in this group will share the same ephemeral disk.",
          "219:     # For more information and examples on the \"ephemeral_disk\" block, please",
          "220:     # see the online documentation at:",
          "226:       # will prefer to place the updated allocation on the same node and",
          "227:       # will migrate the data. This is useful for tasks that store data",
          "228:       # that should persist across allocation updates.",
          "230:       #",
          "231:       # Setting migrate to true results in the allocation directory of a",
          "232:       # sticky allocation directory to be migrated.",
          "234:       #",
          "240:     # The \"affinity\" block enables operators to express placement preferences",
          "243:     # For more information and examples on the \"affinity\" block, please",
          "244:     # see the online documentation at:",
          "249:     # attribute specifies the name of a node attribute or metadata",
          "250:     # attribute = \"${node.datacenter}\"",
          "253:     # value specifies the desired attribute value. In this example Nomad",
          "254:     # will prefer placement in the \"us-west1\" datacenter.",
          "255:     # value  = \"us-west1\"",
          "258:     # weight can be used to indicate relative preference",
          "259:     # when the job has more than one affinity. It defaults to 50 if not set.",
          "260:     # weight = 100",
          "261:     #  }",
          "264:     # The \"spread\" block allows operators to increase the failure tolerance of",
          "265:     # their applications by specifying a node attribute that allocations",
          "268:     # For more information and examples on the \"spread\" block, please",
          "269:     # see the online documentation at:",
          "274:     # attribute specifies the name of a node attribute or metadata",
          "275:     # attribute = \"${node.datacenter}\"",
          "278:     # targets can be used to define desired percentages of allocations",
          "279:     # for each targeted attribute value.",
          "280:     #",
          "",
          "[Added Lines]",
          "222:     # The \"ephemeral_disk\" block describes the ephemeral disk requirements of",
          "223:     # the group. All tasks in this group share the same ephemeral disk.",
          "225:     # For more information and examples on the \"ephemeral_disk\" block, refer",
          "226:     # to:",
          "232:       # prefers to place the updated allocation on the same node and migrate the",
          "233:       # data. This is useful for tasks that store data that should persist",
          "234:       # across updates.",
          "237:       # Setting migrate to true results Nomad copying the allocation directory",
          "238:       # to the new allocation on update.",
          "246:     # The \"affinity\" block lets you express placement preferences",
          "249:     # For more information and examples on the \"affinity\" block, refer to:",
          "254:     #   attribute = \"${node.datacenter}\"",
          "255:     #   value     = \"us-west1\"",
          "256:     #   weight    = 100",
          "257:     # }",
          "259:     # The \"spread\" block let you increase the failure tolerance of",
          "260:     # your applications by specifying a node attribute that allocations",
          "263:     # For more information and examples on the \"spread\" block, refer to:",
          "268:     #   attribute = \"${node.datacenter}\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "287:     #  }",
          "289:     # The \"task\" block creates an individual unit of work, such as a Docker",
          "291:     #",
          "294:     #",
          "295:     #     https://developer.hashicorp.com/nomad/docs/job-specification/task",
          "296:     #",
          "",
          "[Removed Lines]",
          "290:     # container, web application, or batch processing.",
          "292:     # For more information and examples on the \"task\" block, please see",
          "293:     # the online documentation at:",
          "",
          "[Added Lines]",
          "278:     # container, virtual machine, or process.",
          "280:     # For more information and examples on the \"task\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "316:       # The \"artifact\" block instructs Nomad to download an artifact from a",
          "317:       # remote source prior to starting the task. This provides a convenient",
          "318:       # mechanism for downloading configuration files or data needed to run the",
          "321:       #",
          "324:       #",
          "325:       #     https://developer.hashicorp.com/nomad/docs/job-specification/artifact",
          "326:       #",
          "",
          "[Removed Lines]",
          "319:       # task. It is possible to specify the \"artifact\" block multiple times to",
          "320:       # download multiple artifacts.",
          "322:       # For more information and examples on the \"artifact\" block, please see",
          "323:       # the online documentation at:",
          "",
          "[Added Lines]",
          "306:       # task. Specify the \"artifact\" block multiple times to download",
          "307:       # multiple artifacts.",
          "309:       # For more information and examples on the \"artifact\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "336:       # default, but the \"logs\" block allows for finer-grained control over",
          "337:       # the log rotation and storage configuration.",
          "338:       #",
          "341:       #",
          "342:       #     https://developer.hashicorp.com/nomad/docs/job-specification/logs",
          "343:       #",
          "",
          "[Removed Lines]",
          "339:       # For more information and examples on the \"logs\" block, please see",
          "340:       # the online documentation at:",
          "",
          "[Added Lines]",
          "325:       # For more information and examples on the \"logs\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "349:       # The \"identity\" block instructs Nomad to expose the task's workload",
          "350:       # identity token as an environment variable and in the file",
          "351:       # secrets/nomad_token.",
          "352:       identity {",
          "353:         env  = true",
          "354:         file = true",
          "355:       }",
          "357:       # The \"resources\" block describes the requirements a task needs to",
          "361:       #",
          "364:       #",
          "365:       #     https://developer.hashicorp.com/nomad/docs/job-specification/resources",
          "366:       #",
          "",
          "[Removed Lines]",
          "358:       # execute. Resource requirements include memory, cpu, and more.",
          "359:       # This ensures the task will execute on a machine that contains enough",
          "360:       # resource capacity.",
          "362:       # For more information and examples on the \"resources\" block, please see",
          "363:       # the online documentation at:",
          "",
          "[Added Lines]",
          "337:       #",
          "338:       # For more information and examples on the \"identity\" block, refer to:",
          "339:       #",
          "340:       #     https://developer.hashicorp.com/nomad/docs/job-specification/identity",
          "341:       #",
          "348:       # execute. Resource requirements include attributes such as memory, cpu,",
          "349:       # cores, and devices.",
          "351:       # For a complete list of attributes and examples on the \"resources\"",
          "352:       # block, refer to:",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "369:         memory = 256 # 256MB",
          "370:       }",
          "376:       #",
          "379:       #",
          "380:       #     https://developer.hashicorp.com/nomad/docs/job-specification/template",
          "381:       #",
          "",
          "[Removed Lines]",
          "373:       # The \"template\" block instructs Nomad to manage a template, such as",
          "374:       # a configuration file or script. This template can optionally pull data",
          "375:       # from Consul or Vault to populate runtime configuration data.",
          "377:       # For more information and examples on the \"template\" block, please see",
          "378:       # the online documentation at:",
          "",
          "[Added Lines]",
          "361:       # The \"template\" block instructs Nomad to manage a template, such as a",
          "362:       # configuration file or script. This template can optionally pull data",
          "363:       # from Nomad, Consul, or Vault to populate runtime configuration data.",
          "365:       # For more information and examples on the \"template\" block, refer to:",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "396:       #   env         = true",
          "397:       # }",
          "405:       #",
          "408:       #",
          "409:       #     https://developer.hashicorp.com/nomad/docs/job-specification/vault",
          "410:       #",
          "",
          "[Removed Lines]",
          "399:       # The \"vault\" block instructs the Nomad client to acquire a token from",
          "400:       # a HashiCorp Vault server. The Nomad servers must be configured and",
          "401:       # authorized to communicate with Vault. By default, Nomad will inject",
          "402:       # The token into the job via an environment variable and make the token",
          "403:       # available to the \"template\" block. The Nomad client handles the renewal",
          "404:       # and revocation of the Vault token.",
          "406:       # For more information and examples on the \"vault\" block, please see",
          "407:       # the online documentation at:",
          "",
          "[Added Lines]",
          "386:       # The \"vault\" block instructs the Nomad client to acquire a token from a",
          "387:       # HashiCorp Vault server. Nomad must be configured to communicate with",
          "388:       # Vault. By default, Nomad injects the token into the task via an",
          "389:       # environment variable and makes the token available to the \"template\"",
          "390:       # block. The Nomad client handles the renewal and revocation of the Vault",
          "391:       # token.",
          "393:       # For more information and examples on the \"vault\" block, refer to:",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e405392864e928fba89fe565d490d91f6c54aa2f",
      "candidate_info": {
        "commit_hash": "e405392864e928fba89fe565d490d91f6c54aa2f",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/e405392864e928fba89fe565d490d91f6c54aa2f",
        "files": [
          "client/allocrunner/taskrunner/remotetask_hook.go"
        ],
        "message": "client: mark the remote_task hook as deprecated (#24515)\n\nCo-authored-by: James Rasell <jrasell@users.noreply.github.com>",
        "before_after_code_files": [
          "client/allocrunner/taskrunner/remotetask_hook.go||client/allocrunner/taskrunner/remotetask_hook.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "client/allocrunner/taskrunner/remotetask_hook.go||client/allocrunner/taskrunner/remotetask_hook.go": [
          "File: client/allocrunner/taskrunner/remotetask_hook.go -> client/allocrunner/taskrunner/remotetask_hook.go"
        ]
      }
    },
    {
      "candidate_hash": "44945469bf0f8f561b24f5f592a737913ffc7b5c",
      "candidate_info": {
        "commit_hash": "44945469bf0f8f561b24f5f592a737913ffc7b5c",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/44945469bf0f8f561b24f5f592a737913ffc7b5c",
        "files": [
          ".release/ci.hcl",
          "client/structs/structs.generated.go",
          "nomad/structs/structs.generated.go",
          "version/version.go"
        ],
        "message": "Prepare for next release",
        "before_after_code_files": [
          ".release/ci.hcl||.release/ci.hcl",
          "client/structs/structs.generated.go||client/structs/structs.generated.go",
          "nomad/structs/structs.generated.go||nomad/structs/structs.generated.go",
          "version/version.go||version/version.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        ".release/ci.hcl||.release/ci.hcl": [
          "File: .release/ci.hcl -> .release/ci.hcl",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:   team = \"nomad\"",
          "9:   slack {",
          "11:   }",
          "13:   github {",
          "",
          "[Removed Lines]",
          "10:     notification_channel = \"CUYKT2A73\"",
          "",
          "[Added Lines]",
          "10:     notification_channel = \"C03B5EWFW01\"",
          "",
          "---------------"
        ],
        "client/structs/structs.generated.go||client/structs/structs.generated.go": [
          "File: client/structs/structs.generated.go -> client/structs/structs.generated.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "nomad/structs/structs.generated.go||nomad/structs/structs.generated.go": [
          "File: nomad/structs/structs.generated.go -> nomad/structs/structs.generated.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "version/version.go||version/version.go": [
          "File: version/version.go -> version/version.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:  GitDescribe string",
          "30:  VersionMetadata = \"\"",
          "",
          "[Removed Lines]",
          "22:  Version = \"1.9.1\"",
          "27:  VersionPrerelease = \"\"",
          "",
          "[Added Lines]",
          "22:  Version = \"1.9.2\"",
          "27:  VersionPrerelease = \"dev\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "452f30685aef4a9278efa013c4250502f03dd6a9",
      "candidate_info": {
        "commit_hash": "452f30685aef4a9278efa013c4250502f03dd6a9",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/452f30685aef4a9278efa013c4250502f03dd6a9",
        "files": [
          ".changelog/25201.txt",
          "go.mod",
          "go.sum"
        ],
        "message": "deps: update go-msgpack and net-rpc-msgpackrpc (#25201)\n\nFixes a bug where connections would not be closed on write errors in the\nmsgpack encoder, which would cause the reader end of RPC connections to hang\nindefinitely. This resulted in clients in widely-distributed geographies being\nunable to poll for allocation updates.\n\nFixes: https://github.com/hashicorp/nomad/issues/23305",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "67:  github.com/hashicorp/go-kms-wrapping/wrappers/gcpckms/v2 v2.0.12",
          "68:  github.com/hashicorp/go-kms-wrapping/wrappers/transit/v2 v2.0.13",
          "69:  github.com/hashicorp/go-memdb v1.3.4",
          "71:  github.com/hashicorp/go-multierror v1.1.1",
          "72:  github.com/hashicorp/go-netaddrs v0.1.0",
          "73:  github.com/hashicorp/go-plugin v1.6.2",
          "",
          "[Removed Lines]",
          "70:  github.com/hashicorp/go-msgpack/v2 v2.1.2",
          "",
          "[Added Lines]",
          "70:  github.com/hashicorp/go-msgpack/v2 v2.1.3",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "83:  github.com/hashicorp/hcl/v2 v2.20.2-0.20240517235513-55d9c02d147d",
          "84:  github.com/hashicorp/hil v0.0.0-20210521165536-27a72121fd40",
          "85:  github.com/hashicorp/memberlist v0.5.3",
          "87:  github.com/hashicorp/nomad/api v0.0.0-20230103221135-ce00d683f9be",
          "88:  github.com/hashicorp/raft v1.7.1",
          "89:  github.com/hashicorp/raft-autopilot v0.1.6",
          "",
          "[Removed Lines]",
          "86:  github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.0",
          "",
          "[Added Lines]",
          "86:  github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.1",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "1218: github.com/hashicorp/go-msgpack v0.5.5/go.mod h1:ahLV/dePpqEmjfWmKiqvPkv/twdG7iPBM1vqhUKIvfM=",
          "1219: github.com/hashicorp/go-msgpack v1.1.6-0.20240304204939-8824e8ccc35f h1:/xqzTen8ftnKv3cKa87WEoOLtsDJYFU0ArjrKaPTTkc=",
          "1220: github.com/hashicorp/go-msgpack v1.1.6-0.20240304204939-8824e8ccc35f/go.mod h1:gWVc3sv/wbDmR3rQsj1CAktEZzoz1YNK9NfGLXJ69/4=",
          "1223: github.com/hashicorp/go-multierror v1.0.0/go.mod h1:dHtQlpGsu+cZNNAkkCN/P3hoUDHhCYQXV3UM06sGGrk=",
          "1224: github.com/hashicorp/go-multierror v1.1.1 h1:H5DkEtf6CXdFp0N0Em5UCwQpXMWke8IA0+lD48awMYo=",
          "1225: github.com/hashicorp/go-multierror v1.1.1/go.mod h1:iw975J/qwKPdAO1clOe2L8331t/9/fmwbPZ6JB6eMoM=",
          "",
          "[Removed Lines]",
          "1221: github.com/hashicorp/go-msgpack/v2 v2.1.2 h1:4Ee8FTp834e+ewB71RDrQ0VKpyFdrKOjvYtnQ/ltVj0=",
          "1222: github.com/hashicorp/go-msgpack/v2 v2.1.2/go.mod h1:upybraOAblm4S7rx0+jeNy+CWWhzywQsSRV5033mMu4=",
          "",
          "[Added Lines]",
          "1221: github.com/hashicorp/go-msgpack/v2 v2.1.3 h1:cB1w4Zrk0O3jQBTcFMKqYQWRFfsSQ/TYKNyUUVyCP2c=",
          "1222: github.com/hashicorp/go-msgpack/v2 v2.1.3/go.mod h1:SjlwKKFnwBXvxD/I1bEcfJIBbEJ+MCUn39TxymNR5ZU=",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1282: github.com/hashicorp/mdns v1.0.4/go.mod h1:mtBihi+LeNXGtG8L9dX59gAEa12BDtBQSp4v/YAJqrc=",
          "1283: github.com/hashicorp/memberlist v0.5.3 h1:tQ1jOCypD0WvMemw/ZhhtH+PWpzcftQvgCorLu0hndk=",
          "1284: github.com/hashicorp/memberlist v0.5.3/go.mod h1:h60o12SZn/ua/j0B6iKAZezA4eDaGsIuPO70eOaJ6WE=",
          "1287: github.com/hashicorp/raft v1.2.0/go.mod h1:vPAJM8Asw6u8LxC3eJCUZmRP/E4QmUGE1R7g7k8sG/8=",
          "1288: github.com/hashicorp/raft v1.7.1 h1:ytxsNx4baHsRZrhUcbt3+79zc4ly8qm7pi0393pSchY=",
          "1289: github.com/hashicorp/raft v1.7.1/go.mod h1:hUeiEwQQR/Nk2iKDD0dkEhklSsu3jcAcqvPzPoZSAEM=",
          "",
          "[Removed Lines]",
          "1285: github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.0 h1:kBpVVl1sl3MaSrs97e0+pDQhSrqJv9gVbSUrPpVfl1w=",
          "1286: github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.0/go.mod h1:6pdNz0vo0mF0GvhwDG56O3N18qBrAz/XRIcfINfTbwo=",
          "",
          "[Added Lines]",
          "1285: github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.1 h1:Y1sd8ZCCUUlUetCk+3MCpOwdWd+WicHdk2zk2yUM0qw=",
          "1286: github.com/hashicorp/net-rpc-msgpackrpc/v2 v2.0.1/go.mod h1:wASEfI5dofjm9S9Jp3JM4pfoBZy8Z07JUE2wHNi0zuc=",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "70891b327e0aa6b48f5b03c767dabebbb8328152",
      "candidate_info": {
        "commit_hash": "70891b327e0aa6b48f5b03c767dabebbb8328152",
        "repo": "hashicorp/nomad",
        "commit_url": "https://github.com/hashicorp/nomad/commit/70891b327e0aa6b48f5b03c767dabebbb8328152",
        "files": [
          "nomad/fsm.go"
        ],
        "message": "backport of commit 7a9e3d2487b5b4bd3c9f2158cb143e1f1da29703 (#24440)\n\nCo-authored-by: Piotr Kazmierczak <470696+pkazmierczak@users.noreply.github.com>",
        "before_after_code_files": [
          "nomad/fsm.go||nomad/fsm.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/hashicorp/nomad/pull/25471"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "nomad/fsm.go||nomad/fsm.go": [
          "File: nomad/fsm.go -> nomad/fsm.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "33:  IndexSnapshot                        SnapshotType = 2",
          "34:  EvalSnapshot                         SnapshotType = 3",
          "35:  AllocSnapshot                        SnapshotType = 4",
          "37:  PeriodicLaunchSnapshot               SnapshotType = 6",
          "38:  JobSummarySnapshot                   SnapshotType = 7",
          "39:  VaultAccessorSnapshot                SnapshotType = 8",
          "",
          "[Removed Lines]",
          "36:  TimeTableSnapshot                    SnapshotType = 5",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "48:  CSIPluginSnapshot                    SnapshotType = 17",
          "49:  CSIVolumeSnapshot                    SnapshotType = 18",
          "50:  ScalingEventsSnapshot                SnapshotType = 19",
          "52:  ServiceRegistrationSnapshot          SnapshotType = 21",
          "53:  VariablesSnapshot                    SnapshotType = 22",
          "54:  VariablesQuotaSnapshot               SnapshotType = 23",
          "",
          "[Removed Lines]",
          "51:  EventSinkSnapshot                    SnapshotType = 20",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "60:  JobSubmissionSnapshot                SnapshotType = 29",
          "61:  RootKeySnapshot                      SnapshotType = 30",
          "64:  NamespaceSnapshot SnapshotType = 64",
          "65: )",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "63:  TimeTableSnapshot SnapshotType = 5",
          "67:  EventSinkSnapshot SnapshotType = 20",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1796:     return err",
          "1797:    }",
          "1800:   case EventSinkSnapshot:",
          "1803:   case ServiceRegistrationSnapshot:",
          "1804:    serviceRegistration := new(structs.ServiceRegistration)",
          "",
          "[Removed Lines]",
          "1801:    return nil",
          "",
          "[Added Lines]",
          "1807:    return fmt.Errorf(",
          "1808:     \"EventSinkSnapshot is an unsupported snapshot type since Nomad 1.0. Executing this code path means state corruption!\")",
          "",
          "---------------"
        ]
      }
    }
  ]
}