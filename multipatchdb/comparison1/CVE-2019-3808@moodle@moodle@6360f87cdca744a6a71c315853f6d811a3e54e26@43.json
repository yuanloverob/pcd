{
  "cve_id": "CVE-2019-3808",
  "cve_desc": "A flaw was found in Moodle versions 3.6 to 3.6.1, 3.5 to 3.5.3, 3.4 to 3.4.6, 3.1 to 3.1.15 and earlier unsupported versions. The 'manage groups' capability did not have the 'XSS risk' flag assigned to it, but does have that access in certain places. Note that the capability is intended for use by trusted users, and is only assigned to teachers and managers by default.",
  "repo": "moodle/moodle",
  "patch_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
  "patch_info": {
    "commit_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26",
    "files": [
      "lib/db/access.php",
      "version.php"
    ],
    "message": "MDL-64395 groups: Added XSS Risk to the manage groups capability",
    "before_after_code_files": [
      "lib/db/access.php||lib/db/access.php",
      "version.php||version.php"
    ]
  },
  "patch_diff": {
    "lib/db/access.php||lib/db/access.php": [
      "File: lib/db/access.php -> lib/db/access.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1123:     ),",
      "1125:     'moodle/course:managegroups' => array(",
      "1127:         'captype' => 'write',",
      "1128:         'contextlevel' => CONTEXT_COURSE,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1126:         'riskbitmask' => RISK_XSS,",
      "",
      "---------------"
    ],
    "version.php||version.php": [
      "File: version.php -> version.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "30: defined('MOODLE_INTERNAL') || die();",
      "",
      "[Removed Lines]",
      "32: $version  = 2018122000.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "[Added Lines]",
      "32: $version  = 2018122000.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5a01c2409a5a446b2891ae9bd2b45e0d0ca76edc",
      "candidate_info": {
        "commit_hash": "5a01c2409a5a446b2891ae9bd2b45e0d0ca76edc",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/5a01c2409a5a446b2891ae9bd2b45e0d0ca76edc",
        "files": [
          "lang/en/admin.php",
          "lib/classes/task/question_preview_cleanup_task.php",
          "lib/db/tasks.php",
          "lib/db/upgrade.php",
          "version.php"
        ],
        "message": "MDL-65050 core: rename task to question_preview_cleanup_task",
        "before_after_code_files": [
          "lang/en/admin.php||lang/en/admin.php",
          "lib/classes/task/question_cron_task.php||lib/classes/task/question_preview_cleanup_task.php",
          "lib/db/tasks.php||lib/db/tasks.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "lang/en/admin.php||lang/en/admin.php": [
          "File: lang/en/admin.php -> lang/en/admin.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243: $string['taskplagiarismcron'] = 'Background processing for legacy cron in plagiarism plugins';",
          "1244: $string['taskportfoliocron'] = 'Background processing for portfolio plugins';",
          "1245: $string['taskprocessing'] = 'Task processing';",
          "1247: $string['taskrefreshsystemtokens'] = 'Refresh OAuth tokens for service accounts';",
          "1248: $string['taskregistrationcron'] = 'Site registration';",
          "1249: $string['tasksendfailedloginnotifications'] = 'Send failed login notifications';",
          "",
          "[Removed Lines]",
          "1246: $string['taskquestioncron'] = 'Background processing for question engine';",
          "",
          "[Added Lines]",
          "1246: $string['taskquestioncron'] = 'Background processing for cleaning up the old question previews';",
          "",
          "---------------"
        ],
        "lib/classes/task/question_cron_task.php||lib/classes/task/question_preview_cleanup_task.php": [
          "File: lib/classes/task/question_cron_task.php -> lib/classes/task/question_preview_cleanup_task.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: namespace core\\task;",
          "",
          "[Removed Lines]",
          "29: class question_cron_task extends scheduled_task {",
          "",
          "[Added Lines]",
          "32: class question_preview_cleanup_task extends scheduled_task {",
          "",
          "---------------"
        ],
        "lib/db/tasks.php||lib/db/tasks.php": [
          "File: lib/db/tasks.php -> lib/db/tasks.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "213:         'month' => '*'",
          "214:     ),",
          "215:     array(",
          "217:         'blocking' => 0,",
          "218:         'minute' => '*',",
          "219:         'hour' => '*',",
          "",
          "[Removed Lines]",
          "216:         'classname' => 'core\\task\\question_cron_task',",
          "",
          "[Added Lines]",
          "216:         'classname' => 'core\\task\\question_preview_cleanup_task',",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2923:         upgrade_main_savepoint(true, 2019032200.02);",
          "2924:     }",
          "2926:     return true;",
          "2927: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2926:     if ($oldversion < 2019032800.01) {",
          "2927:         $sql = \"UPDATE {task_scheduled}",
          "2928:                    SET classname = ?",
          "2929:                  WHERE component = ?",
          "2930:                    AND classname = ?\";",
          "2931:         $DB->execute($sql, [",
          "2932:             '\\core\\task\\question_preview_cleanup_task',",
          "2933:             'moodle',",
          "2934:             '\\core\\task\\question_cron_task'",
          "2935:         ]);",
          "2938:         upgrade_main_savepoint(true, 2019032800.01);",
          "2939:     }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2019032800.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2019032800.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8cf4c97217230e74e57e41f24e8afbbc8393eb79",
      "candidate_info": {
        "commit_hash": "8cf4c97217230e74e57e41f24e8afbbc8393eb79",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/8cf4c97217230e74e57e41f24e8afbbc8393eb79",
        "files": [
          "version.php"
        ],
        "message": "weekly release 3.9dev",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "36: $branch   = '39';                       // This version's branch.",
          "37: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2019112900.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "35: $release  = '3.9dev (Build: 20191129)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2019120500.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "35: $release  = '3.9dev (Build: 20191205)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e2a687f689cac486a60162e5e8ccd0da53792d86",
      "candidate_info": {
        "commit_hash": "e2a687f689cac486a60162e5e8ccd0da53792d86",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/e2a687f689cac486a60162e5e8ccd0da53792d86",
        "files": [
          "lib/db/install.xml",
          "lib/db/upgrade.php",
          "version.php"
        ],
        "message": "MDL-63691 core: Column 'convhash' now accepts null\n\nIndex 'convhash' also changed to non-unique.",
        "before_after_code_files": [
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2588:         upgrade_main_savepoint(true, 2018101900.01);",
          "2589:     }",
          "2591:     return true;",
          "2592: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2591:     if ($oldversion < 2018101900.02) {",
          "2593:         $table = new xmldb_table('message_conversations');",
          "2596:         $index = new xmldb_index('convhash', XMLDB_INDEX_UNIQUE, ['convhash']);",
          "2597:         if ($dbman->index_exists($table, $index)) {",
          "2598:             $dbman->drop_index($table, $index);",
          "2599:         }",
          "2601:         $field = new xmldb_field('convhash', XMLDB_TYPE_CHAR, '40', null, null, null, null, 'name');",
          "2602:         $dbman->change_field_notnull($table, $field);",
          "2604:         $index = new xmldb_index('convhash', XMLDB_INDEX_NOTUNIQUE, ['convhash']);",
          "2605:         if (!$dbman->index_exists($table, $index)) {",
          "2606:             $dbman->add_index($table, $index);",
          "2607:         }",
          "2609:         upgrade_main_savepoint(true, 2018101900.02);",
          "2610:     }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018101900.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018101900.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3412b12c22e648866015538a78fdb36784b7d1e9",
      "candidate_info": {
        "commit_hash": "3412b12c22e648866015538a78fdb36784b7d1e9",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/3412b12c22e648866015538a78fdb36784b7d1e9",
        "files": [
          "admin/tool/assignmentupgrade/batchupgrade.php",
          "admin/tool/assignmentupgrade/classes/privacy/provider.php",
          "admin/tool/assignmentupgrade/index.php",
          "admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php",
          "admin/tool/assignmentupgrade/listnotupgraded.php",
          "admin/tool/assignmentupgrade/locallib.php",
          "admin/tool/assignmentupgrade/module.js",
          "admin/tool/assignmentupgrade/paginationform.php",
          "admin/tool/assignmentupgrade/renderer.php",
          "admin/tool/assignmentupgrade/settings.php",
          "admin/tool/assignmentupgrade/styles.css",
          "admin/tool/assignmentupgrade/tests/privacy_test.php",
          "admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php",
          "admin/tool/assignmentupgrade/upgradableassignmentstable.php",
          "admin/tool/assignmentupgrade/upgradesingle.php",
          "admin/tool/assignmentupgrade/upgradesingleconfirm.php",
          "admin/tool/assignmentupgrade/version.php",
          "admin/tool/upgrade.txt",
          "lib/classes/plugin_manager.php",
          "lib/db/upgrade.php",
          "lib/tests/plugin_manager_test.php",
          "mod/assignment/lang/en/assignment.php",
          "mod/assignment/view.php",
          "version.php"
        ],
        "message": "MDL-61041 assign: Remove assignment 2.2 upgrader",
        "before_after_code_files": [
          "admin/tool/assignmentupgrade/batchupgrade.php||admin/tool/assignmentupgrade/batchupgrade.php",
          "admin/tool/assignmentupgrade/classes/privacy/provider.php||admin/tool/assignmentupgrade/classes/privacy/provider.php",
          "admin/tool/assignmentupgrade/index.php||admin/tool/assignmentupgrade/index.php",
          "admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php||admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php",
          "admin/tool/assignmentupgrade/listnotupgraded.php||admin/tool/assignmentupgrade/listnotupgraded.php",
          "admin/tool/assignmentupgrade/locallib.php||admin/tool/assignmentupgrade/locallib.php",
          "admin/tool/assignmentupgrade/module.js||admin/tool/assignmentupgrade/module.js",
          "admin/tool/assignmentupgrade/paginationform.php||admin/tool/assignmentupgrade/paginationform.php",
          "admin/tool/assignmentupgrade/renderer.php||admin/tool/assignmentupgrade/renderer.php",
          "admin/tool/assignmentupgrade/settings.php||admin/tool/assignmentupgrade/settings.php",
          "admin/tool/assignmentupgrade/styles.css||admin/tool/assignmentupgrade/styles.css",
          "admin/tool/assignmentupgrade/tests/privacy_test.php||admin/tool/assignmentupgrade/tests/privacy_test.php",
          "admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php||admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php",
          "admin/tool/assignmentupgrade/upgradableassignmentstable.php||admin/tool/assignmentupgrade/upgradableassignmentstable.php",
          "admin/tool/assignmentupgrade/upgradesingle.php||admin/tool/assignmentupgrade/upgradesingle.php",
          "admin/tool/assignmentupgrade/upgradesingleconfirm.php||admin/tool/assignmentupgrade/upgradesingleconfirm.php",
          "admin/tool/assignmentupgrade/version.php||admin/tool/assignmentupgrade/version.php",
          "lib/classes/plugin_manager.php||lib/classes/plugin_manager.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "lib/tests/plugin_manager_test.php||lib/tests/plugin_manager_test.php",
          "mod/assignment/lang/en/assignment.php||mod/assignment/lang/en/assignment.php",
          "mod/assignment/view.php||mod/assignment/view.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/tool/assignmentupgrade/batchupgrade.php||admin/tool/assignmentupgrade/batchupgrade.php": [
          "File: admin/tool/assignmentupgrade/batchupgrade.php -> admin/tool/assignmentupgrade/batchupgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/classes/privacy/provider.php||admin/tool/assignmentupgrade/classes/privacy/provider.php": [
          "File: admin/tool/assignmentupgrade/classes/privacy/provider.php -> admin/tool/assignmentupgrade/classes/privacy/provider.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/index.php||admin/tool/assignmentupgrade/index.php": [
          "File: admin/tool/assignmentupgrade/index.php -> admin/tool/assignmentupgrade/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php||admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php": [
          "File: admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php -> admin/tool/assignmentupgrade/lang/en/tool_assignmentupgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/listnotupgraded.php||admin/tool/assignmentupgrade/listnotupgraded.php": [
          "File: admin/tool/assignmentupgrade/listnotupgraded.php -> admin/tool/assignmentupgrade/listnotupgraded.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/locallib.php||admin/tool/assignmentupgrade/locallib.php": [
          "File: admin/tool/assignmentupgrade/locallib.php -> admin/tool/assignmentupgrade/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/module.js||admin/tool/assignmentupgrade/module.js": [
          "File: admin/tool/assignmentupgrade/module.js -> admin/tool/assignmentupgrade/module.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/paginationform.php||admin/tool/assignmentupgrade/paginationform.php": [
          "File: admin/tool/assignmentupgrade/paginationform.php -> admin/tool/assignmentupgrade/paginationform.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/renderer.php||admin/tool/assignmentupgrade/renderer.php": [
          "File: admin/tool/assignmentupgrade/renderer.php -> admin/tool/assignmentupgrade/renderer.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/settings.php||admin/tool/assignmentupgrade/settings.php": [
          "File: admin/tool/assignmentupgrade/settings.php -> admin/tool/assignmentupgrade/settings.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/styles.css||admin/tool/assignmentupgrade/styles.css": [
          "File: admin/tool/assignmentupgrade/styles.css -> admin/tool/assignmentupgrade/styles.css",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/tests/privacy_test.php||admin/tool/assignmentupgrade/tests/privacy_test.php": [
          "File: admin/tool/assignmentupgrade/tests/privacy_test.php -> admin/tool/assignmentupgrade/tests/privacy_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php||admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php": [
          "File: admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php -> admin/tool/assignmentupgrade/upgradableassignmentsbatchform.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/upgradableassignmentstable.php||admin/tool/assignmentupgrade/upgradableassignmentstable.php": [
          "File: admin/tool/assignmentupgrade/upgradableassignmentstable.php -> admin/tool/assignmentupgrade/upgradableassignmentstable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/upgradesingle.php||admin/tool/assignmentupgrade/upgradesingle.php": [
          "File: admin/tool/assignmentupgrade/upgradesingle.php -> admin/tool/assignmentupgrade/upgradesingle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/upgradesingleconfirm.php||admin/tool/assignmentupgrade/upgradesingleconfirm.php": [
          "File: admin/tool/assignmentupgrade/upgradesingleconfirm.php -> admin/tool/assignmentupgrade/upgradesingleconfirm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "admin/tool/assignmentupgrade/version.php||admin/tool/assignmentupgrade/version.php": [
          "File: admin/tool/assignmentupgrade/version.php -> admin/tool/assignmentupgrade/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/classes/plugin_manager.php||lib/classes/plugin_manager.php": [
          "File: lib/classes/plugin_manager.php -> lib/classes/plugin_manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1652:             'report' => array('search'),",
          "1653:             'repository' => array('alfresco'),",
          "1654:             'tinymce' => array('dragmath'),",
          "1656:             'theme' => array('afterburner', 'anomaly', 'arialist', 'base', 'binarius', 'boxxie', 'brick', 'canvas',",
          "1657:                 'formal_white', 'formfactor', 'fusion', 'leatherbound', 'magazine', 'mymobile', 'nimble', 'nonzero',",
          "1658:                 'overlay', 'serenity', 'sky_high', 'splash', 'standard', 'standardold'),",
          "",
          "[Removed Lines]",
          "1655:             'tool' => array('bloglevelupgrade', 'qeupgradehelper', 'timezoneimport'),",
          "",
          "[Added Lines]",
          "1655:             'tool' => array('bloglevelupgrade', 'qeupgradehelper', 'timezoneimport', 'assignmentupgrade'),",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1904:             ),",
          "1906:             'tool' => array(",
          "1908:                 'dataprivacy', 'dbtransfer', 'filetypes', 'generator', 'health', 'httpsreplace', 'innodb', 'installaddon',",
          "1909:                 'langimport', 'log', 'lp', 'lpimportcsv', 'lpmigrate', 'messageinbound', 'mobile', 'multilangupgrade',",
          "1910:                 'monitor', 'oauth2', 'phpunit', 'policy', 'profiling', 'recyclebin', 'replace', 'spamcleaner', 'task',",
          "",
          "[Removed Lines]",
          "1907:                 'analytics', 'assignmentupgrade', 'availabilityconditions', 'behat', 'capability', 'cohortroles', 'customlang',",
          "",
          "[Added Lines]",
          "1907:                 'analytics', 'availabilityconditions', 'behat', 'capability', 'cohortroles', 'customlang',",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2268:         upgrade_main_savepoint(true, 2018062800.03);",
          "2269:     }",
          "2271:     return true;",
          "2272: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2271:     if ($oldversion < 2018072500.00) {",
          "2273:         if (!file_exists($CFG->dirroot . '/admin/tool/assignmentupgrade/version.php')) {",
          "2274:             unset_all_config_for_plugin('tool_assignmentupgrade');",
          "2275:         }",
          "2276:         upgrade_main_savepoint(true, 2018072500.00);",
          "2277:     }",
          "",
          "---------------"
        ],
        "lib/tests/plugin_manager_test.php||lib/tests/plugin_manager_test.php": [
          "File: lib/tests/plugin_manager_test.php -> lib/tests/plugin_manager_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "236:         global $CFG;",
          "244:     }",
          "246:     public function test_plugin_states() {",
          "",
          "[Removed Lines]",
          "239:         $this->assertFileExists(\"$CFG->dirroot/$CFG->admin/tool/assignmentupgrade\", 'assign upgrade tool is not present');",
          "240:         $this->assertFileExists(\"$CFG->dirroot/mod/assign\", 'assign module is not present');",
          "242:         $this->assertFalse(core_plugin_manager::instance()->can_uninstall_plugin('mod_assign'));",
          "243:         $this->assertTrue(core_plugin_manager::instance()->can_uninstall_plugin('tool_assignmentupgrade'));",
          "",
          "[Added Lines]",
          "239:         $this->assertFileExists(\"$CFG->dirroot/report/competency\", 'competency report is not present');",
          "240:         $this->assertFileExists(\"$CFG->dirroot/$CFG->admin/tool/lp\", 'tool lp is not present');",
          "242:         $this->assertFalse(core_plugin_manager::instance()->can_uninstall_plugin('tool_lp'));",
          "243:         $this->assertTrue(core_plugin_manager::instance()->can_uninstall_plugin('report_competency'));",
          "",
          "---------------"
        ],
        "mod/assignment/lang/en/assignment.php||mod/assignment/lang/en/assignment.php": [
          "File: mod/assignment/lang/en/assignment.php -> mod/assignment/lang/en/assignment.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: $string['assignment:grade'] = 'Grade assignment';",
          "30: $string['assignment:submit'] = 'Submit assignment';",
          "31: $string['assignment:view'] = 'View assignment';",
          "33: $string['messageprovider:assignment_updates'] = 'Assignment (2.2) notifications';",
          "34: $string['assignmentdisabled'] = 'The legacy \"Assignment 2.2\" activity is disabled.';",
          "35: $string['modulename'] = 'Assignment 2.2 (Disabled)';",
          "",
          "[Removed Lines]",
          "32: $string['assignmentneedsupgrade'] = 'The legacy \"Assignment 2.2\" activity has been disabled. Please request that your site administrator runs the assignment upgrade tool for all legacy assignments in this site.';",
          "",
          "[Added Lines]",
          "32: $string['assignmentneedsupgrade'] = 'The legacy \"Assignment 2.2\" activity has been removed.';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "40: $string['page-mod-assignment-submissions'] = 'Assignment module submission page';",
          "41: $string['pluginname'] = 'Assignment 2.2 (Disabled)';",
          "42: $string['upgradenotification'] = 'This activity is based on an older assignment module.';",
          "44: $string['pluginadministration'] = 'Assignment 2.2 (Disabled) administration';",
          "45: $string['privacy:markedsubmissionspath'] = 'markedsubmissions';",
          "46: $string['privacy:submissionpath'] = 'submission';",
          "",
          "[Removed Lines]",
          "43: $string['viewassignmentupgradetool'] = 'View the assignment upgrade tool';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "mod/assignment/view.php||mod/assignment/view.php": [
          "File: mod/assignment/view.php -> mod/assignment/view.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: require_once(\"../../config.php\");",
          "8: require_login();",
          "9: $PAGE->set_context(context_system::instance());",
          "",
          "[Removed Lines]",
          "5: $id = optional_param('id', 0, PARAM_INT);  // Course Module ID.",
          "6: $a  = optional_param('a', 0, PARAM_INT);   // Assignment ID.",
          "11: if (!$id && !$a) {",
          "12:     print_error('invalidcoursemodule');",
          "13: }",
          "15: $mapping = null;",
          "16: if ($id) {",
          "17:     $mapping = $DB->get_record('assignment_upgrade', array('oldcmid' => $id), '*', IGNORE_MISSING);",
          "18: } else {",
          "19:     $mapping = $DB->get_record('assignment_upgrade', array('oldinstance' => $a), '*', IGNORE_MISSING);",
          "20: }",
          "22: if (!$mapping) {",
          "23:     $url = '';",
          "24:     if (has_capability('moodle/site:config', context_system::instance())) {",
          "25:         $url = new moodle_url('/admin/tool/assignmentupgrade/listnotupgraded.php');",
          "26:     }",
          "27:     print_error('assignmentneedsupgrade', 'assignment', $url);",
          "28: }",
          "30: $url = new moodle_url('/mod/assign/view.php', array('id' => $mapping->newcmid));",
          "31: redirect($url);",
          "",
          "[Added Lines]",
          "8: print_error('assignmentneedsupgrade', 'assignment', '');",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018072000.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018072500.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dafcc3cf7ba5650eb73ade21c87b3677579a794e",
      "candidate_info": {
        "commit_hash": "dafcc3cf7ba5650eb73ade21c87b3677579a794e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/dafcc3cf7ba5650eb73ade21c87b3677579a794e",
        "files": [
          "version.php"
        ],
        "message": "on-demand release 3.7dev+",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "38: $branch   = '37';                       // This version's branch.",
          "39: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2019040600.04;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.7dev+ (Build: 20190406)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2019041000.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.7dev+ (Build: 20190410)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    }
  ]
}