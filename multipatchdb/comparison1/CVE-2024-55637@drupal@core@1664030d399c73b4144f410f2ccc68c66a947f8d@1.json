{
  "cve_id": "CVE-2024-55637",
  "cve_desc": "Deserialization of Untrusted Data vulnerability in Drupal Core allows Object Injection.This issue affects Drupal Core: from 8.0.0 before 10.2.11, from 10.3.0 before 10.3.9, from 11.0.0 before 11.0.8.\n\nDrupal core contains a chain of methods that is exploitable when an insecure deserialization vulnerability exists on the site. This so-called gadget chain presents no direct threat but is a vector that can be used to achieve remote code execution if the application deserializes untrusted data due to another vulnerability.",
  "repo": "drupal/core",
  "patch_hash": "1664030d399c73b4144f410f2ccc68c66a947f8d",
  "patch_info": {
    "commit_hash": "1664030d399c73b4144f410f2ccc68c66a947f8d",
    "repo": "drupal/core",
    "commit_url": "https://github.com/drupal/core/commit/1664030d399c73b4144f410f2ccc68c66a947f8d",
    "files": [
      "modules/views/src/ViewExecutable.php"
    ],
    "message": "SA-CORE-2024-007 by mcdruid, larowlan",
    "before_after_code_files": [
      "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
    ]
  },
  "patch_diff": {
    "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
      "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
      "9: use Drupal\\Core\\Session\\AccountInterface;",
      "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
      "11: use Drupal\\views\\Plugin\\ViewsPluginManager;",
      "12: use Symfony\\Component\\HttpFoundation\\Request;",
      "13: use Symfony\\Component\\HttpFoundation\\Response;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "222:   public $query = NULL;",
      "",
      "[Added Lines]",
      "223:   public ?QueryPluginBase $query = NULL;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ebcb799d83cbffe843a99c1907afd1b1fc880ce3",
      "candidate_info": {
        "commit_hash": "ebcb799d83cbffe843a99c1907afd1b1fc880ce3",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/ebcb799d83cbffe843a99c1907afd1b1fc880ce3",
        "files": [
          "modules/views/src/ViewExecutable.php"
        ],
        "message": "SA-CORE-2024-007 by mcdruid, larowlan",
        "before_after_code_files": [
          "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ],
          "candidate": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ]
        }
      },
      "candidate_diff": {
        "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
          "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
          "9: use Drupal\\Core\\Session\\AccountInterface;",
          "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
          "11: use Drupal\\views\\Plugin\\ViewsPluginManager;",
          "12: use Symfony\\Component\\HttpFoundation\\Request;",
          "13: use Symfony\\Component\\HttpFoundation\\Response;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "222:   public $query = NULL;",
          "",
          "[Added Lines]",
          "223:   public ?QueryPluginBase $query = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f720056eed2007b8ccfccb013b6a2b84778e0cf0",
      "candidate_info": {
        "commit_hash": "f720056eed2007b8ccfccb013b6a2b84778e0cf0",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/f720056eed2007b8ccfccb013b6a2b84778e0cf0",
        "files": [
          "modules/views/src/ViewExecutable.php"
        ],
        "message": "SA-CORE-2024-007 by mcdruid, larowlan",
        "before_after_code_files": [
          "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ],
          "candidate": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ]
        }
      },
      "candidate_diff": {
        "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
          "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
          "9: use Drupal\\Core\\Session\\AccountInterface;",
          "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
          "11: use Drupal\\views\\Plugin\\ViewsPluginManager;",
          "12: use Symfony\\Component\\HttpFoundation\\Request;",
          "13: use Symfony\\Component\\HttpFoundation\\Response;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "222:   public $query = NULL;",
          "",
          "[Added Lines]",
          "223:   public ?QueryPluginBase $query = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9bbab5ace8827d00e868a16126e1491b3e59c63b",
      "candidate_info": {
        "commit_hash": "9bbab5ace8827d00e868a16126e1491b3e59c63b",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/9bbab5ace8827d00e868a16126e1491b3e59c63b",
        "files": [
          "modules/views/src/ViewExecutable.php"
        ],
        "message": "SA-CORE-2024-007 by mcdruid, larowlan",
        "before_after_code_files": [
          "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ],
          "candidate": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ]
        }
      },
      "candidate_diff": {
        "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
          "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
          "9: use Drupal\\Core\\Session\\AccountInterface;",
          "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
          "11: use Drupal\\views\\Plugin\\ViewsPluginManager;",
          "12: use Symfony\\Component\\HttpFoundation\\Request;",
          "13: use Symfony\\Component\\HttpFoundation\\Response;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "222:   public $query = NULL;",
          "",
          "[Added Lines]",
          "223:   public ?QueryPluginBase $query = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8c9e92b45a76e209806c8730d603d08971be0525",
      "candidate_info": {
        "commit_hash": "8c9e92b45a76e209806c8730d603d08971be0525",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/8c9e92b45a76e209806c8730d603d08971be0525",
        "files": [
          "modules/views/src/ViewExecutable.php"
        ],
        "message": "SA-CORE-2024-007 by mcdruid, larowlan",
        "before_after_code_files": [
          "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ],
          "candidate": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ]
        }
      },
      "candidate_diff": {
        "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
          "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
          "9: use Drupal\\Core\\Session\\AccountInterface;",
          "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
          "11: use Drupal\\views\\Plugin\\ViewsPluginManager;",
          "12: use Symfony\\Component\\HttpFoundation\\Request;",
          "13: use Symfony\\Component\\HttpFoundation\\Response;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "222:   public $query = NULL;",
          "",
          "[Added Lines]",
          "223:   public ?QueryPluginBase $query = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a126a985908062103c2aab058b23fbbc2c0fbf91",
      "candidate_info": {
        "commit_hash": "a126a985908062103c2aab058b23fbbc2c0fbf91",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/a126a985908062103c2aab058b23fbbc2c0fbf91",
        "files": [
          "modules/views/src/ViewExecutable.php"
        ],
        "message": "SA-CORE-2024-007 by mcdruid, larowlan",
        "before_after_code_files": [
          "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ],
          "candidate": [
            "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php"
          ]
        }
      },
      "candidate_diff": {
        "modules/views/src/ViewExecutable.php||modules/views/src/ViewExecutable.php": [
          "File: modules/views/src/ViewExecutable.php -> modules/views/src/ViewExecutable.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: use Drupal\\Core\\Routing\\RouteProviderInterface;",
          "9: use Drupal\\Core\\Session\\AccountInterface;",
          "10: use Drupal\\views\\Plugin\\views\\display\\DisplayRouterInterface;",
          "11: use Symfony\\Component\\HttpFoundation\\Request;",
          "12: use Symfony\\Component\\HttpFoundation\\Response;",
          "13: use Symfony\\Component\\Routing\\Exception\\RouteNotFoundException;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: use Drupal\\views\\Plugin\\views\\query\\QueryPluginBase;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "202:   public $query = NULL;",
          "",
          "[Added Lines]",
          "203:   public ?QueryPluginBase $query = NULL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}