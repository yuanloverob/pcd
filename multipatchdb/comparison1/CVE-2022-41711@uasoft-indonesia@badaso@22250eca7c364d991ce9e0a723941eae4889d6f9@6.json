{
  "cve_id": "CVE-2022-41711",
  "cve_desc": "Badaso version 2.6.0 allows an unauthenticated remote attacker to execute arbitrary code remotely on the server. This is possible because the application does not properly validate the data uploaded by users.",
  "repo": "uasoft-indonesia/badaso",
  "patch_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
  "patch_info": {
    "commit_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
    "repo": "uasoft-indonesia/badaso",
    "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/22250eca7c364d991ce9e0a723941eae4889d6f9",
    "files": [
      "src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue"
    ],
    "message": "Merge pull request #807 from uasoft-indonesia/bugfix/v2/filter-mimeType\n\nBugfix[v2] add filter mimeType",
    "before_after_code_files": [
      "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue"
    ]
  },
  "patch_diff": {
    "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue": [
      "File: src/resources/js/components/BadasoUploadFile.vue -> src/resources/js/components/BadasoUploadFile.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "336:           });",
      "337:           return;",
      "338:         }",
      "340:         this.uploadFile(files[0]);",
      "341:       }",
      "342:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "339:         if (!this.availableMimetypes.file.validMime.includes(files[0].type)) {",
      "340:           this.$vs.notify({",
      "341:             title: this.$t(\"alert.danger\"),",
      "342:             text: \"File type not allowed\",",
      "343:             color: \"danger\",",
      "344:           });",
      "345:           return;",
      "346:         }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadFileMultiple.vue -> src/resources/js/components/BadasoUploadFileMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             });",
      "368:             return;",
      "369:           }",
      "371:           this.uploadFile(file);",
      "372:         }",
      "373:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:           if (!this.availableMimetypes.file.validMime.includes(file.type)) {",
      "371:             this.$vs.notify({",
      "372:               title: this.$t(\"alert.danger\"),",
      "373:               text: \"File type not allowed\",",
      "374:               color: \"danger\",",
      "375:             });",
      "376:             return;",
      "377:           }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue": [
      "File: src/resources/js/components/BadasoUploadImage.vue -> src/resources/js/components/BadasoUploadImage.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "380:           });",
      "381:           return;",
      "382:         }",
      "384:         this.uploadImage(files[0]);",
      "385:       }",
      "386:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "383:         if (!this.availableMimetypes.image.validMime.includes(files[0].type)){",
      "384:           this.$vs.notify({",
      "385:             title: this.$t(\"alert.danger\"),",
      "386:             text: \"File type not allowed\",",
      "387:             color: \"danger\",",
      "388:           });",
      "389:           return;",
      "390:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:     uploadImage(file) {",
      "422:       const files = new FormData();",
      "423:       files.append(\"upload\", file);",
      "425:       files.append(\"working_dir\", this.getActiveFolder);",
      "426:       this.$api.badasoFile",
      "427:         .uploadUsingLfm(files)",
      "",
      "[Removed Lines]",
      "424:       files.append(\"type\", \"image\");",
      "",
      "[Added Lines]",
      "431:       files.append(\"type\", file.type);",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadImageMultiple.vue -> src/resources/js/components/BadasoUploadImageMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "395:             });",
      "396:             return;",
      "397:           }",
      "399:           this.uploadImage(file);",
      "400:         }",
      "401:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "398:           if (!this.availableMimetypes.image.validMime.includes(file.type)) {",
      "399:             this.$vs.notify({",
      "400:               title: this.$t(\"alert.danger\"),",
      "401:               text: \"File type not allowed\",",
      "402:               color: \"danger\",",
      "403:             });",
      "404:             return;",
      "405:           }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "263e80aef04fe456474f3691798a60e026d2bda3",
      "candidate_info": {
        "commit_hash": "263e80aef04fe456474f3691798a60e026d2bda3",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/263e80aef04fe456474f3691798a60e026d2bda3",
        "files": [
          "src/Commands/BadasoTestSetup.php"
        ],
        "message": "update setup",
        "before_after_code_files": [
          "src/Commands/BadasoTestSetup.php||src/Commands/BadasoTestSetup.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Commands/BadasoTestSetup.php||src/Commands/BadasoTestSetup.php": [
          "File: src/Commands/BadasoTestSetup.php -> src/Commands/BadasoTestSetup.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "48:             <testsuites>",
          "49:                 <testsuite name=\"Unit\">",
          "50:                     <directory suffix=\"Test.php\">./tests/Unit</directory>",
          "52:                 </testsuite>",
          "53:                 <testsuite name=\"Feature\">",
          "54:                     <directory suffix=\"Test.php\">./tests/Feature</directory>",
          "56:                 </testsuite>",
          "57:             </testsuites>",
          "58:             <coverage processUncoveredFiles=\"true\">",
          "59:                 <include>",
          "60:                     <directory suffix=\".php\">./app</directory>",
          "77:                 </include>",
          "78:             </coverage>",
          "79:             <php>",
          "",
          "[Removed Lines]",
          "51:                     <directory suffix=\"Test.php\">./packages/badaso/core/tests/Unit</directory>",
          "55:                     <directory suffix=\"Test.php\">./packages/badaso/core/tests/Feature</directory>",
          "61:                     <directory suffix=\".php\">./packages/badaso/core/src/Commands</directory>",
          "62:                     <directory suffix=\".php\">./packages/badaso/core/src/Controllers</directory>",
          "63:                     <directory suffix=\".php\">./packages/badaso/core/src/ContentManager</directory>",
          "64:                     <directory suffix=\".php\">./packages/badaso/core/src/Events</directory>",
          "65:                     <directory suffix=\".php\">./packages/badaso/core/src/Exceptions</directory>",
          "66:                     <directory suffix=\".php\">./packages/badaso/core/src/Helpers</directory>",
          "67:                     <directory suffix=\".php\">./packages/badaso/core/src/Listeners</directory>",
          "68:                     <directory suffix=\".php\">./packages/badaso/core/src/Mail</directory>",
          "69:                     <directory suffix=\".php\">./packages/badaso/core/src/Middleware</directory>",
          "70:                     <directory suffix=\".php\">./packages/badaso/core/src/Models</directory>",
          "71:                     <directory suffix=\".php\">./packages/badaso/core/src/OrchestratorHandlers</directory>",
          "72:                     <directory suffix=\".php\">./packages/badaso/core/src/Providers</directory>",
          "73:                     <directory suffix=\".php\">./packages/badaso/core/src/Routes</directory>",
          "74:                     <directory suffix=\".php\">./packages/badaso/core/src/Traits</directory>",
          "75:                     <directory suffix=\".php\">./packages/badaso/core/src/Widgets</directory>",
          "76:                     <directory suffix=\".php\">./packages/badaso/core/src/Badaso.php</directory>",
          "",
          "[Added Lines]",
          "51:                     <directory suffix=\"Test.php\">./vendor/badaso/core/tests/Unit</directory>",
          "55:                     <directory suffix=\"Test.php\">./vendor/badaso/core/tests/Feature</directory>",
          "61:                     <directory suffix=\".php\">./vendor/badaso/core/src/Commands</directory>",
          "62:                     <directory suffix=\".php\">./vendor/badaso/core/src/Controllers</directory>",
          "63:                     <directory suffix=\".php\">./vendor/badaso/core/src/ContentManager</directory>",
          "64:                     <directory suffix=\".php\">./vendor/badaso/core/src/Events</directory>",
          "65:                     <directory suffix=\".php\">./vendor/badaso/core/src/Exceptions</directory>",
          "66:                     <directory suffix=\".php\">./vendor/badaso/core/src/Helpers</directory>",
          "67:                     <directory suffix=\".php\">./vendor/badaso/core/src/Listeners</directory>",
          "68:                     <directory suffix=\".php\">./vendor/badaso/core/src/Mail</directory>",
          "69:                     <directory suffix=\".php\">./vendor/badaso/core/src/Middleware</directory>",
          "70:                     <directory suffix=\".php\">./vendor/badaso/core/src/Models</directory>",
          "71:                     <directory suffix=\".php\">./vendor/badaso/core/src/OrchestratorHandlers</directory>",
          "72:                     <directory suffix=\".php\">./vendor/badaso/core/src/Providers</directory>",
          "73:                     <directory suffix=\".php\">./vendor/badaso/core/src/Routes</directory>",
          "74:                     <directory suffix=\".php\">./vendor/badaso/core/src/Traits</directory>",
          "75:                     <directory suffix=\".php\">./vendor/badaso/core/src/Widgets</directory>",
          "76:                     <directory suffix=\".php\">./vendor/badaso/core/src/Badaso.php</directory>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9a0e4be4adca8f746b49af3dff44679f7c29fdb1",
      "candidate_info": {
        "commit_hash": "9a0e4be4adca8f746b49af3dff44679f7c29fdb1",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/9a0e4be4adca8f746b49af3dff44679f7c29fdb1",
        "files": [
          "tests/Feature/BadasoApiCrudManagementTest.php"
        ],
        "message": "Apply fixes from StyleCI",
        "before_after_code_files": [
          "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php": [
          "File: tests/Feature/BadasoApiCrudManagementTest.php -> tests/Feature/BadasoApiCrudManagementTest.php"
        ]
      }
    },
    {
      "candidate_hash": "e599970abce7256dcad609fea2464ff472e545eb",
      "candidate_info": {
        "commit_hash": "e599970abce7256dcad609fea2464ff472e545eb",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/e599970abce7256dcad609fea2464ff472e545eb",
        "files": [
          "src/resources/js/lang/modules/id.js"
        ],
        "message": "update unit test apiCrudManagement",
        "before_after_code_files": [
          "src/resources/js/lang/modules/id.js||src/resources/js/lang/modules/id.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/lang/modules/id.js||src/resources/js/lang/modules/id.js": [
          "File: src/resources/js/lang/modules/id.js -> src/resources/js/lang/modules/id.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1041:           \"Pastikan tabel belum dibuat dengan CRUD Management jika ingin mengedit atau menghapus tabel.\",",
          "1043:         fieldAttUnsigned: \"Batasan kunci asing salah dibentuk. {0} untuk mengunjungi dokumentasi\",",
          "1048:         visitDocs: \"Klik Disini\",",
          "1049:       },",
          "1050:       error: {",
          "",
          "[Removed Lines]",
          "1044: <<<<<<< HEAD",
          "1045: =======",
          "1046:         fieldAttUnsigned: \"Foreign key constraint is incorrectly formed. {0} to visit docs.\",",
          "1047: >>>>>>> a1a682b8a68046ebfeefbace1e9846355b266667",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "27fbb59fba6017008ec8de782056d83359e72bb6",
      "candidate_info": {
        "commit_hash": "27fbb59fba6017008ec8de782056d83359e72bb6",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/27fbb59fba6017008ec8de782056d83359e72bb6",
        "files": [
          "src/Config/lfm.php"
        ],
        "message": "bugfix [v2] remove format svg",
        "before_after_code_files": [
          "src/Config/lfm.php||src/Config/lfm.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Config/lfm.php||src/Config/lfm.php": [
          "File: src/Config/lfm.php -> src/Config/lfm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "67:                 'image/pjpeg',",
          "68:                 'image/png',",
          "69:                 'image/gif',",
          "71:             ],",
          "72:         ],",
          "73:     ],",
          "",
          "[Removed Lines]",
          "70:                 'image/svg+xml',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "da590d2f4752de64f798111340da9e9831b13863",
      "candidate_info": {
        "commit_hash": "da590d2f4752de64f798111340da9e9831b13863",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/da590d2f4752de64f798111340da9e9831b13863",
        "files": [
          "tests/Feature/BadasoApiCrudManagementTest.php"
        ],
        "message": "commit",
        "before_after_code_files": [
          "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/Feature/BadasoApiCrudManagementTest.php||tests/Feature/BadasoApiCrudManagementTest.php": [
          "File: tests/Feature/BadasoApiCrudManagementTest.php -> tests/Feature/BadasoApiCrudManagementTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1753:         $tables = CallHelperTest::getCache($this->KEY_LIST_CREATE_EMPTY_TABLES);",
          "1754:         $first_table = $tables[0];",
          "1757:         $response_read_table_entities = CallHelperTest::getCache($this->KEY_DATA_RESPONSE_READ_EMPTY_TABLE_ENTITY);",
          "1758:         $fields = [];",
          "",
          "[Removed Lines]",
          "1755:         dd($first_table);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1784:                 $response = CallHelperTest::withAuthorizeBearer($this)->json('POST', CallHelperTest::getUrlApiV1Prefix(\"/entities/{$table}/add\"), [",
          "1785:                     'data' => $data,",
          "1786:                 ]);",
          "1788:                 $response->assertSuccessful();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1786:                 dd($response);",
          "",
          "---------------"
        ]
      }
    }
  ]
}