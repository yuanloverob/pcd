{
  "cve_id": "CVE-2020-11056",
  "cve_desc": "In Sprout Forms before 3.9.0, there is a potential Server-Side Template Injection vulnerability when using custom fields in Notification Emails which could lead to the execution of Twig code. This has been fixed in 3.9.0.",
  "repo": "barrelstrength/craft-sprout-base-email",
  "patch_hash": "5ef759f4713ede6dbf77c9d9df9f992876e43a49",
  "patch_info": {
    "commit_hash": "5ef759f4713ede6dbf77c9d9df9f992876e43a49",
    "repo": "barrelstrength/craft-sprout-base-email",
    "commit_url": "https://github.com/barrelstrength/craft-sprout-base-email/commit/5ef759f4713ede6dbf77c9d9df9f992876e43a49",
    "files": [
      "src/base/EmailElement.php",
      "src/base/EmailTemplates.php",
      "src/emailtemplates/BasicTemplates.php",
      "src/emailtemplates/CustomTemplates.php"
    ],
    "message": "Refactor Email Templates to treat /templates folder as base folder when rendering\n\n- Adds getTemplateRoot to barrelstrength\\sproutbaseemail\\base\\EmailTemplates\n- Updates Basic Email Templates to implement getTemplateRoot and new getPath behavior\n- Updates Custom Email Templates to implement getTemplateRoot and new getPath behavior\n\nhttps://github.com/barrelstrength/craft-sprout-email/issues/111\nhttps://github.com/barrelstrength/craft-sprout-email/issues/122",
    "before_after_code_files": [
      "src/base/EmailElement.php||src/base/EmailElement.php",
      "src/base/EmailTemplates.php||src/base/EmailTemplates.php",
      "src/emailtemplates/BasicTemplates.php||src/emailtemplates/BasicTemplates.php",
      "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php"
    ]
  },
  "patch_diff": {
    "src/base/EmailElement.php||src/base/EmailElement.php": [
      "File: src/base/EmailElement.php -> src/base/EmailElement.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "196:                     $emailTemplates = new $settings->emailTemplateId();",
      "197:                 } else {",
      "201:                     $emailTemplates = new CustomTemplates();",
      "202:                     $emailTemplates->setPath($templatePath);",
      "",
      "[Removed Lines]",
      "199:                     $templatePath = $sitePath.DIRECTORY_SEPARATOR.$settings->emailTemplateId;",
      "",
      "[Added Lines]",
      "199:                     $templatePath = $settings->emailTemplateId;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "223:         if ($isCustom) {",
      "227:             $emailTemplates = new CustomTemplates();",
      "228:             $emailTemplates->setPath($templatePath);",
      "",
      "[Removed Lines]",
      "225:             $templatePath = $sitePath.DIRECTORY_SEPARATOR.$emailTemplateId;",
      "",
      "[Added Lines]",
      "225:             $templatePath = $emailTemplateId;",
      "",
      "---------------"
    ],
    "src/base/EmailTemplates.php||src/base/EmailTemplates.php": [
      "File: src/base/EmailTemplates.php -> src/base/EmailTemplates.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: namespace barrelstrength\\sproutbaseemail\\base;",
      "5: use Craft;",
      "6: use League\\HTMLToMarkdown\\HtmlConverter;",
      "7: use Twig\\Error\\LoaderError;",
      "8: use Twig\\Error\\RuntimeError;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5: use barrelstrength\\sproutbaseemail\\emailtemplates\\CustomTemplates;",
      "7: use craft\\web\\View;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "37:     abstract public function getName(): string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "46:     abstract public function getTemplateRoot(): string;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "103:     {",
      "104:         $view = Craft::$app->getView();",
      "105:         $oldTemplatePath = $view->getTemplatesPath();",
      "113:         foreach (Craft::$app->getConfig()->getGeneral()->defaultTemplateExtensions as $extension) {",
      "116:             if (Craft::$app->getView()->doesTemplateExist($templateName)) {",
      "117:                 $htmlEmailTemplate = $templateName;",
      "",
      "[Removed Lines]",
      "106:         $view->setTemplatesPath($this->getPath());",
      "109:         $htmlEmailTemplate = 'email.html';",
      "110:         $textEmailTemplate = 'email.txt';",
      "114:             $templateName = 'email.'.$extension;",
      "",
      "[Added Lines]",
      "116:         $view->setTemplatesPath($this->getTemplateRoot());",
      "118:         $htmlEmailTemplate = null;",
      "119:         $textEmailTemplate = $this->getPath().'/email.txt';",
      "123:             $templateName = $this->getPath().'/email.'.$extension;",
      "",
      "---------------"
    ],
    "src/emailtemplates/BasicTemplates.php||src/emailtemplates/BasicTemplates.php": [
      "File: src/emailtemplates/BasicTemplates.php -> src/emailtemplates/BasicTemplates.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "18:         return Craft::t('sprout-base-email', 'Basic Notification (Sprout Email)');",
      "19:     }",
      "24:     public function getPath(): string",
      "25:     {",
      "27:     }",
      "28: }",
      "",
      "[Removed Lines]",
      "26:         return Craft::getAlias('@sproutbaseemail/templates/_components/emailtemplates/basic');",
      "",
      "[Added Lines]",
      "21:     public function getTemplateRoot(): string",
      "22:     {",
      "23:         return Craft::getAlias('@sproutbaseemail/templates');",
      "24:     }",
      "31:         return '_components/emailtemplates/basic';",
      "",
      "---------------"
    ],
    "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php": [
      "File: src/emailtemplates/CustomTemplates.php -> src/emailtemplates/CustomTemplates.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: use barrelstrength\\sproutbaseemail\\base\\EmailTemplates;",
      "6: use Craft;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7: use craft\\web\\View;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "28:         return Craft::t('sprout-base-email', 'Custom Templates');",
      "29:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32:     public function getTemplateRoot(): string",
      "33:     {",
      "34:         return Craft::$app->getView()->getTemplatesPath();",
      "35:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6c3531f0f4f19e7e3742725a0f9736bea5174329",
      "candidate_info": {
        "commit_hash": "6c3531f0f4f19e7e3742725a0f9736bea5174329",
        "repo": "barrelstrength/craft-sprout-base-email",
        "commit_url": "https://github.com/barrelstrength/craft-sprout-base-email/commit/6c3531f0f4f19e7e3742725a0f9736bea5174329",
        "files": [
          "src/base/EmailElement.php"
        ],
        "message": "Update Email Template assignment logic",
        "before_after_code_files": [
          "src/base/EmailElement.php||src/base/EmailElement.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/base/EmailElement.php||src/base/EmailElement.php"
          ],
          "candidate": [
            "src/base/EmailElement.php||src/base/EmailElement.php"
          ]
        }
      },
      "candidate_diff": {
        "src/base/EmailElement.php||src/base/EmailElement.php": [
          "File: src/base/EmailElement.php -> src/base/EmailElement.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use barrelstrength\\sproutbaseemail\\emailtemplates\\BasicTemplates;",
          "6: use barrelstrength\\sproutbaseemail\\emailtemplates\\CustomTemplates;",
          "7: use barrelstrength\\sproutbaseemail\\mailers\\DefaultMailer;",
          "9: use Craft;",
          "10: use craft\\base\\Element;",
          "11: use craft\\base\\Field;",
          "",
          "[Removed Lines]",
          "8: use barrelstrength\\sproutbaseemail\\models\\Settings;",
          "",
          "[Added Lines]",
          "8: use barrelstrength\\sproutbaseemail\\SproutBaseEmail;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "178:         }",
          "183:         $settings = SproutBaseEmail::$app->settings->getEmailSettings();",
          "203:             }",
          "204:         }",
          "",
          "[Removed Lines]",
          "181:         $emailTemplates = new BasicTemplates();",
          "186:         if ($sproutEmail) {",
          "190:             $settings = $sproutEmail->getSettings();",
          "192:             if ($settings->emailTemplateId) {",
          "194:                 if ($settings->emailTemplateId instanceof EmailTemplates) {",
          "195:                     $emailTemplates = new $settings->emailTemplateId();",
          "196:                 } else {",
          "198:                     $templatePath = $settings->emailTemplateId;",
          "200:                     $emailTemplates = new CustomTemplates();",
          "201:                     $emailTemplates->setPath($templatePath);",
          "202:                 }",
          "",
          "[Added Lines]",
          "180:         $emailTemplates = '';",
          "185:         if ($settings->emailTemplateId) {",
          "186:             if (class_exists($settings->emailTemplateId)) {",
          "187:                 $emailTemplates = new $settings->emailTemplateId();",
          "188:             }",
          "190:             if (!$emailTemplates instanceof EmailTemplates) {",
          "192:                 $templatePath = $settings->emailTemplateId;",
          "194:                 $emailTemplates = new CustomTemplates();",
          "195:                 $emailTemplates->setPath($templatePath);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e2b8f21e12e9ca0ccc99abd6407e54fc962b0877",
      "candidate_info": {
        "commit_hash": "e2b8f21e12e9ca0ccc99abd6407e54fc962b0877",
        "repo": "barrelstrength/craft-sprout-base-email",
        "commit_url": "https://github.com/barrelstrength/craft-sprout-base-email/commit/e2b8f21e12e9ca0ccc99abd6407e54fc962b0877",
        "files": [
          "src/emailtemplates/CustomTemplates.php"
        ],
        "message": "Fixes CustomTemplates Email Template path",
        "before_after_code_files": [
          "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php"
          ],
          "candidate": [
            "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php"
          ]
        }
      },
      "candidate_diff": {
        "src/emailtemplates/CustomTemplates.php||src/emailtemplates/CustomTemplates.php": [
          "File: src/emailtemplates/CustomTemplates.php -> src/emailtemplates/CustomTemplates.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use barrelstrength\\sproutbaseemail\\base\\EmailTemplates;",
          "6: use Craft;",
          "7: use craft\\web\\View;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: use yii\\base\\Exception;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "34:         return View::TEMPLATE_MODE_SITE;",
          "35:     }",
          "37:     public function getTemplateRoot(): string",
          "38:     {",
          "40:     }",
          "",
          "[Removed Lines]",
          "39:         return Craft::$app->getView()->getTemplatesPath();",
          "",
          "[Added Lines]",
          "44:         return Craft::$app->path->getSiteTemplatesPath();",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ac01ed2d7555c27e6d7b8b2c61b26b38de5c7847",
      "candidate_info": {
        "commit_hash": "ac01ed2d7555c27e6d7b8b2c61b26b38de5c7847",
        "repo": "barrelstrength/craft-sprout-base-email",
        "commit_url": "https://github.com/barrelstrength/craft-sprout-base-email/commit/ac01ed2d7555c27e6d7b8b2c61b26b38de5c7847",
        "files": [
          "src/base/EmailTemplates.php",
          "src/base/SenderTrait.php",
          "src/mailers/DefaultMailer.php",
          "src/services/Mailers.php",
          "src/translations/en/sprout-base-email.php",
          "src/web/assets/email/src/js/sprout-modal.js",
          "src/web/assets/email/src/scss/modal.scss"
        ],
        "message": "Code cleanup",
        "before_after_code_files": [
          "src/base/EmailTemplates.php||src/base/EmailTemplates.php",
          "src/base/SenderTrait.php||src/base/SenderTrait.php",
          "src/mailers/DefaultMailer.php||src/mailers/DefaultMailer.php",
          "src/services/Mailers.php||src/services/Mailers.php",
          "src/translations/en/sprout-base-email.php||src/translations/en/sprout-base-email.php",
          "src/web/assets/email/src/js/sprout-modal.js||src/web/assets/email/src/js/sprout-modal.js",
          "src/web/assets/email/src/scss/modal.scss||src/web/assets/email/src/scss/modal.scss"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/base/EmailTemplates.php||src/base/EmailTemplates.php"
          ],
          "candidate": [
            "src/base/EmailTemplates.php||src/base/EmailTemplates.php"
          ]
        }
      },
      "candidate_diff": {
        "src/base/EmailTemplates.php||src/base/EmailTemplates.php": [
          "File: src/base/EmailTemplates.php -> src/base/EmailTemplates.php"
        ],
        "src/base/SenderTrait.php||src/base/SenderTrait.php": [
          "File: src/base/SenderTrait.php -> src/base/SenderTrait.php"
        ],
        "src/mailers/DefaultMailer.php||src/mailers/DefaultMailer.php": [
          "File: src/mailers/DefaultMailer.php -> src/mailers/DefaultMailer.php"
        ],
        "src/services/Mailers.php||src/services/Mailers.php": [
          "File: src/services/Mailers.php -> src/services/Mailers.php"
        ],
        "src/translations/en/sprout-base-email.php||src/translations/en/sprout-base-email.php": [
          "File: src/translations/en/sprout-base-email.php -> src/translations/en/sprout-base-email.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "129:     'List' => 'List',",
          "130:     'Always' => 'Always',",
          "131:     'Send Rule <span class=\\'info\\'>Defines how to check a form submission to determine if a user has opted in to have data sent to this Integration. The Integration will be sent if the setting is set to \\'Always\\'; if the Custom Rule is used and evaluates to \\'1\\', \\'true\\', \\'on\\', or \\'yes\\'. If none of those conditions are met, the Event will not be sent.</span>' => 'Send Rule <span class=\\'info\\'>Defines how to check a form submission to determine if a user has opted in to have data sent to this Integration. The Integration will be sent if the setting is set to \\'Always\\'; if the Custom Rule is used and evaluates to \\'1\\', \\'true\\', \\'on\\', or \\'yes\\'. If none of those conditions are met, the Event will not be sent.</span>',",
          "133: ];",
          "",
          "[Removed Lines]",
          "132:     'Cleaning up Sent Email' => 'Cleaning up Sent Email'",
          "",
          "[Added Lines]",
          "132:     'Cleaning up Sent Email' => 'Cleaning up Sent Email',",
          "133:     'Notification Emails' => 'Notification Emails'",
          "",
          "---------------"
        ],
        "src/web/assets/email/src/js/sprout-modal.js||src/web/assets/email/src/js/sprout-modal.js": [
          "File: src/web/assets/email/src/js/sprout-modal.js -> src/web/assets/email/src/js/sprout-modal.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:     $actions.on('click', function(e) {",
          "120:       e.preventDefault();",
          "124:       if ($self.hasClass('preventAction')) {",
          "125:         $self.removeClass('preventAction');",
          "",
          "[Removed Lines]",
          "122:       var $self = $(e.target);",
          "",
          "[Added Lines]",
          "122:       let $self = $(e.target);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "137:         data = $.extend(data, recipients);",
          "138:       }",
          "140:       $spin.show();",
          "141:       self.postToControllerAction(data, function handleResponse(error, response) {",
          "142:         $spin.hide();",
          "",
          "[Removed Lines]",
          "139:       $spin = $self.parents('.footer').find('.send-spinner');",
          "",
          "[Added Lines]",
          "139:       let $spin = $self.parents('.footer').find('.send-spinner');",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "192:       $('.btnSelectAll', content).off().on('click', function(event) {",
          "193:         event.preventDefault();",
          "202:         document.execCommand('copy');",
          "",
          "[Removed Lines]",
          "195:         $this = $(event.target);",
          "196:         $target = '#' + $this.data('clipboard-target-id');",
          "197:         $message = $this.data('success-message');",
          "199:         $content = $($target).select();",
          "",
          "[Added Lines]",
          "195:         let $this = $(event.target);",
          "196:         let $target = '#' + $this.data('clipboard-target-id');",
          "197:         let $message = $this.data('success-message');",
          "199:         let $content = $($target).select();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "212:       e.preventDefault();",
          "217:       window.open($previewUrl, 'newwindow', 'width=920, height=600');",
          "",
          "[Removed Lines]",
          "214:       $this = $(e.target);",
          "215:       $previewUrl = $this.data('preview-url');",
          "",
          "[Added Lines]",
          "214:       let $this = $(e.target);",
          "215:       let $previewUrl = $this.data('preview-url');",
          "",
          "---------------"
        ],
        "src/web/assets/email/src/scss/modal.scss||src/web/assets/email/src/scss/modal.scss": [
          "File: src/web/assets/email/src/scss/modal.scss -> src/web/assets/email/src/scss/modal.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "69: #sproutmodal .send-spinner.spinner {",
          "70:     display: none;",
          "71:     height: 24px;",
          "73:     margin: 0 auto;",
          "74:     position: absolute;",
          "75:     top: 5px;",
          "",
          "[Removed Lines]",
          "72:     left: 40%",
          "",
          "[Added Lines]",
          "72:     left: 40%;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a34901a6c237c885691d018dfa3302a185b89b00",
      "candidate_info": {
        "commit_hash": "a34901a6c237c885691d018dfa3302a185b89b00",
        "repo": "barrelstrength/craft-sprout-base-email",
        "commit_url": "https://github.com/barrelstrength/craft-sprout-base-email/commit/a34901a6c237c885691d018dfa3302a185b89b00",
        "files": [
          "src/base/EmailTemplates.php",
          "src/base/RecipientsTrait.php",
          "src/base/SenderTrait.php",
          "src/controllers/NotificationsController.php",
          "src/elements/NotificationEmail.php",
          "src/elements/db/NotificationEmailQuery.php",
          "src/mailers/DefaultMailer.php",
          "src/migrations/m180501_000005_update_copypaste_type.php",
          "src/migrations/m190212_000004_add_sent_email_foreign_key.php",
          "src/migrations/m190220_000000_clean_up_sent_email_records.php",
          "src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php",
          "src/services/Mailers.php",
          "src/templates/notifications/_edit.twig",
          "src/translations/en/sprout-base-email.php",
          "src/web/assets/email/src/scss/sproutemail.scss"
        ],
        "message": "Code cleanup",
        "before_after_code_files": [
          "src/base/EmailTemplates.php||src/base/EmailTemplates.php",
          "src/base/RecipientsTrait.php||src/base/RecipientsTrait.php",
          "src/base/SenderTrait.php||src/base/SenderTrait.php",
          "src/controllers/NotificationsController.php||src/controllers/NotificationsController.php",
          "src/elements/NotificationEmail.php||src/elements/NotificationEmail.php",
          "src/elements/db/NotificationEmailQuery.php||src/elements/db/NotificationEmailQuery.php",
          "src/mailers/DefaultMailer.php||src/mailers/DefaultMailer.php",
          "src/migrations/m180501_000005_update_copypaste_type.php||src/migrations/m180501_000005_update_copypaste_type.php",
          "src/migrations/m190212_000004_add_sent_email_foreign_key.php||src/migrations/m190212_000004_add_sent_email_foreign_key.php",
          "src/migrations/m190220_000000_clean_up_sent_email_records.php||src/migrations/m190220_000000_clean_up_sent_email_records.php",
          "src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php||src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php",
          "src/services/Mailers.php||src/services/Mailers.php",
          "src/templates/notifications/_edit.twig||src/templates/notifications/_edit.twig",
          "src/translations/en/sprout-base-email.php||src/translations/en/sprout-base-email.php",
          "src/web/assets/email/src/scss/sproutemail.scss||src/web/assets/email/src/scss/sproutemail.scss"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/base/EmailTemplates.php||src/base/EmailTemplates.php"
          ],
          "candidate": [
            "src/base/EmailTemplates.php||src/base/EmailTemplates.php"
          ]
        }
      },
      "candidate_diff": {
        "src/base/EmailTemplates.php||src/base/EmailTemplates.php": [
          "File: src/base/EmailTemplates.php -> src/base/EmailTemplates.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: use Twig\\Error\\LoaderError;",
          "8: use Twig\\Error\\RuntimeError;",
          "9: use Twig\\Error\\SyntaxError;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: use yii\\base\\Exception;",
          "",
          "---------------"
        ],
        "src/base/RecipientsTrait.php||src/base/RecipientsTrait.php": [
          "File: src/base/RecipientsTrait.php -> src/base/RecipientsTrait.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: use barrelstrength\\sproutbaseemail\\models\\SimpleRecipient;",
          "6: use barrelstrength\\sproutbaseemail\\models\\SimpleRecipientList;",
          "8: use Craft;",
          "9: use craft\\helpers\\Json;",
          "10: use Egulias\\EmailValidator\\EmailValidator;",
          "",
          "[Removed Lines]",
          "7: use barrelstrength\\sproutbasereports\\SproutBaseReports;",
          "",
          "[Added Lines]",
          "7: use barrelstrength\\sproutbasereports\\elements\\Report;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "242:         foreach ($listIds as $reportId) {",
          "247:             if (!$report) {",
          "248:                 throw new NotFoundHttpException('Report not found.');",
          "249:             }",
          "251:             $dataSource = $report->getDataSource();",
          "254:             if (!$dataSource) {",
          "255:                 throw new NotFoundHttpException('Data Source not found.');",
          "256:             }",
          "",
          "[Removed Lines]",
          "244:             $report = SproutBaseReports::$app->reports->getReport($reportId);",
          "",
          "[Added Lines]",
          "246:             $report = Craft::$app->elements->getElementById($reportId, Report::class);",
          "",
          "---------------"
        ],
        "src/base/SenderTrait.php||src/base/SenderTrait.php": [
          "File: src/base/SenderTrait.php -> src/base/SenderTrait.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: use Twig\\Error\\LoaderError;",
          "8: use Twig\\Error\\RuntimeError;",
          "9: use Twig\\Error\\SyntaxError;",
          "11: trait SenderTrait",
          "12: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: use yii\\base\\Exception;",
          "",
          "---------------"
        ],
        "src/controllers/NotificationsController.php||src/controllers/NotificationsController.php": [
          "File: src/controllers/NotificationsController.php -> src/controllers/NotificationsController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: use barrelstrength\\sproutbaseemail\\services\\NotificationEmails;",
          "15: use barrelstrength\\sproutbaseemail\\SproutBaseEmail;",
          "16: use barrelstrength\\sproutbasereports\\base\\DataSource;",
          "18: use Craft;",
          "19: use craft\\base\\Plugin;",
          "20: use craft\\errors\\MissingComponentException;",
          "",
          "[Removed Lines]",
          "17: use barrelstrength\\sproutbasereports\\services\\DataSources;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/elements/NotificationEmail.php||src/elements/NotificationEmail.php": [
          "File: src/elements/NotificationEmail.php -> src/elements/NotificationEmail.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: use Craft;",
          "13: use craft\\behaviors\\FieldLayoutBehavior;",
          "14: use craft\\elements\\db\\ElementQueryInterface;",
          "15: use craft\\helpers\\Json;",
          "16: use craft\\helpers\\UrlHelper;",
          "17: use Egulias\\EmailValidator\\EmailValidator;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15: use craft\\errors\\MissingComponentException;",
          "",
          "---------------"
        ],
        "src/elements/db/NotificationEmailQuery.php||src/elements/db/NotificationEmailQuery.php": [
          "File: src/elements/db/NotificationEmailQuery.php -> src/elements/db/NotificationEmailQuery.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: use Craft;",
          "7: use craft\\base\\Element;",
          "8: use craft\\elements\\db\\ElementQuery;",
          "10: class NotificationEmailQuery extends ElementQuery",
          "11: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9: use craft\\errors\\MissingComponentException;",
          "",
          "---------------"
        ],
        "src/mailers/DefaultMailer.php||src/mailers/DefaultMailer.php": [
          "File: src/mailers/DefaultMailer.php -> src/mailers/DefaultMailer.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: use barrelstrength\\sproutbaseemail\\base\\Mailer;",
          "7: use barrelstrength\\sproutbaseemail\\base\\NotificationEmailSenderInterface;",
          "8: use barrelstrength\\sproutbaseemail\\elements\\NotificationEmail;",
          "9: use barrelstrength\\sproutcampaigns\\elements\\CampaignEmail;",
          "10: use barrelstrength\\sproutemail\\services\\SentEmails;",
          "11: use barrelstrength\\sproutemail\\SproutEmail;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9: use barrelstrength\\sproutbasereports\\elements\\Report;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "293:         $listIds = [];",
          "297:             $listIds = Json::decode($values);",
          "298:             $listIds = $listIds['listIds'];",
          "299:         }",
          "301:         if (!empty($listIds)) {",
          "302:             foreach ($listIds as $key => $listId) {",
          "304:             }",
          "305:         }",
          "",
          "[Removed Lines]",
          "296:         if ($values !== null AND is_string($values)) {",
          "303:                 $selectedElements[] = Craft::$app->elements->getElementById($listId);",
          "",
          "[Added Lines]",
          "297:         if ($values !== null && is_string($values)) {",
          "304:                 $selectedElements[] = Craft::$app->elements->getElementById($listId, Report::class);",
          "",
          "---------------"
        ],
        "src/migrations/m180501_000005_update_copypaste_type.php||src/migrations/m180501_000005_update_copypaste_type.php": [
          "File: src/migrations/m180501_000005_update_copypaste_type.php -> src/migrations/m180501_000005_update_copypaste_type.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace barrelstrength\\sproutbaseemail\\migrations;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "",
          "---------------"
        ],
        "src/migrations/m190212_000004_add_sent_email_foreign_key.php||src/migrations/m190212_000004_add_sent_email_foreign_key.php": [
          "File: src/migrations/m190212_000004_add_sent_email_foreign_key.php -> src/migrations/m190212_000004_add_sent_email_foreign_key.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace barrelstrength\\sproutbaseemail\\migrations;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "",
          "---------------"
        ],
        "src/migrations/m190220_000000_clean_up_sent_email_records.php||src/migrations/m190220_000000_clean_up_sent_email_records.php": [
          "File: src/migrations/m190220_000000_clean_up_sent_email_records.php -> src/migrations/m190220_000000_clean_up_sent_email_records.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace barrelstrength\\sproutbaseemail\\migrations;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "",
          "---------------"
        ],
        "src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php||src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php": [
          "File: src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php -> src/migrations/m200219_000000_clean_up_cc_bcc_emailList_fields.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace barrelstrength\\sproutbaseemail\\migrations;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "",
          "---------------"
        ],
        "src/services/Mailers.php||src/services/Mailers.php": [
          "File: src/services/Mailers.php -> src/services/Mailers.php"
        ],
        "src/templates/notifications/_edit.twig||src/templates/notifications/_edit.twig": [
          "File: src/templates/notifications/_edit.twig -> src/templates/notifications/_edit.twig"
        ],
        "src/translations/en/sprout-base-email.php||src/translations/en/sprout-base-email.php": [
          "File: src/translations/en/sprout-base-email.php -> src/translations/en/sprout-base-email.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     'Always' => 'Always',",
          "131:     'Send Rule <span class=\\'info\\'>Defines how to check a form submission to determine if a user has opted in to have data sent to this Integration. The Integration will be sent if the setting is set to \\'Always\\'; if the Custom Rule is used and evaluates to \\'1\\', \\'true\\', \\'on\\', or \\'yes\\'. If none of those conditions are met, the Event will not be sent.</span>' => 'Send Rule <span class=\\'info\\'>Defines how to check a form submission to determine if a user has opted in to have data sent to this Integration. The Integration will be sent if the setting is set to \\'Always\\'; if the Custom Rule is used and evaluates to \\'1\\', \\'true\\', \\'on\\', or \\'yes\\'. If none of those conditions are met, the Event will not be sent.</span>',",
          "132:     'Cleaning up Sent Email' => 'Cleaning up Sent Email',",
          "134: ];",
          "",
          "[Removed Lines]",
          "133:     'Notification Emails' => 'Notification Emails'",
          "",
          "[Added Lines]",
          "133:     'Notification Emails' => 'Notification Emails',",
          "134:     'Disabling Notifications will remove them from the sidebar navigation and they will no longer be accessible in the Control Panel.' => 'Disabling Notifications will remove them from the sidebar navigation and they will no longer be accessible in the Control Panel.',",
          "135:     'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.',",
          "136:     'Use Sprout Email alongside <a href=\\'{pluginStoreUrl}\\'>Sprout Reports</a> to send Notification Emails to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Use Sprout Email alongside <a href=\\'{pluginStoreUrl}\\'>Sprout Reports</a> to send Notification Emails to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.',",
          "137:     'Sprout Email supports full-featured Reports and Mailing Lists powered by Sprout Reports. If you also have Sprout Reports installed, you may want to disable the Reports tab in Sprout Forms and manage all Reports and Mailing Lists in the Reports section of the CP.' => 'Sprout Email supports full-featured Reports and Mailing Lists powered by Sprout Reports. If you also have Sprout Reports installed, you may want to disable the Reports tab in Sprout Forms and manage all Reports and Mailing Lists in the Reports section of the CP.',",
          "138:     'Disable Sent Email tracking to remove them from the sidebar navigation and make them no longer accessible in the Control Panel.' => 'Disable Sent Email tracking to remove them from the sidebar navigation and make them no longer accessible in the Control Panel.',",
          "139:     'An error occurred while sending your campaign. Please review the Craft logs for more info.' => 'An error occurred while sending your campaign. Please review the Craft logs for more info.',",
          "140:     'Enable Notifications?' => 'Enable Notifications?',",
          "141:     'Add <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Add <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.',",
          "142:     'Install Sprout Reports to send your email to custom Mailing Lists and Segments.' => 'Install Sprout Reports to send your email to custom Mailing Lists and Segments.',",
          "143:     '_email/email-templates-folder' => '_email/email-templates-folder',",
          "144:     'Show Reports Tab' => 'Show Reports Tab',",
          "145:     'Integrations' => 'Integrations',",
          "146:     'Default Email Templates' => 'Default Email Templates',",
          "147:     'Use Sprout Email alongside <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Use Sprout Email alongside <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.',",
          "148:     'Disable Notifications to remove them from the sidebar navigation and make them no longer accessible in the Control Panel.' => 'Disable Notifications to remove them from the sidebar navigation and make them no longer accessible in the Control Panel.',",
          "149:     'Sent Emails' => 'Sent Emails',",
          "150:     'Enable custom Email Templates on a per-email basis' => 'Enable custom Email Templates on a per-email basis',",
          "151:     'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your email to custom Mailing Lists and Segments.' => 'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your email to custom Mailing Lists and Segments.',",
          "152:     'Install <strong>Sprout Reports</strong> to send your email to custom Mailing Lists and Segments.' => 'Install <strong>Sprout Reports</strong> to send your email to custom Mailing Lists and Segments.',",
          "153:     'Allow admins to (optionally) choose custom Email Templates for each email created. Enabling this setting will display the Email Template dropdown field for every Notification Email Element.' => 'Allow admins to (optionally) choose custom Email Templates for each email created. Enabling this setting will display the Email Template dropdown field for every Notification Email Element.',",
          "154:     'Mailers' => 'Mailers',",
          "155:     'Mailing Lists' => 'Mailing Lists',",
          "156:     'Enable Sent Email tracking?' => 'Enable Sent Email tracking?',",
          "157:     'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic Mailing Lists using all the power of the custom reporting engine in Sprout Reports.' => 'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic Mailing Lists using all the power of the custom reporting engine in Sprout Reports.',",
          "158:     'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Install <a href=\\'{url}\\'>Sprout Reports</a> to send your Notification Email to custom Mailing Lists. Build dynamic Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.',",
          "159:     'General' => 'General',",
          "160:     'Use Sprout Email alongside <a href=\\'{url}\\'>Sprout Reports</a> to send Notification Emails to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.' => 'Use Sprout Email alongside <a href=\\'{url}\\'>Sprout Reports</a> to send Notification Emails to custom Mailing Lists. Build dynamic and targeted Mailing Lists and Segments using all the power of the custom reporting engine in Sprout Reports.'",
          "",
          "---------------"
        ],
        "src/web/assets/email/src/scss/sproutemail.scss||src/web/assets/email/src/scss/sproutemail.scss": [
          "File: src/web/assets/email/src/scss/sproutemail.scss -> src/web/assets/email/src/scss/sproutemail.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "26:     background-color: #0d99f2;",
          "27: }",
          "30:     background-color: #d0021b;",
          "31: }",
          "",
          "[Removed Lines]",
          "29: .status.failed, .status.incomplete {",
          "",
          "[Added Lines]",
          "29: .status.failed {",
          "",
          "---------------"
        ]
      }
    }
  ]
}