{
  "cve_id": "CVE-2015-6941",
  "cve_desc": "win_useradd, salt-cloud and the Linode driver in salt 2015.5.x before 2015.5.6, and 2015.8.x before 2015.8.1 leak password information in debug logs.",
  "repo": "saltstack/salt",
  "patch_hash": "c0689e32154c41f59840ae10ffc5fbfa30618710",
  "patch_info": {
    "commit_hash": "c0689e32154c41f59840ae10ffc5fbfa30618710",
    "repo": "saltstack/salt",
    "commit_url": "https://github.com/saltstack/salt/commit/c0689e32154c41f59840ae10ffc5fbfa30618710",
    "files": [
      "salt/states/user.py"
    ],
    "message": "Replaced password with redacted when displayed",
    "before_after_code_files": [
      "salt/states/user.py||salt/states/user.py"
    ]
  },
  "patch_diff": {
    "salt/states/user.py||salt/states/user.py": [
      "File: salt/states/user.py -> salt/states/user.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             ret['comment'] = ('The following user attributes are set to be '",
      "368:                               'changed:\\n')",
      "369:             for key, val in changes.items():",
      "370:                 ret['comment'] += '{0}: {1}\\n'.format(key, val)",
      "371:             return ret",
      "372:         # The user is present",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:                 if key == 'password':",
      "371:                     val = 'XXX-REDACTED-XXX'",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "488:                     if spost['passwd'] != password:",
      "489:                         ret['comment'] = 'User {0} created but failed to set' \\",
      "490:                                          ' password to' \\",
      "492:                         ret['result'] = False",
      "494:                 if date:",
      "495:                     __salt__['shadow.set_date'](name, date)",
      "496:                     spost = __salt__['shadow.info'](name)",
      "",
      "[Removed Lines]",
      "491:                                          ' {1}'.format(name, password)",
      "493:                     ret['changes']['password'] = password",
      "",
      "[Added Lines]",
      "493:                                          ' {1}'.format(name, 'XXX-REDACTED-XXX')",
      "495:                     ret['changes']['password'] = 'XXX-REDACTED-XXX'",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "550:                     if not __salt__['user.setpassword'](name, password):",
      "551:                         ret['comment'] = 'User {0} created but failed to set' \\",
      "552:                                          ' password to' \\",
      "554:                         ret['result'] = False",
      "556:         else:",
      "557:             ret['comment'] = 'Failed to create new user {0}'.format(name)",
      "558:             ret['result'] = False",
      "",
      "[Removed Lines]",
      "553:                                          ' {1}'.format(name, password)",
      "555:                     ret['changes']['passwd'] = password",
      "",
      "[Added Lines]",
      "555:                                          ' {1}'.format(name, 'XXX-REDACTED-XXX')",
      "557:                     ret['changes']['passwd'] = 'XXX-REDACTED-XXX'",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d6f70a4545faceb1ac5c3cfa8ead660b4a34c198",
      "candidate_info": {
        "commit_hash": "d6f70a4545faceb1ac5c3cfa8ead660b4a34c198",
        "repo": "saltstack/salt",
        "commit_url": "https://github.com/saltstack/salt/commit/d6f70a4545faceb1ac5c3cfa8ead660b4a34c198",
        "files": [
          "salt/states/user.py"
        ],
        "message": "Fixed user.present to create password in windows",
        "before_after_code_files": [
          "salt/states/user.py||salt/states/user.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "salt/states/user.py||salt/states/user.py"
          ],
          "candidate": [
            "salt/states/user.py||salt/states/user.py"
          ]
        }
      },
      "candidate_diff": {
        "salt/states/user.py||salt/states/user.py": [
          "File: salt/states/user.py -> salt/states/user.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "545:                                          ' {1}'.format(name, expire)",
          "546:                         ret['result'] = False",
          "547:                     ret['changes']['expire'] = expire",
          "548:         else:",
          "549:             ret['comment'] = 'Failed to create new user {0}'.format(name)",
          "550:             ret['result'] = False",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "548:             elif salt.utils.is_windows():",
          "549:                 if password and not empty_password:",
          "550:                     if not __salt__['user.setpassword'](name, password):",
          "551:                         ret['comment'] = 'User {0} created but failed to set' \\",
          "552:                                          ' password to' \\",
          "553:                                          ' {1}'.format(name, password)",
          "554:                         ret['result'] = False",
          "555:                     ret['changes']['passwd'] = password",
          "",
          "---------------"
        ]
      }
    }
  ]
}