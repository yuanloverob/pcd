{
  "cve_id": "CVE-2022-0251",
  "cve_desc": "Cross-site Scripting (XSS) - Stored in GitHub repository pimcore/pimcore prior to 10.2.10.",
  "repo": "pimcore/pimcore",
  "patch_hash": "3ae96b9d41c117aafa45873ad10077d4b873a3cb",
  "patch_info": {
    "commit_hash": "3ae96b9d41c117aafa45873ad10077d4b873a3cb",
    "repo": "pimcore/pimcore",
    "commit_url": "https://github.com/pimcore/pimcore/commit/3ae96b9d41c117aafa45873ad10077d4b873a3cb",
    "files": [
      "models/DataObject/ClassDefinition/Service.php"
    ],
    "message": "disallow html entity names on import - follow up to #11217",
    "before_after_code_files": [
      "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php"
    ]
  },
  "patch_diff": {
    "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php": [
      "File: models/DataObject/ClassDefinition/Service.php -> models/DataObject/ClassDefinition/Service.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "315:     {",
      "316:         if (is_array($array) && count($array) > 0) {",
      "317:             if ($name = $array['name'] ?? false) {",
      "320:                     throw new \\Exception('not a valid name:' . htmlentities($name));",
      "321:                 }",
      "322:             }",
      "324:             $loader = \\Pimcore::getContainer()->get('pimcore.implementation_loader.object.' . $array['datatype']);",
      "",
      "[Removed Lines]",
      "318:                 $sanitizedName = htmlentities($name);",
      "319:                 if ($sanitizedName !== $name) {",
      "",
      "[Added Lines]",
      "318:                 if (preg_match('/<.+?>/', $name)) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "90074a205c00bbe6167f9b9c84cc074912b4ea0b",
      "candidate_info": {
        "commit_hash": "90074a205c00bbe6167f9b9c84cc074912b4ea0b",
        "repo": "pimcore/pimcore",
        "commit_url": "https://github.com/pimcore/pimcore/commit/90074a205c00bbe6167f9b9c84cc074912b4ea0b",
        "files": [
          "models/DataObject/ClassDefinition/Service.php"
        ],
        "message": "disallow html entity names on import (#11217)\n\n* disallow html entity names on import\n\n* disallow html entity names on import\n\n* Update models/DataObject/ClassDefinition/Service.php\n\nCo-authored-by: Sebastian Blank <blank@data-factory.net>\n\nCo-authored-by: Sebastian Blank <blank@data-factory.net>",
        "before_after_code_files": [
          "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php"
          ],
          "candidate": [
            "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php"
          ]
        }
      },
      "candidate_diff": {
        "models/DataObject/ClassDefinition/Service.php||models/DataObject/ClassDefinition/Service.php": [
          "File: models/DataObject/ClassDefinition/Service.php -> models/DataObject/ClassDefinition/Service.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "282:     public static function generateLayoutTreeFromArray($array, $throwException = false, $insideLocalizedField = false)",
          "283:     {",
          "284:         if (is_array($array) && count($array) > 0) {",
          "286:             $loader = \\Pimcore::getContainer()->get('pimcore.implementation_loader.object.' . $array['datatype']);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "285:             if ($name = $array['name'] ?? false) {",
          "286:                 $sanitizedName = htmlentities($name);",
          "287:                 if ($sanitizedName !== $name) {",
          "288:                     throw new \\Exception('not a valid name:' . htmlentities($name));",
          "289:                 }",
          "290:             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}