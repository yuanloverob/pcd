{
  "cve_id": "CVE-2024-38516",
  "cve_desc": "ai-client-html is an Aimeos e-commerce HTML client component. Debug information revealed sensitive information from environment variables in error log. This issue has been patched in versions 2024.04.7, 2023.10.15, 2022.10.13 and 2021.10.22.",
  "repo": "aimeos/ai-client-html",
  "patch_hash": "bb389620ffc3cf4a2f29c11a1e5f512049e0c132",
  "patch_info": {
    "commit_hash": "bb389620ffc3cf4a2f29c11a1e5f512049e0c132",
    "repo": "aimeos/ai-client-html",
    "commit_url": "https://github.com/aimeos/ai-client-html/commit/bb389620ffc3cf4a2f29c11a1e5f512049e0c132",
    "files": [
      "src/Client/Html/Checkout/Confirm/Standard.php"
    ],
    "message": "Don't log security relevant data to prevent revealing information",
    "before_after_code_files": [
      "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
    ]
  },
  "patch_diff": {
    "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php": [
      "File: src/Client/Html/Checkout/Confirm/Standard.php -> src/Client/Html/Checkout/Confirm/Standard.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "115:   $context = $this->context();",
      "116:   $config = $context->config();",
      "123:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
      "124:   }",
      "",
      "[Removed Lines]",
      "118:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null )",
      "119:   {",
      "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL",
      "121:     . '$_COOKIE: ' . print_r( $_COOKIE, true ) . PHP_EOL",
      "122:     . '$_SERVER: ' . print_r( $_SERVER, true ) );",
      "",
      "[Added Lines]",
      "118:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null ) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "02f9688e945a1f9853202ce1ff3085a07748a06a",
      "candidate_info": {
        "commit_hash": "02f9688e945a1f9853202ce1ff3085a07748a06a",
        "repo": "aimeos/ai-client-html",
        "commit_url": "https://github.com/aimeos/ai-client-html/commit/02f9688e945a1f9853202ce1ff3085a07748a06a",
        "files": [
          "src/Client/Html/Checkout/Confirm/Standard.php"
        ],
        "message": "Added cookie data to error log if no session is available",
        "before_after_code_files": [
          "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ],
          "candidate": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php": [
          "File: src/Client/Html/Checkout/Confirm/Standard.php -> src/Client/Html/Checkout/Confirm/Standard.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "118:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null )",
          "119:   {",
          "121:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
          "122:   }",
          "",
          "[Removed Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . print_r( $_SERVER, true ) );",
          "",
          "[Added Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL",
          "121:     . '$_COOKIE: ' . print_r( $_COOKIE, true ) . PHP_EOL",
          "122:     . '$_SERVER: ' . print_r( $_SERVER, true ) );",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cb408b4783c3adfdfe6d442e682d4550848fac29",
      "candidate_info": {
        "commit_hash": "cb408b4783c3adfdfe6d442e682d4550848fac29",
        "repo": "aimeos/ai-client-html",
        "commit_url": "https://github.com/aimeos/ai-client-html/commit/cb408b4783c3adfdfe6d442e682d4550848fac29",
        "files": [
          "src/Client/Html/Checkout/Confirm/Standard.php"
        ],
        "message": "Only log cookie data to prevent revealing server information",
        "before_after_code_files": [
          "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ],
          "candidate": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php": [
          "File: src/Client/Html/Checkout/Confirm/Standard.php -> src/Client/Html/Checkout/Confirm/Standard.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "118:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null )",
          "119:   {",
          "123:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
          "124:   }",
          "",
          "[Removed Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL",
          "121:     . '$_COOKIE: ' . print_r( $_COOKIE, true ) . PHP_EOL",
          "122:     . '$_SERVER: ' . print_r( $_SERVER, true ) );",
          "",
          "[Added Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . '$_COOKIE: ' . print_r( $_COOKIE, true ) );",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "091eb0197c408f8f08cb2b4e451b771ec3ce2e9f",
      "candidate_info": {
        "commit_hash": "091eb0197c408f8f08cb2b4e451b771ec3ce2e9f",
        "repo": "aimeos/ai-client-html",
        "commit_url": "https://github.com/aimeos/ai-client-html/commit/091eb0197c408f8f08cb2b4e451b771ec3ce2e9f",
        "files": [
          "src/Client/Html/Checkout/Confirm/Standard.php"
        ],
        "message": "Only log cookie data to prevent revealing server information",
        "before_after_code_files": [
          "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ],
          "candidate": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php": [
          "File: src/Client/Html/Checkout/Confirm/Standard.php -> src/Client/Html/Checkout/Confirm/Standard.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "112:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null )",
          "113:   {",
          "115:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
          "116:   }",
          "",
          "[Removed Lines]",
          "114:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . print_r( $_SERVER, true ) );",
          "",
          "[Added Lines]",
          "114:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . '$_COOKIE: ' . print_r( $_COOKIE, true ) );",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1f7d25d205618174d585cdb0556dd00efe9e6134",
      "candidate_info": {
        "commit_hash": "1f7d25d205618174d585cdb0556dd00efe9e6134",
        "repo": "aimeos/ai-client-html",
        "commit_url": "https://github.com/aimeos/ai-client-html/commit/1f7d25d205618174d585cdb0556dd00efe9e6134",
        "files": [
          "client/html/src/Client/Html/Checkout/Confirm/Standard.php"
        ],
        "message": "Only log cookie data to prevent revealing server information",
        "before_after_code_files": [
          "client/html/src/Client/Html/Checkout/Confirm/Standard.php||client/html/src/Client/Html/Checkout/Confirm/Standard.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "client/html/src/Client/Html/Checkout/Confirm/Standard.php||client/html/src/Client/Html/Checkout/Confirm/Standard.php": [
          "File: client/html/src/Client/Html/Checkout/Confirm/Standard.php -> client/html/src/Client/Html/Checkout/Confirm/Standard.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "386:   if( ( $id = $context->getSession()->get( 'aimeos/orderid' ) ) === null )",
          "387:   {",
          "389:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
          "390:   }",
          "",
          "[Removed Lines]",
          "388:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . print_r( $_SERVER, true ) );",
          "",
          "[Added Lines]",
          "388:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . print_r( $_COOKIE, true ) );",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e8b3341a42e0a8d3da92b36a28b553915772303e",
      "candidate_info": {
        "commit_hash": "e8b3341a42e0a8d3da92b36a28b553915772303e",
        "repo": "aimeos/ai-client-html",
        "commit_url": "https://github.com/aimeos/ai-client-html/commit/e8b3341a42e0a8d3da92b36a28b553915772303e",
        "files": [
          "src/Client/Html/Checkout/Confirm/Standard.php"
        ],
        "message": "Only log cookie data to prevent revealing server information",
        "before_after_code_files": [
          "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ],
          "candidate": [
            "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Client/Html/Checkout/Confirm/Standard.php||src/Client/Html/Checkout/Confirm/Standard.php": [
          "File: src/Client/Html/Checkout/Confirm/Standard.php -> src/Client/Html/Checkout/Confirm/Standard.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "118:   if( ( $id = $context->session()->get( 'aimeos/orderid' ) ) === null )",
          "119:   {",
          "123:    throw new \\Aimeos\\Client\\Html\\Exception( $context->translate( 'client', 'No order ID available in session' ) );",
          "124:   }",
          "",
          "[Removed Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL",
          "121:     . '$_COOKIE: ' . print_r( $_COOKIE, true ) . PHP_EOL",
          "122:     . '$_SERVER: ' . print_r( $_SERVER, true ) );",
          "",
          "[Added Lines]",
          "120:    $context->logger()->log( 'Lost session at confirmation page' . PHP_EOL . '$_COOKIE: ' . print_r( $_COOKIE, true ) );",
          "",
          "---------------"
        ]
      }
    }
  ]
}