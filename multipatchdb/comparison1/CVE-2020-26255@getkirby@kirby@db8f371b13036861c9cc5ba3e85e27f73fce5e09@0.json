{
  "cve_id": "CVE-2020-26255",
  "cve_desc": "Kirby is a CMS. In Kirby CMS (getkirby/cms) before version 3.4.5, and Kirby Panel before version 2.5.14 , an editor with full access to the Kirby Panel can upload a PHP .phar file and execute it on the server. This vulnerability is critical if you might have potential attackers in your group of authenticated Panel users, as they can gain access to the server with such a Phar file. Visitors without Panel access *cannot* use this attack vector. The problem has been patched in Kirby 2.5.14 and Kirby 3.4.5. Please update to one of these or a later version to fix the vulnerability. Note: Kirby 2 reaches end of life on December 31, 2020. We therefore recommend to upgrade your Kirby 2 sites to Kirby 3. If you cannot upgrade, we still recommend to update to Kirby 2.5.14.",
  "repo": "getkirby/kirby",
  "patch_hash": "db8f371b13036861c9cc5ba3e85e27f73fce5e09",
  "patch_info": {
    "commit_hash": "db8f371b13036861c9cc5ba3e85e27f73fce5e09",
    "repo": "getkirby/kirby",
    "commit_url": "https://github.com/getkirby/kirby/commit/db8f371b13036861c9cc5ba3e85e27f73fce5e09",
    "files": [
      "cacert.pem",
      "composer.json",
      "composer.lock",
      "src/Cms/FileRules.php",
      "src/Cms/Media.php",
      "tests/Cms/Files/FileRulesTest.php",
      "vendor/composer/ClassLoader.php",
      "vendor/composer/autoload_real.php"
    ],
    "message": "Merge pull request #2962 from getkirby/fix/upload-validation\n\nUpload validation",
    "before_after_code_files": [
      "cacert.pem||cacert.pem",
      "composer.lock||composer.lock",
      "src/Cms/FileRules.php||src/Cms/FileRules.php",
      "src/Cms/Media.php||src/Cms/Media.php",
      "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php",
      "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php",
      "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php"
    ]
  },
  "patch_diff": {
    "cacert.pem||cacert.pem": [
      "File: cacert.pem -> cacert.pem",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: ##",
      "2: ## Bundle of CA Root Certificates",
      "3: ##",
      "5: ##",
      "6: ## This is a bundle of X.509 certificates of public Certificate Authorities",
      "7: ## (CA). These were automatically extracted from Mozilla's root certificates",
      "",
      "[Removed Lines]",
      "4: ## Certificate data from Mozilla as of: Wed Jul 22 03:12:14 2020 GMT",
      "",
      "[Added Lines]",
      "4: ## Certificate data from Mozilla as of: Wed Oct 14 03:12:15 2020 GMT",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "14: ## Just configure this file as the SSLCACertificateFile.",
      "15: ##",
      "16: ## Conversion done with mk-ca-bundle.pl version 1.28.",
      "18: ##",
      "",
      "[Removed Lines]",
      "17: ## SHA256: cc6408bd4be7fbfb8699bdb40ccb7f6de5780d681d87785ea362646e4dad5e8e",
      "",
      "[Added Lines]",
      "17: ## SHA256: a831d3bc63ba1f65478afe28038742b7150c0c2efd243ac342b64792a75d2038",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "448: QBFGmh95DmK/D5fs4C8fF5Q=",
      "449: -----END CERTIFICATE-----",
      "481: DigiCert Assured ID Root CA",
      "482: ===========================",
      "483: -----BEGIN CERTIFICATE-----",
      "",
      "[Removed Lines]",
      "451: Taiwan GRCA",
      "452: ===========",
      "453: -----BEGIN CERTIFICATE-----",
      "454: MIIFcjCCA1qgAwIBAgIQH51ZWtcvwgZEpYAIaeNe9jANBgkqhkiG9w0BAQUFADA/MQswCQYDVQQG",
      "455: EwJUVzEwMC4GA1UECgwnR292ZXJubWVudCBSb290IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4X",
      "456: DTAyMTIwNTEzMjMzM1oXDTMyMTIwNTEzMjMzM1owPzELMAkGA1UEBhMCVFcxMDAuBgNVBAoMJ0dv",
      "457: dmVybm1lbnQgUm9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCCAiIwDQYJKoZIhvcNAQEBBQAD",
      "458: ggIPADCCAgoCggIBAJoluOzMonWoe/fOW1mKydGGEghU7Jzy50b2iPN86aXfTEc2pBsBHH8eV4qN",
      "459: w8XRIePaJD9IK/ufLqGU5ywck9G/GwGHU5nOp/UKIXZ3/6m3xnOUT0b3EEk3+qhZSV1qgQdW8or5",
      "460: BtD3cCJNtLdBuTK4sfCxw5w/cP1T3YGq2GN49thTbqGsaoQkclSGxtKyyhwOeYHWtXBiCAEuTk8O",
      "461: 1RGvqa/lmr/czIdtJuTJV6L7lvnM4T9TjGxMfptTCAtsF/tnyMKtsc2AtJfcdgEWFelq16TheEfO",
      "462: htX7MfP6Mb40qij7cEwdScevLJ1tZqa2jWR+tSBqnTuBto9AAGdLiYa4zGX+FVPpBMHWXx1E1wov",
      "463: J5pGfaENda1UhhXcSTvxls4Pm6Dso3pdvtUqdULle96ltqqvKKyskKw4t9VoNSZ63Pc78/1Fm9G7",
      "464: Q3hub/FCVGqY8A2tl+lSXunVanLeavcbYBT0peS2cWeqH+riTcFCQP5nRhc4L0c/cZyu5SHKYS1t",
      "465: B6iEfC3uUSXxY5Ce/eFXiGvviiNtsea9P63RPZYLhY3Naye7twWb7LuRqQoHEgKXTiCQ8P8NHuJB",
      "466: O9NAOueNXdpm5AKwB1KYXA6OM5zCppX7VRluTI6uSw+9wThNXo+EHWbNxWCWtFJaBYmOlXqYwZE8",
      "467: lSOyDvR5tMl8wUohAgMBAAGjajBoMB0GA1UdDgQWBBTMzO/MKWCkO7GStjz6MmKPrCUVOzAMBgNV",
      "468: HRMEBTADAQH/MDkGBGcqBwAEMTAvMC0CAQAwCQYFKw4DAhoFADAHBgVnKgMAAAQUA5vwIhP/lSg2",
      "469: 09yewDL7MTqKUWUwDQYJKoZIhvcNAQEFBQADggIBAECASvomyc5eMN1PhnR2WPWus4MzeKR6dBcZ",
      "470: TulStbngCnRiqmjKeKBMmo4sIy7VahIkv9Ro04rQ2JyftB8M3jh+Vzj8jeJPXgyfqzvS/3WXy6Tj",
      "471: Zwj/5cAWtUgBfen5Cv8b5Wppv3ghqMKnI6mGq3ZW6A4M9hPdKmaKZEk9GhiHkASfQlK3T8v+R0F2",
      "472: Ne//AHY2RTKbxkaFXeIksB7jSJaYV0eUVXoPQbFEJPPB/hprv4j9wabak2BegUqZIJxIZhm1AHlU",
      "473: D7gsL0u8qV1bYH+Mh6XgUmMqvtg7hUAV/h62ZT/FS9p+tXo1KaMuephgIqP0fSdOLeq0dDzpD6Qz",
      "474: DxARvBMB1uUO07+1EqLhRSPAzAhuYbeJq4PjJB7mXQfnHyA+z2fI56wwbSdLaG5LKlwCCDTb+Hbk",
      "475: Z6MmnD+iMsJKxYEYMRBWqoTvLQr/uB930r+lWKBi5NdLkXWNiYCYfm3LU05er/ayl4WXudpVBrkk",
      "476: 7tfGOB5jGxI7leFYrPLfhNVfmS8NVVvmONsuP3LpSIXLuykTjx44VbnzssQwmSNOXfJIoRIM3BKQ",
      "477: CZBUkQM8R+XVyWXgt0t97EfTsws+rZ7QdAAO671RrcDeLMDDav7v3Aun+kbfYNucpllQdSNpc5Oy",
      "478: +fwC00fmcc4QAu4njIT/rEUNE1yDMuAlpYYsfPQS",
      "479: -----END CERTIFICATE-----",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "806: U/7dIOA1mjbRxwG55tzd8/8dLDoWV9mSOdY=",
      "807: -----END CERTIFICATE-----",
      "832: Certigna",
      "833: ========",
      "834: -----BEGIN CERTIFICATE-----",
      "",
      "[Removed Lines]",
      "809: OISTE WISeKey Global Root GA CA",
      "810: ===============================",
      "811: -----BEGIN CERTIFICATE-----",
      "812: MIID8TCCAtmgAwIBAgIQQT1yx/RrH4FDffHSKFTfmjANBgkqhkiG9w0BAQUFADCBijELMAkGA1UE",
      "813: BhMCQ0gxEDAOBgNVBAoTB1dJU2VLZXkxGzAZBgNVBAsTEkNvcHlyaWdodCAoYykgMjAwNTEiMCAG",
      "814: A1UECxMZT0lTVEUgRm91bmRhdGlvbiBFbmRvcnNlZDEoMCYGA1UEAxMfT0lTVEUgV0lTZUtleSBH",
      "815: bG9iYWwgUm9vdCBHQSBDQTAeFw0wNTEyMTExNjAzNDRaFw0zNzEyMTExNjA5NTFaMIGKMQswCQYD",
      "816: VQQGEwJDSDEQMA4GA1UEChMHV0lTZUtleTEbMBkGA1UECxMSQ29weXJpZ2h0IChjKSAyMDA1MSIw",
      "817: IAYDVQQLExlPSVNURSBGb3VuZGF0aW9uIEVuZG9yc2VkMSgwJgYDVQQDEx9PSVNURSBXSVNlS2V5",
      "818: IEdsb2JhbCBSb290IEdBIENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy0+zAJs9",
      "819: Nt350UlqaxBJH+zYK7LG+DKBKUOVTJoZIyEVRd7jyBxRVVuuk+g3/ytr6dTqvirdqFEr12bDYVxg",
      "820: Asj1znJ7O7jyTmUIms2kahnBAbtzptf2w93NvKSLtZlhuAGio9RN1AU9ka34tAhxZK9w8RxrfvbD",
      "821: d50kc3vkDIzh2TbhmYsFmQvtRTEJysIA2/dyoJaqlYfQjse2YXMNdmaM3Bu0Y6Kff5MTMPGhJ9vZ",
      "822: /yxViJGg4E8HsChWjBgbl0SOid3gF27nKu+POQoxhILYQBRJLnpB5Kf+42TMwVlxSywhp1t94B3R",
      "823: LoGbw9ho972WG6xwsRYUC9tguSYBBQIDAQABo1EwTzALBgNVHQ8EBAMCAYYwDwYDVR0TAQH/BAUw",
      "824: AwEB/zAdBgNVHQ4EFgQUswN+rja8sHnR3JQmthG+IbJphpQwEAYJKwYBBAGCNxUBBAMCAQAwDQYJ",
      "825: KoZIhvcNAQEFBQADggEBAEuh/wuHbrP5wUOxSPMowB0uyQlB+pQAHKSkq0lPjz0e701vvbyk9vIm",
      "826: MMkQyh2I+3QZH4VFvbBsUfk2ftv1TDI6QU9bR8/oCy22xBmddMVHxjtqD6wU2zz0c5ypBd8A3HR4",
      "827: +vg1YFkCExh8vPtNsCBtQ7tgMHpnM1zFmdH4LTlSc/uMqpclXHLZCB6rTjzjgTGfA6b7wP4piFXa",
      "828: hNVQA7bihKOmNqoROgHhGEvWRGizPflTdISzRpFGlgC3gCy24eMQ4tui5yiPAZZiFj4A4xylNoEY",
      "829: okxSdsARo27mHbrjWr42U8U+dY+GaSlYU7Wcu2+fXMUY7N0v4ZjJ/L7fCg0=",
      "830: -----END CERTIFICATE-----",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "1709: e9eiPZaGzPImNC1qkp2aGtAw4l1OBLBfiyB+d8E9lYLRRpo7PHi4b6HQDWSieB4pTpPDpFQUWw==",
      "1710: -----END CERTIFICATE-----",
      "1736: D-TRUST Root Class 3 CA 2 2009",
      "1737: ==============================",
      "1738: -----BEGIN CERTIFICATE-----",
      "",
      "[Removed Lines]",
      "1712: EE Certification Centre Root CA",
      "1713: ===============================",
      "1714: -----BEGIN CERTIFICATE-----",
      "1715: MIIEAzCCAuugAwIBAgIQVID5oHPtPwBMyonY43HmSjANBgkqhkiG9w0BAQUFADB1MQswCQYDVQQG",
      "1716: EwJFRTEiMCAGA1UECgwZQVMgU2VydGlmaXRzZWVyaW1pc2tlc2t1czEoMCYGA1UEAwwfRUUgQ2Vy",
      "1717: dGlmaWNhdGlvbiBDZW50cmUgUm9vdCBDQTEYMBYGCSqGSIb3DQEJARYJcGtpQHNrLmVlMCIYDzIw",
      "1718: MTAxMDMwMTAxMDMwWhgPMjAzMDEyMTcyMzU5NTlaMHUxCzAJBgNVBAYTAkVFMSIwIAYDVQQKDBlB",
      "1719: UyBTZXJ0aWZpdHNlZXJpbWlza2Vza3VzMSgwJgYDVQQDDB9FRSBDZXJ0aWZpY2F0aW9uIENlbnRy",
      "1720: ZSBSb290IENBMRgwFgYJKoZIhvcNAQkBFglwa2lAc2suZWUwggEiMA0GCSqGSIb3DQEBAQUAA4IB",
      "1721: DwAwggEKAoIBAQDIIMDs4MVLqwd4lfNE7vsLDP90jmG7sWLqI9iroWUyeuuOF0+W2Ap7kaJjbMeM",
      "1722: TC55v6kF/GlclY1i+blw7cNRfdCT5mzrMEvhvH2/UpvObntl8jixwKIy72KyaOBhU8E2lf/slLo2",
      "1723: rpwcpzIP5Xy0xm90/XsY6KxX7QYgSzIwWFv9zajmofxwvI6Sc9uXp3whrj3B9UiHbCe9nyV0gVWw",
      "1724: 93X2PaRka9ZP585ArQ/dMtO8ihJTmMmJ+xAdTX7Nfh9WDSFwhfYggx/2uh8Ej+p3iDXE/+pOoYtN",
      "1725: P2MbRMNE1CV2yreN1x5KZmTNXMWcg+HCCIia7E6j8T4cLNlsHaFLAgMBAAGjgYowgYcwDwYDVR0T",
      "1726: AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAQYwHQYDVR0OBBYEFBLyWj7qVhy/zQas8fElyalL1BSZ",
      "1727: MEUGA1UdJQQ+MDwGCCsGAQUFBwMCBggrBgEFBQcDAQYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEF",
      "1728: BQcDCAYIKwYBBQUHAwkwDQYJKoZIhvcNAQEFBQADggEBAHv25MANqhlHt01Xo/6tu7Fq1Q+e2+Rj",
      "1729: xY6hUFaTlrg4wCQiZrxTFGGVv9DHKpY5P30osxBAIWrEr7BSdxjhlthWXePdNl4dp1BUoMUq5KqM",
      "1730: lIpPnTX/dqQGE5Gion0ARD9V04I8GtVbvFZMIi5GQ4okQC3zErg7cBqklrkar4dBGmoYDQZPxz5u",
      "1731: uSlNDUmJEYcyW+ZLBMjkXOZ0c5RdFpgTlf7727FE5TpwrDdr5rMzcijJs1eg9gIWiAYLtqZLICjU",
      "1732: 3j2LrTcFU3T+bsy8QxdxXvnFzBqpYe73dgzzcvRyrc9yAjYHR8/vGVCJYMzpJJUPwssd8m92kMfM",
      "1733: dcGWxZ0=",
      "1734: -----END CERTIFICATE-----",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "3445: NMn5X7azKFGnpyuqSfqNZSlO42sTp5SjLVFteAxEy9/eCG/Oo2Sr05WE1LlSVHJ7liXMvGnjSG4N",
      "3446: 0MedJ5qq+BOS3R7fY581qRY27Iy4g/Q9iY/NtBde17MXQRBdJ3NghVdJIgc=",
      "3447: -----END CERTIFICATE-----",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3372: Trustwave Global Certification Authority",
      "3373: ========================================",
      "3374: -----BEGIN CERTIFICATE-----",
      "3375: MIIF2jCCA8KgAwIBAgIMBfcOhtpJ80Y1LrqyMA0GCSqGSIb3DQEBCwUAMIGIMQswCQYDVQQGEwJV",
      "3376: UzERMA8GA1UECAwISWxsaW5vaXMxEDAOBgNVBAcMB0NoaWNhZ28xITAfBgNVBAoMGFRydXN0d2F2",
      "3377: ZSBIb2xkaW5ncywgSW5jLjExMC8GA1UEAwwoVHJ1c3R3YXZlIEdsb2JhbCBDZXJ0aWZpY2F0aW9u",
      "3378: IEF1dGhvcml0eTAeFw0xNzA4MjMxOTM0MTJaFw00MjA4MjMxOTM0MTJaMIGIMQswCQYDVQQGEwJV",
      "3379: UzERMA8GA1UECAwISWxsaW5vaXMxEDAOBgNVBAcMB0NoaWNhZ28xITAfBgNVBAoMGFRydXN0d2F2",
      "3380: ZSBIb2xkaW5ncywgSW5jLjExMC8GA1UEAwwoVHJ1c3R3YXZlIEdsb2JhbCBDZXJ0aWZpY2F0aW9u",
      "3381: IEF1dGhvcml0eTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBALldUShLPDeS0YLOvR29",
      "3382: zd24q88KPuFd5dyqCblXAj7mY2Hf8g+CY66j96xz0XznswuvCAAJWX/NKSqIk4cXGIDtiLK0thAf",
      "3383: LdZfVaITXdHG6wZWiYj+rDKd/VzDBcdu7oaJuogDnXIhhpCujwOl3J+IKMujkkkP7NAP4m1ET4Bq",
      "3384: stTnoApTAbqOl5F2brz81Ws25kCI1nsvXwXoLG0R8+eyvpJETNKXpP7ScoFDB5zpET71ixpZfR9o",
      "3385: WN0EACyW80OzfpgZdNmcc9kYvkHHNHnZ9GLCQ7mzJ7Aiy/k9UscwR7PJPrhq4ufogXBeQotPJqX+",
      "3386: OsIgbrv4Fo7NDKm0G2x2EOFYeUY+VM6AqFcJNykbmROPDMjWLBz7BegIlT1lRtzuzWniTY+HKE40",
      "3387: Cz7PFNm73bZQmq131BnW2hqIyE4bJ3XYsgjxroMwuREOzYfwhI0Vcnyh78zyiGG69Gm7DIwLdVcE",
      "3388: uE4qFC49DxweMqZiNu5m4iK4BUBjECLzMx10coos9TkpoNPnG4CELcU9402x/RpvumUHO1jsQkUm",
      "3389: +9jaJXLE9gCxInm943xZYkqcBW89zubWR2OZxiRvchLIrH+QtAuRcOi35hYQcRfO3gZPSEF9NUqj",
      "3390: ifLJS3tBEW1ntwiYTOURGa5CgNz7kAXU+FDKvuStx8KU1xad5hePrzb7AgMBAAGjQjBAMA8GA1Ud",
      "3391: EwEB/wQFMAMBAf8wHQYDVR0OBBYEFJngGWcNYtt2s9o9uFvo/ULSMQ6HMA4GA1UdDwEB/wQEAwIB",
      "3392: BjANBgkqhkiG9w0BAQsFAAOCAgEAmHNw4rDT7TnsTGDZqRKGFx6W0OhUKDtkLSGm+J1WE2pIPU/H",
      "3393: PinbbViDVD2HfSMF1OQc3Og4ZYbFdada2zUFvXfeuyk3QAUHw5RSn8pk3fEbK9xGChACMf1KaA0H",
      "3394: ZJDmHvUqoai7PF35owgLEQzxPy0QlG/+4jSHg9bP5Rs1bdID4bANqKCqRieCNqcVtgimQlRXtpla",
      "3395: 4gt5kNdXElE1GYhBaCXUNxeEFfsBctyV3lImIJgm4nb1J2/6ADtKYdkNy1GTKv0WBpanI5ojSP5R",
      "3396: vbbEsLFUzt5sQa0WZ37b/TjNuThOssFgy50X31ieemKyJo90lZvkWx3SD92YHJtZuSPTMaCm/zjd",
      "3397: zyBP6VhWOmfD0faZmZ26NraAL4hHT4a/RDqA5Dccprrql5gR0IRiR2Qequ5AvzSxnI9O4fKSTx+O",
      "3398: 856X3vOmeWqJcU9LJxdI/uz0UA9PSX3MReO9ekDFQdxhVicGaeVyQYHTtgGJoC86cnn+OjC/QezH",
      "3399: Yj6RS8fZMXZC+fc8Y+wmjHMMfRod6qh8h6jCJ3zhM0EPz8/8AKAigJ5Kp28AsEFFtyLKaEjFQqKu",
      "3400: 3R3y4G5OBVixwJAWKqQ9EEC+j2Jjg6mcgn0tAumDMHzLJ8n9HmYAsC7TIS+OMxZsmO0QqAfWzJPP",
      "3401: 29FpHOTKyeC2nOnOcXHebD8WpHk=",
      "3402: -----END CERTIFICATE-----",
      "3404: Trustwave Global ECC P256 Certification Authority",
      "3405: =================================================",
      "3406: -----BEGIN CERTIFICATE-----",
      "3407: MIICYDCCAgegAwIBAgIMDWpfCD8oXD5Rld9dMAoGCCqGSM49BAMCMIGRMQswCQYDVQQGEwJVUzER",
      "3408: MA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRydXN0d2F2ZSBI",
      "3409: b2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDI1NiBDZXJ0aWZp",
      "3410: Y2F0aW9uIEF1dGhvcml0eTAeFw0xNzA4MjMxOTM1MTBaFw00MjA4MjMxOTM1MTBaMIGRMQswCQYD",
      "3411: VQQGEwJVUzERMA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRy",
      "3412: dXN0d2F2ZSBIb2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDI1",
      "3413: NiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH77bOYj",
      "3414: 43MyCMpg5lOcunSNGLB4kFKA3TjASh3RqMyTpJcGOMoNFWLGjgEqZZ2q3zSRLoHB5DOSMcT9CTqm",
      "3415: P62jQzBBMA8GA1UdEwEB/wQFMAMBAf8wDwYDVR0PAQH/BAUDAwcGADAdBgNVHQ4EFgQUo0EGrJBt",
      "3416: 0UrrdaVKEJmzsaGLSvcwCgYIKoZIzj0EAwIDRwAwRAIgB+ZU2g6gWrKuEZ+Hxbb/ad4lvvigtwjz",
      "3417: RM4q3wghDDcCIC0mA6AFvWvR9lz4ZcyGbbOcNEhjhAnFjXca4syc4XR7",
      "3418: -----END CERTIFICATE-----",
      "3420: Trustwave Global ECC P384 Certification Authority",
      "3421: =================================================",
      "3422: -----BEGIN CERTIFICATE-----",
      "3423: MIICnTCCAiSgAwIBAgIMCL2Fl2yZJ6SAaEc7MAoGCCqGSM49BAMDMIGRMQswCQYDVQQGEwJVUzER",
      "3424: MA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRydXN0d2F2ZSBI",
      "3425: b2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDM4NCBDZXJ0aWZp",
      "3426: Y2F0aW9uIEF1dGhvcml0eTAeFw0xNzA4MjMxOTM2NDNaFw00MjA4MjMxOTM2NDNaMIGRMQswCQYD",
      "3427: VQQGEwJVUzERMA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRy",
      "3428: dXN0d2F2ZSBIb2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDM4",
      "3429: NCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTB2MBAGByqGSM49AgEGBSuBBAAiA2IABGvaDXU1CDFH",
      "3430: Ba5FmVXxERMuSvgQMSOjfoPTfygIOiYaOs+Xgh+AtycJj9GOMMQKmw6sWASr9zZ9lCOkmwqKi6vr",
      "3431: /TklZvFe/oyujUF5nQlgziip04pt89ZF1PKYhDhloKNDMEEwDwYDVR0TAQH/BAUwAwEB/zAPBgNV",
      "3432: HQ8BAf8EBQMDBwYAMB0GA1UdDgQWBBRVqYSJ0sEyvRjLbKYHTsjnnb6CkDAKBggqhkjOPQQDAwNn",
      "3433: ADBkAjA3AZKXRRJ+oPM+rRk6ct30UJMDEr5E0k9BpIycnR+j9sKS50gU/k6bpZFXrsY3crsCMGcl",
      "3434: CrEMXu6pY5Jv5ZAL/mYiykf9ijH3g/56vxC+GCsej/YpHpRZ744hN8tRmKVuSw==",
      "3435: -----END CERTIFICATE-----",
      "",
      "---------------"
    ],
    "composer.lock||composer.lock": [
      "File: composer.lock -> composer.lock",
      "--- Hunk 1 ---",
      "[Context before]",
      "4:         \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",",
      "5:         \"This file is @generated automatically\"",
      "6:     ],",
      "8:     \"packages\": [",
      "9:         {",
      "10:             \"name\": \"claviska/simpleimage\",",
      "",
      "[Removed Lines]",
      "7:     \"content-hash\": \"b85ce02787ff0e052a3cc7a01c2daa91\",",
      "",
      "[Added Lines]",
      "7:     \"content-hash\": \"1ca40c0fbd9e8d3584e7ae28b84e0a1c\",",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "142:             ],",
      "143:             \"description\": \"Kirby's custom Composer installer for the Kirby CMS and for Kirby plugins\",",
      "144:             \"homepage\": \"https://getkirby.com\",",
      "145:             \"time\": \"2020-09-13T14:43:34+00:00\"",
      "146:         },",
      "147:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "145:             \"support\": {",
      "146:                 \"issues\": \"https://github.com/getkirby/composer-installer/issues\",",
      "147:                 \"source\": \"https://github.com/getkirby/composer-installer/tree/1.2.0\"",
      "148:             },",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "239:                 \"laminas\",",
      "240:                 \"zf\"",
      "241:             ],",
      "242:             \"time\": \"2020-09-14T14:23:00+00:00\"",
      "243:         },",
      "244:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "246:             \"support\": {",
      "247:                 \"forum\": \"https://discourse.laminas.dev/\",",
      "248:                 \"issues\": \"https://github.com/laminas/laminas-zendframework-bridge/issues\",",
      "249:                 \"rss\": \"https://github.com/laminas/laminas-zendframework-bridge/releases.atom\",",
      "250:                 \"source\": \"https://github.com/laminas/laminas-zendframework-bridge\"",
      "251:             },",
      "252:             \"funding\": [",
      "253:                 {",
      "254:                     \"url\": \"https://funding.communitybridge.org/projects/laminas-project\",",
      "255:                     \"type\": \"community_bridge\"",
      "256:                 }",
      "257:             ],",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "293:                 \"image\",",
      "294:                 \"palette\"",
      "295:             ],",
      "296:             \"time\": \"2016-12-15T09:30:02+00:00\"",
      "297:         },",
      "298:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "312:             \"support\": {",
      "313:                 \"issues\": \"https://github.com/thephpleague/color-extractor/issues\",",
      "314:                 \"source\": \"https://github.com/thephpleague/color-extractor/tree/master\"",
      "315:             },",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "343:                 \"typographer\",",
      "344:                 \"typography\"",
      "345:             ],",
      "346:             \"time\": \"2016-12-13T01:01:17+00:00\"",
      "347:         },",
      "348:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "366:             \"support\": {",
      "367:                 \"issues\": \"https://github.com/michelf/php-smartypants/issues\",",
      "368:                 \"source\": \"https://github.com/michelf/php-smartypants/tree/1.8.1\"",
      "369:             },",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "455:                 }",
      "456:             ],",
      "457:             \"description\": \"PHPMailer is a full-featured email creation and transfer class for PHP\",",
      "458:             \"time\": \"2020-05-27T12:24:03+00:00\"",
      "459:         },",
      "460:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "482:             \"funding\": [",
      "483:                 {",
      "484:                     \"url\": \"https://github.com/synchro\",",
      "485:                     \"type\": \"github\"",
      "486:                 }",
      "487:             ],",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "502:                 \"psr\",",
      "503:                 \"psr-3\"",
      "504:             ],",
      "505:             \"time\": \"2020-03-23T09:12:05+00:00\"",
      "506:         },",
      "507:         {",
      "508:             \"name\": \"symfony/polyfill-mbstring\",",
      "510:             \"source\": {",
      "511:                 \"type\": \"git\",",
      "512:                 \"url\": \"https://github.com/symfony/polyfill-mbstring.git\",",
      "514:             },",
      "515:             \"dist\": {",
      "516:                 \"type\": \"zip\",",
      "519:                 \"shasum\": \"\"",
      "520:             },",
      "521:             \"require\": {",
      "523:             },",
      "524:             \"suggest\": {",
      "525:                 \"ext-mbstring\": \"For best performance\"",
      "",
      "[Removed Lines]",
      "509:             \"version\": \"v1.18.1\",",
      "513:                 \"reference\": \"a6977d63bf9a0ad4c65cd352709e230876f9904a\"",
      "517:                 \"url\": \"https://api.github.com/repos/symfony/polyfill-mbstring/zipball/a6977d63bf9a0ad4c65cd352709e230876f9904a\",",
      "518:                 \"reference\": \"a6977d63bf9a0ad4c65cd352709e230876f9904a\",",
      "522:                 \"php\": \">=5.3.3\"",
      "",
      "[Added Lines]",
      "535:             \"support\": {",
      "536:                 \"source\": \"https://github.com/php-fig/log/tree/1.1.3\"",
      "537:             },",
      "542:             \"version\": \"v1.20.0\",",
      "546:                 \"reference\": \"39d483bdf39be819deabf04ec872eb0b2410b531\"",
      "550:                 \"url\": \"https://api.github.com/repos/symfony/polyfill-mbstring/zipball/39d483bdf39be819deabf04ec872eb0b2410b531\",",
      "551:                 \"reference\": \"39d483bdf39be819deabf04ec872eb0b2410b531\",",
      "555:                 \"php\": \">=7.1\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "527:             \"type\": \"library\",",
      "528:             \"extra\": {",
      "529:                 \"branch-alias\": {",
      "531:                 },",
      "532:                 \"thanks\": {",
      "533:                     \"name\": \"symfony/polyfill\",",
      "",
      "[Removed Lines]",
      "530:                     \"dev-master\": \"1.18-dev\"",
      "",
      "[Added Lines]",
      "563:                     \"dev-main\": \"1.20-dev\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "565:                 \"portable\",",
      "566:                 \"shim\"",
      "567:             ],",
      "569:         },",
      "570:         {",
      "571:             \"name\": \"true/punycode\",",
      "",
      "[Removed Lines]",
      "568:             \"time\": \"2020-07-14T12:35:20+00:00\"",
      "",
      "[Added Lines]",
      "601:             \"support\": {",
      "602:                 \"source\": \"https://github.com/symfony/polyfill-mbstring/tree/v1.20.0\"",
      "603:             },",
      "604:             \"funding\": [",
      "605:                 {",
      "606:                     \"url\": \"https://symfony.com/sponsor\",",
      "607:                     \"type\": \"custom\"",
      "608:                 },",
      "609:                 {",
      "610:                     \"url\": \"https://github.com/fabpot\",",
      "611:                     \"type\": \"github\"",
      "612:                 },",
      "613:                 {",
      "614:                     \"url\": \"https://tidelift.com/funding/github/packagist/symfony/symfony\",",
      "615:                     \"type\": \"tidelift\"",
      "616:                 }",
      "617:             ],",
      "618:             \"time\": \"2020-10-23T14:02:19+00:00\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "611:                 \"idna\",",
      "612:                 \"punycode\"",
      "613:             ],",
      "614:             \"time\": \"2016-11-16T10:37:54+00:00\"",
      "615:         }",
      "616:     ],",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "664:             \"support\": {",
      "665:                 \"issues\": \"https://github.com/true/php-punycode/issues\",",
      "666:                 \"source\": \"https://github.com/true/php-punycode/tree/master\"",
      "667:             },",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "625:         \"ext-mbstring\": \"*\",",
      "626:         \"ext-ctype\": \"*\"",
      "627:     },",
      "629: }",
      "",
      "[Removed Lines]",
      "628:     \"platform-dev\": []",
      "",
      "[Added Lines]",
      "682:     \"platform-dev\": [],",
      "683:     \"plugin-api-version\": \"1.1.0\"",
      "",
      "---------------"
    ],
    "src/Cms/FileRules.php||src/Cms/FileRules.php": [
      "File: src/Cms/FileRules.php -> src/Cms/FileRules.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "82:             throw new PermissionException('The file cannot be created');",
      "83:         }",
      "89:         $upload->match($file->blueprint()->accept());",
      "",
      "[Removed Lines]",
      "85:         static::validExtension($file, $file->extension());",
      "86:         static::validMime($file, $upload->mime());",
      "87:         static::validFilename($file, $file->filename());",
      "",
      "[Added Lines]",
      "85:         static::validFile($file, $upload->mime());",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "176:             ]);",
      "177:         }",
      "180:             throw new InvalidArgumentException([",
      "181:                 'key'  => 'file.extension.forbidden',",
      "182:                 'data' => ['extension' => $extension]",
      "183:             ]);",
      "184:         }",
      "187:             throw new InvalidArgumentException([",
      "188:                 'key'  => 'file.type.forbidden',",
      "189:                 'data' => ['type' => 'PHP']",
      "",
      "[Removed Lines]",
      "179:         if (V::in($extension, ['php', 'html', 'htm', 'exe', App::instance()->contentExtension()])) {",
      "186:         if (Str::contains($extension, 'php')) {",
      "",
      "[Added Lines]",
      "177:         if (V::in($extension, ['php', 'phar', 'html', 'htm', 'exe', App::instance()->contentExtension()])) {",
      "184:         if (Str::contains($extension, 'php') || Str::contains($extension, 'phar')) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "200:         return true;",
      "201:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "209:     public static function validFile(File $file, ?string $mime = null): bool",
      "210:     {",
      "211:         return",
      "212:             static::validExtension($file, $file->extension()) &&",
      "213:             static::validMime($file, $mime ?? $file->mime()) &&",
      "214:             static::validFilename($file, $file->filename());",
      "215:     }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "212:     {",
      "214:         $filename = strtolower($filename);",
      "",
      "[Removed Lines]",
      "211:     public static function validFilename(File $file, string $filename)",
      "",
      "[Added Lines]",
      "225:     public static function validFilename(File $file, string $filename): bool",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "251:     {",
      "253:         $mime = strtolower($mime);",
      "",
      "[Removed Lines]",
      "250:     public static function validMime(File $file, string $mime = null)",
      "",
      "[Added Lines]",
      "264:     public static function validMime(File $file, string $mime = null): bool",
      "",
      "---------------"
    ],
    "src/Cms/Media.php||src/Cms/Media.php": [
      "File: src/Cms/Media.php -> src/Cms/Media.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "71:     public static function publish(File $file, string $dest): bool",
      "72:     {",
      "73:         $src       = $file->root();",
      "74:         $version   = dirname($dest);",
      "75:         $directory = dirname($version);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "74:         FileRules::validFile($file);",
      "",
      "---------------"
    ],
    "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php": [
      "File: tests/Cms/Files/FileRulesTest.php -> tests/Cms/Files/FileRulesTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "190:             ['htm', false, 'The extension \"htm\" is not allowed'],",
      "191:             ['html', false, 'The extension \"html\" is not allowed'],",
      "192:             ['php', false, 'The extension \"php\" is not allowed'],",
      "193:             ['exe', false, 'The extension \"exe\" is not allowed'],",
      "194:             ['php4', false, 'You are not allowed to upload PHP files'],",
      "195:         ];",
      "196:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "193:             ['phar', false, 'The extension \"phar\" is not allowed'],",
      "196:             ['1phar2', false, 'You are not allowed to upload PHP files'],",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "213:         $this->assertTrue($result);",
      "214:     }",
      "216:     public function filenameProvider()",
      "217:     {",
      "218:         return [",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "218:     public function fileProvider()",
      "219:     {",
      "220:         return [",
      "222:             ['test.jpg', 'jpg', 'image/jpeg', true],",
      "223:             ['abc.png', 'png', 'image/png', true],",
      "226:             ['test', '', 'text/plain', false, 'The extensions for \"test\" is missing'],",
      "227:             ['test.htm', 'htm', 'text/plain', false, 'The extension \"htm\" is not allowed'],",
      "228:             ['test.html', 'html', 'text/plain', false, 'The extension \"html\" is not allowed'],",
      "229:             ['test.php', 'php', 'text/plain', false, 'The extension \"php\" is not allowed'],",
      "230:             ['test.phar', 'phar', 'text/plain', false, 'The extension \"phar\" is not allowed'],",
      "231:             ['test.exe', 'exe', 'text/plain', false, 'The extension \"exe\" is not allowed'],",
      "232:             ['test.php4', 'php4', 'text/plain', false, 'You are not allowed to upload PHP files'],",
      "233:             ['test.1phar2', '1phar2', 'text/plain', false, 'You are not allowed to upload PHP files'],",
      "236:             ['test', 'jpg', '', false, 'The media type for \"test\" cannot be detected'],",
      "237:             ['test.jpg', 'jpg', 'application/php', false, 'You are not allowed to upload PHP files'],",
      "238:             ['test.jpg', 'jpg', 'text/html', false, 'The media type \"text/html\" is not allowed'],",
      "239:             ['test.jpg', 'jpg', 'application/x-msdownload', false, 'The media type \"application/x-msdownload\" is not allowed'],",
      "242:             ['', 'jpg', 'image/jpg', false, 'The filename must not be empty'],",
      "243:             ['.htaccess', 'htaccess', 'application/x-apache', false, 'You are not allowed to upload Apache config files'],",
      "244:             ['.htpasswd', 'htpasswd', 'application/x-apache', false, 'You are not allowed to upload Apache config files'],",
      "245:             ['.gitignore', 'gitignore', 'application/x-git', false, 'You are not allowed to upload invisible files'],",
      "248:             ['.test.htm', 'htm', 'application/php', false, 'The extension \"htm\" is not allowed'],",
      "249:             ['.test.htm', 'jpg', 'application/php', false, 'You are not allowed to upload PHP files'],",
      "250:             ['.test.htm', 'jpg', 'text/plain', false, 'You are not allowed to upload invisible files'],",
      "251:         ];",
      "252:     }",
      "257:     public function testValidFile($filename, $extension, $mime, $expected, $message = null)",
      "258:     {",
      "259:         $file = $this->getMockBuilder(File::class)",
      "260:             ->disableOriginalConstructor()",
      "261:             ->onlyMethods(['filename', 'extension'])",
      "262:             ->addMethods(['mime'])",
      "263:             ->getMock();",
      "264:         $file->method('filename')->willReturn($filename);",
      "265:         $file->method('extension')->willReturn($extension);",
      "266:         $file->method('mime')->willReturn($mime);",
      "268:         if ($expected === false) {",
      "269:             $this->expectException('Kirby\\Exception\\InvalidArgumentException');",
      "270:             $this->expectExceptionMessage($message);",
      "271:         }",
      "273:         $result = FileRules::validFile($file);",
      "275:         $this->assertTrue($result);",
      "276:     }",
      "",
      "---------------"
    ],
    "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php": [
      "File: vendor/composer/ClassLoader.php -> vendor/composer/ClassLoader.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "60:     public function getPrefixes()",
      "61:     {",
      "62:         if (!empty($this->prefixesPsr0)) {",
      "64:         }",
      "66:         return array();",
      "",
      "[Removed Lines]",
      "63:             return call_user_func_array('array_merge', $this->prefixesPsr0);",
      "",
      "[Added Lines]",
      "63:             return call_user_func_array('array_merge', array_values($this->prefixesPsr0));",
      "",
      "---------------"
    ],
    "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php": [
      "File: vendor/composer/autoload_real.php -> vendor/composer/autoload_real.php"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "abc9e124db28a76a409b874f6d5ed2c2ef4cda46",
      "candidate_info": {
        "commit_hash": "abc9e124db28a76a409b874f6d5ed2c2ef4cda46",
        "repo": "getkirby/kirby",
        "commit_url": "https://github.com/getkirby/kirby/commit/abc9e124db28a76a409b874f6d5ed2c2ef4cda46",
        "files": [
          "src/Cms/FileRules.php"
        ],
        "message": "Cleanup",
        "before_after_code_files": [
          "src/Cms/FileRules.php||src/Cms/FileRules.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/getkirby/kirby/pull/2962"
        ],
        "olp_code_files": {
          "patch": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php"
          ],
          "candidate": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Cms/FileRules.php||src/Cms/FileRules.php": [
          "File: src/Cms/FileRules.php -> src/Cms/FileRules.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "226:     {",
          "228:         $filename = strtolower($filename);",
          "",
          "[Removed Lines]",
          "225:     public static function validFilename(File $file, string $filename)",
          "",
          "[Added Lines]",
          "225:     public static function validFilename(File $file, string $filename): bool",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "265:     {",
          "267:         $mime = strtolower($mime);",
          "",
          "[Removed Lines]",
          "264:     public static function validMime(File $file, string $mime = null)",
          "",
          "[Added Lines]",
          "264:     public static function validMime(File $file, string $mime = null): bool",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dbe293cdffe8052e571d50126756ed9cdf218c3b",
      "candidate_info": {
        "commit_hash": "dbe293cdffe8052e571d50126756ed9cdf218c3b",
        "repo": "getkirby/kirby",
        "commit_url": "https://github.com/getkirby/kirby/commit/dbe293cdffe8052e571d50126756ed9cdf218c3b",
        "files": [
          "cacert.pem",
          "composer.json",
          "composer.lock",
          "vendor/composer/ClassLoader.php",
          "vendor/composer/autoload_real.php"
        ],
        "message": "Update version number and composer.lock",
        "before_after_code_files": [
          "cacert.pem||cacert.pem",
          "composer.lock||composer.lock",
          "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php",
          "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/getkirby/kirby/pull/2962"
        ],
        "olp_code_files": {
          "patch": [
            "cacert.pem||cacert.pem",
            "composer.lock||composer.lock",
            "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php",
            "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php"
          ],
          "candidate": [
            "cacert.pem||cacert.pem",
            "composer.lock||composer.lock",
            "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php",
            "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php"
          ]
        }
      },
      "candidate_diff": {
        "cacert.pem||cacert.pem": [
          "File: cacert.pem -> cacert.pem",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: ##",
          "2: ## Bundle of CA Root Certificates",
          "3: ##",
          "5: ##",
          "6: ## This is a bundle of X.509 certificates of public Certificate Authorities",
          "7: ## (CA). These were automatically extracted from Mozilla's root certificates",
          "",
          "[Removed Lines]",
          "4: ## Certificate data from Mozilla as of: Wed Jul 22 03:12:14 2020 GMT",
          "",
          "[Added Lines]",
          "4: ## Certificate data from Mozilla as of: Wed Oct 14 03:12:15 2020 GMT",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14: ## Just configure this file as the SSLCACertificateFile.",
          "15: ##",
          "16: ## Conversion done with mk-ca-bundle.pl version 1.28.",
          "18: ##",
          "",
          "[Removed Lines]",
          "17: ## SHA256: cc6408bd4be7fbfb8699bdb40ccb7f6de5780d681d87785ea362646e4dad5e8e",
          "",
          "[Added Lines]",
          "17: ## SHA256: a831d3bc63ba1f65478afe28038742b7150c0c2efd243ac342b64792a75d2038",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "448: QBFGmh95DmK/D5fs4C8fF5Q=",
          "449: -----END CERTIFICATE-----",
          "481: DigiCert Assured ID Root CA",
          "482: ===========================",
          "483: -----BEGIN CERTIFICATE-----",
          "",
          "[Removed Lines]",
          "451: Taiwan GRCA",
          "452: ===========",
          "453: -----BEGIN CERTIFICATE-----",
          "454: MIIFcjCCA1qgAwIBAgIQH51ZWtcvwgZEpYAIaeNe9jANBgkqhkiG9w0BAQUFADA/MQswCQYDVQQG",
          "455: EwJUVzEwMC4GA1UECgwnR292ZXJubWVudCBSb290IENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4X",
          "456: DTAyMTIwNTEzMjMzM1oXDTMyMTIwNTEzMjMzM1owPzELMAkGA1UEBhMCVFcxMDAuBgNVBAoMJ0dv",
          "457: dmVybm1lbnQgUm9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCCAiIwDQYJKoZIhvcNAQEBBQAD",
          "458: ggIPADCCAgoCggIBAJoluOzMonWoe/fOW1mKydGGEghU7Jzy50b2iPN86aXfTEc2pBsBHH8eV4qN",
          "459: w8XRIePaJD9IK/ufLqGU5ywck9G/GwGHU5nOp/UKIXZ3/6m3xnOUT0b3EEk3+qhZSV1qgQdW8or5",
          "460: BtD3cCJNtLdBuTK4sfCxw5w/cP1T3YGq2GN49thTbqGsaoQkclSGxtKyyhwOeYHWtXBiCAEuTk8O",
          "461: 1RGvqa/lmr/czIdtJuTJV6L7lvnM4T9TjGxMfptTCAtsF/tnyMKtsc2AtJfcdgEWFelq16TheEfO",
          "462: htX7MfP6Mb40qij7cEwdScevLJ1tZqa2jWR+tSBqnTuBto9AAGdLiYa4zGX+FVPpBMHWXx1E1wov",
          "463: J5pGfaENda1UhhXcSTvxls4Pm6Dso3pdvtUqdULle96ltqqvKKyskKw4t9VoNSZ63Pc78/1Fm9G7",
          "464: Q3hub/FCVGqY8A2tl+lSXunVanLeavcbYBT0peS2cWeqH+riTcFCQP5nRhc4L0c/cZyu5SHKYS1t",
          "465: B6iEfC3uUSXxY5Ce/eFXiGvviiNtsea9P63RPZYLhY3Naye7twWb7LuRqQoHEgKXTiCQ8P8NHuJB",
          "466: O9NAOueNXdpm5AKwB1KYXA6OM5zCppX7VRluTI6uSw+9wThNXo+EHWbNxWCWtFJaBYmOlXqYwZE8",
          "467: lSOyDvR5tMl8wUohAgMBAAGjajBoMB0GA1UdDgQWBBTMzO/MKWCkO7GStjz6MmKPrCUVOzAMBgNV",
          "468: HRMEBTADAQH/MDkGBGcqBwAEMTAvMC0CAQAwCQYFKw4DAhoFADAHBgVnKgMAAAQUA5vwIhP/lSg2",
          "469: 09yewDL7MTqKUWUwDQYJKoZIhvcNAQEFBQADggIBAECASvomyc5eMN1PhnR2WPWus4MzeKR6dBcZ",
          "470: TulStbngCnRiqmjKeKBMmo4sIy7VahIkv9Ro04rQ2JyftB8M3jh+Vzj8jeJPXgyfqzvS/3WXy6Tj",
          "471: Zwj/5cAWtUgBfen5Cv8b5Wppv3ghqMKnI6mGq3ZW6A4M9hPdKmaKZEk9GhiHkASfQlK3T8v+R0F2",
          "472: Ne//AHY2RTKbxkaFXeIksB7jSJaYV0eUVXoPQbFEJPPB/hprv4j9wabak2BegUqZIJxIZhm1AHlU",
          "473: D7gsL0u8qV1bYH+Mh6XgUmMqvtg7hUAV/h62ZT/FS9p+tXo1KaMuephgIqP0fSdOLeq0dDzpD6Qz",
          "474: DxARvBMB1uUO07+1EqLhRSPAzAhuYbeJq4PjJB7mXQfnHyA+z2fI56wwbSdLaG5LKlwCCDTb+Hbk",
          "475: Z6MmnD+iMsJKxYEYMRBWqoTvLQr/uB930r+lWKBi5NdLkXWNiYCYfm3LU05er/ayl4WXudpVBrkk",
          "476: 7tfGOB5jGxI7leFYrPLfhNVfmS8NVVvmONsuP3LpSIXLuykTjx44VbnzssQwmSNOXfJIoRIM3BKQ",
          "477: CZBUkQM8R+XVyWXgt0t97EfTsws+rZ7QdAAO671RrcDeLMDDav7v3Aun+kbfYNucpllQdSNpc5Oy",
          "478: +fwC00fmcc4QAu4njIT/rEUNE1yDMuAlpYYsfPQS",
          "479: -----END CERTIFICATE-----",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "806: U/7dIOA1mjbRxwG55tzd8/8dLDoWV9mSOdY=",
          "807: -----END CERTIFICATE-----",
          "832: Certigna",
          "833: ========",
          "834: -----BEGIN CERTIFICATE-----",
          "",
          "[Removed Lines]",
          "809: OISTE WISeKey Global Root GA CA",
          "810: ===============================",
          "811: -----BEGIN CERTIFICATE-----",
          "812: MIID8TCCAtmgAwIBAgIQQT1yx/RrH4FDffHSKFTfmjANBgkqhkiG9w0BAQUFADCBijELMAkGA1UE",
          "813: BhMCQ0gxEDAOBgNVBAoTB1dJU2VLZXkxGzAZBgNVBAsTEkNvcHlyaWdodCAoYykgMjAwNTEiMCAG",
          "814: A1UECxMZT0lTVEUgRm91bmRhdGlvbiBFbmRvcnNlZDEoMCYGA1UEAxMfT0lTVEUgV0lTZUtleSBH",
          "815: bG9iYWwgUm9vdCBHQSBDQTAeFw0wNTEyMTExNjAzNDRaFw0zNzEyMTExNjA5NTFaMIGKMQswCQYD",
          "816: VQQGEwJDSDEQMA4GA1UEChMHV0lTZUtleTEbMBkGA1UECxMSQ29weXJpZ2h0IChjKSAyMDA1MSIw",
          "817: IAYDVQQLExlPSVNURSBGb3VuZGF0aW9uIEVuZG9yc2VkMSgwJgYDVQQDEx9PSVNURSBXSVNlS2V5",
          "818: IEdsb2JhbCBSb290IEdBIENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy0+zAJs9",
          "819: Nt350UlqaxBJH+zYK7LG+DKBKUOVTJoZIyEVRd7jyBxRVVuuk+g3/ytr6dTqvirdqFEr12bDYVxg",
          "820: Asj1znJ7O7jyTmUIms2kahnBAbtzptf2w93NvKSLtZlhuAGio9RN1AU9ka34tAhxZK9w8RxrfvbD",
          "821: d50kc3vkDIzh2TbhmYsFmQvtRTEJysIA2/dyoJaqlYfQjse2YXMNdmaM3Bu0Y6Kff5MTMPGhJ9vZ",
          "822: /yxViJGg4E8HsChWjBgbl0SOid3gF27nKu+POQoxhILYQBRJLnpB5Kf+42TMwVlxSywhp1t94B3R",
          "823: LoGbw9ho972WG6xwsRYUC9tguSYBBQIDAQABo1EwTzALBgNVHQ8EBAMCAYYwDwYDVR0TAQH/BAUw",
          "824: AwEB/zAdBgNVHQ4EFgQUswN+rja8sHnR3JQmthG+IbJphpQwEAYJKwYBBAGCNxUBBAMCAQAwDQYJ",
          "825: KoZIhvcNAQEFBQADggEBAEuh/wuHbrP5wUOxSPMowB0uyQlB+pQAHKSkq0lPjz0e701vvbyk9vIm",
          "826: MMkQyh2I+3QZH4VFvbBsUfk2ftv1TDI6QU9bR8/oCy22xBmddMVHxjtqD6wU2zz0c5ypBd8A3HR4",
          "827: +vg1YFkCExh8vPtNsCBtQ7tgMHpnM1zFmdH4LTlSc/uMqpclXHLZCB6rTjzjgTGfA6b7wP4piFXa",
          "828: hNVQA7bihKOmNqoROgHhGEvWRGizPflTdISzRpFGlgC3gCy24eMQ4tui5yiPAZZiFj4A4xylNoEY",
          "829: okxSdsARo27mHbrjWr42U8U+dY+GaSlYU7Wcu2+fXMUY7N0v4ZjJ/L7fCg0=",
          "830: -----END CERTIFICATE-----",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1709: e9eiPZaGzPImNC1qkp2aGtAw4l1OBLBfiyB+d8E9lYLRRpo7PHi4b6HQDWSieB4pTpPDpFQUWw==",
          "1710: -----END CERTIFICATE-----",
          "1736: D-TRUST Root Class 3 CA 2 2009",
          "1737: ==============================",
          "1738: -----BEGIN CERTIFICATE-----",
          "",
          "[Removed Lines]",
          "1712: EE Certification Centre Root CA",
          "1713: ===============================",
          "1714: -----BEGIN CERTIFICATE-----",
          "1715: MIIEAzCCAuugAwIBAgIQVID5oHPtPwBMyonY43HmSjANBgkqhkiG9w0BAQUFADB1MQswCQYDVQQG",
          "1716: EwJFRTEiMCAGA1UECgwZQVMgU2VydGlmaXRzZWVyaW1pc2tlc2t1czEoMCYGA1UEAwwfRUUgQ2Vy",
          "1717: dGlmaWNhdGlvbiBDZW50cmUgUm9vdCBDQTEYMBYGCSqGSIb3DQEJARYJcGtpQHNrLmVlMCIYDzIw",
          "1718: MTAxMDMwMTAxMDMwWhgPMjAzMDEyMTcyMzU5NTlaMHUxCzAJBgNVBAYTAkVFMSIwIAYDVQQKDBlB",
          "1719: UyBTZXJ0aWZpdHNlZXJpbWlza2Vza3VzMSgwJgYDVQQDDB9FRSBDZXJ0aWZpY2F0aW9uIENlbnRy",
          "1720: ZSBSb290IENBMRgwFgYJKoZIhvcNAQkBFglwa2lAc2suZWUwggEiMA0GCSqGSIb3DQEBAQUAA4IB",
          "1721: DwAwggEKAoIBAQDIIMDs4MVLqwd4lfNE7vsLDP90jmG7sWLqI9iroWUyeuuOF0+W2Ap7kaJjbMeM",
          "1722: TC55v6kF/GlclY1i+blw7cNRfdCT5mzrMEvhvH2/UpvObntl8jixwKIy72KyaOBhU8E2lf/slLo2",
          "1723: rpwcpzIP5Xy0xm90/XsY6KxX7QYgSzIwWFv9zajmofxwvI6Sc9uXp3whrj3B9UiHbCe9nyV0gVWw",
          "1724: 93X2PaRka9ZP585ArQ/dMtO8ihJTmMmJ+xAdTX7Nfh9WDSFwhfYggx/2uh8Ej+p3iDXE/+pOoYtN",
          "1725: P2MbRMNE1CV2yreN1x5KZmTNXMWcg+HCCIia7E6j8T4cLNlsHaFLAgMBAAGjgYowgYcwDwYDVR0T",
          "1726: AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAQYwHQYDVR0OBBYEFBLyWj7qVhy/zQas8fElyalL1BSZ",
          "1727: MEUGA1UdJQQ+MDwGCCsGAQUFBwMCBggrBgEFBQcDAQYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEF",
          "1728: BQcDCAYIKwYBBQUHAwkwDQYJKoZIhvcNAQEFBQADggEBAHv25MANqhlHt01Xo/6tu7Fq1Q+e2+Rj",
          "1729: xY6hUFaTlrg4wCQiZrxTFGGVv9DHKpY5P30osxBAIWrEr7BSdxjhlthWXePdNl4dp1BUoMUq5KqM",
          "1730: lIpPnTX/dqQGE5Gion0ARD9V04I8GtVbvFZMIi5GQ4okQC3zErg7cBqklrkar4dBGmoYDQZPxz5u",
          "1731: uSlNDUmJEYcyW+ZLBMjkXOZ0c5RdFpgTlf7727FE5TpwrDdr5rMzcijJs1eg9gIWiAYLtqZLICjU",
          "1732: 3j2LrTcFU3T+bsy8QxdxXvnFzBqpYe73dgzzcvRyrc9yAjYHR8/vGVCJYMzpJJUPwssd8m92kMfM",
          "1733: dcGWxZ0=",
          "1734: -----END CERTIFICATE-----",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3445: NMn5X7azKFGnpyuqSfqNZSlO42sTp5SjLVFteAxEy9/eCG/Oo2Sr05WE1LlSVHJ7liXMvGnjSG4N",
          "3446: 0MedJ5qq+BOS3R7fY581qRY27Iy4g/Q9iY/NtBde17MXQRBdJ3NghVdJIgc=",
          "3447: -----END CERTIFICATE-----",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3372: Trustwave Global Certification Authority",
          "3373: ========================================",
          "3374: -----BEGIN CERTIFICATE-----",
          "3375: MIIF2jCCA8KgAwIBAgIMBfcOhtpJ80Y1LrqyMA0GCSqGSIb3DQEBCwUAMIGIMQswCQYDVQQGEwJV",
          "3376: UzERMA8GA1UECAwISWxsaW5vaXMxEDAOBgNVBAcMB0NoaWNhZ28xITAfBgNVBAoMGFRydXN0d2F2",
          "3377: ZSBIb2xkaW5ncywgSW5jLjExMC8GA1UEAwwoVHJ1c3R3YXZlIEdsb2JhbCBDZXJ0aWZpY2F0aW9u",
          "3378: IEF1dGhvcml0eTAeFw0xNzA4MjMxOTM0MTJaFw00MjA4MjMxOTM0MTJaMIGIMQswCQYDVQQGEwJV",
          "3379: UzERMA8GA1UECAwISWxsaW5vaXMxEDAOBgNVBAcMB0NoaWNhZ28xITAfBgNVBAoMGFRydXN0d2F2",
          "3380: ZSBIb2xkaW5ncywgSW5jLjExMC8GA1UEAwwoVHJ1c3R3YXZlIEdsb2JhbCBDZXJ0aWZpY2F0aW9u",
          "3381: IEF1dGhvcml0eTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBALldUShLPDeS0YLOvR29",
          "3382: zd24q88KPuFd5dyqCblXAj7mY2Hf8g+CY66j96xz0XznswuvCAAJWX/NKSqIk4cXGIDtiLK0thAf",
          "3383: LdZfVaITXdHG6wZWiYj+rDKd/VzDBcdu7oaJuogDnXIhhpCujwOl3J+IKMujkkkP7NAP4m1ET4Bq",
          "3384: stTnoApTAbqOl5F2brz81Ws25kCI1nsvXwXoLG0R8+eyvpJETNKXpP7ScoFDB5zpET71ixpZfR9o",
          "3385: WN0EACyW80OzfpgZdNmcc9kYvkHHNHnZ9GLCQ7mzJ7Aiy/k9UscwR7PJPrhq4ufogXBeQotPJqX+",
          "3386: OsIgbrv4Fo7NDKm0G2x2EOFYeUY+VM6AqFcJNykbmROPDMjWLBz7BegIlT1lRtzuzWniTY+HKE40",
          "3387: Cz7PFNm73bZQmq131BnW2hqIyE4bJ3XYsgjxroMwuREOzYfwhI0Vcnyh78zyiGG69Gm7DIwLdVcE",
          "3388: uE4qFC49DxweMqZiNu5m4iK4BUBjECLzMx10coos9TkpoNPnG4CELcU9402x/RpvumUHO1jsQkUm",
          "3389: +9jaJXLE9gCxInm943xZYkqcBW89zubWR2OZxiRvchLIrH+QtAuRcOi35hYQcRfO3gZPSEF9NUqj",
          "3390: ifLJS3tBEW1ntwiYTOURGa5CgNz7kAXU+FDKvuStx8KU1xad5hePrzb7AgMBAAGjQjBAMA8GA1Ud",
          "3391: EwEB/wQFMAMBAf8wHQYDVR0OBBYEFJngGWcNYtt2s9o9uFvo/ULSMQ6HMA4GA1UdDwEB/wQEAwIB",
          "3392: BjANBgkqhkiG9w0BAQsFAAOCAgEAmHNw4rDT7TnsTGDZqRKGFx6W0OhUKDtkLSGm+J1WE2pIPU/H",
          "3393: PinbbViDVD2HfSMF1OQc3Og4ZYbFdada2zUFvXfeuyk3QAUHw5RSn8pk3fEbK9xGChACMf1KaA0H",
          "3394: ZJDmHvUqoai7PF35owgLEQzxPy0QlG/+4jSHg9bP5Rs1bdID4bANqKCqRieCNqcVtgimQlRXtpla",
          "3395: 4gt5kNdXElE1GYhBaCXUNxeEFfsBctyV3lImIJgm4nb1J2/6ADtKYdkNy1GTKv0WBpanI5ojSP5R",
          "3396: vbbEsLFUzt5sQa0WZ37b/TjNuThOssFgy50X31ieemKyJo90lZvkWx3SD92YHJtZuSPTMaCm/zjd",
          "3397: zyBP6VhWOmfD0faZmZ26NraAL4hHT4a/RDqA5Dccprrql5gR0IRiR2Qequ5AvzSxnI9O4fKSTx+O",
          "3398: 856X3vOmeWqJcU9LJxdI/uz0UA9PSX3MReO9ekDFQdxhVicGaeVyQYHTtgGJoC86cnn+OjC/QezH",
          "3399: Yj6RS8fZMXZC+fc8Y+wmjHMMfRod6qh8h6jCJ3zhM0EPz8/8AKAigJ5Kp28AsEFFtyLKaEjFQqKu",
          "3400: 3R3y4G5OBVixwJAWKqQ9EEC+j2Jjg6mcgn0tAumDMHzLJ8n9HmYAsC7TIS+OMxZsmO0QqAfWzJPP",
          "3401: 29FpHOTKyeC2nOnOcXHebD8WpHk=",
          "3402: -----END CERTIFICATE-----",
          "3404: Trustwave Global ECC P256 Certification Authority",
          "3405: =================================================",
          "3406: -----BEGIN CERTIFICATE-----",
          "3407: MIICYDCCAgegAwIBAgIMDWpfCD8oXD5Rld9dMAoGCCqGSM49BAMCMIGRMQswCQYDVQQGEwJVUzER",
          "3408: MA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRydXN0d2F2ZSBI",
          "3409: b2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDI1NiBDZXJ0aWZp",
          "3410: Y2F0aW9uIEF1dGhvcml0eTAeFw0xNzA4MjMxOTM1MTBaFw00MjA4MjMxOTM1MTBaMIGRMQswCQYD",
          "3411: VQQGEwJVUzERMA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRy",
          "3412: dXN0d2F2ZSBIb2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDI1",
          "3413: NiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH77bOYj",
          "3414: 43MyCMpg5lOcunSNGLB4kFKA3TjASh3RqMyTpJcGOMoNFWLGjgEqZZ2q3zSRLoHB5DOSMcT9CTqm",
          "3415: P62jQzBBMA8GA1UdEwEB/wQFMAMBAf8wDwYDVR0PAQH/BAUDAwcGADAdBgNVHQ4EFgQUo0EGrJBt",
          "3416: 0UrrdaVKEJmzsaGLSvcwCgYIKoZIzj0EAwIDRwAwRAIgB+ZU2g6gWrKuEZ+Hxbb/ad4lvvigtwjz",
          "3417: RM4q3wghDDcCIC0mA6AFvWvR9lz4ZcyGbbOcNEhjhAnFjXca4syc4XR7",
          "3418: -----END CERTIFICATE-----",
          "3420: Trustwave Global ECC P384 Certification Authority",
          "3421: =================================================",
          "3422: -----BEGIN CERTIFICATE-----",
          "3423: MIICnTCCAiSgAwIBAgIMCL2Fl2yZJ6SAaEc7MAoGCCqGSM49BAMDMIGRMQswCQYDVQQGEwJVUzER",
          "3424: MA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRydXN0d2F2ZSBI",
          "3425: b2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDM4NCBDZXJ0aWZp",
          "3426: Y2F0aW9uIEF1dGhvcml0eTAeFw0xNzA4MjMxOTM2NDNaFw00MjA4MjMxOTM2NDNaMIGRMQswCQYD",
          "3427: VQQGEwJVUzERMA8GA1UECBMISWxsaW5vaXMxEDAOBgNVBAcTB0NoaWNhZ28xITAfBgNVBAoTGFRy",
          "3428: dXN0d2F2ZSBIb2xkaW5ncywgSW5jLjE6MDgGA1UEAxMxVHJ1c3R3YXZlIEdsb2JhbCBFQ0MgUDM4",
          "3429: NCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTB2MBAGByqGSM49AgEGBSuBBAAiA2IABGvaDXU1CDFH",
          "3430: Ba5FmVXxERMuSvgQMSOjfoPTfygIOiYaOs+Xgh+AtycJj9GOMMQKmw6sWASr9zZ9lCOkmwqKi6vr",
          "3431: /TklZvFe/oyujUF5nQlgziip04pt89ZF1PKYhDhloKNDMEEwDwYDVR0TAQH/BAUwAwEB/zAPBgNV",
          "3432: HQ8BAf8EBQMDBwYAMB0GA1UdDgQWBBRVqYSJ0sEyvRjLbKYHTsjnnb6CkDAKBggqhkjOPQQDAwNn",
          "3433: ADBkAjA3AZKXRRJ+oPM+rRk6ct30UJMDEr5E0k9BpIycnR+j9sKS50gU/k6bpZFXrsY3crsCMGcl",
          "3434: CrEMXu6pY5Jv5ZAL/mYiykf9ijH3g/56vxC+GCsej/YpHpRZ744hN8tRmKVuSw==",
          "3435: -----END CERTIFICATE-----",
          "",
          "---------------"
        ],
        "composer.lock||composer.lock": [
          "File: composer.lock -> composer.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:         \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",",
          "5:         \"This file is @generated automatically\"",
          "6:     ],",
          "8:     \"packages\": [",
          "9:         {",
          "10:             \"name\": \"claviska/simpleimage\",",
          "",
          "[Removed Lines]",
          "7:     \"content-hash\": \"b85ce02787ff0e052a3cc7a01c2daa91\",",
          "",
          "[Added Lines]",
          "7:     \"content-hash\": \"1ca40c0fbd9e8d3584e7ae28b84e0a1c\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "142:             ],",
          "143:             \"description\": \"Kirby's custom Composer installer for the Kirby CMS and for Kirby plugins\",",
          "144:             \"homepage\": \"https://getkirby.com\",",
          "145:             \"time\": \"2020-09-13T14:43:34+00:00\"",
          "146:         },",
          "147:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "145:             \"support\": {",
          "146:                 \"issues\": \"https://github.com/getkirby/composer-installer/issues\",",
          "147:                 \"source\": \"https://github.com/getkirby/composer-installer/tree/1.2.0\"",
          "148:             },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "239:                 \"laminas\",",
          "240:                 \"zf\"",
          "241:             ],",
          "242:             \"time\": \"2020-09-14T14:23:00+00:00\"",
          "243:         },",
          "244:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "246:             \"support\": {",
          "247:                 \"forum\": \"https://discourse.laminas.dev/\",",
          "248:                 \"issues\": \"https://github.com/laminas/laminas-zendframework-bridge/issues\",",
          "249:                 \"rss\": \"https://github.com/laminas/laminas-zendframework-bridge/releases.atom\",",
          "250:                 \"source\": \"https://github.com/laminas/laminas-zendframework-bridge\"",
          "251:             },",
          "252:             \"funding\": [",
          "253:                 {",
          "254:                     \"url\": \"https://funding.communitybridge.org/projects/laminas-project\",",
          "255:                     \"type\": \"community_bridge\"",
          "256:                 }",
          "257:             ],",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "293:                 \"image\",",
          "294:                 \"palette\"",
          "295:             ],",
          "296:             \"time\": \"2016-12-15T09:30:02+00:00\"",
          "297:         },",
          "298:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "312:             \"support\": {",
          "313:                 \"issues\": \"https://github.com/thephpleague/color-extractor/issues\",",
          "314:                 \"source\": \"https://github.com/thephpleague/color-extractor/tree/master\"",
          "315:             },",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "343:                 \"typographer\",",
          "344:                 \"typography\"",
          "345:             ],",
          "346:             \"time\": \"2016-12-13T01:01:17+00:00\"",
          "347:         },",
          "348:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "366:             \"support\": {",
          "367:                 \"issues\": \"https://github.com/michelf/php-smartypants/issues\",",
          "368:                 \"source\": \"https://github.com/michelf/php-smartypants/tree/1.8.1\"",
          "369:             },",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "455:                 }",
          "456:             ],",
          "457:             \"description\": \"PHPMailer is a full-featured email creation and transfer class for PHP\",",
          "458:             \"time\": \"2020-05-27T12:24:03+00:00\"",
          "459:         },",
          "460:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "482:             \"funding\": [",
          "483:                 {",
          "484:                     \"url\": \"https://github.com/synchro\",",
          "485:                     \"type\": \"github\"",
          "486:                 }",
          "487:             ],",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "502:                 \"psr\",",
          "503:                 \"psr-3\"",
          "504:             ],",
          "505:             \"time\": \"2020-03-23T09:12:05+00:00\"",
          "506:         },",
          "507:         {",
          "508:             \"name\": \"symfony/polyfill-mbstring\",",
          "510:             \"source\": {",
          "511:                 \"type\": \"git\",",
          "512:                 \"url\": \"https://github.com/symfony/polyfill-mbstring.git\",",
          "514:             },",
          "515:             \"dist\": {",
          "516:                 \"type\": \"zip\",",
          "519:                 \"shasum\": \"\"",
          "520:             },",
          "521:             \"require\": {",
          "523:             },",
          "524:             \"suggest\": {",
          "525:                 \"ext-mbstring\": \"For best performance\"",
          "",
          "[Removed Lines]",
          "509:             \"version\": \"v1.18.1\",",
          "513:                 \"reference\": \"a6977d63bf9a0ad4c65cd352709e230876f9904a\"",
          "517:                 \"url\": \"https://api.github.com/repos/symfony/polyfill-mbstring/zipball/a6977d63bf9a0ad4c65cd352709e230876f9904a\",",
          "518:                 \"reference\": \"a6977d63bf9a0ad4c65cd352709e230876f9904a\",",
          "522:                 \"php\": \">=5.3.3\"",
          "",
          "[Added Lines]",
          "535:             \"support\": {",
          "536:                 \"source\": \"https://github.com/php-fig/log/tree/1.1.3\"",
          "537:             },",
          "542:             \"version\": \"v1.20.0\",",
          "546:                 \"reference\": \"39d483bdf39be819deabf04ec872eb0b2410b531\"",
          "550:                 \"url\": \"https://api.github.com/repos/symfony/polyfill-mbstring/zipball/39d483bdf39be819deabf04ec872eb0b2410b531\",",
          "551:                 \"reference\": \"39d483bdf39be819deabf04ec872eb0b2410b531\",",
          "555:                 \"php\": \">=7.1\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "527:             \"type\": \"library\",",
          "528:             \"extra\": {",
          "529:                 \"branch-alias\": {",
          "531:                 },",
          "532:                 \"thanks\": {",
          "533:                     \"name\": \"symfony/polyfill\",",
          "",
          "[Removed Lines]",
          "530:                     \"dev-master\": \"1.18-dev\"",
          "",
          "[Added Lines]",
          "563:                     \"dev-main\": \"1.20-dev\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "565:                 \"portable\",",
          "566:                 \"shim\"",
          "567:             ],",
          "569:         },",
          "570:         {",
          "571:             \"name\": \"true/punycode\",",
          "",
          "[Removed Lines]",
          "568:             \"time\": \"2020-07-14T12:35:20+00:00\"",
          "",
          "[Added Lines]",
          "601:             \"support\": {",
          "602:                 \"source\": \"https://github.com/symfony/polyfill-mbstring/tree/v1.20.0\"",
          "603:             },",
          "604:             \"funding\": [",
          "605:                 {",
          "606:                     \"url\": \"https://symfony.com/sponsor\",",
          "607:                     \"type\": \"custom\"",
          "608:                 },",
          "609:                 {",
          "610:                     \"url\": \"https://github.com/fabpot\",",
          "611:                     \"type\": \"github\"",
          "612:                 },",
          "613:                 {",
          "614:                     \"url\": \"https://tidelift.com/funding/github/packagist/symfony/symfony\",",
          "615:                     \"type\": \"tidelift\"",
          "616:                 }",
          "617:             ],",
          "618:             \"time\": \"2020-10-23T14:02:19+00:00\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "611:                 \"idna\",",
          "612:                 \"punycode\"",
          "613:             ],",
          "614:             \"time\": \"2016-11-16T10:37:54+00:00\"",
          "615:         }",
          "616:     ],",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "664:             \"support\": {",
          "665:                 \"issues\": \"https://github.com/true/php-punycode/issues\",",
          "666:                 \"source\": \"https://github.com/true/php-punycode/tree/master\"",
          "667:             },",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "625:         \"ext-mbstring\": \"*\",",
          "626:         \"ext-ctype\": \"*\"",
          "627:     },",
          "629: }",
          "",
          "[Removed Lines]",
          "628:     \"platform-dev\": []",
          "",
          "[Added Lines]",
          "682:     \"platform-dev\": [],",
          "683:     \"plugin-api-version\": \"1.1.0\"",
          "",
          "---------------"
        ],
        "vendor/composer/ClassLoader.php||vendor/composer/ClassLoader.php": [
          "File: vendor/composer/ClassLoader.php -> vendor/composer/ClassLoader.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "60:     public function getPrefixes()",
          "61:     {",
          "62:         if (!empty($this->prefixesPsr0)) {",
          "64:         }",
          "66:         return array();",
          "",
          "[Removed Lines]",
          "63:             return call_user_func_array('array_merge', $this->prefixesPsr0);",
          "",
          "[Added Lines]",
          "63:             return call_user_func_array('array_merge', array_values($this->prefixesPsr0));",
          "",
          "---------------"
        ],
        "vendor/composer/autoload_real.php||vendor/composer/autoload_real.php": [
          "File: vendor/composer/autoload_real.php -> vendor/composer/autoload_real.php"
        ]
      }
    },
    {
      "candidate_hash": "98e037daaf673d3daeb6ec69baf385194e322d3e",
      "candidate_info": {
        "commit_hash": "98e037daaf673d3daeb6ec69baf385194e322d3e",
        "repo": "getkirby/kirby",
        "commit_url": "https://github.com/getkirby/kirby/commit/98e037daaf673d3daeb6ec69baf385194e322d3e",
        "files": [
          "src/Cms/FileRules.php",
          "tests/Cms/Files/FileRulesTest.php"
        ],
        "message": "Add PHP Phar archives to the list of risky files",
        "before_after_code_files": [
          "src/Cms/FileRules.php||src/Cms/FileRules.php",
          "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/getkirby/kirby/pull/2962"
        ],
        "olp_code_files": {
          "patch": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php",
            "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
          ],
          "candidate": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php",
            "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Cms/FileRules.php||src/Cms/FileRules.php": [
          "File: src/Cms/FileRules.php -> src/Cms/FileRules.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "174:             ]);",
          "175:         }",
          "178:             throw new InvalidArgumentException([",
          "179:                 'key'  => 'file.extension.forbidden',",
          "180:                 'data' => ['extension' => $extension]",
          "181:             ]);",
          "182:         }",
          "185:             throw new InvalidArgumentException([",
          "186:                 'key'  => 'file.type.forbidden',",
          "187:                 'data' => ['type' => 'PHP']",
          "",
          "[Removed Lines]",
          "177:         if (V::in($extension, ['php', 'html', 'htm', 'exe', App::instance()->contentExtension()])) {",
          "184:         if (Str::contains($extension, 'php')) {",
          "",
          "[Added Lines]",
          "177:         if (V::in($extension, ['php', 'phar', 'html', 'htm', 'exe', App::instance()->contentExtension()])) {",
          "184:         if (Str::contains($extension, 'php') || Str::contains($extension, 'phar')) {",
          "",
          "---------------"
        ],
        "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php": [
          "File: tests/Cms/Files/FileRulesTest.php -> tests/Cms/Files/FileRulesTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "190:             ['htm', false, 'The extension \"htm\" is not allowed'],",
          "191:             ['html', false, 'The extension \"html\" is not allowed'],",
          "192:             ['php', false, 'The extension \"php\" is not allowed'],",
          "193:             ['exe', false, 'The extension \"exe\" is not allowed'],",
          "194:             ['php4', false, 'You are not allowed to upload PHP files'],",
          "195:         ];",
          "196:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "193:             ['phar', false, 'The extension \"phar\" is not allowed'],",
          "196:             ['1phar2', false, 'You are not allowed to upload PHP files'],",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "225:             ['test.htm', 'htm', 'text/plain', false, 'The extension \"htm\" is not allowed'],",
          "226:             ['test.html', 'html', 'text/plain', false, 'The extension \"html\" is not allowed'],",
          "227:             ['test.php', 'php', 'text/plain', false, 'The extension \"php\" is not allowed'],",
          "228:             ['test.exe', 'exe', 'text/plain', false, 'The extension \"exe\" is not allowed'],",
          "229:             ['test.php4', 'php4', 'text/plain', false, 'You are not allowed to upload PHP files'],",
          "232:             ['test', 'jpg', '', false, 'The media type for \"test\" cannot be detected'],",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "230:             ['test.phar', 'phar', 'text/plain', false, 'The extension \"phar\" is not allowed'],",
          "233:             ['test.1phar2', '1phar2', 'text/plain', false, 'You are not allowed to upload PHP files'],",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "43260a3044491f84de4dd0228092f7bff3948352",
      "candidate_info": {
        "commit_hash": "43260a3044491f84de4dd0228092f7bff3948352",
        "repo": "getkirby/kirby",
        "commit_url": "https://github.com/getkirby/kirby/commit/43260a3044491f84de4dd0228092f7bff3948352",
        "files": [
          "src/Cms/Media.php"
        ],
        "message": "Never publish risky files to the media folder",
        "before_after_code_files": [
          "src/Cms/Media.php||src/Cms/Media.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/getkirby/kirby/pull/2962"
        ],
        "olp_code_files": {
          "patch": [
            "src/Cms/Media.php||src/Cms/Media.php"
          ],
          "candidate": [
            "src/Cms/Media.php||src/Cms/Media.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Cms/Media.php||src/Cms/Media.php": [
          "File: src/Cms/Media.php -> src/Cms/Media.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "71:     public static function publish(File $file, string $dest): bool",
          "72:     {",
          "73:         $src       = $file->root();",
          "74:         $version   = dirname($dest);",
          "75:         $directory = dirname($version);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "74:         FileRules::validFile($file);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "197f7d5f74a420f7aad05d0dcf018a9f6a1e53be",
      "candidate_info": {
        "commit_hash": "197f7d5f74a420f7aad05d0dcf018a9f6a1e53be",
        "repo": "getkirby/kirby",
        "commit_url": "https://github.com/getkirby/kirby/commit/197f7d5f74a420f7aad05d0dcf018a9f6a1e53be",
        "files": [
          "src/Cms/FileRules.php",
          "tests/Cms/Files/FileRulesTest.php"
        ],
        "message": "New FileRules::validFile() method",
        "before_after_code_files": [
          "src/Cms/FileRules.php||src/Cms/FileRules.php",
          "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/getkirby/kirby/pull/2962"
        ],
        "olp_code_files": {
          "patch": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php",
            "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
          ],
          "candidate": [
            "src/Cms/FileRules.php||src/Cms/FileRules.php",
            "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Cms/FileRules.php||src/Cms/FileRules.php": [
          "File: src/Cms/FileRules.php -> src/Cms/FileRules.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:             throw new PermissionException('The file cannot be created');",
          "83:         }",
          "89:         $upload->match($file->blueprint()->accept());",
          "",
          "[Removed Lines]",
          "85:         static::validExtension($file, $file->extension());",
          "86:         static::validMime($file, $upload->mime());",
          "87:         static::validFilename($file, $file->filename());",
          "",
          "[Added Lines]",
          "85:         static::validFile($file, $upload->mime());",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "200:         return true;",
          "201:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "209:     public static function validFile(File $file, ?string $mime = null): bool",
          "210:     {",
          "211:         return",
          "212:             static::validExtension($file, $file->extension()) &&",
          "213:             static::validMime($file, $mime ?? $file->mime()) &&",
          "214:             static::validFilename($file, $file->filename());",
          "215:     }",
          "",
          "---------------"
        ],
        "tests/Cms/Files/FileRulesTest.php||tests/Cms/Files/FileRulesTest.php": [
          "File: tests/Cms/Files/FileRulesTest.php -> tests/Cms/Files/FileRulesTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "213:         $this->assertTrue($result);",
          "214:     }",
          "216:     public function filenameProvider()",
          "217:     {",
          "218:         return [",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "216:     public function fileProvider()",
          "217:     {",
          "218:         return [",
          "220:             ['test.jpg', 'jpg', 'image/jpeg', true],",
          "221:             ['abc.png', 'png', 'image/png', true],",
          "224:             ['test', '', 'text/plain', false, 'The extensions for \"test\" is missing'],",
          "225:             ['test.htm', 'htm', 'text/plain', false, 'The extension \"htm\" is not allowed'],",
          "226:             ['test.html', 'html', 'text/plain', false, 'The extension \"html\" is not allowed'],",
          "227:             ['test.php', 'php', 'text/plain', false, 'The extension \"php\" is not allowed'],",
          "228:             ['test.exe', 'exe', 'text/plain', false, 'The extension \"exe\" is not allowed'],",
          "229:             ['test.php4', 'php4', 'text/plain', false, 'You are not allowed to upload PHP files'],",
          "232:             ['test', 'jpg', '', false, 'The media type for \"test\" cannot be detected'],",
          "233:             ['test.jpg', 'jpg', 'application/php', false, 'You are not allowed to upload PHP files'],",
          "234:             ['test.jpg', 'jpg', 'text/html', false, 'The media type \"text/html\" is not allowed'],",
          "235:             ['test.jpg', 'jpg', 'application/x-msdownload', false, 'The media type \"application/x-msdownload\" is not allowed'],",
          "238:             ['', 'jpg', 'image/jpg', false, 'The filename must not be empty'],",
          "239:             ['.htaccess', 'htaccess', 'application/x-apache', false, 'You are not allowed to upload Apache config files'],",
          "240:             ['.htpasswd', 'htpasswd', 'application/x-apache', false, 'You are not allowed to upload Apache config files'],",
          "241:             ['.gitignore', 'gitignore', 'application/x-git', false, 'You are not allowed to upload invisible files'],",
          "244:             ['.test.htm', 'htm', 'application/php', false, 'The extension \"htm\" is not allowed'],",
          "245:             ['.test.htm', 'jpg', 'application/php', false, 'You are not allowed to upload PHP files'],",
          "246:             ['.test.htm', 'jpg', 'text/plain', false, 'You are not allowed to upload invisible files'],",
          "247:         ];",
          "248:     }",
          "253:     public function testValidFile($filename, $extension, $mime, $expected, $message = null)",
          "254:     {",
          "255:         $file = $this->getMockBuilder(File::class)",
          "256:             ->disableOriginalConstructor()",
          "257:             ->onlyMethods(['filename', 'extension'])",
          "258:             ->addMethods(['mime'])",
          "259:             ->getMock();",
          "260:         $file->method('filename')->willReturn($filename);",
          "261:         $file->method('extension')->willReturn($extension);",
          "262:         $file->method('mime')->willReturn($mime);",
          "264:         if ($expected === false) {",
          "265:             $this->expectException('Kirby\\Exception\\InvalidArgumentException');",
          "266:             $this->expectExceptionMessage($message);",
          "267:         }",
          "269:         $result = FileRules::validFile($file);",
          "271:         $this->assertTrue($result);",
          "272:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}