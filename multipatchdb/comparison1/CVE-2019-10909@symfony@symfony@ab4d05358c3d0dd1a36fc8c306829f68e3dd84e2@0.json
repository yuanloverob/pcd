{
  "cve_id": "CVE-2019-10909",
  "cve_desc": "In Symfony before 2.7.51, 2.8.x before 2.8.50, 3.x before 3.4.26, 4.x before 4.1.12, and 4.2.x before 4.2.7, validation messages are not escaped, which can lead to XSS when user input is included. This is related to symfony/framework-bundle.",
  "repo": "symfony/symfony",
  "patch_hash": "ab4d05358c3d0dd1a36fc8c306829f68e3dd84e2",
  "patch_info": {
    "commit_hash": "ab4d05358c3d0dd1a36fc8c306829f68e3dd84e2",
    "repo": "symfony/symfony",
    "commit_url": "https://github.com/symfony/symfony/commit/ab4d05358c3d0dd1a36fc8c306829f68e3dd84e2",
    "files": [
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
    ],
    "message": "Fix XSS issues in the form theme of the PHP templating engine",
    "before_after_code_files": [
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
      "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
    ]
  },
  "patch_diff": {
    "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php": [
      "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     <?php if (count($preferred_choices) > 0): ?>",
      "12:         <?php echo $view['form']->block($form, 'choice_widget_options', ['choices' => $preferred_choices]) ?>",
      "13:         <?php if (count($choices) > 0 && null !== $separator): ?>",
      "15:         <?php endif ?>",
      "16:     <?php endif ?>",
      "17:     <?php echo $view['form']->block($form, 'choice_widget_options', ['choices' => $choices]) ?>",
      "",
      "[Removed Lines]",
      "14:             <option disabled=\"disabled\"><?php echo $separator ?></option>",
      "",
      "[Added Lines]",
      "14:             <option disabled=\"disabled\"><?php echo $view->escape($separator) ?></option>",
      "",
      "---------------"
    ],
    "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php": [
      "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: <?php if (count($errors) > 0): ?>",
      "2:     <ul>",
      "3:         <?php foreach ($errors as $error): ?>",
      "5:         <?php endforeach; ?>",
      "6:     </ul>",
      "7: <?php endif ?>",
      "",
      "[Removed Lines]",
      "4:             <li><?php echo $error->getMessage() ?></li>",
      "",
      "[Added Lines]",
      "4:             <li><?php echo $view->escape($error->getMessage()) ?></li>",
      "",
      "---------------"
    ],
    "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php": [
      "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: <?php $method = strtoupper($method) ?>",
      "2: <?php $form_method = $method === 'GET' || $method === 'POST' ? $method : 'POST' ?>",
      "4: <?php if ($form_method !== $method): ?>",
      "6: <?php endif ?>",
      "",
      "[Removed Lines]",
      "3: <form name=\"<?php echo $name ?>\" method=\"<?php echo strtolower($form_method) ?>\"<?php if ($action !== ''): ?> action=\"<?php echo $action ?>\"<?php endif ?><?php foreach ($attr as $k => $v) { printf(' %s=\"%s\"', $view->escape($k), $view->escape($v)); } ?><?php if ($multipart): ?> enctype=\"multipart/form-data\"<?php endif ?>>",
      "5:     <input type=\"hidden\" name=\"_method\" value=\"<?php echo $method ?>\" />",
      "",
      "[Added Lines]",
      "3: <form name=\"<?php echo $name ?>\" method=\"<?php echo strtolower($form_method) ?>\"<?php if ($action !== ''): ?> action=\"<?php echo $view->escape($action) ?>\"<?php endif ?><?php foreach ($attr as $k => $v) { printf(' %s=\"%s\"', $view->escape($k), $view->escape($v)); } ?><?php if ($multipart): ?> enctype=\"multipart/form-data\"<?php endif ?>>",
      "5:     <input type=\"hidden\" name=\"_method\" value=\"<?php echo $view->escape($method) ?>\" />",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d767bef8b56465f2347b2de0ec3636005a0bc759",
      "candidate_info": {
        "commit_hash": "d767bef8b56465f2347b2de0ec3636005a0bc759",
        "repo": "symfony/symfony",
        "commit_url": "https://github.com/symfony/symfony/commit/d767bef8b56465f2347b2de0ec3636005a0bc759",
        "files": [
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
        ],
        "message": "Fix XSS issues in the form theme of the PHP templating engine",
        "before_after_code_files": [
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
          "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
          ],
          "candidate": [
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
            "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php": [
          "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/choice_widget_collapsed.html.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:     <?php if (count($preferred_choices) > 0): ?>",
          "12:         <?php echo $view['form']->block($form, 'choice_widget_options', ['choices' => $preferred_choices]) ?>",
          "13:         <?php if (count($choices) > 0 && null !== $separator): ?>",
          "15:         <?php endif ?>",
          "16:     <?php endif ?>",
          "17:     <?php echo $view['form']->block($form, 'choice_widget_options', ['choices' => $choices]) ?>",
          "",
          "[Removed Lines]",
          "14:             <option disabled=\"disabled\"><?php echo $separator ?></option>",
          "",
          "[Added Lines]",
          "14:             <option disabled=\"disabled\"><?php echo $view->escape($separator) ?></option>",
          "",
          "---------------"
        ],
        "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php": [
          "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_errors.html.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php if (count($errors) > 0): ?>",
          "2:     <ul>",
          "3:         <?php foreach ($errors as $error): ?>",
          "5:         <?php endforeach; ?>",
          "6:     </ul>",
          "7: <?php endif ?>",
          "",
          "[Removed Lines]",
          "4:             <li><?php echo $error->getMessage() ?></li>",
          "",
          "[Added Lines]",
          "4:             <li><?php echo $view->escape($error->getMessage()) ?></li>",
          "",
          "---------------"
        ],
        "src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php||src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php": [
          "File: src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php -> src/Symfony/Bundle/FrameworkBundle/Resources/views/Form/form_start.html.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php $method = strtoupper($method) ?>",
          "2: <?php $form_method = $method === 'GET' || $method === 'POST' ? $method : 'POST' ?>",
          "4: <?php if ($form_method !== $method): ?>",
          "6: <?php endif ?>",
          "",
          "[Removed Lines]",
          "3: <form name=\"<?php echo $name ?>\" method=\"<?php echo strtolower($form_method) ?>\"<?php if ($action !== ''): ?> action=\"<?php echo $action ?>\"<?php endif ?><?php foreach ($attr as $k => $v) { printf(' %s=\"%s\"', $view->escape($k), $view->escape($v)); } ?><?php if ($multipart): ?> enctype=\"multipart/form-data\"<?php endif ?>>",
          "5:     <input type=\"hidden\" name=\"_method\" value=\"<?php echo $method ?>\" />",
          "",
          "[Added Lines]",
          "3: <form name=\"<?php echo $name ?>\" method=\"<?php echo strtolower($form_method) ?>\"<?php if ($action !== ''): ?> action=\"<?php echo $view->escape($action) ?>\"<?php endif ?><?php foreach ($attr as $k => $v) { printf(' %s=\"%s\"', $view->escape($k), $view->escape($v)); } ?><?php if ($multipart): ?> enctype=\"multipart/form-data\"<?php endif ?>>",
          "5:     <input type=\"hidden\" name=\"_method\" value=\"<?php echo $view->escape($method) ?>\" />",
          "",
          "---------------"
        ]
      }
    }
  ]
}