{
  "cve_id": "CVE-2023-1001",
  "cve_desc": "A vulnerability, which was classified as problematic, has been found in xuliangzhan vxe-table up to 3.7.9. This issue affects the function export of the file packages/textarea/src/textarea.js of the component vxe-textarea. The manipulation of the argument inputValue leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 3.7.10 is able to address this issue. The patch is named d70b0e089740b65a22c89c106ebc4627ac48a22d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-266123.",
  "repo": "x-extends/vxe-table",
  "patch_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
  "patch_info": {
    "commit_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "repo": "x-extends/vxe-table",
    "commit_url": "https://github.com/x-extends/vxe-table/commit/d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "files": [
      "packages/table/src/body.js",
      "packages/textarea/src/textarea.js"
    ],
    "message": "textarea \u4fee\u590d\u6ce8\u5165xss\u95ee\u9898 #I8O21R",
    "before_after_code_files": [
      "packages/table/src/body.js||packages/table/src/body.js",
      "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js"
    ]
  },
  "patch_diff": {
    "packages/table/src/body.js||packages/table/src/body.js": [
      "File: packages/table/src/body.js -> packages/table/src/body.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "499:     elemStore[`${prefix}xSpace`] = $refs.xSpace",
      "500:     elemStore[`${prefix}ySpace`] = $refs.ySpace",
      "501:     elemStore[`${prefix}emptyBlock`] = $refs.emptyBlock",
      "504:   },",
      "505:   beforeDestroy () {",
      "506:     clearTimeout(this.wheelTime)",
      "",
      "[Removed Lines]",
      "502:     this.$el.onscroll = this.scrollEvent",
      "503:     this.$el._onscroll = this.scrollEvent",
      "",
      "[Added Lines]",
      "502:     if (this.$el) {",
      "503:       this.$el.onscroll = this.scrollEvent",
      "504:       this.$el._onscroll = this.scrollEvent",
      "505:     }",
      "",
      "---------------"
    ],
    "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js": [
      "File: packages/textarea/src/textarea.js -> packages/textarea/src/textarea.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "188:         autoTxtElem.className = ['vxe-textarea--autosize', size ? `size--${size}` : ''].join(' ')",
      "189:         autoTxtElem.style.width = `${textElem.clientWidth}px`",
      "190:         autoTxtElem.style.padding = textStyle.padding",
      "192:       }",
      "193:     },",
      "194:     handleResize () {",
      "",
      "[Removed Lines]",
      "191:         autoTxtElem.innerHTML = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "[Added Lines]",
      "191:         autoTxtElem.innerText = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "23572546efcbb753ecb26d8f5c2b043e06889319",
      "candidate_info": {
        "commit_hash": "23572546efcbb753ecb26d8f5c2b043e06889319",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/23572546efcbb753ecb26d8f5c2b043e06889319",
        "files": [
          "package.json",
          "packages/toolbar/src/toolbar.js"
        ],
        "message": "fix \u5206\u9875\u7c7b\u578b\u58f0\u660e",
        "before_after_code_files": [
          "packages/toolbar/src/toolbar.js||packages/toolbar/src/toolbar.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/toolbar/src/toolbar.js||packages/toolbar/src/toolbar.js": [
          "File: packages/toolbar/src/toolbar.js -> packages/toolbar/src/toolbar.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "359:       const { $xetable } = this",
          "360:       if ($xetable) {",
          "361:         $xetable.triggerCustomEvent($event)",
          "362:       }",
          "363:     },",
          "364:     handleMouseenterSettingEvent ({ $event }) {",
          "365:       const { $xetable } = this",
          "366:       if ($xetable) {",
          "367:         $xetable.customOpenEvent($event)",
          "368:       }",
          "369:     },",
          "370:     handleMouseleaveSettingEvent ({ $event }) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "362:       } else {",
          "363:         errLog('vxe.error.reqModule', ['VxeTableCustomModule'])",
          "370:       } else {",
          "371:         errLog('vxe.error.reqModule', ['VxeTableCustomModule'])",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "414da82bbae44979c424935a859095679c9b8d20",
      "candidate_info": {
        "commit_hash": "414da82bbae44979c424935a859095679c9b8d20",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/414da82bbae44979c424935a859095679c9b8d20",
        "files": [
          "README.md",
          "index.ts",
          "package.json",
          "types/all.d.ts"
        ],
        "message": "fix",
        "before_after_code_files": [
          "index.ts||index.ts",
          "types/all.d.ts||types/all.d.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "index.ts||index.ts": [
          "File: index.ts -> index.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: import './styles/all.scss'",
          "4: if (typeof window !== 'undefined' && window.Vue) {",
          "5:   window.Vue.use(VxeTableExport)",
          "6: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5:   if (!(window as any).VxeUITable) {",
          "6:     (window as any).VxeUITable = VxeTableExport",
          "7:   }",
          "",
          "---------------"
        ],
        "types/all.d.ts||types/all.d.ts": [
          "File: types/all.d.ts -> types/all.d.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "9:     VXETable: VxeUIExport;",
          "10:   }",
          "11: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10:     VxeUITable: VxeUIExport;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8d5f9bed9569dfdc25fb0e23c1e463be792f2503",
      "candidate_info": {
        "commit_hash": "8d5f9bed9569dfdc25fb0e23c1e463be792f2503",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/8d5f9bed9569dfdc25fb0e23c1e463be792f2503",
        "files": [
          "package.json",
          "packages/table/module/custom/panel.ts"
        ],
        "message": "releases 3.11.13",
        "before_after_code_files": [
          "packages/table/module/custom/panel.ts||packages/table/module/custom/panel.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/module/custom/panel.ts||packages/table/module/custom/panel.ts": [
          "File: packages/table/module/custom/panel.ts -> packages/table/module/custom/panel.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "319: const renderPopupPanel = (h: CreateElement, _vm: any) => {",
          "320:   const VxeUIModalComponent = VxeUI.getComponent<VxeModalComponent>('VxeModal')",
          "321:   const VxeUIButtonComponent = VxeUI.getComponent<VxeButtonComponent>('VxeButton')",
          "322:   const VxeUINumberInputComponent = VxeUI.getComponent<VxeInputComponent>('VxeInput')",
          "323:   const VxeUITooltipComponent = VxeUI.getComponent<VxeTooltipComponent>('VxeTooltip')",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "321:   const VxeUIDrawerComponent = VxeUI.getComponent<VxeDrawerComponent>('VxeDrawer')",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "326:   const $xeTable = _vm.$xeTable",
          "327:   const { _e, customStore } = _vm",
          "328:   const { resizable: allResizable, customOpts, customColumnList, columnOpts, isMaxFixedColumn } = $xeTable",
          "330:   const { maxFixedSize } = columnOpts",
          "331:   const resizableOpts = $xeTable.computeResizableOpts",
          "332:   const { minWidth: reMinWidth, maxWidth: reMaxWidth } = resizableOpts",
          "333:   const modalOpts = Object.assign({}, modalOptions)",
          "334:   const slots = customOpts.slots || {}",
          "335:   const headerSlot = slots.header",
          "336:   const topSlot = slots.top",
          "",
          "[Removed Lines]",
          "329:   const { modalOptions, allowVisible, allowSort, allowFixed, allowResizable, checkMethod, visibleMethod } = customOpts",
          "",
          "[Added Lines]",
          "330:   const { mode, modalOptions, drawerOptions, allowVisible, allowSort, allowFixed, allowResizable, checkMethod, visibleMethod } = customOpts",
          "335:   const drawerOpts = Object.assign({}, drawerOptions)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "679:   if (headerSlot) {",
          "680:     scopedSlots.header = () => $xeTable.callSlot(headerSlot, params, h)",
          "681:   }",
          "682:   return VxeUIModalComponent",
          "683:     ? h(VxeUIModalComponent, {",
          "684:       key: 'modal',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "684:   if (mode === 'drawer') {",
          "685:     return VxeUIDrawerComponent",
          "686:       ? h(VxeUIDrawerComponent, {",
          "687:         key: 'drawer',",
          "688:         props: {",
          "689:           className: ['vxe-table-custom-drawer-wrapper', 'vxe-table--ignore-clear', drawerOpts.className || ''].join(' '),",
          "690:           value: customStore.visible,",
          "691:           title: drawerOpts.title || getI18n('vxe.custom.cstmTitle'),",
          "692:           width: drawerOpts.width || Math.min(880, Math.floor(document.documentElement.clientWidth * 0.6)),",
          "693:           position: drawerOpts.position,",
          "694:           escClosable: !!drawerOpts.escClosable,",
          "695:           destroyOnClose: true,",
          "696:           showFooter: true",
          "697:         },",
          "698:         on: {",
          "699:           input (value: any) {",
          "700:             customStore.visible = value",
          "701:           }",
          "702:         },",
          "703:         scopedSlots",
          "704:       })",
          "705:       : renderEmptyElement($xeTableCustomPanel)",
          "706:   }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "770:   render (this: any, h: CreateElement) {",
          "771:     const { $xetable } = this",
          "772:     const { customOpts } = $xetable",
          "774:       return renderPopupPanel(h, this)",
          "775:     }",
          "776:     return renderSimplePanel(h, this)",
          "",
          "[Removed Lines]",
          "773:     if (['modal', 'popup'].includes(`${customOpts.mode}`)) {",
          "",
          "[Added Lines]",
          "798:     if (['modal', 'drawer', 'popup'].includes(`${customOpts.mode}`)) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "da94122d07df242e53bc0cb1864b50895bc9dcda",
      "candidate_info": {
        "commit_hash": "da94122d07df242e53bc0cb1864b50895bc9dcda",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/da94122d07df242e53bc0cb1864b50895bc9dcda",
        "files": [
          "styles/button-group.scss"
        ],
        "message": "button-group \u4f18\u5316\u6837\u5f0f",
        "before_after_code_files": [
          "styles/button-group.scss||styles/button-group.scss"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "styles/button-group.scss||styles/button-group.scss": [
          "File: styles/button-group.scss -> styles/button-group.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: .vxe-button-group {",
          "4:   display: inline-flex;",
          "5: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6ce4528a4fa308e6c47b48b1253cfb091c9ae23b",
      "candidate_info": {
        "commit_hash": "6ce4528a4fa308e6c47b48b1253cfb091c9ae23b",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/6ce4528a4fa308e6c47b48b1253cfb091c9ae23b",
        "files": [
          "packages/v-x-e-table/src/commands.js",
          "packages/v-x-e-table/src/conf.js",
          "packages/v-x-e-table/src/formats.js",
          "packages/v-x-e-table/src/menus.js"
        ],
        "message": "\u91cd\u6784\u590d\u9009\u6846\u6e32\u67d3\u3001\u5927\u5e45\u63d0\u5347\u6027\u80fd",
        "before_after_code_files": [
          "packages/v-x-e-table/src/commands.js||packages/v-x-e-table/src/commands.js",
          "packages/v-x-e-table/src/conf.js||packages/v-x-e-table/src/conf.js",
          "packages/v-x-e-table/src/formats.js||packages/v-x-e-table/src/formats.js",
          "packages/v-x-e-table/src/menus.js||packages/v-x-e-table/src/menus.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/v-x-e-table/src/commands.js||packages/v-x-e-table/src/commands.js": [
          "File: packages/v-x-e-table/src/commands.js -> packages/v-x-e-table/src/commands.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:     if (XEUtils.isFunction(render)) {",
          "24:       if (process.env.VUE_APP_VXE_TABLE_ENV === 'development') {",
          "26:       }",
          "27:       render = {",
          "28:         commandMethod: render",
          "",
          "[Removed Lines]",
          "25:         warnLog('vxe.error.delProp', ['callback', 'commandMethod'])",
          "",
          "[Added Lines]",
          "25:         warnLog('vxe.error.delProp', ['commands -> callback', 'commandMethod'])",
          "",
          "---------------"
        ],
        "packages/v-x-e-table/src/conf.js||packages/v-x-e-table/src/conf.js": [
          "File: packages/v-x-e-table/src/conf.js -> packages/v-x-e-table/src/conf.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:       isReplace: true",
          "120:     },",
          "121:     scrollX: {",
          "123:       gt: 60",
          "125:     },",
          "126:     scrollY: {",
          "128:       gt: 100",
          "130:     }",
          "",
          "[Removed Lines]",
          "122:       enabled: true,",
          "127:       enabled: true,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "packages/v-x-e-table/src/formats.js||packages/v-x-e-table/src/formats.js": [
          "File: packages/v-x-e-table/src/formats.js -> packages/v-x-e-table/src/formats.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:     if (XEUtils.isFunction(render)) {",
          "24:       if (process.env.VUE_APP_VXE_TABLE_ENV === 'development') {",
          "26:       }",
          "27:       render = {",
          "28:         cellFormatMethod: render",
          "",
          "[Removed Lines]",
          "25:         warnLog('vxe.error.delProp', ['callback', 'cellFormatMethod'])",
          "",
          "[Added Lines]",
          "25:         warnLog('vxe.error.delProp', ['formats -> callback', 'cellFormatMethod'])",
          "",
          "---------------"
        ],
        "packages/v-x-e-table/src/menus.js||packages/v-x-e-table/src/menus.js": [
          "File: packages/v-x-e-table/src/menus.js -> packages/v-x-e-table/src/menus.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "23:     if (XEUtils.isFunction(render)) {",
          "24:       if (process.env.VUE_APP_VXE_TABLE_ENV === 'development') {",
          "26:       }",
          "27:       render = {",
          "28:         menuMethod: render",
          "",
          "[Removed Lines]",
          "25:         warnLog('vxe.error.delProp', ['callback', 'menuMethod'])",
          "",
          "[Added Lines]",
          "25:         warnLog('vxe.error.delProp', ['menus -> callback', 'menuMethod'])",
          "",
          "---------------"
        ]
      }
    }
  ]
}