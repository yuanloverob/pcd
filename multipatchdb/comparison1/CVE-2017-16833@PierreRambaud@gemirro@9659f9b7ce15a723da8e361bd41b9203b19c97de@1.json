{
  "cve_id": "CVE-2017-16833",
  "cve_desc": "Stored cross-site scripting (XSS) vulnerability in Gemirro before 0.16.0 allows attackers to inject arbitrary web script via a crafted javascript: URL in the \"homepage\" value of a \".gemspec\" file.",
  "repo": "PierreRambaud/gemirro",
  "patch_hash": "9659f9b7ce15a723da8e361bd41b9203b19c97de",
  "patch_info": {
    "commit_hash": "9659f9b7ce15a723da8e361bd41b9203b19c97de",
    "repo": "PierreRambaud/gemirro",
    "commit_url": "https://github.com/PierreRambaud/gemirro/commit/9659f9b7ce15a723da8e361bd41b9203b19c97de",
    "files": [
      "Gemfile.lock",
      "lib/gemirro/server.rb",
      "views/gem.erb"
    ],
    "message": "Security Fix again, thanks to Yasin Soliman",
    "before_after_code_files": [
      "Gemfile.lock||Gemfile.lock",
      "lib/gemirro/server.rb||lib/gemirro/server.rb",
      "views/gem.erb||views/gem.erb"
    ]
  },
  "patch_diff": {
    "Gemfile.lock||Gemfile.lock": [
      "File: Gemfile.lock -> Gemfile.lock",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: PATH",
      "2:   remote: .",
      "3:   specs:",
      "5:       builder (~> 3.2)",
      "6:       confstruct (~> 1.0)",
      "7:       erubis (~> 2.7)",
      "",
      "[Removed Lines]",
      "4:     gemirro (0.14.0)",
      "",
      "[Added Lines]",
      "4:     gemirro (0.15.0)",
      "",
      "---------------"
    ],
    "lib/gemirro/server.rb||lib/gemirro/server.rb": [
      "File: lib/gemirro/server.rb -> lib/gemirro/server.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: require 'sinatra/base'",
      "2: require 'thin'",
      "4: module Gemirro",
      "5:   ##",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: require 'uri'",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "271:       def escape(string)",
      "272:         Rack::Utils.escape_html(string)",
      "273:       end",
      "274:     end",
      "275:   end",
      "276: end",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "276:       ##",
      "277:       # Homepage link",
      "278:       #",
      "279:       # @param [Gem] spec",
      "280:       # @return [String]",
      "281:       #",
      "282:       def homepage(spec)",
      "283:         URI.parse(URI.escape(spec.homepage))",
      "284:       end",
      "",
      "---------------"
    ],
    "views/gem.erb||views/gem.erb": [
      "File: views/gem.erb -> views/gem.erb",
      "--- Hunk 1 ---",
      "[Context before]",
      "31:             <ul class=\"list-group\">",
      "32:               <% spec.authors.each do |author| %>",
      "33:                 <li class=\"list-group-item\">",
      "35:                 </li>",
      "36:               <% end %>",
      "37:             </ul>",
      "",
      "[Removed Lines]",
      "34:                   <a href=\"<%= escape(spec.homepage) %>\"><%= escape(author) %></a>",
      "",
      "[Added Lines]",
      "34:                   <a href=\"<%= homepage(spec) %>\"><%= escape(author) %></a>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6a2196d3ff1dca4ea1b4464207df00a6cbb13d68",
      "candidate_info": {
        "commit_hash": "6a2196d3ff1dca4ea1b4464207df00a6cbb13d68",
        "repo": "PierreRambaud/gemirro",
        "commit_url": "https://github.com/PierreRambaud/gemirro/commit/6a2196d3ff1dca4ea1b4464207df00a6cbb13d68",
        "files": [
          "Gemfile.lock"
        ],
        "message": "Whoops missing gemfile.lock",
        "before_after_code_files": [
          "Gemfile.lock||Gemfile.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Gemfile.lock||Gemfile.lock"
          ],
          "candidate": [
            "Gemfile.lock||Gemfile.lock"
          ]
        }
      },
      "candidate_diff": {
        "Gemfile.lock||Gemfile.lock": [
          "File: Gemfile.lock -> Gemfile.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: PATH",
          "2:   remote: .",
          "3:   specs:",
          "5:       builder (~> 3.2)",
          "6:       confstruct (~> 1.0)",
          "7:       erubis (~> 2.7)",
          "",
          "[Removed Lines]",
          "4:     gemirro (0.15.0)",
          "",
          "[Added Lines]",
          "4:     gemirro (0.16.0)",
          "",
          "---------------"
        ]
      }
    }
  ]
}