{
  "cve_id": "CVE-2021-28957",
  "cve_desc": "An XSS vulnerability was discovered in python-lxml's clean module versions before 4.6.3. When disabling the safe_attrs_only and forms arguments, the Cleaner class does not remove the formaction attribute allowing for JS to bypass the sanitizer. A remote attacker could exploit this flaw to run arbitrary JS code on users who interact with incorrectly sanitized HTML. This issue is patched in lxml 4.6.3.",
  "repo": "lxml/lxml",
  "patch_hash": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
  "patch_info": {
    "commit_hash": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
    "repo": "lxml/lxml",
    "commit_url": "https://github.com/lxml/lxml/commit/a5f9cb52079dc57477c460dbe6ba0f775e14a999",
    "files": [
      "CHANGES.txt",
      "doc/main.txt",
      "src/lxml/__init__.py"
    ],
    "message": "Prepare release of lxml 4.6.3.",
    "before_after_code_files": [
      "src/lxml/__init__.py||src/lxml/__init__.py"
    ]
  },
  "patch_diff": {
    "src/lxml/__init__.py||src/lxml/__init__.py": [
      "File: src/lxml/__init__.py -> src/lxml/__init__.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # this is a package",
      "6: def get_include():",
      "",
      "[Removed Lines]",
      "3: __version__ = \"4.6.2\"",
      "",
      "[Added Lines]",
      "3: __version__ = \"4.6.3\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5c4f6a23d5758ec66cfe22b082a40c2e08df4658",
      "candidate_info": {
        "commit_hash": "5c4f6a23d5758ec66cfe22b082a40c2e08df4658",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/5c4f6a23d5758ec66cfe22b082a40c2e08df4658",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of lxml 4.7.0.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.7.0a0\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.7.0\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "076c6740da7236ae6558436835b828da419f6476",
      "candidate_info": {
        "commit_hash": "076c6740da7236ae6558436835b828da419f6476",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/076c6740da7236ae6558436835b828da419f6476",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.5.2.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.5.1\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.5.2\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5e268f937ac8e6c96c9b60f95e2c9d0c09c0e836",
      "candidate_info": {
        "commit_hash": "5e268f937ac8e6c96c9b60f95e2c9d0c09c0e836",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/5e268f937ac8e6c96c9b60f95e2c9d0c09c0e836",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.6.4.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.3\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.4\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c30106ff2648cdafe7857654e9606c491b1acf4d",
      "candidate_info": {
        "commit_hash": "c30106ff2648cdafe7857654e9606c491b1acf4d",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/c30106ff2648cdafe7857654e9606c491b1acf4d",
        "files": [
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.6.2.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.1\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.2\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f10279931121074370c0968b988137550d0f7ee4",
      "candidate_info": {
        "commit_hash": "f10279931121074370c0968b988137550d0f7ee4",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/f10279931121074370c0968b988137550d0f7ee4",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of lxml 4.6.0.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.5.2\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.0\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}