{
  "cve_id": "CVE-2022-30874",
  "cve_desc": "There is a Cross Site Scripting Stored (XSS) vulnerability in NukeViet CMS before 4.5.02.",
  "repo": "nukeviet/nukeviet",
  "patch_hash": "1f328bb8cd256f88bd45fc3ec5a50ae951da2501",
  "patch_info": {
    "commit_hash": "1f328bb8cd256f88bd45fc3ec5a50ae951da2501",
    "repo": "nukeviet/nukeviet",
    "commit_url": "https://github.com/nukeviet/nukeviet/commit/1f328bb8cd256f88bd45fc3ec5a50ae951da2501",
    "files": [
      "assets/js/site.js",
      "themes/admin_default/js/main.js"
    ],
    "message": "Kh\u00f4ng t\u1ef1 \u0111\u1ed9ng x\u00f3a m\u00e3 XSS khi c\u00f3 name=submit",
    "before_after_code_files": [
      "assets/js/site.js||assets/js/site.js",
      "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
    ]
  },
  "patch_diff": {
    "assets/js/site.js||assets/js/site.js": [
      "File: assets/js/site.js -> assets/js/site.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "25: $(function() {",
      "26:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
      "28:     });",
      "29: })",
      "",
      "[Removed Lines]",
      "27:         btnClickSubmit(e, $(this).parents('form'))",
      "",
      "[Added Lines]",
      "27:         var form = $(this).parents('form');",
      "28:         if (!$('[name=submit]', form).length) {",
      "29:             btnClickSubmit(e,form)",
      "30:         }",
      "",
      "---------------"
    ],
    "themes/admin_default/js/main.js||themes/admin_default/js/main.js": [
      "File: themes/admin_default/js/main.js -> themes/admin_default/js/main.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "189:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
      "191:     });",
      "193:     $(document).on('click', function(e) {",
      "",
      "[Removed Lines]",
      "190:         btnClickSubmit(e, $(this).parents('form'))",
      "",
      "[Added Lines]",
      "190:         var form = $(this).parents('form');",
      "191:         if (!$('[name=submit]', form).length) {",
      "192:             btnClickSubmit(e,form)",
      "193:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "15f7ed5e0c570bd042c5dae92483c9f2edc1d77b",
      "candidate_info": {
        "commit_hash": "15f7ed5e0c570bd042c5dae92483c9f2edc1d77b",
        "repo": "nukeviet/nukeviet",
        "commit_url": "https://github.com/nukeviet/nukeviet/commit/15f7ed5e0c570bd042c5dae92483c9f2edc1d77b",
        "files": [
          "admin/settings/security.php",
          "assets/js/DOMPurify/purify.js",
          "assets/js/site.js",
          "includes/core/user_functions.php",
          "includes/language/en/admin_settings.php",
          "includes/language/fr/admin_settings.php",
          "includes/language/vi/admin_settings.php",
          "install/data.php",
          "modules/menu/blocks/global.bootstrap.php",
          "modules/menu/menu_blocks.php",
          "themes/admin_default/js/main.js",
          "themes/admin_default/modules/settings/security.tpl",
          "themes/admin_default/system/header.tpl",
          "themes/admin_default/theme.php"
        ],
        "message": "Th\u00eam thi\u1ebft l\u1eadp an ninh: L\u1ecdc c\u00e1c m\u00e3 HTML nguy hi\u1ec3m\n\nThi\u1ebft l\u1eadp an ninh: L\u1ecdc c\u00e1c m\u00e3 HTML nguy hi\u1ec3m tr\u01b0\u1edbc khi g\u1eedi bi\u1ec3u m\u1eabu \u1edf khu v\u1ef1c t\u01b0\u01a1ng t\u00e1c v\u1edbi ng\u01b0\u1eddi d\u00f9ng v\u00e0 trong khu v\u1ef1c qu\u1ea3n tr\u1ecb.\nT\u00ednh n\u0103ng n\u00e0y ch\u1ec9 ch\u1ea1y khi n\u00fat [type=submit] c\u1ee7a form kh\u00f4ng ch\u1ee9a thu\u1ed9c t\u00ednh [name]",
        "before_after_code_files": [
          "admin/settings/security.php||admin/settings/security.php",
          "assets/js/DOMPurify/purify.js||assets/js/DOMPurify/purify.js",
          "assets/js/site.js||assets/js/site.js",
          "includes/core/user_functions.php||includes/core/user_functions.php",
          "includes/language/en/admin_settings.php||includes/language/en/admin_settings.php",
          "includes/language/fr/admin_settings.php||includes/language/fr/admin_settings.php",
          "includes/language/vi/admin_settings.php||includes/language/vi/admin_settings.php",
          "install/data.php||install/data.php",
          "modules/menu/blocks/global.bootstrap.php||modules/menu/blocks/global.bootstrap.php",
          "modules/menu/menu_blocks.php||modules/menu/menu_blocks.php",
          "themes/admin_default/js/main.js||themes/admin_default/js/main.js",
          "themes/admin_default/modules/settings/security.tpl||themes/admin_default/modules/settings/security.tpl",
          "themes/admin_default/system/header.tpl||themes/admin_default/system/header.tpl",
          "themes/admin_default/theme.php||themes/admin_default/theme.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ],
          "candidate": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ]
        }
      },
      "candidate_diff": {
        "admin/settings/security.php||admin/settings/security.php": [
          "File: admin/settings/security.php -> admin/settings/security.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "66:     $array_config_global['admin_2step_opt'] = $nv_Request->get_typed_array('admin_2step_opt', 'post', 'title', []);",
          "67:     $array_config_global['admin_2step_default'] = $nv_Request->get_title('admin_2step_default', 'post', '');",
          "68:     $array_config_global['domains_restrict'] = (int) $nv_Request->get_bool('domains_restrict', 'post', false);",
          "70:     $domains = $nv_Request->get_textarea('domains_whitelist', '', NV_ALLOWED_HTML_TAGS, true);",
          "71:     $domains = explode('<br />', strip_tags($domains, '<br>'));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "69:     $array_config_global['XSSsanitize'] = (int) $nv_Request->get_bool('XSSsanitize', 'post', false);",
          "70:     $array_config_global['admin_XSSsanitize'] = (int) $nv_Request->get_bool('admin_XSSsanitize', 'post', false);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "717:     $xtpl->assign('IS_LOGIN_BLOCKER', ($array_config_global['is_login_blocker']) ? ' checked=\"checked\"' : '');",
          "718:     $xtpl->assign('DOMAINS_RESTRICT', ($array_config_global['domains_restrict']) ? ' checked=\"checked\"' : '');",
          "719:     $xtpl->assign('LOGIN_NUMBER_TRACKING', $array_config_global['login_number_tracking']);",
          "720:     $xtpl->assign('LOGIN_TIME_TRACKING', $array_config_global['login_time_tracking']);",
          "721:     $xtpl->assign('LOGIN_TIME_BAN', $array_config_global['login_time_ban']);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "721:     $xtpl->assign('XSSSANITIZE', ($array_config_global['XSSsanitize']) ? ' checked=\"checked\"' : '');",
          "722:     $xtpl->assign('ADMIN_XSSSANITIZE', ($array_config_global['admin_XSSsanitize']) ? ' checked=\"checked\"' : '');",
          "",
          "---------------"
        ],
        "assets/js/DOMPurify/purify.js||assets/js/DOMPurify/purify.js": [
          "File: assets/js/DOMPurify/purify.js -> assets/js/DOMPurify/purify.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: !function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).DOMPurify=t()}(this,(function(){\"use strict\";function e(t){return(e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,o,a){return(r=n()?Reflect.construct:function(e,n,r){var o=[null];o.push.apply(o,n);var a=new(Function.bind.apply(e,o));return r&&t(a,r.prototype),a}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}(e)||function(e,t){if(!e)return;if(\"string\"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(e);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=Object.hasOwnProperty,l=Object.setPrototypeOf,c=Object.isFrozen,u=Object.getPrototypeOf,s=Object.getOwnPropertyDescriptor,m=Object.freeze,f=Object.seal,p=Object.create,d=\"undefined\"!=typeof Reflect&&Reflect,h=d.apply,g=d.construct;h||(h=function(e,t,n){return e.apply(t,n)}),m||(m=function(e){return e}),f||(f=function(e){return e}),g||(g=function(e,t){return r(e,o(t))});var y,b=_(Array.prototype.forEach),v=_(Array.prototype.pop),T=_(Array.prototype.push),N=_(String.prototype.toLowerCase),E=_(String.prototype.match),A=_(String.prototype.replace),w=_(String.prototype.indexOf),x=_(String.prototype.trim),k=_(RegExp.prototype.test),S=(y=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(y,t)});function _(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return h(e,t,r)}}function O(e,t){l&&l(e,null);for(var n=t.length;n--;){var r=t[n];if(\"string\"==typeof r){var o=N(r);o!==r&&(c(t)||(t[n]=o),r=o)}e[r]=!0}return e}function D(e){var t,n=p(null);for(t in e)h(i,e,[t])&&(n[t]=e[t]);return n}function C(e,t){for(;null!==e;){var n=s(e,t);if(n){if(n.get)return _(n.get);if(\"function\"==typeof n.value)return _(n.value)}e=u(e)}return function(e){return console.warn(\"fallback value for\",e),null}}var M=m([\"a\",\"abbr\",\"acronym\",\"address\",\"area\",\"article\",\"aside\",\"audio\",\"b\",\"bdi\",\"bdo\",\"big\",\"blink\",\"blockquote\",\"body\",\"br\",\"button\",\"canvas\",\"caption\",\"center\",\"cite\",\"code\",\"col\",\"colgroup\",\"content\",\"data\",\"datalist\",\"dd\",\"decorator\",\"del\",\"details\",\"dfn\",\"dialog\",\"dir\",\"div\",\"dl\",\"dt\",\"element\",\"em\",\"fieldset\",\"figcaption\",\"figure\",\"font\",\"footer\",\"form\",\"h1\",\"h2\",\"h3\",\"h4\",\"h5\",\"h6\",\"head\",\"header\",\"hgroup\",\"hr\",\"html\",\"i\",\"img\",\"input\",\"ins\",\"kbd\",\"label\",\"legend\",\"li\",\"main\",\"map\",\"mark\",\"marquee\",\"menu\",\"menuitem\",\"meter\",\"nav\",\"nobr\",\"ol\",\"optgroup\",\"option\",\"output\",\"p\",\"picture\",\"pre\",\"progress\",\"q\",\"rp\",\"rt\",\"ruby\",\"s\",\"samp\",\"section\",\"select\",\"shadow\",\"small\",\"source\",\"spacer\",\"span\",\"strike\",\"strong\",\"style\",\"sub\",\"summary\",\"sup\",\"table\",\"tbody\",\"td\",\"template\",\"textarea\",\"tfoot\",\"th\",\"thead\",\"time\",\"tr\",\"track\",\"tt\",\"u\",\"ul\",\"var\",\"video\",\"wbr\"]),R=m([\"svg\",\"a\",\"altglyph\",\"altglyphdef\",\"altglyphitem\",\"animatecolor\",\"animatemotion\",\"animatetransform\",\"circle\",\"clippath\",\"defs\",\"desc\",\"ellipse\",\"filter\",\"font\",\"g\",\"glyph\",\"glyphref\",\"hkern\",\"image\",\"line\",\"lineargradient\",\"marker\",\"mask\",\"metadata\",\"mpath\",\"path\",\"pattern\",\"polygon\",\"polyline\",\"radialgradient\",\"rect\",\"stop\",\"style\",\"switch\",\"symbol\",\"text\",\"textpath\",\"title\",\"tref\",\"tspan\",\"view\",\"vkern\"]),L=m([\"feBlend\",\"feColorMatrix\",\"feComponentTransfer\",\"feComposite\",\"feConvolveMatrix\",\"feDiffuseLighting\",\"feDisplacementMap\",\"feDistantLight\",\"feFlood\",\"feFuncA\",\"feFuncB\",\"feFuncG\",\"feFuncR\",\"feGaussianBlur\",\"feImage\",\"feMerge\",\"feMergeNode\",\"feMorphology\",\"feOffset\",\"fePointLight\",\"feSpecularLighting\",\"feSpotLight\",\"feTile\",\"feTurbulence\"]),I=m([\"animate\",\"color-profile\",\"cursor\",\"discard\",\"fedropshadow\",\"font-face\",\"font-face-format\",\"font-face-name\",\"font-face-src\",\"font-face-uri\",\"foreignobject\",\"hatch\",\"hatchpath\",\"mesh\",\"meshgradient\",\"meshpatch\",\"meshrow\",\"missing-glyph\",\"script\",\"set\",\"solidcolor\",\"unknown\",\"use\"]),F=m([\"math\",\"menclose\",\"merror\",\"mfenced\",\"mfrac\",\"mglyph\",\"mi\",\"mlabeledtr\",\"mmultiscripts\",\"mn\",\"mo\",\"mover\",\"mpadded\",\"mphantom\",\"mroot\",\"mrow\",\"ms\",\"mspace\",\"msqrt\",\"mstyle\",\"msub\",\"msup\",\"msubsup\",\"mtable\",\"mtd\",\"mtext\",\"mtr\",\"munder\",\"munderover\"]),H=m([\"maction\",\"maligngroup\",\"malignmark\",\"mlongdiv\",\"mscarries\",\"mscarry\",\"msgroup\",\"mstack\",\"msline\",\"msrow\",\"semantics\",\"annotation\",\"annotation-xml\",\"mprescripts\",\"none\"]),U=m([\"#text\"]),z=m([\"accept\",\"action\",\"align\",\"alt\",\"autocapitalize\",\"autocomplete\",\"autopictureinpicture\",\"autoplay\",\"background\",\"bgcolor\",\"border\",\"capture\",\"cellpadding\",\"cellspacing\",\"checked\",\"cite\",\"class\",\"clear\",\"color\",\"cols\",\"colspan\",\"controls\",\"controlslist\",\"coords\",\"crossorigin\",\"datetime\",\"decoding\",\"default\",\"dir\",\"disabled\",\"disablepictureinpicture\",\"disableremoteplayback\",\"download\",\"draggable\",\"enctype\",\"enterkeyhint\",\"face\",\"for\",\"headers\",\"height\",\"hidden\",\"high\",\"href\",\"hreflang\",\"id\",\"inputmode\",\"integrity\",\"ismap\",\"kind\",\"label\",\"lang\",\"list\",\"loading\",\"loop\",\"low\",\"max\",\"maxlength\",\"media\",\"method\",\"min\",\"minlength\",\"multiple\",\"muted\",\"name\",\"nonce\",\"noshade\",\"novalidate\",\"nowrap\",\"open\",\"optimum\",\"pattern\",\"placeholder\",\"playsinline\",\"poster\",\"preload\",\"pubdate\",\"radiogroup\",\"readonly\",\"rel\",\"required\",\"rev\",\"reversed\",\"role\",\"rows\",\"rowspan\",\"spellcheck\",\"scope\",\"selected\",\"shape\",\"size\",\"sizes\",\"span\",\"srclang\",\"start\",\"src\",\"srcset\",\"step\",\"style\",\"summary\",\"tabindex\",\"title\",\"translate\",\"type\",\"usemap\",\"valign\",\"value\",\"width\",\"xmlns\",\"slot\"]),B=m([\"accent-height\",\"accumulate\",\"additive\",\"alignment-baseline\",\"ascent\",\"attributename\",\"attributetype\",\"azimuth\",\"basefrequency\",\"baseline-shift\",\"begin\",\"bias\",\"by\",\"class\",\"clip\",\"clippathunits\",\"clip-path\",\"clip-rule\",\"color\",\"color-interpolation\",\"color-interpolation-filters\",\"color-profile\",\"color-rendering\",\"cx\",\"cy\",\"d\",\"dx\",\"dy\",\"diffuseconstant\",\"direction\",\"display\",\"divisor\",\"dur\",\"edgemode\",\"elevation\",\"end\",\"fill\",\"fill-opacity\",\"fill-rule\",\"filter\",\"filterunits\",\"flood-color\",\"flood-opacity\",\"font-family\",\"font-size\",\"font-size-adjust\",\"font-stretch\",\"font-style\",\"font-variant\",\"font-weight\",\"fx\",\"fy\",\"g1\",\"g2\",\"glyph-name\",\"glyphref\",\"gradientunits\",\"gradienttransform\",\"height\",\"href\",\"id\",\"image-rendering\",\"in\",\"in2\",\"k\",\"k1\",\"k2\",\"k3\",\"k4\",\"kerning\",\"keypoints\",\"keysplines\",\"keytimes\",\"lang\",\"lengthadjust\",\"letter-spacing\",\"kernelmatrix\",\"kernelunitlength\",\"lighting-color\",\"local\",\"marker-end\",\"marker-mid\",\"marker-start\",\"markerheight\",\"markerunits\",\"markerwidth\",\"maskcontentunits\",\"maskunits\",\"max\",\"mask\",\"media\",\"method\",\"mode\",\"min\",\"name\",\"numoctaves\",\"offset\",\"operator\",\"opacity\",\"order\",\"orient\",\"orientation\",\"origin\",\"overflow\",\"paint-order\",\"path\",\"pathlength\",\"patterncontentunits\",\"patterntransform\",\"patternunits\",\"points\",\"preservealpha\",\"preserveaspectratio\",\"primitiveunits\",\"r\",\"rx\",\"ry\",\"radius\",\"refx\",\"refy\",\"repeatcount\",\"repeatdur\",\"restart\",\"result\",\"rotate\",\"scale\",\"seed\",\"shape-rendering\",\"specularconstant\",\"specularexponent\",\"spreadmethod\",\"startoffset\",\"stddeviation\",\"stitchtiles\",\"stop-color\",\"stop-opacity\",\"stroke-dasharray\",\"stroke-dashoffset\",\"stroke-linecap\",\"stroke-linejoin\",\"stroke-miterlimit\",\"stroke-opacity\",\"stroke\",\"stroke-width\",\"style\",\"surfacescale\",\"systemlanguage\",\"tabindex\",\"targetx\",\"targety\",\"transform\",\"transform-origin\",\"text-anchor\",\"text-decoration\",\"text-rendering\",\"textlength\",\"type\",\"u1\",\"u2\",\"unicode\",\"values\",\"viewbox\",\"visibility\",\"version\",\"vert-adv-y\",\"vert-origin-x\",\"vert-origin-y\",\"width\",\"word-spacing\",\"wrap\",\"writing-mode\",\"xchannelselector\",\"ychannelselector\",\"x\",\"x1\",\"x2\",\"xmlns\",\"y\",\"y1\",\"y2\",\"z\",\"zoomandpan\"]),j=m([\"accent\",\"accentunder\",\"align\",\"bevelled\",\"close\",\"columnsalign\",\"columnlines\",\"columnspan\",\"denomalign\",\"depth\",\"dir\",\"display\",\"displaystyle\",\"encoding\",\"fence\",\"frame\",\"height\",\"href\",\"id\",\"largeop\",\"length\",\"linethickness\",\"lspace\",\"lquote\",\"mathbackground\",\"mathcolor\",\"mathsize\",\"mathvariant\",\"maxsize\",\"minsize\",\"movablelimits\",\"notation\",\"numalign\",\"open\",\"rowalign\",\"rowlines\",\"rowspacing\",\"rowspan\",\"rspace\",\"rquote\",\"scriptlevel\",\"scriptminsize\",\"scriptsizemultiplier\",\"selection\",\"separator\",\"separators\",\"stretchy\",\"subscriptshift\",\"supscriptshift\",\"symmetric\",\"voffset\",\"width\",\"xmlns\"]),P=m([\"xlink:href\",\"xml:id\",\"xlink:title\",\"xml:space\",\"xmlns:xlink\"]),G=f(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm),W=f(/<%[\\w\\W]*|[\\w\\W]*%>/gm),q=f(/^data-[\\-\\w.\\u00B7-\\uFFFF]/),Y=f(/^aria-[\\-\\w]+$/),K=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i),V=f(/^(?:\\w+script|data):/i),$=f(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g),X=f(/^html$/i),Z=function(){return\"undefined\"==typeof window?null:window},J=function(t,n){if(\"object\"!==e(t)||\"function\"!=typeof t.createPolicy)return null;var r=null,o=\"data-tt-policy-suffix\";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var a=\"dompurify\"+(r?\"#\"+r:\"\");try{return t.createPolicy(a,{createHTML:function(e){return e}})}catch(e){return console.warn(\"TrustedTypes policy \"+a+\" could not be created.\"),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),r=function(e){return t(e)};if(r.version=\"2.3.8\",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var a=n.document,i=n.document,l=n.DocumentFragment,c=n.HTMLTemplateElement,u=n.Node,s=n.Element,f=n.NodeFilter,p=n.NamedNodeMap,d=void 0===p?n.NamedNodeMap||n.MozNamedAttrMap:p,h=n.HTMLFormElement,g=n.DOMParser,y=n.trustedTypes,_=s.prototype,Q=C(_,\"cloneNode\"),ee=C(_,\"nextSibling\"),te=C(_,\"childNodes\"),ne=C(_,\"parentNode\");if(\"function\"==typeof c){var re=i.createElement(\"template\");re.content&&re.content.ownerDocument&&(i=re.content.ownerDocument)}var oe=J(y,a),ae=oe?oe.createHTML(\"\"):\"\",ie=i,le=ie.implementation,ce=ie.createNodeIterator,ue=ie.createDocumentFragment,se=ie.getElementsByTagName,me=a.importNode,fe={};try{fe=D(i).documentMode?i.documentMode:{}}catch(e){}var pe={};r.isSupported=\"function\"==typeof ne&&le&&void 0!==le.createHTMLDocument&&9!==fe;var de,he,ge=G,ye=W,be=q,ve=Y,Te=V,Ne=$,Ee=K,Ae=null,we=O({},[].concat(o(M),o(R),o(L),o(F),o(U))),xe=null,ke=O({},[].concat(o(z),o(B),o(j),o(P))),Se=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_e=null,Oe=null,De=!0,Ce=!0,Me=!1,Re=!1,Le=!1,Ie=!1,Fe=!1,He=!1,Ue=!1,ze=!1,Be=!0,je=!0,Pe=!1,Ge={},We=null,qe=O({},[\"annotation-xml\",\"audio\",\"colgroup\",\"desc\",\"foreignobject\",\"head\",\"iframe\",\"math\",\"mi\",\"mn\",\"mo\",\"ms\",\"mtext\",\"noembed\",\"noframes\",\"noscript\",\"plaintext\",\"script\",\"style\",\"svg\",\"template\",\"thead\",\"title\",\"video\",\"xmp\"]),Ye=null,Ke=O({},[\"audio\",\"video\",\"img\",\"source\",\"image\",\"track\"]),Ve=null,$e=O({},[\"alt\",\"class\",\"for\",\"id\",\"label\",\"name\",\"pattern\",\"placeholder\",\"role\",\"summary\",\"title\",\"value\",\"style\",\"xmlns\"]),Xe=\"http://www.w3.org/1998/Math/MathML\",Ze=\"http://www.w3.org/2000/svg\",Je=\"http://www.w3.org/1999/xhtml\",Qe=Je,et=!1,tt=[\"application/xhtml+xml\",\"text/html\"],nt=\"text/html\",rt=null,ot=i.createElement(\"form\"),at=function(e){return e instanceof RegExp||e instanceof Function},it=function(t){rt&&rt===t||(t&&\"object\"===e(t)||(t={}),t=D(t),Ae=\"ALLOWED_TAGS\"in t?O({},t.ALLOWED_TAGS):we,xe=\"ALLOWED_ATTR\"in t?O({},t.ALLOWED_ATTR):ke,Ve=\"ADD_URI_SAFE_ATTR\"in t?O(D($e),t.ADD_URI_SAFE_ATTR):$e,Ye=\"ADD_DATA_URI_TAGS\"in t?O(D(Ke),t.ADD_DATA_URI_TAGS):Ke,We=\"FORBID_CONTENTS\"in t?O({},t.FORBID_CONTENTS):qe,_e=\"FORBID_TAGS\"in t?O({},t.FORBID_TAGS):{},Oe=\"FORBID_ATTR\"in t?O({},t.FORBID_ATTR):{},Ge=\"USE_PROFILES\"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,Ce=!1!==t.ALLOW_DATA_ATTR,Me=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,He=t.RETURN_DOM||!1,Ue=t.RETURN_DOM_FRAGMENT||!1,ze=t.RETURN_TRUSTED_TYPE||!1,Fe=t.FORCE_BODY||!1,Be=!1!==t.SANITIZE_DOM,je=!1!==t.KEEP_CONTENT,Pe=t.IN_PLACE||!1,Ee=t.ALLOWED_URI_REGEXP||Ee,Qe=t.NAMESPACE||Je,t.CUSTOM_ELEMENT_HANDLING&&at(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Se.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&at(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Se.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&\"boolean\"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Se.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),de=de=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?nt:t.PARSER_MEDIA_TYPE,he=\"application/xhtml+xml\"===de?function(e){return e}:N,Re&&(Ce=!1),Ue&&(He=!0),Ge&&(Ae=O({},o(U)),xe=[],!0===Ge.html&&(O(Ae,M),O(xe,z)),!0===Ge.svg&&(O(Ae,R),O(xe,B),O(xe,P)),!0===Ge.svgFilters&&(O(Ae,L),O(xe,B),O(xe,P)),!0===Ge.mathMl&&(O(Ae,F),O(xe,j),O(xe,P))),t.ADD_TAGS&&(Ae===we&&(Ae=D(Ae)),O(Ae,t.ADD_TAGS)),t.ADD_ATTR&&(xe===ke&&(xe=D(xe)),O(xe,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&O(Ve,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(We===qe&&(We=D(We)),O(We,t.FORBID_CONTENTS)),je&&(Ae[\"#text\"]=!0),Le&&O(Ae,[\"html\",\"head\",\"body\"]),Ae.table&&(O(Ae,[\"tbody\"]),delete _e.tbody),m&&m(t),rt=t)},lt=O({},[\"mi\",\"mo\",\"mn\",\"ms\",\"mtext\"]),ct=O({},[\"foreignobject\",\"desc\",\"title\",\"annotation-xml\"]),ut=O({},[\"title\",\"style\",\"font\",\"a\",\"script\"]),st=O({},R);O(st,L),O(st,I);var mt=O({},F);O(mt,H);var ft=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:Je,tagName:\"template\"});var n=N(e.tagName),r=N(t.tagName);return e.namespaceURI===Ze?t.namespaceURI===Je?\"svg\"===n:t.namespaceURI===Xe?\"svg\"===n&&(\"annotation-xml\"===r||lt[r]):Boolean(st[n]):e.namespaceURI===Xe?t.namespaceURI===Je?\"math\"===n:t.namespaceURI===Ze?\"math\"===n&&ct[r]:Boolean(mt[n]):e.namespaceURI===Je&&(!(t.namespaceURI===Ze&&!ct[r])&&(!(t.namespaceURI===Xe&&!lt[r])&&(!mt[n]&&(ut[n]||!st[n]))))},pt=function(e){T(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ae}catch(t){e.remove()}}},dt=function(e,t){try{T(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){T(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),\"is\"===e&&!xe[e])if(He||Ue)try{pt(t)}catch(e){}else try{t.setAttribute(e,\"\")}catch(e){}},ht=function(e){var t,n;if(Fe)e=\"<remove></remove>\"+e;else{var r=E(e,/^[\\r\\n\\t ]+/);n=r&&r[0]}\"application/xhtml+xml\"===de&&(e='<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>'+e+\"</body></html>\");var o=oe?oe.createHTML(e):e;if(Qe===Je)try{t=(new g).parseFromString(o,de)}catch(e){}if(!t||!t.documentElement){t=le.createDocument(Qe,\"template\",null);try{t.documentElement.innerHTML=et?\"\":o}catch(e){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),Qe===Je?se.call(t,Le?\"html\":\"body\")[0]:Le?t.documentElement:a},gt=function(e){return ce.call(e.ownerDocument||e,e,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},yt=function(e){return e instanceof h&&(\"string\"!=typeof e.nodeName||\"string\"!=typeof e.textContent||\"function\"!=typeof e.removeChild||!(e.attributes instanceof d)||\"function\"!=typeof e.removeAttribute||\"function\"!=typeof e.setAttribute||\"string\"!=typeof e.namespaceURI||\"function\"!=typeof e.insertBefore)},bt=function(t){return\"object\"===e(u)?t instanceof u:t&&\"object\"===e(t)&&\"number\"==typeof t.nodeType&&\"string\"==typeof t.nodeName},vt=function(e,t,n){pe[e]&&b(pe[e],(function(e){e.call(r,t,n,rt)}))},Tt=function(e){var t;if(vt(\"beforeSanitizeElements\",e,null),yt(e))return pt(e),!0;if(k(/[\\u0080-\\uFFFF]/,e.nodeName))return pt(e),!0;var n=he(e.nodeName);if(vt(\"uponSanitizeElement\",e,{tagName:n,allowedTags:Ae}),e.hasChildNodes()&&!bt(e.firstElementChild)&&(!bt(e.content)||!bt(e.content.firstElementChild))&&k(/<[/\\w]/g,e.innerHTML)&&k(/<[/\\w]/g,e.textContent))return pt(e),!0;if(\"select\"===n&&k(/<template/i,e.innerHTML))return pt(e),!0;if(!Ae[n]||_e[n]){if(!_e[n]&&Et(n)){if(Se.tagNameCheck instanceof RegExp&&k(Se.tagNameCheck,n))return!1;if(Se.tagNameCheck instanceof Function&&Se.tagNameCheck(n))return!1}if(je&&!We[n]){var o=ne(e)||e.parentNode,a=te(e)||e.childNodes;if(a&&o)for(var i=a.length-1;i>=0;--i)o.insertBefore(Q(a[i],!0),ee(e))}return pt(e),!0}return e instanceof s&&!ft(e)?(pt(e),!0):\"noscript\"!==n&&\"noembed\"!==n||!k(/<\\/no(script|embed)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,t=A(t,ge,\" \"),t=A(t,ye,\" \"),e.textContent!==t&&(T(r.removed,{element:e.cloneNode()}),e.textContent=t)),vt(\"afterSanitizeElements\",e,null),!1):(pt(e),!0)},Nt=function(e,t,n){if(Be&&(\"id\"===t||\"name\"===t)&&(n in i||n in ot))return!1;if(Ce&&!Oe[t]&&k(be,t));else if(De&&k(ve,t));else if(!xe[t]||Oe[t]){if(!(Et(e)&&(Se.tagNameCheck instanceof RegExp&&k(Se.tagNameCheck,e)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(e))&&(Se.attributeNameCheck instanceof RegExp&&k(Se.attributeNameCheck,t)||Se.attributeNameCheck instanceof Function&&Se.attributeNameCheck(t))||\"is\"===t&&Se.allowCustomizedBuiltInElements&&(Se.tagNameCheck instanceof RegExp&&k(Se.tagNameCheck,n)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(n))))return!1}else if(Ve[t]);else if(k(Ee,A(n,Ne,\"\")));else if(\"src\"!==t&&\"xlink:href\"!==t&&\"href\"!==t||\"script\"===e||0!==w(n,\"data:\")||!Ye[e]){if(Me&&!k(Te,A(n,Ne,\"\")));else if(n)return!1}else;return!0},Et=function(e){return e.indexOf(\"-\")>0},At=function(e){var t,n,o,a;vt(\"beforeSanitizeAttributes\",e,null);var i=e.attributes;if(i){var l={attrName:\"\",attrValue:\"\",keepAttr:!0,allowedAttributes:xe};for(a=i.length;a--;){var c=t=i[a],u=c.name,s=c.namespaceURI;if(n=\"value\"===u?t.value:x(t.value),o=he(u),l.attrName=o,l.attrValue=n,l.keepAttr=!0,l.forceKeepAttr=void 0,vt(\"uponSanitizeAttribute\",e,l),n=l.attrValue,!l.forceKeepAttr&&(dt(u,e),l.keepAttr))if(k(/\\/>/i,n))dt(u,e);else{Re&&(n=A(n,ge,\" \"),n=A(n,ye,\" \"));var m=he(e.nodeName);if(Nt(m,o,n))try{s?e.setAttributeNS(s,u,n):e.setAttribute(u,n),v(r.removed)}catch(e){}}}vt(\"afterSanitizeAttributes\",e,null)}},wt=function e(t){var n,r=gt(t);for(vt(\"beforeSanitizeShadowDOM\",t,null);n=r.nextNode();)vt(\"uponSanitizeShadowNode\",n,null),Tt(n)||(n.content instanceof l&&e(n.content),At(n));vt(\"afterSanitizeShadowDOM\",t,null)};return r.sanitize=function(t,o){var i,c,s,m,f;if((et=!t)&&(t=\"\\x3c!--\\x3e\"),\"string\"!=typeof t&&!bt(t)){if(\"function\"!=typeof t.toString)throw S(\"toString is not a function\");if(\"string\"!=typeof(t=t.toString()))throw S(\"dirty is not a string, aborting\")}if(!r.isSupported){if(\"object\"===e(n.toStaticHTML)||\"function\"==typeof n.toStaticHTML){if(\"string\"==typeof t)return n.toStaticHTML(t);if(bt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Ie||it(o),r.removed=[],\"string\"==typeof t&&(Pe=!1),Pe){if(t.nodeName){var p=he(t.nodeName);if(!Ae[p]||_e[p])throw S(\"root node is forbidden and cannot be sanitized in-place\")}}else if(t instanceof u)1===(c=(i=ht(\"\\x3c!----\\x3e\")).ownerDocument.importNode(t,!0)).nodeType&&\"BODY\"===c.nodeName||\"HTML\"===c.nodeName?i=c:i.appendChild(c);else{if(!He&&!Re&&!Le&&-1===t.indexOf(\"<\"))return oe&&ze?oe.createHTML(t):t;if(!(i=ht(t)))return He?null:ze?ae:\"\"}i&&Fe&&pt(i.firstChild);for(var d=gt(Pe?t:i);s=d.nextNode();)3===s.nodeType&&s===m||Tt(s)||(s.content instanceof l&&wt(s.content),At(s),m=s);if(m=null,Pe)return t;if(He){if(Ue)for(f=ue.call(i.ownerDocument);i.firstChild;)f.appendChild(i.firstChild);else f=i;return xe.shadowroot&&(f=me.call(a,f,!0)),f}var h=Le?i.outerHTML:i.innerHTML;return Le&&Ae[\"!doctype\"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&k(X,i.ownerDocument.doctype.name)&&(h=\"<!DOCTYPE \"+i.ownerDocument.doctype.name+\">\\n\"+h),Re&&(h=A(h,ge,\" \"),h=A(h,ye,\" \")),oe&&ze?oe.createHTML(h):h},r.setConfig=function(e){it(e),Ie=!0},r.clearConfig=function(){rt=null,Ie=!1},r.isValidAttribute=function(e,t,n){rt||it({});var r=he(e),o=he(t);return Nt(r,o,n)},r.addHook=function(e,t){\"function\"==typeof t&&(pe[e]=pe[e]||[],T(pe[e],t))},r.removeHook=function(e){if(pe[e])return v(pe[e])},r.removeHooks=function(e){pe[e]&&(pe[e]=[])},r.removeAllHooks=function(){pe={}},r}()}));",
          "",
          "---------------"
        ],
        "assets/js/site.js||assets/js/site.js": [
          "File: assets/js/site.js -> assets/js/site.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: function formXSSsanitize(form) {",
          "11:     $(form).find(\"input, textarea\").not(\":submit, :reset, :image, :file, :disabled\").not('[data-sanitize-ignore]').each(function() {",
          "12:         $(this).val(DOMPurify.sanitize($(this).val(), {}))",
          "13:     })",
          "14: }",
          "16: function btnClickSubmit(event, form) {",
          "17:     event.preventDefault();",
          "18:     if (XSSsanitize) {",
          "19:         formXSSsanitize(form)",
          "20:     }",
          "22:     $(form).submit()",
          "23: }",
          "25: $(function() {",
          "26:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "27:         btnClickSubmit(e, $(this).parents('form'))",
          "28:     });",
          "29: })",
          "",
          "---------------"
        ],
        "includes/core/user_functions.php||includes/core/user_functions.php": [
          "File: includes/core/user_functions.php -> includes/core/user_functions.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "759:     $jsDef .= ',nv_recaptcha_ver=' . $global_config['recaptcha_ver'];",
          "760:     $jsDef .= ',nv_recaptcha_sitekey=\"' . $global_config['recaptcha_sitekey'] . '\"';",
          "761:     $jsDef .= ',nv_recaptcha_type=\"' . $global_config['recaptcha_type'] . '\"';",
          "762:     $jsDef .= ';';",
          "764:     $return = [];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "763:     !isset($global_config['XSSsanitize']) && $global_config['XSSsanitize'] = 1;",
          "764:     $jsDef .= ',XSSsanitize=' . ($global_config['XSSsanitize'] ? 1 : 0);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "779:     }",
          "781:     if ($global_js) {",
          "782:         $return[] = [",
          "783:             'ext' => 1,",
          "784:             'content' => NV_STATIC_URL . NV_ASSETS_DIR . '/js/global.js'",
          "785:         ];",
          "786:     }",
          "788:     if (!empty($other_js)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "786:         if ($global_config['XSSsanitize']) {",
          "787:             $return[] = [",
          "788:                 'ext' => 1,",
          "789:                 'content' => NV_STATIC_URL . NV_ASSETS_DIR . '/js/DOMPurify/purify.js'",
          "790:             ];",
          "791:         }",
          "798:         $return[] = [",
          "799:             'ext' => 1,",
          "800:             'content' => NV_STATIC_URL . NV_ASSETS_DIR . '/js/site.js'",
          "801:         ];",
          "",
          "---------------"
        ],
        "includes/language/en/admin_settings.php||includes/language/en/admin_settings.php": [
          "File: includes/language/en/admin_settings.php -> includes/language/en/admin_settings.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "391: $lang_module['rp_unsafe_url'] = 'Send the origin, path, and query string when performing any request, regardless of security. Warning: This policy will leak potentially-private information from HTTPS resource URLs to insecure origins. Carefully consider the impact of this setting.';",
          "392: $lang_module['rp_note'] = 'If you want to specify a fallback policy in any case the desired policy hasn\\'t got wide enough browser support, use a comma-separated list with the desired policy specified last. For example, Referrer-Policy: no-referrer-when-downgrade, strict-origin-when-cross-origin. In the above scenario, no-referrer-when-downgrade will only be used if strict-origin-when-cross-origin is not supported by the browser.';",
          "393: $lang_module['rp_directives'] = 'Referrer-Policy directives';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "394: $lang_module['XSSsanitize'] = 'Filter dangerous HTML codes before submitting the form';",
          "395: $lang_module['admin_XSSsanitize'] = 'In the admin area';",
          "396: $lang_module['user_XSSsanitize'] = 'In the user interaction area';",
          "",
          "---------------"
        ],
        "includes/language/fr/admin_settings.php||includes/language/fr/admin_settings.php": [
          "File: includes/language/fr/admin_settings.php -> includes/language/fr/admin_settings.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "391: $lang_module['rp_unsafe_url'] = 'Envoie l\\'origine, le chemin et les param\u00e8tres de requ\u00eate pour toutes les requ\u00eates sans tenir compte du niveau de s\u00e9curit\u00e9. Cette valeur divulgera des informations potentiellement confidentielles de la part des URL de ressources HTTPS vers des origines non s\u00e9curis\u00e9es. Consid\u00e9rez les cons\u00e9quences de ce param\u00e9trage avant de vous en servir.';",
          "392: $lang_module['rp_note'] = 'Si vous voulez sp\u00e9cifier une r\u00e8gle \u00e0 appliquer par d\u00e9faut dans les o\u00f9 la r\u00e8gle voulue n\\'est pas support\u00e9e par les navigateurs, utilisez un liste de valeurs s\u00e9par\u00e9es par des virgules avec la r\u00e8gle voulue fournie en derni\u00e8re position: Referrer-Policy: no-referrer-when-downgrade, strict-origin-when-cross-origin. Ici, no-referrer-when-downgrade ne sera utilis\u00e9e que si strict-origin-when-cross-origin n\\'est pas support\u00e9e par le navigateur.';",
          "393: $lang_module['rp_directives'] = 'Referrer-Policy directives';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "394: $lang_module['XSSsanitize'] = 'Filtrer les codes HTML dangereux avant de soumettre le formulaire';",
          "395: $lang_module['admin_XSSsanitize'] = 'Dans la zone d\\'administration';",
          "396: $lang_module['user_XSSsanitize'] = 'Dans la zone d\\'interaction utilisateur';",
          "",
          "---------------"
        ],
        "includes/language/vi/admin_settings.php||includes/language/vi/admin_settings.php": [
          "File: includes/language/vi/admin_settings.php -> includes/language/vi/admin_settings.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "402: $lang_module['rp_unsafe_url'] = 'G\u1eedi origin, path v\u00e0 querystring trong m\u1ecdi tr\u01b0\u1eddng h\u1ee3p. C\u1ea3nh b\u00e1o: Ch\u00ednh s\u00e1ch n\u00e0y s\u1ebd l\u00e0m r\u00f2 r\u1ec9 th\u00f4ng tin c\u00f3 kh\u1ea3 n\u0103ng ri\u00eang t\u01b0 t\u1eeb c\u00e1c URL d\u1ea1ng HTTPS \u0111\u1ebfn c\u00e1c ngu\u1ed3n kh\u00f4ng an to\u00e0n. H\u00e3y xem x\u00e9t c\u1ea9n th\u1eadn t\u00e1c \u0111\u1ed9ng c\u1ee7a c\u00e0i \u0111\u1eb7t n\u00e0y.';",
          "403: $lang_module['rp_note'] = '\u0110\u1ec3 \u0111\u1ec1 ph\u00f2ng tr\u01b0\u1eddng h\u1ee3p tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3 ch\u1ec9 th\u1ecb mong mu\u1ed1n, b\u1ea1n c\u00f3 th\u1ec3 li\u1ec7t k\u00ea nhi\u1ec1u ch\u1ec9 th\u1ecb \u0111\u01b0\u1ee3c ph\u00e2n c\u00e1ch b\u1eb1ng d\u1ea5u ph\u1ea9y v\u1edbi tr\u1eadt t\u1ef1: ch\u1ec9 th\u1ecb mong mu\u1ed1n \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh sau c\u00f9ng. V\u00ed d\u1ee5: Referrer-Policy: no-referrer-when-downgrade, strict-origin-when-cross-origin. \u1ede v\u00ed d\u1ee5 tr\u00ean, ch\u00ednh s\u00e1ch no-referrer-when-downgrade s\u1ebd \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng n\u1ebfu tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3 strict-origin-when-cross-origin.';",
          "404: $lang_module['rp_directives'] = 'C\u00e1c ch\u1ec9 th\u1ecb RP';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "405: $lang_module['XSSsanitize'] = 'L\u1ecdc c\u00e1c m\u00e3 HTML nguy hi\u1ec3m tr\u01b0\u1edbc khi g\u1eedi bi\u1ec3u m\u1eabu';",
          "406: $lang_module['admin_XSSsanitize'] = 'Trong khu v\u1ef1c qu\u1ea3n tr\u1ecb';",
          "407: $lang_module['user_XSSsanitize'] = 'Trong khu v\u1ef1c t\u01b0\u01a1ng t\u00e1c c\u1ee7a ng\u01b0\u1eddi d\u00f9ng';",
          "",
          "---------------"
        ],
        "install/data.php||install/data.php": [
          "File: install/data.php -> install/data.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "175: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'global', 'allow_null_origin', '0')\";",
          "176: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'global', 'ip_allow_null_origin', '')\";",
          "177: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'global', 'cookie_notice_popup', '0')\";",
          "179: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'define', 'nv_gfx_width', '150')\";",
          "180: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'define', 'nv_gfx_height', '40')\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "178: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'global', 'XSSsanitize', '1')\";",
          "179: $sql_create_table[] = 'INSERT INTO ' . NV_CONFIG_GLOBALTABLE . \" (lang, module, config_name, config_value) VALUES ('sys', 'global', 'admin_XSSsanitize', '1')\";",
          "",
          "---------------"
        ],
        "modules/menu/blocks/global.bootstrap.php||modules/menu/blocks/global.bootstrap.php": [
          "File: modules/menu/blocks/global.bootstrap.php -> modules/menu/blocks/global.bootstrap.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "77:         $array_menu = [];",
          "78:         $sql = 'SELECT id, parentid, title, link, icon, note, subitem, groups_view, module_name, op, target, css, active_type FROM ' . NV_PREFIXLANG . '_menu_rows WHERE status=1 AND mid = ' . $block_config['menuid'] . ' ORDER BY weight ASC';",
          "79:         $list = $nv_Cache->db($sql, '', $block_config['module']);",
          "80:         foreach ($list as $row) {",
          "81:             if (nv_user_in_groups($row['groups_view'])) {",
          "82:                 switch ($row['target']) {",
          "83:                     case 1:",
          "84:                         $row['target'] = '';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "81:         $search = ['&amp;', '&lt;', '&gt;', '&#x005C;', '&#x002F;', '&#40;', '&#41;', '&#42;', '&#91;', '&#93;', '&#33;', '&#x3D;', '&#x23;', '&#x25;', '&#x5E;', '&#x3A;', '&#x7B;', '&#x7D;', '&#x60;', '&#x7E;'];",
          "82:         $replace = ['&', '<', '>', '\\\\', '/', '(', ')', '*', '[', ']', '!', '=', '#', '%', '^', ':', '{', '}', '`', '~'];",
          "86:                 $link = str_replace($search, $replace, $row['link']);",
          "87:                 $link = nv_url_rewrite($link, true);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "96:                     'title_trim' => nv_clean60($row['title'], $block_config['title_length']),",
          "97:                     'target' => $row['target'],",
          "98:                     'note' => empty($row['note']) ? $row['title'] : $row['note'],",
          "100:                     'icon' => (empty($row['icon'])) ? '' : NV_BASE_SITEURL . NV_UPLOADS_DIR . '/menu/' . $row['icon'],",
          "101:                     'css' => $row['css'],",
          "102:                     'active_type' => $row['active_type']",
          "",
          "[Removed Lines]",
          "99:                     'link' => nv_url_rewrite(nv_unhtmlspecialchars($row['link']), true),",
          "",
          "[Added Lines]",
          "106:                     'link' => $link,",
          "",
          "---------------"
        ],
        "modules/menu/menu_blocks.php||modules/menu/menu_blocks.php": [
          "File: modules/menu/menu_blocks.php -> modules/menu/menu_blocks.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:     $sql = 'SELECT id, parentid, title, link, icon, note, subitem, groups_view, module_name, op, target, css, active_type FROM ' . NV_PREFIXLANG . '_menu_rows WHERE status=1 AND mid = ' . $block_config['menuid'] . ' ORDER BY weight ASC';",
          "28:     $list = $nv_Cache->db($sql, '', $block_config['module']);",
          "30:     foreach ($list as $row) {",
          "31:         if (nv_user_in_groups($row['groups_view'])) {",
          "32:             if ($row['link'] != '' and $row['link'] != '#') {",
          "34:                 switch ($row['target']) {",
          "35:                     case 1:",
          "36:                         $row['target'] = '';",
          "",
          "[Removed Lines]",
          "33:                 $row['link'] = nv_url_rewrite(nv_unhtmlspecialchars($row['link']), true);",
          "",
          "[Added Lines]",
          "30:     $search = ['&amp;', '&lt;', '&gt;', '&#x005C;', '&#x002F;', '&#40;', '&#41;', '&#42;', '&#91;', '&#93;', '&#33;', '&#x3D;', '&#x23;', '&#x25;', '&#x5E;', '&#x3A;', '&#x7B;', '&#x7D;', '&#x60;', '&#x7E;'];",
          "31:     $replace = ['&', '<', '>', '\\\\', '/', '(', ')', '*', '[', ']', '!', '=', '#', '%', '^', ':', '{', '}', '`', '~'];",
          "36:                 $row['link'] = str_replace($search, $replace, $row['link']);",
          "37:                 $row['link'] = nv_url_rewrite($row['link'], true);",
          "",
          "---------------"
        ],
        "themes/admin_default/js/main.js||themes/admin_default/js/main.js": [
          "File: themes/admin_default/js/main.js -> themes/admin_default/js/main.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:     }",
          "83: }",
          "85: var NV = {",
          "86:     menuBusy: false,",
          "87:     menuTimer: null,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "85: function formXSSsanitize(form) {",
          "86:     $(form).find(\"input, textarea\").not(\":submit, :reset, :image, :file, :disabled\").not('[data-sanitize-ignore]').each(function(e) {",
          "87:         $(this).val(DOMPurify.sanitize($(this).val(), {}))",
          "88:     })",
          "89: }",
          "91: function btnClickSubmit(event, form) {",
          "92:     event.preventDefault();",
          "93:     if (XSSsanitize) {",
          "94:         formXSSsanitize(form)",
          "95:     }",
          "96:     $(form).submit()",
          "97: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "171:         locationReplace($(this).data(\"location\"))",
          "172:     });",
          "174:     $(document).on('click', function(e) {",
          "175:         if (",
          "176:             $('[data-btn=\"toggleLang\"]').is(':visible') &&",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "189:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "190:         btnClickSubmit(e, $(this).parents('form'))",
          "191:     });",
          "",
          "---------------"
        ],
        "themes/admin_default/modules/settings/security.tpl||themes/admin_default/modules/settings/security.tpl": [
          "File: themes/admin_default/modules/settings/security.tpl -> themes/admin_default/modules/settings/security.tpl",
          "--- Hunk 1 ---",
          "[Context before]",
          "122:                                         <textarea name=\"domains_whitelist\" class=\"form-control\" rows=\"5\">{DOMAINS_WHITELIST}</textarea>",
          "123:                                     </td>",
          "124:                                 </tr>",
          "125:                             </tbody>",
          "126:                             <tfoot>",
          "127:                                 <tr>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:                                 <tr>",
          "126:                                     <td><strong>{LANG.XSSsanitize}</strong></td>",
          "127:                                     <td>",
          "128:                                         <div><label><input type=\"checkbox\" name=\"XSSsanitize\" value=\"1\"{XSSSANITIZE}>{LANG.user_XSSsanitize}</label></div>",
          "129:                                         <div><label><input type=\"checkbox\" name=\"admin_XSSsanitize\" value=\"1\"{ADMIN_XSSSANITIZE}>{LANG.admin_XSSsanitize}<label></div>",
          "130:                                     </td>",
          "131:                                 </tr>",
          "",
          "---------------"
        ],
        "themes/admin_default/system/header.tpl||themes/admin_default/system/header.tpl": [
          "File: themes/admin_default/system/header.tpl -> themes/admin_default/system/header.tpl",
          "--- Hunk 1 ---",
          "[Context before]",
          "29:                  nv_cookie_prefix = '{NV_COOKIE_PREFIX}',",
          "30:                  nv_check_pass_mstime = '{NV_CHECK_PASS_MSTIME}',",
          "31:                  nv_safemode = {NV_SAFEMODE},",
          "33:         </script>",
          "34:         <script type=\"text/javascript\" src=\"{NV_BASE_SITEURL}{NV_ASSETS_DIR}/js/jquery/jquery.min.js\"></script>",
          "35:         <script type=\"text/javascript\" src=\"{NV_BASE_SITEURL}{NV_ASSETS_DIR}/js/language/{NV_LANG_INTERFACE}.js\"></script>",
          "36:         <script type=\"text/javascript\" src=\"{NV_BASE_SITEURL}{NV_ASSETS_DIR}/js/global.js\"></script>",
          "37:         <script type=\"text/javascript\" src=\"{NV_BASE_SITEURL}{NV_ASSETS_DIR}/js/admin.js\"></script>",
          "39:         <!-- BEGIN: module_js -->",
          "",
          "[Removed Lines]",
          "32:                  nv_area_admin = 1;",
          "",
          "[Added Lines]",
          "32:                  nv_area_admin = 1,",
          "33:                  XSSsanitize = {NV_XSS_SANITIZE};",
          "38:         <!-- BEGIN: XSSsanitize -->",
          "39:         <script type=\"text/javascript\" src=\"{NV_BASE_SITEURL}{NV_ASSETS_DIR}/js/DOMPurify/purify.js\"></script>",
          "40:         <!-- END: XSSsanitize -->",
          "",
          "---------------"
        ],
        "themes/admin_default/theme.php||themes/admin_default/theme.php": [
          "File: themes/admin_default/theme.php -> themes/admin_default/theme.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "140:     }",
          "142:     $global_config['site_name'] = empty($global_config['site_name']) ? NV_SERVER_NAME : $global_config['site_name'];",
          "144:     $site_favicon = NV_BASE_SITEURL . 'favicon.ico';",
          "145:     if (!empty($global_config['site_favicon']) and file_exists(NV_ROOTDIR . '/' . $global_config['site_favicon'])) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "143:     !isset($global_config['admin_XSSsanitize']) && $global_config['admin_XSSsanitize'] = 1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "159:     $xtpl->assign('NV_SITE_TITLE', $global_config['site_name'] . NV_TITLEBAR_DEFIS . $lang_global['admin_page'] . NV_TITLEBAR_DEFIS . $module_info['custom_title']);",
          "160:     $xtpl->assign('SITE_DESCRIPTION', empty($global_config['site_description']) ? $page_title : $global_config['site_description']);",
          "161:     $xtpl->assign('NV_CHECK_PASS_MSTIME', ((int) ($global_config['admin_check_pass_time']) - 62) * 1000);",
          "162:     $xtpl->assign('NV_BASE_SITEURL', NV_BASE_SITEURL);",
          "163:     $xtpl->assign('NV_ADMINDIR', NV_ADMINDIR);",
          "164:     $xtpl->assign('NV_BASE_ADMINURL', NV_BASE_ADMINURL);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:     $xtpl->assign('NV_XSS_SANITIZE', ($global_config['admin_XSSsanitize'] ? 1 : 0));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "186:     $xtpl->assign('NV_CURRENTTIME', nv_date('T', NV_CURRENTTIME));",
          "187:     $xtpl->assign('NV_COOKIE_PREFIX', $global_config['cookie_prefix']);",
          "189:     if (file_exists(NV_ROOTDIR . '/themes/' . $admin_info['admin_theme'] . '/js/' . $module_file . '.js')) {",
          "190:         $xtpl->assign('NV_JS_MODULE', NV_STATIC_URL . 'themes/' . $admin_info['admin_theme'] . '/js/' . $module_file . '.js');",
          "191:         $xtpl->parse('main.module_js');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "191:     if ($global_config['admin_XSSsanitize']) {",
          "192:         $xtpl->parse('main.XSSsanitize');",
          "193:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c77e906b47f7882e4f9e487f63e8c6dde4674928",
      "candidate_info": {
        "commit_hash": "c77e906b47f7882e4f9e487f63e8c6dde4674928",
        "repo": "nukeviet/nukeviet",
        "commit_url": "https://github.com/nukeviet/nukeviet/commit/c77e906b47f7882e4f9e487f63e8c6dde4674928",
        "files": [
          "assets/js/site.js",
          "themes/admin_default/js/main.js"
        ],
        "message": "Kh\u00f4ng t\u1ef1 \u0111\u1ed9ng x\u00f3a m\u00e3 XSS khi c\u00f3 name=submit",
        "before_after_code_files": [
          "assets/js/site.js||assets/js/site.js",
          "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ],
          "candidate": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ]
        }
      },
      "candidate_diff": {
        "assets/js/site.js||assets/js/site.js": [
          "File: assets/js/site.js -> assets/js/site.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: $(function() {",
          "26:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "28:     });",
          "29: })",
          "",
          "[Removed Lines]",
          "27:         btnClickSubmit(e, $(this).parents('form'))",
          "",
          "[Added Lines]",
          "27:         var form = $(this).parents('form');",
          "28:         if (!$('[name=submit]', form).length) {",
          "29:             btnClickSubmit(e,form)",
          "30:         }",
          "",
          "---------------"
        ],
        "themes/admin_default/js/main.js||themes/admin_default/js/main.js": [
          "File: themes/admin_default/js/main.js -> themes/admin_default/js/main.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "169:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "171:     });",
          "173:     $(document).on('click', function(e) {",
          "",
          "[Removed Lines]",
          "170:         btnClickSubmit(e, $(this).parents('form'))",
          "",
          "[Added Lines]",
          "170:         var form = $(this).parents('form');",
          "171:         if (!$('[name=submit]', form).length) {",
          "172:             btnClickSubmit(e,form)",
          "173:         }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "429f5ce59cccec63661fc1351a3a9145badddd9a",
      "candidate_info": {
        "commit_hash": "429f5ce59cccec63661fc1351a3a9145badddd9a",
        "repo": "nukeviet/nukeviet",
        "commit_url": "https://github.com/nukeviet/nukeviet/commit/429f5ce59cccec63661fc1351a3a9145badddd9a",
        "files": [
          "assets/js/site.js",
          "themes/admin_default/js/main.js"
        ],
        "message": "Kh\u00f4ng t\u1ef1 \u0111\u1ed9ng x\u00f3a m\u00e3 XSS khi c\u00f3 name=submit",
        "before_after_code_files": [
          "assets/js/site.js||assets/js/site.js",
          "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ],
          "candidate": [
            "assets/js/site.js||assets/js/site.js",
            "themes/admin_default/js/main.js||themes/admin_default/js/main.js"
          ]
        }
      },
      "candidate_diff": {
        "assets/js/site.js||assets/js/site.js": [
          "File: assets/js/site.js -> assets/js/site.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "552:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "554:     });",
          "",
          "[Removed Lines]",
          "553:         btnClickSubmit(e, $(this).parents('form'))",
          "",
          "[Added Lines]",
          "553:         var form = $(this).parents('form');",
          "554:         if (!$('[name=submit]', form).length) {",
          "555:             btnClickSubmit(e,form)",
          "556:         }",
          "",
          "---------------"
        ],
        "themes/admin_default/js/main.js||themes/admin_default/js/main.js": [
          "File: themes/admin_default/js/main.js -> themes/admin_default/js/main.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "190:     $('body').on('click', '[type=submit]:not([name])', function(e) {",
          "192:     });",
          "194:     $(document).on('click', function(e) {",
          "",
          "[Removed Lines]",
          "191:         btnClickSubmit(e, $(this).parents('form'))",
          "",
          "[Added Lines]",
          "191:         var form = $(this).parents('form');",
          "192:         if (!$('[name=submit]', form).length) {",
          "193:             btnClickSubmit(e,form)",
          "194:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}