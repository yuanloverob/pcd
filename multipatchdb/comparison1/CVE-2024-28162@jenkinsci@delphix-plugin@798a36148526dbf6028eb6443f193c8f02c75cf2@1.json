{
  "cve_id": "CVE-2024-28162",
  "cve_desc": "In Jenkins Delphix Plugin 3.0.1 through 3.1.0 (both inclusive) a global option for administrators to enable or disable SSL/TLS certificate validation for Data Control Tower (DCT) connections fails to take effect until Jenkins is restarted when switching from disabled validation to enabled validation.",
  "repo": "jenkinsci/delphix-plugin",
  "patch_hash": "798a36148526dbf6028eb6443f193c8f02c75cf2",
  "patch_info": {
    "commit_hash": "798a36148526dbf6028eb6443f193c8f02c75cf2",
    "repo": "jenkinsci/delphix-plugin",
    "commit_url": "https://github.com/jenkinsci/delphix-plugin/commit/798a36148526dbf6028eb6443f193c8f02c75cf2",
    "files": [
      "src/main/java/io/jenkins/plugins/constant/Constant.java",
      "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
      "src/main/java/io/jenkins/plugins/util/DctSdkUtil.java",
      "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly",
      "src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java",
      "src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java",
      "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java",
      "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java"
    ],
    "message": "Merge pull request #37 from jenkinsci/security_fix_and-_test\n\nSecurity fix and testcase",
    "before_after_code_files": [
      "src/main/java/io/jenkins/plugins/constant/Constant.java||src/main/java/io/jenkins/plugins/constant/Constant.java",
      "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
      "src/main/java/io/jenkins/plugins/util/DctSdkUtil.java||src/main/java/io/jenkins/plugins/util/DctSdkUtil.java",
      "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly",
      "src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java||src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java",
      "src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java||src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java",
      "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java||src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java",
      "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java||src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java"
    ]
  },
  "patch_diff": {
    "src/main/java/io/jenkins/plugins/constant/Constant.java||src/main/java/io/jenkins/plugins/constant/Constant.java": [
      "File: src/main/java/io/jenkins/plugins/constant/Constant.java -> src/main/java/io/jenkins/plugins/constant/Constant.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "6:     public static final String UNIQUE_FILE_NAME = \"delphix-VDB-\";",
      "7:     public static final String PROPERTIES = \".properties\";",
      "8:     public static final String FILE_NAME = \"delphix-VDB\";",
      "10:     public static final String CLIENT_NAME = \"Jenkins\";",
      "11:     public static final String CLIENT_NAME_HEADER = \"x-dct-client-name\";",
      "12:     public static final long WAIT_TIME = 20000;",
      "",
      "[Removed Lines]",
      "9:     public static final String USER_AGENT = \"Jenkins-3.1.0\";",
      "",
      "[Added Lines]",
      "9:     public static final String USER_AGENT = \"Jenkins-3.1.1\";",
      "",
      "---------------"
    ],
    "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java": [
      "File: src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java -> src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "13:     }",
      "15:     private String dctUrl;",
      "18:     public DelphixGlobalConfiguration() {",
      "19:         load();",
      "",
      "[Removed Lines]",
      "16:     private boolean sslCheck;",
      "",
      "[Added Lines]",
      "16:     private boolean disableSsl;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "29:         save();",
      "30:     }",
      "34:     }",
      "36:     @DataBoundSetter",
      "39:         save();",
      "40:     }",
      "41: }",
      "",
      "[Removed Lines]",
      "32:     public boolean getSslCheck() {",
      "33:         return sslCheck;",
      "37:     public void setSslCheck(boolean sslCertificate) {",
      "38:         this.sslCheck = sslCertificate;",
      "",
      "[Added Lines]",
      "32:     public boolean getDisableSsl() {",
      "33:         return disableSsl;",
      "37:     public void setDisableSsl(boolean disableSsl) {",
      "38:         this.disableSsl = disableSsl;",
      "",
      "---------------"
    ],
    "src/main/java/io/jenkins/plugins/util/DctSdkUtil.java||src/main/java/io/jenkins/plugins/util/DctSdkUtil.java": [
      "File: src/main/java/io/jenkins/plugins/util/DctSdkUtil.java -> src/main/java/io/jenkins/plugins/util/DctSdkUtil.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "38:             return;",
      "39:         }",
      "40:         this.defaultClient = Configuration.getDefaultApiClient();",
      "44:         this.defaultClient.setConnectTimeout(Constant.TIMEOUT);",
      "45:         this.defaultClient.setReadTimeout(Constant.TIMEOUT);",
      "46:         this.defaultClient.setWriteTimeout(Constant.TIMEOUT);",
      "",
      "[Removed Lines]",
      "41:         if (DelphixGlobalConfiguration.get().getSslCheck()) {",
      "42:             this.defaultClient.setVerifyingSsl(false);",
      "43:         }",
      "",
      "[Added Lines]",
      "41:         this.defaultClient.setVerifyingSsl(!DelphixGlobalConfiguration.get().getDisableSsl());",
      "",
      "---------------"
    ],
    "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly": [
      "File: src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly -> src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly",
      "--- Hunk 1 ---",
      "[Context before]",
      "5:       <f:textbox />",
      "6:     </f:entry>",
      "9:         <f:checkbox default=\"false\" />",
      "10:     </f:entry>",
      "11:   </f:section>",
      "",
      "[Removed Lines]",
      "8:     <f:entry title=\"Disable SSL Certificate Validation\" field=\"sslCheck\" help=\"/plugin/delphix/help-sslCheck.html\">",
      "",
      "[Added Lines]",
      "8:     <f:entry title=\"Disable SSL Certificate Validation\" field=\"disableSsl\" help=\"/plugin/delphix/help-sslCheck.html\">",
      "",
      "---------------"
    ],
    "src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java||src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java": [
      "File: src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java -> src/test/java/io/jenkins/plugins/delphix/DeleteVDBTest.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java||src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java": [
      "File: src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java -> src/test/java/io/jenkins/plugins/delphix/GlobalConfigurationTest.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: package io.jenkins.plugins.delphix;",
      "3: import com.cloudbees.plugins.credentials.CredentialsProvider;",
      "4: import com.cloudbees.plugins.credentials.CredentialsScope;",
      "5: import com.cloudbees.plugins.credentials.domains.Domain;",
      "6: import hudson.model.FreeStyleBuild;",
      "7: import hudson.model.FreeStyleProject;",
      "8: import hudson.util.Secret;",
      "9: import hudson.model.Result;",
      "10: import jenkins.model.GlobalConfiguration;",
      "11: import org.jenkinsci.plugins.plaincredentials.impl.StringCredentialsImpl;",
      "12: import org.junit.Rule;",
      "13: import org.junit.Test;",
      "14: import org.jvnet.hudson.test.JenkinsRule;",
      "16: public class GlobalConfigurationTest {",
      "18:   @Rule",
      "19:   public JenkinsRule jenkins = new JenkinsRule();",
      "21:   @Test",
      "22:   public void GlobalConfigSSLDisable() throws Exception {",
      "23:     DelphixGlobalConfiguration globalConfig1 =",
      "24:         GlobalConfiguration.all().get(DelphixGlobalConfiguration.class);",
      "25:     globalConfig1.setDctUrl(\"https://self-signed.badssl.com\");",
      "26:     globalConfig1.setDisableSsl(true); //disable ssl",
      "27:     globalConfig1.save();",
      "29:     StringCredentialsImpl c =",
      "30:         new StringCredentialsImpl(CredentialsScope.USER, \"test123\", \"description\",",
      "31:             Secret.fromString(\"api key\"));",
      "32:     CredentialsProvider.lookupStores(jenkins).iterator().next().addCredentials(Domain.global(), c);",
      "34:     FreeStyleProject project = jenkins.createFreeStyleProject();",
      "35:     ProvisionVDBFromSnapshot builder = new ProvisionVDBFromSnapshot();",
      "36:     builder.setSourceDataId(\"4-ORACLE_DB_CONTAINER-6\");",
      "37:     builder.setCredentialId(\"test123\");",
      "38:     builder.setAutoSelectRepository(true);",
      "39:     project.getBuildersList().add(builder);",
      "41:     FreeStyleBuild b1 = project.scheduleBuild2(0).get();",
      "42:     System.out.println(b1.toString());",
      "43:     jenkins.assertLogContains(\"<head><title>404 Not Found</title></head>\", b1);",
      "44:     jenkins.assertBuildStatus(Result.FAILURE, b1);",
      "45:   }",
      "48:   @Test",
      "49:   public void GlobalConfigDefault() throws Exception {",
      "50:     DelphixGlobalConfiguration globalConfig1 =",
      "51:         GlobalConfiguration.all().get(DelphixGlobalConfiguration.class);",
      "52:     globalConfig1.setDctUrl(\"https://self-signed.badssl.com\");",
      "53:     globalConfig1.save();",
      "55:     StringCredentialsImpl c =",
      "56:         new StringCredentialsImpl(CredentialsScope.USER, \"test123\", \"description\",",
      "57:             Secret.fromString(\"api key\"));",
      "58:     CredentialsProvider.lookupStores(jenkins).iterator().next().addCredentials(Domain.global(), c);",
      "60:     FreeStyleProject project = jenkins.createFreeStyleProject();",
      "61:     ProvisionVDBFromSnapshot builder = new ProvisionVDBFromSnapshot();",
      "62:     builder.setSourceDataId(\"4-ORACLE_DB_CONTAINER-6\");",
      "63:     builder.setCredentialId(\"test123\");",
      "64:     builder.setAutoSelectRepository(true);",
      "65:     project.getBuildersList().add(builder);",
      "67:     FreeStyleBuild b1 = project.scheduleBuild2(0).get();",
      "68:     System.out.println(b1.toString());",
      "69:     jenkins.assertLogContains(\"javax.net.ssl.SSLHandshakeException:\", b1);",
      "70:     jenkins.assertBuildStatus(Result.FAILURE, b1);",
      "71:   }",
      "72: }",
      "",
      "---------------"
    ],
    "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java||src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java": [
      "File: src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java -> src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromBookmarkTest.java"
    ],
    "src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java||src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java": [
      "File: src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java -> src/test/java/io/jenkins/plugins/delphix/ProvisionVDBFromSnapshotTest.java"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0052a903b28d5bddff0469f38d4db5cdcfdc02fc",
      "candidate_info": {
        "commit_hash": "0052a903b28d5bddff0469f38d4db5cdcfdc02fc",
        "repo": "jenkinsci/delphix-plugin",
        "commit_url": "https://github.com/jenkinsci/delphix-plugin/commit/0052a903b28d5bddff0469f38d4db5cdcfdc02fc",
        "files": [
          "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
          "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly"
        ],
        "message": "rename the internal data member for global config",
        "before_after_code_files": [
          "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
          "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/delphix-plugin/pull/37"
        ],
        "olp_code_files": {
          "patch": [
            "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
            "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly"
          ],
          "candidate": [
            "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
            "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java||src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java": [
          "File: src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java -> src/main/java/io/jenkins/plugins/delphix/DelphixGlobalConfiguration.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "13:     }",
          "15:     private String dctUrl;",
          "18:     public DelphixGlobalConfiguration() {",
          "19:         load();",
          "",
          "[Removed Lines]",
          "16:     private boolean sslCheck;",
          "",
          "[Added Lines]",
          "16:     private boolean disableSsl;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "30:     }",
          "32:     public boolean isSslDisabled() {",
          "34:     }",
          "36:     @DataBoundSetter",
          "39:         save();",
          "40:     }",
          "41: }",
          "",
          "[Removed Lines]",
          "33:         return sslCheck;",
          "37:     public void setSslCheck(boolean sslCertificate) {",
          "38:         this.sslCheck = sslCertificate;",
          "",
          "[Added Lines]",
          "33:         return disableSsl;",
          "37:     public void setDisableSsl(boolean disableSsl) {",
          "38:         this.disableSsl = disableSsl;",
          "",
          "---------------"
        ],
        "src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly||src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly": [
          "File: src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly -> src/main/resources/io/jenkins/plugins/delphix/DelphixGlobalConfiguration/config.jelly",
          "--- Hunk 1 ---",
          "[Context before]",
          "5:       <f:textbox />",
          "6:     </f:entry>",
          "9:         <f:checkbox default=\"false\" />",
          "10:     </f:entry>",
          "11:   </f:section>",
          "",
          "[Removed Lines]",
          "8:     <f:entry title=\"Disable SSL Certificate Validation\" field=\"sslCheck\" help=\"/plugin/delphix/help-sslCheck.html\">",
          "",
          "[Added Lines]",
          "8:     <f:entry title=\"Disable SSL Certificate Validation\" field=\"disableSsl\" help=\"/plugin/delphix/help-sslCheck.html\">",
          "",
          "---------------"
        ]
      }
    }
  ]
}