{
  "cve_id": "CVE-2024-9329",
  "cve_desc": "In Eclipse Glassfish versions before 7.0.17, The Host HTTP parameter could cause the web application to redirect to the specified URL, when the requested endpoint is '/management/domain'. By modifying the URL value to a malicious site, an attacker may successfully launch a phishing scam and steal user credentials.",
  "repo": "eclipse-ee4j/glassfish",
  "patch_hash": "6ca35eee2ba90a8108984b27bec33f9cc50cd83b",
  "patch_info": {
    "commit_hash": "6ca35eee2ba90a8108984b27bec33f9cc50cd83b",
    "repo": "eclipse-ee4j/glassfish",
    "commit_url": "https://github.com/eclipse-ee4j/glassfish/commit/6ca35eee2ba90a8108984b27bec33f9cc50cd83b",
    "files": [
      "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
    ],
    "message": "Merge pull request #25106 from luiseufrasio/luiseufrasio-CVE-2024-7312-link-redirection-via-host-parameter\n\nsetting local Name and Port for /managment/* URI",
    "before_after_code_files": [
      "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
    ]
  },
  "patch_diff": {
    "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java": [
      "File: nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java -> nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "18: package org.glassfish.admin.rest.adapter;",
      "20: import org.glassfish.admin.restconnector.Constants;",
      "21: import org.jvnet.hk2.annotations.Service;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "21: import org.glassfish.grizzly.http.server.Request;",
      "22: import org.glassfish.grizzly.http.server.Response;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "32:     public RestManagementAdapter() {",
      "33:         super(new RestManagementResourceProvider());",
      "34:     }",
      "35: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "38:     @Override",
      "39:     public void service(Request req, Response res) {",
      "40:         req.setServerName(req.getLocalName());",
      "41:         req.setServerPort(req.getLocalPort());",
      "42:         super.service(req, res);",
      "43:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f433d537c77a8d87b183eb0f0437449e0de38ecb",
      "candidate_info": {
        "commit_hash": "f433d537c77a8d87b183eb0f0437449e0de38ecb",
        "repo": "eclipse-ee4j/glassfish",
        "commit_url": "https://github.com/eclipse-ee4j/glassfish/commit/f433d537c77a8d87b183eb0f0437449e0de38ecb",
        "files": [
          "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
        ],
        "message": "setting local Name and Port for /managment/* URI",
        "before_after_code_files": [
          "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/eclipse-ee4j/glassfish/pull/25106"
        ],
        "olp_code_files": {
          "patch": [
            "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
          ],
          "candidate": [
            "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
          ]
        }
      },
      "candidate_diff": {
        "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java": [
          "File: nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java -> nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "32:     public RestManagementAdapter() {",
          "33:         super(new RestManagementResourceProvider());",
          "34:     }",
          "35: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "36:     @Override",
          "37:     public void service(Request req, Response res) {",
          "38:         req.setServerName(req.getLocalName());",
          "39:         req.setServerPort(req.getLocalPort());",
          "40:         super.service(req, res);",
          "41:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3111942b1eda2e84e59a686dd00486d94a2716ba",
      "candidate_info": {
        "commit_hash": "3111942b1eda2e84e59a686dd00486d94a2716ba",
        "repo": "eclipse-ee4j/glassfish",
        "commit_url": "https://github.com/eclipse-ee4j/glassfish/commit/3111942b1eda2e84e59a686dd00486d94a2716ba",
        "files": [
          "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
        ],
        "message": "imports added",
        "before_after_code_files": [
          "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/eclipse-ee4j/glassfish/pull/25106"
        ],
        "olp_code_files": {
          "patch": [
            "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
          ],
          "candidate": [
            "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java"
          ]
        }
      },
      "candidate_diff": {
        "nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java||nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java": [
          "File: nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java -> nucleus/admin/rest/rest-service/src/main/java/org/glassfish/admin/rest/adapter/RestManagementAdapter.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: package org.glassfish.admin.rest.adapter;",
          "20: import org.glassfish.admin.restconnector.Constants;",
          "21: import org.jvnet.hk2.annotations.Service;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: import org.glassfish.grizzly.http.server.Request;",
          "22: import org.glassfish.grizzly.http.server.Response;",
          "",
          "---------------"
        ]
      }
    }
  ]
}