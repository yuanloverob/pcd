{
  "cve_id": "CVE-2018-12022",
  "cve_desc": "An issue was discovered in FasterXML jackson-databind prior to 2.7.9.4, 2.8.11.2, and 2.9.6. When Default Typing is enabled (either globally or for a specific property), the service has the Jodd-db jar (for database access for the Jodd framework) in the classpath, and an attacker can provide an LDAP service to access, it is possible to make the service execute a malicious payload.",
  "repo": "FasterXML/jackson-databind",
  "patch_hash": "28badf7ef60ac3e7ef151cd8e8ec010b8479226a",
  "patch_info": {
    "commit_hash": "28badf7ef60ac3e7ef151cd8e8ec010b8479226a",
    "repo": "FasterXML/jackson-databind",
    "commit_url": "https://github.com/FasterXML/jackson-databind/commit/28badf7ef60ac3e7ef151cd8e8ec010b8479226a",
    "files": [
      "release-notes/VERSION",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
    ],
    "message": "Backport #2052, #2058 fixes for 2.7.9.4",
    "before_after_code_files": [
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
    ]
  },
  "patch_diff": {
    "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java": [
      "File: src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java -> src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "58:         s.add(\"org.apache.ibatis.parsing.XPathParser\");",
      "60:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
      "61:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61:         s.add(\"jodd.db.connection.DataSourceConnectionProvider\");",
      "64:         s.add(\"oracle.jdbc.connector.OracleManagedConnectionFactory\");",
      "65:         s.add(\"oracle.jdbc.rowset.OracleJDBCRowSet\");",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7487cf7eb14be2f65a1eb108e8629c07ef45e0a1",
      "candidate_info": {
        "commit_hash": "7487cf7eb14be2f65a1eb108e8629c07ef45e0a1",
        "repo": "FasterXML/jackson-databind",
        "commit_url": "https://github.com/FasterXML/jackson-databind/commit/7487cf7eb14be2f65a1eb108e8629c07ef45e0a1",
        "files": [
          "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
        ],
        "message": "Preliminary blocks for #2052: not actually sure if there is vuln via gadgets, but they seem suspicious enough to block tentatively",
        "before_after_code_files": [
          "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
          ],
          "candidate": [
            "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java": [
          "File: src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java -> src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "61:         s.add(\"org.apache.ibatis.parsing.XPathParser\");",
          "63:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
          "64:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65:         s.add(\"oracle.jdbc.connector.OracleManagedConnectionFactory\");",
          "66:         s.add(\"jodd.db.connection.DataSourceConnectionProvider\");",
          "67:         s.add(\"oracle.jdbc.rowset.OracleJDBCRowSet\");",
          "",
          "---------------"
        ]
      }
    }
  ]
}