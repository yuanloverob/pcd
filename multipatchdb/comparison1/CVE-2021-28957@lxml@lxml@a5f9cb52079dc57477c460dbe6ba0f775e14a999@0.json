{
  "cve_id": "CVE-2021-28957",
  "cve_desc": "An XSS vulnerability was discovered in python-lxml's clean module versions before 4.6.3. When disabling the safe_attrs_only and forms arguments, the Cleaner class does not remove the formaction attribute allowing for JS to bypass the sanitizer. A remote attacker could exploit this flaw to run arbitrary JS code on users who interact with incorrectly sanitized HTML. This issue is patched in lxml 4.6.3.",
  "repo": "lxml/lxml",
  "patch_hash": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
  "patch_info": {
    "commit_hash": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
    "repo": "lxml/lxml",
    "commit_url": "https://github.com/lxml/lxml/commit/a5f9cb52079dc57477c460dbe6ba0f775e14a999",
    "files": [
      "CHANGES.txt",
      "doc/main.txt",
      "src/lxml/__init__.py"
    ],
    "message": "Prepare release of lxml 4.6.3.",
    "before_after_code_files": [
      "src/lxml/__init__.py||src/lxml/__init__.py"
    ]
  },
  "patch_diff": {
    "src/lxml/__init__.py||src/lxml/__init__.py": [
      "File: src/lxml/__init__.py -> src/lxml/__init__.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # this is a package",
      "6: def get_include():",
      "",
      "[Removed Lines]",
      "3: __version__ = \"4.6.2\"",
      "",
      "[Added Lines]",
      "3: __version__ = \"4.6.3\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "982f8d5612925010a12a70748a077af846def6be",
      "candidate_info": {
        "commit_hash": "982f8d5612925010a12a70748a077af846def6be",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/982f8d5612925010a12a70748a077af846def6be",
        "files": [
          "src/lxml/__init__.py"
        ],
        "message": "Change version in master branch to 4.7.0a0.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.4\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.7.0a0\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bc84830de8cbd675cae1aa4f753a9fc887a7c268",
      "candidate_info": {
        "commit_hash": "bc84830de8cbd675cae1aa4f753a9fc887a7c268",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/bc84830de8cbd675cae1aa4f753a9fc887a7c268",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.6.4.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.3\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.4\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c",
      "candidate_info": {
        "commit_hash": "a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.6.5.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.4\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.5\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "61432a8489657744ed32367ed9fb17fafe405d8e",
      "candidate_info": {
        "commit_hash": "61432a8489657744ed32367ed9fb17fafe405d8e",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/61432a8489657744ed32367ed9fb17fafe405d8e",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of lxml 4.6.1.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.6.0\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.6.1\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0ce08858a824a0a4fae4102af849a8fbf7bcad6f",
      "candidate_info": {
        "commit_hash": "0ce08858a824a0a4fae4102af849a8fbf7bcad6f",
        "repo": "lxml/lxml",
        "commit_url": "https://github.com/lxml/lxml/commit/0ce08858a824a0a4fae4102af849a8fbf7bcad6f",
        "files": [
          "CHANGES.txt",
          "doc/main.txt",
          "src/lxml/__init__.py"
        ],
        "message": "Prepare release of 4.5.1.",
        "before_after_code_files": [
          "src/lxml/__init__.py||src/lxml/__init__.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ],
          "candidate": [
            "src/lxml/__init__.py||src/lxml/__init__.py"
          ]
        }
      },
      "candidate_diff": {
        "src/lxml/__init__.py||src/lxml/__init__.py": [
          "File: src/lxml/__init__.py -> src/lxml/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # this is a package",
          "6: def get_include():",
          "",
          "[Removed Lines]",
          "3: __version__ = \"4.5.0\"",
          "",
          "[Added Lines]",
          "3: __version__ = \"4.5.1\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}