{
  "cve_id": "CVE-2023-39010",
  "cve_desc": "BoofCV 0.42 was discovered to contain a code injection vulnerability via the component boofcv.io.calibration.CalibrationIO.load. This vulnerability is exploited by loading a crafted camera calibration file.",
  "repo": "lessthanoptimal/BoofCV",
  "patch_hash": "0da6139ff69fd5a49359854ab01935d06c7f5aac",
  "patch_info": {
    "commit_hash": "0da6139ff69fd5a49359854ab01935d06c7f5aac",
    "repo": "lessthanoptimal/BoofCV",
    "commit_url": "https://github.com/lessthanoptimal/BoofCV/commit/0da6139ff69fd5a49359854ab01935d06c7f5aac",
    "files": [
      "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
    ],
    "message": "CalibrationIO - Increased code point limit for SnakeYaml - Upgrading SnakeYaml was causing a crash",
    "before_after_code_files": [
      "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
    ]
  },
  "patch_diff": {
    "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java": [
      "File: main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java -> main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "123:  }",
      "125:  public static Yaml createYmlObject() {",
      "129:  }",
      "",
      "[Removed Lines]",
      "126:   DumperOptions options = new DumperOptions();",
      "127:   options.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);",
      "128:   return new Yaml(options);",
      "",
      "[Added Lines]",
      "126:   var dumperOptions = new DumperOptions();",
      "127:   dumperOptions.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);",
      "130:   var loaderOptions = new LoaderOptions();",
      "131:   loaderOptions.setCodePointLimit(30_145_728);",
      "133:   return new Yaml(new Constructor(new LoaderOptions()), new Representer(dumperOptions),",
      "134:     dumperOptions, loaderOptions);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d167f4d66c895e6536a3d59ff931d1987da3a0a0",
      "candidate_info": {
        "commit_hash": "d167f4d66c895e6536a3d59ff931d1987da3a0a0",
        "repo": "lessthanoptimal/BoofCV",
        "commit_url": "https://github.com/lessthanoptimal/BoofCV/commit/d167f4d66c895e6536a3d59ff931d1987da3a0a0",
        "files": [
          "change.txt",
          "integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java",
          "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
        ],
        "message": "- Security   - When de-serializing YAML it now uses Yaml(new SafeConstructor()) to prevent arbitrary code execution   - Thanks Letian Yuan for the disclosure",
        "before_after_code_files": [
          "integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java||integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java",
          "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
          ],
          "candidate": [
            "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java"
          ]
        }
      },
      "candidate_diff": {
        "integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java||integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java": [
          "File: integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java -> integration/boofcv-swing/src/main/java/boofcv/gui/BoofSwingUtil.java"
        ],
        "main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java||main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java": [
          "File: main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java -> main/boofcv-io/src/main/java/boofcv/io/calibration/CalibrationIO.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: import org.yaml.snakeyaml.DumperOptions;",
          "33: import org.yaml.snakeyaml.LoaderOptions;",
          "34: import org.yaml.snakeyaml.Yaml;",
          "36: import org.yaml.snakeyaml.representer.Representer;",
          "38: import java.io.*;",
          "",
          "[Removed Lines]",
          "35: import org.yaml.snakeyaml.constructor.Constructor;",
          "",
          "[Added Lines]",
          "35: import org.yaml.snakeyaml.constructor.SafeConstructor;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "130:   var loaderOptions = new LoaderOptions();",
          "131:   loaderOptions.setCodePointLimit(30_145_728);",
          "134:     dumperOptions, loaderOptions);",
          "135:  }",
          "",
          "[Removed Lines]",
          "133:   return new Yaml(new Constructor(new LoaderOptions()), new Representer(dumperOptions),",
          "",
          "[Added Lines]",
          "133:   return new Yaml(new SafeConstructor(new LoaderOptions()), new Representer(dumperOptions),",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "742:    var representer = new Representer(new DumperOptions());",
          "743:    representer.getPropertyUtils().setSkipMissingProperties(true);",
          "746:    Map<String, Object> map = yaml.load(filtered);",
          "748:    int width = getOrThrow(map, \"image_width\");",
          "",
          "[Removed Lines]",
          "745:    var yaml = new Yaml(new Constructor(new LoaderOptions()), representer);",
          "",
          "[Added Lines]",
          "745:    var yaml = new Yaml(new SafeConstructor(new LoaderOptions()), representer);",
          "",
          "---------------"
        ]
      }
    }
  ]
}