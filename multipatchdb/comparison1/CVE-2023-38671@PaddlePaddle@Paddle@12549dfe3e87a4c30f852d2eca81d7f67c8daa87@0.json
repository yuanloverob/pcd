{
  "cve_id": "CVE-2023-38671",
  "cve_desc": "Heap buffer overflow in paddle.trace in PaddlePaddle before 2.5.0. This flaw can lead to a denial of service, information disclosure, or more damage is possible.\n",
  "repo": "PaddlePaddle/Paddle",
  "patch_hash": "12549dfe3e87a4c30f852d2eca81d7f67c8daa87",
  "patch_info": {
    "commit_hash": "12549dfe3e87a4c30f852d2eca81d7f67c8daa87",
    "repo": "PaddlePaddle/Paddle",
    "commit_url": "https://github.com/PaddlePaddle/Paddle/commit/12549dfe3e87a4c30f852d2eca81d7f67c8daa87",
    "files": [
      "paddle/phi/infermeta/unary.cc"
    ],
    "message": "fix trace heap overflow",
    "before_after_code_files": [
      "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc"
    ]
  },
  "patch_diff": {
    "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc": [
      "File: paddle/phi/infermeta/unary.cc -> paddle/phi/infermeta/unary.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "4016:       x_dims.size(),",
      "4017:       2,",
      "4018:       phi::errors::OutOfRange(",
      "4020:           x_dims.size()));",
      "4021:   PADDLE_ENFORCE_LT(",
      "4022:       dim1_,",
      "4023:       x_dims.size(),",
      "4024:       phi::errors::OutOfRange(",
      "4026:           \"%ld], but got %ld).\",",
      "4027:           -(x_dims.size()),",
      "4028:           (x_dims.size() - 1),",
      "",
      "[Removed Lines]",
      "4019:           \"Input's dim is out of range (expected at least 2, but got %ld).\",",
      "4025:           \"Attr(dim1) is out of range (expected to be in range of [%ld, \"",
      "",
      "[Added Lines]",
      "4019:           \"Input(x)'s dim is out of range (expected at least 2, but got %ld).\",",
      "4025:           \"axis1 is out of range (expected to be in range of [%ld, \"",
      "4026:           \"%ld], but got %ld).\",",
      "4027:           -(x_dims.size()),",
      "4028:           (x_dims.size() - 1),",
      "4029:           dim1));",
      "4030:   PADDLE_ENFORCE_GE(",
      "4031:       dim1_,",
      "4032:       0,",
      "4033:       phi::errors::OutOfRange(",
      "4034:           \"axis1 is out of range (expected to be in range of [%ld, \"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "4031:       dim2_,",
      "4032:       x_dims.size(),",
      "4033:       phi::errors::OutOfRange(",
      "4035:           \"%ld], but got %ld).\",",
      "4036:           -(x_dims.size()),",
      "4037:           (x_dims.size() - 1),",
      "",
      "[Removed Lines]",
      "4034:           \"Attr(dim2) is out of range (expected to be in range of [%ld, \"",
      "",
      "[Added Lines]",
      "4043:           \"axis2 is out of range (expected to be in range of [%ld, \"",
      "4044:           \"%ld], but got %ld).\",",
      "4045:           -(x_dims.size()),",
      "4046:           (x_dims.size() - 1),",
      "4047:           dim2));",
      "4048:   PADDLE_ENFORCE_GE(",
      "4049:       dim2_,",
      "4050:       0,",
      "4051:       phi::errors::OutOfRange(",
      "4052:           \"axis2 is out of range (expected to be in range of [%ld, \"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5feadc0b2753db513ca1523affadc93b086318d8",
      "candidate_info": {
        "commit_hash": "5feadc0b2753db513ca1523affadc93b086318d8",
        "repo": "PaddlePaddle/Paddle",
        "commit_url": "https://github.com/PaddlePaddle/Paddle/commit/5feadc0b2753db513ca1523affadc93b086318d8",
        "files": [
          "paddle/phi/infermeta/unary.cc"
        ],
        "message": "fix trace heap overflow (#49548)",
        "before_after_code_files": [
          "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/PaddlePaddle/Paddle/pull/49548"
        ],
        "olp_code_files": {
          "patch": [
            "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc"
          ],
          "candidate": [
            "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc"
          ]
        }
      },
      "candidate_diff": {
        "paddle/phi/infermeta/unary.cc||paddle/phi/infermeta/unary.cc": [
          "File: paddle/phi/infermeta/unary.cc -> paddle/phi/infermeta/unary.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "4033:       x_dims.size(),",
          "4034:       2,",
          "4035:       phi::errors::OutOfRange(",
          "4037:           x_dims.size()));",
          "4038:   PADDLE_ENFORCE_LT(",
          "4039:       dim1_,",
          "4040:       x_dims.size(),",
          "4041:       phi::errors::OutOfRange(",
          "4043:           \"%ld], but got %ld).\",",
          "4044:           -(x_dims.size()),",
          "4045:           (x_dims.size() - 1),",
          "",
          "[Removed Lines]",
          "4036:           \"Input's dim is out of range (expected at least 2, but got %ld).\",",
          "4042:           \"Attr(dim1) is out of range (expected to be in range of [%ld, \"",
          "",
          "[Added Lines]",
          "4036:           \"Input(x)'s dim is out of range (expected at least 2, but got %ld).\",",
          "4042:           \"axis1 is out of range (expected to be in range of [%ld, \"",
          "4043:           \"%ld], but got %ld).\",",
          "4044:           -(x_dims.size()),",
          "4045:           (x_dims.size() - 1),",
          "4046:           dim1));",
          "4047:   PADDLE_ENFORCE_GE(",
          "4048:       dim1_,",
          "4049:       0,",
          "4050:       phi::errors::OutOfRange(",
          "4051:           \"axis1 is out of range (expected to be in range of [%ld, \"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4048:       dim2_,",
          "4049:       x_dims.size(),",
          "4050:       phi::errors::OutOfRange(",
          "4052:           \"%ld], but got %ld).\",",
          "4053:           -(x_dims.size()),",
          "4054:           (x_dims.size() - 1),",
          "",
          "[Removed Lines]",
          "4051:           \"Attr(dim2) is out of range (expected to be in range of [%ld, \"",
          "",
          "[Added Lines]",
          "4060:           \"axis2 is out of range (expected to be in range of [%ld, \"",
          "4061:           \"%ld], but got %ld).\",",
          "4062:           -(x_dims.size()),",
          "4063:           (x_dims.size() - 1),",
          "4064:           dim2));",
          "4065:   PADDLE_ENFORCE_GE(",
          "4066:       dim2_,",
          "4067:       0,",
          "4068:       phi::errors::OutOfRange(",
          "4069:           \"axis2 is out of range (expected to be in range of [%ld, \"",
          "",
          "---------------"
        ]
      }
    }
  ]
}