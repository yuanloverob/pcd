{
  "cve_id": "CVE-2020-1936",
  "cve_desc": "A cross-site scripting issue was found in Apache Ambari Views. This was addressed in Apache Ambari 2.7.4.",
  "repo": "apache/ambari",
  "patch_hash": "a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
  "patch_info": {
    "commit_hash": "a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
    "repo": "apache/ambari",
    "commit_url": "https://github.com/apache/ambari/pull/3040/commits/a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
    "files": [
      "ambari-web/app/views/common/breadcrumbs_view.js"
    ],
    "message": "AMBARI-25329. Ambari breadcrumbs xss vulnerability",
    "before_after_code_files": [
      "ambari-web/app/views/common/breadcrumbs_view.js||ambari-web/app/views/common/breadcrumbs_view.js"
    ]
  },
  "patch_diff": {
    "ambari-web/app/views/common/breadcrumbs_view.js||ambari-web/app/views/common/breadcrumbs_view.js": [
      "File: ambari-web/app/views/common/breadcrumbs_view.js -> ambari-web/app/views/common/breadcrumbs_view.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "149:   createLabel() {",
      "150:     let label = this.get('label');",
      "151:     let labelBindingPath = this.get('labelBindingPath');",
      "154:     this.set('formattedLabel', this.labelPostFormat(formattedLabel));",
      "155:   },",
      "",
      "[Removed Lines]",
      "153:     let formattedLabel = labelBindingPath ? App.get(_getLabelPathWithoutApp(labelBindingPath)) : label;",
      "",
      "[Added Lines]",
      "152:     let formattedLabel;",
      "154:     if (labelBindingPath) {",
      "155:       formattedLabel = Ember.Handlebars.Utils.escapeExpression(App.get(_getLabelPathWithoutApp(labelBindingPath)));",
      "156:     } else{",
      "157:       formattedLabel = label;",
      "158:     }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "216:       }",
      "217:       currentState = currentState.get('parentState');",
      "218:     }",
      "220:     if (items.length) {",
      "221:       items.get('lastObject').setProperties({",
      "222:         disabled: true,",
      "",
      "[Removed Lines]",
      "219:     items = items.reverse().map(item => App.BreadcrumbItem.extend(item).create());",
      "",
      "[Added Lines]",
      "227:     items.reverse();",
      "228:     items.slice(1).forEach(item => item.label = Ember.Handlebars.Utils.escapeExpression(item.label));",
      "229:     items = items.map(item => App.BreadcrumbItem.extend(item).create());",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b18e2954b4f58e8725c2bef93862da9a4f80b84d",
      "candidate_info": {
        "commit_hash": "b18e2954b4f58e8725c2bef93862da9a4f80b84d",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/b18e2954b4f58e8725c2bef93862da9a4f80b84d",
        "files": [
          "ambari-agent/src/main/python/ambari_agent/Hardware.py",
          "ambari-agent/src/test/python/ambari_agent/TestHardware.py",
          "ambari-server/src/main/resources/stacks/stack_advisor.py",
          "contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py",
          "contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py"
        ],
        "message": "AMBARI-24641. Stackadvisor error while trying to add atlas service. E\u2026 (#2323) (#2333)\n\n* AMBARI-24641. Stackadvisor error while trying to add atlas service. Error - \"if mountPoints[mountPoint] < reqiuredDiskSpace: KeyError: None\" (amagyar)\n\n* AMBARI-24641. Stackadvisor error while trying to add atlas service. Error - \"if mountPoints[mountPoint] < reqiuredDiskSpace: KeyError: None\" (amagyar)",
        "before_after_code_files": [
          "ambari-agent/src/main/python/ambari_agent/Hardware.py||ambari-agent/src/main/python/ambari_agent/Hardware.py",
          "ambari-agent/src/test/python/ambari_agent/TestHardware.py||ambari-agent/src/test/python/ambari_agent/TestHardware.py",
          "ambari-server/src/main/resources/stacks/stack_advisor.py||ambari-server/src/main/resources/stacks/stack_advisor.py",
          "contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py||contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py",
          "contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py||contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-agent/src/main/python/ambari_agent/Hardware.py||ambari-agent/src/main/python/ambari_agent/Hardware.py": [
          "File: ambari-agent/src/main/python/ambari_agent/Hardware.py -> ambari-agent/src/main/python/ambari_agent/Hardware.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "103:   def _check_remote_mounts(self):",
          "104:     \"\"\"Verify if remote mount allowed to be processed or not\"\"\"",
          "105:     if self.config and self.config.has_option(AmbariConfig.AMBARI_PROPERTIES_CATEGORY, Hardware.CHECK_REMOTE_MOUNTS_KEY) and \\",
          "112:   def _is_mount_blacklisted(self, blacklist, mount_point):",
          "113:     \"\"\"",
          "",
          "[Removed Lines]",
          "106:       self.config.get(AmbariConfig.AMBARI_PROPERTIES_CATEGORY, Hardware.CHECK_REMOTE_MOUNTS_KEY).lower() == \"false\":",
          "108:       return False",
          "110:     return True",
          "",
          "[Added Lines]",
          "106:       self.config.get(AmbariConfig.AMBARI_PROPERTIES_CATEGORY, Hardware.CHECK_REMOTE_MOUNTS_KEY).lower() == \"true\":",
          "108:       return True",
          "110:     return False",
          "",
          "---------------"
        ],
        "ambari-agent/src/test/python/ambari_agent/TestHardware.py||ambari-agent/src/test/python/ambari_agent/TestHardware.py": [
          "File: ambari-agent/src/test/python/ambari_agent/TestHardware.py -> ambari-agent/src/test/python/ambari_agent/TestHardware.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "154:     get_os_version_mock.return_value = \"11\"",
          "155:     Hardware(cache_info=False).osdisks()",
          "156:     timeout = 10",
          "159:     config = AmbariConfig()",
          "160:     Hardware(config=config, cache_info=False).osdisks()",
          "163:     config.add_section(AmbariConfig.AMBARI_PROPERTIES_CATEGORY)",
          "164:     config.set(AmbariConfig.AMBARI_PROPERTIES_CATEGORY, Hardware.CHECK_REMOTE_MOUNTS_KEY, \"true\")",
          "",
          "[Removed Lines]",
          "157:     shell_call_mock.assert_called_with(['timeout', str(timeout), \"df\", \"-kPT\"], stdout = subprocess32.PIPE, stderr = subprocess32.PIPE, timeout = timeout, quiet = True)",
          "161:     shell_call_mock.assert_called_with(['timeout', str(timeout), \"df\", \"-kPT\"], stdout = subprocess32.PIPE, stderr = subprocess32.PIPE, timeout = timeout, quiet = True)",
          "",
          "[Added Lines]",
          "157:     shell_call_mock.assert_called_with(['timeout', str(timeout), \"df\", \"-kPT\", \"-l\"], stdout = subprocess32.PIPE, stderr = subprocess32.PIPE, timeout = timeout, quiet = True)",
          "161:     shell_call_mock.assert_called_with(['timeout', str(timeout), \"df\", \"-kPT\", \"-l\"], stdout = subprocess32.PIPE, stderr = subprocess32.PIPE, timeout = timeout, quiet = True)",
          "",
          "---------------"
        ],
        "ambari-server/src/main/resources/stacks/stack_advisor.py||ambari-server/src/main/resources/stacks/stack_advisor.py": [
          "File: ambari-server/src/main/resources/stacks/stack_advisor.py -> ambari-server/src/main/resources/stacks/stack_advisor.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "2999:     if not mountPoints:",
          "3000:       return self.getErrorItem(\"No disk info found on host %s\" % hostInfo[\"host_name\"])",
          "3002:     if mountPoints[mountPoint] < reqiuredDiskSpace:",
          "3003:       msg = \"Ambari Metrics disk space requirements not met. \\n\" \\",
          "3004:             \"Recommended disk space for partition {0} is {1}G\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3002:     if mountPoint is None:",
          "3003:       return self.getErrorItem(\"No mount point in directory %s. Mount points: %s\" % (dir, ', '.join(mountPoints.keys())))",
          "",
          "---------------"
        ],
        "contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py||contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py": [
          "File: contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py -> contrib/management-packs/hdf-ambari-mpack/src/main/resources/stacks/HDF/2.0/services/stack_advisor.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1511:     if not mountPoints:",
          "1512:       return self.getErrorItem(\"No disk info found on host %s\" % hostInfo[\"host_name\"])",
          "1514:     if mountPoints[mountPoint] < reqiuredDiskSpace:",
          "1515:       msg = \"Ambari Metrics disk space requirements not met. \\n\" \\",
          "1516:             \"Recommended disk space for partition {0} is {1}G\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1514:     if mountPoint is None:",
          "1515:       return self.getErrorItem(\"No mount point in directory %s. Mount points: %s\" % (dir, ', '.join(mountPoints.keys())))",
          "",
          "---------------"
        ],
        "contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py||contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py": [
          "File: contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py -> contrib/management-packs/odpi-ambari-mpack/src/main/resources/stacks/ODPi/2.0/services/stack_advisor.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1313:     if not mountPoints:",
          "1314:       return self.getErrorItem(\"No disk info found on host %s\" % hostInfo[\"host_name\"])",
          "1316:     if mountPoints[mountPoint] < reqiuredDiskSpace:",
          "1317:       msg = \"Ambari Metrics disk space requirements not met. \\n\" \\",
          "1318:             \"Recommended disk space for partition {0} is {1}G\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1316:     if mountPoint is None:",
          "1317:       return self.getErrorItem(\"No mount point in directory %s. Mount points: %s\" % (dir, ', '.join(mountPoints.keys())))",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d2cd06a49f33407d15a690d8f20f8c38d19a9521",
      "candidate_info": {
        "commit_hash": "d2cd06a49f33407d15a690d8f20f8c38d19a9521",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/d2cd06a49f33407d15a690d8f20f8c38d19a9521",
        "files": [
          "ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs",
          "ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js"
        ],
        "message": "AMBARI-25441. HDP-GPL field is not available in version registration page but present in edit page",
        "before_after_code_files": [
          "ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs||ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs",
          "ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js||ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs||ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs": [
          "File: ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs -> ambari-web/app/templates/main/admin/stack_upgrade/edit_repositories.hbs",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:           <table class=\"table table-condensed no-borders inner-table\">",
          "39:             <tbody>",
          "40:               {{#each repository in os.repositories}}",
          "47:               {{/each}}",
          "48:             </tbody>",
          "49:           </table>",
          "",
          "[Removed Lines]",
          "41:                 <tr {{bindAttr class=\"repository.repoName\"}}>",
          "42:                   <td class=\"col-md-2\">{{repository.repoName}}</td>",
          "43:                   <td class=\"col-md-8\">",
          "44:                     <div {{bindAttr class=\"repository.hasError:error :form-group\"}}>{{view App.BaseUrlTextField repositoryBinding=\"repository\" disabledBinding=\"view.content.useRedhatSatellite\"}}</div>",
          "45:                   </td>",
          "46:                 </tr>",
          "",
          "[Added Lines]",
          "41:                 {{#if repository.showRepo}}",
          "42:                   <tr {{bindAttr class=\"repository.repoName\"}}>",
          "43:                     <td class=\"col-md-2\">{{repository.repoName}}</td>",
          "44:                     <td class=\"col-md-8\">",
          "45:                       <div {{bindAttr class=\"repository.hasError:error :form-group\"}}>{{view App.BaseUrlTextField repositoryBinding=\"repository\" disabledBinding=\"view.content.useRedhatSatellite\"}}</div>",
          "46:                     </td>",
          "47:                   </tr>",
          "48:                 {{/if}}",
          "",
          "---------------"
        ],
        "ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js||ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js": [
          "File: ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js -> ambari-web/app/views/main/admin/stack_upgrade/upgrade_version_box_view.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "480:               repoName: repository.get('repoName'),",
          "481:               repoId: repository.get('repoId'),",
          "482:               baseUrl: repository.get('baseUrl'),",
          "484:             });",
          "485:           })",
          "486:         });",
          "",
          "[Removed Lines]",
          "483:               hasError: false",
          "",
          "[Added Lines]",
          "483:               hasError: false,",
          "484:               showRepo: repository.get('showRepo')",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6f5e966cb372af85b1562d3d608bda708caf301f",
      "candidate_info": {
        "commit_hash": "6f5e966cb372af85b1562d3d608bda708caf301f",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/6f5e966cb372af85b1562d3d608bda708caf301f",
        "files": [
          "ambari-web/app/templates/main/host/details/host_component.hbs",
          "ambari-web/app/views/main/host/details/host_component_view.js"
        ],
        "message": "AMBARI-24161 Cannot distinguish components on Host Details page due to shortened display name (Ambari should show full component name on mouse over). (ababiichuk)",
        "before_after_code_files": [
          "ambari-web/app/templates/main/host/details/host_component.hbs||ambari-web/app/templates/main/host/details/host_component.hbs",
          "ambari-web/app/views/main/host/details/host_component_view.js||ambari-web/app/views/main/host/details/host_component_view.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-web/app/templates/main/host/details/host_component.hbs||ambari-web/app/templates/main/host/details/host_component.hbs": [
          "File: ambari-web/app/templates/main/host/details/host_component.hbs -> ambari-web/app/templates/main/host/details/host_component.hbs",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: <td class=\"component-name-block\">",
          "48:   <span>",
          "49:     {{#if component.displayNameAdvanced}}",
          "51:     {{else}}",
          "53:     {{/if}}",
          "54:     <span class=\"hidden-lg\"><br/></span>",
          "55:     <a href=\"#\" {{action routeToService component.service}} {{bindAttr title=\"component.service.displayName\"}}>",
          "",
          "[Removed Lines]",
          "50:       <span {{bindAttr title=\"component.displayNameAdvanced\"}}>{{component.getDisplayNameAdvanced}}&nbsp;/</span>",
          "52:       <span {{bindAttr title=\"component.displayName\"}}>{{component.getDisplayName}}&nbsp;/</span>",
          "",
          "[Added Lines]",
          "50:       <span rel=\"componentNameTooltip\" {{bindAttr data-original-title=\"component.displayNameAdvanced\"}}>{{component.getDisplayNameAdvanced}}&nbsp;/</span>",
          "52:       <span rel=\"componentNameTooltip\" {{bindAttr data-original-title=\"component.displayName\"}}>{{component.getDisplayName}}&nbsp;/</span>",
          "",
          "---------------"
        ],
        "ambari-web/app/views/main/host/details/host_component_view.js||ambari-web/app/views/main/host/details/host_component_view.js": [
          "File: ambari-web/app/views/main/host/details/host_component_view.js -> ambari-web/app/views/main/host/details/host_component_view.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "274:   didInsertElement: function () {",
          "275:     App.tooltip($('[rel=componentHealthTooltip]'));",
          "276:     App.tooltip($('[rel=passiveTooltip]'));",
          "277:     if (this.get('isInProgress')) {",
          "278:       this.doBlinking();",
          "279:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "277:     App.tooltip($('[rel=componentNameTooltip]'));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "676618b93ba40ef248dac7af2010accb381ce45d",
      "candidate_info": {
        "commit_hash": "676618b93ba40ef248dac7af2010accb381ce45d",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/676618b93ba40ef248dac7af2010accb381ce45d",
        "files": [
          "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java",
          "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java",
          "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java",
          "ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java"
        ],
        "message": "AMBARI-25210. ONEFS installation via blueprint fails (amagyar) (#2886)",
        "before_after_code_files": [
          "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java||ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java",
          "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java||ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java",
          "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java||ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java",
          "ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java||ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java||ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java -> ambari-server/src/main/java/org/apache/ambari/server/controller/internal/BlueprintConfigurationProcessor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1950:               return origValue;",
          "1951:             }",
          "1954:               return origValue;",
          "1955:             }",
          "",
          "[Removed Lines]",
          "1953:             if (topology.isComponentHadoopCompatible(component)) {",
          "",
          "[Added Lines]",
          "1953:             if (isComponentNameNode() && topology.hasHadoopCompatibleService()) { // do not fail, could be a ONEFS installation",
          "",
          "---------------"
        ],
        "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java||ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java -> ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopology.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "181:   String getDefaultPassword();",
          "187: }",
          "",
          "[Removed Lines]",
          "186:   boolean isComponentHadoopCompatible(String component);",
          "",
          "[Added Lines]",
          "186:   boolean hasHadoopCompatibleService();",
          "",
          "---------------"
        ],
        "ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java||ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java -> ambari-server/src/main/java/org/apache/ambari/server/topology/ClusterTopologyImpl.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "315:   }",
          "317:   @Override",
          "319:     return blueprint.getServiceInfos().stream()",
          "324:   }",
          "326:   private void registerHostGroupInfo(Map<String, HostGroupInfo> requestedHostGroupInfoMap) throws InvalidTopologyException {",
          "",
          "[Removed Lines]",
          "318:   public boolean isComponentHadoopCompatible(String component) {",
          "320:       .filter(service -> service.getComponentByName(component) != null)",
          "321:       .findFirst()",
          "322:       .map(service -> HADOOP_COMPATIBLE_FS.equals(service.getServiceType()))",
          "323:       .orElse(false);",
          "",
          "[Added Lines]",
          "318:   public boolean hasHadoopCompatibleService() {",
          "320:       .anyMatch(service -> HADOOP_COMPATIBLE_FS.equals(service.getServiceType()));",
          "",
          "---------------"
        ],
        "ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java||ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java": [
          "File: ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java -> ambari-server/src/test/java/org/apache/ambari/server/topology/ClusterTopologyImplTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: import static java.util.Arrays.asList;",
          "22: import static java.util.Collections.singletonList;",
          "23: import static org.easymock.EasyMock.expect;",
          "25: import static org.junit.Assert.assertTrue;",
          "26: import static org.powermock.api.easymock.PowerMock.createNiceMock;",
          "27: import static org.powermock.api.easymock.PowerMock.replay;",
          "",
          "[Removed Lines]",
          "24: import static org.junit.Assert.assertFalse;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "232:     ).anyTimes();",
          "233:     replayAll();",
          "234:     ClusterTopologyImpl topology = new ClusterTopologyImpl(null, new TestTopologyRequest(TopologyRequest.Type.PROVISION));",
          "237:   }",
          "239:   private ServiceInfo aHCFSWith(ComponentInfo... components) {",
          "",
          "[Removed Lines]",
          "235:     assertTrue(topology.isComponentHadoopCompatible(\"ONEFS_CLIENT\"));",
          "236:     assertFalse(topology.isComponentHadoopCompatible(\"ZOOKEEPER_CLIENT\"));",
          "",
          "[Added Lines]",
          "234:     assertTrue(topology.hasHadoopCompatibleService());",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d7248a3177bebbba66f7df9004ee85cb548e643b",
      "candidate_info": {
        "commit_hash": "d7248a3177bebbba66f7df9004ee85cb548e643b",
        "repo": "apache/ambari",
        "commit_url": "https://github.com/apache/ambari/commit/d7248a3177bebbba66f7df9004ee85cb548e643b",
        "files": [
          "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java"
        ],
        "message": "AMBARI-25200. Ambari returns stack trace in HTML doc when an error occurs retrieving details for a user resource that does not exist (dlysnichenko) (#2879)",
        "before_after_code_files": [
          "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java||ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/ambari/pull/3633",
          "https://github.com/apache/ambari/pull/3631",
          "https://github.com/apache/ambari/pull/3637",
          "https://github.com/apache/ambari/pull/3632",
          "https://github.com/apache/ambari/pull/3634",
          "https://github.com/apache/ambari/pull/3635"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java||ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java": [
          "File: ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java -> ambari-server/src/main/java/org/apache/ambari/server/controller/internal/UserPrivilegeResourceProvider.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "279:             }",
          "280:           }",
          "281:           usersCache.get().putAll(userNames);",
          "283:         }",
          "285:         if (userEntity == null) {",
          "",
          "[Removed Lines]",
          "282:           userEntity = usersCache.get().getUnchecked(userName);",
          "",
          "[Added Lines]",
          "282:           userEntity = usersCache.get().getIfPresent(userName);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "287:         }",
          "289:         if (userEntity == null) {",
          "291:         }",
          "293:         final Collection<PrivilegeEntity> privileges = users.getUserPrivileges(userEntity);",
          "",
          "[Removed Lines]",
          "290:           throw new SystemException(\"User was not found\");",
          "",
          "[Added Lines]",
          "290:           throw new NoSuchParentResourceException(\"User was not found\");",
          "",
          "---------------"
        ]
      }
    }
  ]
}