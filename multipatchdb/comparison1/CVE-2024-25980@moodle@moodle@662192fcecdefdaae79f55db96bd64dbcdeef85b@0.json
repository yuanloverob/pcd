{
  "cve_id": "CVE-2024-25980",
  "cve_desc": "Separate Groups mode restrictions were not honored in the H5P attempts report, which would display users from other groups. By default this only provided additional access to non-editing teachers.",
  "repo": "moodle/moodle",
  "patch_hash": "662192fcecdefdaae79f55db96bd64dbcdeef85b",
  "patch_info": {
    "commit_hash": "662192fcecdefdaae79f55db96bd64dbcdeef85b",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/662192fcecdefdaae79f55db96bd64dbcdeef85b",
    "files": [
      "mod/h5pactivity/classes/local/manager.php",
      "mod/h5pactivity/tests/local/manager_test.php"
    ],
    "message": "MDL-80501 mod_h5pactivity: activity group mode\n\nRespect activity's group mode when checking access to the report.\nPreviously only the course's group mode was checked.",
    "before_after_code_files": [
      "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
      "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
    ]
  },
  "patch_diff": {
    "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php": [
      "File: mod/h5pactivity/classes/local/manager.php -> mod/h5pactivity/classes/local/manager.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "487:             if ($user && $user->id != $USER->id) {",
      "488:                 $course = get_course($this->coursemodule->course);",
      "490:                     return null;",
      "491:                 }",
      "492:             }",
      "",
      "[Removed Lines]",
      "489:                 if ($this->coursemodule->effectivegroupmode == SEPARATEGROUPS && !user_can_view_profile($user, $course)) {",
      "",
      "[Added Lines]",
      "489:                 if (!groups_user_groups_visible($course, $user->id, $this->coursemodule)) {",
      "",
      "---------------"
    ],
    "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php": [
      "File: mod/h5pactivity/tests/local/manager_test.php -> mod/h5pactivity/tests/local/manager_test.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "964:         ];",
      "965:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "974:     public function test_get_report_groupmode(bool $activitygroupmode): void {",
      "975:         global $DB;",
      "977:         $this->resetAfterTest();",
      "978:         $this->setAdminUser();",
      "980:         if ($activitygroupmode) {",
      "981:             $course = $this->getDataGenerator()->create_course(['groupmode' => NOGROUPS, 'groupmodeforce' => 0]);",
      "982:             $activitysettings = ['course' => $course, 'groupmode' => SEPARATEGROUPS];",
      "983:         } else {",
      "984:             $course = $this->getDataGenerator()->create_course(['groupmode' => SEPARATEGROUPS, 'groupmodeforce' => 1]);",
      "985:             $activitysettings = ['course' => $course];",
      "986:         }",
      "988:         $activity = $this->getDataGenerator()->create_module('h5pactivity', $activitysettings);",
      "992:         $teacherrole = $DB->get_record('role', ['shortname' => 'teacher']);",
      "993:         role_change_permission($teacherrole->id,",
      "994:             \\context_course::instance($course->id), 'mod/h5pactivity:reviewattempts', CAP_ALLOW);",
      "996:         $manager = manager::create_from_instance($activity);",
      "998:         $editingteacher = $this->getDataGenerator()->create_and_enrol($course, 'editingteacher');",
      "999:         $teacher1 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
      "1000:         $teacher2 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
      "1001:         $student1 = $this->getDataGenerator()->create_and_enrol($course);",
      "1002:         $student2 = $this->getDataGenerator()->create_and_enrol($course);",
      "1003:         $student3 = $this->getDataGenerator()->create_and_enrol($course);",
      "1005:         $group1 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
      "1006:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $teacher1->id]);",
      "1007:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $student1->id]);",
      "1009:         $group2 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
      "1010:         $this->getDataGenerator()->create_group_member(['groupid' => $group2->id, 'userid' => $student2->id]);",
      "1015:         $this->setUser($editingteacher);",
      "1016:         $report = $manager->get_report($student1->id);",
      "1017:         $this->assertNotNull($report);",
      "1018:         $report = $manager->get_report($student3->id);",
      "1019:         $this->assertNotNull($report);",
      "1022:         $this->setUser($teacher1);",
      "1023:         $report = $manager->get_report($student1->id);",
      "1024:         $this->assertNotNull($report);",
      "1027:         $report = $manager->get_report($student3->id);",
      "1028:         $this->assertNull($report);",
      "1031:         $report = $manager->get_report($student2->id);",
      "1032:         $this->assertNull($report);",
      "1035:         $this->setUser($teacher2);",
      "1036:         $report = $manager->get_report($student1->id);",
      "1037:         $this->assertNull($report);",
      "1038:         $report = $manager->get_report($student3->id);",
      "1039:         $this->assertNull($report);",
      "1040:     }",
      "1047:     public function get_report_data_groupmode(): array {",
      "1048:         return [",
      "1050:             'course groupmode is SEPARATEGROUPS' => [false],",
      "1051:             'course groupmode is NOGROUPS, activity groupmode is SEPARATEGROUPS' => [true],",
      "1052:         ];",
      "1053:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "bd305ed770bb4e3d94625db5bd42c5bf25db693b",
      "candidate_info": {
        "commit_hash": "bd305ed770bb4e3d94625db5bd42c5bf25db693b",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/bd305ed770bb4e3d94625db5bd42c5bf25db693b",
        "files": [
          "mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php"
        ],
        "message": "MDL-80501 mod_h5pactivity: activity group mode\n\nRespect activity's group mode when checking access to the report.\nPreviously only the course's group mode was checked.",
        "before_after_code_files": [
          "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ],
          "candidate": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php": [
          "File: mod/h5pactivity/classes/local/manager.php -> mod/h5pactivity/classes/local/manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "487:             if ($user && $user->id != $USER->id) {",
          "488:                 $course = get_course($this->coursemodule->course);",
          "490:                     return null;",
          "491:                 }",
          "492:             }",
          "",
          "[Removed Lines]",
          "489:                 if ($this->coursemodule->effectivegroupmode == SEPARATEGROUPS && !user_can_view_profile($user, $course)) {",
          "",
          "[Added Lines]",
          "489:                 if (!groups_user_groups_visible($course, $user->id, $this->coursemodule)) {",
          "",
          "---------------"
        ],
        "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php": [
          "File: mod/h5pactivity/tests/local/manager_test.php -> mod/h5pactivity/tests/local/manager_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "964:         ];",
          "965:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "974:     public function test_get_report_groupmode(bool $activitygroupmode): void {",
          "975:         global $DB;",
          "977:         $this->resetAfterTest();",
          "978:         $this->setAdminUser();",
          "980:         if ($activitygroupmode) {",
          "981:             $course = $this->getDataGenerator()->create_course(['groupmode' => NOGROUPS, 'groupmodeforce' => 0]);",
          "982:             $activitysettings = ['course' => $course, 'groupmode' => SEPARATEGROUPS];",
          "983:         } else {",
          "984:             $course = $this->getDataGenerator()->create_course(['groupmode' => SEPARATEGROUPS, 'groupmodeforce' => 1]);",
          "985:             $activitysettings = ['course' => $course];",
          "986:         }",
          "988:         $activity = $this->getDataGenerator()->create_module('h5pactivity', $activitysettings);",
          "992:         $teacherrole = $DB->get_record('role', ['shortname' => 'teacher']);",
          "993:         role_change_permission($teacherrole->id,",
          "994:             \\context_course::instance($course->id), 'mod/h5pactivity:reviewattempts', CAP_ALLOW);",
          "996:         $manager = manager::create_from_instance($activity);",
          "998:         $editingteacher = $this->getDataGenerator()->create_and_enrol($course, 'editingteacher');",
          "999:         $teacher1 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "1000:         $teacher2 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "1001:         $student1 = $this->getDataGenerator()->create_and_enrol($course);",
          "1002:         $student2 = $this->getDataGenerator()->create_and_enrol($course);",
          "1003:         $student3 = $this->getDataGenerator()->create_and_enrol($course);",
          "1005:         $group1 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "1006:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $teacher1->id]);",
          "1007:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $student1->id]);",
          "1009:         $group2 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "1010:         $this->getDataGenerator()->create_group_member(['groupid' => $group2->id, 'userid' => $student2->id]);",
          "1015:         $this->setUser($editingteacher);",
          "1016:         $report = $manager->get_report($student1->id);",
          "1017:         $this->assertNotNull($report);",
          "1018:         $report = $manager->get_report($student3->id);",
          "1019:         $this->assertNotNull($report);",
          "1022:         $this->setUser($teacher1);",
          "1023:         $report = $manager->get_report($student1->id);",
          "1024:         $this->assertNotNull($report);",
          "1027:         $report = $manager->get_report($student3->id);",
          "1028:         $this->assertNull($report);",
          "1031:         $report = $manager->get_report($student2->id);",
          "1032:         $this->assertNull($report);",
          "1035:         $this->setUser($teacher2);",
          "1036:         $report = $manager->get_report($student1->id);",
          "1037:         $this->assertNull($report);",
          "1038:         $report = $manager->get_report($student3->id);",
          "1039:         $this->assertNull($report);",
          "1040:     }",
          "1047:     public function get_report_data_groupmode(): array {",
          "1048:         return [",
          "1050:             'course groupmode is SEPARATEGROUPS' => [false],",
          "1051:             'course groupmode is NOGROUPS, activity groupmode is SEPARATEGROUPS' => [true],",
          "1052:         ];",
          "1053:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4b9f6e77d38f93155c5daaac95b02cb9eb6e9cd9",
      "candidate_info": {
        "commit_hash": "4b9f6e77d38f93155c5daaac95b02cb9eb6e9cd9",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/4b9f6e77d38f93155c5daaac95b02cb9eb6e9cd9",
        "files": [
          "mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php"
        ],
        "message": "MDL-80501 mod_h5pactivity: activity group mode\n\nRespect activity's group mode when checking access to the report.\nPreviously only the course's group mode was checked.",
        "before_after_code_files": [
          "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ],
          "candidate": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php": [
          "File: mod/h5pactivity/classes/local/manager.php -> mod/h5pactivity/classes/local/manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "487:             if ($user && $user->id != $USER->id) {",
          "488:                 $course = get_course($this->coursemodule->course);",
          "490:                     return null;",
          "491:                 }",
          "492:             }",
          "",
          "[Removed Lines]",
          "489:                 if ($this->coursemodule->effectivegroupmode == SEPARATEGROUPS && !user_can_view_profile($user, $course)) {",
          "",
          "[Added Lines]",
          "489:                 if (!groups_user_groups_visible($course, $user->id, $this->coursemodule)) {",
          "",
          "---------------"
        ],
        "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php": [
          "File: mod/h5pactivity/tests/local/manager_test.php -> mod/h5pactivity/tests/local/manager_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "964:         ];",
          "965:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "974:     public function test_get_report_groupmode(bool $activitygroupmode): void {",
          "975:         global $DB;",
          "977:         $this->resetAfterTest();",
          "978:         $this->setAdminUser();",
          "980:         if ($activitygroupmode) {",
          "981:             $course = $this->getDataGenerator()->create_course(['groupmode' => NOGROUPS, 'groupmodeforce' => 0]);",
          "982:             $activitysettings = ['course' => $course, 'groupmode' => SEPARATEGROUPS];",
          "983:         } else {",
          "984:             $course = $this->getDataGenerator()->create_course(['groupmode' => SEPARATEGROUPS, 'groupmodeforce' => 1]);",
          "985:             $activitysettings = ['course' => $course];",
          "986:         }",
          "988:         $activity = $this->getDataGenerator()->create_module('h5pactivity', $activitysettings);",
          "992:         $teacherrole = $DB->get_record('role', ['shortname' => 'teacher']);",
          "993:         role_change_permission($teacherrole->id,",
          "994:             \\context_course::instance($course->id), 'mod/h5pactivity:reviewattempts', CAP_ALLOW);",
          "996:         $manager = manager::create_from_instance($activity);",
          "998:         $editingteacher = $this->getDataGenerator()->create_and_enrol($course, 'editingteacher');",
          "999:         $teacher1 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "1000:         $teacher2 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "1001:         $student1 = $this->getDataGenerator()->create_and_enrol($course);",
          "1002:         $student2 = $this->getDataGenerator()->create_and_enrol($course);",
          "1003:         $student3 = $this->getDataGenerator()->create_and_enrol($course);",
          "1005:         $group1 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "1006:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $teacher1->id]);",
          "1007:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $student1->id]);",
          "1009:         $group2 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "1010:         $this->getDataGenerator()->create_group_member(['groupid' => $group2->id, 'userid' => $student2->id]);",
          "1015:         $this->setUser($editingteacher);",
          "1016:         $report = $manager->get_report($student1->id);",
          "1017:         $this->assertNotNull($report);",
          "1018:         $report = $manager->get_report($student3->id);",
          "1019:         $this->assertNotNull($report);",
          "1022:         $this->setUser($teacher1);",
          "1023:         $report = $manager->get_report($student1->id);",
          "1024:         $this->assertNotNull($report);",
          "1027:         $report = $manager->get_report($student3->id);",
          "1028:         $this->assertNull($report);",
          "1031:         $report = $manager->get_report($student2->id);",
          "1032:         $this->assertNull($report);",
          "1035:         $this->setUser($teacher2);",
          "1036:         $report = $manager->get_report($student1->id);",
          "1037:         $this->assertNull($report);",
          "1038:         $report = $manager->get_report($student3->id);",
          "1039:         $this->assertNull($report);",
          "1040:     }",
          "1047:     public function get_report_data_groupmode(): array {",
          "1048:         return [",
          "1050:             'course groupmode is SEPARATEGROUPS' => [false],",
          "1051:             'course groupmode is NOGROUPS, activity groupmode is SEPARATEGROUPS' => [true],",
          "1052:         ];",
          "1053:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fa72ebc1555fecfbedc7ac94440f641d587bd6ec",
      "candidate_info": {
        "commit_hash": "fa72ebc1555fecfbedc7ac94440f641d587bd6ec",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/fa72ebc1555fecfbedc7ac94440f641d587bd6ec",
        "files": [
          "mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php"
        ],
        "message": "MDL-80501 mod_h5pactivity: activity group mode\n\nRespect activity's group mode when checking access to the report.\nPreviously only the course's group mode was checked.",
        "before_after_code_files": [
          "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
          "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ],
          "candidate": [
            "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php",
            "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/h5pactivity/classes/local/manager.php||mod/h5pactivity/classes/local/manager.php": [
          "File: mod/h5pactivity/classes/local/manager.php -> mod/h5pactivity/classes/local/manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "480:             if ($user && $user->id != $USER->id) {",
          "481:                 $course = get_course($this->coursemodule->course);",
          "483:                     return null;",
          "484:                 }",
          "485:             }",
          "",
          "[Removed Lines]",
          "482:                 if ($this->coursemodule->effectivegroupmode == SEPARATEGROUPS && !user_can_view_profile($user, $course)) {",
          "",
          "[Added Lines]",
          "482:                 if (!groups_user_groups_visible($course, $user->id, $this->coursemodule)) {",
          "",
          "---------------"
        ],
        "mod/h5pactivity/tests/local/manager_test.php||mod/h5pactivity/tests/local/manager_test.php": [
          "File: mod/h5pactivity/tests/local/manager_test.php -> mod/h5pactivity/tests/local/manager_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "950:         ];",
          "951:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "960:     public function test_get_report_groupmode(bool $activitygroupmode): void {",
          "961:         global $DB;",
          "963:         $this->resetAfterTest();",
          "964:         $this->setAdminUser();",
          "966:         if ($activitygroupmode) {",
          "967:             $course = $this->getDataGenerator()->create_course(['groupmode' => NOGROUPS, 'groupmodeforce' => 0]);",
          "968:             $activitysettings = ['course' => $course, 'groupmode' => SEPARATEGROUPS];",
          "969:         } else {",
          "970:             $course = $this->getDataGenerator()->create_course(['groupmode' => SEPARATEGROUPS, 'groupmodeforce' => 1]);",
          "971:             $activitysettings = ['course' => $course];",
          "972:         }",
          "974:         $activity = $this->getDataGenerator()->create_module('h5pactivity', $activitysettings);",
          "978:         $teacherrole = $DB->get_record('role', ['shortname' => 'teacher']);",
          "979:         role_change_permission($teacherrole->id,",
          "980:             \\context_course::instance($course->id), 'mod/h5pactivity:reviewattempts', CAP_ALLOW);",
          "982:         $manager = manager::create_from_instance($activity);",
          "984:         $editingteacher = $this->getDataGenerator()->create_and_enrol($course, 'editingteacher');",
          "985:         $teacher1 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "986:         $teacher2 = $this->getDataGenerator()->create_and_enrol($course, 'teacher');",
          "987:         $student1 = $this->getDataGenerator()->create_and_enrol($course);",
          "988:         $student2 = $this->getDataGenerator()->create_and_enrol($course);",
          "989:         $student3 = $this->getDataGenerator()->create_and_enrol($course);",
          "991:         $group1 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "992:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $teacher1->id]);",
          "993:         $this->getDataGenerator()->create_group_member(['groupid' => $group1->id, 'userid' => $student1->id]);",
          "995:         $group2 = $this->getDataGenerator()->create_group(['courseid' => $course->id]);",
          "996:         $this->getDataGenerator()->create_group_member(['groupid' => $group2->id, 'userid' => $student2->id]);",
          "1001:         $this->setUser($editingteacher);",
          "1002:         $report = $manager->get_report($student1->id);",
          "1003:         $this->assertNotNull($report);",
          "1004:         $report = $manager->get_report($student3->id);",
          "1005:         $this->assertNotNull($report);",
          "1008:         $this->setUser($teacher1);",
          "1009:         $report = $manager->get_report($student1->id);",
          "1010:         $this->assertNotNull($report);",
          "1013:         $report = $manager->get_report($student3->id);",
          "1014:         $this->assertNull($report);",
          "1017:         $report = $manager->get_report($student2->id);",
          "1018:         $this->assertNull($report);",
          "1021:         $this->setUser($teacher2);",
          "1022:         $report = $manager->get_report($student1->id);",
          "1023:         $this->assertNull($report);",
          "1024:         $report = $manager->get_report($student3->id);",
          "1025:         $this->assertNull($report);",
          "1026:     }",
          "1033:     public function get_report_data_groupmode(): array {",
          "1034:         return [",
          "1036:             'course groupmode is SEPARATEGROUPS' => [false],",
          "1037:             'course groupmode is NOGROUPS, activity groupmode is SEPARATEGROUPS' => [true],",
          "1038:         ];",
          "1039:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}