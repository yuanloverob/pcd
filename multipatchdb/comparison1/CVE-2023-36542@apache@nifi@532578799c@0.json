{
  "cve_id": "CVE-2023-36542",
  "cve_desc": "Apache NiFi 0.0.2 through 1.22.0 include Processors and Controller Services that support HTTP URL references for retrieving drivers, which allows an authenticated and authorized user to configure a location that enables custom code execution. The resolution introduces a new Required Permission for referencing remote resources, restricting configuration of these components to privileged users. The permission prevents unprivileged users from configuring Processors and Controller Services annotated with the new Reference Remote Resources restriction. Upgrading to Apache NiFi 1.23.0 is the recommended mitigation.",
  "repo": "apache/nifi",
  "patch_hash": "532578799c0a4cb1edc54dadda81aa60787e54b0",
  "patch_info": {
    "commit_hash": "532578799c0a4cb1edc54dadda81aa60787e54b0",
    "repo": "apache/nifi",
    "commit_url": "https://github.com/apache/nifi/commit/532578799c0a4cb1edc54dadda81aa60787e54b0",
    "files": [
      "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
      "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
    ],
    "message": "NIFI-11744 Added Required Permission to Reference Remote Resources\n\n- Applied Required Permission to components supporting URL Resource References\n\nSigned-off-by: Matt Burgess <mattyb149@apache.org>",
    "before_after_code_files": [
      "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
      "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
      "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
      "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
      "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
    ]
  },
  "patch_diff": {
    "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java": [
      "File: nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java -> nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "30:     ACCESS_KEYTAB(\"access-keytab\", \"access keytab\"),",
      "31:     ACCESS_TICKET_CACHE(\"access-ticket-cache\", \"access ticket cache\"),",
      "32:     ACCESS_ENVIRONMENT_CREDENTIALS(\"access-environment-credentials\", \"access environment credentials\"),",
      "35:     private String permissionIdentifier;",
      "36:     private String permissionLabel;",
      "",
      "[Removed Lines]",
      "33:     EXPORT_NIFI_DETAILS(\"export-nifi-details\", \"export nifi details\");",
      "",
      "[Added Lines]",
      "33:     EXPORT_NIFI_DETAILS(\"export-nifi-details\", \"export nifi details\"),",
      "34:     REFERENCE_REMOTE_RESOURCES(\"reference-remote-resources\", \"reference remote resources\");",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java": [
      "File: nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java -> nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "31: import org.apache.nifi.annotation.behavior.InputRequirement;",
      "32: import org.apache.nifi.annotation.behavior.PrimaryNodeOnly;",
      "33: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
      "34: import org.apache.nifi.annotation.behavior.Stateful;",
      "35: import org.apache.nifi.annotation.behavior.TriggerSerially;",
      "36: import org.apache.nifi.annotation.behavior.WritesAttribute;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "34: import org.apache.nifi.annotation.behavior.Restricted;",
      "35: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "65: import org.apache.nifi.components.AllowableValue;",
      "66: import org.apache.nifi.components.PropertyDescriptor;",
      "67: import org.apache.nifi.components.PropertyValue;",
      "68: import org.apache.nifi.components.ValidationContext;",
      "69: import org.apache.nifi.components.ValidationResult;",
      "70: import org.apache.nifi.components.resource.ResourceCardinality;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "151:                 + \"application/json\")",
      "152: })",
      "153: @RequiresInstanceClassLoading",
      "154: public class CaptureChangeMySQL extends AbstractSessionFactoryProcessor {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "157: @Restricted(",
      "158:         restrictions = {",
      "159:                 @Restriction(",
      "160:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "161:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
      "162:                 )",
      "163:         }",
      "164: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java": [
      "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "17: package org.apache.nifi.jms.cf;",
      "19: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "20: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "21: import org.apache.nifi.annotation.documentation.SeeAlso;",
      "22: import org.apache.nifi.annotation.documentation.Tags;",
      "23: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
      "24: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
      "25: import org.apache.nifi.components.PropertyDescriptor;",
      "26: import org.apache.nifi.controller.AbstractControllerService;",
      "27: import org.apache.nifi.controller.ConfigurationContext;",
      "28: import org.apache.nifi.expression.ExpressionLanguageScope;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "20: import org.apache.nifi.annotation.behavior.Restricted;",
      "21: import org.apache.nifi.annotation.behavior.Restriction;",
      "28: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "61:                 + \"property and 'com.ibm.mq.jms.MQConnectionFactory.setTransportType(int)' would imply 'transportType' property.\",",
      "62:                 expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
      "63: @SeeAlso(classNames = {\"org.apache.nifi.jms.processors.ConsumeJMS\", \"org.apache.nifi.jms.processors.PublishJMS\"})",
      "64: public class JMSConnectionFactoryProvider extends AbstractControllerService implements JMSConnectionFactoryProviderDefinition, VerifiableControllerService {",
      "65:     private static final String ESTABLISH_CONNECTION = \"Establish Connection\";",
      "66:     private static final String VERIFY_JMS_INTERACTION = \"Verify JMS Interaction\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "67: @Restricted(",
      "68:         restrictions = {",
      "69:                 @Restriction(",
      "70:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "71:                         explanation = \"Client Library Location can reference resources over HTTP\"",
      "72:                 )",
      "73:         }",
      "74: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java": [
      "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "20: import org.apache.nifi.annotation.behavior.InputRequirement;",
      "21: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
      "22: import org.apache.nifi.annotation.behavior.WritesAttribute;",
      "23: import org.apache.nifi.annotation.behavior.WritesAttributes;",
      "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "22: import org.apache.nifi.annotation.behavior.Restricted;",
      "23: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "27: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
      "28: import org.apache.nifi.components.AllowableValue;",
      "29: import org.apache.nifi.components.PropertyDescriptor;",
      "30: import org.apache.nifi.components.ValidationContext;",
      "31: import org.apache.nifi.components.ValidationResult;",
      "32: import org.apache.nifi.expression.ExpressionLanguageScope;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "94:                 \"properties of the processor. For more information, see the Additional Details page.\",",
      "95:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
      "96: @SeeAlso(value = { PublishJMS.class, JMSConnectionFactoryProvider.class })",
      "97: public class ConsumeJMS extends AbstractJMSProcessor<JMSConsumer> {",
      "99:     public static final String JMS_MESSAGETYPE = \"jms.messagetype\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "100: @Restricted(",
      "101:         restrictions = {",
      "102:                 @Restriction(",
      "103:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "104:                         explanation = \"Client Library Location can reference resources over HTTP\"",
      "105:                 )",
      "106:         }",
      "107: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java": [
      "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "22: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
      "23: import org.apache.nifi.annotation.behavior.ReadsAttribute;",
      "24: import org.apache.nifi.annotation.behavior.ReadsAttributes;",
      "25: import org.apache.nifi.annotation.behavior.SystemResource;",
      "26: import org.apache.nifi.annotation.behavior.SystemResourceConsideration;",
      "27: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "28: import org.apache.nifi.annotation.documentation.SeeAlso;",
      "29: import org.apache.nifi.annotation.documentation.Tags;",
      "30: import org.apache.nifi.components.PropertyDescriptor;",
      "31: import org.apache.nifi.expression.ExpressionLanguageScope;",
      "32: import org.apache.nifi.flowfile.FlowFile;",
      "33: import org.apache.nifi.jms.cf.JMSConnectionFactoryProvider;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "25: import org.apache.nifi.annotation.behavior.Restricted;",
      "26: import org.apache.nifi.annotation.behavior.Restriction;",
      "33: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "102:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
      "103: @SeeAlso(value = { ConsumeJMS.class, JMSConnectionFactoryProvider.class })",
      "104: @SystemResourceConsideration(resource = SystemResource.MEMORY)",
      "105: public class PublishJMS extends AbstractJMSProcessor<JMSPublisher> {",
      "107:     static final PropertyDescriptor MESSAGE_BODY = new PropertyDescriptor.Builder()",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108: @Restricted(",
      "109:         restrictions = {",
      "110:                 @Restriction(",
      "111:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "112:                         explanation = \"Client Library Location can reference resources over HTTP\"",
      "113:                 )",
      "114:         }",
      "115: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java": [
      "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "24: import io.krakens.grok.api.exception.GrokException;",
      "25: import org.apache.nifi.annotation.behavior.EventDriven;",
      "26: import org.apache.nifi.annotation.behavior.InputRequirement;",
      "27: import org.apache.nifi.annotation.behavior.SideEffectFree;",
      "28: import org.apache.nifi.annotation.behavior.SupportsBatching;",
      "29: import org.apache.nifi.annotation.behavior.WritesAttribute;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "27: import org.apache.nifi.annotation.behavior.Restricted;",
      "28: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "33: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
      "34: import org.apache.nifi.annotation.lifecycle.OnStopped;",
      "35: import org.apache.nifi.components.PropertyDescriptor;",
      "36: import org.apache.nifi.components.ValidationContext;",
      "37: import org.apache.nifi.components.ValidationResult;",
      "38: import org.apache.nifi.components.resource.ResourceCardinality;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "38: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "77:     @WritesAttribute(attribute = \"grok.XXX\", description = \"When operating in flowfile-attribute mode, each of the Grok identifier that is matched in the flowfile \" +",
      "78:         \"will be added as an attribute, prefixed with \\\"grok.\\\" For example,\" +",
      "79:         \"if the grok identifier \\\"timestamp\\\" is matched, then the value will be added to an attribute named \\\"grok.timestamp\\\"\")})",
      "80: public class ExtractGrok extends AbstractProcessor {",
      "82:     public static final String FLOWFILE_ATTRIBUTE = \"flowfile-attribute\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "83: @Restricted(",
      "84:         restrictions = {",
      "85:                 @Restriction(",
      "86:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "87:                         explanation = \"Patterns can reference resources over HTTP\"",
      "88:                 )",
      "89:         }",
      "90: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java": [
      "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "25: import com.networknt.schema.ValidationMessage;",
      "26: import org.apache.nifi.annotation.behavior.InputRequirement;",
      "27: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
      "28: import org.apache.nifi.annotation.behavior.SideEffectFree;",
      "29: import org.apache.nifi.annotation.behavior.SupportsBatching;",
      "30: import org.apache.nifi.annotation.behavior.SystemResource;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "28: import org.apache.nifi.annotation.behavior.Restricted;",
      "29: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "36: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
      "37: import org.apache.nifi.components.DescribedValue;",
      "38: import org.apache.nifi.components.PropertyDescriptor;",
      "39: import org.apache.nifi.components.resource.ResourceCardinality;",
      "40: import org.apache.nifi.components.resource.ResourceType;",
      "41: import org.apache.nifi.flowfile.FlowFile;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "41: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "64: })",
      "65: @CapabilityDescription(\"Validates the contents of FlowFiles against a configurable JSON Schema. See json-schema.org for specification standards.\")",
      "66: @SystemResourceConsideration(resource = SystemResource.MEMORY, description = \"Validating JSON requires reading FlowFile content into memory\")",
      "67: public class ValidateJson extends AbstractProcessor {",
      "68:     public enum SchemaVersion implements DescribedValue {",
      "69:         DRAFT_4(\"Draft Version 4\", \"Draft 4\", VersionFlag.V4),",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70: @Restricted(",
      "71:         restrictions = {",
      "72:                 @Restriction(",
      "73:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "74:                         explanation = \"Schema configuration can reference resources over HTTP\"",
      "75:                 )",
      "76:         }",
      "77: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java": [
      "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: import org.apache.nifi.annotation.behavior.EventDriven;",
      "20: import org.apache.nifi.annotation.behavior.InputRequirement;",
      "21: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
      "22: import org.apache.nifi.annotation.behavior.SideEffectFree;",
      "23: import org.apache.nifi.annotation.behavior.SupportsBatching;",
      "24: import org.apache.nifi.annotation.behavior.SystemResource;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "22: import org.apache.nifi.annotation.behavior.Restricted;",
      "23: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "29: import org.apache.nifi.annotation.documentation.Tags;",
      "30: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
      "31: import org.apache.nifi.components.PropertyDescriptor;",
      "32: import org.apache.nifi.components.resource.ResourceCardinality;",
      "33: import org.apache.nifi.components.resource.ResourceType;",
      "34: import org.apache.nifi.expression.ExpressionLanguageScope;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "34: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "81:         + \"to ensure the XML syntax is correct and well-formed, e.g. all opening tags are properly closed.\")",
      "82: @SystemResourceConsideration(resource = SystemResource.MEMORY, description = \"While this processor supports processing XML within attributes, it is strongly discouraged to hold \"",
      "83:         + \"large amounts of data in attributes. In general, attribute values should be as small as possible and hold no more than a couple hundred characters.\")",
      "84: public class ValidateXml extends AbstractProcessor {",
      "86:     public static final String ERROR_ATTRIBUTE_KEY = \"validatexml.invalid.error\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "87: @Restricted(",
      "88:         restrictions = {",
      "89:                 @Restriction(",
      "90:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "91:                         explanation = \"Schema configuration can reference resources over HTTP\"",
      "92:                 )",
      "93:         }",
      "94: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java": [
      "File: nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "21: import org.apache.nifi.annotation.behavior.DynamicProperties;",
      "22: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "23: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
      "24: import org.apache.nifi.annotation.behavior.SupportsSensitiveDynamicProperties;",
      "25: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "26: import org.apache.nifi.annotation.documentation.Tags;",
      "27: import org.apache.nifi.components.PropertyDescriptor;",
      "28: import org.apache.nifi.components.PropertyValue;",
      "29: import org.apache.nifi.components.ValidationContext;",
      "30: import org.apache.nifi.components.ValidationResult;",
      "31: import org.apache.nifi.controller.ConfigurationContext;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "24: import org.apache.nifi.annotation.behavior.Restricted;",
      "25: import org.apache.nifi.annotation.behavior.Restriction;",
      "31: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "86:                 description = \"JDBC driver property name prefixed with 'SENSITIVE.' handled as a sensitive property.\")",
      "87: })",
      "88: @RequiresInstanceClassLoading",
      "89: public class DBCPConnectionPool extends AbstractDBCPConnectionPool implements DBCPService, VerifiableControllerService {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "92: @Restricted(",
      "93:         restrictions = {",
      "94:                 @Restriction(",
      "95:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "96:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
      "97:                 )",
      "98:         }",
      "99: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java": [
      "File: nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "20: import org.apache.commons.lang3.StringUtils;",
      "21: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "22: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
      "23: import org.apache.nifi.annotation.behavior.SupportsSensitiveDynamicProperties;",
      "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "25: import org.apache.nifi.annotation.documentation.Tags;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "23: import org.apache.nifi.annotation.behavior.Restricted;",
      "24: import org.apache.nifi.annotation.behavior.Restriction;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "27: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
      "28: import org.apache.nifi.components.PropertyDescriptor;",
      "29: import org.apache.nifi.components.PropertyValue;",
      "30: import org.apache.nifi.components.resource.ResourceCardinality;",
      "31: import org.apache.nifi.components.resource.ResourceType;",
      "32: import org.apache.nifi.controller.AbstractControllerService;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "60:         description = \"Specifies a property name and value to be set on the JDBC connection(s). \"",
      "61:                 + \"If Expression Language is used, evaluation will be performed upon the controller service being enabled. \"",
      "62:                 + \"Note that no flow file input (attributes, e.g.) is available for use in Expression Language constructs for these properties.\")",
      "63: public class HikariCPConnectionPool extends AbstractControllerService implements DBCPService {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "66: @Restricted(",
      "67:         restrictions = {",
      "68:                 @Restriction(",
      "69:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "70:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
      "71:                 )",
      "72:         }",
      "73: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java": [
      "File: nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "23: import org.apache.hadoop.security.UserGroupInformation;",
      "24: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "25: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
      "26: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "27: import org.apache.nifi.annotation.documentation.Tags;",
      "28: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
      "29: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
      "30: import org.apache.nifi.components.PropertyDescriptor;",
      "31: import org.apache.nifi.components.PropertyValue;",
      "32: import org.apache.nifi.components.ValidationContext;",
      "33: import org.apache.nifi.components.ValidationResult;",
      "34: import org.apache.nifi.components.resource.ResourceCardinality;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "26: import org.apache.nifi.annotation.behavior.Restricted;",
      "27: import org.apache.nifi.annotation.behavior.Restriction;",
      "34: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "76: @DynamicProperty(name = \"The name of a Hadoop configuration property.\", value = \"The value of the given Hadoop configuration property.\",",
      "77:         description = \"These properties will be set on the Hadoop configuration after loading any provided configuration files.\",",
      "78:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
      "79: public class HadoopDBCPConnectionPool extends AbstractControllerService implements DBCPService {",
      "81:     private static final String ALLOW_EXPLICIT_KEYTAB = \"NIFI_ALLOW_EXPLICIT_KEYTAB\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "82: @Restricted(",
      "83:         restrictions = {",
      "84:                 @Restriction(",
      "85:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "86:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
      "87:                 )",
      "88:         }",
      "89: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java": [
      "File: nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java -> nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "42: import org.apache.hadoop.security.UserGroupInformation;",
      "43: import org.apache.nifi.annotation.behavior.DynamicProperty;",
      "44: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
      "45: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "46: import org.apache.nifi.annotation.documentation.Tags;",
      "47: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
      "48: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
      "49: import org.apache.nifi.components.PropertyDescriptor;",
      "50: import org.apache.nifi.components.ValidationContext;",
      "51: import org.apache.nifi.components.ValidationResult;",
      "52: import org.apache.nifi.components.resource.ResourceCardinality;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "45: import org.apache.nifi.annotation.behavior.Restricted;",
      "46: import org.apache.nifi.annotation.behavior.Restriction;",
      "52: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "93:         \"configuration.\")",
      "94: @DynamicProperty(name=\"The name of an HBase configuration property.\", value=\"The value of the given HBase configuration property.\",",
      "95:         description=\"These properties will be set on the HBase configuration after loading any provided configuration files.\")",
      "96: public class HBase_2_ClientService extends AbstractControllerService implements HBaseClientService {",
      "97:     private static final String ALLOW_EXPLICIT_KEYTAB = \"NIFI_ALLOW_EXPLICIT_KEYTAB\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "99: @Restricted(",
      "100:         restrictions = {",
      "101:                 @Restriction(",
      "102:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "103:                         explanation = \"Client JAR Location can reference resources over HTTP\"",
      "104:                 )",
      "105:         }",
      "106: )",
      "",
      "---------------"
    ],
    "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java": [
      "File: nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java -> nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "21: import io.krakens.grok.api.GrokCompiler;",
      "22: import io.krakens.grok.api.GrokUtils;",
      "23: import io.krakens.grok.api.exception.GrokException;",
      "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
      "25: import org.apache.nifi.annotation.documentation.Tags;",
      "26: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
      "27: import org.apache.nifi.components.AllowableValue;",
      "28: import org.apache.nifi.components.PropertyDescriptor;",
      "29: import org.apache.nifi.components.ValidationContext;",
      "30: import org.apache.nifi.components.ValidationResult;",
      "31: import org.apache.nifi.components.resource.ResourceCardinality;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "24: import org.apache.nifi.annotation.behavior.Restricted;",
      "25: import org.apache.nifi.annotation.behavior.Restriction;",
      "31: import org.apache.nifi.components.RequiredPermission;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "73:     + \"a log message is considered to be part of the previous message but is added to the 'stackTrace' field of the Record. If a record has \"",
      "74:     + \"no stack trace, it will have a NULL value for the stackTrace field (assuming that the schema does in fact include a stackTrace field of type String). \"",
      "75:     + \"Assuming that the schema includes a '_raw' field of type String, the raw message will be included in the Record.\")",
      "76: public class GrokReader extends SchemaRegistryService implements RecordReaderFactory {",
      "77:     private volatile List<Grok> groks;",
      "78:     private volatile NoMatchStrategy noMatchStrategy;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "79: @Restricted(",
      "80:         restrictions = {",
      "81:                 @Restriction(",
      "82:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
      "83:                         explanation = \"Patterns and Expressions can reference resources over HTTP\"",
      "84:                 )",
      "85:         }",
      "86: )",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "bdd7ef3671cfccf75e1fa1aaff867d2e35c68c85",
      "candidate_info": {
        "commit_hash": "bdd7ef3671cfccf75e1fa1aaff867d2e35c68c85",
        "repo": "apache/nifi",
        "commit_url": "https://github.com/apache/nifi/commit/bdd7ef3671cfccf75e1fa1aaff867d2e35c68c85",
        "files": [
          "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
          "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
        ],
        "message": "NIFI-11744 Added Required Permission to Reference Remote Resources\n\n- Applied Required Permission to components supporting URL Resource References\n\nSigned-off-by: Matt Burgess <mattyb149@apache.org>\n\nThis closes #7426",
        "before_after_code_files": [
          "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
          "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
          "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
          "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
          "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
            "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
          ],
          "candidate": [
            "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
            "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
            "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
            "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
            "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java"
          ]
        }
      },
      "candidate_diff": {
        "nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java||nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java": [
          "File: nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java -> nifi-api/src/main/java/org/apache/nifi/components/RequiredPermission.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:     ACCESS_KEYTAB(\"access-keytab\", \"access keytab\"),",
          "31:     ACCESS_TICKET_CACHE(\"access-ticket-cache\", \"access ticket cache\"),",
          "32:     ACCESS_ENVIRONMENT_CREDENTIALS(\"access-environment-credentials\", \"access environment credentials\"),",
          "35:     private String permissionIdentifier;",
          "36:     private String permissionLabel;",
          "",
          "[Removed Lines]",
          "33:     EXPORT_NIFI_DETAILS(\"export-nifi-details\", \"export nifi details\");",
          "",
          "[Added Lines]",
          "33:     EXPORT_NIFI_DETAILS(\"export-nifi-details\", \"export nifi details\"),",
          "34:     REFERENCE_REMOTE_RESOURCES(\"reference-remote-resources\", \"reference remote resources\");",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java||nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java": [
          "File: nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java -> nifi-nar-bundles/nifi-cdc/nifi-cdc-mysql-bundle/nifi-cdc-mysql-processors/src/main/java/org/apache/nifi/cdc/mysql/processors/CaptureChangeMySQL.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: import org.apache.nifi.annotation.behavior.InputRequirement;",
          "32: import org.apache.nifi.annotation.behavior.PrimaryNodeOnly;",
          "33: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
          "34: import org.apache.nifi.annotation.behavior.Stateful;",
          "35: import org.apache.nifi.annotation.behavior.TriggerSerially;",
          "36: import org.apache.nifi.annotation.behavior.WritesAttribute;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34: import org.apache.nifi.annotation.behavior.Restricted;",
          "35: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "65: import org.apache.nifi.components.AllowableValue;",
          "66: import org.apache.nifi.components.PropertyDescriptor;",
          "67: import org.apache.nifi.components.PropertyValue;",
          "68: import org.apache.nifi.components.ValidationContext;",
          "69: import org.apache.nifi.components.ValidationResult;",
          "70: import org.apache.nifi.components.resource.ResourceCardinality;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "151:                 + \"application/json\")",
          "152: })",
          "153: @RequiresInstanceClassLoading",
          "154: public class CaptureChangeMySQL extends AbstractSessionFactoryProcessor {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "157: @Restricted(",
          "158:         restrictions = {",
          "159:                 @Restriction(",
          "160:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "161:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
          "162:                 )",
          "163:         }",
          "164: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java": [
          "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/cf/JMSConnectionFactoryProvider.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: package org.apache.nifi.jms.cf;",
          "19: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "20: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "21: import org.apache.nifi.annotation.documentation.SeeAlso;",
          "22: import org.apache.nifi.annotation.documentation.Tags;",
          "23: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
          "24: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
          "25: import org.apache.nifi.components.PropertyDescriptor;",
          "26: import org.apache.nifi.controller.AbstractControllerService;",
          "27: import org.apache.nifi.controller.ConfigurationContext;",
          "28: import org.apache.nifi.expression.ExpressionLanguageScope;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20: import org.apache.nifi.annotation.behavior.Restricted;",
          "21: import org.apache.nifi.annotation.behavior.Restriction;",
          "28: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61:                 + \"property and 'com.ibm.mq.jms.MQConnectionFactory.setTransportType(int)' would imply 'transportType' property.\",",
          "62:                 expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
          "63: @SeeAlso(classNames = {\"org.apache.nifi.jms.processors.ConsumeJMS\", \"org.apache.nifi.jms.processors.PublishJMS\"})",
          "64: public class JMSConnectionFactoryProvider extends AbstractControllerService implements JMSConnectionFactoryProviderDefinition, VerifiableControllerService {",
          "65:     private static final String ESTABLISH_CONNECTION = \"Establish Connection\";",
          "66:     private static final String VERIFY_JMS_INTERACTION = \"Verify JMS Interaction\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "67: @Restricted(",
          "68:         restrictions = {",
          "69:                 @Restriction(",
          "70:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "71:                         explanation = \"Client Library Location can reference resources over HTTP\"",
          "72:                 )",
          "73:         }",
          "74: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java": [
          "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/ConsumeJMS.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "20: import org.apache.nifi.annotation.behavior.InputRequirement;",
          "21: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
          "22: import org.apache.nifi.annotation.behavior.WritesAttribute;",
          "23: import org.apache.nifi.annotation.behavior.WritesAttributes;",
          "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: import org.apache.nifi.annotation.behavior.Restricted;",
          "23: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "27: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
          "28: import org.apache.nifi.components.AllowableValue;",
          "29: import org.apache.nifi.components.PropertyDescriptor;",
          "30: import org.apache.nifi.components.ValidationContext;",
          "31: import org.apache.nifi.components.ValidationResult;",
          "32: import org.apache.nifi.expression.ExpressionLanguageScope;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "94:                 \"properties of the processor. For more information, see the Additional Details page.\",",
          "95:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
          "96: @SeeAlso(value = { PublishJMS.class, JMSConnectionFactoryProvider.class })",
          "97: public class ConsumeJMS extends AbstractJMSProcessor<JMSConsumer> {",
          "99:     public static final String JMS_MESSAGETYPE = \"jms.messagetype\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "100: @Restricted(",
          "101:         restrictions = {",
          "102:                 @Restriction(",
          "103:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "104:                         explanation = \"Client Library Location can reference resources over HTTP\"",
          "105:                 )",
          "106:         }",
          "107: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java||nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java": [
          "File: nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java -> nifi-nar-bundles/nifi-jms-bundle/nifi-jms-processors/src/main/java/org/apache/nifi/jms/processors/PublishJMS.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "22: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
          "23: import org.apache.nifi.annotation.behavior.ReadsAttribute;",
          "24: import org.apache.nifi.annotation.behavior.ReadsAttributes;",
          "25: import org.apache.nifi.annotation.behavior.SystemResource;",
          "26: import org.apache.nifi.annotation.behavior.SystemResourceConsideration;",
          "27: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "28: import org.apache.nifi.annotation.documentation.SeeAlso;",
          "29: import org.apache.nifi.annotation.documentation.Tags;",
          "30: import org.apache.nifi.components.PropertyDescriptor;",
          "31: import org.apache.nifi.expression.ExpressionLanguageScope;",
          "32: import org.apache.nifi.flowfile.FlowFile;",
          "33: import org.apache.nifi.jms.cf.JMSConnectionFactoryProvider;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "25: import org.apache.nifi.annotation.behavior.Restricted;",
          "26: import org.apache.nifi.annotation.behavior.Restriction;",
          "33: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "102:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
          "103: @SeeAlso(value = { ConsumeJMS.class, JMSConnectionFactoryProvider.class })",
          "104: @SystemResourceConsideration(resource = SystemResource.MEMORY)",
          "105: public class PublishJMS extends AbstractJMSProcessor<JMSPublisher> {",
          "107:     static final PropertyDescriptor MESSAGE_BODY = new PropertyDescriptor.Builder()",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108: @Restricted(",
          "109:         restrictions = {",
          "110:                 @Restriction(",
          "111:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "112:                         explanation = \"Client Library Location can reference resources over HTTP\"",
          "113:                 )",
          "114:         }",
          "115: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java": [
          "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ExtractGrok.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: import io.krakens.grok.api.exception.GrokException;",
          "25: import org.apache.nifi.annotation.behavior.EventDriven;",
          "26: import org.apache.nifi.annotation.behavior.InputRequirement;",
          "27: import org.apache.nifi.annotation.behavior.SideEffectFree;",
          "28: import org.apache.nifi.annotation.behavior.SupportsBatching;",
          "29: import org.apache.nifi.annotation.behavior.WritesAttribute;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27: import org.apache.nifi.annotation.behavior.Restricted;",
          "28: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "33: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
          "34: import org.apache.nifi.annotation.lifecycle.OnStopped;",
          "35: import org.apache.nifi.components.PropertyDescriptor;",
          "36: import org.apache.nifi.components.ValidationContext;",
          "37: import org.apache.nifi.components.ValidationResult;",
          "38: import org.apache.nifi.components.resource.ResourceCardinality;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:     @WritesAttribute(attribute = \"grok.XXX\", description = \"When operating in flowfile-attribute mode, each of the Grok identifier that is matched in the flowfile \" +",
          "78:         \"will be added as an attribute, prefixed with \\\"grok.\\\" For example,\" +",
          "79:         \"if the grok identifier \\\"timestamp\\\" is matched, then the value will be added to an attribute named \\\"grok.timestamp\\\"\")})",
          "80: public class ExtractGrok extends AbstractProcessor {",
          "82:     public static final String FLOWFILE_ATTRIBUTE = \"flowfile-attribute\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "83: @Restricted(",
          "84:         restrictions = {",
          "85:                 @Restriction(",
          "86:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "87:                         explanation = \"Patterns can reference resources over HTTP\"",
          "88:                 )",
          "89:         }",
          "90: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java": [
          "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateJson.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: import com.networknt.schema.ValidationMessage;",
          "26: import org.apache.nifi.annotation.behavior.InputRequirement;",
          "27: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
          "28: import org.apache.nifi.annotation.behavior.SideEffectFree;",
          "29: import org.apache.nifi.annotation.behavior.SupportsBatching;",
          "30: import org.apache.nifi.annotation.behavior.SystemResource;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "28: import org.apache.nifi.annotation.behavior.Restricted;",
          "29: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "36: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
          "37: import org.apache.nifi.components.DescribedValue;",
          "38: import org.apache.nifi.components.PropertyDescriptor;",
          "39: import org.apache.nifi.components.resource.ResourceCardinality;",
          "40: import org.apache.nifi.components.resource.ResourceType;",
          "41: import org.apache.nifi.flowfile.FlowFile;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "41: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "64: })",
          "65: @CapabilityDescription(\"Validates the contents of FlowFiles against a configurable JSON Schema. See json-schema.org for specification standards.\")",
          "66: @SystemResourceConsideration(resource = SystemResource.MEMORY, description = \"Validating JSON requires reading FlowFile content into memory\")",
          "67: public class ValidateJson extends AbstractProcessor {",
          "68:     public enum SchemaVersion implements DescribedValue {",
          "69:         DRAFT_4(\"Draft Version 4\", \"Draft 4\", VersionFlag.V4),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: @Restricted(",
          "71:         restrictions = {",
          "72:                 @Restriction(",
          "73:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "74:                         explanation = \"Schema configuration can reference resources over HTTP\"",
          "75:                 )",
          "76:         }",
          "77: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java||nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java": [
          "File: nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java -> nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/ValidateXml.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: import org.apache.nifi.annotation.behavior.EventDriven;",
          "20: import org.apache.nifi.annotation.behavior.InputRequirement;",
          "21: import org.apache.nifi.annotation.behavior.InputRequirement.Requirement;",
          "22: import org.apache.nifi.annotation.behavior.SideEffectFree;",
          "23: import org.apache.nifi.annotation.behavior.SupportsBatching;",
          "24: import org.apache.nifi.annotation.behavior.SystemResource;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: import org.apache.nifi.annotation.behavior.Restricted;",
          "23: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29: import org.apache.nifi.annotation.documentation.Tags;",
          "30: import org.apache.nifi.annotation.lifecycle.OnScheduled;",
          "31: import org.apache.nifi.components.PropertyDescriptor;",
          "32: import org.apache.nifi.components.resource.ResourceCardinality;",
          "33: import org.apache.nifi.components.resource.ResourceType;",
          "34: import org.apache.nifi.expression.ExpressionLanguageScope;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "81:         + \"to ensure the XML syntax is correct and well-formed, e.g. all opening tags are properly closed.\")",
          "82: @SystemResourceConsideration(resource = SystemResource.MEMORY, description = \"While this processor supports processing XML within attributes, it is strongly discouraged to hold \"",
          "83:         + \"large amounts of data in attributes. In general, attribute values should be as small as possible and hold no more than a couple hundred characters.\")",
          "84: public class ValidateXml extends AbstractProcessor {",
          "86:     public static final String ERROR_ATTRIBUTE_KEY = \"validatexml.invalid.error\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "87: @Restricted(",
          "88:         restrictions = {",
          "89:                 @Restriction(",
          "90:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "91:                         explanation = \"Schema configuration can reference resources over HTTP\"",
          "92:                 )",
          "93:         }",
          "94: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java": [
          "File: nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-dbcp-service/src/main/java/org/apache/nifi/dbcp/DBCPConnectionPool.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: import org.apache.nifi.annotation.behavior.DynamicProperties;",
          "22: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "23: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
          "24: import org.apache.nifi.annotation.behavior.SupportsSensitiveDynamicProperties;",
          "25: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "26: import org.apache.nifi.annotation.documentation.Tags;",
          "27: import org.apache.nifi.components.PropertyDescriptor;",
          "28: import org.apache.nifi.components.PropertyValue;",
          "29: import org.apache.nifi.components.ValidationContext;",
          "30: import org.apache.nifi.components.ValidationResult;",
          "31: import org.apache.nifi.controller.ConfigurationContext;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "24: import org.apache.nifi.annotation.behavior.Restricted;",
          "25: import org.apache.nifi.annotation.behavior.Restriction;",
          "31: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "86:                 description = \"JDBC driver property name prefixed with 'SENSITIVE.' handled as a sensitive property.\")",
          "87: })",
          "88: @RequiresInstanceClassLoading",
          "89: public class DBCPConnectionPool extends AbstractDBCPConnectionPool implements DBCPService, VerifiableControllerService {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92: @Restricted(",
          "93:         restrictions = {",
          "94:                 @Restriction(",
          "95:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "96:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
          "97:                 )",
          "98:         }",
          "99: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java": [
          "File: nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-dbcp-service-bundle/nifi-hikari-dbcp-service/src/main/java/org/apache/nifi/dbcp/HikariCPConnectionPool.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: import org.apache.commons.lang3.StringUtils;",
          "21: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "22: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
          "23: import org.apache.nifi.annotation.behavior.SupportsSensitiveDynamicProperties;",
          "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "25: import org.apache.nifi.annotation.documentation.Tags;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "23: import org.apache.nifi.annotation.behavior.Restricted;",
          "24: import org.apache.nifi.annotation.behavior.Restriction;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "27: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
          "28: import org.apache.nifi.components.PropertyDescriptor;",
          "29: import org.apache.nifi.components.PropertyValue;",
          "30: import org.apache.nifi.components.resource.ResourceCardinality;",
          "31: import org.apache.nifi.components.resource.ResourceType;",
          "32: import org.apache.nifi.controller.AbstractControllerService;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "60:         description = \"Specifies a property name and value to be set on the JDBC connection(s). \"",
          "61:                 + \"If Expression Language is used, evaluation will be performed upon the controller service being enabled. \"",
          "62:                 + \"Note that no flow file input (attributes, e.g.) is available for use in Expression Language constructs for these properties.\")",
          "63: public class HikariCPConnectionPool extends AbstractControllerService implements DBCPService {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "66: @Restricted(",
          "67:         restrictions = {",
          "68:                 @Restriction(",
          "69:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "70:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
          "71:                 )",
          "72:         }",
          "73: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java||nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java": [
          "File: nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java -> nifi-nar-bundles/nifi-standard-services/nifi-hadoop-dbcp-service-bundle/nifi-hadoop-dbcp-service/src/main/java/org/apache/nifi/dbcp/HadoopDBCPConnectionPool.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: import org.apache.hadoop.security.UserGroupInformation;",
          "24: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "25: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
          "26: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "27: import org.apache.nifi.annotation.documentation.Tags;",
          "28: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
          "29: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
          "30: import org.apache.nifi.components.PropertyDescriptor;",
          "31: import org.apache.nifi.components.PropertyValue;",
          "32: import org.apache.nifi.components.ValidationContext;",
          "33: import org.apache.nifi.components.ValidationResult;",
          "34: import org.apache.nifi.components.resource.ResourceCardinality;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "26: import org.apache.nifi.annotation.behavior.Restricted;",
          "27: import org.apache.nifi.annotation.behavior.Restriction;",
          "34: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76: @DynamicProperty(name = \"The name of a Hadoop configuration property.\", value = \"The value of the given Hadoop configuration property.\",",
          "77:         description = \"These properties will be set on the Hadoop configuration after loading any provided configuration files.\",",
          "78:         expressionLanguageScope = ExpressionLanguageScope.VARIABLE_REGISTRY)",
          "79: public class HadoopDBCPConnectionPool extends AbstractControllerService implements DBCPService {",
          "81:     private static final String ALLOW_EXPLICIT_KEYTAB = \"NIFI_ALLOW_EXPLICIT_KEYTAB\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "82: @Restricted(",
          "83:         restrictions = {",
          "84:                 @Restriction(",
          "85:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "86:                         explanation = \"Database Driver Location can reference resources over HTTP\"",
          "87:                 )",
          "88:         }",
          "89: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java||nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java": [
          "File: nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java -> nifi-nar-bundles/nifi-standard-services/nifi-hbase_2-client-service-bundle/nifi-hbase_2-client-service/src/main/java/org/apache/nifi/hbase/HBase_2_ClientService.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: import org.apache.hadoop.security.UserGroupInformation;",
          "43: import org.apache.nifi.annotation.behavior.DynamicProperty;",
          "44: import org.apache.nifi.annotation.behavior.RequiresInstanceClassLoading;",
          "45: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "46: import org.apache.nifi.annotation.documentation.Tags;",
          "47: import org.apache.nifi.annotation.lifecycle.OnDisabled;",
          "48: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
          "49: import org.apache.nifi.components.PropertyDescriptor;",
          "50: import org.apache.nifi.components.ValidationContext;",
          "51: import org.apache.nifi.components.ValidationResult;",
          "52: import org.apache.nifi.components.resource.ResourceCardinality;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "45: import org.apache.nifi.annotation.behavior.Restricted;",
          "46: import org.apache.nifi.annotation.behavior.Restriction;",
          "52: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "93:         \"configuration.\")",
          "94: @DynamicProperty(name=\"The name of an HBase configuration property.\", value=\"The value of the given HBase configuration property.\",",
          "95:         description=\"These properties will be set on the HBase configuration after loading any provided configuration files.\")",
          "96: public class HBase_2_ClientService extends AbstractControllerService implements HBaseClientService {",
          "97:     private static final String ALLOW_EXPLICIT_KEYTAB = \"NIFI_ALLOW_EXPLICIT_KEYTAB\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "99: @Restricted(",
          "100:         restrictions = {",
          "101:                 @Restriction(",
          "102:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "103:                         explanation = \"Client JAR Location can reference resources over HTTP\"",
          "104:                 )",
          "105:         }",
          "106: )",
          "",
          "---------------"
        ],
        "nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java||nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java": [
          "File: nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java -> nifi-nar-bundles/nifi-standard-services/nifi-record-serialization-services-bundle/nifi-record-serialization-services/src/main/java/org/apache/nifi/grok/GrokReader.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: import io.krakens.grok.api.GrokCompiler;",
          "22: import io.krakens.grok.api.GrokUtils;",
          "23: import io.krakens.grok.api.exception.GrokException;",
          "24: import org.apache.nifi.annotation.documentation.CapabilityDescription;",
          "25: import org.apache.nifi.annotation.documentation.Tags;",
          "26: import org.apache.nifi.annotation.lifecycle.OnEnabled;",
          "27: import org.apache.nifi.components.AllowableValue;",
          "28: import org.apache.nifi.components.PropertyDescriptor;",
          "29: import org.apache.nifi.components.ValidationContext;",
          "30: import org.apache.nifi.components.ValidationResult;",
          "31: import org.apache.nifi.components.resource.ResourceCardinality;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "24: import org.apache.nifi.annotation.behavior.Restricted;",
          "25: import org.apache.nifi.annotation.behavior.Restriction;",
          "31: import org.apache.nifi.components.RequiredPermission;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "73:     + \"a log message is considered to be part of the previous message but is added to the 'stackTrace' field of the Record. If a record has \"",
          "74:     + \"no stack trace, it will have a NULL value for the stackTrace field (assuming that the schema does in fact include a stackTrace field of type String). \"",
          "75:     + \"Assuming that the schema includes a '_raw' field of type String, the raw message will be included in the Record.\")",
          "76: public class GrokReader extends SchemaRegistryService implements RecordReaderFactory {",
          "77:     private volatile List<Grok> groks;",
          "78:     private volatile NoMatchStrategy noMatchStrategy;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "79: @Restricted(",
          "80:         restrictions = {",
          "81:                 @Restriction(",
          "82:                         requiredPermission = RequiredPermission.REFERENCE_REMOTE_RESOURCES,",
          "83:                         explanation = \"Patterns and Expressions can reference resources over HTTP\"",
          "84:                 )",
          "85:         }",
          "86: )",
          "",
          "---------------"
        ]
      }
    }
  ]
}