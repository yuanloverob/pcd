{
  "cve_id": "CVE-2023-23617",
  "cve_desc": "OpenMage LTS is an e-commerce platform. Versions prior to 19.4.22 and 20.0.19 contain an infinite loop in malicious code filter in certain conditions. Versions 19.4.22 and 20.0.19 have a fix for this issue. There are no known workarounds.",
  "repo": "OpenMage/magento-lts",
  "patch_hash": "494027785bdb7db53e60c11ef03c144b61cd3172",
  "patch_info": {
    "commit_hash": "494027785bdb7db53e60c11ef03c144b61cd3172",
    "repo": "OpenMage/magento-lts",
    "commit_url": "https://github.com/OpenMage/magento-lts/commit/494027785bdb7db53e60c11ef03c144b61cd3172",
    "files": [
      "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
    ],
    "message": "Merge pull request from GHSA-3p73-mm7v-4f6m\n\nCo-authored-by: Judx <juho.holsa@gmail.com>",
    "before_after_code_files": [
      "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
    ]
  },
  "patch_diff": {
    "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php": [
      "File: app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php -> app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "63:     public function filter($value)",
      "64:     {",
      "66:         do {",
      "69:         } while ($count !== 0);",
      "72:     }",
      "",
      "[Removed Lines]",
      "65:         $result = false;",
      "67:             $subject = $result ? $result : $value;",
      "68:             $result = preg_replace($this->_expressions, '', $subject, -1, $count);",
      "71:         return $result;",
      "",
      "[Added Lines]",
      "66:             $value = preg_replace($this->_expressions, '', $value, -1, $count);",
      "69:         return $value;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a4aeb13d23e4fa213160abfdab942f6f09b82dc3",
      "candidate_info": {
        "commit_hash": "a4aeb13d23e4fa213160abfdab942f6f09b82dc3",
        "repo": "OpenMage/magento-lts",
        "commit_url": "https://github.com/OpenMage/magento-lts/commit/a4aeb13d23e4fa213160abfdab942f6f09b82dc3",
        "files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ],
        "message": "Merge pull request from GHSA-3p73-mm7v-4f6m\n\nCo-authored-by: Judx <juho.holsa@gmail.com>",
        "before_after_code_files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ],
          "candidate": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ]
        }
      },
      "candidate_diff": {
        "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php": [
          "File: app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php -> app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "63:     public function filter($value)",
          "64:     {",
          "66:         do {",
          "69:         } while ($count !== 0);",
          "72:     }",
          "",
          "[Removed Lines]",
          "65:         $result = false;",
          "67:             $subject = $result ? $result : $value;",
          "68:             $result = preg_replace($this->_expressions, '', $subject, -1, $count);",
          "71:         return $result;",
          "",
          "[Added Lines]",
          "66:             $value = preg_replace($this->_expressions, '', $value, -1, $count);",
          "69:         return $value;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b2a7bbd15b16ac47fb645c4651c53258bca5ab8a",
      "candidate_info": {
        "commit_hash": "b2a7bbd15b16ac47fb645c4651c53258bca5ab8a",
        "repo": "OpenMage/magento-lts",
        "commit_url": "https://github.com/OpenMage/magento-lts/commit/b2a7bbd15b16ac47fb645c4651c53258bca5ab8a",
        "files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ],
        "message": "Merge pull request from GHSA-3p73-mm7v-4f6m\n\nCo-authored-by: Judx <juho.holsa@gmail.com>",
        "before_after_code_files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ],
          "candidate": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ]
        }
      },
      "candidate_diff": {
        "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php": [
          "File: app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php -> app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "63:     public function filter($value)",
          "64:     {",
          "66:         do {",
          "69:         } while ($count !== 0);",
          "72:     }",
          "",
          "[Removed Lines]",
          "65:         $result = false;",
          "67:             $subject = $result ? $result : $value;",
          "68:             $result = preg_replace($this->_expressions, '', $subject, -1, $count);",
          "71:         return $result;",
          "",
          "[Added Lines]",
          "66:             $value = preg_replace($this->_expressions, '', $value, -1, $count);",
          "69:         return $value;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ed820f35134090cfb81b5ec468adc8562b26f018",
      "candidate_info": {
        "commit_hash": "ed820f35134090cfb81b5ec468adc8562b26f018",
        "repo": "OpenMage/magento-lts",
        "commit_url": "https://github.com/OpenMage/magento-lts/commit/ed820f35134090cfb81b5ec468adc8562b26f018",
        "files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ],
        "message": "Merge pull request from GHSA-3p73-mm7v-4f6m\n\nCo-authored-by: Judx <juho.holsa@gmail.com>",
        "before_after_code_files": [
          "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ],
          "candidate": [
            "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php"
          ]
        }
      },
      "candidate_diff": {
        "app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php||app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php": [
          "File: app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php -> app/code/core/Mage/Core/Model/Input/Filter/MaliciousCode.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "63:     public function filter($value)",
          "64:     {",
          "66:         do {",
          "69:         } while ($count !== 0);",
          "72:     }",
          "",
          "[Removed Lines]",
          "65:         $result = false;",
          "67:             $subject = $result ? $result : $value;",
          "68:             $result = preg_replace($this->_expressions, '', $subject, -1, $count);",
          "71:         return $result;",
          "",
          "[Added Lines]",
          "66:             $value = preg_replace($this->_expressions, '', $value, -1, $count);",
          "69:         return $value;",
          "",
          "---------------"
        ]
      }
    }
  ]
}