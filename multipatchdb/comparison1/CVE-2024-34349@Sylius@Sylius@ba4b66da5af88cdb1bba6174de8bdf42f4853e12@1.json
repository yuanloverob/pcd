{
  "cve_id": "CVE-2024-34349",
  "cve_desc": "Sylius is an open source eCommerce platform. Prior to 1.12.16 and 1.13.1, there is a possibility to execute javascript code in the Admin panel. In order to perform an XSS attack input a script into Name field in which of the resources: Taxons, Products, Product Options or Product Variants. The code will be executed while using an autocomplete field with one of the listed entities in the Admin Panel. Also for the taxons in the category tree on the product form.The issue is fixed in versions: 1.12.16, 1.13.1.",
  "repo": "Sylius/Sylius",
  "patch_hash": "ba4b66da5af88cdb1bba6174de8bdf42f4853e12",
  "patch_info": {
    "commit_hash": "ba4b66da5af88cdb1bba6174de8bdf42f4853e12",
    "repo": "Sylius/Sylius",
    "commit_url": "https://github.com/Sylius/Sylius/commit/ba4b66da5af88cdb1bba6174de8bdf42f4853e12",
    "files": [
      "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
      "features/product/managing_products/preventing_xss_attack_while_editing_product.feature",
      "features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature",
      "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
      "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php",
      "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
      "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js",
      "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js",
      "features/account/customer_account/address_book/preventing_xss_attack_during_updating_address.feature",
      "features/checkout/addressing_order/preventing_xss_attack_during_checkout.feature",
      "src/Sylius/Behat/Context/Setup/AddressContext.php",
      "src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php",
      "src/Sylius/Behat/Context/Ui/Shop/Checkout/CheckoutAddressingContext.php",
      "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php",
      "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php",
      "src/Sylius/Behat/Page/Shop/Checkout/AddressPage.php",
      "src/Sylius/Behat/Page/Shop/Checkout/AddressPageInterface.php",
      "src/Sylius/Bundle/ShopBundle/Resources/private/js/sylius-province-field.js"
    ],
    "message": "bug #76 Fix potential xss in admin panel (mpysiak)\n\nThis PR was merged into the 1.12 branch.\n\nDiscussion\n----------\n\n| Q               | A\n|-----------------|-----\n| Branch?         | 1.12\n| Bug fix?        | yes\n| New feature?    | no\n| BC breaks?      | no\n| Deprecations?   | no\n| Related tickets | n/a\n| License         | MIT\n\nFixes potential xss in admin panel (Taxons and Products)\n\nCommits\n-------\n\nd4812f9c14c7b2acc1f2f64cff363533e4c77b41 Fix potential xss in admin panel\n29d18a39935e4d6e3d59bac5ebca798bfff00fe2 Use function from UIBundle\nc11c424c1cd4918a71831152f69bc9b1915d542d Fix product-auto-complete\na17de6d1ed47155277732bcfab61fb491cac8cb6 Test adding new taxon\nd25edf3ff097dbb704ecf4dc35b766526008516a Test adding new simple product\n63c3cf7a12ff7e1471ef3af2e2141c474e42aa03 Test adding similar products\n679e79352156f19e1747ab1d735070187b3788d7 Fixes after CR",
    "before_after_code_files": [
      "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
      "features/product/managing_products/preventing_xss_attack_while_editing_product.feature||features/product/managing_products/preventing_xss_attack_while_editing_product.feature",
      "features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature||features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature",
      "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
      "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php",
      "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
      "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js",
      "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js"
    ]
  },
  "patch_diff": {
    "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature": [
      "File: features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature -> features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: @managing_products",
      "2: Feature: Preventing a potential XSS attack while adding new product",
      "3:     In order to keep my information safe",
      "4:     As an Administrator",
      "5:     I want to be protected against the potential XSS attacks",
      "7:     Background:",
      "8:         Given the store operates on a single channel in \"United States\"",
      "9:         And the store has \"<script>alert('xss')</script>\" taxonomy",
      "10:         And the store has \"No XSS\" taxonomy",
      "11:         And I am logged in as an administrator",
      "13:     @ui @javascript @no-api",
      "14:     Scenario: Preventing a potential XSS attack while adding new product",
      "15:         When I want to create a new simple product",
      "16:         Then I should be able to name it \"No XSS\" in \"English (United States)\"",
      "18:     @ui @javascript @no-api",
      "19:     Scenario: Preventing a potential XSS attack while choosing main taxon for a new product",
      "20:         When I want to create a new simple product",
      "21:         Then I should be able to choose main taxon \"No XSS\"",
      "",
      "---------------"
    ],
    "features/product/managing_products/preventing_xss_attack_while_editing_product.feature||features/product/managing_products/preventing_xss_attack_while_editing_product.feature": [
      "File: features/product/managing_products/preventing_xss_attack_while_editing_product.feature -> features/product/managing_products/preventing_xss_attack_while_editing_product.feature",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: @managing_products",
      "2: Feature: Preventing a potential XSS attack while selecting similar product",
      "3:     In order to keep my information safe",
      "4:     As an Administrator",
      "5:     I want to be protected against the potential XSS attacks",
      "7:     Background:",
      "8:         Given the store operates on a single channel in \"United States\"",
      "9:         And the store has a product association type \"Accessories\"",
      "10:         And the store has \"<script>alert('xss')</script>\" and \"LG headphones\" products",
      "11:         And I am logged in as an administrator",
      "13:     @ui @javascript @no-api",
      "14:     Scenario: Preventing a potential XSS attack while editing product",
      "15:         When I want to create a new simple product",
      "16:         Then I should be able to associate as \"Accessories\" the \"LG headphones\" product",
      "",
      "---------------"
    ],
    "features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature||features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature": [
      "File: features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature -> features/taxonomy/managing_taxons/preventing_xss_attack_while_adding_a_new_taxon.feature",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: @managing_taxons",
      "2: Feature: Preventing a potential XSS attack while adding new taxon",
      "3:     In order to keep my information safe",
      "4:     As an Administrator",
      "5:     I want to be protected against the potential XSS attacks",
      "7:     Background:",
      "8:         Given the store operates on a single channel in \"United States\"",
      "9:         And the store has \"Category\" taxonomy",
      "10:         And the store has \"<script>alert('xss')</script>\" taxonomy",
      "11:         And I am logged in as an administrator",
      "13:     @ui @javascript @no-api",
      "14:     Scenario: Preventing a potential XSS attack while adding new taxon",
      "15:         When I want to create a new taxon",
      "16:         Then I should be able to change its parent taxon to \"Category\"",
      "",
      "---------------"
    ],
    "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php": [
      "File: src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php -> src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
    ],
    "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php": [
      "File: src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php -> src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
    ],
    "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js": [
      "File: src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js -> src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "10: import 'semantic-ui-css/components/api';",
      "11: import 'semantic-ui-css/components/checkbox';",
      "12: import $ from 'jquery';",
      "14: const createRootContainer = function createRootContainer() {",
      "15:   return $('<div class=\"ui list\"></div>');",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13: import { sanitizeInput } from \"sylius/ui/sylius-sanitizer\";",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "81:           onSuccess(response) {",
      "82:             response.forEach((leafNode) => {",
      "83:               leafContainerElement.append((",
      "85:               ));",
      "86:             });",
      "87:             content.append(leafContainerElement);",
      "",
      "[Removed Lines]",
      "84:                 createLeafFunc(leafNode.name, leafNode.code, leafNode.hasChildren, multiple, leafNode.level)",
      "",
      "[Added Lines]",
      "85:                 createLeafFunc(sanitizeInput(leafNode.name), sanitizeInput(leafNode.code), leafNode.hasChildren, multiple, leafNode.level)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "169:         const rootContainer = createRootContainer();",
      "170:         response.forEach((rootNode) => {",
      "171:           rootContainer.append((",
      "173:           ));",
      "174:         });",
      "175:         tree.append(rootContainer);",
      "",
      "[Removed Lines]",
      "172:             createLeaf(rootNode.name, rootNode.code, rootNode.hasChildren, multiple, rootNode.level)",
      "",
      "[Added Lines]",
      "173:             createLeaf(sanitizeInput(rootNode.name), sanitizeInput(rootNode.code), rootNode.hasChildren, multiple, rootNode.level)",
      "",
      "---------------"
    ],
    "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js": [
      "File: src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js -> src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-auto-complete.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "10: import 'semantic-ui-css/components/dropdown';",
      "11: import $ from 'jquery';",
      "13: $.fn.extend({",
      "14:   autoComplete() {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "12: import { sanitizeInput } from \"./sylius-sanitizer\";",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "37:           },",
      "38:           onResponse(response) {",
      "39:             let results = response.map(item => ({",
      "42:             }));",
      "44:             if (!element.hasClass('multiple')) {",
      "",
      "[Removed Lines]",
      "40:               name: item[choiceName],",
      "41:               value: item[choiceValue],",
      "",
      "[Added Lines]",
      "41:               name: sanitizeInput(item[choiceName]),",
      "42:               value: sanitizeInput(item[choiceValue]),",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "72:           onSuccess(response) {",
      "73:             response.forEach((item) => {",
      "74:               menuElement.append((",
      "76:               ));",
      "77:             });",
      "",
      "[Removed Lines]",
      "75:                 $(`<div class=\"item\" data-value=\"${item[choiceValue]}\">${item[choiceName]}</div>`)",
      "",
      "[Added Lines]",
      "76:                 $(`<div class=\"item\" data-value=\"${item[choiceValue]}\">${sanitizeInput(item[choiceName])}</div>`)",
      "",
      "---------------"
    ],
    "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js": [
      "File: src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js -> src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "10: import 'semantic-ui-css/components/dropdown';",
      "11: import $ from 'jquery';",
      "13: $.fn.extend({",
      "14:   productAutoComplete() {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "12: import { sanitizeInput } from \"./sylius-sanitizer\";",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "38:           return {",
      "39:             success: true,",
      "40:             results: response._embedded.items.map(item => ({",
      "43:             })),",
      "44:           };",
      "45:         },",
      "",
      "[Removed Lines]",
      "41:               name: item.name,",
      "42:               value: item.code,",
      "",
      "[Added Lines]",
      "42:               name: sanitizeInput(item.name),",
      "43:               value: sanitizeInput(item.code),",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d25edf3ff097dbb704ecf4dc35b766526008516a",
      "candidate_info": {
        "commit_hash": "d25edf3ff097dbb704ecf4dc35b766526008516a",
        "repo": "Sylius/Sylius",
        "commit_url": "https://github.com/Sylius/Sylius/commit/d25edf3ff097dbb704ecf4dc35b766526008516a",
        "files": [
          "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
          "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
        ],
        "message": "Test adding new simple product",
        "before_after_code_files": [
          "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
          "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/Sylius/Sylius/pull/16241"
        ],
        "olp_code_files": {
          "patch": [
            "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
            "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
          ],
          "candidate": [
            "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
            "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
          ]
        }
      },
      "candidate_diff": {
        "features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature||features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature": [
          "File: features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature -> features/product/managing_products/preventing_xss_attack_while_adding_a_new_product.feature",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: @managing_products",
          "2: Feature: Preventing a potential XSS attack while adding new product",
          "3:     In order to keep my information safe",
          "4:     As an Administrator",
          "5:     I want to be protected against the potential XSS attacks",
          "7:     Background:",
          "8:         Given the store operates on a single channel in \"United States\"",
          "9:         And the store has \"<script>alert('xss')</script>\" taxonomy",
          "10:         And I am logged in as an administrator",
          "12:     @ui @javascript @no-api",
          "13:     Scenario: Preventing a potential XSS attack while adding new product",
          "14:         When I want to create a new simple product",
          "15:         Then I should be able to name it \"No XSS\" in \"English (United States)\"",
          "",
          "---------------"
        ],
        "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php": [
          "File: src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php -> src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
        ]
      }
    },
    {
      "candidate_hash": "c11c424c1cd4918a71831152f69bc9b1915d542d",
      "candidate_info": {
        "commit_hash": "c11c424c1cd4918a71831152f69bc9b1915d542d",
        "repo": "Sylius/Sylius",
        "commit_url": "https://github.com/Sylius/Sylius/commit/c11c424c1cd4918a71831152f69bc9b1915d542d",
        "files": [
          "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js"
        ],
        "message": "Fix product-auto-complete",
        "before_after_code_files": [
          "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/Sylius/Sylius/pull/16241"
        ],
        "olp_code_files": {
          "patch": [
            "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js"
          ],
          "candidate": [
            "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js"
          ]
        }
      },
      "candidate_diff": {
        "src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js||src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js": [
          "File: src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js -> src/Sylius/Bundle/UiBundle/Resources/private/js/sylius-product-auto-complete.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: import 'semantic-ui-css/components/dropdown';",
          "11: import $ from 'jquery';",
          "13: $.fn.extend({",
          "14:   productAutoComplete() {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12: import { sanitizeInput } from \"./sylius-sanitizer\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "38:           return {",
          "39:             success: true,",
          "40:             results: response._embedded.items.map(item => ({",
          "43:             })),",
          "44:           };",
          "45:         },",
          "",
          "[Removed Lines]",
          "41:               name: item.name,",
          "42:               value: item.code,",
          "",
          "[Added Lines]",
          "42:               name: sanitizeInput(item.name),",
          "43:               value: sanitizeInput(item.code),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "29d18a39935e4d6e3d59bac5ebca798bfff00fe2",
      "candidate_info": {
        "commit_hash": "29d18a39935e4d6e3d59bac5ebca798bfff00fe2",
        "repo": "Sylius/Sylius",
        "commit_url": "https://github.com/Sylius/Sylius/commit/29d18a39935e4d6e3d59bac5ebca798bfff00fe2",
        "files": [
          "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
          "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js"
        ],
        "message": "Use function from UIBundle",
        "before_after_code_files": [
          "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
          "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/Sylius/Sylius/pull/16241"
        ],
        "olp_code_files": {
          "patch": [
            "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js"
          ],
          "candidate": [
            "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js"
          ]
        }
      },
      "candidate_diff": {
        "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js": [
          "File: src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js -> src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-lazy-choice-tree.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: import 'semantic-ui-css/components/api';",
          "11: import 'semantic-ui-css/components/checkbox';",
          "12: import $ from 'jquery';",
          "15: const createRootContainer = function createRootContainer() {",
          "16:   return $('<div class=\"ui list\"></div>');",
          "",
          "[Removed Lines]",
          "13: import { sanitizeInput} from \"./sylius-sanitizer\";",
          "",
          "[Added Lines]",
          "13: import { sanitizeInput } from \"sylius/ui/sylius-sanitizer\";",
          "",
          "---------------"
        ],
        "src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js||src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js": [
          "File: src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js -> src/Sylius/Bundle/AdminBundle/Resources/private/js/sylius-sanitizer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3d66fb067253160ef40b3b300d9fc7fb0cd81fd8",
      "candidate_info": {
        "commit_hash": "3d66fb067253160ef40b3b300d9fc7fb0cd81fd8",
        "repo": "Sylius/Sylius",
        "commit_url": "https://github.com/Sylius/Sylius/commit/3d66fb067253160ef40b3b300d9fc7fb0cd81fd8",
        "files": [
          "features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature",
          "src/Sylius/Behat/Context/Setup/AddressContext.php",
          "src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php",
          "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php",
          "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php"
        ],
        "message": "[AddressBook] Add scenario for preventing from a potential XSS attack",
        "before_after_code_files": [
          "features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature||features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature",
          "src/Sylius/Behat/Context/Setup/AddressContext.php||src/Sylius/Behat/Context/Setup/AddressContext.php",
          "src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php||src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php",
          "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php||src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php",
          "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php||src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/Sylius/Sylius/pull/16241"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature||features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature": [
          "File: features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature -> features/account/customer_account/address_book/preventing_from_xss_attack_during_updating_address.feature",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: @address_book",
          "2: Feature: Preventing from a potential XSS attack during updating the address",
          "3:     In order to keep my information safe",
          "4:     As a Customer",
          "5:     I want to be protected against the potential XSS attacks",
          "7:     Background:",
          "8:         Given the store operates on a single channel in \"United States\"",
          "9:         And I am a logged in customer",
          "10:         And I have an address \"Lucifer Morningstar\", \"Seaside Fwy\", \"90802\", \"Los Angeles\", \"United States\", \"Arkansas\" in my address book",
          "11:         And this address has province '<img \"\"\"><script>alert(\"XSS\")</script>\">'",
          "13:     @ui @javascript @no-api",
          "14:     Scenario: Preventing from a potential XSS attack during updating the address",
          "15:         When I want to edit the address of \"Lucifer Morningstar\"",
          "16:         Then I should be able to update it without unexpected alert",
          "",
          "---------------"
        ],
        "src/Sylius/Behat/Context/Setup/AddressContext.php||src/Sylius/Behat/Context/Setup/AddressContext.php": [
          "File: src/Sylius/Behat/Context/Setup/AddressContext.php -> src/Sylius/Behat/Context/Setup/AddressContext.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "66:         $customer = $user->getCustomer();",
          "68:         $this->addAddressToCustomer($customer, $address);",
          "69:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70:         $this->sharedStorage->set('address', $address);",
          "71:     }",
          "76:     public function thisAddressHasProvince(string $provinceName): void",
          "77:     {",
          "78:         $address = $this->sharedStorage->get('address');",
          "79:         $address->setProvinceName($provinceName);",
          "81:         $this->customerManager->flush();",
          "",
          "---------------"
        ],
        "src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php||src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php": [
          "File: src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php -> src/Sylius/Behat/Context/Ui/Shop/AddressBookContext.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:     {",
          "47:         $this->sharedStorage->set('full_name', $fullName);",
          "",
          "[Removed Lines]",
          "45:     public function iEditAddressOf($fullName)",
          "",
          "[Added Lines]",
          "46:     public function iEditAddressOf(string $fullName): void",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "350:         Assert::same($actualFullName, $expectedFullName);",
          "351:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "357:     public function iShouldBeAbleToUpdateItWithoutUnexpectedAlert(): void",
          "358:     {",
          "359:         $this->addressBookUpdatePage->waitForFormToStopLoading();",
          "360:     }",
          "",
          "---------------"
        ],
        "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php||src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php": [
          "File: src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php -> src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePage.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "71:         JQueryHelper::waitForFormToStopLoading($this->getDocument());",
          "72:     }",
          "74:     public function saveChanges(): void",
          "75:     {",
          "76:         JQueryHelper::waitForFormToStopLoading($this->getDocument());",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "74:     public function waitForFormToStopLoading(): void",
          "75:     {",
          "76:         JQueryHelper::waitForFormToStopLoading($this->getDocument());",
          "77:     }",
          "",
          "---------------"
        ],
        "src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php||src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php": [
          "File: src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php -> src/Sylius/Behat/Page/Shop/Account/AddressBook/UpdatePageInterface.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:     public function selectCountry(string $name): void;",
          "32:     public function saveChanges(): void;",
          "33: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:     public function waitForFormToStopLoading(): void;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "679e79352156f19e1747ab1d735070187b3788d7",
      "candidate_info": {
        "commit_hash": "679e79352156f19e1747ab1d735070187b3788d7",
        "repo": "Sylius/Sylius",
        "commit_url": "https://github.com/Sylius/Sylius/commit/679e79352156f19e1747ab1d735070187b3788d7",
        "files": [
          "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
          "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
        ],
        "message": "Fixes after CR",
        "before_after_code_files": [
          "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
          "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/Sylius/Sylius/pull/16241"
        ],
        "olp_code_files": {
          "patch": [
            "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
            "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
          ],
          "candidate": [
            "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php",
            "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php": [
          "File: src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php -> src/Sylius/Behat/Context/Ui/Admin/ManagingProductsContext.php"
        ],
        "src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php||src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php": [
          "File: src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php -> src/Sylius/Behat/Context/Ui/Admin/ManagingTaxonsContext.php"
        ]
      }
    }
  ]
}