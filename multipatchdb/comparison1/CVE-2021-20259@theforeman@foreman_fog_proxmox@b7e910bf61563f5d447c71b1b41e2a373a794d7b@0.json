{
  "cve_id": "CVE-2021-20259",
  "cve_desc": "A flaw was found in the Foreman project. The Proxmox compute resource exposes the password through the API to an authenticated local attacker with view_hosts permission. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability. Versions before foreman_fog_proxmox 0.13.1 are affected",
  "repo": "theforeman/foreman_fog_proxmox",
  "patch_hash": "b7e910bf61563f5d447c71b1b41e2a373a794d7b",
  "patch_info": {
    "commit_hash": "b7e910bf61563f5d447c71b1b41e2a373a794d7b",
    "repo": "theforeman/foreman_fog_proxmox",
    "commit_url": "https://github.com/theforeman/foreman_fog_proxmox/pull/184/commits/b7e910bf61563f5d447c71b1b41e2a373a794d7b",
    "files": [
      "app/views/api/v2/compute_resources/proxmox.json.rabl"
    ],
    "message": "Fix clean API result",
    "before_after_code_files": [
      "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl"
    ]
  },
  "patch_diff": {
    "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl": [
      "File: app/views/api/v2/compute_resources/proxmox.json.rabl -> app/views/api/v2/compute_resources/proxmox.json.rabl",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # frozen_string_literal: true",
      "",
      "[Removed Lines]",
      "3: attributes :url, :user, :password, :ssl_verify_peer, :ssl_certs, :renew",
      "",
      "[Added Lines]",
      "3: attributes :url, :user, :ssl_verify_peer, :ssl_certs, :renew",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "011e018ee97c800d6b25bb3599dd84a2dcd9adb8",
      "candidate_info": {
        "commit_hash": "011e018ee97c800d6b25bb3599dd84a2dcd9adb8",
        "repo": "theforeman/foreman_fog_proxmox",
        "commit_url": "https://github.com/theforeman/foreman_fog_proxmox/commit/011e018ee97c800d6b25bb3599dd84a2dcd9adb8",
        "files": [
          "app/views/api/v2/compute_resources/proxmox.json.rabl"
        ],
        "message": "feat: fixes #147 update api",
        "before_after_code_files": [
          "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl"
          ],
          "candidate": [
            "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl"
          ]
        }
      },
      "candidate_diff": {
        "app/views/api/v2/compute_resources/proxmox.json.rabl||app/views/api/v2/compute_resources/proxmox.json.rabl": [
          "File: app/views/api/v2/compute_resources/proxmox.json.rabl -> app/views/api/v2/compute_resources/proxmox.json.rabl",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # frozen_string_literal: true",
          "",
          "[Removed Lines]",
          "3: attributes :user, :url, :ssl_verify_peer, :disable_proxy",
          "",
          "[Added Lines]",
          "3: attributes :url, :user, :password, :ssl_verify_peer, :ssl_certs, :renew",
          "",
          "---------------"
        ]
      }
    }
  ]
}