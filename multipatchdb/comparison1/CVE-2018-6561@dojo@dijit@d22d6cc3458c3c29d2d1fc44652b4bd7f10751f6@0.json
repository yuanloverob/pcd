{
  "cve_id": "CVE-2018-6561",
  "cve_desc": "dijit.Editor in Dojo Toolkit 1.13 allows XSS via the onload attribute of an SVG element.",
  "repo": "dojo/dijit",
  "patch_hash": "d22d6cc3458c3c29d2d1fc44652b4bd7f10751f6",
  "patch_info": {
    "commit_hash": "d22d6cc3458c3c29d2d1fc44652b4bd7f10751f6",
    "repo": "dojo/dijit",
    "commit_url": "https://github.com/dojo/dijit/commit/d22d6cc3458c3c29d2d1fc44652b4bd7f10751f6",
    "files": [
      "_editor/plugins/ViewSource.js",
      "tests/editor/bug.png",
      "tests/editor/test_ViewSource.html"
    ],
    "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
    "before_after_code_files": [
      "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
      "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
    ]
  },
  "patch_diff": {
    "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
      "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "46:   stripIFrames: true,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "52:   stripEventHandlers: true,",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "477:    return html;",
      "478:   },",
      "480:   _filter: function(html){",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "486:   _stripEventHandlers: function (html) {",
      "487:    if(html){",
      "489:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
      "490:     if(matches){",
      "491:      for(var i = 0, l = matches.length; i < l; i++){",
      "493:       var match = matches[i];",
      "494:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
      "495:       html = html.replace(match, replacement);",
      "496:      }",
      "497:     }",
      "498:    }",
      "499:    return html;",
      "500:   },",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "494:     if(this.stripIFrames){",
      "495:      html = this._stripIFrames(html);",
      "496:     }",
      "497:    }",
      "498:    return html;",
      "499:   },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "519:     if(this.stripEventHandlers){",
      "520:      html = this._stripEventHandlers(html);",
      "521:     }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "543:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
      "544:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
      "545:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
      "547:   });",
      "548:  };",
      "",
      "[Removed Lines]",
      "546:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
      "",
      "[Added Lines]",
      "571:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
      "572:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
      "",
      "---------------"
    ],
    "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
      "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "105:  </div>",
      "106:  <br>",
      "107:  <br>",
      "108:  <div>Content after the editors.</div>",
      "109: </body>",
      "110: </html>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108:  <div>",
      "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
      "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
      "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
      "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
      "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
      "114:    <button",
      "115:      onclick=\"alert('Button clicked!')\"",
      "116:      id=\"button1\"",
      "117:      ondblclick=\"alert('Button double clicked!')\">",
      "118:     onclick button",
      "119:    </button>",
      "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
      "121:    <h2>Things to test:</h2>",
      "122:    <ol>",
      "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
      "124:    </ol>",
      "125:   </div>",
      "126:  </div>",
      "127:  <br>",
      "128:  <br>",
      "129:  <div>",
      "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
      "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
      "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
      "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
      "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
      "135:    <button",
      "136:      onclick=\"alert('Button clicked!')\"",
      "137:      id=\"button3\"",
      "138:      ondblclick=\"alert('Button double clicked!')\">",
      "139:     onclick button",
      "140:    </button>",
      "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
      "142:    <h2>Things to test:</h2>",
      "143:    <ol>",
      "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
      "145:    </ol>",
      "146:   </div>",
      "147:  </div>",
      "148:  <br>",
      "149:  <br>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9bed588a5439d27958ea49196ff5ac6ec95539c8",
      "candidate_info": {
        "commit_hash": "9bed588a5439d27958ea49196ff5ac6ec95539c8",
        "repo": "dojo/dijit",
        "commit_url": "https://github.com/dojo/dijit/commit/9bed588a5439d27958ea49196ff5ac6ec95539c8",
        "files": [
          "_editor/plugins/ViewSource.js",
          "tests/editor/bug.png",
          "tests/editor/test_ViewSource.html"
        ],
        "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
        "before_after_code_files": [
          "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
          "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ],
          "candidate": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ]
        }
      },
      "candidate_diff": {
        "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
          "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:   stripIFrames: true,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:   stripEventHandlers: true,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "477:    return html;",
          "478:   },",
          "480:   _filter: function(html){",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "486:   _stripEventHandlers: function (html) {",
          "487:    if(html){",
          "489:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
          "490:     if(matches){",
          "491:      for(var i = 0, l = matches.length; i < l; i++){",
          "493:       var match = matches[i];",
          "494:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
          "495:       html = html.replace(match, replacement);",
          "496:      }",
          "497:     }",
          "498:    }",
          "499:    return html;",
          "500:   },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "494:     if(this.stripIFrames){",
          "495:      html = this._stripIFrames(html);",
          "496:     }",
          "497:    }",
          "498:    return html;",
          "499:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:     if(this.stripEventHandlers){",
          "520:      html = this._stripEventHandlers(html);",
          "521:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "543:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
          "544:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
          "545:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
          "547:   });",
          "548:  };",
          "",
          "[Removed Lines]",
          "546:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
          "",
          "[Added Lines]",
          "571:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
          "572:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
          "",
          "---------------"
        ],
        "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
          "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  </div>",
          "106:  <br>",
          "107:  <br>",
          "108:  <div>Content after the editors.</div>",
          "109: </body>",
          "110: </html>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108:  <div>",
          "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
          "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
          "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
          "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "114:    <button",
          "115:      onclick=\"alert('Button clicked!')\"",
          "116:      id=\"button1\"",
          "117:      ondblclick=\"alert('Button double clicked!')\">",
          "118:     onclick button",
          "119:    </button>",
          "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
          "121:    <h2>Things to test:</h2>",
          "122:    <ol>",
          "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
          "124:    </ol>",
          "125:   </div>",
          "126:  </div>",
          "127:  <br>",
          "128:  <br>",
          "129:  <div>",
          "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
          "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
          "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
          "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "135:    <button",
          "136:      onclick=\"alert('Button clicked!')\"",
          "137:      id=\"button3\"",
          "138:      ondblclick=\"alert('Button double clicked!')\">",
          "139:     onclick button",
          "140:    </button>",
          "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
          "142:    <h2>Things to test:</h2>",
          "143:    <ol>",
          "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
          "145:    </ol>",
          "146:   </div>",
          "147:  </div>",
          "148:  <br>",
          "149:  <br>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "def7e20ec158cd760af60d4b2749d952f1d20640",
      "candidate_info": {
        "commit_hash": "def7e20ec158cd760af60d4b2749d952f1d20640",
        "repo": "dojo/dijit",
        "commit_url": "https://github.com/dojo/dijit/commit/def7e20ec158cd760af60d4b2749d952f1d20640",
        "files": [
          "_editor/plugins/ViewSource.js",
          "tests/editor/bug.png",
          "tests/editor/test_ViewSource.html"
        ],
        "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
        "before_after_code_files": [
          "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
          "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ],
          "candidate": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ]
        }
      },
      "candidate_diff": {
        "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
          "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:   stripIFrames: true,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:   stripEventHandlers: true,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "477:    return html;",
          "478:   },",
          "480:   _filter: function(html){",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "486:   _stripEventHandlers: function (html) {",
          "487:    if(html){",
          "489:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
          "490:     if(matches){",
          "491:      for(var i = 0, l = matches.length; i < l; i++){",
          "493:       var match = matches[i];",
          "494:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
          "495:       html = html.replace(match, replacement);",
          "496:      }",
          "497:     }",
          "498:    }",
          "499:    return html;",
          "500:   },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "494:     if(this.stripIFrames){",
          "495:      html = this._stripIFrames(html);",
          "496:     }",
          "497:    }",
          "498:    return html;",
          "499:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:     if(this.stripEventHandlers){",
          "520:      html = this._stripEventHandlers(html);",
          "521:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "543:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
          "544:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
          "545:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
          "547:   });",
          "548:  };",
          "",
          "[Removed Lines]",
          "546:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
          "",
          "[Added Lines]",
          "571:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
          "572:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
          "",
          "---------------"
        ],
        "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
          "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  </div>",
          "106:  <br>",
          "107:  <br>",
          "108:  <div>Content after the editors.</div>",
          "109: </body>",
          "110: </html>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108:  <div>",
          "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
          "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
          "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
          "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "114:    <button",
          "115:      onclick=\"alert('Button clicked!')\"",
          "116:      id=\"button1\"",
          "117:      ondblclick=\"alert('Button double clicked!')\">",
          "118:     onclick button",
          "119:    </button>",
          "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
          "121:    <h2>Things to test:</h2>",
          "122:    <ol>",
          "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
          "124:    </ol>",
          "125:   </div>",
          "126:  </div>",
          "127:  <br>",
          "128:  <br>",
          "129:  <div>",
          "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
          "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
          "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
          "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "135:    <button",
          "136:      onclick=\"alert('Button clicked!')\"",
          "137:      id=\"button3\"",
          "138:      ondblclick=\"alert('Button double clicked!')\">",
          "139:     onclick button",
          "140:    </button>",
          "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
          "142:    <h2>Things to test:</h2>",
          "143:    <ol>",
          "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
          "145:    </ol>",
          "146:   </div>",
          "147:  </div>",
          "148:  <br>",
          "149:  <br>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1c2ed344b63d1b7c693354fe787adf0427ed970d",
      "candidate_info": {
        "commit_hash": "1c2ed344b63d1b7c693354fe787adf0427ed970d",
        "repo": "dojo/dijit",
        "commit_url": "https://github.com/dojo/dijit/commit/1c2ed344b63d1b7c693354fe787adf0427ed970d",
        "files": [
          "_editor/plugins/ViewSource.js",
          "tests/editor/bug.png",
          "tests/editor/test_ViewSource.html"
        ],
        "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
        "before_after_code_files": [
          "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
          "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ],
          "candidate": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ]
        }
      },
      "candidate_diff": {
        "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
          "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:   stripIFrames: true,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:   stripEventHandlers: true,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "498:    return html;",
          "499:   },",
          "501:   _filter: function(html){",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "507:   _stripEventHandlers: function (html) {",
          "508:    if(html){",
          "510:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
          "511:     if(matches){",
          "512:      for(var i = 0, l = matches.length; i < l; i++){",
          "514:       var match = matches[i];",
          "515:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
          "516:       html = html.replace(match, replacement);",
          "517:      }",
          "518:     }",
          "519:    }",
          "520:    return html;",
          "521:   },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "515:     if(this.stripIFrames){",
          "516:      html = this._stripIFrames(html);",
          "517:     }",
          "518:    }",
          "519:    return html;",
          "520:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "540:     if(this.stripEventHandlers){",
          "541:      html = this._stripEventHandlers(html);",
          "542:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "570:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
          "571:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
          "572:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
          "574:   });",
          "575:  };",
          "",
          "[Removed Lines]",
          "573:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
          "",
          "[Added Lines]",
          "598:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
          "599:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
          "",
          "---------------"
        ],
        "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
          "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  </div>",
          "106:  <br>",
          "107:  <br>",
          "108:  <div>Content after the editors.</div>",
          "109: </body>",
          "110: </html>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108:  <div>",
          "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
          "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
          "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
          "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "114:    <button",
          "115:      onclick=\"alert('Button clicked!')\"",
          "116:      id=\"button1\"",
          "117:      ondblclick=\"alert('Button double clicked!')\">",
          "118:     onclick button",
          "119:    </button>",
          "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
          "121:    <h2>Things to test:</h2>",
          "122:    <ol>",
          "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
          "124:    </ol>",
          "125:   </div>",
          "126:  </div>",
          "127:  <br>",
          "128:  <br>",
          "129:  <div>",
          "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
          "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
          "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
          "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "135:    <button",
          "136:      onclick=\"alert('Button clicked!')\"",
          "137:      id=\"button3\"",
          "138:      ondblclick=\"alert('Button double clicked!')\">",
          "139:     onclick button",
          "140:    </button>",
          "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
          "142:    <h2>Things to test:</h2>",
          "143:    <ol>",
          "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
          "145:    </ol>",
          "146:   </div>",
          "147:  </div>",
          "148:  <br>",
          "149:  <br>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "427c752f0f46c7e9d54a5931d4cbcc90ecfc2769",
      "candidate_info": {
        "commit_hash": "427c752f0f46c7e9d54a5931d4cbcc90ecfc2769",
        "repo": "dojo/dijit",
        "commit_url": "https://github.com/dojo/dijit/commit/427c752f0f46c7e9d54a5931d4cbcc90ecfc2769",
        "files": [
          "_editor/plugins/ViewSource.js",
          "tests/editor/bug.png",
          "tests/editor/test_ViewSource.html"
        ],
        "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
        "before_after_code_files": [
          "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
          "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ],
          "candidate": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ]
        }
      },
      "candidate_diff": {
        "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
          "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:   stripIFrames: true,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:   stripEventHandlers: true,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "477:    return html;",
          "478:   },",
          "480:   _filter: function(html){",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "486:   _stripEventHandlers: function (html) {",
          "487:    if(html){",
          "489:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
          "490:     if(matches){",
          "491:      for(var i = 0, l = matches.length; i < l; i++){",
          "493:       var match = matches[i];",
          "494:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
          "495:       html = html.replace(match, replacement);",
          "496:      }",
          "497:     }",
          "498:    }",
          "499:    return html;",
          "500:   },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "494:     if(this.stripIFrames){",
          "495:      html = this._stripIFrames(html);",
          "496:     }",
          "497:    }",
          "498:    return html;",
          "499:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:     if(this.stripEventHandlers){",
          "520:      html = this._stripEventHandlers(html);",
          "521:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "543:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
          "544:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
          "545:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
          "547:   });",
          "548:  };",
          "",
          "[Removed Lines]",
          "546:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
          "",
          "[Added Lines]",
          "571:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
          "572:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
          "",
          "---------------"
        ],
        "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
          "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  </div>",
          "106:  <br>",
          "107:  <br>",
          "108:  <div>Content after the editors.</div>",
          "109: </body>",
          "110: </html>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108:  <div>",
          "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
          "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
          "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
          "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "114:    <button",
          "115:      onclick=\"alert('Button clicked!')\"",
          "116:      id=\"button1\"",
          "117:      ondblclick=\"alert('Button double clicked!')\">",
          "118:     onclick button",
          "119:    </button>",
          "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
          "121:    <h2>Things to test:</h2>",
          "122:    <ol>",
          "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
          "124:    </ol>",
          "125:   </div>",
          "126:  </div>",
          "127:  <br>",
          "128:  <br>",
          "129:  <div>",
          "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
          "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
          "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
          "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "135:    <button",
          "136:      onclick=\"alert('Button clicked!')\"",
          "137:      id=\"button3\"",
          "138:      ondblclick=\"alert('Button double clicked!')\">",
          "139:     onclick button",
          "140:    </button>",
          "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
          "142:    <h2>Things to test:</h2>",
          "143:    <ol>",
          "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
          "145:    </ol>",
          "146:   </div>",
          "147:  </div>",
          "148:  <br>",
          "149:  <br>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "873e64989c62a66a328838afb4112791fc0d46a8",
      "candidate_info": {
        "commit_hash": "873e64989c62a66a328838afb4112791fc0d46a8",
        "repo": "dojo/dijit",
        "commit_url": "https://github.com/dojo/dijit/commit/873e64989c62a66a328838afb4112791fc0d46a8",
        "files": [
          "_editor/plugins/ViewSource.js",
          "tests/editor/bug.png",
          "tests/editor/test_ViewSource.html"
        ],
        "message": "Update Editor to remove event handler attributes from tags in the editor's contents. (#146)",
        "before_after_code_files": [
          "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
          "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ],
          "candidate": [
            "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js",
            "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html"
          ]
        }
      },
      "candidate_diff": {
        "_editor/plugins/ViewSource.js||_editor/plugins/ViewSource.js": [
          "File: _editor/plugins/ViewSource.js -> _editor/plugins/ViewSource.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:   stripIFrames: true,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:   stripEventHandlers: true,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "498:    return html;",
          "499:   },",
          "501:   _filter: function(html){",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "507:   _stripEventHandlers: function (html) {",
          "508:    if(html){",
          "510:     var matches = html.match(/<[a-z]+?\\b(.*?on.*?(['\"]).*?\\2.*?)+>/gim);",
          "511:     if(matches){",
          "512:      for(var i = 0, l = matches.length; i < l; i++){",
          "514:       var match = matches[i];",
          "515:       var replacement = match.replace(/\\s+on[a-z]*\\s*=\\s*(['\"])(.*?)\\1/igm, \"\");",
          "516:       html = html.replace(match, replacement);",
          "517:      }",
          "518:     }",
          "519:    }",
          "520:    return html;",
          "521:   },",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "515:     if(this.stripIFrames){",
          "516:      html = this._stripIFrames(html);",
          "517:     }",
          "518:    }",
          "519:    return html;",
          "520:   },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "540:     if(this.stripEventHandlers){",
          "541:      html = this._stripEventHandlers(html);",
          "542:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "570:    readOnly: (\"readOnly\" in args) ? args.readOnly : false,",
          "571:    stripComments: (\"stripComments\" in args) ? args.stripComments : true,",
          "572:    stripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,",
          "574:   });",
          "575:  };",
          "",
          "[Removed Lines]",
          "573:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true",
          "",
          "[Added Lines]",
          "598:    stripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true,",
          "599:    stripEventHandlers: (\"stripEventHandlers\" in args) ? args.stripEventHandlers : true",
          "",
          "---------------"
        ],
        "tests/editor/test_ViewSource.html||tests/editor/test_ViewSource.html": [
          "File: tests/editor/test_ViewSource.html -> tests/editor/test_ViewSource.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  </div>",
          "106:  <br>",
          "107:  <br>",
          "108:  <div>Content after the editors.</div>",
          "109: </body>",
          "110: </html>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "108:  <div>",
          "109:   <div id=\"editor4\" data-dojo-type=\"dijit/Editor\"",
          "110:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", \"viewSource\"],",
          "111:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "112:    <h1>ViewSource Plugin with stripEventHandlers enabled</h1>",
          "113:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "114:    <button",
          "115:      onclick=\"alert('Button clicked!')\"",
          "116:      id=\"button1\"",
          "117:      ondblclick=\"alert('Button double clicked!')\">",
          "118:     onclick button",
          "119:    </button>",
          "120:    <button name=\"button\" id=\"button2\">Just a button</button>",
          "121:    <h2>Things to test:</h2>",
          "122:    <ol>",
          "123:     <li>Click the view source button and verify that all on* attributes have been removed.</li>",
          "124:    </ol>",
          "125:   </div>",
          "126:  </div>",
          "127:  <br>",
          "128:  <br>",
          "129:  <div>",
          "130:   <div id=\"editor5\" data-dojo-type=\"dijit/Editor\"",
          "131:     data-dojo-props='\"aria-label\":\"editor3\",extraPlugins:[\"fullScreen\", {name: \"viewSource\", stripEventHandlers: false}],",
          "132:    style:\"background-color: white; width: 800px;\", height:\"300px\" '>",
          "133:    <h1>ViewSource Plugin with stripEventHandlers disabled</h1>",
          "134:    <img ondrag=\"alert('Bug dragged!')\" src=\"./bug.png\" onclick=\"alert('Bug clicked!');\">",
          "135:    <button",
          "136:      onclick=\"alert('Button clicked!')\"",
          "137:      id=\"button3\"",
          "138:      ondblclick=\"alert('Button double clicked!')\">",
          "139:     onclick button",
          "140:    </button>",
          "141:    <button name=\"button\" id=\"button4\">Just a button</button>",
          "142:    <h2>Things to test:</h2>",
          "143:    <ol>",
          "144:     <li>Click the view source button and verify that all on* attributes have NOT been removed.</li>",
          "145:    </ol>",
          "146:   </div>",
          "147:  </div>",
          "148:  <br>",
          "149:  <br>",
          "",
          "---------------"
        ]
      }
    }
  ]
}