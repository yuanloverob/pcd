{
  "cve_id": "CVE-2018-14522",
  "cve_desc": "An issue was discovered in aubio 0.4.6. A SEGV signal can occur in aubio_pitch_set_unit in pitch/pitch.c, as demonstrated by aubionotes.",
  "repo": "aubio/aubio",
  "patch_hash": "99c7aa2e3efec988a5f81018b48d9388ff24bba1",
  "patch_info": {
    "commit_hash": "99c7aa2e3efec988a5f81018b48d9388ff24bba1",
    "repo": "aubio/aubio",
    "commit_url": "https://github.com/aubio/aubio/commit/99c7aa2e3efec988a5f81018b48d9388ff24bba1",
    "files": [
      "src/io/source_wavread.c"
    ],
    "message": "src/io/source_wavread.c: also exit if samplerate is negative (closes #188)",
    "before_after_code_files": [
      "src/io/source_wavread.c||src/io/source_wavread.c"
    ]
  },
  "patch_diff": {
    "src/io/source_wavread.c||src/io/source_wavread.c": [
      "File: src/io/source_wavread.c -> src/io/source_wavread.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "195:     goto beach;",
      "196:   }",
      "200:     goto beach;",
      "201:   }",
      "",
      "[Removed Lines]",
      "198:   if ( sr == 0 ) {",
      "199:     AUBIO_ERR(\"source_wavread: Failed opening %s (samplerate can not be 0)\\n\", s->path);",
      "",
      "[Added Lines]",
      "198:   if ( (sint_t)sr <= 0 ) {",
      "199:     AUBIO_ERR(\"source_wavread: Failed opening %s (samplerate can not be <= 0)\\n\", s->path);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "25ecb7338cebc5b8c79092347839c78349ec33f1",
      "candidate_info": {
        "commit_hash": "25ecb7338cebc5b8c79092347839c78349ec33f1",
        "repo": "aubio/aubio",
        "commit_url": "https://github.com/aubio/aubio/commit/25ecb7338cebc5b8c79092347839c78349ec33f1",
        "files": [
          "src/io/source_wavread.c"
        ],
        "message": "src/io/source_wavread.c: add some input validation (closes: #158)",
        "before_after_code_files": [
          "src/io/source_wavread.c||src/io/source_wavread.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/io/source_wavread.c||src/io/source_wavread.c"
          ],
          "candidate": [
            "src/io/source_wavread.c||src/io/source_wavread.c"
          ]
        }
      },
      "candidate_diff": {
        "src/io/source_wavread.c||src/io/source_wavread.c": [
          "File: src/io/source_wavread.c -> src/io/source_wavread.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "190:   bytes_read += fread(buf, 1, 2, s->fid);",
          "191:   bitspersample = read_little_endian(buf, 2);",
          "192: #if 0",
          "193:   if ( bitspersample != 16 ) {",
          "194:     AUBIO_ERR(\"source_wavread: can not process %dbit file %s\\n\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "193:   if ( channels == 0 ) {",
          "194:     AUBIO_ERR(\"source_wavread: Failed opening %s (number of channels can not be 0)\\n\", s->path);",
          "195:     goto beach;",
          "196:   }",
          "198:   if ( sr == 0 ) {",
          "199:     AUBIO_ERR(\"source_wavread: Failed opening %s (samplerate can not be 0)\\n\", s->path);",
          "200:     goto beach;",
          "201:   }",
          "203:   if ( byterate == 0 ) {",
          "204:     AUBIO_ERR(\"source_wavread: Failed opening %s (byterate can not be 0)\\n\", s->path);",
          "205:     goto beach;",
          "206:   }",
          "208:   if ( bitspersample == 0 ) {",
          "209:     AUBIO_ERR(\"source_wavread: Failed opening %s (bitspersample can not be 0)\\n\", s->path);",
          "210:     goto beach;",
          "211:   }",
          "",
          "---------------"
        ]
      }
    }
  ]
}