{
  "cve_id": "CVE-2022-29049",
  "cve_desc": "Jenkins promoted builds Plugin 873.v6149db_d64130 and earlier, except 3.10.1, does not validate the names of promotions defined in Job DSL, allowing attackers with Job/Configure permission to create a promotion with an unsafe name.",
  "repo": "jenkinsci/promoted-builds-plugin",
  "patch_hash": "d6fd95688ae2052bf9ac7158bc2579c755167fe0",
  "patch_info": {
    "commit_hash": "d6fd95688ae2052bf9ac7158bc2579c755167fe0",
    "repo": "jenkinsci/promoted-builds-plugin",
    "commit_url": "https://github.com/jenkinsci/promoted-builds-plugin/commit/d6fd95688ae2052bf9ac7158bc2579c755167fe0",
    "files": [
      "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
    ],
    "message": "SECURITY-2655",
    "before_after_code_files": [
      "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
    ]
  },
  "patch_diff": {
    "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java": [
      "File: src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java -> src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "24: import javaposse.jobdsl.plugin.ContextExtensionPoint;",
      "25: import javaposse.jobdsl.plugin.DslEnvironment;",
      "26: import javaposse.jobdsl.plugin.DslExtensionMethod;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "27: import jenkins.model.Jenkins;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "72:         Set<String> names = (Set<String>) dslEnvironment.get(\"processNames\");",
      "73:         if (names != null && names.size() > 0) {",
      "74:             for (String name : names) {",
      "75:                 JobDslPromotionProcess promotionProcess = promotionProcesses.get(name);",
      "76:                 XSTREAM.registerConverter(new JobDslPromotionProcessConverter(XSTREAM.getMapper(), XSTREAM.getReflectionProvider()));",
      "77:                 XSTREAM.registerConverter(new ManualConditionConverter(XSTREAM.getMapper(), XSTREAM.getReflectionProvider()));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "76:                 Jenkins.checkGoodName(name);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "641f505ac86bbf19f4934ac60d636e6a9739c79c",
      "candidate_info": {
        "commit_hash": "641f505ac86bbf19f4934ac60d636e6a9739c79c",
        "repo": "jenkinsci/promoted-builds-plugin",
        "commit_url": "https://github.com/jenkinsci/promoted-builds-plugin/commit/641f505ac86bbf19f4934ac60d636e6a9739c79c",
        "files": [
          "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
        ],
        "message": "SECURITY-2655",
        "before_after_code_files": [
          "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
          ],
          "candidate": [
            "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java||src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java": [
          "File: src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java -> src/main/java/hudson/plugins/promoted_builds/integrations/jobdsl/PromotionsExtensionPoint.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: import javaposse.jobdsl.plugin.ContextExtensionPoint;",
          "25: import javaposse.jobdsl.plugin.DslEnvironment;",
          "26: import javaposse.jobdsl.plugin.DslExtensionMethod;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27: import jenkins.model.Jenkins;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "72:         Set<String> names = (Set<String>) dslEnvironment.get(\"processNames\");",
          "73:         if (names != null && names.size() > 0) {",
          "74:             for (String name : names) {",
          "75:                 JobDslPromotionProcess promotionProcess = promotionProcesses.get(name);",
          "76:                 XSTREAM.registerConverter(new JobDslPromotionProcessConverter(XSTREAM.getMapper(), XSTREAM.getReflectionProvider()));",
          "77:                 XSTREAM.registerConverter(new ManualConditionConverter(XSTREAM.getMapper(), XSTREAM.getReflectionProvider()));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "76:                 Jenkins.checkGoodName(name);",
          "",
          "---------------"
        ]
      }
    }
  ]
}