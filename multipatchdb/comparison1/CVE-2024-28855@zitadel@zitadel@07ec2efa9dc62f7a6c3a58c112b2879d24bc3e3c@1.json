{
  "cve_id": "CVE-2024-28855",
  "cve_desc": "ZITADEL, open source authentication management software, uses Go templates to render the login UI. Due to a improper use of the `text/template` instead of the `html/template` package, the Login UI did not sanitize input parameters prior to versions 2.47.3, 2.46.1, 2.45.1, 2.44.3, 2.43.9, 2.42.15, and 2.41.15. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen. While it was possible to inject HTML including JavaScript, the execution of such scripts would be prevented by the Content Security Policy. Versions 2.47.3, 2.46.1, 2.45.1, 2.44.3, 2.43.9, 2.42.15, and 2.41.15 contain a patch for this issue. No known workarounds are available.",
  "repo": "zitadel/zitadel",
  "patch_hash": "07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c",
  "patch_info": {
    "commit_hash": "07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c",
    "repo": "zitadel/zitadel",
    "commit_url": "https://github.com/zitadel/zitadel/commit/07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c",
    "files": [
      "internal/renderer/renderer.go"
    ],
    "message": "fix: use correct template package (#7522)",
    "before_after_code_files": [
      "internal/renderer/renderer.go||internal/renderer/renderer.go"
    ]
  },
  "patch_diff": {
    "internal/renderer/renderer.go||internal/renderer/renderer.go": [
      "File: internal/renderer/renderer.go -> internal/renderer/renderer.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: import (",
      "4:  \"context\"",
      "5:  \"io/ioutil\"",
      "6:  \"net/http\"",
      "7:  \"os\"",
      "10:  \"github.com/zitadel/logging\"",
      "11:  \"golang.org/x/text/language\"",
      "",
      "[Removed Lines]",
      "8:  \"text/template\"",
      "",
      "[Added Lines]",
      "5:  \"html/template\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6ff695e40aa04050b060f745a28cd2ffbb371aea",
      "candidate_info": {
        "commit_hash": "6ff695e40aa04050b060f745a28cd2ffbb371aea",
        "repo": "zitadel/zitadel",
        "commit_url": "https://github.com/zitadel/zitadel/commit/6ff695e40aa04050b060f745a28cd2ffbb371aea",
        "files": [
          "internal/renderer/renderer.go"
        ],
        "message": "fix: use correct template package (#7522)\n\n(cherry picked from commit 07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c)",
        "before_after_code_files": [
          "internal/renderer/renderer.go||internal/renderer/renderer.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "internal/renderer/renderer.go||internal/renderer/renderer.go"
          ],
          "candidate": [
            "internal/renderer/renderer.go||internal/renderer/renderer.go"
          ]
        }
      },
      "candidate_diff": {
        "internal/renderer/renderer.go||internal/renderer/renderer.go": [
          "File: internal/renderer/renderer.go -> internal/renderer/renderer.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import (",
          "4:  \"context\"",
          "5:  \"io/ioutil\"",
          "6:  \"net/http\"",
          "7:  \"os\"",
          "10:  \"github.com/zitadel/logging\"",
          "11:  \"golang.org/x/text/language\"",
          "",
          "[Removed Lines]",
          "8:  \"text/template\"",
          "",
          "[Added Lines]",
          "5:  \"html/template\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3c0cd30afeac2b1e247b6d009bba2e2e108117dc",
      "candidate_info": {
        "commit_hash": "3c0cd30afeac2b1e247b6d009bba2e2e108117dc",
        "repo": "zitadel/zitadel",
        "commit_url": "https://github.com/zitadel/zitadel/commit/3c0cd30afeac2b1e247b6d009bba2e2e108117dc",
        "files": [
          "internal/renderer/renderer.go"
        ],
        "message": "fix: use correct template package (#7522)\n\n(cherry picked from commit 07ec2efa9dc62f7a6c3a58c112b2879d24bc3e3c)",
        "before_after_code_files": [
          "internal/renderer/renderer.go||internal/renderer/renderer.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "internal/renderer/renderer.go||internal/renderer/renderer.go"
          ],
          "candidate": [
            "internal/renderer/renderer.go||internal/renderer/renderer.go"
          ]
        }
      },
      "candidate_diff": {
        "internal/renderer/renderer.go||internal/renderer/renderer.go": [
          "File: internal/renderer/renderer.go -> internal/renderer/renderer.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import (",
          "4:  \"context\"",
          "5:  \"io/ioutil\"",
          "6:  \"net/http\"",
          "7:  \"os\"",
          "10:  \"github.com/zitadel/logging\"",
          "11:  \"golang.org/x/text/language\"",
          "",
          "[Removed Lines]",
          "8:  \"text/template\"",
          "",
          "[Added Lines]",
          "5:  \"html/template\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}