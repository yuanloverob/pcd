{
  "cve_id": "CVE-2024-1726",
  "cve_desc": "A flaw was discovered in the RESTEasy Reactive implementation in Quarkus. Due to security checks for some JAX-RS endpoints being performed after serialization, more processing resources are consumed while the HTTP request is checked. In certain configurations, if an attacker has knowledge of any POST, PUT, or PATCH request paths, they can potentially identify vulnerable endpoints and trigger excessive resource usage as the endpoints process the requests. This can result in a denial of service.",
  "repo": "quarkusio/quarkus",
  "patch_hash": "34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
  "patch_info": {
    "commit_hash": "34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
    "repo": "quarkusio/quarkus",
    "commit_url": "https://github.com/quarkusio/quarkus/commit/34c1a63baf5401d0d578a23a1a4deb4b841ce65b",
    "files": [
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
    ],
    "message": "Perform security checks eagerly in RR on inherited endpoints\n\n(cherry picked from commit 37834cb44a0bc5101cdf60922c8dd0301efac822)",
    "before_after_code_files": [
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
    ]
  },
  "patch_diff": {
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "91:         assertStatus(path, 403, 401);",
      "92:     }",
      "94:     @Test",
      "95:     public void shouldDenyUnannotatedOnInterface() {",
      "96:         String path = \"/unsecured/defaultSecurityInterface\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "94:     @Test",
      "95:     public void shouldAllowAnnotatedParentEndpoint() {",
      "97:         String path = \"/unsecured/parent-annotated\";",
      "98:         assertStatus(path, 200, 401);",
      "99:     }",
      "101:     @Test",
      "102:     public void shouldAllowAnnotatedEndpointOnInterface() {",
      "104:         String path = \"/unsecured/interface-annotated\";",
      "105:         assertStatus(path, 200, 401);",
      "106:     }",
      "108:     @Test",
      "109:     public void shouldDenyUnannotatedOverriddenOnInterfaceImplementor() {",
      "111:         String path = \"/unsecured/interface-overridden-declared-on-implementor\";",
      "112:         assertStatus(path, 403, 401);",
      "113:     }",
      "115:     @Test",
      "116:     public void shouldAllowAnnotatedOverriddenEndpointDeclaredOnInterface() {",
      "118:         String path = \"/unsecured/interface-overridden-declared-on-interface\";",
      "119:         assertStatus(path, 200, 401);",
      "121:         given().auth().preemptive()",
      "122:                 .basic(\"admin\", \"admin\").get(path)",
      "123:                 .then()",
      "124:                 .body(Matchers.is(\"implementor-response\"));",
      "125:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: package io.quarkus.resteasy.reactive.server.test.security;",
      "3: import jakarta.ws.rs.GET;",
      "4: import jakarta.ws.rs.Path;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: import jakarta.annotation.security.RolesAllowed;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11:         return \"defaultSecurityParent\";",
      "12:     }",
      "14: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "15:     @RolesAllowed({ \"admin\", \"user\" })",
      "16:     @GET",
      "17:     @Path(\"/parent-annotated\")",
      "18:     public String parentAnnotated() {",
      "19:         return \"parent-annotated\";",
      "20:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "57:     public UnsecuredSubResource permitAllSub() {",
      "58:         return new UnsecuredSubResource();",
      "59:     }",
      "60: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61:     @Override",
      "62:     public String interfaceOverriddenDeclaredOnInterface() {",
      "63:         return \"implementor-response\";",
      "64:     }",
      "66:     @GET",
      "67:     @Path(\"/interface-overridden-declared-on-implementor\")",
      "68:     @Override",
      "69:     public String interfaceOverriddenDeclaredOnImplementor() {",
      "70:         return \"implementor-response\";",
      "71:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: package io.quarkus.resteasy.reactive.server.test.security;",
      "3: import jakarta.ws.rs.GET;",
      "4: import jakarta.ws.rs.Path;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: import jakarta.annotation.security.RolesAllowed;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11:         return \"defaultSecurityInterface\";",
      "12:     }",
      "14: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "15:     @RolesAllowed({ \"admin\", \"user\" })",
      "16:     @GET",
      "17:     @Path(\"/interface-annotated\")",
      "18:     default String interfaceAnnotated() {",
      "19:         return \"interface-annotated\";",
      "20:     }",
      "22:     @RolesAllowed({ \"admin\", \"user\" })",
      "23:     @GET",
      "24:     @Path(\"/interface-overridden-declared-on-interface\")",
      "25:     default String interfaceOverriddenDeclaredOnInterface() {",
      "27:         return \"interface-overridden-declared-on-interface\";",
      "28:     }",
      "30:     @RolesAllowed({ \"admin\", \"user\" })",
      "31:     @GET",
      "32:     @Path(\"/interface-overridden-declared-on-implementor\")",
      "33:     default String interfaceOverriddenDeclaredOnImplementor() {",
      "35:         return \"interface-overridden-declared-on-implementor\";",
      "36:     }",
      "",
      "---------------"
    ],
    "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java": [
      "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "187:     }",
      "189:     static MethodDescription lazyMethodToMethodDescription(ResteasyReactiveResourceInfo lazyMethod) {",
      "191:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
      "192:     }",
      "",
      "[Removed Lines]",
      "190:         return new MethodDescription(lazyMethod.getResourceClass().getName(),",
      "",
      "[Added Lines]",
      "190:         return new MethodDescription(lazyMethod.getActualDeclaringClassName(),",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java": [
      "File: independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java -> independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "183:             }",
      "184:         }",
      "185:         serverResourceMethod.setHandlerChainCustomizers(methodCustomizers);",
      "186:         return serverResourceMethod;",
      "187:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "186:         serverResourceMethod.setActualDeclaringClassName(methodInfo.declaringClass().name().toString());",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "190:         ResteasyReactiveResourceInfo lazyMethod = new ResteasyReactiveResourceInfo(method.getName(), resourceClass,",
      "191:                 parameterDeclaredUnresolvedTypes, classAnnotationNames, method.getMethodAnnotationNames(),",
      "194:         RuntimeInterceptorDeployment.MethodInterceptorContext interceptorDeployment = runtimeInterceptorDeployment",
      "195:                 .forMethod(method, lazyMethod);",
      "",
      "[Removed Lines]",
      "192:                 !defaultBlocking && !method.isBlocking());",
      "",
      "[Added Lines]",
      "192:                 !defaultBlocking && !method.isBlocking(), method.getActualDeclaringClassName());",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "19:     private List<HandlerChainCustomizer> handlerChainCustomizers = new ArrayList<>();",
      "20:     private ParameterExtractor customerParameterExtractor;",
      "22:     public ServerResourceMethod() {",
      "23:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "21:     private String actualDeclaringClassName;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "70:         this.customerParameterExtractor = customerParameterExtractor;",
      "71:         return this;",
      "72:     }",
      "73: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "75:     public String getActualDeclaringClassName() {",
      "76:         return actualDeclaringClassName;",
      "77:     }",
      "79:     public void setActualDeclaringClassName(String actualDeclaringClassName) {",
      "80:         this.actualDeclaringClassName = actualDeclaringClassName;",
      "81:     }",
      "",
      "---------------"
    ],
    "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java": [
      "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "28:     public final boolean isNonBlocking;",
      "30:     private volatile Annotation[] classAnnotations;",
      "31:     private volatile Method method;",
      "32:     private volatile Annotation[] annotations;",
      "33:     private volatile Type returnType;",
      "34:     private volatile String methodId;",
      "36:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
      "37:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking) {",
      "38:         this.name = name;",
      "39:         this.declaringClass = declaringClass;",
      "40:         this.parameterTypes = parameterTypes;",
      "41:         this.classAnnotationNames = classAnnotationNames;",
      "42:         this.methodAnnotationNames = methodAnnotationNames;",
      "43:         this.isNonBlocking = isNonBlocking;",
      "44:     }",
      "46:     public String getName() {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "32:     private final String actualDeclaringClassName;",
      "39:     @Deprecated",
      "42:         this(name, declaringClass, parameterTypes, classAnnotationNames, methodAnnotationNames, isNonBlocking,",
      "43:                 declaringClass.getName());",
      "44:     }",
      "46:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
      "47:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking,",
      "48:             String actualDeclaringClassName) {",
      "55:         this.actualDeclaringClassName = actualDeclaringClassName;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "119:         }",
      "120:         return methodId;",
      "121:     }",
      "122: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "135:     public String getActualDeclaringClassName() {",
      "136:         return actualDeclaringClassName;",
      "137:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9afdc862c526392f165e61826ab68a98746f0a59",
      "candidate_info": {
        "commit_hash": "9afdc862c526392f165e61826ab68a98746f0a59",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/9afdc862c526392f165e61826ab68a98746f0a59",
        "files": [
          "extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java"
        ],
        "message": "Add response text to the OIDC bootstrap log errors\n\n(cherry picked from commit c4433baac4cab145c6e655b37771a926a46c8f37)",
        "before_after_code_files": [
          "extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java||extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/quarkusio/quarkus/pull/38864"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java||extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java": [
          "File: extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java -> extensions/oidc-common/runtime/src/main/java/io/quarkus/oidc/common/runtime/OidcCommonUtils.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "447:             if (resp.statusCode() == 200) {",
          "448:                 return resp.bodyAsJsonObject();",
          "449:             } else {",
          "451:                 throw new OidcEndpointAccessException(resp.statusCode());",
          "452:             }",
          "453:         }).onFailure(oidcEndpointNotAvailable())",
          "",
          "[Removed Lines]",
          "450:                 LOG.warnf(\"Discovery has failed, status code: %d\", resp.statusCode());",
          "",
          "[Added Lines]",
          "450:                 String errorMessage = resp.bodyAsString();",
          "451:                 if (errorMessage != null && !errorMessage.isEmpty()) {",
          "452:                     LOG.warnf(\"Discovery request %s has failed, status code: %d, error message: %s\", discoveryUrl,",
          "453:                             resp.statusCode(), errorMessage);",
          "454:                 } else {",
          "455:                     LOG.warnf(\"Discovery request %s has failed, status code: %d\", discoveryUrl, resp.statusCode());",
          "456:                 }",
          "",
          "---------------"
        ],
        "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java": [
          "File: extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java -> extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcProviderClient.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "22: import io.quarkus.oidc.common.runtime.OidcCommonConfig.Credentials.Secret.Method;",
          "23: import io.quarkus.oidc.common.runtime.OidcCommonUtils;",
          "24: import io.quarkus.oidc.common.runtime.OidcConstants;",
          "26: import io.smallrye.mutiny.Uni;",
          "27: import io.smallrye.mutiny.groups.UniOnItem;",
          "28: import io.vertx.core.Vertx;",
          "",
          "[Removed Lines]",
          "25: import io.quarkus.oidc.common.runtime.OidcEndpointAccessException;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "109:         if (resp.statusCode() == 200) {",
          "110:             return new JsonWebKeySet(resp.bodyAsString(StandardCharsets.UTF_8.name()));",
          "111:         } else {",
          "113:         }",
          "114:     }",
          "",
          "[Removed Lines]",
          "112:             throw new OidcEndpointAccessException(resp.statusCode());",
          "",
          "[Added Lines]",
          "111:             throw responseException(metadata.getJsonWebKeySetUri(), resp);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "201:     }",
          "203:     private AuthorizationCodeTokens getAuthorizationCodeTokens(HttpResponse<Buffer> resp) {",
          "205:         final String idToken = json.getString(OidcConstants.ID_TOKEN_VALUE);",
          "206:         final String accessToken = json.getString(OidcConstants.ACCESS_TOKEN_VALUE);",
          "207:         final String refreshToken = json.getString(OidcConstants.REFRESH_TOKEN_VALUE);",
          "",
          "[Removed Lines]",
          "204:         JsonObject json = getJsonObject(resp);",
          "",
          "[Added Lines]",
          "203:         JsonObject json = getJsonObject(metadata.getAuthorizationUri(), resp);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "209:     }",
          "211:     private UserInfo getUserInfo(HttpResponse<Buffer> resp) {",
          "213:     }",
          "215:     private TokenIntrospection getTokenIntrospection(HttpResponse<Buffer> resp) {",
          "217:     }",
          "220:         if (resp.statusCode() == 200) {",
          "221:             LOG.debugf(\"Request succeeded: %s\", resp.bodyAsJsonObject());",
          "222:             return resp.bodyAsJsonObject();",
          "223:         } else {",
          "225:         }",
          "226:     }",
          "229:         if (resp.statusCode() == 200) {",
          "230:             LOG.debugf(\"Request succeeded: %s\", resp.bodyAsString());",
          "231:             return resp.bodyAsString();",
          "232:         } else {",
          "234:         }",
          "235:     }",
          "238:         String errorMessage = resp.bodyAsString();",
          "241:     }",
          "243:     @Override",
          "",
          "[Removed Lines]",
          "212:         return new UserInfo(getString(resp));",
          "216:         return new TokenIntrospection(getString(resp));",
          "219:     private static JsonObject getJsonObject(HttpResponse<Buffer> resp) {",
          "224:             throw responseException(resp);",
          "228:     private static String getString(HttpResponse<Buffer> resp) {",
          "233:             throw responseException(resp);",
          "237:     private static OIDCException responseException(HttpResponse<Buffer> resp) {",
          "239:         LOG.debugf(\"Request has failed: status: %d, error message: %s\", resp.statusCode(), errorMessage);",
          "240:         throw new OIDCException(errorMessage);",
          "",
          "[Added Lines]",
          "211:         return new UserInfo(getString(metadata.getUserInfoUri(), resp));",
          "215:         return new TokenIntrospection(getString(metadata.getIntrospectionUri(), resp));",
          "218:     private static JsonObject getJsonObject(String requestUri, HttpResponse<Buffer> resp) {",
          "223:             throw responseException(requestUri, resp);",
          "227:     private static String getString(String requestUri, HttpResponse<Buffer> resp) {",
          "232:             throw responseException(requestUri, resp);",
          "236:     private static OIDCException responseException(String requestUri, HttpResponse<Buffer> resp) {",
          "239:         if (errorMessage != null && !errorMessage.isEmpty()) {",
          "240:             LOG.errorf(\"Request %s has failed: status: %d, error message: %s\", requestUri, resp.statusCode(), errorMessage);",
          "241:             throw new OIDCException(errorMessage);",
          "242:         } else {",
          "243:             LOG.errorf(\"Request %s has failed: status: %d\", requestUri, resp.statusCode());",
          "244:             throw new OIDCException(\"Error status:\" + resp.statusCode());",
          "245:         }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a5daa319747a67527d48f6fd24438b0d93a6b1fb",
      "candidate_info": {
        "commit_hash": "a5daa319747a67527d48f6fd24438b0d93a6b1fb",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/a5daa319747a67527d48f6fd24438b0d93a6b1fb",
        "files": [
          "docs/src/main/asciidoc/security-openid-connect-multitenancy.adoc",
          "extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java",
          "extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java",
          "extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java",
          "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java",
          "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java",
          "integration-tests/oidc-wiremock/pom.xml",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java",
          "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java",
          "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java"
        ],
        "message": "Use OIDC Tenant annotation to resolve tenants",
        "before_after_code_files": [
          "extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java||extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java",
          "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java",
          "extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java||extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java",
          "extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java||extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java",
          "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java",
          "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java||extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java",
          "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java||extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java",
          "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java",
          "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java||integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java",
          "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java||integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java"
          ],
          "candidate": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java"
          ]
        }
      },
      "candidate_diff": {
        "extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java||extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java": [
          "File: extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java -> extensions/oidc/deployment/src/main/java/io/quarkus/oidc/deployment/OidcBuildStep.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.oidc.deployment;",
          "3: import java.util.function.BooleanSupplier;",
          "5: import jakarta.inject.Singleton;",
          "7: import org.eclipse.microprofile.jwt.Claim;",
          "8: import org.jboss.jandex.DotName;",
          "10: import io.quarkus.arc.deployment.AdditionalBeanBuildItem;",
          "11: import io.quarkus.arc.deployment.SynthesisFinishedBuildItem;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import static io.quarkus.vertx.http.deployment.EagerSecurityInterceptorCandidateBuildItem.hasProperEndpointModifiers;",
          "4: import static org.jboss.jandex.AnnotationTarget.Kind.CLASS;",
          "5: import static org.jboss.jandex.AnnotationTarget.Kind.METHOD;",
          "7: import java.util.HashMap;",
          "8: import java.util.Map;",
          "10: import java.util.function.Consumer;",
          "11: import java.util.stream.Collectors;",
          "16: import org.jboss.jandex.AnnotationInstance;",
          "17: import org.jboss.jandex.AnnotationTarget;",
          "19: import org.jboss.jandex.IndexView;",
          "20: import org.jboss.jandex.MethodInfo;",
          "21: import org.jboss.logging.Logger;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "19: import io.quarkus.deployment.annotations.Consume;",
          "20: import io.quarkus.deployment.annotations.ExecutionTime;",
          "21: import io.quarkus.deployment.annotations.Record;",
          "22: import io.quarkus.deployment.builditem.ExtensionSslNativeSupportBuildItem;",
          "23: import io.quarkus.deployment.builditem.RuntimeConfigSetupCompleteBuildItem;",
          "24: import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;",
          "25: import io.quarkus.oidc.SecurityEvent;",
          "26: import io.quarkus.oidc.TokenIntrospectionCache;",
          "27: import io.quarkus.oidc.UserInfoCache;",
          "28: import io.quarkus.oidc.runtime.BackChannelLogoutHandler;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: import io.quarkus.deployment.builditem.CombinedIndexBuildItem;",
          "40: import io.quarkus.oidc.Tenant;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "41: import io.quarkus.oidc.runtime.providers.AzureAccessTokenCustomizer;",
          "42: import io.quarkus.runtime.TlsConfig;",
          "43: import io.quarkus.vertx.core.deployment.CoreVertxBuildItem;",
          "44: import io.quarkus.vertx.http.deployment.SecurityInformationBuildItem;",
          "45: import io.smallrye.jwt.auth.cdi.ClaimValueProducer;",
          "46: import io.smallrye.jwt.auth.cdi.CommonJwtProducer;",
          "47: import io.smallrye.jwt.auth.cdi.JsonValueProducer;",
          "48: import io.smallrye.jwt.auth.cdi.RawClaimTypeProducer;",
          "50: @BuildSteps(onlyIf = OidcBuildStep.IsEnabled.class)",
          "51: public class OidcBuildStep {",
          "52:     public static final DotName DOTNAME_SECURITY_EVENT = DotName.createSimple(SecurityEvent.class.getName());",
          "54:     @BuildStep",
          "55:     public void provideSecurityInformation(BuildProducer<SecurityInformationBuildItem> securityInformationProducer) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "59: import io.quarkus.vertx.http.deployment.EagerSecurityInterceptorCandidateBuildItem;",
          "61: import io.quarkus.vertx.http.runtime.HttpBuildTimeConfig;",
          "66: import io.vertx.ext.web.RoutingContext;",
          "71:     private static final DotName TENANT_NAME = DotName.createSimple(Tenant.class);",
          "72:     private static final Logger LOG = Logger.getLogger(OidcBuildStep.class);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "136:         recorder.setSecurityEventObserved(isSecurityEventObserved);",
          "137:     }",
          "139:     public static class IsEnabled implements BooleanSupplier {",
          "140:         OidcBuildTimeConfig config;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "159:     @BuildStep",
          "160:     @Record(ExecutionTime.STATIC_INIT)",
          "161:     public void produceTenantResolverInterceptors(CombinedIndexBuildItem indexBuildItem,",
          "162:             Capabilities capabilities, OidcRecorder recorder,",
          "163:             BuildProducer<EagerSecurityInterceptorCandidateBuildItem> producer,",
          "164:             HttpBuildTimeConfig buildTimeConfig) {",
          "165:         if (!buildTimeConfig.auth.proactive",
          "166:                 && (capabilities.isPresent(Capability.RESTEASY_REACTIVE) || capabilities.isPresent(Capability.RESTEASY))) {",
          "170:             IndexView index = indexBuildItem.getIndex();",
          "171:             Map<MethodInfo, String> candidateToTenant = new HashMap<>();",
          "173:             for (AnnotationInstance annotation : index.getAnnotations(TENANT_NAME)) {",
          "176:                 AnnotationTarget target = annotation.target();",
          "177:                 if (annotation.value() == null || annotation.value().asString().isEmpty()) {",
          "178:                     LOG.warnf(\"Annotation instance @Tenant placed on %s did not provide valid tenant\", toTargetName(target));",
          "179:                     continue;",
          "180:                 }",
          "183:                 String tenant = annotation.value().asString();",
          "184:                 if (target.kind() == METHOD) {",
          "185:                     MethodInfo method = target.asMethod();",
          "186:                     if (hasProperEndpointModifiers(method)) {",
          "187:                         candidateToTenant.put(method, tenant);",
          "188:                     } else {",
          "189:                         LOG.warnf(\"Method %s is not valid endpoint, but is annotated with the '@Tenant' annotation\",",
          "190:                                 toTargetName(target));",
          "191:                     }",
          "192:                 } else if (target.kind() == CLASS) {",
          "196:                     for (MethodInfo method : target.asClass().methods()) {",
          "197:                         if (hasProperEndpointModifiers(method)) {",
          "198:                             candidateToTenant.put(method, tenant);",
          "199:                         }",
          "200:                     }",
          "201:                 }",
          "202:             }",
          "205:             if (!candidateToTenant.isEmpty()) {",
          "207:                 Map<String, Consumer<RoutingContext>> tenantToInterceptor = candidateToTenant",
          "208:                         .values()",
          "209:                         .stream()",
          "210:                         .distinct()",
          "211:                         .map(tenant -> Map.entry(tenant, recorder.createTenantResolverInterceptor(tenant)))",
          "212:                         .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));",
          "214:                 candidateToTenant.forEach((method, tenant) -> {",
          "217:                     String[] paramTypes = method.parameterTypes().stream().map(t -> t.name().toString()).toArray(String[]::new);",
          "218:                     String className = method.declaringClass().name().toString();",
          "219:                     String methodName = method.name();",
          "220:                     var description = recorder.methodInfoToDescription(className, methodName, paramTypes);",
          "222:                     producer.produce(new EagerSecurityInterceptorCandidateBuildItem(method, description,",
          "223:                             tenantToInterceptor.get(tenant)));",
          "224:                 });",
          "225:             }",
          "226:         }",
          "227:     }",
          "229:     private static String toTargetName(AnnotationTarget target) {",
          "230:         if (target.kind() == CLASS) {",
          "231:             return target.asClass().name().toString();",
          "232:         } else {",
          "233:             return target.asMethod().declaringClass().name().toString() + \"#\" + target.asMethod().name();",
          "234:         }",
          "235:     }",
          "",
          "---------------"
        ],
        "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java": [
          "File: extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java -> extensions/oidc/runtime/src/main/java/io/quarkus/oidc/Tenant.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.oidc;",
          "3: import static java.lang.annotation.ElementType.METHOD;",
          "4: import static java.lang.annotation.ElementType.TYPE;",
          "6: import java.lang.annotation.Retention;",
          "7: import java.lang.annotation.RetentionPolicy;",
          "8: import java.lang.annotation.Target;",
          "13: @Target({ TYPE, METHOD })",
          "14: @Retention(RetentionPolicy.RUNTIME)",
          "15: public @interface Tenant {",
          "19:     String value();",
          "20: }",
          "",
          "---------------"
        ],
        "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java": [
          "File: extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java -> extensions/oidc/runtime/src/main/java/io/quarkus/oidc/TenantResolverInterceptor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java||extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java": [
          "File: extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java -> extensions/oidc/runtime/src/main/java/io/quarkus/oidc/runtime/OidcRecorder.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: import java.util.Set;",
          "9: import java.util.concurrent.ConcurrentHashMap;",
          "10: import java.util.function.BiFunction;",
          "11: import java.util.function.Function;",
          "12: import java.util.function.Supplier;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: import java.util.function.Consumer;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "28: import io.quarkus.oidc.common.runtime.OidcCommonUtils;",
          "29: import io.quarkus.runtime.ExecutorRecorder;",
          "30: import io.quarkus.runtime.LaunchMode;",
          "31: import io.quarkus.runtime.TlsConfig;",
          "32: import io.quarkus.runtime.annotations.Recorder;",
          "33: import io.quarkus.runtime.configuration.ConfigurationException;",
          "34: import io.smallrye.jwt.algorithm.KeyEncryptionAlgorithm;",
          "35: import io.smallrye.jwt.util.KeyUtils;",
          "36: import io.smallrye.mutiny.Uni;",
          "37: import io.vertx.core.Vertx;",
          "38: import io.vertx.core.json.JsonObject;",
          "39: import io.vertx.core.net.ProxyOptions;",
          "40: import io.vertx.ext.web.client.WebClientOptions;",
          "41: import io.vertx.mutiny.ext.web.client.WebClient;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32: import io.quarkus.runtime.RuntimeValue;",
          "36: import io.quarkus.security.spi.runtime.MethodDescription;",
          "43: import io.vertx.ext.web.RoutingContext;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "85:         };",
          "86:     }",
          "88:     private Uni<TenantConfigContext> createDynamicTenantContext(Vertx vertx,",
          "89:             OidcTenantConfig oidcConfig, TlsConfig tlsConfig, String tenantId) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92:     public RuntimeValue<MethodDescription> methodInfoToDescription(String className, String methodName, String[] paramTypes) {",
          "93:         return new RuntimeValue<>(new MethodDescription(className, methodName, paramTypes));",
          "94:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "478:                 introspectionUri, authorizationUri, jwksUri, userInfoUri, endSessionUri,",
          "479:                 oidcConfig.token.issuer.orElse(null));",
          "480:     }",
          "481: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "490:     public Consumer<RoutingContext> createTenantResolverInterceptor(String tenantId) {",
          "491:         return new Consumer<RoutingContext>() {",
          "492:             @Override",
          "493:             public void accept(RoutingContext routingContext) {",
          "494:                 routingContext.put(OidcUtils.TENANT_ID_ATTRIBUTE, tenantId);",
          "495:             }",
          "496:         };",
          "497:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java||extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java": [
          "File: extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java -> extensions/resteasy-classic/resteasy/deployment/src/main/java/io/quarkus/resteasy/deployment/ResteasyBuiltinsProcessor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: import java.util.ArrayList;",
          "8: import java.util.List;",
          "9: import java.util.Objects;",
          "10: import java.util.stream.Collectors;",
          "12: import org.jboss.jandex.ClassInfo;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: import java.util.Optional;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "27: import io.quarkus.resteasy.runtime.AuthenticationFailedExceptionMapper;",
          "28: import io.quarkus.resteasy.runtime.AuthenticationRedirectExceptionMapper;",
          "29: import io.quarkus.resteasy.runtime.CompositeExceptionMapper;",
          "30: import io.quarkus.resteasy.runtime.ExceptionMapperRecorder;",
          "31: import io.quarkus.resteasy.runtime.ForbiddenExceptionMapper;",
          "32: import io.quarkus.resteasy.runtime.JaxRsSecurityConfig;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "31: import io.quarkus.resteasy.runtime.EagerSecurityFilter;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "39: import io.quarkus.resteasy.runtime.vertx.JsonObjectWriter;",
          "40: import io.quarkus.resteasy.server.common.deployment.ResteasyDeploymentBuildItem;",
          "41: import io.quarkus.security.spi.AdditionalSecuredMethodsBuildItem;",
          "42: import io.quarkus.vertx.http.deployment.HttpRootPathBuildItem;",
          "43: import io.quarkus.vertx.http.deployment.devmode.NotFoundPageDisplayableEndpointBuildItem;",
          "44: import io.quarkus.vertx.http.deployment.devmode.RouteDescriptionBuildItem;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: import io.quarkus.vertx.http.deployment.EagerSecurityInterceptorBuildItem;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "89:     @BuildStep",
          "90:     void setUpSecurity(BuildProducer<ResteasyJaxrsProviderBuildItem> providers,",
          "92:         providers.produce(new ResteasyJaxrsProviderBuildItem(UnauthorizedExceptionMapper.class.getName()));",
          "93:         providers.produce(new ResteasyJaxrsProviderBuildItem(ForbiddenExceptionMapper.class.getName()));",
          "94:         providers.produce(new ResteasyJaxrsProviderBuildItem(AuthenticationFailedExceptionMapper.class.getName()));",
          "",
          "[Removed Lines]",
          "91:             BuildProducer<AdditionalBeanBuildItem> additionalBeanBuildItem, Capabilities capabilities) {",
          "",
          "[Added Lines]",
          "94:             BuildProducer<AdditionalBeanBuildItem> additionalBeanBuildItem, Capabilities capabilities,",
          "95:             Optional<EagerSecurityInterceptorBuildItem> eagerSecurityInterceptors) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "98:         if (capabilities.isPresent(Capability.SECURITY)) {",
          "99:             providers.produce(new ResteasyJaxrsProviderBuildItem(SecurityContextFilter.class.getName()));",
          "100:             additionalBeanBuildItem.produce(AdditionalBeanBuildItem.unremovableOf(SecurityContextFilter.class));",
          "101:         }",
          "102:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "105:             if (eagerSecurityInterceptors.isPresent()) {",
          "106:                 providers.produce(new ResteasyJaxrsProviderBuildItem(EagerSecurityFilter.class.getName()));",
          "107:                 additionalBeanBuildItem.produce(AdditionalBeanBuildItem.unremovableOf(EagerSecurityFilter.class));",
          "108:             }",
          "",
          "---------------"
        ],
        "extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java||extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java": [
          "File: extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java -> extensions/resteasy-classic/resteasy/runtime/src/main/java/io/quarkus/resteasy/runtime/EagerSecurityFilter.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.resteasy.runtime;",
          "3: import java.io.IOException;",
          "4: import java.util.HashMap;",
          "5: import java.util.Map;",
          "6: import java.util.function.Consumer;",
          "8: import jakarta.annotation.Priority;",
          "9: import jakarta.inject.Inject;",
          "10: import jakarta.ws.rs.Priorities;",
          "11: import jakarta.ws.rs.container.ContainerRequestContext;",
          "12: import jakarta.ws.rs.container.ContainerRequestFilter;",
          "13: import jakarta.ws.rs.container.ResourceInfo;",
          "14: import jakarta.ws.rs.core.Context;",
          "15: import jakarta.ws.rs.ext.Provider;",
          "17: import io.quarkus.security.spi.runtime.MethodDescription;",
          "18: import io.quarkus.vertx.http.runtime.security.EagerSecurityInterceptorStorage;",
          "19: import io.vertx.ext.web.RoutingContext;",
          "21: @Priority(Priorities.AUTHENTICATION)",
          "22: @Provider",
          "23: public class EagerSecurityFilter implements ContainerRequestFilter {",
          "25:     private static final Consumer<RoutingContext> NULL_SENTINEL = new Consumer<RoutingContext>() {",
          "26:         @Override",
          "27:         public void accept(RoutingContext routingContext) {",
          "29:         }",
          "30:     };",
          "31:     private final Map<MethodDescription, Consumer<RoutingContext>> cache = new HashMap<>();",
          "33:     @Context",
          "34:     ResourceInfo resourceInfo;",
          "36:     @Inject",
          "37:     EagerSecurityInterceptorStorage interceptorStorage;",
          "39:     @Inject",
          "40:     RoutingContext routingContext;",
          "42:     @Override",
          "43:     public void filter(ContainerRequestContext requestContext) throws IOException {",
          "44:         var description = MethodDescription.ofMethod(resourceInfo.getResourceMethod());",
          "45:         var interceptor = cache.get(description);",
          "47:         if (interceptor == NULL_SENTINEL) {",
          "48:             return;",
          "49:         } else if (interceptor != null) {",
          "50:             interceptor.accept(routingContext);",
          "51:         }",
          "53:         interceptor = interceptorStorage.getInterceptor(description);",
          "54:         if (interceptor == null) {",
          "55:             cache.put(description, NULL_SENTINEL);",
          "56:         } else {",
          "57:             cache.put(description, interceptor);",
          "58:             interceptor.accept(routingContext);",
          "59:         }",
          "60:     }",
          "61: }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/main/java/io/quarkus/resteasy/reactive/server/deployment/ResteasyReactiveProcessor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "176: import io.quarkus.resteasy.reactive.server.runtime.exceptionmappers.ForbiddenExceptionMapper;",
          "177: import io.quarkus.resteasy.reactive.server.runtime.exceptionmappers.UnauthorizedExceptionMapper;",
          "178: import io.quarkus.resteasy.reactive.server.runtime.security.EagerSecurityHandler;",
          "179: import io.quarkus.resteasy.reactive.server.runtime.security.SecurityContextOverrideHandler;",
          "180: import io.quarkus.resteasy.reactive.server.spi.AnnotationsTransformerBuildItem;",
          "181: import io.quarkus.resteasy.reactive.server.spi.ContextTypeBuildItem;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "179: import io.quarkus.resteasy.reactive.server.runtime.security.EagerSecurityInterceptorHandler;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "198: import io.quarkus.security.AuthenticationFailedException;",
          "199: import io.quarkus.security.AuthenticationRedirectException;",
          "200: import io.quarkus.security.ForbiddenException;",
          "201: import io.quarkus.vertx.http.deployment.FilterBuildItem;",
          "202: import io.quarkus.vertx.http.deployment.RouteBuildItem;",
          "203: import io.quarkus.vertx.http.runtime.HttpBuildTimeConfig;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "202: import io.quarkus.vertx.http.deployment.EagerSecurityInterceptorBuildItem;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1486:     @BuildStep",
          "1487:     MethodScannerBuildItem integrateEagerSecurity(Capabilities capabilities, CombinedIndexBuildItem indexBuildItem,",
          "1489:         if (!capabilities.isPresent(Capability.SECURITY)) {",
          "1490:             return null;",
          "1491:         }",
          "1493:         final boolean denyJaxRs = ConfigProvider.getConfig()",
          "1494:                 .getOptionalValue(\"quarkus.security.jaxrs.deny-unannotated-endpoints\", Boolean.class).orElse(false);",
          "1495:         final boolean hasDefaultJaxRsRolesAllowed = ConfigProvider.getConfig()",
          "",
          "[Removed Lines]",
          "1488:             HttpBuildTimeConfig httpBuildTimeConfig) {",
          "",
          "[Added Lines]",
          "1490:             HttpBuildTimeConfig httpBuildTimeConfig, Optional<EagerSecurityInterceptorBuildItem> eagerSecurityInterceptors) {",
          "1495:         final boolean applySecurityInterceptors = eagerSecurityInterceptors.isPresent();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1508:                     securityHandlerList = Collections",
          "1509:                             .singletonList(EagerSecurityHandler.Customizer.newInstance(httpBuildTimeConfig.auth.proactive));",
          "1510:                 }",
          "1511:                 return Objects.requireNonNullElse(securityHandlerList, Collections.emptyList());",
          "1512:             }",
          "1513:         });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1514:                 if (applySecurityInterceptors && eagerSecurityInterceptors.get().applyInterceptorOn(method)) {",
          "1515:                     List<HandlerChainCustomizer> nextSecurityHandlerList = new ArrayList<>();",
          "1516:                     nextSecurityHandlerList.add(EagerSecurityInterceptorHandler.Customizer.newInstance());",
          "1519:                     if (securityHandlerList != null) {",
          "1520:                         nextSecurityHandlerList.addAll(securityHandlerList);",
          "1521:                     }",
          "1523:                     securityHandlerList = List.copyOf(nextSecurityHandlerList);",
          "1524:                 }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:         }",
          "58:         SecurityCheck check = this.check;",
          "59:         ResteasyReactiveResourceInfo lazyMethod = requestContext.getTarget().getLazyMethod();",
          "62:         if (check == null) {",
          "63:             check = Arc.container().instance(SecurityCheckStorage.class).get().getSecurityCheck(methodDescription);",
          "64:             if (check == null) {",
          "",
          "[Removed Lines]",
          "60:         MethodDescription methodDescription = new MethodDescription(lazyMethod.getResourceClass().getName(),",
          "61:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
          "",
          "[Added Lines]",
          "60:         MethodDescription methodDescription = lazyMethodToMethodDescription(lazyMethod);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "131:         }",
          "132:     }",
          "134:     private void preventRepeatedSecurityChecks(ResteasyReactiveRequestContext requestContext,",
          "135:             MethodDescription methodDescription) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     static MethodDescription lazyMethodToMethodDescription(ResteasyReactiveResourceInfo lazyMethod) {",
          "134:         return new MethodDescription(lazyMethod.getResourceClass().getName(),",
          "135:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
          "136:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityInterceptorHandler.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.resteasy.reactive.server.runtime.security;",
          "3: import static io.quarkus.resteasy.reactive.server.runtime.security.EagerSecurityHandler.lazyMethodToMethodDescription;",
          "5: import java.util.Collections;",
          "6: import java.util.List;",
          "7: import java.util.function.Consumer;",
          "9: import org.jboss.resteasy.reactive.common.model.ResourceClass;",
          "10: import org.jboss.resteasy.reactive.server.core.ResteasyReactiveRequestContext;",
          "11: import org.jboss.resteasy.reactive.server.model.HandlerChainCustomizer;",
          "12: import org.jboss.resteasy.reactive.server.model.ServerResourceMethod;",
          "13: import org.jboss.resteasy.reactive.server.spi.ServerRestHandler;",
          "15: import io.quarkus.arc.Arc;",
          "16: import io.quarkus.security.spi.runtime.MethodDescription;",
          "17: import io.quarkus.security.spi.runtime.SecurityCheck;",
          "18: import io.quarkus.vertx.http.runtime.security.EagerSecurityInterceptorStorage;",
          "19: import io.vertx.ext.web.RoutingContext;",
          "25: public class EagerSecurityInterceptorHandler implements ServerRestHandler {",
          "27:     private static final Consumer<RoutingContext> NULL_SENTINEL = new Consumer<RoutingContext>() {",
          "28:         @Override",
          "29:         public void accept(RoutingContext routingContext) {",
          "31:         }",
          "32:     };",
          "33:     private volatile Consumer<RoutingContext> interceptor;",
          "35:     private EagerSecurityInterceptorHandler() {",
          "36:     }",
          "38:     @Override",
          "39:     public void handle(ResteasyReactiveRequestContext requestContext) throws Exception {",
          "43:         if (interceptor == NULL_SENTINEL) {",
          "44:             return;",
          "45:         }",
          "47:         if (interceptor == null) {",
          "48:             MethodDescription methodDescription = lazyMethodToMethodDescription(requestContext.getTarget().getLazyMethod());",
          "49:             interceptor = Arc.container().select(EagerSecurityInterceptorStorage.class).get().getInterceptor(methodDescription);",
          "51:             if (interceptor == null) {",
          "52:                 interceptor = NULL_SENTINEL;",
          "53:                 return;",
          "54:             }",
          "55:         }",
          "57:         interceptor.accept(requestContext.unwrap(RoutingContext.class));",
          "58:     }",
          "60:     public static class Customizer implements HandlerChainCustomizer {",
          "62:         public static HandlerChainCustomizer newInstance() {",
          "63:             return new Customizer();",
          "64:         }",
          "66:         @Override",
          "67:         public List<ServerRestHandler> handlers(Phase phase, ResourceClass resourceClass,",
          "68:                 ServerResourceMethod serverResourceMethod) {",
          "69:             if (phase == Phase.AFTER_MATCH) {",
          "70:                 return Collections.singletonList(new EagerSecurityInterceptorHandler());",
          "71:             }",
          "72:             return Collections.emptyList();",
          "73:         }",
          "75:     }",
          "76: }",
          "",
          "---------------"
        ],
        "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java": [
          "File: extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java -> extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorBuildItem.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.vertx.http.deployment;",
          "3: import java.util.List;",
          "4: import java.util.Map;",
          "5: import java.util.function.Consumer;",
          "7: import org.jboss.jandex.MethodInfo;",
          "9: import io.quarkus.builder.item.SimpleBuildItem;",
          "10: import io.quarkus.runtime.RuntimeValue;",
          "11: import io.quarkus.security.spi.runtime.MethodDescription;",
          "12: import io.vertx.ext.web.RoutingContext;",
          "23: public final class EagerSecurityInterceptorBuildItem extends SimpleBuildItem {",
          "25:     private final List<MethodInfo> methodCandidates;",
          "26:     final Map<RuntimeValue<MethodDescription>, Consumer<RoutingContext>> methodCandidateToSecurityInterceptor;",
          "28:     EagerSecurityInterceptorBuildItem(",
          "29:             List<MethodInfo> methodCandidates,",
          "30:             Map<RuntimeValue<MethodDescription>, Consumer<RoutingContext>> methodCandidateToSecurityInterceptor) {",
          "31:         this.methodCandidates = methodCandidates;",
          "32:         this.methodCandidateToSecurityInterceptor = Map.copyOf(methodCandidateToSecurityInterceptor);",
          "33:     }",
          "35:     public boolean applyInterceptorOn(MethodInfo method) {",
          "36:         return methodCandidates.contains(method);",
          "37:     }",
          "38: }",
          "",
          "---------------"
        ],
        "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java": [
          "File: extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java -> extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/EagerSecurityInterceptorCandidateBuildItem.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.vertx.http.deployment;",
          "3: import java.lang.reflect.Modifier;",
          "4: import java.util.Objects;",
          "5: import java.util.function.Consumer;",
          "7: import org.jboss.jandex.MethodInfo;",
          "9: import io.quarkus.builder.item.MultiBuildItem;",
          "10: import io.quarkus.runtime.RuntimeValue;",
          "11: import io.quarkus.security.spi.runtime.MethodDescription;",
          "12: import io.vertx.ext.web.RoutingContext;",
          "22: public final class EagerSecurityInterceptorCandidateBuildItem extends MultiBuildItem {",
          "24:     private final MethodInfo methodInfo;",
          "25:     private final RuntimeValue<MethodDescription> descriptionRuntimeValue;",
          "26:     private final Consumer<RoutingContext> securityInterceptor;",
          "34:     public EagerSecurityInterceptorCandidateBuildItem(MethodInfo methodInfo,",
          "35:             RuntimeValue<MethodDescription> descriptionRuntimeValue,",
          "36:             Consumer<RoutingContext> securityInterceptor) {",
          "37:         this.methodInfo = Objects.requireNonNull(methodInfo);",
          "38:         this.descriptionRuntimeValue = Objects.requireNonNull(descriptionRuntimeValue);",
          "39:         this.securityInterceptor = securityInterceptor;",
          "40:     }",
          "42:     public static boolean hasProperEndpointModifiers(MethodInfo info) {",
          "44:         if ((info.flags() & 0x1000) != 0) {",
          "45:             return false;",
          "46:         }",
          "48:         if ((info.flags() & Modifier.PUBLIC) == 0) {",
          "49:             return false;",
          "50:         }",
          "52:         return (info.flags() & Modifier.STATIC) == 0;",
          "53:     }",
          "55:     MethodInfo getMethodInfo() {",
          "56:         return methodInfo;",
          "57:     }",
          "59:     RuntimeValue<MethodDescription> getDescriptionRuntimeValue() {",
          "60:         return descriptionRuntimeValue;",
          "61:     }",
          "63:     Consumer<RoutingContext> getSecurityInterceptor() {",
          "64:         return securityInterceptor;",
          "65:     }",
          "66: }",
          "",
          "---------------"
        ],
        "extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java||extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java": [
          "File: extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java -> extensions/vertx-http/deployment/src/main/java/io/quarkus/vertx/http/deployment/HttpSecurityProcessor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.vertx.http.deployment;",
          "3: import java.security.Permission;",
          "4: import java.util.HashMap;",
          "5: import java.util.List;",
          "6: import java.util.Map;",
          "7: import java.util.function.BiFunction;",
          "8: import java.util.function.Function;",
          "9: import java.util.function.Supplier;",
          "11: import jakarta.inject.Singleton;",
          "13: import org.jboss.jandex.ClassInfo;",
          "15: import org.jboss.jandex.IndexView;",
          "16: import org.jboss.jandex.MethodInfo;",
          "17: import org.jboss.jandex.Type;",
          "",
          "[Removed Lines]",
          "14: import org.jboss.jandex.DotName;",
          "",
          "[Added Lines]",
          "3: import static org.jboss.jandex.AnnotationTarget.Kind.CLASS;",
          "9: import java.util.Optional;",
          "11: import java.util.function.Consumer;",
          "14: import java.util.stream.Collectors;",
          "16: import jakarta.enterprise.context.ApplicationScoped;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "27: import io.quarkus.deployment.annotations.Record;",
          "28: import io.quarkus.deployment.builditem.CombinedIndexBuildItem;",
          "29: import io.quarkus.deployment.builditem.nativeimage.ReflectiveClassBuildItem;",
          "30: import io.quarkus.runtime.configuration.ConfigurationException;",
          "31: import io.quarkus.security.StringPermission;",
          "32: import io.quarkus.vertx.http.runtime.HttpBuildTimeConfig;",
          "33: import io.quarkus.vertx.http.runtime.PolicyConfig;",
          "34: import io.quarkus.vertx.http.runtime.management.ManagementInterfaceBuildTimeConfig;",
          "35: import io.quarkus.vertx.http.runtime.security.AuthenticatedHttpSecurityPolicy;",
          "36: import io.quarkus.vertx.http.runtime.security.BasicAuthenticationMechanism;",
          "37: import io.quarkus.vertx.http.runtime.security.DenySecurityPolicy;",
          "38: import io.quarkus.vertx.http.runtime.security.FormAuthenticationMechanism;",
          "39: import io.quarkus.vertx.http.runtime.security.HttpAuthenticationMechanism;",
          "40: import io.quarkus.vertx.http.runtime.security.HttpAuthenticator;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: import io.quarkus.runtime.RuntimeValue;",
          "38: import io.quarkus.security.spi.runtime.MethodDescription;",
          "45: import io.quarkus.vertx.http.runtime.security.EagerSecurityInterceptorStorage;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "47: import io.quarkus.vertx.http.runtime.security.RolesAllowedHttpSecurityPolicy;",
          "48: import io.quarkus.vertx.http.runtime.security.SupplierImpl;",
          "49: import io.vertx.core.http.ClientAuth;",
          "51: public class HttpSecurityProcessor {",
          "55:     @BuildStep",
          "56:     @Record(ExecutionTime.STATIC_INIT)",
          "57:     public void builtins(BuildProducer<HttpSecurityPolicyBuildItem> producer,",
          "",
          "[Removed Lines]",
          "53:     private static final DotName PERMISSION = DotName.createSimple(Permission.class.getName());",
          "",
          "[Added Lines]",
          "58: import io.vertx.ext.web.RoutingContext;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "275:         }",
          "276:     }",
          "278:     private static boolean isMtlsClientAuthenticationEnabled(HttpBuildTimeConfig buildTimeConfig) {",
          "279:         return !ClientAuth.NONE.equals(buildTimeConfig.tlsClientAuth);",
          "280:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "285:     @BuildStep",
          "286:     void collectEagerSecurityInterceptors(List<EagerSecurityInterceptorCandidateBuildItem> interceptorCandidates,",
          "287:             HttpBuildTimeConfig buildTimeConfig, Capabilities capabilities,",
          "288:             BuildProducer<EagerSecurityInterceptorBuildItem> interceptorsProducer) {",
          "289:         if (!buildTimeConfig.auth.proactive && capabilities.isPresent(Capability.SECURITY)",
          "290:                 && !interceptorCandidates.isEmpty()) {",
          "291:             List<MethodInfo> allInterceptedMethodInfos = interceptorCandidates",
          "292:                     .stream()",
          "293:                     .map(EagerSecurityInterceptorCandidateBuildItem::getMethodInfo)",
          "294:                     .collect(Collectors.toList());",
          "295:             Map<RuntimeValue<MethodDescription>, Consumer<RoutingContext>> methodToInterceptor = interceptorCandidates",
          "296:                     .stream()",
          "297:                     .collect(Collectors.toMap(EagerSecurityInterceptorCandidateBuildItem::getDescriptionRuntimeValue,",
          "298:                             EagerSecurityInterceptorCandidateBuildItem::getSecurityInterceptor));",
          "299:             interceptorsProducer.produce(new EagerSecurityInterceptorBuildItem(allInterceptedMethodInfos, methodToInterceptor));",
          "300:         }",
          "301:     }",
          "303:     @BuildStep",
          "304:     @Record(ExecutionTime.STATIC_INIT)",
          "305:     void produceEagerSecurityInterceptorStorage(HttpSecurityRecorder recorder,",
          "306:             BuildProducer<SyntheticBeanBuildItem> producer,",
          "307:             Optional<EagerSecurityInterceptorBuildItem> interceptors) {",
          "308:         if (interceptors.isPresent()) {",
          "309:             producer.produce(SyntheticBeanBuildItem",
          "310:                     .configure(EagerSecurityInterceptorStorage.class)",
          "311:                     .scope(ApplicationScoped.class)",
          "312:                     .supplier(",
          "313:                             recorder.createSecurityInterceptorStorage(interceptors.get().methodCandidateToSecurityInterceptor))",
          "314:                     .unremovable()",
          "315:                     .done());",
          "316:         }",
          "317:     }",
          "",
          "---------------"
        ],
        "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java||extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java": [
          "File: extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java -> extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/EagerSecurityInterceptorStorage.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.vertx.http.runtime.security;",
          "3: import java.util.Map;",
          "4: import java.util.function.Consumer;",
          "6: import io.quarkus.security.spi.runtime.MethodDescription;",
          "7: import io.vertx.ext.web.RoutingContext;",
          "17: public class EagerSecurityInterceptorStorage {",
          "19:     private final Map<MethodDescription, Consumer<RoutingContext>> methodToInterceptor;",
          "21:     EagerSecurityInterceptorStorage(",
          "22:             Map<MethodDescription, Consumer<RoutingContext>> methodToInterceptor) {",
          "23:         this.methodToInterceptor = Map.copyOf(methodToInterceptor);",
          "24:     }",
          "32:     public Consumer<RoutingContext> getInterceptor(MethodDescription endpoint) {",
          "33:         return methodToInterceptor.get(endpoint);",
          "34:     }",
          "35: }",
          "",
          "---------------"
        ],
        "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java||extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java": [
          "File: extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java -> extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/security/HttpSecurityRecorder.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: import io.quarkus.security.StringPermission;",
          "36: import io.quarkus.security.identity.SecurityIdentity;",
          "37: import io.quarkus.security.identity.request.AnonymousAuthenticationRequest;",
          "38: import io.quarkus.vertx.http.runtime.FormAuthConfig;",
          "39: import io.quarkus.vertx.http.runtime.HttpBuildTimeConfig;",
          "40: import io.quarkus.vertx.http.runtime.HttpConfiguration;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38: import io.quarkus.security.spi.runtime.MethodDescription;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "223:         return new SupplierImpl<>(new RolesAllowedHttpSecurityPolicy(rolesAllowed, roleToPermissions));",
          "224:     }",
          "226:     private static Map<String, Set<Permission>> createPermissions(Map<String, List<String>> roleToPermissions,",
          "227:             BiFunction<String, String[], Permission> permissionCreator) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "227:     public Supplier<EagerSecurityInterceptorStorage> createSecurityInterceptorStorage(",
          "228:             Map<RuntimeValue<MethodDescription>, Consumer<RoutingContext>> endpointRuntimeValToInterceptor) {",
          "230:         final Map<MethodDescription, Consumer<RoutingContext>> endpointToInterceptor = new HashMap<>();",
          "231:         for (var entry : endpointRuntimeValToInterceptor.entrySet()) {",
          "232:             endpointToInterceptor.put(entry.getKey().getValue(), entry.getValue());",
          "233:         }",
          "235:         return new Supplier<EagerSecurityInterceptorStorage>() {",
          "236:             @Override",
          "237:             public EagerSecurityInterceptorStorage get() {",
          "238:                 return new EagerSecurityInterceptorStorage(endpointToInterceptor);",
          "239:             }",
          "240:         };",
          "241:     }",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java": [
          "File: integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java -> integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrInterceptor.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java": [
          "File: integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java -> integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/HrTenant.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java": [
          "File: integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java -> integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEcho2Resource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.it.keycloak;",
          "3: import jakarta.inject.Inject;",
          "4: import jakarta.ws.rs.GET;",
          "5: import jakarta.ws.rs.Path;",
          "6: import jakarta.ws.rs.Produces;",
          "7: import jakarta.ws.rs.core.MediaType;",
          "9: import io.quarkus.oidc.Tenant;",
          "10: import io.quarkus.oidc.runtime.OidcUtils;",
          "11: import io.quarkus.security.Authenticated;",
          "12: import io.quarkus.security.identity.SecurityIdentity;",
          "13: import io.vertx.ext.web.RoutingContext;",
          "15: @Authenticated",
          "16: @Path(\"/api/tenant-echo2\")",
          "17: public class TenantEcho2Resource {",
          "19:     @Inject",
          "20:     RoutingContext routingContext;",
          "22:     @Inject",
          "23:     SecurityIdentity identity;",
          "25:     @Path(\"/hr\")",
          "26:     @Tenant(\"hr\")",
          "27:     @GET",
          "28:     @Produces(MediaType.TEXT_PLAIN)",
          "29:     public String getHrTenant() {",
          "30:         return getTenant();",
          "31:     }",
          "33:     @Path(\"/default\")",
          "34:     @GET",
          "35:     @Produces(MediaType.TEXT_PLAIN)",
          "36:     public String getDefaultTenant() {",
          "37:         return getTenant();",
          "38:     }",
          "40:     private String getTenant() {",
          "41:         return OidcUtils.TENANT_ID_ATTRIBUTE + \"=\" + routingContext.get(OidcUtils.TENANT_ID_ATTRIBUTE)",
          "42:                 + \", static.tenant.id=\" + routingContext.get(\"static.tenant.id\")",
          "43:                 + \", name=\" + identity.getPrincipal().getName();",
          "44:     }",
          "45: }",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java||integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java": [
          "File: integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java -> integration-tests/oidc-wiremock/src/main/java/io/quarkus/it/keycloak/TenantEchoResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: import jakarta.ws.rs.Produces;",
          "7: import jakarta.ws.rs.core.MediaType;",
          "9: import io.quarkus.oidc.runtime.OidcUtils;",
          "10: import io.quarkus.security.Authenticated;",
          "11: import io.quarkus.security.identity.SecurityIdentity;",
          "12: import io.vertx.ext.web.RoutingContext;",
          "15: @Authenticated",
          "16: @Path(\"/api/tenant-echo\")",
          "17: public class TenantEchoResource {",
          "",
          "[Removed Lines]",
          "14: @HrTenant",
          "",
          "[Added Lines]",
          "9: import io.quarkus.oidc.Tenant;",
          "15: @Tenant(\"hr\")",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java||integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java": [
          "File: integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java -> integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/AnnotationBasedTenantTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:     }",
          "32:     @Test",
          "35:         WiremockTestResource server = new WiremockTestResource();",
          "36:         server.start();",
          "",
          "[Removed Lines]",
          "33:     public void test() {",
          "",
          "[Added Lines]",
          "33:     public void testClassLevelAnnotation() {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "56:             server.stop();",
          "57:         }",
          "58:     }",
          "59: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60:     @Test",
          "61:     public void testMethodLevelAnnotation() {",
          "63:         WiremockTestResource server = new WiremockTestResource();",
          "64:         server.start();",
          "65:         try {",
          "68:             String token = OidcWiremockTestResource.getAccessToken(\"alice\", new HashSet<>(Arrays.asList(\"user\", \"admin\")));",
          "69:             RestAssured.given().auth().oauth2(token)",
          "70:                     .when().get(\"/api/tenant-echo2/hr\")",
          "71:                     .then().statusCode(401);",
          "73:             token = Jwt.preferredUserName(\"alice\")",
          "74:                     .audience(\"http://hr.service\")",
          "75:                     .jws()",
          "76:                     .keyId(\"1\")",
          "77:                     .sign(\"privateKey.jwk\");",
          "79:             RestAssured.given().auth().oauth2(token)",
          "80:                     .when().get(\"/api/tenant-echo2/hr\")",
          "81:                     .then().statusCode(200)",
          "82:                     .body(Matchers.equalTo((\"tenant-id=hr, static.tenant.id=hr, name=alice\")));",
          "85:             token = OidcWiremockTestResource.getAccessToken(\"alice\", new HashSet<>(Arrays.asList(\"user\", \"admin\")));",
          "87:             RestAssured.given().auth().oauth2(token)",
          "88:                     .when().get(\"/api/tenant-echo2/default\")",
          "89:                     .then().statusCode(200)",
          "90:                     .body(Matchers.equalTo((\"tenant-id=null, static.tenant.id=null, name=alice\")));",
          "91:         } finally {",
          "92:             server.stop();",
          "93:         }",
          "94:     }",
          "",
          "---------------"
        ],
        "integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java||integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java": [
          "File: integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java -> integration-tests/oidc-wiremock/src/test/java/io/quarkus/it/keycloak/CodeFlowAuthorizationTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: import org.junit.jupiter.api.Test;",
          "27: import com.gargoylesoftware.htmlunit.SilentCssErrorHandler;",
          "28: import com.gargoylesoftware.htmlunit.WebClient;",
          "29: import com.gargoylesoftware.htmlunit.WebRequest;",
          "30: import com.gargoylesoftware.htmlunit.WebResponse;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "28: import com.gargoylesoftware.htmlunit.TextPage;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "73:             form.getInputByName(\"username\").type(\"alice\");",
          "74:             form.getInputByName(\"password\").type(\"alice\");",
          "79:             assertNotNull(getSessionCookie(webClient, \"code-flow\"));",
          "83:             assertNull(getSessionCookie(webClient, \"code-flow\"));",
          "85:             webClient.getCookieManager().clearCookies();",
          "",
          "[Removed Lines]",
          "76:             page = form.getInputByValue(\"login\").click();",
          "78:             assertEquals(\"alice, cache size: 0\", page.getBody().asNormalizedText());",
          "81:             page = webClient.getPage(\"http://localhost:8081/code-flow/logout\");",
          "82:             assertEquals(\"Welcome, clientId: quarkus-web-app\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "77:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "79:             assertEquals(\"alice, cache size: 0\", textPage.getContent());",
          "82:             textPage = webClient.getPage(\"http://localhost:8081/code-flow/logout\");",
          "83:             assertEquals(\"Welcome, clientId: quarkus-web-app\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "105:             form.getInputByName(\"username\").type(\"alice\");",
          "106:             form.getInputByName(\"password\").type(\"alice\");",
          "111:             Cookie sessionCookie = getSessionCookie(webClient, tenant);",
          "112:             assertNotNull(sessionCookie);",
          "114:             assertTrue(OidcUtils.isEncryptedToken(sessionCookie.getValue().split(\"\\\\|\")[0]));",
          "120:             webClient.getCookieManager().clearCookies();",
          "121:         }",
          "",
          "[Removed Lines]",
          "108:             page = form.getInputByValue(\"login\").click();",
          "110:             assertEquals(\"user: alice\", page.getBody().asNormalizedText());",
          "117:             page = webClient.getPage(\"http://localhost:8081/code-flow-encrypted-id-token/\" + tenant);",
          "118:             assertEquals(\"user: alice\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "109:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "111:             assertEquals(\"user: alice\", textPage.getContent());",
          "118:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-encrypted-id-token/\" + tenant);",
          "119:             assertEquals(\"user: alice\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "132:             form.getInputByName(\"username\").type(\"alice\");",
          "133:             form.getInputByName(\"password\").type(\"alice\");",
          "139:             assertNotNull(getSessionCookie(webClient, \"code-flow-form-post\"));",
          "145:             assertNotNull(getSessionCookie(webClient, \"code-flow-form-post\"));",
          "",
          "[Removed Lines]",
          "135:             page = form.getInputByValue(\"login\").click();",
          "137:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "141:             page = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "142:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "136:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "138:             assertEquals(\"alice\", textPage.getContent());",
          "142:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "143:             assertEquals(\"alice\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "154:                     .statusCode(200);",
          "160:             assertNotNull(getSessionCookie(webClient, \"code-flow-form-post\"));",
          "",
          "[Removed Lines]",
          "157:             page = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "158:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "158:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "159:             assertEquals(\"alice\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "190:             form.getInputByName(\"username\").type(\"alice\");",
          "191:             form.getInputByName(\"password\").type(\"alice\");",
          "197:             assertNotNull(getSessionCookie(webClient, \"code-flow-form-post\"));",
          "203:             JsonObject idTokenClaims = decryptIdToken(webClient, \"code-flow-form-post\");",
          "",
          "[Removed Lines]",
          "193:             page = form.getInputByValue(\"login\").click();",
          "195:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "199:             page = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "200:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "194:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "196:             assertEquals(\"alice\", textPage.getContent());",
          "200:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-form-post\");",
          "201:             assertEquals(\"alice\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "251:             form.getInputByName(\"username\").type(\"alice\");",
          "252:             form.getInputByName(\"password\").type(\"alice\");",
          "259:             Thread.sleep(3000);",
          "263:             webClient.getCookieManager().clearCookies();",
          "264:         }",
          "",
          "[Removed Lines]",
          "254:             page = form.getInputByValue(\"login\").click();",
          "256:             assertEquals(\"alice\", page.getBody().asNormalizedText());",
          "260:             page = webClient.getPage(\"http://localhost:8081/code-flow-token-introspection\");",
          "261:             assertEquals(\"admin\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "255:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "257:             assertEquals(\"alice\", textPage.getContent());",
          "261:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-token-introspection\");",
          "262:             assertEquals(\"admin\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "273:             form.getInputByName(\"username\").type(\"alice\");",
          "274:             form.getInputByName(\"password\").type(\"alice\");",
          "284:             wireMockServer.verify(1, getRequestedFor(urlPathMatching(\"/auth/realms/quarkus/protocol/openid-connect/userinfo\")));",
          "285:             wireMockServer.resetRequests();",
          "",
          "[Removed Lines]",
          "276:             page = form.getInputByValue(\"login\").click();",
          "278:             assertEquals(\"alice:alice:alice, cache size: 1\", page.getBody().asNormalizedText());",
          "279:             page = webClient.getPage(\"http://localhost:8081/\" + tenantId);",
          "280:             assertEquals(\"alice:alice:alice, cache size: 1\", page.getBody().asNormalizedText());",
          "281:             page = webClient.getPage(\"http://localhost:8081/\" + tenantId);",
          "282:             assertEquals(\"alice:alice:alice, cache size: 1\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "277:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "279:             assertEquals(\"alice:alice:alice, cache size: 1\", textPage.getContent());",
          "280:             textPage = webClient.getPage(\"http://localhost:8081/\" + tenantId);",
          "281:             assertEquals(\"alice:alice:alice, cache size: 1\", textPage.getContent());",
          "282:             textPage = webClient.getPage(\"http://localhost:8081/\" + tenantId);",
          "283:             assertEquals(\"alice:alice:alice, cache size: 1\", textPage.getContent());",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "324:             form.getInputByName(\"username\").type(\"alice\");",
          "325:             form.getInputByName(\"password\").type(\"alice\");",
          "331:             JsonObject idTokenClaims = decryptIdToken(webClient, \"code-flow-user-info-github-cached-in-idtoken\");",
          "332:             assertNotNull(idTokenClaims.getJsonObject(OidcUtils.USER_INFO_ATTRIBUTE));",
          "335:             Thread.sleep(3000);",
          "339:             webClient.getCookieManager().clearCookies();",
          "340:         }",
          "",
          "[Removed Lines]",
          "327:             page = form.getInputByValue(\"login\").click();",
          "329:             assertEquals(\"alice:alice:alice, cache size: 0\", page.getBody().asNormalizedText());",
          "336:             page = webClient.getPage(\"http://localhost:8081/code-flow-user-info-github-cached-in-idtoken\");",
          "337:             assertEquals(\"alice:alice:bob, cache size: 0\", page.getBody().asNormalizedText());",
          "",
          "[Added Lines]",
          "328:             TextPage textPage = form.getInputByValue(\"login\").click();",
          "330:             assertEquals(\"alice:alice:alice, cache size: 0\", textPage.getContent());",
          "337:             textPage = webClient.getPage(\"http://localhost:8081/code-flow-user-info-github-cached-in-idtoken\");",
          "338:             assertEquals(\"alice:alice:bob, cache size: 0\", textPage.getContent());",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dd065b6cecb0e496dcf6b63be87de1f30032a288",
      "candidate_info": {
        "commit_hash": "dd065b6cecb0e496dcf6b63be87de1f30032a288",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/dd065b6cecb0e496dcf6b63be87de1f30032a288",
        "files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ],
        "message": "[2.13] Perform security checks eagerly in RR on inherited endpoints",
        "before_after_code_files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ],
          "candidate": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ]
        }
      },
      "candidate_diff": {
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedJaxRsTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:     static QuarkusUnitTest runner = new QuarkusUnitTest()",
          "18:             .withApplicationRoot((jar) -> jar",
          "19:                     .addClasses(PermitAllResource.class, UnsecuredResource.class,",
          "22:                             UnsecuredSubResource.class)",
          "23:                     .addAsResource(new StringAsset(\"quarkus.security.jaxrs.default-roles-allowed=admin\\n\"),",
          "24:                             \"application.properties\"));",
          "",
          "[Removed Lines]",
          "20:                             TestIdentityProvider.class,",
          "21:                             TestIdentityController.class,",
          "",
          "[Added Lines]",
          "20:                             TestIdentityProvider.class, UnsecuredParentResource.class,",
          "21:                             TestIdentityController.class, UnsecuredResourceInterface.class,",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DefaultRolesAllowedStarJaxRsTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:     static QuarkusUnitTest runner = new QuarkusUnitTest()",
          "18:             .withApplicationRoot((jar) -> jar",
          "19:                     .addClasses(PermitAllResource.class, UnsecuredResource.class,",
          "22:                             UnsecuredSubResource.class)",
          "23:                     .addAsResource(new StringAsset(\"quarkus.security.jaxrs.default-roles-allowed = **\\n\"),",
          "24:                             \"application.properties\"));",
          "",
          "[Removed Lines]",
          "20:                             TestIdentityProvider.class,",
          "21:                             TestIdentityController.class,",
          "",
          "[Added Lines]",
          "20:                             TestIdentityProvider.class, UnsecuredResourceInterface.class,",
          "21:                             TestIdentityController.class, UnsecuredParentResource.class,",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "20:     static QuarkusUnitTest runner = new QuarkusUnitTest()",
          "21:             .withApplicationRoot((jar) -> jar",
          "22:                     .addClasses(PermitAllResource.class, UnsecuredResource.class,",
          "26:                     .addAsResource(new StringAsset(\"quarkus.security.jaxrs.deny-unannotated-endpoints = true\\n\"),",
          "27:                             \"application.properties\"));",
          "",
          "[Removed Lines]",
          "23:                             TestIdentityProvider.class,",
          "24:                             TestIdentityController.class,",
          "25:                             UnsecuredSubResource.class)",
          "",
          "[Added Lines]",
          "23:                             TestIdentityProvider.class, TestIdentityController.class, UnsecuredSubResource.class,",
          "24:                             UnsecuredParentResource.class, UnsecuredResourceInterface.class)",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/RolesAllowedJaxRsTestCase.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import static org.hamcrest.Matchers.is;",
          "5: import java.io.IOException;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import static io.restassured.RestAssured.given;",
          "4: import static io.restassured.RestAssured.when;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14: import javax.ws.rs.ext.MessageBodyReader;",
          "15: import javax.ws.rs.ext.Provider;",
          "17: import org.junit.jupiter.api.Assertions;",
          "18: import org.junit.jupiter.api.BeforeAll;",
          "19: import org.junit.jupiter.api.Test;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19: import org.hamcrest.Matchers;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "31:                     .addClasses(RolesAllowedResource.class, UserResource.class, RolesAllowedBlockingResource.class,",
          "32:                             SerializationEntity.class, SerializationRolesResource.class, TestIdentityProvider.class,",
          "33:                             TestIdentityController.class, UnsecuredSubResource.class, RolesAllowedService.class,",
          "36:     @BeforeAll",
          "37:     public static void setupUsers() {",
          "",
          "[Removed Lines]",
          "34:                             RolesAllowedServiceResource.class));",
          "",
          "[Added Lines]",
          "37:                             RolesAllowedServiceResource.class, UnsecuredResource.class, UnsecuredParentResource.class,",
          "38:                             UnsecuredResourceInterface.class));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "90:         Assertions.assertFalse(read);",
          "91:     }",
          "93:     static volatile boolean read = false;",
          "95:     @Provider",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "97:     @Test",
          "98:     public void shouldAllowAnnotatedParentEndpoint() {",
          "100:         String path = \"/unsecured/parent-annotated\";",
          "101:         assertStatus(path, 200, 200, 401);",
          "102:     }",
          "104:     @Test",
          "105:     public void shouldAllowAnnotatedEndpointOnInterface() {",
          "107:         String path = \"/unsecured/interface-annotated\";",
          "108:         assertStatus(path, 200, 200, 401);",
          "109:     }",
          "111:     @Test",
          "112:     public void shouldDenyUnannotatedOverriddenOnInterfaceImplementor() {",
          "114:         String path = \"/unsecured/interface-overridden-declared-on-implementor\";",
          "115:         assertStatus(path, 200, 200, 200);",
          "116:     }",
          "118:     @Test",
          "119:     public void shouldAllowAnnotatedOverriddenEndpointDeclaredOnInterface() {",
          "121:         String path = \"/unsecured/interface-overridden-declared-on-interface\";",
          "122:         assertStatus(path, 200, 200, 401);",
          "124:         given().auth().preemptive()",
          "125:                 .basic(\"admin\", \"admin\").get(path)",
          "126:                 .then()",
          "127:                 .body(Matchers.is(\"implementor-response\"));",
          "128:     }",
          "130:     private void assertStatus(String path, int adminStatus, int userStatus, int anonStatus) {",
          "131:         given().auth().preemptive()",
          "132:                 .basic(\"admin\", \"admin\").get(path)",
          "133:                 .then()",
          "134:                 .statusCode(adminStatus);",
          "135:         given().auth().preemptive()",
          "136:                 .basic(\"user\", \"user\").get(path)",
          "137:                 .then()",
          "138:                 .statusCode(userStatus);",
          "139:         when().get(path)",
          "140:                 .then()",
          "141:                 .statusCode(anonStatus);",
          "142:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import javax.annotation.security.RolesAllowed;",
          "4: import javax.ws.rs.GET;",
          "5: import javax.ws.rs.Path;",
          "7: public class UnsecuredParentResource {",
          "9:     @Path(\"/defaultSecurityParent\")",
          "10:     @GET",
          "11:     public String defaultSecurityParent() {",
          "12:         return \"defaultSecurityParent\";",
          "13:     }",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/parent-annotated\")",
          "18:     public String parentAnnotated() {",
          "19:         return \"parent-annotated\";",
          "20:     }",
          "22: }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: @Path(\"/unsecured\")",
          "15:     @Path(\"/defaultSecurity\")",
          "16:     @GET",
          "17:     public String defaultSecurity() {",
          "",
          "[Removed Lines]",
          "14: public class UnsecuredResource {",
          "",
          "[Added Lines]",
          "14: public class UnsecuredResource extends UnsecuredParentResource implements UnsecuredResourceInterface {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "49:     public UnsecuredSubResource permitAllSub() {",
          "50:         return new UnsecuredSubResource();",
          "51:     }",
          "52: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "53:     @Override",
          "54:     public String interfaceOverriddenDeclaredOnInterface() {",
          "55:         return \"implementor-response\";",
          "56:     }",
          "58:     @GET",
          "59:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "60:     @Override",
          "61:     public String interfaceOverriddenDeclaredOnImplementor() {",
          "62:         return \"implementor-response\";",
          "63:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import javax.annotation.security.RolesAllowed;",
          "4: import javax.ws.rs.GET;",
          "5: import javax.ws.rs.Path;",
          "7: public interface UnsecuredResourceInterface {",
          "9:     @Path(\"/defaultSecurityInterface\")",
          "10:     @GET",
          "11:     default String defaultSecurityInterface() {",
          "12:         return \"defaultSecurityInterface\";",
          "13:     }",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/interface-annotated\")",
          "18:     default String interfaceAnnotated() {",
          "19:         return \"interface-annotated\";",
          "20:     }",
          "22:     @RolesAllowed({ \"admin\", \"user\" })",
          "23:     @GET",
          "24:     @Path(\"/interface-overridden-declared-on-interface\")",
          "25:     default String interfaceOverriddenDeclaredOnInterface() {",
          "27:         return \"interface-overridden-declared-on-interface\";",
          "28:     }",
          "30:     @RolesAllowed({ \"admin\", \"user\" })",
          "31:     @GET",
          "32:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "33:     default String interfaceOverriddenDeclaredOnImplementor() {",
          "35:         return \"interface-overridden-declared-on-implementor\";",
          "36:     }",
          "38: }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityHandler.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "56:         }",
          "57:         SecurityCheck check = this.check;",
          "58:         ResteasyReactiveResourceInfo lazyMethod = requestContext.getTarget().getLazyMethod();",
          "60:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
          "61:         if (check == null) {",
          "62:             check = Arc.container().instance(SecurityCheckStorage.class).get().getSecurityCheck(methodDescription);",
          "",
          "[Removed Lines]",
          "59:         MethodDescription methodDescription = new MethodDescription(lazyMethod.getResourceClass().getName(),",
          "",
          "[Added Lines]",
          "59:         MethodDescription methodDescription = new MethodDescription(lazyMethod.getActualDeclaringClassName(),",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java": [
          "File: independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java -> independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "168:             }",
          "169:         }",
          "170:         serverResourceMethod.setHandlerChainCustomizers(methodCustomizers);",
          "171:         return serverResourceMethod;",
          "172:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "171:         serverResourceMethod.setActualDeclaringClassName(methodInfo.declaringClass().name().toString());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "183:         ResteasyReactiveResourceInfo lazyMethod = new ResteasyReactiveResourceInfo(method.getName(), resourceClass,",
          "184:                 parameterDeclaredUnresolvedTypes, classAnnotationNames, method.getMethodAnnotationNames(),",
          "187:         RuntimeInterceptorDeployment.MethodInterceptorContext interceptorDeployment = runtimeInterceptorDeployment",
          "188:                 .forMethod(method, lazyMethod);",
          "",
          "[Removed Lines]",
          "185:                 !defaultBlocking && !method.isBlocking());",
          "",
          "[Added Lines]",
          "185:                 !defaultBlocking && !method.isBlocking(), method.getActualDeclaringClassName());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     private List<HandlerChainCustomizer> handlerChainCustomizers = new ArrayList<>();",
          "20:     private ParameterExtractor customerParameterExtractor;",
          "22:     public ServerResourceMethod() {",
          "23:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21:     private String actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69:         this.customerParameterExtractor = customerParameterExtractor;",
          "70:         return this;",
          "71:     }",
          "72: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "74:     public String getActualDeclaringClassName() {",
          "75:         return actualDeclaringClassName;",
          "76:     }",
          "78:     public void setActualDeclaringClassName(String actualDeclaringClassName) {",
          "79:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "80:     }",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:     public final boolean isNonBlocking;",
          "30:     private volatile Annotation[] classAnnotations;",
          "31:     private volatile Method method;",
          "32:     private volatile Annotation[] annotations;",
          "33:     private volatile Type returnType;",
          "34:     private volatile String methodId;",
          "36:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "37:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking) {",
          "38:         this.name = name;",
          "39:         this.declaringClass = declaringClass;",
          "40:         this.parameterTypes = parameterTypes;",
          "41:         this.classAnnotationNames = classAnnotationNames;",
          "42:         this.methodAnnotationNames = methodAnnotationNames;",
          "43:         this.isNonBlocking = isNonBlocking;",
          "44:     }",
          "46:     public String getName() {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:     private final String actualDeclaringClassName;",
          "39:     @Deprecated",
          "42:         this(name, declaringClass, parameterTypes, classAnnotationNames, methodAnnotationNames, isNonBlocking,",
          "43:                 declaringClass.getName());",
          "44:     }",
          "46:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "47:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking,",
          "48:             String actualDeclaringClassName) {",
          "55:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "119:         }",
          "120:         return methodId;",
          "121:     }",
          "122: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "135:     public String getActualDeclaringClassName() {",
          "136:         return actualDeclaringClassName;",
          "137:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "29eb4516b5b429004765c3d7c4ac23885a36a05a",
      "candidate_info": {
        "commit_hash": "29eb4516b5b429004765c3d7c4ac23885a36a05a",
        "repo": "quarkusio/quarkus",
        "commit_url": "https://github.com/quarkusio/quarkus/commit/29eb4516b5b429004765c3d7c4ac23885a36a05a",
        "files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ],
        "message": "Perform security checks eagerly in RR on inherited endpoints",
        "before_after_code_files": [
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java",
          "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ],
          "candidate": [
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
            "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
            "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
            "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java"
          ]
        }
      },
      "candidate_diff": {
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/DenyAllJaxRsTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "91:         assertStatus(path, 403, 401);",
          "92:     }",
          "94:     @Test",
          "95:     public void shouldDenyUnannotatedOnInterface() {",
          "96:         String path = \"/unsecured/defaultSecurityInterface\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "94:     @Test",
          "95:     public void shouldAllowAnnotatedParentEndpoint() {",
          "97:         String path = \"/unsecured/parent-annotated\";",
          "98:         assertStatus(path, 200, 401);",
          "99:     }",
          "101:     @Test",
          "102:     public void shouldAllowAnnotatedEndpointOnInterface() {",
          "104:         String path = \"/unsecured/interface-annotated\";",
          "105:         assertStatus(path, 200, 401);",
          "106:     }",
          "108:     @Test",
          "109:     public void shouldDenyUnannotatedOverriddenOnInterfaceImplementor() {",
          "111:         String path = \"/unsecured/interface-overridden-declared-on-implementor\";",
          "112:         assertStatus(path, 403, 401);",
          "113:     }",
          "115:     @Test",
          "116:     public void shouldAllowAnnotatedOverriddenEndpointDeclaredOnInterface() {",
          "118:         String path = \"/unsecured/interface-overridden-declared-on-interface\";",
          "119:         assertStatus(path, 200, 401);",
          "121:         given().auth().preemptive()",
          "122:                 .basic(\"admin\", \"admin\").get(path)",
          "123:                 .then()",
          "124:                 .body(Matchers.is(\"implementor-response\"));",
          "125:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredParentResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import jakarta.ws.rs.GET;",
          "4: import jakarta.ws.rs.Path;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import jakarta.annotation.security.RolesAllowed;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11:         return \"defaultSecurityParent\";",
          "12:     }",
          "14: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/parent-annotated\")",
          "18:     public String parentAnnotated() {",
          "19:         return \"parent-annotated\";",
          "20:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResource.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:     public UnsecuredSubResource permitAllSub() {",
          "58:         return new UnsecuredSubResource();",
          "59:     }",
          "60: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61:     @Override",
          "62:     public String interfaceOverriddenDeclaredOnInterface() {",
          "63:         return \"implementor-response\";",
          "64:     }",
          "66:     @GET",
          "67:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "68:     @Override",
          "69:     public String interfaceOverriddenDeclaredOnImplementor() {",
          "70:         return \"implementor-response\";",
          "71:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/deployment/src/test/java/io/quarkus/resteasy/reactive/server/test/security/UnsecuredResourceInterface.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: package io.quarkus.resteasy.reactive.server.test.security;",
          "3: import jakarta.ws.rs.GET;",
          "4: import jakarta.ws.rs.Path;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: import jakarta.annotation.security.RolesAllowed;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11:         return \"defaultSecurityInterface\";",
          "12:     }",
          "14: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15:     @RolesAllowed({ \"admin\", \"user\" })",
          "16:     @GET",
          "17:     @Path(\"/interface-annotated\")",
          "18:     default String interfaceAnnotated() {",
          "19:         return \"interface-annotated\";",
          "20:     }",
          "22:     @RolesAllowed({ \"admin\", \"user\" })",
          "23:     @GET",
          "24:     @Path(\"/interface-overridden-declared-on-interface\")",
          "25:     default String interfaceOverriddenDeclaredOnInterface() {",
          "27:         return \"interface-overridden-declared-on-interface\";",
          "28:     }",
          "30:     @RolesAllowed({ \"admin\", \"user\" })",
          "31:     @GET",
          "32:     @Path(\"/interface-overridden-declared-on-implementor\")",
          "33:     default String interfaceOverriddenDeclaredOnImplementor() {",
          "35:         return \"interface-overridden-declared-on-implementor\";",
          "36:     }",
          "",
          "---------------"
        ],
        "extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java||extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java": [
          "File: extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java -> extensions/resteasy-reactive/quarkus-resteasy-reactive/runtime/src/main/java/io/quarkus/resteasy/reactive/server/runtime/security/EagerSecurityContext.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "171:     }",
          "173:     static MethodDescription lazyMethodToMethodDescription(ResteasyReactiveResourceInfo lazyMethod) {",
          "175:                 lazyMethod.getName(), MethodDescription.typesAsStrings(lazyMethod.getParameterTypes()));",
          "176:     }",
          "177: }",
          "",
          "[Removed Lines]",
          "174:         return new MethodDescription(lazyMethod.getResourceClass().getName(),",
          "",
          "[Added Lines]",
          "174:         return new MethodDescription(lazyMethod.getActualDeclaringClassName(),",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java||independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java": [
          "File: independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java -> independent-projects/resteasy-reactive/server/processor/src/main/java/org/jboss/resteasy/reactive/server/processor/ServerEndpointIndexer.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "183:             }",
          "184:         }",
          "185:         serverResourceMethod.setHandlerChainCustomizers(methodCustomizers);",
          "186:         return serverResourceMethod;",
          "187:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "186:         serverResourceMethod.setActualDeclaringClassName(methodInfo.declaringClass().name().toString());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/core/startup/RuntimeResourceDeployment.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "190:         ResteasyReactiveResourceInfo lazyMethod = new ResteasyReactiveResourceInfo(method.getName(), resourceClass,",
          "191:                 parameterDeclaredUnresolvedTypes, classAnnotationNames, method.getMethodAnnotationNames(),",
          "194:         RuntimeInterceptorDeployment.MethodInterceptorContext interceptorDeployment = runtimeInterceptorDeployment",
          "195:                 .forMethod(method, lazyMethod);",
          "",
          "[Removed Lines]",
          "192:                 !defaultBlocking && !method.isBlocking());",
          "",
          "[Added Lines]",
          "192:                 !defaultBlocking && !method.isBlocking(), method.getActualDeclaringClassName());",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/model/ServerResourceMethod.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     private List<HandlerChainCustomizer> handlerChainCustomizers = new ArrayList<>();",
          "20:     private ParameterExtractor customerParameterExtractor;",
          "22:     public ServerResourceMethod() {",
          "23:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21:     private String actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "70:         this.customerParameterExtractor = customerParameterExtractor;",
          "71:         return this;",
          "72:     }",
          "73: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75:     public String getActualDeclaringClassName() {",
          "76:         return actualDeclaringClassName;",
          "77:     }",
          "79:     public void setActualDeclaringClassName(String actualDeclaringClassName) {",
          "80:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "81:     }",
          "",
          "---------------"
        ],
        "independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java||independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java": [
          "File: independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java -> independent-projects/resteasy-reactive/server/runtime/src/main/java/org/jboss/resteasy/reactive/server/spi/ResteasyReactiveResourceInfo.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:     public final boolean isNonBlocking;",
          "30:     private volatile Annotation[] classAnnotations;",
          "31:     private volatile Method method;",
          "32:     private volatile Annotation[] annotations;",
          "33:     private volatile Type returnType;",
          "34:     private volatile String methodId;",
          "36:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "37:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking) {",
          "38:         this.name = name;",
          "39:         this.declaringClass = declaringClass;",
          "40:         this.parameterTypes = parameterTypes;",
          "41:         this.classAnnotationNames = classAnnotationNames;",
          "42:         this.methodAnnotationNames = methodAnnotationNames;",
          "43:         this.isNonBlocking = isNonBlocking;",
          "44:     }",
          "46:     public String getName() {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:     private final String actualDeclaringClassName;",
          "39:     @Deprecated",
          "42:         this(name, declaringClass, parameterTypes, classAnnotationNames, methodAnnotationNames, isNonBlocking,",
          "43:                 declaringClass.getName());",
          "44:     }",
          "46:     public ResteasyReactiveResourceInfo(String name, Class<?> declaringClass, Class[] parameterTypes,",
          "47:             Set<String> classAnnotationNames, Set<String> methodAnnotationNames, boolean isNonBlocking,",
          "48:             String actualDeclaringClassName) {",
          "55:         this.actualDeclaringClassName = actualDeclaringClassName;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "119:         }",
          "120:         return methodId;",
          "121:     }",
          "122: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "135:     public String getActualDeclaringClassName() {",
          "136:         return actualDeclaringClassName;",
          "137:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}