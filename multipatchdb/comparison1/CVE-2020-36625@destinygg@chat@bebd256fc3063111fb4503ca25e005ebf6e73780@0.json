{
  "cve_id": "CVE-2020-36625",
  "cve_desc": "A vulnerability was found in destiny.gg chat. It has been rated as problematic. This issue affects the function websocket.Upgrader of the file main.go. The manipulation leads to cross-site request forgery. The attack may be initiated remotely. The name of the patch is bebd256fc3063111fb4503ca25e005ebf6e73780. It is recommended to apply a patch to fix this issue. The identifier VDB-216521 was assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
  "repo": "destinygg/chat",
  "patch_hash": "bebd256fc3063111fb4503ca25e005ebf6e73780",
  "patch_info": {
    "commit_hash": "bebd256fc3063111fb4503ca25e005ebf6e73780",
    "repo": "destinygg/chat",
    "commit_url": "https://github.com/destinygg/chat/commit/bebd256fc3063111fb4503ca25e005ebf6e73780",
    "files": [
      "main.go"
    ],
    "message": "Merge pull request #35 from 11k/fix-origin-check\n\nFix WebSocket upgrade CSRF vulnerability",
    "before_after_code_files": [
      "main.go||main.go"
    ]
  },
  "patch_diff": {
    "main.go||main.go": [
      "File: main.go -> main.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "37: var upgrader = websocket.Upgrader{",
      "38:  ReadBufferSize:  1024,",
      "39:  WriteBufferSize: 1024,",
      "41: }",
      "43: const (",
      "",
      "[Removed Lines]",
      "40:  CheckOrigin:     func(r *http.Request) bool { return true },",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d6214082744ce73c90022046b3e60d5e0bbcfaf7",
      "candidate_info": {
        "commit_hash": "d6214082744ce73c90022046b3e60d5e0bbcfaf7",
        "repo": "destinygg/chat",
        "commit_url": "https://github.com/destinygg/chat/commit/d6214082744ce73c90022046b3e60d5e0bbcfaf7",
        "files": [
          "main.go"
        ],
        "message": "Use default `CheckOrigin` implementation\n\nIf `CheckOrigin` is undefined, a \"safe default\" is used.",
        "before_after_code_files": [
          "main.go||main.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/destinygg/chat/pull/35"
        ],
        "olp_code_files": {
          "patch": [
            "main.go||main.go"
          ],
          "candidate": [
            "main.go||main.go"
          ]
        }
      },
      "candidate_diff": {
        "main.go||main.go": [
          "File: main.go -> main.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "37: var upgrader = websocket.Upgrader{",
          "38:  ReadBufferSize:  1024,",
          "39:  WriteBufferSize: 1024,",
          "41: }",
          "43: const (",
          "",
          "[Removed Lines]",
          "40:  CheckOrigin:     func(r *http.Request) bool { return true },",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}