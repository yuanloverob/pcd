{
  "cve_id": "CVE-2024-12393",
  "cve_desc": "Improper Neutralization of Input During Web Page Generation (XSS or 'Cross-site Scripting') vulnerability in Drupal Core allows Cross-Site Scripting (XSS).This issue affects Drupal Core: from 8.8.0 before 10.2.11, from 10.3.0 before 10.3.9, from 11.0.0 before 11.0.8.",
  "repo": "drupal/core",
  "patch_hash": "276ac67ad891605052e0a24fb36ece9caaa511e8",
  "patch_info": {
    "commit_hash": "276ac67ad891605052e0a24fb36ece9caaa511e8",
    "repo": "drupal/core",
    "commit_url": "https://github.com/drupal/core/commit/276ac67ad891605052e0a24fb36ece9caaa511e8",
    "files": [
      "lib/Drupal/Core/Ajax/MessageCommand.php"
    ],
    "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
    "before_after_code_files": [
      "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
    ]
  },
  "patch_diff": {
    "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
      "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: namespace Drupal\\Core\\Ajax;",
      "5: use Drupal\\Core\\Asset\\AttachedAssets;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5: use Drupal\\Component\\Render\\MarkupInterface;",
      "6: use Drupal\\Component\\Utility\\Xss;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "120:   public function render() {",
      "121:     return [",
      "122:       'command' => 'message',",
      "124:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
      "125:       'messageOptions' => $this->options,",
      "126:       'clearPrevious' => $this->clearPrevious,",
      "",
      "[Removed Lines]",
      "123:       'message' => $this->message,",
      "",
      "[Added Lines]",
      "125:       'message' => $this->message instanceof MarkupInterface",
      "126:         ? (string) $this->message",
      "127:         : Xss::filterAdmin($this->message),",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8e2a47d9f1a46bd050db53144057dbff3cdeb86a",
      "candidate_info": {
        "commit_hash": "8e2a47d9f1a46bd050db53144057dbff3cdeb86a",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/8e2a47d9f1a46bd050db53144057dbff3cdeb86a",
        "files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php"
        ],
        "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
        "before_after_code_files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ],
          "candidate": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
          "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Drupal\\Core\\Ajax;",
          "5: use Drupal\\Core\\Asset\\AttachedAssets;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use Drupal\\Component\\Render\\MarkupInterface;",
          "6: use Drupal\\Component\\Utility\\Xss;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:   public function render() {",
          "121:     return [",
          "122:       'command' => 'message',",
          "124:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
          "125:       'messageOptions' => $this->options,",
          "126:       'clearPrevious' => $this->clearPrevious,",
          "",
          "[Removed Lines]",
          "123:       'message' => $this->message,",
          "",
          "[Added Lines]",
          "125:       'message' => $this->message instanceof MarkupInterface",
          "126:         ? (string) $this->message",
          "127:         : Xss::filterAdmin($this->message),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "af82dad646cd5d4ef662e053bf3f772af19b6815",
      "candidate_info": {
        "commit_hash": "af82dad646cd5d4ef662e053bf3f772af19b6815",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/af82dad646cd5d4ef662e053bf3f772af19b6815",
        "files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php"
        ],
        "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
        "before_after_code_files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ],
          "candidate": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
          "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Drupal\\Core\\Ajax;",
          "5: use Drupal\\Core\\Asset\\AttachedAssets;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use Drupal\\Component\\Render\\MarkupInterface;",
          "6: use Drupal\\Component\\Utility\\Xss;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:   public function render() {",
          "121:     return [",
          "122:       'command' => 'message',",
          "124:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
          "125:       'messageOptions' => $this->options,",
          "126:       'clearPrevious' => $this->clearPrevious,",
          "",
          "[Removed Lines]",
          "123:       'message' => $this->message,",
          "",
          "[Added Lines]",
          "125:       'message' => $this->message instanceof MarkupInterface",
          "126:         ? (string) $this->message",
          "127:         : Xss::filterAdmin($this->message),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "043151351f5b8511eb6ec10f3d325e0d29763821",
      "candidate_info": {
        "commit_hash": "043151351f5b8511eb6ec10f3d325e0d29763821",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/043151351f5b8511eb6ec10f3d325e0d29763821",
        "files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php"
        ],
        "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
        "before_after_code_files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ],
          "candidate": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
          "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Drupal\\Core\\Ajax;",
          "5: use Drupal\\Core\\Asset\\AttachedAssets;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use Drupal\\Component\\Render\\MarkupInterface;",
          "6: use Drupal\\Component\\Utility\\Xss;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:   public function render() {",
          "121:     return [",
          "122:       'command' => 'message',",
          "124:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
          "125:       'messageOptions' => $this->options,",
          "126:       'clearPrevious' => $this->clearPrevious,",
          "",
          "[Removed Lines]",
          "123:       'message' => $this->message,",
          "",
          "[Added Lines]",
          "125:       'message' => $this->message instanceof MarkupInterface",
          "126:         ? (string) $this->message",
          "127:         : Xss::filterAdmin($this->message),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9aba4d3fc0227c9864e4df9626f0dca943be5685",
      "candidate_info": {
        "commit_hash": "9aba4d3fc0227c9864e4df9626f0dca943be5685",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/9aba4d3fc0227c9864e4df9626f0dca943be5685",
        "files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php"
        ],
        "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
        "before_after_code_files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ],
          "candidate": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
          "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Drupal\\Core\\Ajax;",
          "5: use Drupal\\Core\\Asset\\AttachedAssets;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use Drupal\\Component\\Render\\MarkupInterface;",
          "6: use Drupal\\Component\\Utility\\Xss;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:   public function render() {",
          "121:     return [",
          "122:       'command' => 'message',",
          "124:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
          "125:       'messageOptions' => $this->options,",
          "126:       'clearPrevious' => $this->clearPrevious,",
          "",
          "[Removed Lines]",
          "123:       'message' => $this->message,",
          "",
          "[Added Lines]",
          "125:       'message' => $this->message instanceof MarkupInterface",
          "126:         ? (string) $this->message",
          "127:         : Xss::filterAdmin($this->message),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "95c6fa49857e650b6bf5f8796f936324cdba0593",
      "candidate_info": {
        "commit_hash": "95c6fa49857e650b6bf5f8796f936324cdba0593",
        "repo": "drupal/core",
        "commit_url": "https://github.com/drupal/core/commit/95c6fa49857e650b6bf5f8796f936324cdba0593",
        "files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php"
        ],
        "message": "SA-CORE-2024-003 by jrb, larowlan, catch, mingsong, poker10, longwave, benjifisher",
        "before_after_code_files": [
          "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ],
          "candidate": [
            "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/Drupal/Core/Ajax/MessageCommand.php||lib/Drupal/Core/Ajax/MessageCommand.php": [
          "File: lib/Drupal/Core/Ajax/MessageCommand.php -> lib/Drupal/Core/Ajax/MessageCommand.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: namespace Drupal\\Core\\Ajax;",
          "5: use Drupal\\Core\\Asset\\AttachedAssets;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: use Drupal\\Component\\Render\\MarkupInterface;",
          "6: use Drupal\\Component\\Utility\\Xss;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "82:   public function render() {",
          "83:     return [",
          "84:       'command' => 'message',",
          "86:       'messageWrapperQuerySelector' => $this->wrapperQuerySelector,",
          "87:       'messageOptions' => $this->options,",
          "88:       'clearPrevious' => $this->clearPrevious,",
          "",
          "[Removed Lines]",
          "85:       'message' => $this->message,",
          "",
          "[Added Lines]",
          "87:       'message' => $this->message instanceof MarkupInterface",
          "88:         ? (string) $this->message",
          "89:         : Xss::filterAdmin($this->message),",
          "",
          "---------------"
        ]
      }
    }
  ]
}