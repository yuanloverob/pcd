{
  "cve_id": "CVE-2022-0198",
  "cve_desc": "corenlp is vulnerable to Improper Restriction of XML External Entity Reference",
  "repo": "stanfordnlp/corenlp",
  "patch_hash": "1f52136321cfca68b991bd7870563d06cf96624d",
  "patch_info": {
    "commit_hash": "1f52136321cfca68b991bd7870563d06cf96624d",
    "repo": "stanfordnlp/corenlp",
    "commit_url": "https://github.com/stanfordnlp/corenlp/commit/1f52136321cfca68b991bd7870563d06cf96624d",
    "files": [
      "src/edu/stanford/nlp/process/TransformXML.java"
    ],
    "message": "Fix SAXParser security issue",
    "before_after_code_files": [
      "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java"
    ]
  },
  "patch_diff": {
    "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java": [
      "File: src/edu/stanford/nlp/process/TransformXML.java -> src/edu/stanford/nlp/process/TransformXML.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: import java.io.*;",
      "6: import java.util.*;",
      "8: import javax.xml.parsers.SAXParser;",
      "9: import javax.xml.parsers.SAXParserFactory;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: import javax.xml.XMLConstants;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "196:   public TransformXML() {",
      "197:     try {",
      "198:       saxParser = SAXParserFactory.newInstance().newSAXParser();",
      "199:     } catch (Exception e) {",
      "200:       log.info(\"Error configuring XML parser: \" + e);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "199:       SAXParserFactory spf = SAXParserFactory.newInstance();",
      "200:       spf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "820192ce1ad1062057cf6abcb359cd635988bf63",
      "candidate_info": {
        "commit_hash": "820192ce1ad1062057cf6abcb359cd635988bf63",
        "repo": "stanfordnlp/corenlp",
        "commit_url": "https://github.com/stanfordnlp/corenlp/commit/820192ce1ad1062057cf6abcb359cd635988bf63",
        "files": [
          "src/edu/stanford/nlp/process/TransformXML.java"
        ],
        "message": "Fix SAXParser security issue",
        "before_after_code_files": [
          "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java"
          ],
          "candidate": [
            "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java"
          ]
        }
      },
      "candidate_diff": {
        "src/edu/stanford/nlp/process/TransformXML.java||src/edu/stanford/nlp/process/TransformXML.java": [
          "File: src/edu/stanford/nlp/process/TransformXML.java -> src/edu/stanford/nlp/process/TransformXML.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: import java.io.*;",
          "6: import java.util.*;",
          "8: import javax.xml.parsers.SAXParser;",
          "9: import javax.xml.parsers.SAXParserFactory;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: import javax.xml.XMLConstants;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "196:   public TransformXML() {",
          "197:     try {",
          "199:     } catch (Exception e) {",
          "200:       log.info(\"Error configuring XML parser: \" + e);",
          "201:       throw new RuntimeException(e);",
          "",
          "[Removed Lines]",
          "198:       saxParser = SAXParserFactory.newInstance().newSAXParser();",
          "",
          "[Added Lines]",
          "199:       SAXParserFactory spf = SAXParserFactory.newInstance();",
          "200:       spf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);",
          "201:       saxParser = spf.newSAXParser();",
          "",
          "---------------"
        ]
      }
    }
  ]
}