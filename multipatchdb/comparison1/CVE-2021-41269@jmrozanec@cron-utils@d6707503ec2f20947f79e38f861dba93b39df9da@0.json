{
  "cve_id": "CVE-2021-41269",
  "cve_desc": "cron-utils is a Java library to define, parse, validate, migrate crons as well as get human readable descriptions for them. In affected versions A template Injection was identified in cron-utils enabling attackers to inject arbitrary Java EL expressions, leading to unauthenticated Remote Code Execution (RCE) vulnerability. Versions up to 9.1.2 are susceptible to this vulnerability. Please note, that only projects using the @Cron annotation to validate untrusted Cron expressions are affected. The issue was patched and a new version was released. Please upgrade to version 9.1.6. There are no known workarounds known.",
  "repo": "jmrozanec/cron-utils",
  "patch_hash": "d6707503ec2f20947f79e38f861dba93b39df9da",
  "patch_info": {
    "commit_hash": "d6707503ec2f20947f79e38f861dba93b39df9da",
    "repo": "jmrozanec/cron-utils",
    "commit_url": "https://github.com/jmrozanec/cron-utils/commit/d6707503ec2f20947f79e38f861dba93b39df9da",
    "files": [
      "src/main/java/com/cronutils/validation/CronValidator.java"
    ],
    "message": "Merge pull request #493 from pwntester/patch-1\n\nPrevent arbitrary EL expression evaluation",
    "before_after_code_files": [
      "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
    ]
  },
  "patch_diff": {
    "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java": [
      "File: src/main/java/com/cronutils/validation/CronValidator.java -> src/main/java/com/cronutils/validation/CronValidator.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "30:             return true;",
      "31:         } catch (IllegalArgumentException e) {",
      "32:             context.disableDefaultConstraintViolation();",
      "34:             return false;",
      "35:         }",
      "36:     }",
      "",
      "[Removed Lines]",
      "33:             context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation();",
      "",
      "[Added Lines]",
      "33:             context.buildConstraintViolationWithTemplate(\"Error parsing the Cron expression\").addConstraintViolation();",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d7c6e3cd8c8c7732330b00c01fc881845b4a6fbe",
      "candidate_info": {
        "commit_hash": "d7c6e3cd8c8c7732330b00c01fc881845b4a6fbe",
        "repo": "jmrozanec/cron-utils",
        "commit_url": "https://github.com/jmrozanec/cron-utils/commit/d7c6e3cd8c8c7732330b00c01fc881845b4a6fbe",
        "files": [
          "src/main/java/com/cronutils/validation/CronValidator.java"
        ],
        "message": "Update CronValidator.java",
        "before_after_code_files": [
          "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jmrozanec/cron-utils/pull/493"
        ],
        "olp_code_files": {
          "patch": [
            "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
          ],
          "candidate": [
            "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java": [
          "File: src/main/java/com/cronutils/validation/CronValidator.java -> src/main/java/com/cronutils/validation/CronValidator.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:             return true;",
          "31:         } catch (IllegalArgumentException e) {",
          "32:             context.disableDefaultConstraintViolation();",
          "34:             return false;",
          "35:         }",
          "36:     }",
          "",
          "[Removed Lines]",
          "33:             context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation();",
          "",
          "[Added Lines]",
          "33:             context.buildConstraintViolationWithTemplate(\"Error parsing the Cron expression\").addConstraintViolation();",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "528fcae628b8d893d7c5acf5ae5efcb0610bb5b3",
      "candidate_info": {
        "commit_hash": "528fcae628b8d893d7c5acf5ae5efcb0610bb5b3",
        "repo": "jmrozanec/cron-utils",
        "commit_url": "https://github.com/jmrozanec/cron-utils/commit/528fcae628b8d893d7c5acf5ae5efcb0610bb5b3",
        "files": [
          "src/main/java/com/cronutils/validation/CronValidator.java",
          "src/test/java/com/cronutils/converter/CronConverterTest.java"
        ],
        "message": "Issue #493: update code towards one of the proposed solutions.",
        "before_after_code_files": [
          "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java",
          "src/test/java/com/cronutils/converter/CronConverterTest.java||src/test/java/com/cronutils/converter/CronConverterTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
          ],
          "candidate": [
            "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/com/cronutils/validation/CronValidator.java||src/main/java/com/cronutils/validation/CronValidator.java": [
          "File: src/main/java/com/cronutils/validation/CronValidator.java -> src/main/java/com/cronutils/validation/CronValidator.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:             return true;",
          "31:         } catch (IllegalArgumentException e) {",
          "32:             context.disableDefaultConstraintViolation();",
          "34:             return false;",
          "35:         }",
          "36:     }",
          "",
          "[Removed Lines]",
          "33:             context.buildConstraintViolationWithTemplate(\"Error parsing the Cron expression\").addConstraintViolation();",
          "",
          "[Added Lines]",
          "33:             context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation();",
          "",
          "---------------"
        ],
        "src/test/java/com/cronutils/converter/CronConverterTest.java||src/test/java/com/cronutils/converter/CronConverterTest.java": [
          "File: src/test/java/com/cronutils/converter/CronConverterTest.java -> src/test/java/com/cronutils/converter/CronConverterTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: package com.cronutils.converter;",
          "16: import org.junit.Assert;",
          "17: import org.junit.Test;",
          "18: import org.junit.runner.RunWith;",
          "19: import org.junit.runners.Parameterized;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17: import org.junit.Ignore;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "54:  }",
          "56:  @Test",
          "57:  public void testCronConverterBuilder() {",
          "58:   Assert.assertEquals(expectedCronExpression,",
          "59:     cronConverter.using(inputCronExpression)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "58:  @Ignore //TODO: fix",
          "",
          "---------------"
        ]
      }
    }
  ]
}