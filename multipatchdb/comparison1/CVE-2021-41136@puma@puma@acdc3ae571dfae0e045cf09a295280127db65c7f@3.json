{
  "cve_id": "CVE-2021-41136",
  "cve_desc": "Puma is a HTTP 1.1 server for Ruby/Rack applications. Prior to versions 5.5.1 and 4.3.9, using `puma` with a proxy which forwards HTTP header values which contain the LF character could allow HTTP request smugggling. A client could smuggle a request through a proxy, causing the proxy to send a response back to another unknown client. The only proxy which has this behavior, as far as the Puma team is aware of, is Apache Traffic Server. If the proxy uses persistent connections and the client adds another request in via HTTP pipelining, the proxy may mistake it as the first request's body. Puma, however, would see it as two requests, and when processing the second request, send back a response that the proxy does not expect. If the proxy has reused the persistent connection to Puma to send another request for a different client, the second response from the first client will be sent to the second client. This vulnerability was patched in Puma 5.5.1 and 4.3.9. As a workaround, do not use Apache Traffic Server with `puma`.",
  "repo": "puma/puma",
  "patch_hash": "acdc3ae571dfae0e045cf09a295280127db65c7f",
  "patch_info": {
    "commit_hash": "acdc3ae571dfae0e045cf09a295280127db65c7f",
    "repo": "puma/puma",
    "commit_url": "https://github.com/puma/puma/commit/acdc3ae571dfae0e045cf09a295280127db65c7f",
    "files": [
      "History.md",
      "ext/puma_http11/http11_parser.c",
      "ext/puma_http11/http11_parser_common.rl",
      "ext/puma_http11/org/jruby/puma/Http11Parser.java",
      "lib/puma/const.rb",
      "test/test_http11.rb"
    ],
    "message": "Merge pull request from GHSA-48w2-rm65-62xx\n\n* Fix HTTP request smuggling vulnerability\n\nSee GHSA-48w2-rm65-62xx or CVE-2021-41136 for more info.\n\n* 4.3.9 release note\n\n* 5.5.1 release note\n\n* 5.5.1",
    "before_after_code_files": [
      "ext/puma_http11/http11_parser.c||ext/puma_http11/http11_parser.c",
      "ext/puma_http11/http11_parser_common.rl||ext/puma_http11/http11_parser_common.rl",
      "ext/puma_http11/org/jruby/puma/Http11Parser.java||ext/puma_http11/org/jruby/puma/Http11Parser.java",
      "lib/puma/const.rb||lib/puma/const.rb",
      "test/test_http11.rb||test/test_http11.rb"
    ]
  },
  "patch_diff": {
    "ext/puma_http11/http11_parser.c||ext/puma_http11/http11_parser.c": [
      "File: ext/puma_http11/http11_parser.c -> ext/puma_http11/http11_parser.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "426: case 18:",
      "427: #line 428 \"ext/puma_http11/http11_parser.c\"",
      "428:  switch( (*p) ) {",
      "429:   case 13: goto tr26;",
      "430:   case 32: goto tr27;",
      "431:  }",
      "433: tr25:",
      "434: #line 46 \"ext/puma_http11/http11_parser.rl\"",
      "435:  { MARK(mark, p); }",
      "",
      "[Removed Lines]",
      "432:  goto tr25;",
      "",
      "[Added Lines]",
      "429:   case 9: goto tr25;",
      "433:  if ( 33 <= (*p) && (*p) <= 126 )",
      "434:   goto tr25;",
      "435:  goto st0;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "438:  if ( ++p == pe )",
      "439:   goto _test_eof19;",
      "440: case 19:",
      "445: tr9:",
      "446: #line 53 \"ext/puma_http11/http11_parser.rl\"",
      "447:  {",
      "",
      "[Removed Lines]",
      "441: #line 442 \"ext/puma_http11/http11_parser.c\"",
      "442:  if ( (*p) == 13 )",
      "443:   goto tr29;",
      "444:  goto st19;",
      "",
      "[Added Lines]",
      "444: #line 445 \"ext/puma_http11/http11_parser.c\"",
      "445:  switch( (*p) ) {",
      "446:   case 9: goto st19;",
      "447:   case 13: goto tr29;",
      "448:  }",
      "449:  if ( 32 <= (*p) && (*p) <= 126 )",
      "450:   goto st19;",
      "451:  goto st0;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "484:  if ( ++p == pe )",
      "485:   goto _test_eof20;",
      "486: case 20:",
      "488:  switch( (*p) ) {",
      "489:   case 32: goto tr31;",
      "490:   case 60: goto st0;",
      "",
      "[Removed Lines]",
      "487: #line 488 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "494: #line 495 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "505:  if ( ++p == pe )",
      "506:   goto _test_eof21;",
      "507: case 21:",
      "509:  switch( (*p) ) {",
      "510:   case 32: goto tr33;",
      "511:   case 60: goto st0;",
      "",
      "[Removed Lines]",
      "508: #line 509 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "515: #line 516 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "526:  if ( ++p == pe )",
      "527:   goto _test_eof22;",
      "528: case 22:",
      "530:  switch( (*p) ) {",
      "531:   case 43: goto st22;",
      "532:   case 58: goto st23;",
      "",
      "[Removed Lines]",
      "529: #line 530 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "536: #line 537 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "551:  if ( ++p == pe )",
      "552:   goto _test_eof23;",
      "553: case 23:",
      "555:  switch( (*p) ) {",
      "556:   case 32: goto tr8;",
      "557:   case 34: goto st0;",
      "",
      "[Removed Lines]",
      "554: #line 555 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "561: #line 562 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "571:  if ( ++p == pe )",
      "572:   goto _test_eof24;",
      "573: case 24:",
      "575:  switch( (*p) ) {",
      "576:   case 32: goto tr37;",
      "577:   case 34: goto st0;",
      "",
      "[Removed Lines]",
      "574: #line 575 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "581: #line 582 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "594:  if ( ++p == pe )",
      "595:   goto _test_eof25;",
      "596: case 25:",
      "598:  switch( (*p) ) {",
      "599:   case 32: goto tr41;",
      "600:   case 34: goto st0;",
      "",
      "[Removed Lines]",
      "597: #line 598 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "604: #line 605 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "614:  if ( ++p == pe )",
      "615:   goto _test_eof26;",
      "616: case 26:",
      "618:  switch( (*p) ) {",
      "619:   case 32: goto tr44;",
      "620:   case 34: goto st0;",
      "",
      "[Removed Lines]",
      "617: #line 618 \"ext/puma_http11/http11_parser.c\"",
      "",
      "[Added Lines]",
      "624: #line 625 \"ext/puma_http11/http11_parser.c\"",
      "",
      "---------------"
    ],
    "ext/puma_http11/http11_parser_common.rl||ext/puma_http11/http11_parser_common.rl": [
      "File: ext/puma_http11/http11_parser_common.rl -> ext/puma_http11/http11_parser_common.rl",
      "--- Hunk 1 ---",
      "[Context before]",
      "44:   field_name = ( token -- \":\" )+ >start_field $snake_upcase_field %write_field;",
      "48:   message_header = field_name \":\" \" \"* field_value :> CRLF;",
      "",
      "[Removed Lines]",
      "46:   field_value = any* >start_value %write_value;",
      "",
      "[Added Lines]",
      "46:   field_value = ( print | \"\\t\" )* >start_value %write_value;",
      "",
      "---------------"
    ],
    "ext/puma_http11/org/jruby/puma/Http11Parser.java||ext/puma_http11/org/jruby/puma/Http11Parser.java": [
      "File: ext/puma_http11/org/jruby/puma/Http11Parser.java -> ext/puma_http11/org/jruby/puma/Http11Parser.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "34: {",
      "35:  return new short [] {",
      "36:      0,    0,    8,   17,   27,   29,   30,   31,   32,   33,   34,   36,",
      "40:  };",
      "41: }",
      "",
      "[Removed Lines]",
      "37:     39,   41,   44,   45,   61,   62,   78,   80,   81,   89,   97,  107,",
      "38:    115,  124,  132,  140,  149,  158,  167,  176,  185,  194,  203,  212,",
      "39:    221,  230,  239,  248,  257,  266,  275,  284,  293,  302,  303",
      "",
      "[Added Lines]",
      "37:     39,   41,   44,   45,   61,   62,   78,   83,   87,   95,  103,  113,",
      "38:    121,  130,  138,  146,  155,  164,  173,  182,  191,  200,  209,  218,",
      "39:    227,  236,  245,  254,  263,  272,  281,  290,  299,  308,  309",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "52:     46,   48,   57,   48,   57,   13,   48,   57,   10,   13,   33,  124,",
      "53:    126,   35,   39,   42,   43,   45,   46,   48,   57,   65,   90,   94,",
      "54:    122,   10,   33,   58,  124,  126,   35,   39,   42,   43,   45,   46,",
      "63:     36,   95,   45,   46,   48,   57,   65,   90,   32,   36,   95,   45,",
      "64:     46,   48,   57,   65,   90,   32,   36,   95,   45,   46,   48,   57,",
      "65:     65,   90,   32,   36,   95,   45,   46,   48,   57,   65,   90,   32,",
      "",
      "[Removed Lines]",
      "55:     48,   57,   65,   90,   94,  122,   13,   32,   13,   32,   60,   62,",
      "56:    127,    0,   31,   34,   35,   32,   60,   62,  127,    0,   31,   34,",
      "57:     35,   43,   58,   45,   46,   48,   57,   65,   90,   97,  122,   32,",
      "58:     34,   35,   60,   62,  127,    0,   31,   32,   34,   35,   60,   62,",
      "59:     63,  127,    0,   31,   32,   34,   35,   60,   62,  127,    0,   31,",
      "60:     32,   34,   35,   60,   62,  127,    0,   31,   32,   36,   95,   45,",
      "61:     46,   48,   57,   65,   90,   32,   36,   95,   45,   46,   48,   57,",
      "62:     65,   90,   32,   36,   95,   45,   46,   48,   57,   65,   90,   32,",
      "",
      "[Added Lines]",
      "55:     48,   57,   65,   90,   94,  122,    9,   13,   32,   33,  126,    9,",
      "56:     13,   32,  126,   32,   60,   62,  127,    0,   31,   34,   35,   32,",
      "57:     60,   62,  127,    0,   31,   34,   35,   43,   58,   45,   46,   48,",
      "58:     57,   65,   90,   97,  122,   32,   34,   35,   60,   62,  127,    0,",
      "59:     31,   32,   34,   35,   60,   62,   63,  127,    0,   31,   32,   34,",
      "60:     35,   60,   62,  127,    0,   31,   32,   34,   35,   60,   62,  127,",
      "61:      0,   31,   32,   36,   95,   45,   46,   48,   57,   65,   90,   32,",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "71:     65,   90,   32,   36,   95,   45,   46,   48,   57,   65,   90,   32,",
      "72:     36,   95,   45,   46,   48,   57,   65,   90,   32,   36,   95,   45,",
      "73:     46,   48,   57,   65,   90,   32,   36,   95,   45,   46,   48,   57,",
      "75:  };",
      "76: }",
      "",
      "[Removed Lines]",
      "74:     65,   90,   32,    0",
      "",
      "[Added Lines]",
      "73:     65,   90,   32,   36,   95,   45,   46,   48,   57,   65,   90,   32,",
      "74:     36,   95,   45,   46,   48,   57,   65,   90,   32,    0",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "82: {",
      "83:  return new byte [] {",
      "84:      0,    2,    3,    4,    2,    1,    1,    1,    1,    1,    0,    1,",
      "86:      7,    6,    6,    3,    3,    3,    3,    3,    3,    3,    3,    3,",
      "87:      3,    3,    3,    3,    3,    3,    3,    3,    3,    1,    0",
      "88:  };",
      "",
      "[Removed Lines]",
      "85:      0,    1,    1,    4,    1,    4,    2,    1,    4,    4,    2,    6,",
      "",
      "[Added Lines]",
      "85:      0,    1,    1,    4,    1,    4,    3,    2,    4,    4,    2,    6,",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "95: {",
      "96:  return new byte [] {",
      "97:      0,    3,    3,    3,    0,    0,    0,    0,    0,    0,    1,    1,",
      "99:      1,    1,    1,    3,    3,    3,    3,    3,    3,    3,    3,    3,",
      "100:      3,    3,    3,    3,    3,    3,    3,    3,    3,    0,    0",
      "101:  };",
      "",
      "[Removed Lines]",
      "98:      1,    1,    0,    6,    0,    6,    0,    0,    2,    2,    4,    1,",
      "",
      "[Added Lines]",
      "98:      1,    1,    0,    6,    0,    6,    1,    1,    2,    2,    4,    1,",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "108: {",
      "109:  return new short [] {",
      "110:      0,    0,    6,   13,   21,   24,   26,   28,   30,   32,   34,   36,",
      "114:  };",
      "115: }",
      "",
      "[Removed Lines]",
      "111:     39,   41,   44,   46,   57,   59,   70,   73,   75,   82,   89,   96,",
      "112:    104,  113,  121,  129,  136,  143,  150,  157,  164,  171,  178,  185,",
      "113:    192,  199,  206,  213,  220,  227,  234,  241,  248,  255,  257",
      "",
      "[Added Lines]",
      "111:     39,   41,   44,   46,   57,   59,   70,   75,   79,   86,   93,  100,",
      "112:    108,  117,  125,  133,  140,  147,  154,  161,  168,  175,  182,  189,",
      "113:    196,  203,  210,  217,  224,  231,  238,  245,  252,  259,  261",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "125:     10,    1,   11,    1,   12,    1,   13,    1,   14,    1,   15,    1,",
      "126:     16,   15,    1,   17,    1,   18,   17,    1,   19,    1,   20,   21,",
      "127:     21,   21,   21,   21,   21,   21,   21,   21,    1,   22,    1,   23,",
      "145:  };",
      "146: }",
      "",
      "[Removed Lines]",
      "128:     24,   23,   23,   23,   23,   23,   23,   23,   23,    1,   26,   27,",
      "129:     25,   29,   28,   30,    1,    1,    1,    1,    1,   31,   32,    1,",
      "130:      1,    1,    1,    1,   33,   34,   35,   34,   34,   34,   34,    1,",
      "131:      8,    1,    9,    1,    1,    1,    1,   35,   36,    1,   38,    1,",
      "132:      1,   39,    1,    1,   37,   40,    1,   42,    1,    1,    1,    1,",
      "133:     41,   43,    1,   45,    1,    1,    1,    1,   44,    2,   46,   46,",
      "134:     46,   46,   46,    1,    2,   47,   47,   47,   47,   47,    1,    2,",
      "135:     48,   48,   48,   48,   48,    1,    2,   49,   49,   49,   49,   49,",
      "136:      1,    2,   50,   50,   50,   50,   50,    1,    2,   51,   51,   51,",
      "137:     51,   51,    1,    2,   52,   52,   52,   52,   52,    1,    2,   53,",
      "138:     53,   53,   53,   53,    1,    2,   54,   54,   54,   54,   54,    1,",
      "139:      2,   55,   55,   55,   55,   55,    1,    2,   56,   56,   56,   56,",
      "140:     56,    1,    2,   57,   57,   57,   57,   57,    1,    2,   58,   58,",
      "141:     58,   58,   58,    1,    2,   59,   59,   59,   59,   59,    1,    2,",
      "142:     60,   60,   60,   60,   60,    1,    2,   61,   61,   61,   61,   61,",
      "143:      1,    2,   62,   62,   62,   62,   62,    1,    2,   63,   63,   63,",
      "144:     63,   63,    1,    2,    1,    1,    0",
      "",
      "[Added Lines]",
      "128:     24,   23,   23,   23,   23,   23,   23,   23,   23,    1,   25,   26,",
      "129:     27,   25,    1,   28,   29,   28,    1,   30,    1,    1,    1,    1,",
      "130:      1,   31,   32,    1,    1,    1,    1,    1,   33,   34,   35,   34,",
      "131:     34,   34,   34,    1,    8,    1,    9,    1,    1,    1,    1,   35,",
      "132:     36,    1,   38,    1,    1,   39,    1,    1,   37,   40,    1,   42,",
      "133:      1,    1,    1,    1,   41,   43,    1,   45,    1,    1,    1,    1,",
      "134:     44,    2,   46,   46,   46,   46,   46,    1,    2,   47,   47,   47,",
      "135:     47,   47,    1,    2,   48,   48,   48,   48,   48,    1,    2,   49,",
      "136:     49,   49,   49,   49,    1,    2,   50,   50,   50,   50,   50,    1,",
      "137:      2,   51,   51,   51,   51,   51,    1,    2,   52,   52,   52,   52,",
      "138:     52,    1,    2,   53,   53,   53,   53,   53,    1,    2,   54,   54,",
      "139:     54,   54,   54,    1,    2,   55,   55,   55,   55,   55,    1,    2,",
      "140:     56,   56,   56,   56,   56,    1,    2,   57,   57,   57,   57,   57,",
      "141:      1,    2,   58,   58,   58,   58,   58,    1,    2,   59,   59,   59,",
      "142:     59,   59,    1,    2,   60,   60,   60,   60,   60,    1,    2,   61,",
      "143:     61,   61,   61,   61,    1,    2,   62,   62,   62,   62,   62,    1,",
      "144:      2,   63,   63,   63,   63,   63,    1,    2,    1,    1,    0",
      "",
      "---------------"
    ],
    "lib/puma/const.rb||lib/puma/const.rb": [
      "File: lib/puma/const.rb -> lib/puma/const.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "100:   # too taxing on performance.",
      "101:   module Const",
      "104:     CODE_NAME = \"Zawgyi\".freeze",
      "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
      "",
      "[Removed Lines]",
      "103:     PUMA_VERSION = VERSION = \"5.5.0\".freeze",
      "",
      "[Added Lines]",
      "103:     PUMA_VERSION = VERSION = \"5.5.1\".freeze",
      "",
      "---------------"
    ],
    "test/test_http11.rb||test/test_http11.rb": [
      "File: test/test_http11.rb -> test/test_http11.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "209:     assert_equal \"Strip This\", req[\"HTTP_X_STRIP_ME\"]",
      "210:   end",
      "211: end",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "212:   def test_newline_smuggler",
      "213:     parser = Puma::HttpParser.new",
      "214:     req = {}",
      "215:     http = \"GET / HTTP/1.1\\r\\nHost: localhost:8080\\r\\nDummy: x\\nDummy2: y\\r\\n\\r\\n\"",
      "217:     parser.execute(req, http, 0) rescue nil # We test the raise elsewhere.",
      "219:     assert parser.error?, \"Parser SHOULD have error\"",
      "220:   end",
      "222:   def test_newline_smuggler_two",
      "223:     parser = Puma::HttpParser.new",
      "224:     req = {}",
      "225:     http = \"GET / HTTP/1.1\\r\\nHost: localhost:8080\\r\\nDummy: x\\r\\nDummy: y\\nDummy2: z\\r\\n\\r\\n\"",
      "227:     parser.execute(req, http, 0) rescue nil",
      "229:     assert parser.error?, \"Parser SHOULD have error\"",
      "230:   end",
      "232:   def test_htab_in_header_val",
      "233:     parser = Puma::HttpParser.new",
      "234:     req = {}",
      "235:     http = \"GET / HTTP/1.1\\r\\nHost: localhost:8080\\r\\nDummy: Valid\\tValue\\r\\n\\r\\n\"",
      "237:     parser.execute(req, http, 0)",
      "239:     assert_equal \"Valid\\tValue\", req['HTTP_DUMMY']",
      "240:   end",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f4766ce46976ec623f163a0428515d157f53e420",
      "candidate_info": {
        "commit_hash": "f4766ce46976ec623f163a0428515d157f53e420",
        "repo": "puma/puma",
        "commit_url": "https://github.com/puma/puma/commit/f4766ce46976ec623f163a0428515d157f53e420",
        "files": [
          "History.md",
          "lib/puma/const.rb"
        ],
        "message": "5.3.2",
        "before_after_code_files": [
          "lib/puma/const.rb||lib/puma/const.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ],
          "candidate": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/puma/const.rb||lib/puma/const.rb": [
          "File: lib/puma/const.rb -> lib/puma/const.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:   # too taxing on performance.",
          "101:   module Const",
          "104:     CODE_NAME = \"Sweetnighter\".freeze",
          "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
          "",
          "[Removed Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.3.1\".freeze",
          "",
          "[Added Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.3.2\".freeze",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "adca7fc62ad933e34efb9c58eb32e3baa8a58771",
      "candidate_info": {
        "commit_hash": "adca7fc62ad933e34efb9c58eb32e3baa8a58771",
        "repo": "puma/puma",
        "commit_url": "https://github.com/puma/puma/commit/adca7fc62ad933e34efb9c58eb32e3baa8a58771",
        "files": [
          "lib/puma/const.rb"
        ],
        "message": "Master becoming 5.5.0 in prep for release",
        "before_after_code_files": [
          "lib/puma/const.rb||lib/puma/const.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ],
          "candidate": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/puma/const.rb||lib/puma/const.rb": [
          "File: lib/puma/const.rb -> lib/puma/const.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:   # too taxing on performance.",
          "101:   module Const",
          "104:     CODE_NAME = \"Zawgyi\".freeze",
          "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
          "",
          "[Removed Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.4.0\".freeze",
          "",
          "[Added Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.5.0\".freeze",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5a988f193b9da8ca5e79876adb25ec05df528ddf",
      "candidate_info": {
        "commit_hash": "5a988f193b9da8ca5e79876adb25ec05df528ddf",
        "repo": "puma/puma",
        "commit_url": "https://github.com/puma/puma/commit/5a988f193b9da8ca5e79876adb25ec05df528ddf",
        "files": [
          "lib/puma/const.rb"
        ],
        "message": "Bump version to 5.1.0 (#2491)",
        "before_after_code_files": [
          "lib/puma/const.rb||lib/puma/const.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ],
          "candidate": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/puma/const.rb||lib/puma/const.rb": [
          "File: lib/puma/const.rb -> lib/puma/const.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:   # too taxing on performance.",
          "101:   module Const",
          "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
          "",
          "[Removed Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.0.4\".freeze",
          "104:     CODE_NAME = \"Spoony Bard\".freeze",
          "",
          "[Added Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.1.0\".freeze",
          "104:     CODE_NAME = \"At Your Service\".freeze",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "30a8cc0ff2e27bd2a58eb2e193d16cd743b98d5f",
      "candidate_info": {
        "commit_hash": "30a8cc0ff2e27bd2a58eb2e193d16cd743b98d5f",
        "repo": "puma/puma",
        "commit_url": "https://github.com/puma/puma/commit/30a8cc0ff2e27bd2a58eb2e193d16cd743b98d5f",
        "files": [
          "lib/puma/const.rb"
        ],
        "message": "Bump version to 5.2.0 (#2537)",
        "before_after_code_files": [
          "lib/puma/const.rb||lib/puma/const.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ],
          "candidate": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/puma/const.rb||lib/puma/const.rb": [
          "File: lib/puma/const.rb -> lib/puma/const.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:   # too taxing on performance.",
          "101:   module Const",
          "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
          "",
          "[Removed Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.1.1\".freeze",
          "104:     CODE_NAME = \"At Your Service\".freeze",
          "",
          "[Added Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.2.0\".freeze",
          "104:     CODE_NAME = \"Fettisdagsbulle\".freeze",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1c91a4f1af23328118dbfe5b615f812af5e817ef",
      "candidate_info": {
        "commit_hash": "1c91a4f1af23328118dbfe5b615f812af5e817ef",
        "repo": "puma/puma",
        "commit_url": "https://github.com/puma/puma/commit/1c91a4f1af23328118dbfe5b615f812af5e817ef",
        "files": [
          "History.md",
          "lib/puma/const.rb"
        ],
        "message": "5.3.1",
        "before_after_code_files": [
          "lib/puma/const.rb||lib/puma/const.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ],
          "candidate": [
            "lib/puma/const.rb||lib/puma/const.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/puma/const.rb||lib/puma/const.rb": [
          "File: lib/puma/const.rb -> lib/puma/const.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:   # too taxing on performance.",
          "101:   module Const",
          "104:     CODE_NAME = \"Sweetnighter\".freeze",
          "106:     PUMA_SERVER_STRING = ['puma', PUMA_VERSION, CODE_NAME].join(' ').freeze",
          "",
          "[Removed Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.3.0\".freeze",
          "",
          "[Added Lines]",
          "103:     PUMA_VERSION = VERSION = \"5.3.1\".freeze",
          "",
          "---------------"
        ]
      }
    }
  ]
}