{
  "cve_id": "CVE-2018-16516",
  "cve_desc": "helpers.py in Flask-Admin 1.5.2 has Reflected XSS via a crafted URL.",
  "repo": "flask-admin/flask-admin",
  "patch_hash": "8af10e0b022464fdcb2da3d0ea5bbd2f11c0acd1",
  "patch_info": {
    "commit_hash": "8af10e0b022464fdcb2da3d0ea5bbd2f11c0acd1",
    "repo": "flask-admin/flask-admin",
    "commit_url": "https://github.com/flask-admin/flask-admin/commit/8af10e0b022464fdcb2da3d0ea5bbd2f11c0acd1",
    "files": [
      "flask_admin/helpers.py",
      "flask_admin/tests/test_helpers.py",
      ".travis.yml",
      "README.rst",
      "doc/_templates/sidebarintro.html",
      "doc/advanced.rst",
      "doc/api/index.rst",
      "doc/api/mod_contrib_sqla_fields.rst",
      "doc/changelog.rst",
      "doc/index.rst",
      "doc/introduction.rst",
      "examples/__init__.py",
      "examples/custom-layout/README.rst",
      "examples/custom-layout/__init__.py",
      "examples/custom-layout/app.py",
      "examples/custom-layout/requirements.txt",
      "examples/custom-layout/static/layout.css",
      "examples/custom-layout/templates/admin/index.html",
      "examples/custom-layout/templates/create.html",
      "examples/custom-layout/templates/edit.html",
      "examples/custom-layout/templates/layout.html",
      "examples/custom-layout/templates/list.html",
      "examples/file/README.rst",
      "examples/file/app.py",
      "examples/file/requirements.txt",
      "examples/forms-files-images/README.rst",
      "examples/forms-files-images/__init__.py",
      "examples/forms-files-images/app.py",
      "examples/forms-files-images/files/3d364b7a-7ccf-4a08-b362-a9d2a3b8cf05.jpg",
      "examples/forms-files-images/files/3d364b7a-7ccf-4a08-b362-a9d2a3b8cf05_thumb.jpg",
      "examples/forms-files-images/files/buffalo.jpg",
      "examples/forms-files-images/files/buffalo_thumb.jpg",
      "examples/forms-files-images/files/elephant.jpg",
      "examples/forms-files-images/files/elephant_thumb.jpg",
      "examples/forms-files-images/files/example_1.pdf",
      "examples/forms-files-images/files/example_2.pdf",
      "examples/forms-files-images/files/example_3.pdf",
      "examples/forms-files-images/files/leopard.jpg",
      "examples/forms-files-images/files/leopard_thumb.jpg",
      "examples/forms-files-images/files/lion.jpg",
      "examples/forms-files-images/files/lion_thumb.jpg",
      "examples/forms-files-images/files/rhino.jpg",
      "examples/forms-files-images/files/rhino_thumb.jpg",
      "examples/forms-files-images/requirements.txt",
      "examples/forms-files-images/templates/admin/index.html",
      "examples/forms-files-images/templates/create_page.html",
      "examples/forms-files-images/templates/create_user.html",
      "examples/forms-files-images/templates/edit_page.html",
      "examples/forms-files-images/templates/edit_user.html",
      "examples/forms-files-images/templates/macros.html",
      "examples/forms/README.rst",
      "examples/forms/__init__.py",
      "examples/forms/app.py",
      "examples/forms/files/buffalo.jpg",
      "examples/forms/files/buffalo_thumb.jpg",
      "examples/forms/files/elephant.jpg",
      "examples/forms/files/elephant_thumb.jpg",
      "examples/forms/files/example_1.pdf",
      "examples/forms/files/example_2.pdf",
      "examples/forms/files/example_3.pdf",
      "examples/forms/files/leopard.jpg",
      "examples/forms/files/leopard_thumb.jpg",
      "examples/forms/files/lion.jpg",
      "examples/forms/files/lion_thumb.jpg",
      "examples/forms/files/rhino.jpg",
      "examples/forms/files/rhino_thumb.jpg",
      "examples/forms/requirements.txt",
      "examples/forms/templates/admin/index.html",
      "examples/forms/templates/rule_create.html",
      "examples/forms/templates/rule_demo.html",
      "examples/forms/templates/rule_edit.html",
      "examples/geo_alchemy/config.py",
      "examples/layout/README.rst",
      "examples/layout/__init__.py",
      "examples/layout/app.py",
      "examples/layout/requirements.txt",
      "examples/layout/static/layout.css",
      "examples/layout/templates/admin/index.html",
      "examples/layout/templates/create.html",
      "examples/layout/templates/edit.html",
      "examples/layout/templates/layout.html",
      "examples/layout/templates/list.html",
      "examples/layout_bootstrap3/README.rst",
      "examples/layout_bootstrap3/__init__.py",
      "examples/layout_bootstrap3/app.py",
      "examples/layout_bootstrap3/requirements.txt",
      "examples/layout_bootstrap3/static/layout.css",
      "examples/layout_bootstrap3/templates/admin/index.html",
      "examples/layout_bootstrap3/templates/create.html",
      "examples/layout_bootstrap3/templates/edit.html",
      "examples/layout_bootstrap3/templates/layout.html",
      "examples/layout_bootstrap3/templates/list.html",
      "examples/menu-external-links/README.rst",
      "examples/menu-external-links/app.py",
      "examples/menu-external-links/requirements.txt",
      "examples/menu-external-links/templates/authenticated-admin.html",
      "examples/multi/README.rst",
      "examples/multi/app.py",
      "examples/multi/requirements.txt",
      "examples/multi/templates/first.html",
      "examples/multi/templates/second.html",
      "examples/multiple-admin-instances/README.rst",
      "examples/multiple-admin-instances/app.py",
      "examples/multiple-admin-instances/requirements.txt",
      "examples/multiple-admin-instances/templates/first.html",
      "examples/multiple-admin-instances/templates/second.html",
      "examples/quickstart/README.rst",
      "examples/quickstart/__init__.py",
      "examples/quickstart/app.py",
      "examples/quickstart/app2.py",
      "examples/quickstart/app3.py",
      "examples/quickstart/requirements.txt",
      "examples/quickstart/templates/index.html",
      "examples/rediscli/README.rst",
      "examples/rediscli/app.py",
      "examples/rediscli/requirements.txt",
      "examples/sqla-custom-filter/README.rst",
      "examples/sqla-custom-filter/__init__.py",
      "examples/sqla-custom-filter/app.py",
      "examples/sqla-custom-filter/requirements.txt",
      "examples/sqla-custom-inline-forms/README.rst",
      "examples/sqla-custom-inline-forms/app.py",
      "examples/sqla-custom-inline-forms/requirements.txt",
      "examples/sqla-custom-inline-forms/static/7b1468ff-019a-44d1-b4bb-729e5a252899.jpg",
      "examples/sqla-custom-inline-forms/templates/field_list.html",
      "examples/sqla-custom-inline-forms/templates/locations.html",
      "examples/sqla-filter-selectable/README.rst",
      "examples/sqla-filter-selectable/__init__.py",
      "examples/sqla-filter-selectable/app.py",
      "examples/sqla-filter-selectable/requirement.txt",
      "examples/sqla-hybrid_property/README.rst",
      "examples/sqla-hybrid_property/__init__.py",
      "examples/sqla-hybrid_property/app.py",
      "examples/sqla-hybrid_property/requirements.txt",
      "examples/sqla-inline/README.rst",
      "examples/sqla-inline/app.py",
      "examples/sqla-inline/requirements.txt",
      "examples/sqla-inline/templates/field_list.html",
      "examples/sqla-inline/templates/locations.html",
      "examples/sqla/README.rst",
      "examples/sqla/app.py",
      "examples/sqla/app2.py",
      "examples/sqla/requirements.txt",
      "examples/swatch/README.rst",
      "examples/swatch/__init__.py",
      "examples/swatch/app.py",
      "examples/swatch/files/buffalo.jpg",
      "examples/swatch/files/buffalo_thumb.jpg",
      "examples/swatch/files/elephant.jpg",
      "examples/swatch/files/elephant_thumb.jpg",
      "examples/swatch/files/example_1.pdf",
      "examples/swatch/files/example_2.pdf",
      "examples/swatch/files/example_3.pdf",
      "examples/swatch/files/leopard.jpg",
      "examples/swatch/files/leopard_thumb.jpg",
      "examples/swatch/files/lion.jpg",
      "examples/swatch/files/lion_thumb.jpg",
      "examples/swatch/files/rhino.jpg",
      "examples/swatch/files/rhino_thumb.jpg",
      "examples/swatch/requirements.txt",
      "examples/swatch/templates/admin/index.html",
      "examples/swatch/templates/rule_create.html",
      "examples/swatch/templates/rule_demo.html",
      "examples/swatch/templates/rule_edit.html",
      "examples/swatch3/README.rst",
      "examples/swatch3/__init__.py",
      "examples/swatch3/app.py",
      "examples/swatch3/files/buffalo.jpg",
      "examples/swatch3/files/buffalo_thumb.jpg",
      "examples/swatch3/files/elephant.jpg",
      "examples/swatch3/files/elephant_thumb.jpg",
      "examples/swatch3/files/example_1.pdf",
      "examples/swatch3/files/example_2.pdf",
      "examples/swatch3/files/example_3.pdf",
      "examples/swatch3/files/leopard.jpg",
      "examples/swatch3/files/leopard_thumb.jpg",
      "examples/swatch3/files/lion.jpg",
      "examples/swatch3/files/lion_thumb.jpg",
      "examples/swatch3/files/rhino.jpg",
      "examples/swatch3/files/rhino_thumb.jpg",
      "examples/swatch3/requirements.txt",
      "examples/swatch3/templates/admin/index.html",
      "examples/swatch3/templates/rule_create.html",
      "examples/swatch3/templates/rule_demo.html",
      "examples/swatch3/templates/rule_edit.html",
      "examples/wysiwyg/README.rst",
      "examples/wysiwyg/app.py",
      "examples/wysiwyg/requirements.txt",
      "examples/wysiwyg/templates/create.html",
      "examples/wysiwyg/templates/edit.html",
      "flask_admin/_backwards.py",
      "flask_admin/_compat.py",
      "flask_admin/base.py",
      "flask_admin/contrib/fileadmin/__init__.py",
      "flask_admin/contrib/fileadmin/azure.py",
      "flask_admin/contrib/fileadmin/s3.py",
      "flask_admin/contrib/mongoengine/ajax.py",
      "flask_admin/contrib/mongoengine/tools.py",
      "flask_admin/contrib/mongoengine/view.py",
      "flask_admin/contrib/mongoengine/widgets.py",
      "flask_admin/contrib/peewee/ajax.py",
      "flask_admin/contrib/peewee/view.py",
      "flask_admin/contrib/pymongo/view.py",
      "flask_admin/contrib/sqla/fields.py",
      "flask_admin/contrib/sqla/form.py",
      "flask_admin/contrib/sqla/view.py",
      "flask_admin/contrib/sqla/widgets.py",
      "flask_admin/form/upload.py",
      "flask_admin/menu.py",
      "flask_admin/model/base.py",
      "flask_admin/model/fields.py",
      "flask_admin/model/widgets.py",
      "flask_admin/static/admin/css/bootstrap3/submenu.css",
      "flask_admin/static/admin/js/actions.js",
      "flask_admin/static/admin/js/form.js",
      "flask_admin/static/vendor/leaflet/images/layers-2x.png",
      "flask_admin/static/vendor/leaflet/images/layers.png",
      "flask_admin/static/vendor/leaflet/images/marker-icon-2x.png",
      "flask_admin/static/vendor/leaflet/images/marker-icon.png",
      "flask_admin/static/vendor/leaflet/images/marker-shadow.png",
      "flask_admin/static/vendor/leaflet/images/spritesheet-2x.png",
      "flask_admin/static/vendor/leaflet/images/spritesheet.png",
      "flask_admin/static/vendor/leaflet/images/spritesheet.svg",
      "flask_admin/static/vendor/leaflet/leaflet.css",
      "flask_admin/static/vendor/leaflet/leaflet.draw.css",
      "flask_admin/static/vendor/leaflet/leaflet.draw.js",
      "flask_admin/static/vendor/leaflet/leaflet.js",
      "flask_admin/static/vendor/leaflet/leaflet.js.map",
      "flask_admin/templates/bootstrap2/admin/layout.html",
      "flask_admin/templates/bootstrap2/admin/lib.html",
      "flask_admin/templates/bootstrap2/admin/model/layout.html",
      "flask_admin/templates/bootstrap3/admin/base.html",
      "flask_admin/templates/bootstrap3/admin/layout.html",
      "flask_admin/templates/bootstrap3/admin/lib.html",
      "flask_admin/templates/bootstrap3/admin/model/layout.html",
      "flask_admin/templates/bootstrap3/admin/model/row_actions.html",
      "flask_admin/tests/fileadmin/test_fileadmin.py",
      "flask_admin/tests/fileadmin/test_fileadmin_azure.py",
      "flask_admin/tests/geoa/__init__.py",
      "flask_admin/tests/mongoengine/test_basic.py",
      "flask_admin/tests/peeweemodel/test_basic.py",
      "flask_admin/tests/sqla/__init__.py",
      "flask_admin/tests/sqla/test_basic.py",
      "flask_admin/translations/uk/LC_MESSAGES/admin.po",
      "flask_admin/translations/zh_Hant_TW/LC_MESSAGES/admin.mo",
      "flask_admin/translations/zh_Hant_TW/LC_MESSAGES/admin.po",
      "requirements-dev.txt",
      "setup.py",
      "tox.ini"
    ],
    "message": "Merge pull request #1699 from lbhsot/master\n\nrefs #1503 fix reflected xss",
    "before_after_code_files": [
      "flask_admin/helpers.py||flask_admin/helpers.py",
      "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
    ]
  },
  "patch_diff": {
    "flask_admin/helpers.py||flask_admin/helpers.py": [
      "File: flask_admin/helpers.py -> flask_admin/helpers.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: from jinja2 import contextfunction",
      "3: from flask import g, request, url_for, flash",
      "4: from wtforms.validators import DataRequired, InputRequired",
      "",
      "[Removed Lines]",
      "1: from re import sub",
      "",
      "[Added Lines]",
      "1: from re import sub, compile",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11: VALID_SCHEMES = ['http', 'https']",
      "14: def set_current_view(view):",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "12: _substitute_whitespace = compile(r'[\\s\\x00-\\x08\\x0B\\x0C\\x0E-\\x19]+').sub",
      "13: _fix_multiple_slashes = compile(r'(^([^/]+:)?//)/*').sub",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "133: def is_safe_url(target):",
      "134:     # prevent urls starting with \"javascript:\"",
      "136:     target_info = urlparse(target)",
      "137:     target_scheme = target_info.scheme",
      "138:     if target_scheme and target_scheme not in VALID_SCHEMES:",
      "",
      "[Removed Lines]",
      "135:     target = target.strip()",
      "",
      "[Added Lines]",
      "136:     # prevent urls like \"\\\\www.google.com\"",
      "137:     # some browser will change \\\\ to // (eg: Chrome)",
      "138:     # refs https://stackoverflow.com/questions/10438008",
      "139:     target = target.replace('\\\\', '/')",
      "141:     # handle cases like \"j a v a s c r i p t:\"",
      "142:     target = _substitute_whitespace('', target)",
      "144:     # Chrome and FireFox \"fix\" more than two slashes into two after protocol",
      "145:     target = _fix_multiple_slashes(lambda m: m.group(1), target, 1)",
      "",
      "---------------"
    ],
    "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py": [
      "File: flask_admin/tests/test_helpers.py -> flask_admin/tests/test_helpers.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:         assert helpers.is_safe_url('https://127.0.0.1/admin/car/')",
      "12:         assert helpers.is_safe_url('/admin/car/')",
      "13:         assert helpers.is_safe_url('admin/car/')",
      "15:         assert not helpers.is_safe_url('http://127.0.0.2/admin/car/')",
      "16:         assert not helpers.is_safe_url(' javascript:alert(document.domain)')",
      "17:         assert not helpers.is_safe_url('javascript:alert(document.domain)')",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14:         assert helpers.is_safe_url('http////www.google.com')",
      "19:         assert not helpers.is_safe_url('javascrip\\nt:alert(document.domain)')",
      "20:         assert not helpers.is_safe_url(r'\\\\www.google.com')",
      "21:         assert not helpers.is_safe_url(r'\\\\/www.google.com')",
      "22:         assert not helpers.is_safe_url('/////www.google.com')",
      "23:         assert not helpers.is_safe_url('http:///www.google.com')",
      "24:         assert not helpers.is_safe_url('https:////www.google.com')",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c35fddddeccfaefd106e717fd8bf65df332399df",
      "candidate_info": {
        "commit_hash": "c35fddddeccfaefd106e717fd8bf65df332399df",
        "repo": "flask-admin/flask-admin",
        "commit_url": "https://github.com/flask-admin/flask-admin/commit/c35fddddeccfaefd106e717fd8bf65df332399df",
        "files": [
          "flask_admin/helpers.py",
          "flask_admin/tests/test_helpers.py"
        ],
        "message": "Fix multiple slashes",
        "before_after_code_files": [
          "flask_admin/helpers.py||flask_admin/helpers.py",
          "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/pallets-eco/flask-admin/pull/1699"
        ],
        "olp_code_files": {
          "patch": [
            "flask_admin/helpers.py||flask_admin/helpers.py",
            "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
          ],
          "candidate": [
            "flask_admin/helpers.py||flask_admin/helpers.py",
            "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
          ]
        }
      },
      "candidate_diff": {
        "flask_admin/helpers.py||flask_admin/helpers.py": [
          "File: flask_admin/helpers.py -> flask_admin/helpers.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: VALID_SCHEMES = ['http', 'https']",
          "12: _substitute_whitespace = compile(r'[\\s\\x00-\\x08\\x0B\\x0C\\x0E-\\x19]+').sub",
          "15: def set_current_view(view):",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13: _fix_multiple_slashes = compile(r'(^([^/]+:)?//)/*').sub",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "137:     # refs https://stackoverflow.com/questions/10438008",
          "138:     target = target.replace('\\\\', '/')",
          "141:     target = _substitute_whitespace('', target)",
          "142:     target_info = urlparse(target)",
          "143:     target_scheme = target_info.scheme",
          "144:     if target_scheme and target_scheme not in VALID_SCHEMES:",
          "",
          "[Removed Lines]",
          "140:     # prevent urls starting with \"javascript:\"",
          "",
          "[Added Lines]",
          "141:     # handle cases like \"j a v a s c r i p t:\"",
          "144:     # Chrome and FireFox \"fix\" more than two slashes into two after protocol",
          "145:     target = _fix_multiple_slashes(lambda m: m.group(1), target, 1)",
          "147:     # prevent urls starting with \"javascript:\"",
          "",
          "---------------"
        ],
        "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py": [
          "File: flask_admin/tests/test_helpers.py -> flask_admin/tests/test_helpers.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "11:         assert helpers.is_safe_url('https://127.0.0.1/admin/car/')",
          "12:         assert helpers.is_safe_url('/admin/car/')",
          "13:         assert helpers.is_safe_url('admin/car/')",
          "15:         assert not helpers.is_safe_url('http://127.0.0.2/admin/car/')",
          "16:         assert not helpers.is_safe_url(' javascript:alert(document.domain)')",
          "17:         assert not helpers.is_safe_url('javascript:alert(document.domain)')",
          "18:         assert not helpers.is_safe_url('javascrip\\nt:alert(document.domain)')",
          "",
          "[Removed Lines]",
          "19:         assert not helpers.is_safe_url('\\\\\\\\www.google.com')",
          "",
          "[Added Lines]",
          "14:         assert helpers.is_safe_url('http////www.google.com')",
          "20:         assert not helpers.is_safe_url(r'\\\\www.google.com')",
          "21:         assert not helpers.is_safe_url(r'\\\\/www.google.com')",
          "22:         assert not helpers.is_safe_url('/////www.google.com')",
          "23:         assert not helpers.is_safe_url('http:///www.google.com')",
          "24:         assert not helpers.is_safe_url('https:////www.google.com')",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "75e51ebca2c4ef236854cfe88a237177813d39c1",
      "candidate_info": {
        "commit_hash": "75e51ebca2c4ef236854cfe88a237177813d39c1",
        "repo": "flask-admin/flask-admin",
        "commit_url": "https://github.com/flask-admin/flask-admin/commit/75e51ebca2c4ef236854cfe88a237177813d39c1",
        "files": [
          "flask_admin/helpers.py",
          "flask_admin/tests/test_helpers.py"
        ],
        "message": "refs #1503 fixed reflected xss & treat backslash in url",
        "before_after_code_files": [
          "flask_admin/helpers.py||flask_admin/helpers.py",
          "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/pallets-eco/flask-admin/pull/1699"
        ],
        "olp_code_files": {
          "patch": [
            "flask_admin/helpers.py||flask_admin/helpers.py",
            "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
          ],
          "candidate": [
            "flask_admin/helpers.py||flask_admin/helpers.py",
            "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py"
          ]
        }
      },
      "candidate_diff": {
        "flask_admin/helpers.py||flask_admin/helpers.py": [
          "File: flask_admin/helpers.py -> flask_admin/helpers.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: from jinja2 import contextfunction",
          "3: from flask import g, request, url_for, flash",
          "4: from wtforms.validators import DataRequired, InputRequired",
          "",
          "[Removed Lines]",
          "1: from re import sub",
          "",
          "[Added Lines]",
          "1: from re import sub, compile",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11: VALID_SCHEMES = ['http', 'https']",
          "14: def set_current_view(view):",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12: _substitute_whitespace = compile(r'[\\s\\x00-\\x08\\x0B\\x0C\\x0E-\\x19]+').sub",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "133: def is_safe_url(target):",
          "134:     # prevent urls starting with \"javascript:\"",
          "136:     target_info = urlparse(target)",
          "137:     target_scheme = target_info.scheme",
          "138:     if target_scheme and target_scheme not in VALID_SCHEMES:",
          "",
          "[Removed Lines]",
          "135:     target = target.strip()",
          "",
          "[Added Lines]",
          "135:     # prevent urls like \"\\\\www.google.com\"",
          "136:     # some browser will change \\\\ to // (eg: Chrome)",
          "137:     # refs https://stackoverflow.com/questions/10438008",
          "138:     target = target.replace('\\\\', '/')",
          "141:     target = _substitute_whitespace('', target)",
          "",
          "---------------"
        ],
        "flask_admin/tests/test_helpers.py||flask_admin/tests/test_helpers.py": [
          "File: flask_admin/tests/test_helpers.py -> flask_admin/tests/test_helpers.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "15:         assert not helpers.is_safe_url('http://127.0.0.2/admin/car/')",
          "16:         assert not helpers.is_safe_url(' javascript:alert(document.domain)')",
          "17:         assert not helpers.is_safe_url('javascript:alert(document.domain)')",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18:         assert not helpers.is_safe_url('javascrip\\nt:alert(document.domain)')",
          "19:         assert not helpers.is_safe_url('\\\\\\\\www.google.com')",
          "",
          "---------------"
        ]
      }
    }
  ]
}