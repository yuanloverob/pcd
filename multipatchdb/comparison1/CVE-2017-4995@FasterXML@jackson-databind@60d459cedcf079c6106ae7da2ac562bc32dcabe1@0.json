{
  "cve_id": "CVE-2017-4995",
  "cve_desc": "An issue was discovered in Pivotal Spring Security 4.2.0.RELEASE through 4.2.2.RELEASE, and Spring Security 5.0.0.M1. When configured to enable default typing, Jackson contained a deserialization vulnerability that could lead to arbitrary code execution. Jackson fixed this vulnerability by blacklisting known \"deserialization gadgets.\" Spring Security configures Jackson with global default typing enabled, which means that (through the previous exploit) arbitrary code could be executed if all of the following is true: (1) Spring Security's Jackson support is being leveraged by invoking SecurityJackson2Modules.getModules(ClassLoader) or SecurityJackson2Modules.enableDefaultTyping(ObjectMapper); (2) Jackson is used to deserialize data that is not trusted (Spring Security does not perform deserialization using Jackson, so this is an explicit choice of the user); and (3) there is an unknown (Jackson is not blacklisting it already) \"deserialization gadget\" that allows code execution present on the classpath. Jackson provides a blacklisting approach to protecting against this type of attack, but Spring Security should be proactive against blocking unknown \"deserialization gadgets\" when Spring Security enables default typing.",
  "repo": "FasterXML/jackson-databind",
  "patch_hash": "60d459cedcf079c6106ae7da2ac562bc32dcabe1",
  "patch_info": {
    "commit_hash": "60d459cedcf079c6106ae7da2ac562bc32dcabe1",
    "repo": "FasterXML/jackson-databind",
    "commit_url": "https://github.com/FasterXML/jackson-databind/commit/60d459cedcf079c6106ae7da2ac562bc32dcabe1",
    "files": [
      "release-notes/VERSION",
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
      "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java",
      ".gitattributes",
      ".github/ISSUE_TEMPLATE.md",
      ".travis.yml",
      "README.md",
      "attic/MappingIteratorReadTest.java",
      "pom.xml",
      "release-notes/CREDITS",
      "release-notes/VERSION",
      "src/main/java/com/fasterxml/jackson/databind/AbstractTypeResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/AnnotationIntrospector.java",
      "src/main/java/com/fasterxml/jackson/databind/BeanDescription.java",
      "src/main/java/com/fasterxml/jackson/databind/BeanProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/DatabindContext.java",
      "src/main/java/com/fasterxml/jackson/databind/DeserializationConfig.java",
      "src/main/java/com/fasterxml/jackson/databind/DeserializationContext.java",
      "src/main/java/com/fasterxml/jackson/databind/DeserializationFeature.java",
      "src/main/java/com/fasterxml/jackson/databind/JavaType.java",
      "src/main/java/com/fasterxml/jackson/databind/JsonMappingException.java",
      "src/main/java/com/fasterxml/jackson/databind/JsonSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/MapperFeature.java",
      "src/main/java/com/fasterxml/jackson/databind/Module.java",
      "src/main/java/com/fasterxml/jackson/databind/ObjectMapper.java",
      "src/main/java/com/fasterxml/jackson/databind/ObjectReader.java",
      "src/main/java/com/fasterxml/jackson/databind/ObjectWriter.java",
      "src/main/java/com/fasterxml/jackson/databind/PropertyMetadata.java",
      "src/main/java/com/fasterxml/jackson/databind/PropertyNamingStrategy.java",
      "src/main/java/com/fasterxml/jackson/databind/SerializationConfig.java",
      "src/main/java/com/fasterxml/jackson/databind/SerializationFeature.java",
      "src/main/java/com/fasterxml/jackson/databind/SerializerProvider.java",
      "src/main/java/com/fasterxml/jackson/databind/annotation/JsonAppend.java",
      "src/main/java/com/fasterxml/jackson/databind/annotation/JsonDeserialize.java",
      "src/main/java/com/fasterxml/jackson/databind/annotation/JsonPOJOBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/BaseSettings.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/ConfigOverride.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/ConfigOverrides.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/MapperConfig.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/MapperConfigBase.java",
      "src/main/java/com/fasterxml/jackson/databind/cfg/MutableConfigOverride.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/AbstractDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BasicDeserializerFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/BuilderBasedDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/CreatorProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/DefaultDeserializationContext.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/DeserializationProblemHandler.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/DeserializerCache.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/Deserializers.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/SettableAnyProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/SettableBeanProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/ValueInstantiator.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/BeanAsArrayBuilderDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/BeanAsArrayDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/BeanPropertyMap.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/CreatorCollector.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ErrorThrowingDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ExternalTypeHandler.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/FailingDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/FieldProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/InnerClassProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ManagedReferenceProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/MethodProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/NoClassDefFoundDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/NullProvider.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ObjectIdReferenceProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ObjectIdValueProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/PropertyBasedCreator.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/PropertyValueBuffer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/ReadableObjectId.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/SetterlessProperty.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/impl/UnwrappedPropertyHandler.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/AtomicReferenceDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/CollectionDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/DateDeserializers.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/EnumDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/EnumMapDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/EnumSetDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/FactoryBasedEnumDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/FromStringDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/JsonLocationInstantiator.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/JsonNodeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/MapDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/MapEntryDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/NumberDeserializers.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/ObjectArrayDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/PrimitiveArrayDeserializers.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/ReferenceTypeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StackTraceElementDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StdDelegatingDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StdDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StdKeyDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StdScalarDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StdValueInstantiator.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StringArrayDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StringCollectionDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/StringDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/ThrowableDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/UUIDDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/UntypedObjectDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/deser/std/UntypedObjectDeserializer.java.orig",
      "src/main/java/com/fasterxml/jackson/databind/exc/InvalidTypeIdException.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/CoreXMLDeserializers.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/DOMDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/Java7Support.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/Java7SupportImpl.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/NioPathDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/NioPathSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/OptionalHandlerFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/ext/PathDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/Annotated.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedClass.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedConstructor.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedMember.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedMethod.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedWithParams.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/AnnotationIntrospectorPair.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/BasicBeanDescription.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/BeanPropertyDefinition.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/ConcreteBeanPropertyBase.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/JacksonAnnotationIntrospector.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/POJOPropertiesCollector.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/POJOPropertyBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/VirtualAnnotatedMember.java",
      "src/main/java/com/fasterxml/jackson/databind/introspect/VisibilityChecker.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/SubtypeResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/TypeIdResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/TypeSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsArrayTypeSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsExistingPropertyTypeSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsExternalTypeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsPropertyTypeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsWrapperTypeDeserializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/AsWrapperTypeSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/ClassNameIdResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/MinimalClassNameIdResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/StdSubtypeResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/StdTypeResolverBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeDeserializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeIdResolverBase.java",
      "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/TypeNameIdResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/module/SimpleAbstractTypeResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/node/ArrayNode.java",
      "src/main/java/com/fasterxml/jackson/databind/node/ContainerNode.java",
      "src/main/java/com/fasterxml/jackson/databind/node/FloatNode.java",
      "src/main/java/com/fasterxml/jackson/databind/node/JsonNodeCreator.java",
      "src/main/java/com/fasterxml/jackson/databind/node/JsonNodeFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/node/ObjectNode.java",
      "src/main/java/com/fasterxml/jackson/databind/node/TextNode.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/AnyGetterWriter.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/BasicSerializerFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/BeanPropertyWriter.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/BeanSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/BeanSerializerBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/BeanSerializerFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/DefaultSerializerProvider.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/PropertyBuilder.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/BeanAsArraySerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/FailingSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/MapEntrySerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/StringArraySerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/UnknownSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/impl/UnwrappingBeanSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/ArraySerializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/AsArraySerializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/AtomicReferenceSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/BeanSerializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/DateTimeSerializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/EnumSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/JsonValueSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/MapSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/NumberSerializers.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/ObjectArraySerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/ReferenceTypeSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/SerializableSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/StaticListSerializerBase.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/StdArraySerializers.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/StdKeySerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/StdKeySerializers.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/StdSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/ser/std/ToStringSerializer.java",
      "src/main/java/com/fasterxml/jackson/databind/type/ArrayType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/CollectionLikeType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/CollectionType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/MapLikeType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/ReferenceType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/ResolvedRecursiveType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/SimpleType.java",
      "src/main/java/com/fasterxml/jackson/databind/type/TypeBase.java",
      "src/main/java/com/fasterxml/jackson/databind/type/TypeFactory.java",
      "src/main/java/com/fasterxml/jackson/databind/util/ArrayBuilders.java",
      "src/main/java/com/fasterxml/jackson/databind/util/ClassUtil.java",
      "src/main/java/com/fasterxml/jackson/databind/util/EnumResolver.java",
      "src/main/java/com/fasterxml/jackson/databind/util/ISO8601Utils.java",
      "src/main/java/com/fasterxml/jackson/databind/util/JSONWrappedObject.java",
      "src/main/java/com/fasterxml/jackson/databind/util/LinkedNode.java",
      "src/main/java/com/fasterxml/jackson/databind/util/ObjectIdMap.java",
      "src/main/java/com/fasterxml/jackson/databind/util/TokenBuffer.java",
      "src/test/java/com/fasterxml/jackson/databind/BaseMapTest.java",
      "src/test/java/com/fasterxml/jackson/databind/BaseTest.java",
      "src/test/java/com/fasterxml/jackson/databind/ObjectMapperTest.java",
      "src/test/java/com/fasterxml/jackson/databind/TestFormatSchema.java",
      "src/test/java/com/fasterxml/jackson/databind/TestObjectMapperBeanDeserializer.java",
      "src/test/java/com/fasterxml/jackson/databind/contextual/TestContextualWithAnnDeserializer.java",
      "src/test/java/com/fasterxml/jackson/databind/convert/ConvertingAbstractSerializer795Test.java",
      "src/test/java/com/fasterxml/jackson/databind/convert/TestArrayConversions.java",
      "src/test/java/com/fasterxml/jackson/databind/convert/TestBeanConversions.java",
      "src/test/java/com/fasterxml/jackson/databind/convert/TestUpdateValue.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/ArrayDelegatorCreatorForCollectionTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/BuilderSimpleTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/CreatorPropertiesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/DelegatingCreatorImplicitNames1001Test.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/EnumCreatorTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/FailOnNullCreatorTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/InnerClassCreatorTest.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestConstructFromMap.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestCreators2.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestCreatorsWithIdentity.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestCustomValueInstDefaults.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestValueInstantiator.java",
      "src/test/java/com/fasterxml/jackson/databind/creators/TestValueUpdate.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/AnySetter349Test.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/EnumDefaultReadTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/EnumDeserializationTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/ExceptionFromCustomEnumKeyDeserializerTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/JDKAtomicTypesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/JDKNumberDeserTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/JDKScalarsTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/JDKStringLikeTypesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/KeyDeser1429Test.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/NullHandlingTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/NumberDeserTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/ReadOrWriteOnlyTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestAnnotationIgnore.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestAnyProperties.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestBeanDeserializer.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestDateDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestEnumDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestExceptionDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestExceptionHandling.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestExceptionHandlingWithDefaultDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestExceptionHandlingWithJsonCreatorDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestIgnoredTypes.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestJDKAtomicTypes.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestJdkTypes.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestMapDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestNullHandling.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestSimpleTypes.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestUntypedDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/TestValueAnnotations.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/UntypedNumbersTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/builder/BuilderWithUnwrappedTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/ExceptionPathTest.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionHandling.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionHandlingWithDefaultDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionHandlingWithJsonCreatorDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionSerialization.java",
      "src/test/java/com/fasterxml/jackson/databind/deser/exc/TestExceptionsDuringWriting.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestDOM.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestJava6Types.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestJava7Types.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestJdk16Types.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestJdk7Types.java",
      "src/test/java/com/fasterxml/jackson/databind/ext/TestSOAP.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/IgnoreCreatorProp1317Test.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/IgnorePropertiesDeser1575Test.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/IgnorePropertyOnDeser1217Test.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/IgnorePropsForSerTest.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/JsonInclude1327Test.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/JsonIncludeTest.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/ProblemHandlerTest.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/TestAnyGetterFiltering.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/TestJsonFilter.java",
      "src/test/java/com/fasterxml/jackson/databind/filter/TestUnknownPropertyDeserialization.java",
      "src/test/java/com/fasterxml/jackson/databind/format/DateFormatTest.java",
      "src/test/java/com/fasterxml/jackson/databind/introspect/TestAutoDetect.java",
      "src/test/java/com/fasterxml/jackson/databind/introspect/TestJacksonAnnotationIntrospector.java",
      "src/test/java/com/fasterxml/jackson/databind/introspect/TestNamingStrategyStd.java",
      "src/test/java/com/fasterxml/jackson/databind/introspect/TransientTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsonschema/NewSchemaTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsonschema/TestGenerateJsonSchema.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/DefaultTypingWithPrimitivesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ExternalTypeId198Test.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestCustomTypeIdResolver.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestDefaultForArrays.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestDefaultWithCreators.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestExternalId.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestGenericListSerialization.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestOverlappingTypeIdNames.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestOverlappingTypeIdNames312.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestPolymorphicWithDefaultImpl.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TestSubtypes.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/TypeRefinementForMapTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/UnknownSubClassTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/ExternalTypeId198Test.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/ExternalTypeId999Test.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/ExternalTypeIdTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/ExternalTypeIdTest1288.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/JsonValueExtTypeIdTest.java",
      "src/test/java/com/fasterxml/jackson/databind/jsontype/ext/TestSubtypesExternalPropertyMissingProperty.java",
      "src/test/java/com/fasterxml/jackson/databind/misc/AccessFixTest.java",
      "src/test/java/com/fasterxml/jackson/databind/misc/CaseInsensitiveDeser.java",
      "src/test/java/com/fasterxml/jackson/databind/misc/CaseInsensitiveDeserTest.java",
      "src/test/java/com/fasterxml/jackson/databind/misc/TestJSONP.java",
      "src/test/java/com/fasterxml/jackson/databind/module/TestAbstractTypes.java",
      "src/test/java/com/fasterxml/jackson/databind/module/TestCustomEnumKeyDeserializer.java",
      "src/test/java/com/fasterxml/jackson/databind/node/NotANumberConversionTest.java",
      "src/test/java/com/fasterxml/jackson/databind/node/TestEndOfInputHandling.java",
      "src/test/java/com/fasterxml/jackson/databind/objectid/Objecid1083Test.java",
      "src/test/java/com/fasterxml/jackson/databind/objectid/ObjectIdReordering1388Test.java",
      "src/test/java/com/fasterxml/jackson/databind/objectid/ObjectWithCreator1261Test.java",
      "src/test/java/com/fasterxml/jackson/databind/objectid/TestObjectId.java",
      "src/test/java/com/fasterxml/jackson/databind/objectid/TestObjectIdWithInjectables538.java",
      "src/test/java/com/fasterxml/jackson/databind/seq/ObjectReaderTest.java",
      "src/test/java/com/fasterxml/jackson/databind/seq/ObjectWriterTest.java",
      "src/test/java/com/fasterxml/jackson/databind/seq/SequenceWriterTest.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/NumberSerTest.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/SerializationFeaturesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestEnumSerialization.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestExceptionHandling.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestExceptionSerialization.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestFeatures.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestJsonValue.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestMapSerialization.java",
      "src/test/java/com/fasterxml/jackson/databind/ser/TestRootType.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/EmptyArrayAsNullTest.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/EnumFormatShapeTest.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/FormatFeaturesTest.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/SingleValueAsArrayTest.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/TestBackRefsWithPolymorphic.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/TestFormatForCollections.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/TestPOJOAsArray.java",
      "src/test/java/com/fasterxml/jackson/databind/struct/TestUnwrapped.java",
      "src/test/java/com/fasterxml/jackson/databind/type/TestJavaType.java",
      "src/test/java/com/fasterxml/jackson/databind/type/TestTypeBindings.java",
      "src/test/java/com/fasterxml/jackson/databind/type/TestTypeFactory.java",
      "src/test/java/com/fasterxml/jackson/databind/util/TestTokenBuffer.java",
      "src/test/java/com/fasterxml/jackson/failing/AnySetter1035Test.java",
      "src/test/java/com/fasterxml/jackson/failing/BackReference1516Test.java",
      "src/test/java/com/fasterxml/jackson/failing/BuilderWithIgnored1214Test.java",
      "src/test/java/com/fasterxml/jackson/failing/CollectionType1415Test.java",
      "src/test/java/com/fasterxml/jackson/failing/CreatorProperties1401Test.java",
      "src/test/java/com/fasterxml/jackson/failing/DelegatingCreatorImplicitNames1001Test.java",
      "src/test/java/com/fasterxml/jackson/failing/EnumCreatorTest929.java",
      "src/test/java/com/fasterxml/jackson/failing/ExternalId96Test.java",
      "src/test/java/com/fasterxml/jackson/failing/ExternalTypeId96Test.java",
      "src/test/java/com/fasterxml/jackson/failing/ExternalTypeId999Test.java",
      "src/test/java/com/fasterxml/jackson/failing/FailingSubTypeUnknownClass1098Test.java",
      "src/test/java/com/fasterxml/jackson/failing/IgnorePropertyOnDeser1217Test.java",
      "src/test/java/com/fasterxml/jackson/failing/IgnoredCreatorProperty1572Test.java",
      "src/test/java/com/fasterxml/jackson/failing/InnerClassCreator1502Test.java",
      "src/test/java/com/fasterxml/jackson/failing/ObjectIdWithInjectable639Test.java",
      "src/test/java/com/fasterxml/jackson/failing/ReadWriteOnlyProp935Test.java",
      "src/test/java/com/fasterxml/jackson/failing/SkipInjectableIntrospection962Test.java",
      "src/test/java/com/fasterxml/jackson/failing/TestMultipleExternalIds291.java",
      "src/test/java/com/fasterxml/jackson/failing/TestObjectIdWithInjectables538.java",
      "src/test/java/com/fasterxml/jackson/failing/TestObjectIdWithInjectables639.java",
      "src/test/java/com/fasterxml/jackson/failing/TestObjectIdWithUnwrapping1298.java",
      "src/test/java/com/fasterxml/jackson/failing/TestSubtypes1311.java",
      "src/test/java/com/fasterxml/jackson/failing/TestTypeWithJsonValue466.java",
      "src/test/java/com/fasterxml/jackson/failing/TestUnknownProperty426.java",
      "src/test/java/perf/ManualReadWithTypeResolution.java"
    ],
    "message": "Fix #1599 for 2.8.9\n\nMerge branch '2.7' into 2.8",
    "before_after_code_files": [
      "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
      "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java"
    ]
  },
  "patch_diff": {
    "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java": [
      "File: src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java -> src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "38:     private final static Class<?>[] INIT_CAUSE_PARAMS = new Class<?>[] { Throwable.class };",
      "40:     private final static Class<?>[] NO_VIEWS = new Class<?>[0];",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "48:     protected final static Set<String> DEFAULT_NO_DESER_CLASS_NAMES;",
      "49:     static {",
      "50:         Set<String> s = new HashSet<>();",
      "53:         s.add(\"org.apache.commons.collections.functors.InvokerTransformer\");",
      "54:         s.add(\"org.apache.commons.collections.functors.InstantiateTransformer\");",
      "55:         s.add(\"org.apache.commons.collections4.functors.InvokerTransformer\");",
      "56:         s.add(\"org.apache.commons.collections4.functors.InstantiateTransformer\");",
      "57:         s.add(\"org.codehaus.groovy.runtime.ConvertedClosure\");",
      "58:         s.add(\"org.codehaus.groovy.runtime.MethodClosure\");",
      "59:         s.add(\"org.springframework.beans.factory.ObjectFactory\");",
      "60:         s.add(\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\");",
      "61:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
      "62:     }",
      "69:     protected Set<String> _cfgIllegalClassNames = DEFAULT_NO_DESER_CLASS_NAMES;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "137:         if (!isPotentialBeanType(type.getRawClass())) {",
      "138:             return null;",
      "139:         }",
      "141:         return buildBeanDeserializer(ctxt, type, beanDesc);",
      "142:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "170:         checkIllegalTypes(ctxt, type, beanDesc);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "855:         ignoredTypes.put(type, status);",
      "856:         return status.booleanValue();",
      "857:     }",
      "858: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "893:     protected void checkIllegalTypes(DeserializationContext ctxt, JavaType type,",
      "894:             BeanDescription beanDesc)",
      "895:         throws JsonMappingException",
      "896:     {",
      "899:         String full = type.getRawClass().getName();",
      "901:         if (_cfgIllegalClassNames.contains(full)) {",
      "902:             ctxt.reportBadTypeDefinition(beanDesc,",
      "903:                     \"Illegal type (%s) to deserialize: prevented for security reasons\", full);",
      "904:         }",
      "905:     }",
      "",
      "---------------"
    ],
    "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java": [
      "File: src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java -> src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: package com.fasterxml.jackson.databind.interop;",
      "3: import com.fasterxml.jackson.databind.*;",
      "9: public class IllegalTypesCheckTest extends BaseMapTest",
      "10: {",
      "11:     static class Bean1599 {",
      "12:         public int id;",
      "13:         public Object obj;",
      "14:     }",
      "16:     public void testIssue1599() throws Exception",
      "17:     {",
      "18:         final String JSON = aposToQuotes(",
      "19:  \"{'id': 124,\\n\"",
      "20: +\" 'obj':[ 'com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl',\\n\"",
      "21: +\"  {\\n\"",
      "22: +\"    'transletBytecodes' : [ 'AAIAZQ==' ],\\n\"",
      "23: +\"    'transletName' : 'a.b',\\n\"",
      "24: +\"    'outputProperties' : { }\\n\"",
      "25: +\"  }\\n\"",
      "26: +\" ]\\n\"",
      "27: +\"}\"",
      "28:         );",
      "29:         ObjectMapper mapper = new ObjectMapper();",
      "30:         mapper.enableDefaultTyping();",
      "31:         try {",
      "32:             mapper.readValue(JSON, Bean1599.class);",
      "33:             fail(\"Should not pass\");",
      "34:         } catch (JsonMappingException e) {",
      "35:             verifyException(e, \"Illegal type\");",
      "36:             verifyException(e, \"to deserialize\");",
      "37:             verifyException(e, \"prevented for security reasons\");",
      "38:         }",
      "39:     }",
      "40: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fa87c1ddbe803ebb7295f5c2ebfe38e12f6e6162",
      "candidate_info": {
        "commit_hash": "fa87c1ddbe803ebb7295f5c2ebfe38e12f6e6162",
        "repo": "FasterXML/jackson-databind",
        "commit_url": "https://github.com/FasterXML/jackson-databind/commit/fa87c1ddbe803ebb7295f5c2ebfe38e12f6e6162",
        "files": [
          "pom.xml",
          "release-notes/VERSION",
          "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
          "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java"
        ],
        "message": "Backport #1599 in 2.6.x",
        "before_after_code_files": [
          "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
          "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
            "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java"
          ],
          "candidate": [
            "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
            "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java": [
          "File: src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java -> src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "40:     private final static Class<?>[] INIT_CAUSE_PARAMS = new Class<?>[] { Throwable.class };",
          "42:     private final static Class<?>[] NO_VIEWS = new Class<?>[0];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "48:     private final static Set<String> DEFAULT_NO_DESER_CLASS_NAMES;",
          "49:     static {",
          "50:         Set<String> s = new HashSet<String>();",
          "53:         s.add(\"org.apache.commons.collections.functors.InvokerTransformer\");",
          "54:         s.add(\"org.apache.commons.collections.functors.InstantiateTransformer\");",
          "55:         s.add(\"org.apache.commons.collections4.functors.InvokerTransformer\");",
          "56:         s.add(\"org.apache.commons.collections4.functors.InstantiateTransformer\");",
          "57:         s.add(\"org.codehaus.groovy.runtime.ConvertedClosure\");",
          "58:         s.add(\"org.codehaus.groovy.runtime.MethodClosure\");",
          "59:         s.add(\"org.springframework.beans.factory.ObjectFactory\");",
          "60:         s.add(\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\");",
          "61:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
          "62:     }",
          "67:     private Set<String> _cfgIllegalClassNames = DEFAULT_NO_DESER_CLASS_NAMES;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "138:         if (!isPotentialBeanType(type.getRawClass())) {",
          "139:             return null;",
          "140:         }",
          "142:         return buildBeanDeserializer(ctxt, type, beanDesc);",
          "143:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "167:         checkIllegalTypes(ctxt, type, beanDesc);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "837:         return (status == null) ? false : status.booleanValue();",
          "838:     }",
          "839: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "867:     private void checkIllegalTypes(DeserializationContext ctxt, JavaType type,",
          "868:             BeanDescription beanDesc)",
          "869:         throws JsonMappingException",
          "870:     {",
          "873:         String full = type.getRawClass().getName();",
          "875:         if (_cfgIllegalClassNames.contains(full)) {",
          "876:             String message = String.format(\"Illegal type (%s) to deserialize: prevented for security reasons\",",
          "877:                     full);",
          "878:             throw ctxt.mappingException(\"Invalid type definition for type %s: %s\",",
          "879:                     beanDesc, message);",
          "880:         }",
          "881:     }",
          "",
          "---------------"
        ],
        "src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java||src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java": [
          "File: src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java -> src/test/java/com/fasterxml/jackson/databind/interop/IllegalTypesCheckTest.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: package com.fasterxml.jackson.databind.interop;",
          "3: import com.fasterxml.jackson.databind.*;",
          "9: public class IllegalTypesCheckTest extends BaseMapTest",
          "10: {",
          "11:     static class Bean1599 {",
          "12:         public int id;",
          "13:         public Object obj;",
          "14:     }",
          "16:     public void testIssue1599() throws Exception",
          "17:     {",
          "18:         final String JSON = aposToQuotes(",
          "19:  \"{'id': 124,\\n\"",
          "20: +\" 'obj':[ 'com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl',\\n\"",
          "21: +\"  {\\n\"",
          "22: +\"    'transletBytecodes' : [ 'AAIAZQ==' ],\\n\"",
          "23: +\"    'transletName' : 'a.b',\\n\"",
          "24: +\"    'outputProperties' : { }\\n\"",
          "25: +\"  }\\n\"",
          "26: +\" ]\\n\"",
          "27: +\"}\"",
          "28:         );",
          "29:         ObjectMapper mapper = new ObjectMapper();",
          "30:         mapper.enableDefaultTyping();",
          "31:         try {",
          "32:             mapper.readValue(JSON, Bean1599.class);",
          "33:             fail(\"Should not pass\");",
          "34:         } catch (JsonMappingException e) {",
          "35:             verifyException(e, \"Illegal type\");",
          "36:             verifyException(e, \"to deserialize\");",
          "37:             verifyException(e, \"prevented for security reasons\");",
          "38:         }",
          "39:     }",
          "40: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3bfbb835e530055c1941ddf87fde0b08d08dcd38",
      "candidate_info": {
        "commit_hash": "3bfbb835e530055c1941ddf87fde0b08d08dcd38",
        "repo": "FasterXML/jackson-databind",
        "commit_url": "https://github.com/FasterXML/jackson-databind/commit/3bfbb835e530055c1941ddf87fde0b08d08dcd38",
        "files": [
          "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java"
        ],
        "message": "Minor improvement wrt #1599 (also cover vanilla xalan impl)",
        "before_after_code_files": [
          "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java"
          ],
          "candidate": [
            "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java"
          ]
        }
      },
      "candidate_diff": {
        "src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java||src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java": [
          "File: src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java -> src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:         s.add(\"org.codehaus.groovy.runtime.MethodClosure\");",
          "58:         s.add(\"org.springframework.beans.factory.ObjectFactory\");",
          "59:         s.add(\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\");",
          "60:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
          "61:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60:         s.add(\"org.apache.xalan.xsltc.trax.TemplatesImpl\");",
          "",
          "---------------"
        ]
      }
    }
  ]
}