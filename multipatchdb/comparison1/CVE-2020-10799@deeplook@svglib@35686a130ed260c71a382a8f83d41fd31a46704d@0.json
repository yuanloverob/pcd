{
  "cve_id": "CVE-2020-10799",
  "cve_desc": "The svglib package through 0.9.3 for Python allows XXE attacks via an svg2rlg call.",
  "repo": "deeplook/svglib",
  "patch_hash": "35686a130ed260c71a382a8f83d41fd31a46704d",
  "patch_info": {
    "commit_hash": "35686a130ed260c71a382a8f83d41fd31a46704d",
    "repo": "deeplook/svglib",
    "commit_url": "https://github.com/deeplook/svglib/commit/35686a130ed260c71a382a8f83d41fd31a46704d",
    "files": [
      "CHANGELOG.rst",
      "svglib/svglib.py"
    ],
    "message": "Fixes #229 - External entity loading disabled by default\n\nFixes CVE-2020-10799",
    "before_after_code_files": [
      "svglib/svglib.py||svglib/svglib.py"
    ]
  },
  "patch_diff": {
    "svglib/svglib.py||svglib/svglib.py": [
      "File: svglib/svglib.py -> svglib/svglib.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "1403:             shape.fillColor.alpha = shape.fillOpacity",
      "1407:     \"Convert an SVG file to an RLG Drawing object.\"",
      "1409:     # unzip .svgz file into .svg",
      "",
      "[Removed Lines]",
      "1406: def svg2rlg(path, **kwargs):",
      "",
      "[Added Lines]",
      "1406: def svg2rlg(path, resolve_entities=False, **kwargs):",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1414:         path = path[:-1]",
      "1415:         unzipped = True",
      "1418:     if svg_root is None:",
      "1419:         return",
      "",
      "[Removed Lines]",
      "1417:     svg_root = load_svg_file(path)",
      "",
      "[Added Lines]",
      "1417:     svg_root = load_svg_file(path, resolve_entities=resolve_entities)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1429:     return drawing",
      "1434:     try:",
      "1435:         doc = etree.parse(path, parser=parser)",
      "1436:         svg_root = doc.getroot()",
      "",
      "[Removed Lines]",
      "1432: def load_svg_file(path):",
      "1433:     parser = etree.XMLParser(remove_comments=True, recover=True)",
      "",
      "[Added Lines]",
      "1432: def load_svg_file(path, resolve_entities=False):",
      "1433:     parser = etree.XMLParser(",
      "1434:         remove_comments=True, recover=True, resolve_entities=resolve_entities",
      "1435:     )",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d6d08c4323a3656ee5ebe9a072a6e6237efde800",
      "candidate_info": {
        "commit_hash": "d6d08c4323a3656ee5ebe9a072a6e6237efde800",
        "repo": "deeplook/svglib",
        "commit_url": "https://github.com/deeplook/svglib/commit/d6d08c4323a3656ee5ebe9a072a6e6237efde800",
        "files": [
          "CHANGELOG.rst",
          "svglib/svglib.py"
        ],
        "message": "Fixes #229 - External entity loading disabled by default\n\nFixes CVE-2020-10799",
        "before_after_code_files": [
          "svglib/svglib.py||svglib/svglib.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "svglib/svglib.py||svglib/svglib.py"
          ],
          "candidate": [
            "svglib/svglib.py||svglib/svglib.py"
          ]
        }
      },
      "candidate_diff": {
        "svglib/svglib.py||svglib/svglib.py": [
          "File: svglib/svglib.py -> svglib/svglib.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1402:             shape.fillColor.alpha = shape.fillOpacity",
          "1406:     \"Convert an SVG file to an RLG Drawing object.\"",
          "1408:     # unzip .svgz file into .svg",
          "",
          "[Removed Lines]",
          "1405: def svg2rlg(path, **kwargs):",
          "",
          "[Added Lines]",
          "1405: def svg2rlg(path, resolve_entities=False, **kwargs):",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1413:         path = path[:-1]",
          "1414:         unzipped = True",
          "1417:     if svg_root is None:",
          "1418:         return",
          "",
          "[Removed Lines]",
          "1416:     svg_root = load_svg_file(path)",
          "",
          "[Added Lines]",
          "1416:     svg_root = load_svg_file(path, resolve_entities=resolve_entities)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1428:     return drawing",
          "1433:     try:",
          "1434:         doc = etree.parse(path, parser=parser)",
          "1435:         svg_root = doc.getroot()",
          "",
          "[Removed Lines]",
          "1431: def load_svg_file(path):",
          "1432:     parser = etree.XMLParser(remove_comments=True, recover=True)",
          "",
          "[Added Lines]",
          "1431: def load_svg_file(path, resolve_entities=False):",
          "1432:     parser = etree.XMLParser(",
          "1433:         remove_comments=True, recover=True, resolve_entities=resolve_entities",
          "1434:     )",
          "",
          "---------------"
        ]
      }
    }
  ]
}