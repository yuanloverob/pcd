{
  "cve_id": "CVE-2024-7042",
  "cve_desc": "A vulnerability in the GraphCypherQAChain class of langchain-ai/langchainjs versions 0.2.5 and all versions with this class allows for prompt injection, leading to SQL injection. This vulnerability permits unauthorized data manipulation, data exfiltration, denial of service (DoS) by deleting all data, breaches in multi-tenant security environments, and data integrity issues. Attackers can create, update, or delete nodes and relationships without proper authorization, extract sensitive data, disrupt services, access data across different tenants, and compromise the integrity of the database.",
  "repo": "langchain-ai/langchainjs",
  "patch_hash": "615b9d9ab30a2d23a2f95fb8d7acfdf4b41ad7a6",
  "patch_info": {
    "commit_hash": "615b9d9ab30a2d23a2f95fb8d7acfdf4b41ad7a6",
    "repo": "langchain-ai/langchainjs",
    "commit_url": "https://github.com/langchain-ai/langchainjs/commit/615b9d9ab30a2d23a2f95fb8d7acfdf4b41ad7a6",
    "files": [
      "examples/package.json",
      "examples/src/indexes/vector_stores/lancedb/fromDocs.ts",
      "examples/src/indexes/vector_stores/lancedb/fromTexts.ts",
      "libs/langchain-community/package.json",
      "libs/langchain-community/src/vectorstores/lancedb.ts",
      "libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts",
      "yarn.lock"
    ],
    "message": "feat(community): Remove required param from LanceDB integration (#6706)\n\nCo-authored-by: jacoblee93 <jacoblee93@gmail.com>",
    "before_after_code_files": [
      "examples/src/indexes/vector_stores/lancedb/fromDocs.ts||examples/src/indexes/vector_stores/lancedb/fromDocs.ts",
      "examples/src/indexes/vector_stores/lancedb/fromTexts.ts||examples/src/indexes/vector_stores/lancedb/fromTexts.ts",
      "libs/langchain-community/src/vectorstores/lancedb.ts||libs/langchain-community/src/vectorstores/lancedb.ts",
      "libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts||libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts",
      "yarn.lock||yarn.lock"
    ]
  },
  "patch_diff": {
    "examples/src/indexes/vector_stores/lancedb/fromDocs.ts||examples/src/indexes/vector_stores/lancedb/fromDocs.ts": [
      "File: examples/src/indexes/vector_stores/lancedb/fromDocs.ts -> examples/src/indexes/vector_stores/lancedb/fromDocs.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: import fs from \"node:fs/promises\";",
      "5: import path from \"node:path\";",
      "6: import os from \"node:os\";",
      "10: const loader = new TextLoader(\"src/document_loaders/example_data/example.txt\");",
      "11: const docs = await loader.load();",
      "13: export const run = async () => {",
      "14:   const dir = await fs.mkdtemp(path.join(os.tmpdir(), \"lancedb-\"));",
      "26:   const resultOne = await vectorStore.similaritySearch(\"hello world\", 1);",
      "27:   console.log(resultOne);",
      "",
      "[Removed Lines]",
      "7: import { connect } from \"vectordb\";",
      "15:   const db = await connect(dir);",
      "16:   const table = await db.createTable(\"vectors\", [",
      "17:     { vector: Array(1536), text: \"sample\", source: \"a\" },",
      "18:   ]);",
      "20:   const vectorStore = await LanceDB.fromDocuments(",
      "21:     docs,",
      "22:     new OpenAIEmbeddings(),",
      "23:     { table }",
      "24:   );",
      "",
      "[Added Lines]",
      "13:   const vectorStore = await LanceDB.fromDocuments(docs, new OpenAIEmbeddings());",
      "15:   const resultOne = await vectorStore.similaritySearch(\"hello world\", 1);",
      "16:   console.log(resultOne);",
      "24: };",
      "26: export const run_with_existing_table = async () => {",
      "29:   const vectorStore = await LanceDB.fromDocuments(docs, new OpenAIEmbeddings());",
      "",
      "---------------"
    ],
    "examples/src/indexes/vector_stores/lancedb/fromTexts.ts||examples/src/indexes/vector_stores/lancedb/fromTexts.ts": [
      "File: examples/src/indexes/vector_stores/lancedb/fromTexts.ts -> examples/src/indexes/vector_stores/lancedb/fromTexts.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: import { LanceDB } from \"@langchain/community/vectorstores/lancedb\";",
      "2: import { OpenAIEmbeddings } from \"@langchain/openai\";",
      "4: import * as fs from \"node:fs/promises\";",
      "5: import * as path from \"node:path\";",
      "6: import os from \"node:os\";",
      "8: export const run = async () => {",
      "15:   const vectorStore = await LanceDB.fromTexts(",
      "16:     [\"Hello world\", \"Bye bye\", \"hello nice world\"],",
      "17:     [{ id: 2 }, { id: 1 }, { id: 3 }],",
      "20:   );",
      "22:   const resultOne = await vectorStore.similaritySearch(\"hello world\", 1);",
      "",
      "[Removed Lines]",
      "3: import { connect } from \"vectordb\";",
      "9:   const dir = await fs.mkdtemp(path.join(os.tmpdir(), \"lancedb-\"));",
      "10:   const db = await connect(dir);",
      "11:   const table = await db.createTable(\"vectors\", [",
      "12:     { vector: Array(1536), text: \"sample\", id: 1 },",
      "13:   ]);",
      "18:     new OpenAIEmbeddings(),",
      "19:     { table }",
      "",
      "[Added Lines]",
      "8:   const vectorStore = await LanceDB.fromTexts(",
      "9:     [\"Hello world\", \"Bye bye\", \"hello nice world\"],",
      "10:     [{ id: 2 }, { id: 1 }, { id: 3 }],",
      "11:     new OpenAIEmbeddings()",
      "12:   );",
      "14:   const resultOne = await vectorStore.similaritySearch(\"hello world\", 1);",
      "15:   console.log(resultOne);",
      "17: };",
      "19: export const run_with_existing_table = async () => {",
      "20:   const dir = await fs.mkdtemp(path.join(os.tmpdir(), \"lancedb-\"));",
      "24:     new OpenAIEmbeddings()",
      "",
      "---------------"
    ],
    "libs/langchain-community/src/vectorstores/lancedb.ts||libs/langchain-community/src/vectorstores/lancedb.ts": [
      "File: libs/langchain-community/src/vectorstores/lancedb.ts -> libs/langchain-community/src/vectorstores/lancedb.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: import type { EmbeddingsInterface } from \"@langchain/core/embeddings\";",
      "3: import { VectorStore } from \"@langchain/core/vectorstores\";",
      "4: import { Document } from \"@langchain/core/documents\";",
      "",
      "[Removed Lines]",
      "1: import { Table } from \"vectordb\";",
      "",
      "[Added Lines]",
      "1: import { connect, Table, Connection, WriteMode } from \"vectordb\";",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "10: export type LanceDBArgs = {",
      "12:   textKey?: string;",
      "13: };",
      "",
      "[Removed Lines]",
      "11:   table: Table;",
      "",
      "[Added Lines]",
      "11:   table?: Table;",
      "13:   uri?: string;",
      "14:   tableName?: string;",
      "15:   mode?: WriteMode;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "20: export class LanceDB extends VectorStore {",
      "23:   private textKey: string;",
      "28:     this.embeddings = embeddings;",
      "30:   }",
      "",
      "[Removed Lines]",
      "21:   private table: Table;",
      "25:   constructor(embeddings: EmbeddingsInterface, args: LanceDBArgs) {",
      "26:     super(embeddings, args);",
      "27:     this.table = args.table;",
      "29:     this.textKey = args.textKey || \"text\";",
      "",
      "[Added Lines]",
      "24:   private table?: Table;",
      "28:   private uri: string;",
      "30:   private tableName: string;",
      "32:   private mode?: WriteMode;",
      "34:   constructor(embeddings: EmbeddingsInterface, args?: LanceDBArgs) {",
      "35:     super(embeddings, args || {});",
      "36:     this.table = args?.table;",
      "38:     this.textKey = args?.textKey || \"text\";",
      "39:     this.uri = args?.uri || \"~/lancedb\";",
      "40:     this.tableName = args?.tableName || \"langchain\";",
      "41:     this.mode = args?.mode || WriteMode.Overwrite;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "71:       });",
      "72:       data.push(record);",
      "73:     }",
      "74:     await this.table.add(data);",
      "75:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "86:     if (!this.table) {",
      "87:       const db: Connection = await connect(this.uri);",
      "88:       this.table = await db.createTable(this.tableName, data, {",
      "89:         writeMode: this.mode,",
      "90:       });",
      "92:       return;",
      "93:     }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "85:     query: number[],",
      "86:     k: number",
      "87:   ): Promise<[Document, number][]> {",
      "88:     const results = await this.table.search(query).limit(k).execute();",
      "90:     const docsAndScore: [Document, number][] = [];",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "108:     if (!this.table) {",
      "109:       throw new Error(",
      "110:         \"Table not found. Please add vectors to the table first.\"",
      "111:       );",
      "112:     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "119:     texts: string[],",
      "120:     metadatas: object[] | object,",
      "121:     embeddings: EmbeddingsInterface,",
      "123:   ): Promise<LanceDB> {",
      "124:     const docs: Document[] = [];",
      "125:     for (let i = 0; i < texts.length; i += 1) {",
      "",
      "[Removed Lines]",
      "122:     dbConfig: LanceDBArgs",
      "",
      "[Added Lines]",
      "147:     dbConfig?: LanceDBArgs",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "143:   static async fromDocuments(",
      "144:     docs: Document[],",
      "145:     embeddings: EmbeddingsInterface,",
      "147:   ): Promise<LanceDB> {",
      "148:     const instance = new this(embeddings, dbConfig);",
      "149:     await instance.addDocuments(docs);",
      "",
      "[Removed Lines]",
      "146:     dbConfig: LanceDBArgs",
      "",
      "[Added Lines]",
      "171:     dbConfig?: LanceDBArgs",
      "",
      "---------------"
    ],
    "libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts||libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts": [
      "File: libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts -> libs/langchain-community/src/vectorstores/tests/lancedb.int.test.ts",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:     expect(resultsTwo.length).toBe(5);",
      "46:   });",
      "47: });",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "49: describe(\"LanceDB empty schema\", () => {",
      "50:   test(\"Test fromTexts + addDocuments\", async () => {",
      "51:     const embeddings = new OpenAIEmbeddings();",
      "52:     const vectorStore = await LanceDB.fromTexts(",
      "53:       [\"hello bye\", \"hello world\", \"bye bye\"],",
      "54:       [{ id: 1 }, { id: 2 }, { id: 3 }],",
      "55:       embeddings",
      "56:     );",
      "58:     const results = await vectorStore.similaritySearch(\"hello bye\", 10);",
      "59:     expect(results.length).toBe(3);",
      "61:     await vectorStore.addDocuments([",
      "62:       new Document({",
      "63:         pageContent: \"a new world\",",
      "64:         metadata: { id: 4 },",
      "65:       }),",
      "66:     ]);",
      "68:     const resultsTwo = await vectorStore.similaritySearch(\"hello bye\", 10);",
      "69:     expect(resultsTwo.length).toBe(4);",
      "70:   });",
      "71: });",
      "",
      "---------------"
    ],
    "yarn.lock||yarn.lock": [
      "File: yarn.lock -> yarn.lock",
      "--- Hunk 1 ---",
      "[Context before]",
      "251:   languageName: node",
      "252:   linkType: hard",
      "272: \"@apify/consts@npm:^2.13.0, @apify/consts@npm:^2.9.0\":",
      "273:   version: 2.13.0",
      "274:   resolution: \"@apify/consts@npm:2.13.0\"",
      "",
      "[Removed Lines]",
      "254: \"@apache-arrow/ts@npm:^12.0.0\":",
      "255:   version: 12.0.0",
      "256:   resolution: \"@apache-arrow/ts@npm:12.0.0\"",
      "257:   dependencies:",
      "258:     \"@types/command-line-args\": 5.2.0",
      "259:     \"@types/command-line-usage\": 5.0.2",
      "260:     \"@types/node\": 18.14.5",
      "261:     \"@types/pad-left\": 2.1.1",
      "262:     command-line-args: 5.2.1",
      "263:     command-line-usage: 6.1.3",
      "264:     flatbuffers: 23.3.3",
      "265:     json-bignum: ^0.0.3",
      "266:     pad-left: ^2.1.0",
      "267:     tslib: ^2.5.0",
      "268:   checksum: 67b2791e14d5377b1d160a0d8390decc386e013c517713f8b9c100737a0e478a394086d91a8c846848d4e30289070a119d8e65191998f4c2555b18a29564df50",
      "269:   languageName: node",
      "270:   linkType: hard",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "11112:   languageName: node",
      "11113:   linkType: hard",
      "11115: \"@langchain/anthropic@*, @langchain/anthropic@workspace:*, @langchain/anthropic@workspace:libs/langchain-anthropic\":",
      "11116:   version: 0.0.0-use.local",
      "11117:   resolution: \"@langchain/anthropic@workspace:libs/langchain-anthropic\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11097: \"@lancedb/vectordb-darwin-arm64@npm:0.4.20\":",
      "11098:   version: 0.4.20",
      "11099:   resolution: \"@lancedb/vectordb-darwin-arm64@npm:0.4.20\"",
      "11100:   conditions: os=darwin & cpu=arm64",
      "11101:   languageName: node",
      "11102:   linkType: hard",
      "11104: \"@lancedb/vectordb-darwin-x64@npm:0.4.20\":",
      "11105:   version: 0.4.20",
      "11106:   resolution: \"@lancedb/vectordb-darwin-x64@npm:0.4.20\"",
      "11107:   conditions: os=darwin & cpu=x64",
      "11108:   languageName: node",
      "11109:   linkType: hard",
      "11111: \"@lancedb/vectordb-linux-arm64-gnu@npm:0.4.20\":",
      "11112:   version: 0.4.20",
      "11113:   resolution: \"@lancedb/vectordb-linux-arm64-gnu@npm:0.4.20\"",
      "11114:   conditions: os=linux & cpu=arm64",
      "11115:   languageName: node",
      "11116:   linkType: hard",
      "11118: \"@lancedb/vectordb-linux-x64-gnu@npm:0.4.20\":",
      "11119:   version: 0.4.20",
      "11120:   resolution: \"@lancedb/vectordb-linux-x64-gnu@npm:0.4.20\"",
      "11121:   conditions: os=linux & cpu=x64",
      "11122:   languageName: node",
      "11123:   linkType: hard",
      "11125: \"@lancedb/vectordb-win32-x64-msvc@npm:0.4.20\":",
      "11126:   version: 0.4.20",
      "11127:   resolution: \"@lancedb/vectordb-win32-x64-msvc@npm:0.4.20\"",
      "11128:   conditions: os=win32 & cpu=x64",
      "11129:   languageName: node",
      "11130:   linkType: hard",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "11577:     typesense: ^1.5.3",
      "11578:     usearch: ^1.1.1",
      "11579:     uuid: ^10.0.0",
      "11581:     voy-search: 0.6.2",
      "11582:     weaviate-ts-client: ^1.4.0",
      "11583:     web-auth-library: ^1.0.3",
      "",
      "[Removed Lines]",
      "11580:     vectordb: ^0.1.4",
      "",
      "[Added Lines]",
      "11597:     vectordb: ^0.9.0",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "13039:   languageName: node",
      "13040:   linkType: hard",
      "13042: \"@neondatabase/serverless@npm:0.6.0\":",
      "13043:   version: 0.6.0",
      "13044:   resolution: \"@neondatabase/serverless@npm:0.6.0\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13059: \"@neon-rs/load@npm:^0.0.74\":",
      "13060:   version: 0.0.74",
      "13061:   resolution: \"@neon-rs/load@npm:0.0.74\"",
      "13062:   checksum: d26ec9b08cdf1a7c5aeefe98f77112d205d11b4005a7934b21fe8fd27528847e08e4749e7e6c3fc05ae9f701175a58c11a095ae6af449634df3991a2c82e1dfa",
      "13063:   languageName: node",
      "13064:   linkType: hard",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "20774:   languageName: node",
      "20775:   linkType: hard",
      "20797: \"apache-arrow@npm:^12.0.1\":",
      "20798:   version: 12.0.1",
      "20799:   resolution: \"apache-arrow@npm:12.0.1\"",
      "",
      "[Removed Lines]",
      "20777: \"apache-arrow@npm:^12.0.0\":",
      "20778:   version: 12.0.0",
      "20779:   resolution: \"apache-arrow@npm:12.0.0\"",
      "20780:   dependencies:",
      "20781:     \"@types/command-line-args\": 5.2.0",
      "20782:     \"@types/command-line-usage\": 5.0.2",
      "20783:     \"@types/node\": 18.14.5",
      "20784:     \"@types/pad-left\": 2.1.1",
      "20785:     command-line-args: 5.2.1",
      "20786:     command-line-usage: 6.1.3",
      "20787:     flatbuffers: 23.3.3",
      "20788:     json-bignum: ^0.0.3",
      "20789:     pad-left: ^2.1.0",
      "20790:     tslib: ^2.5.0",
      "20791:   bin:",
      "20792:     arrow2csv: bin/arrow2csv.js",
      "20793:   checksum: 3285189517c2b298cda42852321ce127754918513116eade6e4914c57983f68b6ba96605cfaa2202796d3d6e14755d3b3758f76c1374492affa3d95714eaca40",
      "20794:   languageName: node",
      "20795:   linkType: hard",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "27133:     typescript: ~5.1.6",
      "27134:     typesense: ^1.5.3",
      "27135:     uuid: ^10.0.0",
      "27137:     voy-search: 0.6.2",
      "27138:     weaviate-ts-client: ^2.0.0",
      "27139:     zod: ^3.22.4",
      "",
      "[Removed Lines]",
      "27136:     vectordb: ^0.1.4",
      "",
      "[Added Lines]",
      "27140:     vectordb: ^0.9.0",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "42444:   languageName: node",
      "42445:   linkType: hard",
      "42454:   languageName: node",
      "42455:   linkType: hard",
      "",
      "[Removed Lines]",
      "42447: \"vectordb@npm:^0.1.4\":",
      "42448:   version: 0.1.4",
      "42449:   resolution: \"vectordb@npm:0.1.4\"",
      "42450:   dependencies:",
      "42451:     \"@apache-arrow/ts\": ^12.0.0",
      "42452:     apache-arrow: ^12.0.0",
      "42453:   checksum: 8a40abf4466479b0b9e61687416b5ab232458401917bf9a1d5f3d8ea8c8320ecc5691174f4d4c0cfef0bb6c16328a9088419fd90ac85fd7267dbccdd1f9e55d7",
      "",
      "[Added Lines]",
      "42451: \"vectordb@npm:^0.9.0\":",
      "42452:   version: 0.9.0",
      "42453:   resolution: \"vectordb@npm:0.9.0\"",
      "42454:   dependencies:",
      "42455:     \"@lancedb/vectordb-darwin-arm64\": 0.4.20",
      "42456:     \"@lancedb/vectordb-darwin-x64\": 0.4.20",
      "42457:     \"@lancedb/vectordb-linux-arm64-gnu\": 0.4.20",
      "42458:     \"@lancedb/vectordb-linux-x64-gnu\": 0.4.20",
      "42459:     \"@lancedb/vectordb-win32-x64-msvc\": 0.4.20",
      "42460:     \"@neon-rs/load\": ^0.0.74",
      "42461:     axios: ^1.4.0",
      "42462:   peerDependencies:",
      "42463:     \"@apache-arrow/ts\": ^14.0.2",
      "42464:     apache-arrow: ^14.0.2",
      "42465:   dependenciesMeta:",
      "42466:     \"@lancedb/vectordb-darwin-arm64\":",
      "42467:       optional: true",
      "42468:     \"@lancedb/vectordb-darwin-x64\":",
      "42469:       optional: true",
      "42470:     \"@lancedb/vectordb-linux-arm64-gnu\":",
      "42471:       optional: true",
      "42472:     \"@lancedb/vectordb-linux-x64-gnu\":",
      "42473:       optional: true",
      "42474:     \"@lancedb/vectordb-win32-x64-msvc\":",
      "42475:       optional: true",
      "42476:   conditions: (os=darwin | os=linux | os=win32) & (cpu=x64 | cpu=arm64)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0a6bc45297abb3705582176c31b8815ae263a43c",
      "candidate_info": {
        "commit_hash": "0a6bc45297abb3705582176c31b8815ae263a43c",
        "repo": "langchain-ai/langchainjs",
        "commit_url": "https://github.com/langchain-ai/langchainjs/commit/0a6bc45297abb3705582176c31b8815ae263a43c",
        "files": [
          "libs/langchain-google-gauth/package.json",
          "libs/langchain-google-webauth/package.json",
          "yarn.lock"
        ],
        "message": "fix(google-gauth/webauth): Bump Google common dep (#7266)",
        "before_after_code_files": [
          "yarn.lock||yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "yarn.lock||yarn.lock"
          ],
          "candidate": [
            "yarn.lock||yarn.lock"
          ]
        }
      },
      "candidate_diff": {
        "yarn.lock||yarn.lock": [
          "File: yarn.lock -> yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "12314:   languageName: unknown",
          "12315:   linkType: soft",
          "12318:   version: 0.0.0-use.local",
          "12319:   resolution: \"@langchain/google-common@workspace:libs/langchain-google-common\"",
          "12320:   dependencies:",
          "",
          "[Removed Lines]",
          "12317: \"@langchain/google-common@^0.1.0, @langchain/google-common@workspace:*, @langchain/google-common@workspace:libs/langchain-google-common, @langchain/google-common@~0.1.2\":",
          "",
          "[Added Lines]",
          "12317: \"@langchain/google-common@^0.1.0, @langchain/google-common@workspace:*, @langchain/google-common@workspace:libs/langchain-google-common, @langchain/google-common@~0.1.3\":",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "12355:   dependencies:",
          "12356:     \"@jest/globals\": ^29.5.0",
          "12357:     \"@langchain/core\": \"workspace:*\"",
          "12359:     \"@langchain/scripts\": \">=0.1.0 <0.2.0\"",
          "12360:     \"@swc/core\": ^1.3.90",
          "12361:     \"@swc/jest\": ^0.2.29",
          "",
          "[Removed Lines]",
          "12358:     \"@langchain/google-common\": ~0.1.2",
          "",
          "[Added Lines]",
          "12358:     \"@langchain/google-common\": ~0.1.3",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "12499:   dependencies:",
          "12500:     \"@jest/globals\": ^29.5.0",
          "12501:     \"@langchain/core\": \"workspace:*\"",
          "12503:     \"@langchain/scripts\": \">=0.1.0 <0.2.0\"",
          "12504:     \"@swc/core\": ^1.3.90",
          "12505:     \"@swc/jest\": ^0.2.29",
          "",
          "[Removed Lines]",
          "12502:     \"@langchain/google-common\": ~0.1.2",
          "",
          "[Added Lines]",
          "12502:     \"@langchain/google-common\": ~0.1.3",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0fc87849e756685be78b4e1e7497c0300d97a3cd",
      "candidate_info": {
        "commit_hash": "0fc87849e756685be78b4e1e7497c0300d97a3cd",
        "repo": "langchain-ai/langchainjs",
        "commit_url": "https://github.com/langchain-ai/langchainjs/commit/0fc87849e756685be78b4e1e7497c0300d97a3cd",
        "files": [
          "examples/package.json",
          "langchain/package.json",
          "libs/langchain-community/package.json",
          "package.json",
          "yarn.lock"
        ],
        "message": "community[patch]: Loosen conflicting peer dep (#5694)\n\n* Loosen conflicting peer dep\n\n* Bound better\n\n* Deps\n\n* Bump",
        "before_after_code_files": [
          "yarn.lock||yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "yarn.lock||yarn.lock"
          ],
          "candidate": [
            "yarn.lock||yarn.lock"
          ]
        }
      },
      "candidate_diff": {
        "yarn.lock||yarn.lock": [
          "File: yarn.lock -> yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "9155:     \"@zilliz/milvus2-sdk-node\": \">=2.2.11\"",
          "9156:     apify-client: ^2.7.1",
          "9157:     assemblyai: ^4.0.0",
          "9159:     binary-extensions: ^2.2.0",
          "9160:     cassandra-driver: ^4.7.2",
          "9161:     cborg: ^4.1.1",
          "",
          "[Removed Lines]",
          "9158:     better-sqlite3: ^11.0.0",
          "",
          "[Added Lines]",
          "9158:     better-sqlite3: \">=9.4.0 <12.0.0\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "9229:     sonix-speech-recognition: ^2.1.1",
          "9230:     srt-parser-2: ^1.2.3",
          "9231:     ts-jest: ^29.1.0",
          "9233:     typescript: ~5.1.6",
          "9234:     typesense: ^1.5.3",
          "9235:     usearch: ^1.1.1",
          "",
          "[Removed Lines]",
          "9232:     typeorm: ^0.3.12",
          "",
          "[Added Lines]",
          "9232:     typeorm: ^0.3.20",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "9303:     \"@zilliz/milvus2-sdk-node\": \">=2.2.7\"",
          "9304:     apify-client: ^2.7.1",
          "9305:     assemblyai: ^4.0.0",
          "9307:     cassandra-driver: ^4.7.2",
          "9308:     cborg: ^4.1.1",
          "9309:     cheerio: ^1.0.0-rc.12",
          "",
          "[Removed Lines]",
          "9306:     better-sqlite3: ^11.0.0",
          "",
          "[Added Lines]",
          "9306:     better-sqlite3: \">=9.4.0 <12.0.0\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "9353:     replicate: ^0.29.4",
          "9354:     sonix-speech-recognition: ^2.1.1",
          "9355:     srt-parser-2: ^1.2.3",
          "9357:     typesense: ^1.5.3",
          "9358:     usearch: ^1.1.1",
          "9359:     vectordb: ^0.1.4",
          "",
          "[Removed Lines]",
          "9356:     typeorm: ^0.3.12",
          "",
          "[Added Lines]",
          "9356:     typeorm: ^0.3.20",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "17623:   languageName: node",
          "17624:   linkType: hard",
          "17629:   dependencies:",
          "17630:     bindings: ^1.5.0",
          "17631:     node-gyp: latest",
          "17632:     prebuild-install: ^7.1.1",
          "17634:   languageName: node",
          "17635:   linkType: hard",
          "",
          "[Removed Lines]",
          "17626: \"better-sqlite3@npm:^11.0.0\":",
          "17627:   version: 11.0.0",
          "17628:   resolution: \"better-sqlite3@npm:11.0.0\"",
          "17633:   checksum: 7bf02ea6ba3253f53cb36bd872f86379ebf1a66cb103d39b91c610995c4396dde2b976bdf866f07eb7d67eb6f5433aa5490a6a4f4264244f83a53562f68832dc",
          "",
          "[Added Lines]",
          "17626: \"better-sqlite3@npm:9.4.0\":",
          "17627:   version: 9.4.0",
          "17628:   resolution: \"better-sqlite3@npm:9.4.0\"",
          "17633:   checksum: a1a470fae20dfba82d6e74ae90b35ea8996c60922e95574162732d6e076e84c0c90fc4ff77ab8c27554671899eb15f284e2c8de5e4ee406aa9f7eb170eca5bee",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "20304:   languageName: node",
          "20305:   linkType: hard",
          "20314: \"date-fns@npm:^3.3.1\":",
          "20315:   version: 3.3.1",
          "20316:   resolution: \"date-fns@npm:3.3.1\"",
          "",
          "[Removed Lines]",
          "20307: \"date-fns@npm:^2.29.3\":",
          "20308:   version: 2.29.3",
          "20309:   resolution: \"date-fns@npm:2.29.3\"",
          "20310:   checksum: e01cf5b62af04e05dfff921bb9c9933310ed0e1ae9a81eb8653452e64dc841acf7f6e01e1a5ae5644d0337e9a7f936175fd2cb6819dc122fdd9c5e86c56be484",
          "20311:   languageName: node",
          "20312:   linkType: hard",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "20325:   languageName: node",
          "20326:   linkType: hard",
          "20328: \"debounce-fn@npm:^4.0.0\":",
          "20329:   version: 4.0.0",
          "20330:   resolution: \"debounce-fn@npm:4.0.0\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20321: \"dayjs@npm:^1.11.9\":",
          "20322:   version: 1.11.11",
          "20323:   resolution: \"dayjs@npm:1.11.11\"",
          "20324:   checksum: 84788275aad8a87fee4f1ce4be08861df29687aae6b7b43dd65350118a37dda56772a3902f802cb2dc651dfed447a5a8df62d88f0fb900dba8333e411190a5d5",
          "20325:   languageName: node",
          "20326:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "22637:     redis: ^4.6.13",
          "22638:     sqlite3: ^5.1.4",
          "22639:     tsx: ^3.12.3",
          "22641:     typescript: ~5.1.6",
          "22642:     typesense: ^1.5.3",
          "22643:     uuid: ^9.0.0",
          "",
          "[Removed Lines]",
          "22640:     typeorm: ^0.3.12",
          "",
          "[Added Lines]",
          "22640:     typeorm: ^0.3.20",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "27766:     sonix-speech-recognition: ^2.1.1",
          "27767:     srt-parser-2: ^1.2.3",
          "27768:     ts-jest: ^29.1.0",
          "27770:     typescript: ~5.1.6",
          "27771:     uuid: ^9.0.0",
          "27772:     weaviate-ts-client: ^2.0.0",
          "",
          "[Removed Lines]",
          "27769:     typeorm: ^0.3.12",
          "",
          "[Added Lines]",
          "27769:     typeorm: ^0.3.20",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "27821:     redis: ^4.6.4",
          "27822:     sonix-speech-recognition: ^2.1.1",
          "27823:     srt-parser-2: ^1.2.3",
          "27825:     weaviate-ts-client: \"*\"",
          "27826:     web-auth-library: ^1.0.3",
          "27827:     ws: ^8.14.2",
          "",
          "[Removed Lines]",
          "27824:     typeorm: ^0.3.12",
          "",
          "[Added Lines]",
          "27824:     typeorm: ^0.3.20",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "33141:   languageName: node",
          "33142:   linkType: hard",
          "33144: \"reflect.getprototypeof@npm:^1.0.4\":",
          "33145:   version: 1.0.4",
          "33146:   resolution: \"reflect.getprototypeof@npm:1.0.4\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33144: \"reflect-metadata@npm:^0.2.1\":",
          "33145:   version: 0.2.2",
          "33146:   resolution: \"reflect-metadata@npm:0.2.2\"",
          "33147:   checksum: a66c7b583e4efdd8f3c3124fbff33da2d0c86d8280617516308b32b2159af7a3698c961db3246387f56f6316b1d33a608f39bb2b49d813316dfc58f6d3bf3210",
          "33148:   languageName: node",
          "33149:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "36249:   languageName: node",
          "36250:   linkType: hard",
          "36255:   dependencies:",
          "36256:     \"@sqltools/formatter\": ^1.2.5",
          "36257:     app-root-path: ^3.1.0",
          "36258:     buffer: ^6.0.3",
          "36259:     chalk: ^4.1.2",
          "36260:     cli-highlight: ^2.1.11",
          "36262:     debug: ^4.3.4",
          "36263:     dotenv: ^16.0.3",
          "36266:     mkdirp: ^2.1.3",
          "36268:     sha.js: ^2.4.11",
          "36269:     tslib: ^2.5.0",
          "36270:     uuid: ^9.0.0",
          "36272:     yargs: ^17.6.2",
          "36273:   peerDependencies:",
          "36274:     \"@google-cloud/spanner\": ^5.18.0",
          "36275:     \"@sap/hana-client\": ^2.12.25",
          "36277:     hdb-pool: ^0.1.6",
          "36278:     ioredis: ^5.0.4",
          "36281:     mysql2: ^2.2.5 || ^3.0.1",
          "36283:     pg: ^8.5.1",
          "36284:     pg-native: ^3.0.0",
          "36285:     pg-query-stream: ^4.0.0",
          "",
          "[Removed Lines]",
          "36252: \"typeorm@npm:^0.3.12\":",
          "36253:   version: 0.3.12",
          "36254:   resolution: \"typeorm@npm:0.3.12\"",
          "36261:     date-fns: ^2.29.3",
          "36264:     glob: ^8.1.0",
          "36265:     js-yaml: ^4.1.0",
          "36267:     reflect-metadata: ^0.1.13",
          "36271:     xml2js: ^0.4.23",
          "36276:     better-sqlite3: ^7.1.2 || ^8.0.0",
          "36279:     mongodb: ^3.6.0",
          "36280:     mssql: ^7.3.0",
          "36282:     oracledb: ^5.1.0",
          "",
          "[Added Lines]",
          "36259: \"typeorm@npm:^0.3.20\":",
          "36260:   version: 0.3.20",
          "36261:   resolution: \"typeorm@npm:0.3.20\"",
          "36268:     dayjs: ^1.11.9",
          "36271:     glob: ^10.3.10",
          "36273:     reflect-metadata: ^0.2.1",
          "36281:     better-sqlite3: ^7.1.2 || ^8.0.0 || ^9.0.0",
          "36284:     mongodb: ^5.8.0",
          "36285:     mssql: ^9.1.1 || ^10.0.1",
          "36287:     oracledb: ^6.3.0",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "36327:     typeorm: cli.js",
          "36328:     typeorm-ts-node-commonjs: cli-ts-node-commonjs.js",
          "36329:     typeorm-ts-node-esm: cli-ts-node-esm.js",
          "36331:   languageName: node",
          "36332:   linkType: hard",
          "",
          "[Removed Lines]",
          "36330:   checksum: 67dd3b72522ba6d79770c8ed9ef87c8e60ecf11f1a76df82317bb629db8ca31121ec9dadd91a5d8051f24910367c491bc29706e2a5a4fe5de5fb8fa7c07b9e5c",
          "",
          "[Added Lines]",
          "36335:   checksum: 9d6e5ecd0688eed5a151f33fb26b6d7c3e0af0eaf14ceaefe4c1c1863cdda6eabf2e865c9df2321f7dce26e40f320b76b811e2d1d58bf43f6ce19b36aa1ed1c4",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f9f1b7f42f1ec0db11a153f3c957f22aaf52a095",
      "candidate_info": {
        "commit_hash": "f9f1b7f42f1ec0db11a153f3c957f22aaf52a095",
        "repo": "langchain-ai/langchainjs",
        "commit_url": "https://github.com/langchain-ai/langchainjs/commit/f9f1b7f42f1ec0db11a153f3c957f22aaf52a095",
        "files": [
          "docs/core_docs/docs/integrations/vectorstores/libsql.mdx",
          "libs/langchain-community/.gitignore",
          "libs/langchain-community/langchain.config.js",
          "libs/langchain-community/package.json",
          "libs/langchain-community/src/load/import_constants.ts",
          "libs/langchain-community/src/vectorstores/libsql.ts",
          "yarn.lock"
        ],
        "message": "feat(community): add libsql vectorstore (#6904)\n\nCo-authored-by: jacoblee93 <jacoblee93@gmail.com>",
        "before_after_code_files": [
          "libs/langchain-community/langchain.config.js||libs/langchain-community/langchain.config.js",
          "libs/langchain-community/src/load/import_constants.ts||libs/langchain-community/src/load/import_constants.ts",
          "libs/langchain-community/src/vectorstores/libsql.ts||libs/langchain-community/src/vectorstores/libsql.ts",
          "yarn.lock||yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "yarn.lock||yarn.lock"
          ],
          "candidate": [
            "yarn.lock||yarn.lock"
          ]
        }
      },
      "candidate_diff": {
        "libs/langchain-community/langchain.config.js||libs/langchain-community/langchain.config.js": [
          "File: libs/langchain-community/langchain.config.js -> libs/langchain-community/langchain.config.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "129:     \"vectorstores/hnswlib\": \"vectorstores/hnswlib\",",
          "130:     \"vectorstores/hanavector\": \"vectorstores/hanavector\",",
          "131:     \"vectorstores/lancedb\": \"vectorstores/lancedb\",",
          "132:     \"vectorstores/milvus\": \"vectorstores/milvus\",",
          "133:     \"vectorstores/momento_vector_index\": \"vectorstores/momento_vector_index\",",
          "134:     \"vectorstores/mongodb_atlas\": \"vectorstores/mongodb_atlas\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "132:     \"vectorstores/libsql\": \"vectorstores/libsql\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "375:     \"vectorstores/hnswlib\",",
          "376:     \"vectorstores/hanavector\",",
          "377:     \"vectorstores/lancedb\",",
          "378:     \"vectorstores/milvus\",",
          "379:     \"vectorstores/momento_vector_index\",",
          "380:     \"vectorstores/mongodb_atlas\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "379:     \"vectorstores/libsql\",",
          "",
          "---------------"
        ],
        "libs/langchain-community/src/load/import_constants.ts||libs/langchain-community/src/load/import_constants.ts": [
          "File: libs/langchain-community/src/load/import_constants.ts -> libs/langchain-community/src/load/import_constants.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "53:   \"langchain_community/vectorstores/hnswlib\",",
          "54:   \"langchain_community/vectorstores/hanavector\",",
          "55:   \"langchain_community/vectorstores/lancedb\",",
          "56:   \"langchain_community/vectorstores/milvus\",",
          "57:   \"langchain_community/vectorstores/momento_vector_index\",",
          "58:   \"langchain_community/vectorstores/mongodb_atlas\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "56:   \"langchain_community/vectorstores/libsql\",",
          "",
          "---------------"
        ],
        "libs/langchain-community/src/vectorstores/libsql.ts||libs/langchain-community/src/vectorstores/libsql.ts": [
          "File: libs/langchain-community/src/vectorstores/libsql.ts -> libs/langchain-community/src/vectorstores/libsql.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: import type { Client } from \"@libsql/client\";",
          "2: import { VectorStore } from \"@langchain/core/vectorstores\";",
          "3: import type { EmbeddingsInterface } from \"@langchain/core/embeddings\";",
          "4: import { Document } from \"@langchain/core/documents\";",
          "9: export interface LibSQLVectorStoreArgs {",
          "10:   db: Client;",
          "12:   table?: string;",
          "14:   column?: string;",
          "16: }",
          "21: export class LibSQLVectorStore extends VectorStore {",
          "22:   declare FilterType: (doc: Document) => boolean;",
          "24:   private db;",
          "26:   private readonly table: string;",
          "28:   private readonly column: string;",
          "34:   _vectorstoreType(): string {",
          "35:     return \"libsql\";",
          "36:   }",
          "44:   constructor(embeddings: EmbeddingsInterface, options: LibSQLVectorStoreArgs) {",
          "45:     super(embeddings, options);",
          "47:     this.db = options.db;",
          "48:     this.table = options.table || \"vectors\";",
          "49:     this.column = options.column || \"embedding\";",
          "50:   }",
          "57:   async addDocuments(documents: Document[]): Promise<string[]> {",
          "58:     const texts = documents.map(({ pageContent }) => pageContent);",
          "59:     const embeddings = await this.embeddings.embedDocuments(texts);",
          "61:     return this.addVectors(embeddings, documents);",
          "62:   }",
          "70:   async addVectors(",
          "71:     vectors: number[][],",
          "72:     documents: Document[]",
          "73:   ): Promise<string[]> {",
          "74:     const rows = vectors.map((embedding, idx) => ({",
          "75:       content: documents[idx].pageContent,",
          "76:       embedding: `[${embedding.join(\",\")}]`,",
          "77:       metadata: JSON.stringify(documents[idx].metadata),",
          "78:     }));",
          "80:     const batchSize = 100;",
          "81:     const ids: string[] = [];",
          "83:     for (let i = 0; i < rows.length; i += batchSize) {",
          "84:       const chunk = rows.slice(i, i + batchSize);",
          "85:       const insertQueries = chunk.map(",
          "86:         (row) =>",
          "87:           `INSERT INTO ${this.table} (content, metadata, ${this.column}) VALUES (${row.content}, ${row.metadata}, vector(${row.embedding})) RETURNING id`",
          "88:       );",
          "90:       const results = await this.db.batch(insertQueries);",
          "92:       for (const result of results) {",
          "93:         if (",
          "94:           result &&",
          "95:           result.rows &&",
          "96:           result.rows.length > 0 &&",
          "97:           result.rows[0].id != null",
          "98:         ) {",
          "99:           ids.push(result.rows[0].id.toString());",
          "100:         }",
          "101:       }",
          "102:     }",
          "104:     return ids;",
          "105:   }",
          "113:   async similaritySearchVectorWithScore(",
          "114:     query: number[],",
          "115:     k: number",
          "118:   ): Promise<[Document, number][]> {",
          "120:     if (!query.every((num) => typeof num === \"number\" && !Number.isNaN(num))) {",
          "121:       throw new Error(\"Invalid query vector: all elements must be numbers\");",
          "122:     }",
          "124:     const queryVector = `[${query.join(\",\")}]`;",
          "126:     const sql = `",
          "127:       SELECT content, metadata, vector_distance_cos(${this.column}, vector(${queryVector})) AS distance",
          "128:       FROM vector_top_k('${this.table}_idx', vector(${queryVector}), ${k})",
          "129:       JOIN ${this.table} ON ${this.table}.rowid = id",
          "130:     `;",
          "132:     const results = await this.db.execute(sql);",
          "134:     return results.rows.map((row: any) => {",
          "135:       const metadata = JSON.parse(row.metadata);",
          "137:       const doc = new Document({",
          "138:         metadata,",
          "139:         pageContent: row.content,",
          "140:       });",
          "142:       return [doc, row.distance];",
          "143:     });",
          "144:   }",
          "152:   async delete(params: { ids?: string[] | number[] }): Promise<void> {",
          "153:     if (!params.ids) {",
          "154:       await this.db.execute(`DELETE FROM ${this.table}`);",
          "155:       return;",
          "156:     }",
          "158:     const idsToDelete = params.ids.join(\", \");",
          "160:     await this.db.execute({",
          "161:       sql: `DELETE FROM ${this.table} WHERE id IN (?)`,",
          "162:       args: [idsToDelete],",
          "163:     });",
          "164:   }",
          "175:   static async fromTexts(",
          "176:     texts: string[],",
          "177:     metadatas: object[] | object,",
          "178:     embeddings: EmbeddingsInterface,",
          "179:     options: LibSQLVectorStoreArgs",
          "180:   ): Promise<LibSQLVectorStore> {",
          "181:     const docs = texts.map((text, i) => {",
          "182:       const metadata = Array.isArray(metadatas) ? metadatas[i] : metadatas;",
          "184:       return new Document({ pageContent: text, metadata });",
          "185:     });",
          "187:     return LibSQLVectorStore.fromDocuments(docs, embeddings, options);",
          "188:   }",
          "198:   static async fromDocuments(",
          "199:     docs: Document[],",
          "200:     embeddings: EmbeddingsInterface,",
          "201:     options: LibSQLVectorStoreArgs",
          "202:   ): Promise<LibSQLVectorStore> {",
          "203:     const instance = new this(embeddings, options);",
          "205:     await instance.addDocuments(docs);",
          "207:     return instance;",
          "208:   }",
          "209: }",
          "",
          "---------------"
        ],
        "yarn.lock||yarn.lock": [
          "File: yarn.lock -> yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "11469:     \"@langchain/scripts\": \">=0.1.0 <0.2.0\"",
          "11470:     \"@langchain/standard-tests\": 0.0.0",
          "11471:     \"@layerup/layerup-security\": ^1.5.12",
          "11472:     \"@mendable/firecrawl-js\": ^0.0.36",
          "11473:     \"@mlc-ai/web-llm\": \">=0.2.62 <0.3.0\"",
          "11474:     \"@mozilla/readability\": ^0.4.4",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11472:     \"@libsql/client\": ^0.14.0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11639:     \"@huggingface/inference\": ^2.6.4",
          "11640:     \"@langchain/core\": \">=0.2.21 <0.4.0\"",
          "11641:     \"@layerup/layerup-security\": ^1.5.12",
          "11642:     \"@mendable/firecrawl-js\": ^0.0.13",
          "11643:     \"@mlc-ai/web-llm\": \"*\"",
          "11644:     \"@mozilla/readability\": \"*\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11643:     \"@libsql/client\": ^0.14.0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11787:       optional: true",
          "11788:     \"@layerup/layerup-security\":",
          "11789:       optional: true",
          "11790:     \"@mendable/firecrawl-js\":",
          "11791:       optional: true",
          "11792:     \"@mlc-ai/web-llm\":",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11792:     \"@libsql/client\":",
          "11793:       optional: true",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "12869:   languageName: node",
          "12870:   linkType: hard",
          "12872: \"@mapbox/node-pre-gyp@npm:^1.0.0\":",
          "12873:   version: 1.0.10",
          "12874:   resolution: \"@mapbox/node-pre-gyp@npm:1.0.10\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12876: \"@libsql/client@npm:^0.14.0\":",
          "12877:   version: 0.14.0",
          "12878:   resolution: \"@libsql/client@npm:0.14.0\"",
          "12879:   dependencies:",
          "12880:     \"@libsql/core\": ^0.14.0",
          "12881:     \"@libsql/hrana-client\": ^0.7.0",
          "12882:     js-base64: ^3.7.5",
          "12883:     libsql: ^0.4.4",
          "12884:     promise-limit: ^2.7.0",
          "12885:   checksum: 7eeaf95d76da8870544c27fcf1206c377a0fc3df72b174393a1fb17fc92ca568d9a42d24d65e771ca77edc5108e853a7ac18540ad0242da759f2ec1191103d99",
          "12886:   languageName: node",
          "12887:   linkType: hard",
          "12889: \"@libsql/core@npm:^0.14.0\":",
          "12890:   version: 0.14.0",
          "12891:   resolution: \"@libsql/core@npm:0.14.0\"",
          "12892:   dependencies:",
          "12893:     js-base64: ^3.7.5",
          "12894:   checksum: dae12491a277e03c3729de069bee9af9689f0c178b0fd1ef342f03aab94e4ccba8801e11d0393e0e3a77596e34f101b69b7f07f16f6b34a09eca698e340bed36",
          "12895:   languageName: node",
          "12896:   linkType: hard",
          "12898: \"@libsql/darwin-arm64@npm:0.4.6\":",
          "12899:   version: 0.4.6",
          "12900:   resolution: \"@libsql/darwin-arm64@npm:0.4.6\"",
          "12901:   conditions: os=darwin & cpu=arm64",
          "12902:   languageName: node",
          "12903:   linkType: hard",
          "12905: \"@libsql/darwin-x64@npm:0.4.6\":",
          "12906:   version: 0.4.6",
          "12907:   resolution: \"@libsql/darwin-x64@npm:0.4.6\"",
          "12908:   conditions: os=darwin & cpu=x64",
          "12909:   languageName: node",
          "12910:   linkType: hard",
          "12912: \"@libsql/hrana-client@npm:^0.7.0\":",
          "12913:   version: 0.7.0",
          "12914:   resolution: \"@libsql/hrana-client@npm:0.7.0\"",
          "12915:   dependencies:",
          "12916:     \"@libsql/isomorphic-fetch\": ^0.3.1",
          "12917:     \"@libsql/isomorphic-ws\": ^0.1.5",
          "12918:     js-base64: ^3.7.5",
          "12919:     node-fetch: ^3.3.2",
          "12920:   checksum: 0d36931ca3a01144dc14294d1d9666ee64724c6ab4889890ff0bc45564369503f6abccbc448518485af107bd69f49d35878059c46d98dacb34db4757b52c406a",
          "12921:   languageName: node",
          "12922:   linkType: hard",
          "12924: \"@libsql/isomorphic-fetch@npm:^0.3.1\":",
          "12925:   version: 0.3.1",
          "12926:   resolution: \"@libsql/isomorphic-fetch@npm:0.3.1\"",
          "12927:   checksum: 9f131cae3b14c39712f1140e21b2ab1ccc81b5f6ad2aa90d739dc8df0602109a5c4c0ea820dcd39632ace7a4b247bc31e2a5e79cd6efaf5f1777650aac9ac694",
          "12928:   languageName: node",
          "12929:   linkType: hard",
          "12931: \"@libsql/isomorphic-ws@npm:^0.1.5\":",
          "12932:   version: 0.1.5",
          "12933:   resolution: \"@libsql/isomorphic-ws@npm:0.1.5\"",
          "12934:   dependencies:",
          "12935:     \"@types/ws\": ^8.5.4",
          "12936:     ws: ^8.13.0",
          "12937:   checksum: 8255a0f4cae8ea66c94d6ab02ca57ddc7d6472c43700fd089e615e2df56028bf3723f694c91fbd76db403772f43f49cf2545e29e7ac18f77aa482fcfed71c940",
          "12938:   languageName: node",
          "12939:   linkType: hard",
          "12941: \"@libsql/linux-arm64-gnu@npm:0.4.6\":",
          "12942:   version: 0.4.6",
          "12943:   resolution: \"@libsql/linux-arm64-gnu@npm:0.4.6\"",
          "12944:   conditions: os=linux & cpu=arm64",
          "12945:   languageName: node",
          "12946:   linkType: hard",
          "12948: \"@libsql/linux-arm64-musl@npm:0.4.6\":",
          "12949:   version: 0.4.6",
          "12950:   resolution: \"@libsql/linux-arm64-musl@npm:0.4.6\"",
          "12951:   conditions: os=linux & cpu=arm64",
          "12952:   languageName: node",
          "12953:   linkType: hard",
          "12955: \"@libsql/linux-x64-gnu@npm:0.4.6\":",
          "12956:   version: 0.4.6",
          "12957:   resolution: \"@libsql/linux-x64-gnu@npm:0.4.6\"",
          "12958:   conditions: os=linux & cpu=x64",
          "12959:   languageName: node",
          "12960:   linkType: hard",
          "12962: \"@libsql/linux-x64-musl@npm:0.4.6\":",
          "12963:   version: 0.4.6",
          "12964:   resolution: \"@libsql/linux-x64-musl@npm:0.4.6\"",
          "12965:   conditions: os=linux & cpu=x64",
          "12966:   languageName: node",
          "12967:   linkType: hard",
          "12969: \"@libsql/win32-x64-msvc@npm:0.4.6\":",
          "12970:   version: 0.4.6",
          "12971:   resolution: \"@libsql/win32-x64-msvc@npm:0.4.6\"",
          "12972:   conditions: os=win32 & cpu=x64",
          "12973:   languageName: node",
          "12974:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "13057:   languageName: node",
          "13058:   linkType: hard",
          "13060: \"@neon-rs/load@npm:^0.0.74\":",
          "13061:   version: 0.0.74",
          "13062:   resolution: \"@neon-rs/load@npm:0.0.74\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13164: \"@neon-rs/load@npm:^0.0.4\":",
          "13165:   version: 0.0.4",
          "13166:   resolution: \"@neon-rs/load@npm:0.0.4\"",
          "13167:   checksum: ceed42a681980f4c96152857f6846434e3a89e25cac14228604a55e7992e96af01f30629026a498341984b405a2687099e56256a9eded9fee5393facca1ef762",
          "13168:   languageName: node",
          "13169:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "19565:   languageName: node",
          "19566:   linkType: hard",
          "19568: \"@types/ws@npm:^8.5.5\":",
          "19569:   version: 8.5.7",
          "19570:   resolution: \"@types/ws@npm:8.5.7\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19679: \"@types/ws@npm:^8.5.4\":",
          "19680:   version: 8.5.12",
          "19681:   resolution: \"@types/ws@npm:8.5.12\"",
          "19682:   dependencies:",
          "19683:     \"@types/node\": \"*\"",
          "19684:   checksum: ddefb6ad1671f70ce73b38a5f47f471d4d493864fca7c51f002a86e5993d031294201c5dced6d5018fb8905ad46888d65c7f20dd54fc165910b69f42fba9a6d0",
          "19685:   languageName: node",
          "19686:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "24982:   languageName: node",
          "24983:   linkType: hard",
          "24985: \"detect-libc@npm:^2.0.0\":",
          "24986:   version: 2.0.1",
          "24987:   resolution: \"detect-libc@npm:2.0.1\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "25105: \"detect-libc@npm:2.0.2, detect-libc@npm:^2.0.2\":",
          "25106:   version: 2.0.2",
          "25107:   resolution: \"detect-libc@npm:2.0.2\"",
          "25108:   checksum: 2b2cd3649b83d576f4be7cc37eb3b1815c79969c8b1a03a40a4d55d83bc74d010753485753448eacb98784abf22f7dbd3911fd3b60e29fda28fed2d1a997944d",
          "25109:   languageName: node",
          "25110:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "24989:   languageName: node",
          "24990:   linkType: hard",
          "24999: \"detect-newline@npm:^3.0.0\":",
          "25000:   version: 3.1.0",
          "25001:   resolution: \"detect-newline@npm:3.1.0\"",
          "",
          "[Removed Lines]",
          "24992: \"detect-libc@npm:^2.0.2\":",
          "24993:   version: 2.0.2",
          "24994:   resolution: \"detect-libc@npm:2.0.2\"",
          "24995:   checksum: 2b2cd3649b83d576f4be7cc37eb3b1815c79969c8b1a03a40a4d55d83bc74d010753485753448eacb98784abf22f7dbd3911fd3b60e29fda28fed2d1a997944d",
          "24996:   languageName: node",
          "24997:   linkType: hard",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "32086:   languageName: node",
          "32087:   linkType: hard",
          "32090:   version: 3.7.7",
          "32091:   resolution: \"js-base64@npm:3.7.7\"",
          "32092:   checksum: d1b02971db9dc0fd35baecfaf6ba499731fb44fe3373e7e1d6681fbd3ba665f29e8d9d17910254ef8104e2cb8b44117fe4202d3dc54c7cafe9ba300fe5433358",
          "",
          "[Removed Lines]",
          "32089: \"js-base64@npm:3.7.7\":",
          "",
          "[Added Lines]",
          "32209: \"js-base64@npm:3.7.7, js-base64@npm:^3.7.5\":",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "32819:   languageName: node",
          "32820:   linkType: hard",
          "32822: \"lie@npm:~3.3.0\":",
          "32823:   version: 3.3.0",
          "32824:   resolution: \"lie@npm:3.3.0\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32942: \"libsql@npm:^0.4.4\":",
          "32943:   version: 0.4.6",
          "32944:   resolution: \"libsql@npm:0.4.6\"",
          "32945:   dependencies:",
          "32946:     \"@libsql/darwin-arm64\": 0.4.6",
          "32947:     \"@libsql/darwin-x64\": 0.4.6",
          "32948:     \"@libsql/linux-arm64-gnu\": 0.4.6",
          "32949:     \"@libsql/linux-arm64-musl\": 0.4.6",
          "32950:     \"@libsql/linux-x64-gnu\": 0.4.6",
          "32951:     \"@libsql/linux-x64-musl\": 0.4.6",
          "32952:     \"@libsql/win32-x64-msvc\": 0.4.6",
          "32953:     \"@neon-rs/load\": ^0.0.4",
          "32954:     detect-libc: 2.0.2",
          "32955:   dependenciesMeta:",
          "32956:     \"@libsql/darwin-arm64\":",
          "32957:       optional: true",
          "32958:     \"@libsql/darwin-x64\":",
          "32959:       optional: true",
          "32960:     \"@libsql/linux-arm64-gnu\":",
          "32961:       optional: true",
          "32962:     \"@libsql/linux-arm64-musl\":",
          "32963:       optional: true",
          "32964:     \"@libsql/linux-x64-gnu\":",
          "32965:       optional: true",
          "32966:     \"@libsql/linux-x64-musl\":",
          "32967:       optional: true",
          "32968:     \"@libsql/win32-x64-msvc\":",
          "32969:       optional: true",
          "32970:   checksum: 0c2e864172d43bbf9555eeb1e5aba41e1fe86cb3eb05f99a8ed1b92afc702ec84193fb207163d7e3b291a65d86735f45a86138c03b919fcf0edca054cd0ea1b3",
          "32971:   conditions: (os=darwin | os=linux | os=win32) & (cpu=x64 | cpu=arm64 | cpu=wasm32)",
          "32972:   languageName: node",
          "32973:   linkType: hard",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "37166:   languageName: node",
          "37167:   linkType: hard",
          "37169: \"promise-retry@npm:^2.0.1\":",
          "37170:   version: 2.0.1",
          "37171:   resolution: \"promise-retry@npm:2.0.1\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "37322: \"promise-limit@npm:^2.7.0\":",
          "37323:   version: 2.7.0",
          "37324:   resolution: \"promise-limit@npm:2.7.0\"",
          "37325:   checksum: 3e20a46d752ab41c921feceb668b3a6d000438573e71342d42bf63373fdbafbf4b6a3f88ef5ff902a2a37be28152dc74e618e863134fd4c08c196448f4a6d28f",
          "37326:   languageName: node",
          "37327:   linkType: hard",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "05cccee1598acccbd55c377dc0e880cc82e45e38",
      "candidate_info": {
        "commit_hash": "05cccee1598acccbd55c377dc0e880cc82e45e38",
        "repo": "langchain-ai/langchainjs",
        "commit_url": "https://github.com/langchain-ai/langchainjs/commit/05cccee1598acccbd55c377dc0e880cc82e45e38",
        "files": [
          "docs/core_docs/docs/concepts/retrieval.mdx",
          "docs/core_docs/docs/how_to/index.mdx",
          "docs/core_docs/docs/how_to/query_constructing_filters.ipynb",
          "docs/core_docs/docs/how_to/query_few_shot.ipynb",
          "docs/core_docs/docs/how_to/query_high_cardinality.ipynb",
          "docs/core_docs/docs/how_to/query_multiple_queries.ipynb",
          "docs/core_docs/docs/how_to/query_multiple_retrievers.ipynb",
          "docs/core_docs/docs/how_to/query_no_queries.ipynb",
          "docs/core_docs/docs/tutorials/chatbot.ipynb",
          "docs/core_docs/docs/tutorials/classification.ipynb",
          "docs/core_docs/docs/tutorials/extraction.ipynb",
          "docs/core_docs/docs/tutorials/index.mdx",
          "docs/core_docs/docs/tutorials/llm_chain.ipynb",
          "docs/core_docs/docs/tutorials/local_rag.ipynb",
          "docs/core_docs/docs/tutorials/pdf_qa.ipynb",
          "docs/core_docs/docs/tutorials/qa_chat_history.ipynb",
          "docs/core_docs/docs/tutorials/query_analysis.ipynb",
          "docs/core_docs/docs/tutorials/rag.ipynb",
          "docs/core_docs/docs/tutorials/retrievers.ipynb",
          "docs/core_docs/docs/tutorials/sql_qa.ipynb",
          "docs/core_docs/docs/tutorials/sql_qa.mdx",
          "docs/core_docs/docs/tutorials/summarization.ipynb",
          "docs/core_docs/docs/tutorials/summarization.mdx",
          "docs/core_docs/package.json",
          "docs/core_docs/static/img/graph_img_rag.png",
          "docs/core_docs/static/img/graph_img_rag_part_2.png",
          "docs/core_docs/static/img/graph_img_rag_qa.png",
          "docs/core_docs/static/img/graph_img_react.png",
          "docs/core_docs/static/img/graph_img_sql_qa.png",
          "docs/core_docs/static/img/graph_img_sql_qa_interrupt.png",
          "docs/core_docs/static/img/graph_img_summarization.png",
          "docs/core_docs/vercel.json",
          "examples/package.json",
          "yarn.lock"
        ],
        "message": "docs: update tutorials (#7358)",
        "before_after_code_files": [
          "yarn.lock||yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "yarn.lock||yarn.lock"
          ],
          "candidate": [
            "yarn.lock||yarn.lock"
          ]
        }
      },
      "candidate_diff": {
        "yarn.lock||yarn.lock": [
          "File: yarn.lock -> yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "12650:   languageName: unknown",
          "12651:   linkType: soft",
          "12656:   dependencies:",
          "12657:     uuid: ^10.0.0",
          "12658:   peerDependencies:",
          "12659:     \"@langchain/core\": \">=0.2.31 <0.4.0\"",
          "12661:   languageName: node",
          "12662:   linkType: hard",
          "12667:   dependencies:",
          "12670:     uuid: ^10.0.0",
          "12671:     zod: ^3.23.8",
          "12672:   peerDependencies:",
          "12675:   languageName: node",
          "12676:   linkType: hard",
          "",
          "[Removed Lines]",
          "12653: \"@langchain/langgraph-checkpoint@npm:~0.0.6\":",
          "12654:   version: 0.0.6",
          "12655:   resolution: \"@langchain/langgraph-checkpoint@npm:0.0.6\"",
          "12660:   checksum: 7303a0f92f6474757bc9484314f36566a0785d8167ead65483fdada2921447e153a24754629ee601a168d2a39b6cc6d0c57ec34d607e10225619b9d5d30c8a5a",
          "12664: \"@langchain/langgraph@npm:0.2.3, @langchain/langgraph@npm:^0.2.3\":",
          "12665:   version: 0.2.3",
          "12666:   resolution: \"@langchain/langgraph@npm:0.2.3\"",
          "12668:     \"@langchain/langgraph-checkpoint\": ~0.0.6",
          "12669:     double-ended-queue: ^2.1.0-0",
          "12673:     \"@langchain/core\": \">=0.2.31 <0.4.0\"",
          "12674:   checksum: 09d423228633f4bfee24b15e9f81eee57e96fecf9914f1e1c1f40f9436d120de912b8c987da356591c6eae0ee2bcf3759ab8e0ff762f87bc4f3f73e4098c12e9",
          "",
          "[Added Lines]",
          "12653: \"@langchain/langgraph-checkpoint@npm:~0.0.13\":",
          "12654:   version: 0.0.13",
          "12655:   resolution: \"@langchain/langgraph-checkpoint@npm:0.0.13\"",
          "12660:   checksum: 721f6a99119e4445504d34d311f0c38c025ca65be04731c49915c08d6e7a2b5c9917b16e8c2f7b1ff9dd9f23ae56a4aa0918d902e0044ebdc8bf80704671163b",
          "12664: \"@langchain/langgraph-sdk@npm:~0.0.21\":",
          "12665:   version: 0.0.32",
          "12666:   resolution: \"@langchain/langgraph-sdk@npm:0.0.32\"",
          "12668:     \"@types/json-schema\": ^7.0.15",
          "12669:     p-queue: ^6.6.2",
          "12670:     p-retry: 4",
          "12671:     uuid: ^9.0.0",
          "12672:   checksum: dd0e3fd1f3880e1ddff65108f338e75365bdff60f8ca5dc4e1b1e1be79fa216f1e599fa5d7f62ab9b44778787426f20b82db4e97463d6f3f4eda43f81666bfe9",
          "12673:   languageName: node",
          "12674:   linkType: hard",
          "12676: \"@langchain/langgraph@npm:^0.2.34\":",
          "12677:   version: 0.2.34",
          "12678:   resolution: \"@langchain/langgraph@npm:0.2.34\"",
          "12679:   dependencies:",
          "12680:     \"@langchain/langgraph-checkpoint\": ~0.0.13",
          "12681:     \"@langchain/langgraph-sdk\": ~0.0.21",
          "12685:     \"@langchain/core\": \">=0.2.36 <0.3.0 || >=0.3.9 < 0.4.0\"",
          "12686:   checksum: b60a639ef0b368637c8663f2ca89ea95192408d4117c1ea7d93cfa8cb4edb016c684bb7f8ace5ba1cbbb7279c99e5dfa0929dcdf2a284a0c85ae4b5a73baa23e",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "19431:   languageName: node",
          "19432:   linkType: hard",
          "19435:   version: 7.0.15",
          "19436:   resolution: \"@types/json-schema@npm:7.0.15\"",
          "19437:   checksum: 97ed0cb44d4070aecea772b7b2e2ed971e10c81ec87dd4ecc160322ffa55ff330dace1793489540e3e318d90942064bb697cc0f8989391797792d919737b3b98",
          "",
          "[Removed Lines]",
          "19434: \"@types/json-schema@npm:^7.0.11, @types/json-schema@npm:^7.0.12, @types/json-schema@npm:^7.0.6\":",
          "",
          "[Added Lines]",
          "19446: \"@types/json-schema@npm:^7.0.11, @types/json-schema@npm:^7.0.12, @types/json-schema@npm:^7.0.15, @types/json-schema@npm:^7.0.6\":",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "24118:     \"@docusaurus/preset-classic\": 2.4.3",
          "24119:     \"@docusaurus/remark-plugin-npm2yarn\": 2.4.3",
          "24120:     \"@docusaurus/theme-mermaid\": 2.4.3",
          "24122:     \"@langchain/scripts\": \"workspace:*\"",
          "24123:     \"@mdx-js/react\": ^1.6.22",
          "24124:     \"@microsoft/fetch-event-source\": ^2.0.1",
          "",
          "[Removed Lines]",
          "24121:     \"@langchain/langgraph\": 0.2.3",
          "",
          "[Added Lines]",
          "24133:     \"@langchain/langgraph\": ^0.2.34",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "25903:   languageName: node",
          "25904:   linkType: hard",
          "25913: \"dpdm@npm:3.12.0\":",
          "25914:   version: 3.12.0",
          "25915:   resolution: \"dpdm@npm:3.12.0\"",
          "",
          "[Removed Lines]",
          "25906: \"double-ended-queue@npm:^2.1.0-0\":",
          "25907:   version: 2.1.0-0",
          "25908:   resolution: \"double-ended-queue@npm:2.1.0-0\"",
          "25909:   checksum: 3030cf9dcf6f8e7d8cb6ae5b7304890445d7c32233a614e400ba7b378086ad76f5822d0e501afd5ffe0af1de4bcb842fa23d4c79174d54f6566399435fafc271",
          "25910:   languageName: node",
          "25911:   linkType: hard",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "27688:     \"@langchain/google-vertexai\": \"workspace:*\"",
          "27689:     \"@langchain/google-vertexai-web\": \"workspace:*\"",
          "27690:     \"@langchain/groq\": \"workspace:*\"",
          "27692:     \"@langchain/mistralai\": \"workspace:*\"",
          "27693:     \"@langchain/mongodb\": \"workspace:*\"",
          "27694:     \"@langchain/nomic\": \"workspace:*\"",
          "",
          "[Removed Lines]",
          "27691:     \"@langchain/langgraph\": ^0.2.3",
          "",
          "[Added Lines]",
          "27696:     \"@langchain/langgraph\": ^0.2.34",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0050a558abda22fa411b0ee624ea1224cdb61c10",
      "candidate_info": {
        "commit_hash": "0050a558abda22fa411b0ee624ea1224cdb61c10",
        "repo": "langchain-ai/langchainjs",
        "commit_url": "https://github.com/langchain-ai/langchainjs/commit/0050a558abda22fa411b0ee624ea1224cdb61c10",
        "files": [
          "libs/langchain-ollama/package.json",
          "libs/langchain-ollama/src/chat_models.ts",
          "libs/langchain-ollama/src/tests/chat_models_structured_output.int.test.ts",
          "yarn.lock"
        ],
        "message": "feat(ollama): Add support for Ollama built-in JSON schema with withStructuredOutput (#7672)",
        "before_after_code_files": [
          "libs/langchain-ollama/src/chat_models.ts||libs/langchain-ollama/src/chat_models.ts",
          "libs/langchain-ollama/src/tests/chat_models-tools.int.test.ts||libs/langchain-ollama/src/tests/chat_models_structured_output.int.test.ts",
          "yarn.lock||yarn.lock"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "yarn.lock||yarn.lock"
          ],
          "candidate": [
            "yarn.lock||yarn.lock"
          ]
        }
      },
      "candidate_diff": {
        "libs/langchain-ollama/src/chat_models.ts||libs/langchain-ollama/src/chat_models.ts": [
          "File: libs/langchain-ollama/src/chat_models.ts -> libs/langchain-ollama/src/chat_models.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "3:   UsageMetadata,",
          "4:   type BaseMessage,",
          "5: } from \"@langchain/core/messages\";",
          "7: import { CallbackManagerForLLMRun } from \"@langchain/core/callbacks/manager\";",
          "8: import {",
          "9:   type BaseChatModelParams,",
          "",
          "[Removed Lines]",
          "6: import { BaseLanguageModelInput } from \"@langchain/core/language_models/base\";",
          "",
          "[Added Lines]",
          "6: import {",
          "7:   BaseLanguageModelInput,",
          "8:   StructuredOutputMethodOptions,",
          "9: } from \"@langchain/core/language_models/base\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "21:   Message as OllamaMessage,",
          "22:   Tool as OllamaTool,",
          "23: } from \"ollama\";",
          "25: import { convertToOpenAITool } from \"@langchain/core/utils/function_calling\";",
          "26: import { concat } from \"@langchain/core/utils/stream\";",
          "27: import {",
          "28:   convertOllamaMessagesToLangChain,",
          "29:   convertToOllamaMessages,",
          "",
          "[Removed Lines]",
          "24: import { Runnable } from \"@langchain/core/runnables\";",
          "",
          "[Added Lines]",
          "27: import {",
          "28:   Runnable,",
          "29:   RunnablePassthrough,",
          "30:   RunnableSequence,",
          "31: } from \"@langchain/core/runnables\";",
          "34: import {",
          "35:   JsonOutputParser,",
          "36:   StructuredOutputParser,",
          "37: } from \"@langchain/core/output_parsers\";",
          "38: import { isZodSchema } from \"@langchain/core/utils/types\";",
          "39: import { z } from \"zod\";",
          "40: import { zodToJsonSchema } from \"zod-to-json-schema\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "37:   stop?: string[];",
          "38:   tools?: BindToolsInput[];",
          "39: }",
          "41: export interface PullModelOptions {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54:   format?: string | Record<string, any>;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "83:   checkOrPullModel?: boolean;",
          "84:   streaming?: boolean;",
          "86: }",
          "",
          "[Removed Lines]",
          "85:   format?: string;",
          "",
          "[Added Lines]",
          "102:   format?: string | Record<string, any>;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "454:   streaming?: boolean;",
          "458:   keepAlive?: string | number;",
          "",
          "[Removed Lines]",
          "456:   format?: string;",
          "",
          "[Added Lines]",
          "474:   format?: string | Record<string, any>;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "576:     return {",
          "577:       model: this.model,",
          "579:       keep_alive: this.keepAlive,",
          "580:       options: {",
          "581:         numa: this.numa,",
          "",
          "[Removed Lines]",
          "578:       format: this.format,",
          "",
          "[Added Lines]",
          "596:       format: options?.format ?? this.format,",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "763:       }),",
          "764:     });",
          "765:   }",
          "766: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "785:   withStructuredOutput<",
          "787:     RunOutput extends Record<string, any> = Record<string, any>",
          "788:   >(",
          "789:     outputSchema:",
          "790:       | z.ZodType<RunOutput>",
          "792:       | Record<string, any>,",
          "793:     config?: StructuredOutputMethodOptions<false>",
          "794:   ): Runnable<BaseLanguageModelInput, RunOutput>;",
          "796:   withStructuredOutput<",
          "798:     RunOutput extends Record<string, any> = Record<string, any>",
          "799:   >(",
          "800:     outputSchema:",
          "801:       | z.ZodType<RunOutput>",
          "803:       | Record<string, any>,",
          "804:     config?: StructuredOutputMethodOptions<true>",
          "805:   ): Runnable<BaseLanguageModelInput, { raw: BaseMessage; parsed: RunOutput }>;",
          "807:   withStructuredOutput<",
          "809:     RunOutput extends Record<string, any> = Record<string, any>",
          "810:   >(",
          "811:     outputSchema:",
          "812:       | z.ZodType<RunOutput>",
          "814:       | Record<string, any>,",
          "815:     config?: StructuredOutputMethodOptions<boolean>",
          "816:   ):",
          "817:     | Runnable<BaseLanguageModelInput, RunOutput>",
          "818:     | Runnable<",
          "819:         BaseLanguageModelInput,",
          "820:         {",
          "821:           raw: BaseMessage;",
          "822:           parsed: RunOutput;",
          "823:         }",
          "824:       >;",
          "826:   withStructuredOutput<",
          "828:     RunOutput extends Record<string, any> = Record<string, any>",
          "829:   >(",
          "830:     outputSchema:",
          "831:       | z.ZodType<RunOutput>",
          "833:       | Record<string, any>,",
          "834:     config?: StructuredOutputMethodOptions<boolean>",
          "835:   ):",
          "836:     | Runnable<BaseLanguageModelInput, RunOutput>",
          "837:     | Runnable<",
          "838:         BaseLanguageModelInput,",
          "839:         {",
          "840:           raw: BaseMessage;",
          "841:           parsed: RunOutput;",
          "842:         }",
          "843:       > {",
          "845:     if (config?.method === \"jsonSchema\") {",
          "846:       const outputSchemaIsZod = isZodSchema(outputSchema);",
          "847:       const jsonSchema = outputSchemaIsZod",
          "848:         ? zodToJsonSchema(outputSchema)",
          "849:         : outputSchema;",
          "850:       const llm = this.bind({",
          "851:         format: jsonSchema,",
          "852:       });",
          "853:       const outputParser = outputSchemaIsZod",
          "854:         ? StructuredOutputParser.fromZodSchema(outputSchema)",
          "855:         : new JsonOutputParser<RunOutput>();",
          "857:       if (!config?.includeRaw) {",
          "858:         return llm.pipe(outputParser) as Runnable<",
          "859:           BaseLanguageModelInput,",
          "860:           RunOutput",
          "861:         >;",
          "862:       }",
          "864:       const parserAssign = RunnablePassthrough.assign({",
          "866:         parsed: (input: any, config) => outputParser.invoke(input.raw, config),",
          "867:       });",
          "868:       const parserNone = RunnablePassthrough.assign({",
          "869:         parsed: () => null,",
          "870:       });",
          "871:       const parsedWithFallback = parserAssign.withFallbacks({",
          "872:         fallbacks: [parserNone],",
          "873:       });",
          "874:       return RunnableSequence.from<",
          "875:         BaseLanguageModelInput,",
          "876:         { raw: BaseMessage; parsed: RunOutput }",
          "877:       >([",
          "878:         {",
          "879:           raw: llm,",
          "880:         },",
          "881:         parsedWithFallback,",
          "882:       ]);",
          "883:     } else {",
          "886:       return super.withStructuredOutput<RunOutput>(outputSchema, config as any);",
          "887:     }",
          "888:   }",
          "",
          "---------------"
        ],
        "libs/langchain-ollama/src/tests/chat_models-tools.int.test.ts||libs/langchain-ollama/src/tests/chat_models_structured_output.int.test.ts": [
          "File: libs/langchain-ollama/src/tests/chat_models-tools.int.test.ts -> libs/langchain-ollama/src/tests/chat_models_structured_output.int.test.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "89:   expect(result.location).not.toBe(\"\");",
          "90: });",
          "93:   const model = new ChatOllama({",
          "94:     model: \"llama3-groq-tool-use\",",
          "95:     maxRetries: 1,",
          "",
          "[Removed Lines]",
          "92: test(\"Ollama can call withStructuredOutput includeRaw\", async () => {",
          "",
          "[Added Lines]",
          "92: test(\"Ollama can call withStructuredOutput includeRaw JSON Schema\", async () => {",
          "93:   const model = new ChatOllama({",
          "94:     model: \"llama3-groq-tool-use\",",
          "95:     maxRetries: 1,",
          "96:   }).withStructuredOutput(weatherTool.schema, {",
          "97:     name: weatherTool.name,",
          "98:     includeRaw: true,",
          "99:     method: \"jsonSchema\",",
          "100:   });",
          "102:   const result = await model.invoke(messageHistory);",
          "103:   expect(result).toBeDefined();",
          "104:   expect(result.parsed.location).toBeDefined();",
          "105:   expect(result.parsed.location).not.toBe(\"\");",
          "106:   expect((result.raw as AIMessage).tool_calls?.length).toBe(0);",
          "107: });",
          "109: test(\"Ollama can call withStructuredOutput includeRaw with tool calling\", async () => {",
          "",
          "---------------"
        ],
        "yarn.lock||yarn.lock": [
          "File: yarn.lock -> yarn.lock",
          "--- Hunk 1 ---",
          "[Context before]",
          "12990:     eslint-plugin-prettier: ^4.2.1",
          "12991:     jest: ^29.5.0",
          "12992:     jest-environment-node: ^29.6.4",
          "12994:     prettier: ^2.8.3",
          "12995:     release-it: ^17.6.0",
          "12996:     rollup: ^4.5.2",
          "12997:     ts-jest: ^29.1.0",
          "12998:     typescript: <5.2.0",
          "12999:     uuid: ^10.0.0",
          "13002:   peerDependencies:",
          "13003:     \"@langchain/core\": \">=0.2.21 <0.4.0\"",
          "13004:   languageName: unknown",
          "",
          "[Removed Lines]",
          "12993:     ollama: ^0.5.9",
          "13000:     zod: ^3.22.4",
          "13001:     zod-to-json-schema: ^3.23.0",
          "",
          "[Added Lines]",
          "12993:     ollama: ^0.5.12",
          "13000:     zod: ^3.24.1",
          "13001:     zod-to-json-schema: ^3.24.1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "36216:   languageName: node",
          "36217:   linkType: hard",
          "36222:   dependencies:",
          "36223:     whatwg-fetch: ^3.6.20",
          "36225:   languageName: node",
          "36226:   linkType: hard",
          "",
          "[Removed Lines]",
          "36219: \"ollama@npm:^0.5.9\":",
          "36220:   version: 0.5.9",
          "36221:   resolution: \"ollama@npm:0.5.9\"",
          "36224:   checksum: bfaadcec6273d86fcc7c94e5e9e571a7b6b84b852b407a473f3bac7dc69b7b11815a163ae549b5318267a00f192d39696225309812319d2edc8a98a079ace475",
          "",
          "[Added Lines]",
          "36219: \"ollama@npm:^0.5.12\":",
          "36220:   version: 0.5.12",
          "36221:   resolution: \"ollama@npm:0.5.12\"",
          "36224:   checksum: 0abc1151d2cfd02198829f706f8efca978c8562691e7502924166798f6a0cd7e1bf51e085d313ddf5a76507a36ffa12b48a66d4dd659b419474c2f33e3f03b44",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "44942:   languageName: node",
          "44943:   linkType: hard",
          "44945: \"zod@npm:3.23.8\":",
          "44946:   version: 3.23.8",
          "44947:   resolution: \"zod@npm:3.23.8\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44945: \"zod-to-json-schema@npm:^3.24.1\":",
          "44946:   version: 3.24.1",
          "44947:   resolution: \"zod-to-json-schema@npm:3.24.1\"",
          "44948:   peerDependencies:",
          "44949:     zod: ^3.24.1",
          "44950:   checksum: 7195563f611bc21ea7f44129b8e32780125a9bd98b2e6b8709ac98bd2645729fecd87b8aeeaa8789617ee3f38e6585bab23dd613e2a35c31c6c157908f7a1681",
          "44951:   languageName: node",
          "44952:   linkType: hard",
          "",
          "---------------"
        ]
      }
    }
  ]
}