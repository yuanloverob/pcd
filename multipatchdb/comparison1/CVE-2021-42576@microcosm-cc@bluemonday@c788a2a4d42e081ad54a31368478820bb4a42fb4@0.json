{
  "cve_id": "CVE-2021-42576",
  "cve_desc": "The bluemonday sanitizer before 1.0.16 for Go, and before 0.0.8 for Python (in pybluemonday), does not properly enforce policies associated with the SELECT, STYLE, and OPTION elements.",
  "repo": "microcosm-cc/bluemonday",
  "patch_hash": "c788a2a4d42e081ad54a31368478820bb4a42fb4",
  "patch_info": {
    "commit_hash": "c788a2a4d42e081ad54a31368478820bb4a42fb4",
    "repo": "microcosm-cc/bluemonday",
    "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/c788a2a4d42e081ad54a31368478820bb4a42fb4",
    "files": [
      "CREDITS.md",
      "README.md",
      "policy.go",
      "policy_test.go",
      "sanitize.go",
      "sanitize_test.go"
    ],
    "message": "Prevent a HTML sanitization vulnerability\n\nCVE-2021-42576\n\nA vulnerability was discovered by https://github.com/TomAnthony https://www.tomanthony.co.uk/ which allowed the contents of a `style` tag to be leaked unsanitized by bluemonday into the HTML output. Further it was demonstrated that if the form elements `select` and `option` were allowed by the policy that this could result in a successful XSS.\n\nYou would only be vulnerable to if if you allowed `style`, `select` and `option` in your HTML sanitization policy:\n\n```go\np := bluemonday.NewPolicy()\np.AllowElements(\"style\",\"select\")\nhtml := p.Sanitize(`<select><option><style><script>alert(1)</script>`)\nfmt.Println(html)\n```\n\nbluemonday very strongly recommends not allowing the `style` element in a policy. It is fundamentally unsafe as we do not have a CSS sanitizer and the content is passed through unmodified.\n\nbluemonday has been updated to explicitly suppress `style` and `script` elements by default even if you do allow them by policy as these are considered unsafe. If you have a use-case for using bluemonday whilst trusting the input then you can assert this via `p.AllowUnsafe(true)` which will let `style` and `script` through if the policy also allows them.\n\nNote: the policies shipped with bluemonday are not vulnerable to this.",
    "before_after_code_files": [
      "policy.go||policy.go",
      "policy_test.go||policy_test.go",
      "sanitize.go||sanitize.go",
      "sanitize_test.go||sanitize_test.go"
    ]
  },
  "patch_diff": {
    "policy.go||policy.go": [
      "File: policy.go -> policy.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "134:  setOfElementsMatchingAllowedWithoutAttrs []*regexp.Regexp",
      "136:  setOfElementsToSkipContent map[string]struct{}",
      "137: }",
      "139: type attrPolicy struct {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "149:  allowUnsafe bool",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "714:  return p",
      "715: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "741: func (p *Policy) AllowUnsafe(allowUnsafe bool) *Policy {",
      "742:  p.init()",
      "743:  p.allowUnsafe = allowUnsafe",
      "744:  return p",
      "745: }",
      "",
      "---------------"
    ],
    "policy_test.go||policy_test.go": [
      "File: policy_test.go -> policy_test.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "35: )",
      "37: func TestAllowElementsContent(t *testing.T) {",
      "40:  tests := []test{",
      "41:   {",
      "",
      "[Removed Lines]",
      "38:  policy := NewPolicy().AllowElementsContent(\"iframe\", \"script\")",
      "",
      "[Added Lines]",
      "38:  policy := NewPolicy().AllowElementsContent(\"iframe\", \"script\").AllowUnsafe(true)",
      "",
      "---------------"
    ],
    "sanitize.go||sanitize.go": [
      "File: sanitize.go -> sanitize.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "294:    mostRecentlyStartedToken = normaliseElementName(token.Data)",
      "296:    aps, ok := p.elsAndAttrs[token.Data]",
      "297:    if !ok {",
      "298:     aa, matched := p.matchRegex(token.Data)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "296:    switch normaliseElementName(token.Data) {",
      "297:    case `script`:",
      "298:     if !p.allowUnsafe {",
      "299:      continue",
      "300:     }",
      "301:    case `style`:",
      "302:     if !p.allowUnsafe {",
      "303:      continue",
      "304:     }",
      "305:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "341:     mostRecentlyStartedToken = \"\"",
      "342:    }",
      "344:    if skipClosingTag && closingTagToSkipStack[len(closingTagToSkipStack)-1] == token.Data {",
      "345:     closingTagToSkipStack = closingTagToSkipStack[:len(closingTagToSkipStack)-1]",
      "346:     if len(closingTagToSkipStack) == 0 {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "355:    switch normaliseElementName(token.Data) {",
      "356:    case `script`:",
      "357:     if !p.allowUnsafe {",
      "358:      continue",
      "359:     }",
      "360:    case `style`:",
      "361:     if !p.allowUnsafe {",
      "362:      continue",
      "363:     }",
      "364:    }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "387:   case html.SelfClosingTagToken:",
      "389:    aps, ok := p.elsAndAttrs[token.Data]",
      "390:    if !ok {",
      "391:     aa, matched := p.matchRegex(token.Data)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "411:    switch normaliseElementName(token.Data) {",
      "412:    case `script`:",
      "413:     if !p.allowUnsafe {",
      "414:      continue",
      "415:     }",
      "416:    case `style`:",
      "417:     if !p.allowUnsafe {",
      "418:      continue",
      "419:     }",
      "420:    }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "425:     case `script`:",
      "430:      }",
      "431:     case \"style\":",
      "436:      }",
      "437:     default:",
      "",
      "[Removed Lines]",
      "428:      if _, err := buff.WriteString(token.Data); err != nil {",
      "429:       return err",
      "434:      if _, err := buff.WriteString(token.Data); err != nil {",
      "435:       return err",
      "",
      "[Added Lines]",
      "463:      if p.allowUnsafe {",
      "464:       if _, err := buff.WriteString(token.Data); err != nil {",
      "465:        return err",
      "466:       }",
      "473:      if p.allowUnsafe {",
      "474:       if _, err := buff.WriteString(token.Data); err != nil {",
      "475:        return err",
      "476:       }",
      "",
      "---------------"
    ],
    "sanitize_test.go||sanitize_test.go": [
      "File: sanitize_test.go -> sanitize_test.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "1721: func TestIssue55ScriptTags(t *testing.T) {",
      "1722:  p1 := NewPolicy()",
      "1723:  p2 := UGCPolicy()",
      "1726:  in := `<SCRIPT>document.write('<h1><header/h1>')</SCRIPT>`",
      "1727:  expected := ``",
      "",
      "[Removed Lines]",
      "1724:  p3 := UGCPolicy().AllowElements(\"script\")",
      "",
      "[Added Lines]",
      "1724:  p3 := UGCPolicy().AllowElements(\"script\").AllowUnsafe(true)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "3660:  }",
      "3661:  wg.Wait()",
      "3662: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3664: func TestInsertionModeSanitization(t *testing.T) {",
      "3665:  tests := []test{",
      "3666:   {",
      "3667:    in:       `<select><option><style><script>alert(1)</script>`,",
      "3668:    expected: `<select><option>`,",
      "3669:   },",
      "3670:  }",
      "3672:  p := UGCPolicy()",
      "3673:  p.AllowElements(\"select\", \"option\", \"style\")",
      "3677:  wg := sync.WaitGroup{}",
      "3678:  wg.Add(len(tests))",
      "3679:  for ii, tt := range tests {",
      "3680:   go func(ii int, tt test) {",
      "3681:    out := p.Sanitize(tt.in)",
      "3682:    if out != tt.expected {",
      "3683:     t.Errorf(",
      "3684:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
      "3685:      ii,",
      "3686:      tt.in,",
      "3687:      out,",
      "3688:      tt.expected,",
      "3689:     )",
      "3690:    }",
      "3691:    wg.Done()",
      "3692:   }(ii, tt)",
      "3693:  }",
      "3694:  wg.Wait()",
      "3695: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ba345254c49643e8c772e2ef1747837f5a88a0ed",
      "candidate_info": {
        "commit_hash": "ba345254c49643e8c772e2ef1747837f5a88a0ed",
        "repo": "microcosm-cc/bluemonday",
        "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/ba345254c49643e8c772e2ef1747837f5a88a0ed",
        "files": [
          "helpers.go",
          "sanitize_test.go"
        ],
        "message": "Closes #146 by adding image/svg+xml support for inline images",
        "before_after_code_files": [
          "helpers.go||helpers.go",
          "sanitize_test.go||sanitize_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "sanitize_test.go||sanitize_test.go"
          ],
          "candidate": [
            "sanitize_test.go||sanitize_test.go"
          ]
        }
      },
      "candidate_diff": {
        "helpers.go||helpers.go": [
          "File: helpers.go -> helpers.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:  dataURIImagePrefix = regexp.MustCompile(",
          "121:  )",
          "122: )",
          "",
          "[Removed Lines]",
          "120:   `^image/(gif|jpeg|png|webp);base64,`,",
          "",
          "[Added Lines]",
          "120:   `^image/(gif|jpeg|png|svg\\+xml|webp);base64,`,",
          "",
          "---------------"
        ],
        "sanitize_test.go||sanitize_test.go": [
          "File: sanitize_test.go -> sanitize_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243:  wg.Wait()",
          "1244: }",
          "1436: func TestAllowNoAttrs(t *testing.T) {",
          "1437:  input := \"<tag>test</tag>\"",
          "1438:  outputFail := \"test\"",
          "",
          "[Removed Lines]",
          "1246: func TestIssue3(t *testing.T) {",
          "1249:  p := UGCPolicy()",
          "1250:  p.AllowStyling()",
          "1252:  tests := []test{",
          "1253:   {",
          "1254:    in:       `Hello <span class=\"foo bar bash\">there</span> world.`,",
          "1255:    expected: `Hello <span class=\"foo bar bash\">there</span> world.`,",
          "1256:   },",
          "1257:   {",
          "1258:    in:       `Hello <span class=\"javascript:alert(123)\">there</span> world.`,",
          "1259:    expected: `Hello <span>there</span> world.`,",
          "1260:   },",
          "1261:   {",
          "1262:    in:       `Hello <span class=\"><script src=\"http://hackers.org/XSS.js\"></script>\">there</span> world.`,",
          "1263:    expected: `Hello <span>&#34;&gt;there</span> world.`,",
          "1264:   },",
          "1265:   {",
          "1266:    in:       `Hello <span class=\"><script src='http://hackers.org/XSS.js'></script>\">there</span> world.`,",
          "1267:    expected: `Hello <span>there</span> world.`,",
          "1268:   },",
          "1269:  }",
          "1271:  wg := sync.WaitGroup{}",
          "1272:  wg.Add(len(tests))",
          "1273:  for ii, tt := range tests {",
          "1274:   go func(ii int, tt test) {",
          "1275:    out := p.Sanitize(tt.in)",
          "1276:    if out != tt.expected {",
          "1277:     t.Errorf(",
          "1278:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1279:      ii,",
          "1280:      tt.in,",
          "1281:      out,",
          "1282:      tt.expected,",
          "1283:     )",
          "1284:    }",
          "1285:    wg.Done()",
          "1286:   }(ii, tt)",
          "1287:  }",
          "1288:  wg.Wait()",
          "1289: }",
          "1291: func TestIssue9(t *testing.T) {",
          "1293:  p := UGCPolicy()",
          "1294:  p.AllowAttrs(\"class\").Matching(SpaceSeparatedTokens).OnElements(\"div\", \"span\")",
          "1295:  p.AllowAttrs(\"class\", \"name\").Matching(SpaceSeparatedTokens).OnElements(\"a\")",
          "1296:  p.AllowAttrs(\"rel\").Matching(regexp.MustCompile(`^nofollow$`)).OnElements(\"a\")",
          "1297:  p.AllowAttrs(\"aria-hidden\").Matching(regexp.MustCompile(`^true$`)).OnElements(\"a\")",
          "1298:  p.AllowDataURIImages()",
          "1300:  tt := test{",
          "1301:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1302:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1303:  }",
          "1304:  out := p.Sanitize(tt.in)",
          "1305:  if out != tt.expected {",
          "1306:   t.Errorf(",
          "1307:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1308:    tt.in,",
          "1309:    out,",
          "1310:    tt.expected,",
          "1311:   )",
          "1312:  }",
          "1314:  tt = test{",
          "1315:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1316:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1317:  }",
          "1318:  out = p.Sanitize(tt.in)",
          "1319:  if out != tt.expected {",
          "1320:   t.Errorf(",
          "1321:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1322:    tt.in,",
          "1323:    out,",
          "1324:    tt.expected,",
          "1325:   )",
          "1326:  }",
          "1328:  p.AddTargetBlankToFullyQualifiedLinks(true)",
          "1330:  tt = test{",
          "1331:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1332:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1333:  }",
          "1334:  out = p.Sanitize(tt.in)",
          "1335:  if out != tt.expected {",
          "1336:   t.Errorf(",
          "1337:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1338:    tt.in,",
          "1339:    out,",
          "1340:    tt.expected,",
          "1341:   )",
          "1342:  }",
          "1344:  tt = test{",
          "1345:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1346:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1347:  }",
          "1348:  out = p.Sanitize(tt.in)",
          "1349:  if out != tt.expected {",
          "1350:   t.Errorf(",
          "1351:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1352:    tt.in,",
          "1353:    out,",
          "1354:    tt.expected,",
          "1355:   )",
          "1356:  }",
          "1358:  tt = test{",
          "1359:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" target=\"namedwindow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1360:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "1361:  }",
          "1362:  out = p.Sanitize(tt.in)",
          "1363:  if out != tt.expected {",
          "1364:   t.Errorf(",
          "1365:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1366:    tt.in,",
          "1367:    out,",
          "1368:    tt.expected,",
          "1369:   )",
          "1370:  }",
          "1371: }",
          "1373: func TestIssue18(t *testing.T) {",
          "1374:  p := UGCPolicy()",
          "1376:  p.AllowAttrs(\"color\").OnElements(\"font\")",
          "1377:  p.AllowElements(\"font\")",
          "1379:  tt := test{",
          "1380:   in:       `<font face=\"Arial\">No link here. <a href=\"http://link.com\">link here</a>.</font> Should not be linked here.`,",
          "1381:   expected: `No link here. <a href=\"http://link.com\" rel=\"nofollow\">link here</a>. Should not be linked here.`,",
          "1382:  }",
          "1383:  out := p.Sanitize(tt.in)",
          "1384:  if out != tt.expected {",
          "1385:   t.Errorf(",
          "1386:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1387:    tt.in,",
          "1388:    out,",
          "1389:    tt.expected)",
          "1390:  }",
          "1391: }",
          "1393: func TestIssue23(t *testing.T) {",
          "1394:  p := NewPolicy()",
          "1395:  p.SkipElementsContent(\"tag1\", \"tag2\")",
          "1396:  input := `<tag1>cut<tag2></tag2>harm</tag1><tag1>123</tag1><tag2>234</tag2>`",
          "1397:  out := p.Sanitize(input)",
          "1398:  expected := \"\"",
          "1399:  if out != expected {",
          "1400:   t.Errorf(",
          "1401:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1402:    input,",
          "1403:    out,",
          "1404:    expected)",
          "1405:  }",
          "1407:  p = NewPolicy()",
          "1408:  p.SkipElementsContent(\"tag\")",
          "1409:  p.AllowElements(\"p\")",
          "1410:  input = `<tag>234<p>asd</p></tag>`",
          "1411:  out = p.Sanitize(input)",
          "1412:  expected = \"\"",
          "1413:  if out != expected {",
          "1414:   t.Errorf(",
          "1415:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1416:    input,",
          "1417:    out,",
          "1418:    expected)",
          "1419:  }",
          "1421:  p = NewPolicy()",
          "1422:  p.SkipElementsContent(\"tag\")",
          "1423:  p.AllowElements(\"p\", \"br\")",
          "1424:  input = `<tag>234<p>as<br/>d</p></tag>`",
          "1425:  out = p.Sanitize(input)",
          "1426:  expected = \"\"",
          "1427:  if out != expected {",
          "1428:   t.Errorf(",
          "1429:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1430:    input,",
          "1431:    out,",
          "1432:    expected)",
          "1433:  }",
          "1434: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1615:  wg.Wait()",
          "1616: }",
          "1626:  p := NewPolicy()",
          "1633:  if out != expected {",
          "1634:   t.Errorf(",
          "1635:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1637:    out,",
          "1639:  }",
          "1892: func TestSanitizedURL(t *testing.T) {",
          "1893:  tests := []test{",
          "",
          "[Removed Lines]",
          "1618: func TestIssue51(t *testing.T) {",
          "1627:  p.AllowImages()",
          "1628:  p.AllowDataURIImages()",
          "1630:  input := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "1631:  out := p.Sanitize(input)",
          "1632:  expected := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "1636:    input,",
          "1638:    expected)",
          "1641:  input = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0",
          "1642: eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTD",
          "1643: pgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfk",
          "1644: T8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNr",
          "1645: ZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBt",
          "1646: ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1F",
          "1647: eGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIv",
          "1648: MjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAg",
          "1649: ICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5z",
          "1650: OnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERp",
          "1651: bWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFn",
          "1652: ZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRp",
          "1653: b249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAg",
          "1654: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1655: ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1656: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1657: ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1658: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1659: ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1660: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1661: ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1662: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog",
          "1663: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1664: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg",
          "1665: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1666: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg",
          "1667: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1668: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg",
          "1669: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1670: ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1671: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1672: ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1673: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1674: ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1675: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1676: ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1677: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg",
          "1678: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1679: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg",
          "1680: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1681: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg",
          "1682: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1683: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg",
          "1684: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1685: ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1686: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1687: ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1688: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1689: ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1690: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "1691: IAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8A",
          "1692: AAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEky",
          "1693: MyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l6",
          "1694: 8NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBH",
          "1695: IJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJ",
          "1696: X/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBd",
          "1697: HnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6",
          "1698: m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9",
          "1699: DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDy",
          "1700: j7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3",
          "1701: zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwq",
          "1702: Vjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45",
          "1703: TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi",
          "1704: 8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2f",
          "1705: kGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716",
          "1706: tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5m",
          "1707: I3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfk",
          "1708: whWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcA",
          "1709: AAAASUVORK5CYII=\" alt=\"\">`",
          "1710:  out = p.Sanitize(input)",
          "1711:  expected = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "1712:  if out != expected {",
          "1713:   t.Errorf(",
          "1714:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1715:    input,",
          "1716:    out,",
          "1717:    expected)",
          "1718:  }",
          "1719: }",
          "1721: func TestIssue55ScriptTags(t *testing.T) {",
          "1722:  p1 := NewPolicy()",
          "1723:  p2 := UGCPolicy()",
          "1724:  p3 := UGCPolicy().AllowElements(\"script\").AllowUnsafe(true)",
          "1726:  in := `<SCRIPT>document.write('<h1><header/h1>')</SCRIPT>`",
          "1727:  expected := ``",
          "1728:  out := p1.Sanitize(in)",
          "1729:  if out != expected {",
          "1730:   t.Errorf(",
          "1731:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1732:    in,",
          "1733:    out,",
          "1734:    expected,",
          "1735:   )",
          "1736:  }",
          "1738:  expected = ``",
          "1739:  out = p2.Sanitize(in)",
          "1740:  if out != expected {",
          "1741:   t.Errorf(",
          "1742:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1743:    in,",
          "1744:    out,",
          "1745:    expected,",
          "1746:   )",
          "1747:  }",
          "1749:  expected = `<script>document.write('<h1><header/h1>')</script>`",
          "1750:  out = p3.Sanitize(in)",
          "1751:  if out != expected {",
          "1752:   t.Errorf(",
          "1753:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1754:    in,",
          "1755:    out,",
          "1756:    expected,",
          "1757:   )",
          "1758:  }",
          "1759: }",
          "1761: func TestIssue85NoReferrer(t *testing.T) {",
          "1762:  p := UGCPolicy()",
          "1763:  p.AllowAttrs(\"rel\").OnElements(\"a\")",
          "1764:  p.RequireNoReferrerOnLinks(true)",
          "1765:  p.AddTargetBlankToFullyQualifiedLinks(true)",
          "1766:  p.AllowAttrs(\"target\").Matching(Paragraph).OnElements(\"a\")",
          "1768:  tests := []test{",
          "1769:   {",
          "1770:    in:       `<a href=\"/path\" />`,",
          "1771:    expected: `<a href=\"/path\" rel=\"nofollow noreferrer\"/>`,",
          "1772:   },",
          "1773:   {",
          "1774:    in:       `<a href=\"/path\" target=\"_blank\" />`,",
          "1775:    expected: `<a href=\"/path\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "1776:   },",
          "1777:   {",
          "1778:    in:       `<a href=\"/path\" target=\"foo\" />`,",
          "1779:    expected: `<a href=\"/path\" target=\"foo\" rel=\"nofollow noreferrer\"/>`,",
          "1780:   },",
          "1781:   {",
          "1782:    in:       `<a href=\"https://www.google.com/\" />`,",
          "1783:    expected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "1784:   },",
          "1785:   {",
          "1786:    in:       `<a href=\"https://www.google.com/\" target=\"_blank\"/>`,",
          "1787:    expected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "1788:   },",
          "1789:   {",
          "1790:    in:       `<a href=\"https://www.google.com/\" rel=\"nofollow\"/>`,",
          "1791:    expected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "1792:   },",
          "1793:   {",
          "1794:    in:       `<a href=\"https://www.google.com/\" rel=\"noopener\"/>`,",
          "1795:    expected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,",
          "1796:   },",
          "1797:   {",
          "1798:    in:       `<a href=\"https://www.google.com/\" rel=\"noopener nofollow\" />`,",
          "1799:    expected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,",
          "1800:   },",
          "1801:   {",
          "1802:    in:       `<a href=\"https://www.google.com/\" target=\"foo\" />`,",
          "1803:    expected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "1804:   },",
          "1805:   {",
          "1806:    in:       `<a href=\"https://www.google.com/\" rel=\"external\"/>`,",
          "1807:    expected: `<a href=\"https://www.google.com/\" rel=\"external nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "1808:   },",
          "1809:  }",
          "1813:  wg := sync.WaitGroup{}",
          "1814:  wg.Add(len(tests))",
          "1815:  for ii, tt := range tests {",
          "1816:   go func(ii int, tt test) {",
          "1817:    out := p.Sanitize(tt.in)",
          "1818:    if out != tt.expected {",
          "1819:     t.Errorf(",
          "1820:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1821:      ii,",
          "1822:      tt.in,",
          "1823:      out,",
          "1824:      tt.expected,",
          "1825:     )",
          "1826:    }",
          "1827:    wg.Done()",
          "1828:   }(ii, tt)",
          "1829:  }",
          "1830:  wg.Wait()",
          "1831: }",
          "1833: func TestIssue107(t *testing.T) {",
          "1834:  p := UGCPolicy()",
          "1835:  p.RequireCrossOriginAnonymous(true)",
          "1837:  tests := []test{",
          "1838:   {",
          "1839:    in:       `<img src=\"/path\" />`,",
          "1840:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "1841:   },",
          "1842:   {",
          "1843:    in:       `<img src=\"/path\" crossorigin=\"use-credentials\"/>`,",
          "1844:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "1845:   },",
          "1846:   {",
          "1847:    in:       `<img src=\"/path\" crossorigin=\"\"/>`,",
          "1848:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "1849:   },",
          "1850:  }",
          "1854:  wg := sync.WaitGroup{}",
          "1855:  wg.Add(len(tests))",
          "1856:  for ii, tt := range tests {",
          "1857:   go func(ii int, tt test) {",
          "1858:    out := p.Sanitize(tt.in)",
          "1859:    if out != tt.expected {",
          "1860:     t.Errorf(",
          "1861:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1862:      ii,",
          "1863:      tt.in,",
          "1864:      out,",
          "1865:      tt.expected,",
          "1866:     )",
          "1867:    }",
          "1868:    wg.Done()",
          "1869:   }(ii, tt)",
          "1870:  }",
          "1871:  wg.Wait()",
          "1872: }",
          "1874: func TestIFrameSandbox(t *testing.T) {",
          "1875:  p := NewPolicy()",
          "1876:  p.AllowAttrs(\"sandbox\").OnElements(\"iframe\")",
          "1877:  p.RequireSandboxOnIFrame(SandboxAllowForms, SandboxAllowPopups)",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads allow-popups\"></iframe>`",
          "1880:  expected := `<iframe sandbox=\"allow-forms allow-popups\"></iframe>`",
          "1881:  out := p.Sanitize(in)",
          "1882:  if out != expected {",
          "1883:   t.Errorf(",
          "1884:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1885:    in,",
          "1886:    out,",
          "1887:    expected,",
          "1888:   )",
          "1889:  }",
          "1890: }",
          "",
          "[Added Lines]",
          "1428: func TestIFrameSandbox(t *testing.T) {",
          "1430:  p.AllowAttrs(\"sandbox\").OnElements(\"iframe\")",
          "1431:  p.RequireSandboxOnIFrame(SandboxAllowForms, SandboxAllowPopups)",
          "1433:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads allow-popups\"></iframe>`",
          "1434:  expected := `<iframe sandbox=\"allow-forms allow-popups\"></iframe>`",
          "1435:  out := p.Sanitize(in)",
          "1439:    in,",
          "1441:    expected,",
          "1442:   )",
          "1444: }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3711:  }",
          "3712:  wg.Wait()",
          "3713: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3269: func TestIssue3(t *testing.T) {",
          "3272:  p := UGCPolicy()",
          "3273:  p.AllowStyling()",
          "3275:  tests := []test{",
          "3276:   {",
          "3277:    in:       `Hello <span class=\"foo bar bash\">there</span> world.`,",
          "3278:    expected: `Hello <span class=\"foo bar bash\">there</span> world.`,",
          "3279:   },",
          "3280:   {",
          "3281:    in:       `Hello <span class=\"javascript:alert(123)\">there</span> world.`,",
          "3282:    expected: `Hello <span>there</span> world.`,",
          "3283:   },",
          "3284:   {",
          "3285:    in:       `Hello <span class=\"><script src=\"http://hackers.org/XSS.js\"></script>\">there</span> world.`,",
          "3286:    expected: `Hello <span>&#34;&gt;there</span> world.`,",
          "3287:   },",
          "3288:   {",
          "3289:    in:       `Hello <span class=\"><script src='http://hackers.org/XSS.js'></script>\">there</span> world.`,",
          "3290:    expected: `Hello <span>there</span> world.`,",
          "3291:   },",
          "3292:  }",
          "3294:  wg := sync.WaitGroup{}",
          "3295:  wg.Add(len(tests))",
          "3296:  for ii, tt := range tests {",
          "3297:   go func(ii int, tt test) {",
          "3298:    out := p.Sanitize(tt.in)",
          "3299:    if out != tt.expected {",
          "3300:     t.Errorf(",
          "3301:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3302:      ii,",
          "3303:      tt.in,",
          "3304:      out,",
          "3305:      tt.expected,",
          "3306:     )",
          "3307:    }",
          "3308:    wg.Done()",
          "3309:   }(ii, tt)",
          "3310:  }",
          "3311:  wg.Wait()",
          "3312: }",
          "3313: func TestIssue9(t *testing.T) {",
          "3315:  p := UGCPolicy()",
          "3316:  p.AllowAttrs(\"class\").Matching(SpaceSeparatedTokens).OnElements(\"div\", \"span\")",
          "3317:  p.AllowAttrs(\"class\", \"name\").Matching(SpaceSeparatedTokens).OnElements(\"a\")",
          "3318:  p.AllowAttrs(\"rel\").Matching(regexp.MustCompile(`^nofollow$`)).OnElements(\"a\")",
          "3319:  p.AllowAttrs(\"aria-hidden\").Matching(regexp.MustCompile(`^true$`)).OnElements(\"a\")",
          "3320:  p.AllowDataURIImages()",
          "3322:  tt := test{",
          "3323:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3324:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3325:  }",
          "3326:  out := p.Sanitize(tt.in)",
          "3327:  if out != tt.expected {",
          "3328:   t.Errorf(",
          "3329:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3330:    tt.in,",
          "3331:    out,",
          "3332:    tt.expected,",
          "3333:   )",
          "3334:  }",
          "3336:  tt = test{",
          "3337:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3338:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3339:  }",
          "3340:  out = p.Sanitize(tt.in)",
          "3341:  if out != tt.expected {",
          "3342:   t.Errorf(",
          "3343:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3344:    tt.in,",
          "3345:    out,",
          "3346:    tt.expected,",
          "3347:   )",
          "3348:  }",
          "3350:  p.AddTargetBlankToFullyQualifiedLinks(true)",
          "3352:  tt = test{",
          "3353:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3354:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3355:  }",
          "3356:  out = p.Sanitize(tt.in)",
          "3357:  if out != tt.expected {",
          "3358:   t.Errorf(",
          "3359:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3360:    tt.in,",
          "3361:    out,",
          "3362:    tt.expected,",
          "3363:   )",
          "3364:  }",
          "3366:  tt = test{",
          "3367:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3368:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3369:  }",
          "3370:  out = p.Sanitize(tt.in)",
          "3371:  if out != tt.expected {",
          "3372:   t.Errorf(",
          "3373:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3374:    tt.in,",
          "3375:    out,",
          "3376:    tt.expected,",
          "3377:   )",
          "3378:  }",
          "3380:  tt = test{",
          "3381:   in:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" target=\"namedwindow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3382:   expected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,",
          "3383:  }",
          "3384:  out = p.Sanitize(tt.in)",
          "3385:  if out != tt.expected {",
          "3386:   t.Errorf(",
          "3387:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3388:    tt.in,",
          "3389:    out,",
          "3390:    tt.expected,",
          "3391:   )",
          "3392:  }",
          "3393: }",
          "3395: func TestIssue18(t *testing.T) {",
          "3396:  p := UGCPolicy()",
          "3398:  p.AllowAttrs(\"color\").OnElements(\"font\")",
          "3399:  p.AllowElements(\"font\")",
          "3401:  tt := test{",
          "3402:   in:       `<font face=\"Arial\">No link here. <a href=\"http://link.com\">link here</a>.</font> Should not be linked here.`,",
          "3403:   expected: `No link here. <a href=\"http://link.com\" rel=\"nofollow\">link here</a>. Should not be linked here.`,",
          "3404:  }",
          "3405:  out := p.Sanitize(tt.in)",
          "3406:  if out != tt.expected {",
          "3407:   t.Errorf(",
          "3408:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3409:    tt.in,",
          "3410:    out,",
          "3411:    tt.expected)",
          "3412:  }",
          "3413: }",
          "3415: func TestIssue23(t *testing.T) {",
          "3416:  p := NewPolicy()",
          "3417:  p.SkipElementsContent(\"tag1\", \"tag2\")",
          "3418:  input := `<tag1>cut<tag2></tag2>harm</tag1><tag1>123</tag1><tag2>234</tag2>`",
          "3419:  out := p.Sanitize(input)",
          "3420:  expected := \"\"",
          "3421:  if out != expected {",
          "3422:   t.Errorf(",
          "3423:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3424:    input,",
          "3425:    out,",
          "3426:    expected)",
          "3427:  }",
          "3429:  p = NewPolicy()",
          "3430:  p.SkipElementsContent(\"tag\")",
          "3431:  p.AllowElements(\"p\")",
          "3432:  input = `<tag>234<p>asd</p></tag>`",
          "3433:  out = p.Sanitize(input)",
          "3434:  expected = \"\"",
          "3435:  if out != expected {",
          "3436:   t.Errorf(",
          "3437:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3438:    input,",
          "3439:    out,",
          "3440:    expected)",
          "3441:  }",
          "3443:  p = NewPolicy()",
          "3444:  p.SkipElementsContent(\"tag\")",
          "3445:  p.AllowElements(\"p\", \"br\")",
          "3446:  input = `<tag>234<p>as<br/>d</p></tag>`",
          "3447:  out = p.Sanitize(input)",
          "3448:  expected = \"\"",
          "3449:  if out != expected {",
          "3450:   t.Errorf(",
          "3451:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3452:    input,",
          "3453:    out,",
          "3454:    expected)",
          "3455:  }",
          "3456: }",
          "3458: func TestIssue51(t *testing.T) {",
          "3466:  p := NewPolicy()",
          "3467:  p.AllowImages()",
          "3468:  p.AllowDataURIImages()",
          "3470:  input := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "3471:  out := p.Sanitize(input)",
          "3472:  expected := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "3473:  if out != expected {",
          "3474:   t.Errorf(",
          "3475:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3476:    input,",
          "3477:    out,",
          "3478:    expected)",
          "3479:  }",
          "3481:  input = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0",
          "3482: eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTD",
          "3483: pgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfk",
          "3484: T8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNr",
          "3485: ZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBt",
          "3486: ZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1F",
          "3487: eGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIv",
          "3488: MjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAg",
          "3489: ICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5z",
          "3490: OnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERp",
          "3491: bWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFn",
          "3492: ZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRp",
          "3493: b249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAg",
          "3494: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3495: ICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3496: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3497: ICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3498: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3499: ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3500: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3501: ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3502: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog",
          "3503: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3504: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg",
          "3505: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3506: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg",
          "3507: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3508: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg",
          "3509: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3510: ICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3511: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3512: ICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3513: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3514: ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3515: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3516: ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3517: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg",
          "3518: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3519: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg",
          "3520: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3521: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg",
          "3522: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3523: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg",
          "3524: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3525: ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3526: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3527: ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3528: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3529: ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3530: ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg",
          "3531: IAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8A",
          "3532: AAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEky",
          "3533: MyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l6",
          "3534: 8NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBH",
          "3535: IJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJ",
          "3536: X/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBd",
          "3537: HnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6",
          "3538: m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9",
          "3539: DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDy",
          "3540: j7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3",
          "3541: zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwq",
          "3542: Vjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45",
          "3543: TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi",
          "3544: 8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2f",
          "3545: kGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716",
          "3546: tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5m",
          "3547: I3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfk",
          "3548: whWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcA",
          "3549: AAAASUVORK5CYII=\" alt=\"\">`",
          "3550:  out = p.Sanitize(input)",
          "3551:  expected = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`",
          "3552:  if out != expected {",
          "3553:   t.Errorf(",
          "3554:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3555:    input,",
          "3556:    out,",
          "3557:    expected)",
          "3558:  }",
          "3559: }",
          "3561: func TestIssue55(t *testing.T) {",
          "3562:  p1 := NewPolicy()",
          "3563:  p2 := UGCPolicy()",
          "3564:  p3 := UGCPolicy().AllowElements(\"script\").AllowUnsafe(true)",
          "3566:  in := `<SCRIPT>document.write('<h1><header/h1>')</SCRIPT>`",
          "3567:  expected := ``",
          "3568:  out := p1.Sanitize(in)",
          "3569:  if out != expected {",
          "3570:   t.Errorf(",
          "3571:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3572:    in,",
          "3573:    out,",
          "3574:    expected,",
          "3575:   )",
          "3576:  }",
          "3578:  expected = ``",
          "3579:  out = p2.Sanitize(in)",
          "3580:  if out != expected {",
          "3581:   t.Errorf(",
          "3582:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3583:    in,",
          "3584:    out,",
          "3585:    expected,",
          "3586:   )",
          "3587:  }",
          "3589:  expected = `<script>document.write('<h1><header/h1>')</script>`",
          "3590:  out = p3.Sanitize(in)",
          "3591:  if out != expected {",
          "3592:   t.Errorf(",
          "3593:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3594:    in,",
          "3595:    out,",
          "3596:    expected,",
          "3597:   )",
          "3598:  }",
          "3599: }",
          "3601: func TestIssue85(t *testing.T) {",
          "3602:  p := UGCPolicy()",
          "3603:  p.AllowAttrs(\"rel\").OnElements(\"a\")",
          "3604:  p.RequireNoReferrerOnLinks(true)",
          "3605:  p.AddTargetBlankToFullyQualifiedLinks(true)",
          "3606:  p.AllowAttrs(\"target\").Matching(Paragraph).OnElements(\"a\")",
          "3608:  tests := []test{",
          "3609:   {",
          "3610:    in:       `<a href=\"/path\" />`,",
          "3611:    expected: `<a href=\"/path\" rel=\"nofollow noreferrer\"/>`,",
          "3612:   },",
          "3613:   {",
          "3614:    in:       `<a href=\"/path\" target=\"_blank\" />`,",
          "3615:    expected: `<a href=\"/path\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "3616:   },",
          "3617:   {",
          "3618:    in:       `<a href=\"/path\" target=\"foo\" />`,",
          "3619:    expected: `<a href=\"/path\" target=\"foo\" rel=\"nofollow noreferrer\"/>`,",
          "3620:   },",
          "3621:   {",
          "3622:    in:       `<a href=\"https://www.google.com/\" />`,",
          "3623:    expected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "3624:   },",
          "3625:   {",
          "3626:    in:       `<a href=\"https://www.google.com/\" target=\"_blank\"/>`,",
          "3627:    expected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "3628:   },",
          "3629:   {",
          "3630:    in:       `<a href=\"https://www.google.com/\" rel=\"nofollow\"/>`,",
          "3631:    expected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "3632:   },",
          "3633:   {",
          "3634:    in:       `<a href=\"https://www.google.com/\" rel=\"noopener\"/>`,",
          "3635:    expected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,",
          "3636:   },",
          "3637:   {",
          "3638:    in:       `<a href=\"https://www.google.com/\" rel=\"noopener nofollow\" />`,",
          "3639:    expected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,",
          "3640:   },",
          "3641:   {",
          "3642:    in:       `<a href=\"https://www.google.com/\" target=\"foo\" />`,",
          "3643:    expected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,",
          "3644:   },",
          "3645:   {",
          "3646:    in:       `<a href=\"https://www.google.com/\" rel=\"external\"/>`,",
          "3647:    expected: `<a href=\"https://www.google.com/\" rel=\"external nofollow noreferrer noopener\" target=\"_blank\"/>`,",
          "3648:   },",
          "3649:  }",
          "3653:  wg := sync.WaitGroup{}",
          "3654:  wg.Add(len(tests))",
          "3655:  for ii, tt := range tests {",
          "3656:   go func(ii int, tt test) {",
          "3657:    out := p.Sanitize(tt.in)",
          "3658:    if out != tt.expected {",
          "3659:     t.Errorf(",
          "3660:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3661:      ii,",
          "3662:      tt.in,",
          "3663:      out,",
          "3664:      tt.expected,",
          "3665:     )",
          "3666:    }",
          "3667:    wg.Done()",
          "3668:   }(ii, tt)",
          "3669:  }",
          "3670:  wg.Wait()",
          "3671: }",
          "3673: func TestIssue107(t *testing.T) {",
          "3674:  p := UGCPolicy()",
          "3675:  p.RequireCrossOriginAnonymous(true)",
          "3677:  tests := []test{",
          "3678:   {",
          "3679:    in:       `<img src=\"/path\" />`,",
          "3680:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "3681:   },",
          "3682:   {",
          "3683:    in:       `<img src=\"/path\" crossorigin=\"use-credentials\"/>`,",
          "3684:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "3685:   },",
          "3686:   {",
          "3687:    in:       `<img src=\"/path\" crossorigin=\"\"/>`,",
          "3688:    expected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,",
          "3689:   },",
          "3690:  }",
          "3694:  wg := sync.WaitGroup{}",
          "3695:  wg.Add(len(tests))",
          "3696:  for ii, tt := range tests {",
          "3697:   go func(ii int, tt test) {",
          "3698:    out := p.Sanitize(tt.in)",
          "3699:    if out != tt.expected {",
          "3700:     t.Errorf(",
          "3701:      \"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3702:      ii,",
          "3703:      tt.in,",
          "3704:      out,",
          "3705:      tt.expected,",
          "3706:     )",
          "3707:    }",
          "3708:    wg.Done()",
          "3709:   }(ii, tt)",
          "3710:  }",
          "3711:  wg.Wait()",
          "3712: }",
          "3714: func TestIssue146(t *testing.T) {",
          "3721:  p := NewPolicy()",
          "3722:  p.AllowImages()",
          "3723:  p.AllowDataURIImages()",
          "3725:  input := `<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=\" alt=\"\">`",
          "3726:  out := p.Sanitize(input)",
          "3727:  expected := `<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=\" alt=\"\">`",
          "3728:  if out != expected {",
          "3729:   t.Errorf(",
          "3730:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "3731:    input,",
          "3732:    out,",
          "3733:    expected)",
          "3734:  }",
          "3735: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1d1aa608ce7cd35f940949b8dd4884a8a94653fe",
      "candidate_info": {
        "commit_hash": "1d1aa608ce7cd35f940949b8dd4884a8a94653fe",
        "repo": "microcosm-cc/bluemonday",
        "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/1d1aa608ce7cd35f940949b8dd4884a8a94653fe",
        "files": [
          "policy.go",
          "sanitize_test.go"
        ],
        "message": "Fix incorrect handling of iframe SandboxValues",
        "before_after_code_files": [
          "policy.go||policy.go",
          "sanitize_test.go||sanitize_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "policy.go||policy.go",
            "sanitize_test.go||sanitize_test.go"
          ],
          "candidate": [
            "policy.go||policy.go",
            "sanitize_test.go||sanitize_test.go"
          ]
        }
      },
      "candidate_diff": {
        "policy.go||policy.go": [
          "File: policy.go -> policy.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "707: func (p *Policy) RequireSandboxOnIFrame(vals ...SandboxValue) {",
          "708:  p.requireSandboxOnIFrame = make(map[string]bool)",
          "711:   switch SandboxValue(val) {",
          "712:   case SandboxAllowDownloads:",
          "713:    p.requireSandboxOnIFrame[\"allow-downloads\"] = true",
          "",
          "[Removed Lines]",
          "710:  for val := range vals {",
          "",
          "[Added Lines]",
          "710:  for _, val := range vals {",
          "",
          "---------------"
        ],
        "sanitize_test.go||sanitize_test.go": [
          "File: sanitize_test.go -> sanitize_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "1874: func TestIFrameSandbox(t *testing.T) {",
          "1875:  p := NewPolicy()",
          "1876:  p.AllowAttrs(\"sandbox\").OnElements(\"iframe\")",
          "1881:  out := p.Sanitize(in)",
          "1882:  if out != expected {",
          "1883:   t.Errorf(",
          "",
          "[Removed Lines]",
          "1877:  p.RequireSandboxOnIFrame(SandboxAllowDownloads)",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads\"></iframe>`",
          "1880:  expected := `<iframe sandbox=\"allow-downloads\"></iframe>`",
          "",
          "[Added Lines]",
          "1877:  p.RequireSandboxOnIFrame(SandboxAllowForms, SandboxAllowPopups)",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads allow-popups\"></iframe>`",
          "1880:  expected := `<iframe sandbox=\"allow-forms allow-popups\"></iframe>`",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6e7247ef0b0e9204765ba99f2bc7a162ef137c59",
      "candidate_info": {
        "commit_hash": "6e7247ef0b0e9204765ba99f2bc7a162ef137c59",
        "repo": "microcosm-cc/bluemonday",
        "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/6e7247ef0b0e9204765ba99f2bc7a162ef137c59",
        "files": [
          "sanitize.go",
          "sanitize_test.go"
        ],
        "message": "Remove duplicate vals",
        "before_after_code_files": [
          "sanitize.go||sanitize.go",
          "sanitize_test.go||sanitize_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "sanitize.go||sanitize.go",
            "sanitize_test.go||sanitize_test.go"
          ],
          "candidate": [
            "sanitize.go||sanitize.go",
            "sanitize_test.go||sanitize_test.go"
          ]
        }
      },
      "candidate_diff": {
        "sanitize.go||sanitize.go": [
          "File: sanitize.go -> sanitize.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "815:    if htmlAttr.Key == \"sandbox\" {",
          "816:     sandboxFound = true",
          "817:     var cleanVals []string",
          "818:     for _, val := range strings.Fields(htmlAttr.Val) {",
          "819:      if p.requireSandboxOnIFrame[val] {",
          "821:      }",
          "822:     }",
          "823:     cleanAttrs[i].Val = strings.Join(cleanVals, \" \")",
          "",
          "[Removed Lines]",
          "820:       cleanVals = append(cleanVals, val)",
          "",
          "[Added Lines]",
          "818:     cleanValsSet := make(map[string]bool)",
          "821:       if !cleanValsSet[val] {",
          "822:        cleanVals = append(cleanVals, val)",
          "823:        cleanValsSet[val] = true",
          "824:       }",
          "",
          "---------------"
        ],
        "sanitize_test.go||sanitize_test.go": [
          "File: sanitize_test.go -> sanitize_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "1876:  p.AllowAttrs(\"sandbox\").OnElements(\"iframe\")",
          "1877:  p.RequireSandboxOnIFrame(SandboxAllowDownloads)",
          "1880:  expected := `<iframe sandbox=\"allow-downloads\"></iframe>`",
          "1881:  out := p.Sanitize(in)",
          "1882:  if out != expected {",
          "",
          "[Removed Lines]",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads\"></iframe>`",
          "",
          "[Added Lines]",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads\"></iframe>`",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "591be1dba1210f2eaec2819ff09de46c5130fcc8",
      "candidate_info": {
        "commit_hash": "591be1dba1210f2eaec2819ff09de46c5130fcc8",
        "repo": "microcosm-cc/bluemonday",
        "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/591be1dba1210f2eaec2819ff09de46c5130fcc8",
        "files": [
          "sanitize.go"
        ],
        "message": "Add function to sanitize to writer directly\n\nSigned-off-by: Andrew Thornton <art27@cantab.net>",
        "before_after_code_files": [
          "sanitize.go||sanitize.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "sanitize.go||sanitize.go"
          ],
          "candidate": [
            "sanitize.go||sanitize.go"
          ]
        }
      },
      "candidate_diff": {
        "sanitize.go||sanitize.go": [
          "File: sanitize.go -> sanitize.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: import (",
          "33:  \"bytes\"",
          "34:  \"io\"",
          "35:  \"net/url\"",
          "36:  \"regexp\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34:  \"fmt\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "60:   return s",
          "61:  }",
          "64: }",
          "",
          "[Removed Lines]",
          "63:  return p.sanitize(strings.NewReader(s)).String()",
          "",
          "[Added Lines]",
          "64:  return p.sanitizeWithBuff(strings.NewReader(s)).String()",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "74:   return b",
          "75:  }",
          "78: }",
          "",
          "[Removed Lines]",
          "77:  return p.sanitize(bytes.NewReader(b)).Bytes()",
          "",
          "[Added Lines]",
          "78:  return p.sanitizeWithBuff(bytes.NewReader(b)).Bytes()",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "85: func (p *Policy) SanitizeReader(r io.Reader) *bytes.Buffer {",
          "87: }",
          "89: const escapedURLChars = \"'<>\\\"\\r\"",
          "93:  i := strings.IndexAny(val, escapedURLChars)",
          "94:  for i != -1 {",
          "95:   if _, err := w.WriteString(val[:i]); err != nil {",
          "97:   }",
          "98:   var esc string",
          "99:   switch val[i] {",
          "",
          "[Removed Lines]",
          "86:  return p.sanitize(r)",
          "91: func escapeUrlComponent(val string) string {",
          "92:  w := bytes.NewBufferString(\"\")",
          "96:    return w.String()",
          "",
          "[Added Lines]",
          "87:  return p.sanitizeWithBuff(r)",
          "88: }",
          "93: func (p *Policy) SanitizeReaderToWriter(r io.Reader, w io.Writer) error {",
          "94:  return p.sanitize(r, w)",
          "99: func escapeUrlComponent(w stringWriterWriter, val string) error {",
          "103:    return err",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "114:   }",
          "115:   val = val[i+1:]",
          "116:   if _, err := w.WriteString(esc); err != nil {",
          "118:   }",
          "119:   i = strings.IndexAny(val, escapedURLChars)",
          "120:  }",
          "123: }",
          "125: func sanitizedUrl(val string) (string, error) {",
          "",
          "[Removed Lines]",
          "117:    return w.String()",
          "121:  w.WriteString(val)",
          "122:  return w.String()",
          "",
          "[Added Lines]",
          "124:    return err",
          "128:  _, err := w.WriteString(val)",
          "129:  return err",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "142:  return u.String(), nil",
          "143: }",
          "149:  tokenBuff.WriteString(token.Data)",
          "150:  for _, attr := range token.Attr {",
          "151:   tokenBuff.WriteByte(' ')",
          "152:   tokenBuff.WriteString(attr.Key)",
          "154:   switch attr.Key {",
          "155:   case \"href\", \"src\":",
          "156:    u, ok := p.validURL(attr.Val)",
          "",
          "[Removed Lines]",
          "145: func (p *Policy) writeLinkableBuf(buff *bytes.Buffer, token *html.Token) {",
          "147:  tokenBuff := bytes.NewBufferString(\"\")",
          "148:  tokenBuff.WriteString(\"<\")",
          "153:   tokenBuff.WriteString(`=\"`)",
          "",
          "[Added Lines]",
          "152: func (p *Policy) writeLinkableBuf(buff stringWriterWriter, token *html.Token) (int, error) {",
          "154:  tokenBuff := bytes.NewBuffer(make([]byte, 0, 1024)) // This should stay on the stack unless it gets too big",
          "156:  tokenBuff.WriteByte('<')",
          "161:   tokenBuff.Write([]byte{'=', '\"'})",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "175:   tokenBuff.WriteString(\"/\")",
          "176:  }",
          "177:  tokenBuff.WriteString(\">\")",
          "179: }",
          "",
          "[Removed Lines]",
          "178:  buff.WriteString(tokenBuff.String())",
          "182: func (p *Policy) sanitize(r io.Reader) *bytes.Buffer {",
          "",
          "[Added Lines]",
          "186:  return buff.Write(tokenBuff.Bytes())",
          "190: func (p *Policy) sanitizeWithBuff(r io.Reader) *bytes.Buffer {",
          "191:  var buff bytes.Buffer",
          "192:  if err := p.sanitize(r, &buff); err != nil {",
          "193:   return &bytes.Buffer{}",
          "194:  }",
          "195:  return &buff",
          "196: }",
          "198: type stringWriterWriter interface {",
          "199:  io.Writer",
          "200:  io.StringWriter",
          "201: }",
          "203: type asStringWriter struct {",
          "204:  io.Writer",
          "205: }",
          "207: func (a *asStringWriter) WriteString(s string) (int, error) {",
          "208:  return a.Write([]byte(s))",
          "209: }",
          "211: func (p *Policy) sanitize(r io.Reader, w io.Writer) error {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "190:  p.init()",
          "192:  var (",
          "194:   skipElementContent       bool",
          "195:   skippingElementsCount    int64",
          "196:   skipClosingTag           bool",
          "",
          "[Removed Lines]",
          "193:   buff                     bytes.Buffer",
          "",
          "[Added Lines]",
          "220:  buff, ok := w.(stringWriterWriter)",
          "221:  if !ok {",
          "222:   buff = &asStringWriter{w}",
          "223:  }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "204:    err := tokenizer.Err()",
          "205:    if err == io.EOF {",
          "208:    }",
          "212:   }",
          "214:   token := tokenizer.Token()",
          "",
          "[Removed Lines]",
          "207:     return &buff",
          "211:    return &bytes.Buffer{}",
          "",
          "[Added Lines]",
          "239:     return nil",
          "243:    return err",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "240:       skippingElementsCount++",
          "241:      }",
          "242:      if p.addSpaces {",
          "244:      }",
          "245:      break",
          "246:     }",
          "",
          "[Removed Lines]",
          "243:       buff.WriteString(\" \")",
          "",
          "[Added Lines]",
          "275:       if _, err := buff.WriteString(\" \"); err != nil {",
          "276:        return err",
          "277:       }",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "255:      skipClosingTag = true",
          "256:      closingTagToSkipStack = append(closingTagToSkipStack, token.Data)",
          "257:      if p.addSpaces {",
          "259:      }",
          "260:      break",
          "261:     }",
          "",
          "[Removed Lines]",
          "258:       buff.WriteString(\" \")",
          "",
          "[Added Lines]",
          "292:       if _, err := buff.WriteString(\" \"); err != nil {",
          "293:        return err",
          "294:       }",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "264:    if !skipElementContent {",
          "266:     if linkable(token.Data) {",
          "268:     } else {",
          "270:     }",
          "271:    }",
          "",
          "[Removed Lines]",
          "267:      p.writeLinkableBuf(&buff, &token)",
          "269:      buff.WriteString(token.String())",
          "",
          "[Added Lines]",
          "303:      if _, err := p.writeLinkableBuf(buff, &token); err != nil {",
          "304:       return err",
          "305:      }",
          "307:      if _, err := buff.WriteString(token.String()); err != nil {",
          "308:       return err",
          "309:      }",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "282:      skipClosingTag = false",
          "283:     }",
          "284:     if p.addSpaces {",
          "286:     }",
          "287:     break",
          "288:    }",
          "",
          "[Removed Lines]",
          "285:      buff.WriteString(\" \")",
          "",
          "[Added Lines]",
          "325:      if _, err := buff.WriteString(\" \"); err != nil {",
          "326:       return err",
          "327:      }",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "303:     }",
          "304:     if !match {",
          "305:      if p.addSpaces {",
          "307:      }",
          "308:      break",
          "309:     }",
          "310:    }",
          "312:    if !skipElementContent {",
          "314:    }",
          "316:   case html.SelfClosingTagToken:",
          "",
          "[Removed Lines]",
          "306:       buff.WriteString(\" \")",
          "313:     buff.WriteString(token.String())",
          "",
          "[Added Lines]",
          "348:       if _, err := buff.WriteString(\" \"); err != nil {",
          "349:        return err",
          "350:       }",
          "357:     if _, err := buff.WriteString(token.String()); err != nil {",
          "358:      return err",
          "359:     }",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "320:     aa, matched := p.matchRegex(token.Data)",
          "321:     if !matched {",
          "322:      if p.addSpaces && !matched {",
          "324:      }",
          "325:      break",
          "326:     }",
          "",
          "[Removed Lines]",
          "323:       buff.WriteString(\" \")",
          "",
          "[Added Lines]",
          "369:       if _, err := buff.WriteString(\" \"); err != nil {",
          "370:        return err",
          "371:       }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "334:    if len(token.Attr) == 0 && !p.allowNoAttrs(token.Data) {",
          "335:     if p.addSpaces {",
          "337:      break",
          "338:     }",
          "339:    }",
          "340:    if !skipElementContent {",
          "342:     if linkable(token.Data) {",
          "344:     } else {",
          "346:     }",
          "347:    }",
          "",
          "[Removed Lines]",
          "336:      buff.WriteString(\" \")",
          "343:      p.writeLinkableBuf(&buff, &token)",
          "345:      buff.WriteString(token.String())",
          "",
          "[Added Lines]",
          "384:      if _, err := buff.WriteString(\" \"); err != nil {",
          "385:       return err",
          "386:      }",
          "393:      if _, err := p.writeLinkableBuf(buff, &token); err != nil {",
          "394:       return err",
          "395:      }",
          "397:      if _, err := buff.WriteString(token.String()); err != nil {",
          "398:       return err",
          "399:      }",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "353:     case `script`:",
          "361:     default:",
          "364:     }",
          "365:    }",
          "367:   default:",
          "370:   }",
          "371:  }",
          "372: }",
          "",
          "[Removed Lines]",
          "356:      buff.WriteString(token.Data)",
          "357:     case `style`:",
          "360:      buff.WriteString(token.Data)",
          "363:      buff.WriteString(token.String())",
          "369:    return &bytes.Buffer{}",
          "",
          "[Added Lines]",
          "410:      if _, err := buff.WriteString(token.Data); err != nil {",
          "411:       return err",
          "412:      }",
          "413:     case \"style\":",
          "416:      if _, err := buff.WriteString(token.Data); err != nil {",
          "417:       return err",
          "418:      }",
          "421:      if _, err := buff.WriteString(token.String()); err != nil {",
          "422:       return err",
          "423:      }",
          "429:    return fmt.Errorf(\"unknown token: %v\", token)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "906:    `\"`),",
          "907:   `\"`,",
          "908:  )",
          "",
          "[Removed Lines]",
          "909: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1eebb57bf41c2e3907c9456c1866e8bcc7110b9d",
      "candidate_info": {
        "commit_hash": "1eebb57bf41c2e3907c9456c1866e8bcc7110b9d",
        "repo": "microcosm-cc/bluemonday",
        "commit_url": "https://github.com/microcosm-cc/bluemonday/commit/1eebb57bf41c2e3907c9456c1866e8bcc7110b9d",
        "files": [
          "policy.go",
          "sanitize.go",
          "sanitize_test.go"
        ],
        "message": "Add RequireSandboxOnIFrame",
        "before_after_code_files": [
          "policy.go||policy.go",
          "sanitize.go||sanitize.go",
          "sanitize_test.go||sanitize_test.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "policy.go||policy.go",
            "sanitize.go||sanitize.go",
            "sanitize_test.go||sanitize_test.go"
          ],
          "candidate": [
            "policy.go||policy.go",
            "sanitize.go||sanitize.go",
            "sanitize_test.go||sanitize_test.go"
          ]
        }
      },
      "candidate_diff": {
        "policy.go||policy.go": [
          "File: policy.go -> policy.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "75:  requireCrossOriginAnonymous bool",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:  requireSandboxOnIFrame map[string]bool",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "190: type urlPolicy func(url *url.URL) (allowUrl bool)",
          "193: func (p *Policy) init() {",
          "194:  if !p.initialized {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "195: type SandboxValue int64",
          "197: const (",
          "198:  SandboxAllowDownloads SandboxValue = iota",
          "199:  SandboxAllowDownloadsWithoutUserActivation",
          "200:  SandboxAllowForms",
          "201:  SandboxAllowModals",
          "202:  SandboxAllowOrientationLock",
          "203:  SandboxAllowPointerLock",
          "204:  SandboxAllowPopups",
          "205:  SandboxAllowPopupsToEscapeSandbox",
          "206:  SandboxAllowPresentation",
          "207:  SandboxAllowSameOrigin",
          "208:  SandboxAllowScripts",
          "209:  SandboxAllowStorageAccessByUserActivation",
          "210:  SandboxAllowTopNavigation",
          "211:  SandboxAllowTopNavigationByUserActivation",
          "212: )",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "680:  return p",
          "681: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "705: func (p *Policy) RequireSandboxOnIFrame(vals ...SandboxValue) {",
          "706:  p.requireSandboxOnIFrame = make(map[string]bool)",
          "708:  for val := range vals {",
          "709:   switch SandboxValue(val) {",
          "710:   case SandboxAllowDownloads:",
          "711:    p.requireSandboxOnIFrame[\"allow-downloads\"] = true",
          "713:   case SandboxAllowDownloadsWithoutUserActivation:",
          "714:    p.requireSandboxOnIFrame[\"allow-downloads-without-user-activation\"] = true",
          "716:   case SandboxAllowForms:",
          "717:    p.requireSandboxOnIFrame[\"allow-forms\"] = true",
          "719:   case SandboxAllowModals:",
          "720:    p.requireSandboxOnIFrame[\"allow-modals\"] = true",
          "722:   case SandboxAllowOrientationLock:",
          "723:    p.requireSandboxOnIFrame[\"allow-orientation-lock\"] = true",
          "725:   case SandboxAllowPointerLock:",
          "726:    p.requireSandboxOnIFrame[\"allow-pointer-lock\"] = true",
          "728:   case SandboxAllowPopups:",
          "729:    p.requireSandboxOnIFrame[\"allow-popups\"] = true",
          "731:   case SandboxAllowPopupsToEscapeSandbox:",
          "732:    p.requireSandboxOnIFrame[\"allow-popups-to-escape-sandbox\"] = true",
          "734:   case SandboxAllowPresentation:",
          "735:    p.requireSandboxOnIFrame[\"allow-presentation\"] = true",
          "737:   case SandboxAllowSameOrigin:",
          "738:    p.requireSandboxOnIFrame[\"allow-same-origin\"] = true",
          "740:   case SandboxAllowScripts:",
          "741:    p.requireSandboxOnIFrame[\"allow-scripts\"] = true",
          "743:   case SandboxAllowStorageAccessByUserActivation:",
          "744:    p.requireSandboxOnIFrame[\"allow-storage-access-by-user-activation\"] = true",
          "746:   case SandboxAllowTopNavigation:",
          "747:    p.requireSandboxOnIFrame[\"allow-top-navigation\"] = true",
          "749:   case SandboxAllowTopNavigationByUserActivation:",
          "750:    p.requireSandboxOnIFrame[\"allow-top-navigation-by-user-activation\"] = true",
          "751:   }",
          "752:  }",
          "753: }",
          "",
          "---------------"
        ],
        "sanitize.go||sanitize.go": [
          "File: sanitize.go -> sanitize.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "809:   }",
          "810:  }",
          "812:  return cleanAttrs",
          "813: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "812:  if p.requireSandboxOnIFrame != nil && elementName == \"iframe\" {",
          "813:   var sandboxFound bool",
          "814:   for i, htmlAttr := range cleanAttrs {",
          "815:    if htmlAttr.Key == \"sandbox\" {",
          "816:     sandboxFound = true",
          "817:     var cleanVals []string",
          "818:     for _, val := range strings.Fields(htmlAttr.Val) {",
          "819:      if p.requireSandboxOnIFrame[val] {",
          "820:       cleanVals = append(cleanVals, val)",
          "821:      }",
          "822:     }",
          "823:     cleanAttrs[i].Val = strings.Join(cleanVals, \" \")",
          "824:    }",
          "825:   }",
          "827:   if !sandboxFound {",
          "828:    sandbox := html.Attribute{}",
          "829:    sandbox.Key = \"sandbox\"",
          "830:    sandbox.Val = \"\"",
          "831:    cleanAttrs = append(cleanAttrs, sandbox)",
          "832:   }",
          "833:  }",
          "",
          "---------------"
        ],
        "sanitize_test.go||sanitize_test.go": [
          "File: sanitize_test.go -> sanitize_test.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "1871:  wg.Wait()",
          "1872: }",
          "1874: func TestSanitizedURL(t *testing.T) {",
          "1875:  tests := []test{",
          "1876:   {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1874: func TestIFrameSandbox(t *testing.T) {",
          "1875:  p := NewPolicy()",
          "1876:  p.AllowAttrs(\"sandbox\").OnElements(\"iframe\")",
          "1877:  p.RequireSandboxOnIFrame(SandboxAllowDownloads)",
          "1879:  in := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads\"></iframe>`",
          "1880:  expected := `<iframe sandbox=\"allow-downloads\"></iframe>`",
          "1881:  out := p.Sanitize(in)",
          "1882:  if out != expected {",
          "1883:   t.Errorf(",
          "1884:    \"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",",
          "1885:    in,",
          "1886:    out,",
          "1887:    expected,",
          "1888:   )",
          "1889:  }",
          "1890: }",
          "",
          "---------------"
        ]
      }
    }
  ]
}