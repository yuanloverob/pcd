{
  "cve_id": "CVE-2023-47112",
  "cve_desc": "Rundeck is an open source automation service with a web console, command line tools and a WebAPI. In affected versions access to two URLs used in both Rundeck Open Source and Process Automation products could allow authenticated users to access the URL path, which provides a list of job names and groups for any project, without the necessary authorization checks. The output of these endpoints only exposes the name of job groups and the jobs contained within the specified project. The output is read-only and the access does not allow changes to the information. This vulnerability has been patched in version 4.17.3. Users are advised to upgrade. Users unable to upgrade may block access to the two URLs used in either Rundeck Open Source or Process Automation products at a load balancer level.",
  "repo": "rundeck/rundeck",
  "patch_hash": "8992879036a1ddacfca78559d823be0424796e7e",
  "patch_info": {
    "commit_hash": "8992879036a1ddacfca78559d823be0424796e7e",
    "repo": "rundeck/rundeck",
    "commit_url": "https://github.com/rundeck/rundeck/commit/8992879036a1ddacfca78559d823be0424796e7e",
    "files": [
      "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
      "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
    ],
    "message": "Merge pull request from GHSA-xvmv-4rx6-x6jx\n\nremove unused controller",
    "before_after_code_files": [
      "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
      "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
    ]
  },
  "patch_diff": {
    "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy": [
      "File: rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy -> rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy": [
      "File: rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy -> rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy",
      "--- Hunk 1 ---",
      "[Context before]",
      "48:         }",
      "49:         \"/api/$api_version/incubator/executions/$id\"(controller: 'rdExecution', action: \"listForJob\")",
      "57:         \"/api/$api_version/job/$id\"(controller: 'scheduledExecution') {",
      "58:             action = [GET: 'apiJobExport', DELETE: 'apiJobDelete']",
      "59:         }",
      "",
      "[Removed Lines]",
      "51:         \"/api/$api_version/incubator/job/$id?\"(controller: 'rdJob') {",
      "52:             action = [GET: 'get', POST: 'save', DELETE: 'delete']",
      "53:         }",
      "55:         \"/api/$api_version/incubator/jobs\"(controller: 'rdJob', action: \"query\")",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "03c4833c05a79a8e73d296980ffbd778e614e8f3",
      "candidate_info": {
        "commit_hash": "03c4833c05a79a8e73d296980ffbd778e614e8f3",
        "repo": "rundeck/rundeck",
        "commit_url": "https://github.com/rundeck/rundeck/commit/03c4833c05a79a8e73d296980ffbd778e614e8f3",
        "files": [
          "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
          "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
        ],
        "message": "remove unused controller",
        "before_after_code_files": [
          "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
          "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
            "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
          ],
          "candidate": [
            "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
            "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy"
          ]
        }
      },
      "candidate_diff": {
        "rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy||rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy": [
          "File: rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy -> rundeckapp/grails-app/controllers/rundeck/controllers/RdJobController.groovy",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy||rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy": [
          "File: rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy -> rundeckapp/grails-app/controllers/rundeckapp/UrlMappings.groovy",
          "--- Hunk 1 ---",
          "[Context before]",
          "48:         }",
          "49:         \"/api/$api_version/incubator/executions/$id\"(controller: 'rdExecution', action: \"listForJob\")",
          "57:         \"/api/$api_version/job/$id\"(controller: 'scheduledExecution') {",
          "58:             action = [GET: 'apiJobExport', DELETE: 'apiJobDelete']",
          "59:         }",
          "",
          "[Removed Lines]",
          "51:         \"/api/$api_version/incubator/job/$id?\"(controller: 'rdJob') {",
          "52:             action = [GET: 'get', POST: 'save', DELETE: 'delete']",
          "53:         }",
          "55:         \"/api/$api_version/incubator/jobs\"(controller: 'rdJob', action: \"query\")",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}