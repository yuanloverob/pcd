{
  "cve_id": "CVE-2023-1001",
  "cve_desc": "A vulnerability, which was classified as problematic, has been found in xuliangzhan vxe-table up to 3.7.9. This issue affects the function export of the file packages/textarea/src/textarea.js of the component vxe-textarea. The manipulation of the argument inputValue leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 3.7.10 is able to address this issue. The patch is named d70b0e089740b65a22c89c106ebc4627ac48a22d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-266123.",
  "repo": "x-extends/vxe-table",
  "patch_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
  "patch_info": {
    "commit_hash": "d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "repo": "x-extends/vxe-table",
    "commit_url": "https://github.com/x-extends/vxe-table/commit/d70b0e089740b65a22c89c106ebc4627ac48a22d",
    "files": [
      "packages/table/src/body.js",
      "packages/textarea/src/textarea.js"
    ],
    "message": "textarea \u4fee\u590d\u6ce8\u5165xss\u95ee\u9898 #I8O21R",
    "before_after_code_files": [
      "packages/table/src/body.js||packages/table/src/body.js",
      "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js"
    ]
  },
  "patch_diff": {
    "packages/table/src/body.js||packages/table/src/body.js": [
      "File: packages/table/src/body.js -> packages/table/src/body.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "499:     elemStore[`${prefix}xSpace`] = $refs.xSpace",
      "500:     elemStore[`${prefix}ySpace`] = $refs.ySpace",
      "501:     elemStore[`${prefix}emptyBlock`] = $refs.emptyBlock",
      "504:   },",
      "505:   beforeDestroy () {",
      "506:     clearTimeout(this.wheelTime)",
      "",
      "[Removed Lines]",
      "502:     this.$el.onscroll = this.scrollEvent",
      "503:     this.$el._onscroll = this.scrollEvent",
      "",
      "[Added Lines]",
      "502:     if (this.$el) {",
      "503:       this.$el.onscroll = this.scrollEvent",
      "504:       this.$el._onscroll = this.scrollEvent",
      "505:     }",
      "",
      "---------------"
    ],
    "packages/textarea/src/textarea.js||packages/textarea/src/textarea.js": [
      "File: packages/textarea/src/textarea.js -> packages/textarea/src/textarea.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "188:         autoTxtElem.className = ['vxe-textarea--autosize', size ? `size--${size}` : ''].join(' ')",
      "189:         autoTxtElem.style.width = `${textElem.clientWidth}px`",
      "190:         autoTxtElem.style.padding = textStyle.padding",
      "192:       }",
      "193:     },",
      "194:     handleResize () {",
      "",
      "[Removed Lines]",
      "191:         autoTxtElem.innerHTML = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "[Added Lines]",
      "191:         autoTxtElem.innerText = ('' + (inputValue || '\u3000')).replace(/\\n$/, '\\n\u3000')",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d21df41f0cb890e1836fdcab199952d6e70d7ccc",
      "candidate_info": {
        "commit_hash": "d21df41f0cb890e1836fdcab199952d6e70d7ccc",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/d21df41f0cb890e1836fdcab199952d6e70d7ccc",
        "files": [
          "packages/table/src/methods.js"
        ],
        "message": "column \u589e\u52a0\u53c2\u6570 titleSuffix",
        "before_after_code_files": [
          "packages/table/src/methods.js||packages/table/src/methods.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/src/methods.js||packages/table/src/methods.js": [
          "File: packages/table/src/methods.js -> packages/table/src/methods.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "2811:     }",
          "2812:   },",
          "2813:   triggerHeaderTitleEvent (evnt, iconParams, params) {",
          "2815:       const { $refs, tooltipStore } = this",
          "2817:       this.handleTargetEnterEvent(true)",
          "2818:       tooltipStore.visible = true",
          "2819:       tooltipStore.currOpts = { ...params, content: null }",
          "",
          "[Removed Lines]",
          "2814:     if (iconParams.content || iconParams.message) {",
          "2816:       const content = getFuncText(iconParams.content || iconParams.message)",
          "",
          "[Added Lines]",
          "2814:     const tipContent = iconParams.content || iconParams.message",
          "2815:     if (tipContent) {",
          "2817:       const content = getFuncText(tipContent)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "db4358a6300cb10d34cec866c115187d527e285d",
      "candidate_info": {
        "commit_hash": "db4358a6300cb10d34cec866c115187d527e285d",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/db4358a6300cb10d34cec866c115187d527e285d",
        "files": [
          "package.json",
          "packages/grid/src/grid.ts"
        ],
        "message": "\u652f\u6301\u56fd\u9645\u5316",
        "before_after_code_files": [
          "packages/grid/src/grid.ts||packages/grid/src/grid.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/grid/src/grid.ts||packages/grid/src/grid.ts": [
          "File: packages/grid/src/grid.ts -> packages/grid/src/grid.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "385:       return this.proxyOpts.showActiveMsg",
          "386:     },",
          "387:     proxyOpts () {",
          "388:       return XEUtils.merge({}, getConfig().grid.proxyConfig, this.proxyConfig)",
          "389:     },",
          "390:     pagerOpts () {",
          "391:       return Object.assign({}, getConfig().grid.pagerConfig, this.pagerConfig)",
          "392:     },",
          "393:     formOpts () {",
          "394:       return Object.assign({}, getConfig().grid.formConfig, this.formConfig)",
          "395:     },",
          "396:     toolbarOpts () {",
          "397:       return Object.assign({}, getConfig().grid.toolbarConfig, this.toolbarConfig || this.toolbar)",
          "398:     },",
          "399:     zoomOpts () {",
          "400:       return Object.assign({}, getConfig().grid.zoomConfig, this.zoomConfig)",
          "401:     },",
          "402:     renderStyle () {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "388:       return this.computeProxyOpts",
          "389:     },",
          "390:     computeProxyOpts () {",
          "394:       return this.computePagerOpts",
          "395:     },",
          "396:     computePagerOpts () {",
          "400:       return this.computeFormOpts",
          "401:     },",
          "402:     computeFormOpts () {",
          "406:       return this.computeToolbarOpts",
          "407:     },",
          "408:     computeToolbarOpts () {",
          "412:       return this.computeZoomOpts",
          "413:     },",
          "414:     computeZoomOpts () {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "68dce361fbd8324aa6fb28636dcd68049ccb5936",
      "candidate_info": {
        "commit_hash": "68dce361fbd8324aa6fb28636dcd68049ccb5936",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/68dce361fbd8324aa6fb28636dcd68049ccb5936",
        "files": [
          "package.json",
          "packages/table/src/methods.ts"
        ],
        "message": "releases 3.11.6",
        "before_after_code_files": [
          "packages/table/src/methods.ts||packages/table/src/methods.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/src/methods.ts||packages/table/src/methods.ts": [
          "File: packages/table/src/methods.ts -> packages/table/src/methods.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "508:   if (!el || !el.clientWidth) {",
          "509:     return $xeTable.$nextTick()",
          "510:   }",
          "512:   $xeTable.calcCellWidth()",
          "513:   $xeTable.autoCellWidth()",
          "514:   if (reFull === true) {",
          "",
          "[Removed Lines]",
          "511:   calcCellHeight($xeTable)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2750:               height = Math.max(height, cellHeight)",
          "2751:             }",
          "2752:           }",
          "2754:         }",
          "2755:       })",
          "2756:     }",
          "",
          "[Removed Lines]",
          "2753:           rowRest.height = height",
          "",
          "[Added Lines]",
          "2752:           rowRest.height = scrollXLoad ? Math.max(rowRest.height, height) : height",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b4f42ce260e49695378cd3d59c5990dd3315ed2a",
      "candidate_info": {
        "commit_hash": "b4f42ce260e49695378cd3d59c5990dd3315ed2a",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/b4f42ce260e49695378cd3d59c5990dd3315ed2a",
        "files": [
          "packages/tools/dom.js"
        ],
        "message": "Update dom.js\n\n\u5f53\u4e3b\u9875\u9762\u5d4c\u5957\u5728iframe\u65f6\uff0celem.getBoundingClientRect()\u4ec5\u8ba1\u7b97\u5728\u5f53\u524dbody\u5185\u7684\u8fb9\u754c\u8ddd\u79bb\uff0c\u5ffd\u7565\u4e86body\u6240\u5728\u7684\u8fb9\u754c\u8ddd\u79bb,\u5bfc\u81f4tooltip\u5728\u5fae\u524d\u7aef\u5d4c\u5957\u73af\u5883\u65f6\u504f\u79bb\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0bbody\u7684\u8fb9\u754c\u8ddd\u79bb\u4e3a0\uff0c\u4e0d\u5f71\u54cd\u6b63\u5e38\u4f7f\u7528",
        "before_after_code_files": [
          "packages/tools/dom.js||packages/tools/dom.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/tools/dom.js||packages/tools/dom.js": [
          "File: packages/tools/dom.js -> packages/tools/dom.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "132:     return getNodeOffset(elem, container, { left: 0, top: 0 })",
          "133:   },",
          "134:   getAbsolutePos (elem) {",
          "135:     const bounding = elem.getBoundingClientRect()",
          "138:     const { scrollTop, scrollLeft, visibleHeight, visibleWidth } = getDomNode()",
          "139:     return { boundingTop, top: scrollTop + boundingTop, boundingLeft, left: scrollLeft + boundingLeft, visibleHeight, visibleWidth }",
          "140:   },",
          "",
          "[Removed Lines]",
          "136:     const boundingTop = bounding.top",
          "137:     const boundingLeft = bounding.left",
          "",
          "[Added Lines]",
          "136:     const bodyBounding = document.body.getBoundingClientRect()",
          "138:     const boundingTop = bounding.top - bodyBounding.top",
          "139:     const boundingLeft = bounding.left - bodyBounding.left",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "125453a8f78e43aa12a045cc9b9f6b79b5893316",
      "candidate_info": {
        "commit_hash": "125453a8f78e43aa12a045cc9b9f6b79b5893316",
        "repo": "x-extends/vxe-table",
        "commit_url": "https://github.com/x-extends/vxe-table/commit/125453a8f78e43aa12a045cc9b9f6b79b5893316",
        "files": [
          "package.json",
          "packages/table/module/edit/mixin.ts",
          "packages/table/src/methods.ts"
        ],
        "message": "releases 3.10.13",
        "before_after_code_files": [
          "packages/table/module/edit/mixin.ts||packages/table/module/edit/mixin.ts",
          "packages/table/src/methods.ts||packages/table/src/methods.ts"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/x-extends/vxe-table/pull/1672",
          "https://github.com/wangdaodao/vxe-table/pull/4"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "packages/table/module/edit/mixin.ts||packages/table/module/edit/mixin.ts": [
          "File: packages/table/module/edit/mixin.ts -> packages/table/module/edit/mixin.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "634:           if (XEUtils.isFunction(autoFocus)) {",
          "635:             inputElem = autoFocus.call(this, params)",
          "636:           } else if (autoFocus) {",
          "638:             if (inputElem) {",
          "639:               inputElem.focus()",
          "640:             }",
          "",
          "[Removed Lines]",
          "637:             inputElem = cell.querySelector(autoFocus)",
          "",
          "[Added Lines]",
          "637:             if (autoFocus === true) {",
          "639:               inputElem = cell.querySelector('input,textarea')",
          "640:             } else {",
          "641:               inputElem = cell.querySelector(autoFocus)",
          "642:             }",
          "",
          "---------------"
        ],
        "packages/table/src/methods.ts||packages/table/src/methods.ts": [
          "File: packages/table/src/methods.ts -> packages/table/src/methods.ts"
        ]
      }
    }
  ]
}