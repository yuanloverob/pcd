{
  "cve_id": "CVE-2022-41711",
  "cve_desc": "Badaso version 2.6.0 allows an unauthenticated remote attacker to execute arbitrary code remotely on the server. This is possible because the application does not properly validate the data uploaded by users.",
  "repo": "uasoft-indonesia/badaso",
  "patch_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
  "patch_info": {
    "commit_hash": "22250eca7c364d991ce9e0a723941eae4889d6f9",
    "repo": "uasoft-indonesia/badaso",
    "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/22250eca7c364d991ce9e0a723941eae4889d6f9",
    "files": [
      "src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue"
    ],
    "message": "Merge pull request #807 from uasoft-indonesia/bugfix/v2/filter-mimeType\n\nBugfix[v2] add filter mimeType",
    "before_after_code_files": [
      "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue",
      "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue",
      "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue",
      "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue"
    ]
  },
  "patch_diff": {
    "src/resources/js/components/BadasoUploadFile.vue||src/resources/js/components/BadasoUploadFile.vue": [
      "File: src/resources/js/components/BadasoUploadFile.vue -> src/resources/js/components/BadasoUploadFile.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "336:           });",
      "337:           return;",
      "338:         }",
      "340:         this.uploadFile(files[0]);",
      "341:       }",
      "342:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "339:         if (!this.availableMimetypes.file.validMime.includes(files[0].type)) {",
      "340:           this.$vs.notify({",
      "341:             title: this.$t(\"alert.danger\"),",
      "342:             text: \"File type not allowed\",",
      "343:             color: \"danger\",",
      "344:           });",
      "345:           return;",
      "346:         }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadFileMultiple.vue||src/resources/js/components/BadasoUploadFileMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadFileMultiple.vue -> src/resources/js/components/BadasoUploadFileMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "367:             });",
      "368:             return;",
      "369:           }",
      "371:           this.uploadFile(file);",
      "372:         }",
      "373:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "370:           if (!this.availableMimetypes.file.validMime.includes(file.type)) {",
      "371:             this.$vs.notify({",
      "372:               title: this.$t(\"alert.danger\"),",
      "373:               text: \"File type not allowed\",",
      "374:               color: \"danger\",",
      "375:             });",
      "376:             return;",
      "377:           }",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImage.vue||src/resources/js/components/BadasoUploadImage.vue": [
      "File: src/resources/js/components/BadasoUploadImage.vue -> src/resources/js/components/BadasoUploadImage.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "380:           });",
      "381:           return;",
      "382:         }",
      "384:         this.uploadImage(files[0]);",
      "385:       }",
      "386:     },",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "383:         if (!this.availableMimetypes.image.validMime.includes(files[0].type)){",
      "384:           this.$vs.notify({",
      "385:             title: this.$t(\"alert.danger\"),",
      "386:             text: \"File type not allowed\",",
      "387:             color: \"danger\",",
      "388:           });",
      "389:           return;",
      "390:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:     uploadImage(file) {",
      "422:       const files = new FormData();",
      "423:       files.append(\"upload\", file);",
      "425:       files.append(\"working_dir\", this.getActiveFolder);",
      "426:       this.$api.badasoFile",
      "427:         .uploadUsingLfm(files)",
      "",
      "[Removed Lines]",
      "424:       files.append(\"type\", \"image\");",
      "",
      "[Added Lines]",
      "431:       files.append(\"type\", file.type);",
      "",
      "---------------"
    ],
    "src/resources/js/components/BadasoUploadImageMultiple.vue||src/resources/js/components/BadasoUploadImageMultiple.vue": [
      "File: src/resources/js/components/BadasoUploadImageMultiple.vue -> src/resources/js/components/BadasoUploadImageMultiple.vue",
      "--- Hunk 1 ---",
      "[Context before]",
      "395:             });",
      "396:             return;",
      "397:           }",
      "399:           this.uploadImage(file);",
      "400:         }",
      "401:       }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "398:           if (!this.availableMimetypes.image.validMime.includes(file.type)) {",
      "399:             this.$vs.notify({",
      "400:               title: this.$t(\"alert.danger\"),",
      "401:               text: \"File type not allowed\",",
      "402:               color: \"danger\",",
      "403:             });",
      "404:             return;",
      "405:           }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "98eaf24f2526db7f918b29810c259fb641ff4f46",
      "candidate_info": {
        "commit_hash": "98eaf24f2526db7f918b29810c259fb641ff4f46",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/98eaf24f2526db7f918b29810c259fb641ff4f46",
        "files": [
          ".github/workflows/phpunit.yml",
          "src/Controllers/BadasoAuthController.php",
          "src/resources/js/pages/configuration/browse.vue"
        ],
        "message": "task change default role",
        "before_after_code_files": [
          "src/Controllers/BadasoAuthController.php||src/Controllers/BadasoAuthController.php",
          "src/resources/js/pages/configuration/browse.vue||src/resources/js/pages/configuration/browse.vue"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/Controllers/BadasoAuthController.php||src/Controllers/BadasoAuthController.php": [
          "File: src/Controllers/BadasoAuthController.php -> src/Controllers/BadasoAuthController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: use Uasoft\\Badaso\\Mail\\ForgotPassword;",
          "18: use Uasoft\\Badaso\\Mail\\SendUserVerification;",
          "19: use Uasoft\\Badaso\\Middleware\\BadasoAuthenticate;",
          "20: use Uasoft\\Badaso\\Models\\EmailReset;",
          "21: use Uasoft\\Badaso\\Models\\PasswordReset;",
          "22: use Uasoft\\Badaso\\Models\\Role;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20: use Uasoft\\Badaso\\Models\\Configuration;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "439:     protected function getCustomerRole()",
          "440:     {",
          "443:         if (is_null($role)) {",
          "444:             $role = new Role();",
          "",
          "[Removed Lines]",
          "441:         $role = Role::where('name', 'customer')->first();",
          "",
          "[Added Lines]",
          "442:         $name_role = Configuration::where('key', 'defaultRoleRegistration')->select('value')->first();",
          "443:         $role = Role::where('name', $name_role->value)->first();",
          "",
          "---------------"
        ],
        "src/resources/js/pages/configuration/browse.vue||src/resources/js/pages/configuration/browse.vue": [
          "File: src/resources/js/pages/configuration/browse.vue -> src/resources/js/pages/configuration/browse.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "277:   components: {},",
          "278:   data: () => ({",
          "279:     configurations: [],",
          "280:     willDeleteConfigurationId: null,",
          "281:   }),",
          "282:   computed: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "280:     role: [],",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "319:     },",
          "320:     getConfigurationList() {",
          "321:       this.$openLoader();",
          "322:       this.$api.badasoConfiguration",
          "323:         .browse()",
          "324:         .then((response) => {",
          "325:           this.$closeLoader();",
          "326:           const configurations = response.data.configurations.map((data) => {",
          "327:             try {",
          "330:                 data.value = data.details.value ? data.details.value : \"\";",
          "331:               }",
          "333:                 data.value = data.value == \"1\";",
          "334:               }",
          "335:               const typeRequiredItems = [",
          "",
          "[Removed Lines]",
          "328:               data.details = JSON.parse(data.details);",
          "329:               if (data.type == \"hidden\") {",
          "332:               if (data.type == \"switch\") {",
          "",
          "[Added Lines]",
          "323:       this.$api.badasoRole",
          "324:       .browse()",
          "325:       .then((response) => {",
          "326:         response.data.roles.map((data) => {",
          "327:             const temp = {'label': data.displayName, 'value': data.name}",
          "328:             this.role.push(temp)",
          "329:             return data",
          "330:         });",
          "331:       })",
          "332:       .catch((error) => {",
          "333:           this.$closeLoader();",
          "334:           this.$vs.notify({",
          "335:             title: this.$t(\"alert.danger\"),",
          "336:             text: error.message,",
          "337:             color: \"danger\",",
          "338:           });",
          "339:         });",
          "346:               data.details = JSON.parse(data.details);",
          "347:               if (data.type === \"hidden\") {",
          "350:               if(data.details.key === 'defaultRoleRegistration' ){",
          "351:                  data.details.items = this.role",
          "352:               }",
          "353:               if (data.type === \"switch\") {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1b6466f3ba39532fff74c4ce8aa9eb9468611fc5",
      "candidate_info": {
        "commit_hash": "1b6466f3ba39532fff74c4ce8aa9eb9468611fc5",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/1b6466f3ba39532fff74c4ce8aa9eb9468611fc5",
        "files": [
          "src/resources/js/lang/modules/id.js"
        ],
        "message": "Update id.js",
        "before_after_code_files": [
          "src/resources/js/lang/modules/id.js||src/resources/js/lang/modules/id.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/lang/modules/id.js||src/resources/js/lang/modules/id.js": [
          "File: src/resources/js/lang/modules/id.js -> src/resources/js/lang/modules/id.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1041:           \"Pastikan tabel belum dibuat dengan CRUD Management jika ingin mengedit atau menghapus tabel.\",",
          "1043:         fieldAttUnsigned: \"Batasan kunci asing salah dibentuk. {0} untuk mengunjungi dokumentasi\",",
          "1048:         visitDocs: \"Klik Disini\",",
          "1049:       },",
          "1050:       error: {",
          "",
          "[Removed Lines]",
          "1044: <<<<<<< HEAD",
          "1045: =======",
          "1046:         fieldAttUnsigned: \"Foreign key constraint is incorrectly formed. {0} to visit docs.\",",
          "1047: >>>>>>> a1a682b8a68046ebfeefbace1e9846355b266667",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fe8f4a269fadc7f6269a55c5fe8e86a6868627e6",
      "candidate_info": {
        "commit_hash": "fe8f4a269fadc7f6269a55c5fe8e86a6868627e6",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/fe8f4a269fadc7f6269a55c5fe8e86a6868627e6",
        "files": [
          "src/resources/js/components/BadasoSidebarMenu.vue",
          "src/resources/js/layout/admin/sidebar/SideBar.vue"
        ],
        "message": "repair compnent sidebar",
        "before_after_code_files": [
          "src/resources/js/components/BadasoSidebarMenu.vue||src/resources/js/components/BadasoSidebarMenu.vue",
          "src/resources/js/layout/admin/sidebar/SideBar.vue||src/resources/js/layout/admin/sidebar/SideBar.vue"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/components/BadasoSidebarMenu.vue||src/resources/js/components/BadasoSidebarMenu.vue": [
          "File: src/resources/js/components/BadasoSidebarMenu.vue -> src/resources/js/components/BadasoSidebarMenu.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "78:   props: {",
          "79:     defaultIsExpand: {",
          "80:       type: Boolean,",
          "82:     },",
          "83:     icon: {",
          "84:       type: String,",
          "",
          "[Removed Lines]",
          "81:       default: true,",
          "",
          "[Added Lines]",
          "81:       default: false,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "94:     },",
          "95:     children: {",
          "96:       type: Array,",
          "98:     },",
          "99:   },",
          "100:   computed: {",
          "",
          "[Removed Lines]",
          "97:       default: [],",
          "",
          "[Added Lines]",
          "97:       default: () => {",
          "98:         []",
          "99:       },",
          "",
          "---------------"
        ],
        "src/resources/js/layout/admin/sidebar/SideBar.vue||src/resources/js/layout/admin/sidebar/SideBar.vue": [
          "File: src/resources/js/layout/admin/sidebar/SideBar.vue -> src/resources/js/layout/admin/sidebar/SideBar.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "50:         <!-- if show header -->",
          "51:         <badaso-sidebar-group",
          "52:           :title=\"displayMenu.menu.displayName\"",
          "54:           :icon=\"displayMenu.menu.icon\"",
          "55:           :key=\"indexMenu\"",
          "56:           v-if=\"",
          "",
          "[Removed Lines]",
          "53:           :open=\"displayMenu.menu.isExpand\"",
          "",
          "[Added Lines]",
          "53:           :open=\"displayMenu.menu.isExpand == 1\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61:         >",
          "62:           <template v-for=\"(menu, index) in displayMenu.menuItems\">",
          "63:             <badaso-sidebar-menu",
          "65:               :title=\"menu.title\"",
          "66:               :url=\"menu.url\"",
          "67:               :icon=\"menu.icon\"",
          "",
          "[Removed Lines]",
          "64:               :defaultIsExpand=\"menu.isExpand\"",
          "",
          "[Added Lines]",
          "64:               :defaultIsExpand=\"menu.isExpand == 1\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "75:         <div :key=\"indexMenu\" v-else>",
          "76:           <template v-for=\"(menu, index) in displayMenu.menuItems\">",
          "77:             <badaso-sidebar-menu",
          "79:               :title=\"menu.title\"",
          "80:               :url=\"menu.url\"",
          "81:               :icon=\"menu.icon\"",
          "",
          "[Removed Lines]",
          "78:               :defaultIsExpand=\"menu.isExpand\"",
          "",
          "[Added Lines]",
          "78:               :defaultIsExpand=\"menu.isExpand == 1\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1fcd6d1adb3024bea3e84a9d983b3be084dd5dcd",
      "candidate_info": {
        "commit_hash": "1fcd6d1adb3024bea3e84a9d983b3be084dd5dcd",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/1fcd6d1adb3024bea3e84a9d983b3be084dd5dcd",
        "files": [
          "src/resources/js/components/BadasoSidebarItem.vue",
          "src/resources/js/store/modules/badaso.js"
        ],
        "message": "typo class sidebar-item",
        "before_after_code_files": [
          "src/resources/js/components/BadasoSidebarItem.vue||src/resources/js/components/BadasoSidebarItem.vue",
          "src/resources/js/store/modules/badaso.js||src/resources/js/store/modules/badaso.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/components/BadasoSidebarItem.vue||src/resources/js/components/BadasoSidebarItem.vue": [
          "File: src/resources/js/components/BadasoSidebarItem.vue -> src/resources/js/components/BadasoSidebarItem.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <template>",
          "2:   <div",
          "3:     :class=\"{ 'vs-sidebar-item-active': getActive }\"",
          "5:     @click=\"setIndexActive\"",
          "6:   >",
          "7:     <router-link v-if=\"to && target === '_self'\" :to=\"to\">",
          "",
          "[Removed Lines]",
          "4:     class=\"vs-sidebar--item \"",
          "",
          "[Added Lines]",
          "4:     class=\"vs-sidebar--item\"",
          "",
          "---------------"
        ],
        "src/resources/js/store/modules/badaso.js||src/resources/js/store/modules/badaso.js": [
          "File: src/resources/js/store/modules/badaso.js -> src/resources/js/store/modules/badaso.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "52:       const menuItemAddPrefix = (arrayMenuChild, callbackMenuItemAddPrefix) => {",
          "53:         arrayMenuChild = arrayMenuChild.map((menuItem) => {",
          "56:           menuItem.icon = menuItem.iconClass;",
          "58:           if (menuItem.children) {",
          "",
          "[Removed Lines]",
          "55:           menuItem.url = menuItem.url.substring(0,4) == 'http' ? menuItem.url: \"/\" + prefix + menuItem.url;",
          "",
          "[Added Lines]",
          "54:           menuItem.url =",
          "55:             menuItem.url.substring(0, 4) == \"http\" ? menuItem.url: \"/\" + prefix + menuItem.url;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0e58a696f9a1eb398f3d89661b786caa8242ed10",
      "candidate_info": {
        "commit_hash": "0e58a696f9a1eb398f3d89661b786caa8242ed10",
        "repo": "uasoft-indonesia/badaso",
        "commit_url": "https://github.com/uasoft-indonesia/badaso/commit/0e58a696f9a1eb398f3d89661b786caa8242ed10",
        "files": [
          "src/resources/js/pages/crud-generated/add.vue"
        ],
        "message": "fix time component",
        "before_after_code_files": [
          "src/resources/js/pages/crud-generated/add.vue||src/resources/js/pages/crud-generated/add.vue"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/uasoft-indonesia/badaso/pull/1086"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/resources/js/pages/crud-generated/add.vue||src/resources/js/pages/crud-generated/add.vue": [
          "File: src/resources/js/pages/crud-generated/add.vue -> src/resources/js/pages/crud-generated/add.vue",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:                     :label=\"dataRow.displayName\"",
          "102:                     :placeholder=\"dataRow.displayName\"",
          "103:                     v-model=\"dataRow.value\"",
          "105:                     size=\"12\"",
          "106:                     :alert=\"",
          "107:                       errors[$caseConvert.stringSnakeToCamel(dataRow.field)]",
          "",
          "[Removed Lines]",
          "104:                     value-zone=\"Asia/Jakarta\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "122:                     :label=\"dataRow.displayName\"",
          "123:                     :placeholder=\"dataRow.displayName\"",
          "124:                     v-model=\"dataRow.value\"",
          "126:                     size=\"12\"",
          "127:                     :alert=\"",
          "128:                       errors[$caseConvert.stringSnakeToCamel(dataRow.field)]",
          "",
          "[Removed Lines]",
          "125:                     value-zone=\"Asia/Jakarta\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}