{
  "cve_id": "CVE-2019-1197",
  "cve_desc": "",
  "repo": "chakra-core/ChakraCore",
  "patch_hash": "bf52b6cfa96d6395046d0aaf87396cd7ca13f6cb",
  "patch_info": {
    "commit_hash": "bf52b6cfa96d6395046d0aaf87396cd7ca13f6cb",
    "repo": "chakra-core/ChakraCore",
    "commit_url": "https://github.com/chakra-core/ChakraCore/commit/bf52b6cfa96d6395046d0aaf87396cd7ca13f6cb",
    "files": [
      "lib/Backend/GlobOptIntBounds.cpp"
    ],
    "message": "[CVE-2019-1197] Chakra JIT Type Confusion",
    "before_after_code_files": [
      "lib/Backend/GlobOptIntBounds.cpp||lib/Backend/GlobOptIntBounds.cpp"
    ]
  },
  "patch_diff": {
    "lib/Backend/GlobOptIntBounds.cpp||lib/Backend/GlobOptIntBounds.cpp": [
      "File: lib/Backend/GlobOptIntBounds.cpp -> lib/Backend/GlobOptIntBounds.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "1278:     }",
      "1282:     for (Loop * loop = this->currentBlock->loop; loop; loop = loop->parent)",
      "1283:     {",
      "1286:         {",
      "1288:         }",
      "1289:     }",
      "1290: }",
      "",
      "[Removed Lines]",
      "1284:         InductionVariable *iv = nullptr;",
      "1285:         if (loop->inductionVariables && loop->inductionVariables->TryGetReference(dstSym->m_id, &iv))",
      "1287:             iv->SetChangeIsIndeterminate();",
      "",
      "[Added Lines]",
      "1288:         if (loop->inductionVariables && loop->inductionVariables->ContainsKey(dstSym->m_id))",
      "1290:             for (auto it = loop->inductionVariables->GetIterator(); it.IsValid(); it.MoveNext())",
      "1291:             {",
      "1292:                 InductionVariable& inductionVariable = it.CurrentValueReference();",
      "1293:                 inductionVariable.SetChangeIsIndeterminate();",
      "1294:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "242c59ea40c0428e1ced7366bf2c28bfbdda1999",
      "candidate_info": {
        "commit_hash": "242c59ea40c0428e1ced7366bf2c28bfbdda1999",
        "repo": "chakra-core/ChakraCore",
        "commit_url": "https://github.com/chakra-core/ChakraCore/commit/242c59ea40c0428e1ced7366bf2c28bfbdda1999",
        "files": [
          "lib/Parser/Parse.cpp"
        ],
        "message": "[CVE-2019-1131] Chakra Type confusion",
        "before_after_code_files": [
          "lib/Parser/Parse.cpp||lib/Parser/Parse.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/chakra-core/ChakraCore/pull/6243"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/Parser/Parse.cpp||lib/Parser/Parse.cpp": [
          "File: lib/Parser/Parse.cpp -> lib/Parser/Parse.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "4664:                     }",
          "4665:                 }",
          "4672:                 bool couldBeObjectPattern = !isObjectPattern && m_token.tk == tkAsg;",
          "",
          "[Removed Lines]",
          "4667:                 if (buildAST)",
          "4668:                 {",
          "4669:                     CheckArgumentsUse(pidHint, GetCurrentFunctionNode());",
          "4670:                 }",
          "",
          "[Added Lines]",
          "4667:                 CheckArgumentsUse(pidHint, GetCurrentFunctionNode());",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "450a349fda1b153d758a9e01698b977e60870e4c",
      "candidate_info": {
        "commit_hash": "450a349fda1b153d758a9e01698b977e60870e4c",
        "repo": "chakra-core/ChakraCore",
        "commit_url": "https://github.com/chakra-core/ChakraCore/commit/450a349fda1b153d758a9e01698b977e60870e4c",
        "files": [
          "Build/NuGet/.pack-version",
          "lib/Common/ChakraCoreVersion.h"
        ],
        "message": "Update version to 1.11.12",
        "before_after_code_files": [
          "lib/Common/ChakraCoreVersion.h||lib/Common/ChakraCoreVersion.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/chakra-core/ChakraCore/pull/6243"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/Common/ChakraCoreVersion.h||lib/Common/ChakraCoreVersion.h": [
          "File: lib/Common/ChakraCoreVersion.h -> lib/Common/ChakraCoreVersion.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: #define CHAKRA_CORE_MAJOR_VERSION 1",
          "19: #define CHAKRA_CORE_MINOR_VERSION 11",
          "21: #define CHAKRA_CORE_VERSION_RELEASE_QFE 0 // Redundant with PATCH_VERSION. Keep this value set to 0.",
          "",
          "[Removed Lines]",
          "20: #define CHAKRA_CORE_PATCH_VERSION 11",
          "",
          "[Added Lines]",
          "20: #define CHAKRA_CORE_PATCH_VERSION 12",
          "",
          "---------------"
        ]
      }
    }
  ]
}