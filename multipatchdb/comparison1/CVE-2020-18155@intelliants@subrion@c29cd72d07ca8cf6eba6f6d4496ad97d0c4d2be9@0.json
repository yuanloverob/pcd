{
  "cve_id": "CVE-2020-18155",
  "cve_desc": "SQL Injection vulnerability in Subrion CMS v4.2.1 in the search page if a website uses a PDO connection.",
  "repo": "intelliants/subrion",
  "patch_hash": "c29cd72d07ca8cf6eba6f6d4496ad97d0c4d2be9",
  "patch_info": {
    "commit_hash": "c29cd72d07ca8cf6eba6f6d4496ad97d0c4d2be9",
    "repo": "intelliants/subrion",
    "commit_url": "https://github.com/intelliants/subrion/commit/c29cd72d07ca8cf6eba6f6d4496ad97d0c4d2be9",
    "files": [
      "includes/classes/ia.core.pdo.php",
      "includes/classes/ia.core.php"
    ],
    "message": "#817 drop support for PDO",
    "before_after_code_files": [
      "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php",
      "includes/classes/ia.core.php||includes/classes/ia.core.php"
    ]
  },
  "patch_diff": {
    "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php": [
      "File: includes/classes/ia.core.pdo.php -> includes/classes/ia.core.pdo.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "includes/classes/ia.core.php||includes/classes/ia.core.php": [
      "File: includes/classes/ia.core.php -> includes/classes/ia.core.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "779:         if ('db' == $name) { // can't we get rid of this?",
      "780:             $name = INTELLI_CONNECT;",
      "781:         }",
      "783:         $fileName = iaSystem::CLASSES_PREFIX . $type . '.' . $name . iaSystem::EXECUTABLE_FILE_EXT;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "783:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
      "785:                 $name = 'mysqli';",
      "787:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0361d3ec2c084ad9ba24f87efbba93b4c4bd1666",
      "candidate_info": {
        "commit_hash": "0361d3ec2c084ad9ba24f87efbba93b4c4bd1666",
        "repo": "intelliants/subrion",
        "commit_url": "https://github.com/intelliants/subrion/commit/0361d3ec2c084ad9ba24f87efbba93b4c4bd1666",
        "files": [
          "includes/classes/ia.core.php"
        ],
        "message": "corrected code according to psr standards",
        "before_after_code_files": [
          "includes/classes/ia.core.php||includes/classes/ia.core.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/intelliants/subrion/pull/825"
        ],
        "olp_code_files": {
          "patch": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ],
          "candidate": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ]
        }
      },
      "candidate_diff": {
        "includes/classes/ia.core.php||includes/classes/ia.core.php": [
          "File: includes/classes/ia.core.php -> includes/classes/ia.core.php"
        ]
      }
    },
    {
      "candidate_hash": "1eb0e24947a85745e24f5e1b82e51c70a266c471",
      "candidate_info": {
        "commit_hash": "1eb0e24947a85745e24f5e1b82e51c70a266c471",
        "repo": "intelliants/subrion",
        "commit_url": "https://github.com/intelliants/subrion/commit/1eb0e24947a85745e24f5e1b82e51c70a266c471",
        "files": [
          "includes/classes/ia.core.php"
        ],
        "message": "corrected code according to psr standards",
        "before_after_code_files": [
          "includes/classes/ia.core.php||includes/classes/ia.core.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/intelliants/subrion/pull/825"
        ],
        "olp_code_files": {
          "patch": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ],
          "candidate": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ]
        }
      },
      "candidate_diff": {
        "includes/classes/ia.core.php||includes/classes/ia.core.php": [
          "File: includes/classes/ia.core.php -> includes/classes/ia.core.php"
        ]
      }
    },
    {
      "candidate_hash": "d51637af357dc1cab94f8e363a955d6f5d16ad74",
      "candidate_info": {
        "commit_hash": "d51637af357dc1cab94f8e363a955d6f5d16ad74",
        "repo": "intelliants/subrion",
        "commit_url": "https://github.com/intelliants/subrion/commit/d51637af357dc1cab94f8e363a955d6f5d16ad74",
        "files": [
          "includes/classes/ia.core.php"
        ],
        "message": "corrected code according to psr standards",
        "before_after_code_files": [
          "includes/classes/ia.core.php||includes/classes/ia.core.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/intelliants/subrion/pull/825"
        ],
        "olp_code_files": {
          "patch": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ],
          "candidate": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ]
        }
      },
      "candidate_diff": {
        "includes/classes/ia.core.php||includes/classes/ia.core.php": [
          "File: includes/classes/ia.core.php -> includes/classes/ia.core.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "780:         if ('db' == $name) { // can't we get rid of this?",
          "781:             $name = INTELLI_CONNECT;",
          "784:                 $name = 'mysqli';",
          "786:             }",
          "787:         }",
          "",
          "[Removed Lines]",
          "782:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
          "",
          "[Added Lines]",
          "783:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "af4cca169b35df87074a1b6198d9a59de8445104",
      "candidate_info": {
        "commit_hash": "af4cca169b35df87074a1b6198d9a59de8445104",
        "repo": "intelliants/subrion",
        "commit_url": "https://github.com/intelliants/subrion/commit/af4cca169b35df87074a1b6198d9a59de8445104",
        "files": [
          "includes/classes/ia.core.php"
        ],
        "message": "corrected code according to psr standards",
        "before_after_code_files": [
          "includes/classes/ia.core.php||includes/classes/ia.core.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/intelliants/subrion/pull/825"
        ],
        "olp_code_files": {
          "patch": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ],
          "candidate": [
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ]
        }
      },
      "candidate_diff": {
        "includes/classes/ia.core.php||includes/classes/ia.core.php": [
          "File: includes/classes/ia.core.php -> includes/classes/ia.core.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "780:         if ('db' == $name) { // can't we get rid of this?",
          "781:             $name = INTELLI_CONNECT;",
          "784:                 $name = 'mysqli';",
          "786:             }",
          "787:         }",
          "",
          "[Removed Lines]",
          "782:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
          "",
          "[Added Lines]",
          "783:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "abc681e113d19a5c4f94dc2cebce356bd0ca1e5e",
      "candidate_info": {
        "commit_hash": "abc681e113d19a5c4f94dc2cebce356bd0ca1e5e",
        "repo": "intelliants/subrion",
        "commit_url": "https://github.com/intelliants/subrion/commit/abc681e113d19a5c4f94dc2cebce356bd0ca1e5e",
        "files": [
          "includes/classes/ia.core.pdo.php",
          "includes/classes/ia.core.php"
        ],
        "message": "#817 drop support for PDO",
        "before_after_code_files": [
          "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php",
          "includes/classes/ia.core.php||includes/classes/ia.core.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/intelliants/subrion/pull/825"
        ],
        "olp_code_files": {
          "patch": [
            "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php",
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ],
          "candidate": [
            "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php",
            "includes/classes/ia.core.php||includes/classes/ia.core.php"
          ]
        }
      },
      "candidate_diff": {
        "includes/classes/ia.core.pdo.php||includes/classes/ia.core.pdo.php": [
          "File: includes/classes/ia.core.pdo.php -> includes/classes/ia.core.pdo.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "includes/classes/ia.core.php||includes/classes/ia.core.php": [
          "File: includes/classes/ia.core.php -> includes/classes/ia.core.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "779:         if ('db' == $name) { // can't we get rid of this?",
          "780:             $name = INTELLI_CONNECT;",
          "781:         }",
          "783:         $fileName = iaSystem::CLASSES_PREFIX . $type . '.' . $name . iaSystem::EXECUTABLE_FILE_EXT;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "783:             if (strtolower(INTELLI_CONNECT) == 'pdo') {",
          "785:                 $name = 'mysqli';",
          "787:             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}