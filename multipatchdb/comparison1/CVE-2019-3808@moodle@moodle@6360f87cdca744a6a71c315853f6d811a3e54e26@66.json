{
  "cve_id": "CVE-2019-3808",
  "cve_desc": "A flaw was found in Moodle versions 3.6 to 3.6.1, 3.5 to 3.5.3, 3.4 to 3.4.6, 3.1 to 3.1.15 and earlier unsupported versions. The 'manage groups' capability did not have the 'XSS risk' flag assigned to it, but does have that access in certain places. Note that the capability is intended for use by trusted users, and is only assigned to teachers and managers by default.",
  "repo": "moodle/moodle",
  "patch_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
  "patch_info": {
    "commit_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26",
    "files": [
      "lib/db/access.php",
      "version.php"
    ],
    "message": "MDL-64395 groups: Added XSS Risk to the manage groups capability",
    "before_after_code_files": [
      "lib/db/access.php||lib/db/access.php",
      "version.php||version.php"
    ]
  },
  "patch_diff": {
    "lib/db/access.php||lib/db/access.php": [
      "File: lib/db/access.php -> lib/db/access.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1123:     ),",
      "1125:     'moodle/course:managegroups' => array(",
      "1127:         'captype' => 'write',",
      "1128:         'contextlevel' => CONTEXT_COURSE,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1126:         'riskbitmask' => RISK_XSS,",
      "",
      "---------------"
    ],
    "version.php||version.php": [
      "File: version.php -> version.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "30: defined('MOODLE_INTERNAL') || die();",
      "",
      "[Removed Lines]",
      "32: $version  = 2018122000.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "[Added Lines]",
      "32: $version  = 2018122000.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b1f1bd2e542a617b8c8a8781e0344c25fc9a70d1",
      "candidate_info": {
        "commit_hash": "b1f1bd2e542a617b8c8a8781e0344c25fc9a70d1",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/b1f1bd2e542a617b8c8a8781e0344c25fc9a70d1",
        "files": [
          "admin/settings/users.php",
          "lib/db/upgrade.php",
          "version.php"
        ],
        "message": "MDL-61714 admin: Update digital age consent map according legislation",
        "before_after_code_files": [
          "admin/settings/users.php||admin/settings/users.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/settings/users.php||admin/settings/users.php": [
          "File: admin/settings/users.php -> admin/settings/users.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "228:     $setting->set_force_ltr(true);",
          "229:     $temp->add($setting);",
          "231:     $setting = new admin_setting_agedigitalconsentmap('agedigitalconsentmap',",
          "232:         new lang_string('ageofdigitalconsentmap', 'admin'),",
          "233:         new lang_string('ageofdigitalconsentmap_desc', 'admin'),",
          "252:         PARAM_RAW",
          "253:     );",
          "254:     $temp->add($setting);",
          "",
          "[Removed Lines]",
          "235:         implode(PHP_EOL, [",
          "236:             '*, 16',",
          "237:             'AT, 14',",
          "238:             'CZ, 13',",
          "239:             'DE, 14',",
          "240:             'DK, 13',",
          "241:             'ES, 13',",
          "242:             'FI, 15',",
          "243:             'GB, 13',",
          "244:             'HU, 14',",
          "245:             'IE, 13',",
          "246:             'LT, 16',",
          "247:             'LU, 16',",
          "248:             'NL, 16',",
          "249:             'PL, 13',",
          "250:             'SE, 13',",
          "251:         ]),",
          "",
          "[Added Lines]",
          "232:     $ageofdigitalconsentmap = implode(PHP_EOL, [",
          "233:         '*, 16',",
          "234:         'AT, 14',",
          "235:         'ES, 14',",
          "236:         'SI, 14',",
          "237:         'US, 13'",
          "238:     ]);",
          "242:         $ageofdigitalconsentmap,",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2216:         upgrade_main_savepoint(true, 2018040500.01);",
          "2217:     }",
          "2219:     return true;",
          "2220: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2219:     if ($oldversion < 2018050800.02) {",
          "2221:         $ageofdigitalconsentmap = implode(PHP_EOL, [",
          "2222:             '*, 16',",
          "2223:             'AT, 14',",
          "2224:             'ES, 14',",
          "2225:             'SI, 14',",
          "2226:             'US, 13'",
          "2227:         ]);",
          "2228:         set_config('agedigitalconsentmap', $ageofdigitalconsentmap);",
          "2231:         upgrade_main_savepoint(true, 2018050800.02);",
          "2232:     }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018050800.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018050800.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "310d6901f9260adb91ac9719b714a7ee1714bec2",
      "candidate_info": {
        "commit_hash": "310d6901f9260adb91ac9719b714a7ee1714bec2",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/310d6901f9260adb91ac9719b714a7ee1714bec2",
        "files": [
          "version.php"
        ],
        "message": "weekly release 3.8dev",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "38: $branch   = '38';                       // This version's branch.",
          "39: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2019082400.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.8dev (Build: 20190824)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2019083000.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.8dev (Build: 20190830)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "76d0192e0b10db777c8a82fc6c7236e57ce77027",
      "candidate_info": {
        "commit_hash": "76d0192e0b10db777c8a82fc6c7236e57ce77027",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/76d0192e0b10db777c8a82fc6c7236e57ce77027",
        "files": [
          "admin/settings/security.php",
          "admin/upgrade.txt",
          "lang/en/admin.php",
          "lib/classes/session/manager.php",
          "lib/db/upgrade.php",
          "report/security/lang/en/report_security.php",
          "report/security/locallib.php",
          "version.php"
        ],
        "message": "MDL-7339 admin: Replaced \"open to google\" references to be more generic\n\nAMOS BEGIN\n MOV [configopentogoogle,admin],[configopentowebcrawlers,admin]\n MOV [opentogoogle,admin],[opentowebcrawlers,admin]\n MOV [check_google_details,report_security],[check_crawlers_details,report_security]\n MOV [check_google_error,report_security],[check_crawlers_error,report_security]\n MOV [check_google_info,report_security],[check_crawlers_info,report_security]\n MOV [check_google_name,report_security],[check_crawlers_name,report_security]\n MOV [check_google_ok,report_security],[check_crawlers_ok,report_security]\nAMOS END",
        "before_after_code_files": [
          "admin/settings/security.php||admin/settings/security.php",
          "lang/en/admin.php||lang/en/admin.php",
          "lib/classes/session/manager.php||lib/classes/session/manager.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "report/security/lang/en/report_security.php||report/security/lang/en/report_security.php",
          "report/security/locallib.php||report/security/locallib.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/settings/security.php||admin/settings/security.php": [
          "File: admin/settings/security.php -> admin/settings/security.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:     $temp->add(new admin_setting_configcheckbox('forcelogin', new lang_string('forcelogin', 'admin'), new lang_string('configforcelogin', 'admin'), 0));",
          "18:     $temp->add(new admin_setting_configcheckbox('forceloginforprofiles', new lang_string('forceloginforprofiles', 'admin'), new lang_string('configforceloginforprofiles', 'admin'), 1));",
          "19:     $temp->add(new admin_setting_configcheckbox('forceloginforprofileimage', new lang_string('forceloginforprofileimage', 'admin'), new lang_string('forceloginforprofileimage_help', 'admin'), 0));",
          "21:     $temp->add(new admin_setting_configselect('allowindexing', new lang_string('allowindexing', 'admin'), new lang_string('allowindexing_desc', 'admin'),",
          "22:         0,",
          "23:         array(0 => new lang_string('allowindexingexceptlogin', 'admin'),",
          "",
          "[Removed Lines]",
          "20:     $temp->add(new admin_setting_configcheckbox('opentogoogle', new lang_string('opentogoogle', 'admin'), new lang_string('configopentogoogle', 'admin'), 0));",
          "",
          "[Added Lines]",
          "20:     $temp->add(new admin_setting_configcheckbox('opentowebcrawlers', new lang_string('opentowebcrawlers', 'admin'), new lang_string('configopentowebcrawlers', 'admin'), 0));",
          "",
          "---------------"
        ],
        "lang/en/admin.php||lang/en/admin.php": [
          "File: lang/en/admin.php -> lang/en/admin.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "298: $string['confignotifyloginfailures'] = 'Send login failure notification messages to these selected users. This requires an internal logstore (eg Standard Logstore) to be enabled.';",
          "299: $string['confignotifyloginthreshold'] = 'If notifications about failed logins are active, how many failed login attempts by one user or one IP address is it worth notifying about?';",
          "300: $string['confignotloggedinroleid'] = 'Users who are not logged in to the site will be treated as if they have this role granted to them at the site context.  Guest is almost always what you want here, but you might want to create roles that are less or more restrictive.  Things like creating posts still require the user to log in properly.';",
          "302: $string['configoverride'] = 'Defined in config.php';",
          "303: $string['configpasswordpolicy'] = 'If enabled, user passwords will be checked against the password policy as specified in the settings below. Enabling the password policy will not affect existing users until they decide to, or are required to, change their password.';",
          "304: $string['configpasswordresettime'] = 'This specifies the amount of time people have to validate a password reset request before it expires. Usually 30 minutes is a good value.';",
          "",
          "[Removed Lines]",
          "301: $string['configopentogoogle'] = 'If you enable this setting, then Google will be allowed to enter your site as a Guest.  In addition, people coming in to your site via a Google search will automatically be logged in as a Guest.  Note that this only provides transparent access to courses that already allow guest access.';",
          "",
          "[Added Lines]",
          "301: $string['configopentowebcrawlers'] = 'If you enable this setting, then search engines will be allowed to enter your site as a guest.  In addition, people coming in to your site via a search engine will automatically be logged in as a guest.  Note that this only provides transparent access to courses that already allow guest access.';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "860: $string['opcacherecommended'] = 'PHP opcode caching improves performance and lowers memory requirements, OPcache extension is recommended and fully supported.';",
          "861: $string['opensslrecommended'] = 'Installing the optional OpenSSL library is highly recommended -- it enables Moodle Networking functionality.';",
          "862: $string['opensslrequired'] = 'The OpenSSL PHP extension is now required by Moodle to provide stronger cryptographic services.';",
          "864: $string['optionalmaintenancemessage'] = 'Optional maintenance message';",
          "865: $string['order1'] = 'First';",
          "866: $string['order2'] = 'Second';",
          "",
          "[Removed Lines]",
          "863: $string['opentogoogle'] = 'Open to Google';",
          "",
          "[Added Lines]",
          "863: $string['opentowebcrawlers'] = 'Open to search engines';",
          "",
          "---------------"
        ],
        "lib/classes/session/manager.php||lib/classes/session/manager.php": [
          "File: lib/classes/session/manager.php -> lib/classes/session/manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "429:         $user = null;",
          "432:             if (\\core_useragent::is_web_crawler()) {",
          "433:                 $user = guest_user();",
          "434:             }",
          "",
          "[Removed Lines]",
          "431:         if (!empty($CFG->opentogoogle)) {",
          "",
          "[Added Lines]",
          "431:         if (!empty($CFG->opentowebcrawlers)) {",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "3381:     return true;",
          "3382: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3381:     if ($oldversion < 2019060600.02) {",
          "3383:         $opentogooglevalue = get_config('core', 'opentogoogle');",
          "3386:         if ($opentogooglevalue !== false) {",
          "3387:             set_config('opentowebcrawlers', $opentogooglevalue);",
          "3388:         }",
          "3391:         unset_config('opentogoogle');",
          "3394:         upgrade_main_savepoint(true, 2019060600.02);",
          "3395:     }",
          "",
          "---------------"
        ],
        "report/security/lang/en/report_security.php||report/security/lang/en/report_security.php": [
          "File: report/security/lang/en/report_security.php -> report/security/lang/en/report_security.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "61: $string['check_frontpagerole_name'] = 'Frontpage role';",
          "62: $string['check_frontpagerole_notset'] = 'Frontpage role is not set.';",
          "63: $string['check_frontpagerole_ok'] = 'Frontpage role definition is OK.';",
          "69: $string['check_guestrole_details'] = '<p>The guest role is used for guests, not logged in users and temporary guest course access. Please make sure no risky capabilities are allowed in this role.</p>",
          "70: <p>The only supported legacy type for guest role is <em>Guest</em>.</p>';",
          "71: $string['check_guestrole_error'] = 'The guest role \"{$a}\" is incorrectly defined!';",
          "",
          "[Removed Lines]",
          "64: $string['check_google_details'] = '<p>The Open to Google setting enables search engines to enter courses with guest access. There is no point in enabling this setting if guest login is not allowed.</p>';",
          "65: $string['check_google_error'] = 'Search engine access is allowed but guest access is disabled.';",
          "66: $string['check_google_info'] = 'Search engines may enter as guests.';",
          "67: $string['check_google_name'] = 'Open to Google';",
          "68: $string['check_google_ok'] = 'Search engine access is not enabled.';",
          "",
          "[Added Lines]",
          "64: $string['check_crawlers_details'] = '<p>The \"Open to search engines\" setting enables search engines to enter courses with guest access. There is no point in enabling this setting if guest login is not allowed.</p>';",
          "65: $string['check_crawlers_error'] = 'Search engine access is allowed but guest access is disabled.';",
          "66: $string['check_crawlers_info'] = 'Search engines may enter as guests.';",
          "67: $string['check_crawlers_name'] = 'Open to search engines';",
          "68: $string['check_crawlers_ok'] = 'Search engine access is not enabled.';",
          "",
          "---------------"
        ],
        "report/security/locallib.php||report/security/locallib.php": [
          "File: report/security/locallib.php -> report/security/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "47:         'report_security_check_embed',",
          "48:         'report_security_check_mediafilterswf',",
          "49:         'report_security_check_openprofiles',",
          "51:         'report_security_check_passwordpolicy',",
          "52:         'report_security_check_emailchangeconfirmation',",
          "53:         'report_security_check_cookiesecure',",
          "",
          "[Removed Lines]",
          "50:         'report_security_check_google',",
          "",
          "[Added Lines]",
          "50:         'report_security_check_crawlers',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "308: }",
          "317:     global $CFG;",
          "319:     $result = new stdClass();",
          "322:     $result->info    = null;",
          "323:     $result->details = null;",
          "324:     $result->status  = null;",
          "325:     $result->link    = \"<a href=\\\"$CFG->wwwroot/$CFG->admin/settings.php?section=sitepolicies\\\">\".get_string('sitepolicies', 'admin').'</a>';",
          "328:         $result->status = REPORT_SECURITY_OK;",
          "330:     } else if (!empty($CFG->guestloginbutton)) {",
          "331:         $result->status = REPORT_SECURITY_INFO;",
          "333:     } else {",
          "334:         $result->status = REPORT_SECURITY_SERIOUS;",
          "336:     }",
          "338:     if ($detailed) {",
          "340:     }",
          "342:     return $result;",
          "",
          "[Removed Lines]",
          "316: function report_security_check_google($detailed=false) {",
          "320:     $result->issue   = 'report_security_check_google';",
          "321:     $result->name    = get_string('check_google_name', 'report_security');",
          "327:     if (empty($CFG->opentogoogle)) {",
          "329:         $result->info   = get_string('check_google_ok', 'report_security');",
          "332:         $result->info   = get_string('check_google_info', 'report_security');",
          "335:         $result->info   = get_string('check_google_error', 'report_security');",
          "339:         $result->details = get_string('check_google_details', 'report_security');",
          "",
          "[Added Lines]",
          "316: function report_security_check_crawlers($detailed=false) {",
          "320:     $result->issue   = 'report_security_check_crawlers';",
          "321:     $result->name    = get_string('check_crawlers_name', 'report_security');",
          "327:     if (empty($CFG->opentowebcrawlers)) {",
          "329:         $result->info   = get_string('check_crawlers_ok', 'report_security');",
          "332:         $result->info   = get_string('check_crawlers_info', 'report_security');",
          "335:         $result->info   = get_string('check_crawlers_error', 'report_security');",
          "339:         $result->details = get_string('check_crawlers_details', 'report_security');",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2019060600.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2019060600.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4033c2a11b61c15705f4c1dbb1ed9002f1a19645",
      "candidate_info": {
        "commit_hash": "4033c2a11b61c15705f4c1dbb1ed9002f1a19645",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/4033c2a11b61c15705f4c1dbb1ed9002f1a19645",
        "files": [
          "admin/settings/users.php",
          "lib/db/upgrade.php",
          "version.php"
        ],
        "message": "Merge branch 'MDL-61714-master' of git://github.com/sarjona/moodle",
        "before_after_code_files": [
          "admin/settings/users.php||admin/settings/users.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/settings/users.php||admin/settings/users.php": [
          "File: admin/settings/users.php -> admin/settings/users.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "228:     $setting->set_force_ltr(true);",
          "229:     $temp->add($setting);",
          "231:     $setting = new admin_setting_agedigitalconsentmap('agedigitalconsentmap',",
          "232:         new lang_string('ageofdigitalconsentmap', 'admin'),",
          "233:         new lang_string('ageofdigitalconsentmap_desc', 'admin'),",
          "252:         PARAM_RAW",
          "253:     );",
          "254:     $temp->add($setting);",
          "",
          "[Removed Lines]",
          "235:         implode(PHP_EOL, [",
          "236:             '*, 16',",
          "237:             'AT, 14',",
          "238:             'CZ, 13',",
          "239:             'DE, 14',",
          "240:             'DK, 13',",
          "241:             'ES, 13',",
          "242:             'FI, 15',",
          "243:             'GB, 13',",
          "244:             'HU, 14',",
          "245:             'IE, 13',",
          "246:             'LT, 16',",
          "247:             'LU, 16',",
          "248:             'NL, 16',",
          "249:             'PL, 13',",
          "250:             'SE, 13',",
          "251:         ]),",
          "",
          "[Added Lines]",
          "232:     $ageofdigitalconsentmap = implode(PHP_EOL, [",
          "233:         '*, 16',",
          "234:         'AT, 14',",
          "235:         'ES, 14',",
          "236:         'SI, 14',",
          "237:         'US, 13'",
          "238:     ]);",
          "242:         $ageofdigitalconsentmap,",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2216:         upgrade_main_savepoint(true, 2018040500.01);",
          "2217:     }",
          "2219:     return true;",
          "2220: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2219:     if ($oldversion < 2018050900.01) {",
          "2221:         $ageofdigitalconsentmap = implode(PHP_EOL, [",
          "2222:             '*, 16',",
          "2223:             'AT, 14',",
          "2224:             'ES, 14',",
          "2225:             'SI, 14',",
          "2226:             'US, 13'",
          "2227:         ]);",
          "2228:         set_config('agedigitalconsentmap', $ageofdigitalconsentmap);",
          "2231:         upgrade_main_savepoint(true, 2018050900.01);",
          "2232:     }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018050900.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018050900.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2cea0bd6c66300813457a2f18dc9a4a075efbc93",
      "candidate_info": {
        "commit_hash": "2cea0bd6c66300813457a2f18dc9a4a075efbc93",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/2cea0bd6c66300813457a2f18dc9a4a075efbc93",
        "files": [
          "version.php"
        ],
        "message": "weekly back-to-dev release 3.7dev",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018120300.00;              // 20181203      = branching date YYYYMMDD - do not modify!",
          "36: $release  = '3.6 (Build: 20181203)'; // Human-friendly version name",
          "38: $branch   = '36';                       // This version's branch.",
          "39: $maturity = MATURITY_STABLE;             // This version's maturity level.",
          "",
          "[Added Lines]",
          "32: $version  = 2018120300.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.7dev (Build: 20181203)'; // Human-friendly version name",
          "38: $branch   = '37';                       // This version's branch.",
          "39: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "---------------"
        ]
      }
    }
  ]
}