{
  "cve_id": "CVE-2019-3808",
  "cve_desc": "A flaw was found in Moodle versions 3.6 to 3.6.1, 3.5 to 3.5.3, 3.4 to 3.4.6, 3.1 to 3.1.15 and earlier unsupported versions. The 'manage groups' capability did not have the 'XSS risk' flag assigned to it, but does have that access in certain places. Note that the capability is intended for use by trusted users, and is only assigned to teachers and managers by default.",
  "repo": "moodle/moodle",
  "patch_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
  "patch_info": {
    "commit_hash": "6360f87cdca744a6a71c315853f6d811a3e54e26",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/6360f87cdca744a6a71c315853f6d811a3e54e26",
    "files": [
      "lib/db/access.php",
      "version.php"
    ],
    "message": "MDL-64395 groups: Added XSS Risk to the manage groups capability",
    "before_after_code_files": [
      "lib/db/access.php||lib/db/access.php",
      "version.php||version.php"
    ]
  },
  "patch_diff": {
    "lib/db/access.php||lib/db/access.php": [
      "File: lib/db/access.php -> lib/db/access.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1123:     ),",
      "1125:     'moodle/course:managegroups' => array(",
      "1127:         'captype' => 'write',",
      "1128:         'contextlevel' => CONTEXT_COURSE,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1126:         'riskbitmask' => RISK_XSS,",
      "",
      "---------------"
    ],
    "version.php||version.php": [
      "File: version.php -> version.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "30: defined('MOODLE_INTERNAL') || die();",
      "",
      "[Removed Lines]",
      "32: $version  = 2018122000.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "[Added Lines]",
      "32: $version  = 2018122000.02;              // YYYYMMDD      = weekly release date of this DEV branch.",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "77ac4d8c319d066006f8c17fdb11e0b10e6adef2",
      "candidate_info": {
        "commit_hash": "77ac4d8c319d066006f8c17fdb11e0b10e6adef2",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/77ac4d8c319d066006f8c17fdb11e0b10e6adef2",
        "files": [
          "admin/settings/courses.php",
          "lang/en/moodle.php",
          "lib/db/upgrade.php",
          "lib/outputrenderers.php",
          "lib/templates/course_header_image.mustache",
          "theme/boost/scss/moodle/course.scss",
          "theme/boost/style/moodle.css",
          "theme/bootstrapbase/less/moodle/course.less",
          "theme/bootstrapbase/style/moodle.css",
          "version.php"
        ],
        "message": "Merge branch 'MDL-63445-master' of git://github.com/bmbrands/moodle",
        "before_after_code_files": [
          "admin/settings/courses.php||admin/settings/courses.php",
          "lang/en/moodle.php||lang/en/moodle.php",
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "lib/outputrenderers.php||lib/outputrenderers.php",
          "lib/templates/course_header_image.mustache||lib/templates/course_header_image.mustache",
          "theme/boost/scss/moodle/course.scss||theme/boost/scss/moodle/course.scss",
          "theme/boost/style/moodle.css||theme/boost/style/moodle.css",
          "theme/bootstrapbase/less/moodle/course.less||theme/bootstrapbase/less/moodle/course.less",
          "theme/bootstrapbase/style/moodle.css||theme/bootstrapbase/style/moodle.css",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/settings/courses.php||admin/settings/courses.php": [
          "File: admin/settings/courses.php -> admin/settings/courses.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "121:     $temp->add(new admin_setting_configselect('moodlecourse/showreports', new lang_string('showreports'), '', 0,",
          "122:         array(0 => new lang_string('no'), 1 => new lang_string('yes'))));",
          "125:     $temp->add(new admin_setting_heading('filesanduploadshdr', new lang_string('filesanduploads'), ''));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "124:     $temp->add(new admin_setting_configcheckbox('moodlecourse/showcourseimages', get_string('showcourseimages'),",
          "125:         get_string('showcourseimages_desc'), 1));",
          "",
          "---------------"
        ],
        "lang/en/moodle.php||lang/en/moodle.php": [
          "File: lang/en/moodle.php -> lang/en/moodle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "327: $string['courseformats'] = 'Course formats';",
          "328: $string['courseformatoptions'] = 'Formatting options for {$a}';",
          "329: $string['courseformatudpate'] = 'Update format';",
          "330: $string['courseprofiles'] = 'Course profiles';",
          "331: $string['coursepreferences'] = 'Course preferences';",
          "332: $string['coursegrades'] = 'Course grades';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "330: $string['courseheaderimage'] = 'Course header image';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1822: $string['showblockcourse'] = 'Show list of courses containing block';",
          "1823: $string['showcategory'] = 'Show {$a}';",
          "1824: $string['showchartdata'] = 'Show chart data';",
          "1825: $string['showcomments'] = 'Show/hide comments';",
          "1826: $string['showcommentsnonjs'] = 'Show comments';",
          "1827: $string['showdescription'] = 'Display description on course page';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1826: $string['showcourseimages'] = 'Show course images';",
          "1827: $string['showcourseimages_desc'] = 'Show the course image or image placeholder in the course header.';",
          "",
          "---------------"
        ],
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2666:         upgrade_main_savepoint(true, 2018102900.00);",
          "2667:     }",
          "2669:     return true;",
          "2670: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2669:     if ($oldversion < 2018102900.01) {",
          "2671:         set_config('showcourseimages', 1, 'moodlecourse');",
          "2672:         upgrade_main_savepoint(true, 2018102900.01);",
          "2673:     }",
          "",
          "---------------"
        ],
        "lib/outputrenderers.php||lib/outputrenderers.php": [
          "File: lib/outputrenderers.php -> lib/outputrenderers.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "4153:     }",
          "4155:     public function context_header($headerinfo = null, $headinglevel = 1) {",
          "4157:         require_once($CFG->dirroot . '/user/lib.php');",
          "4158:         $context = $this->page->context;",
          "4159:         $heading = null;",
          "",
          "[Removed Lines]",
          "4156:         global $DB, $USER, $CFG;",
          "",
          "[Added Lines]",
          "4156:         global $DB, $USER, $CFG, $COURSE;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4164:         if (isset($headerinfo['heading'])) {",
          "4165:             $heading = $headerinfo['heading'];",
          "4166:         }",
          "4168:         if (isset($headerinfo['user']) || $context->contextlevel == CONTEXT_USER) {",
          "4169:             if (isset($headerinfo['user'])) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4169:         if ($context->contextlevel == CONTEXT_COURSE && get_config('moodlecourse', 'showcourseimages')) {",
          "4170:             $exporter = new core_course\\external\\course_summary_exporter($COURSE, ['context' => $context]);",
          "4171:             $courseinfo = $exporter->export($this);",
          "4172:             $imagedata = $this->render_from_template('core/course_header_image', $courseinfo);",
          "4173:         }",
          "",
          "---------------"
        ],
        "lib/templates/course_header_image.mustache||lib/templates/course_header_image.mustache": [
          "File: lib/templates/course_header_image.mustache -> lib/templates/course_header_image.mustache",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: {{!",
          "2:     This file is part of Moodle - http://moodle.org/",
          "4:     Moodle is free software: you can redistribute it and/or modify",
          "5:     it under the terms of the GNU General Public License as published by",
          "6:     the Free Software Foundation, either version 3 of the License, or",
          "7:     (at your option) any later version.",
          "9:     Moodle is distributed in the hope that it will be useful,",
          "10:     but WITHOUT ANY WARRANTY; without even the implied warranty of",
          "11:     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the",
          "12:     GNU General Public License for more details.",
          "14:     You should have received a copy of the GNU General Public License",
          "15:     along with Moodle.  If not, see <http://www.gnu.org/licenses/>.",
          "16: }}",
          "17: {{!",
          "18:     @template core/course_header_image",
          "20:     Example context (json):",
          "21:     {",
          "22:         \"courseimage\": \"http://domain.name/pluginfile.php/123/course/overviewfiles/kitten.jpg\"",
          "23:     }",
          "24: }}",
          "25: <div class=\"course-header-image-wrapper\">",
          "26:     <div class=\"course-header-image rounded w-100 h-100\" style='background-image: url(\"{{{courseimage}}}\");'>",
          "27:         <div class=\"sr-only\">{{#str}}courseheaderimage, core{{/str}}</div>",
          "28:     </div>",
          "29: </div>",
          "",
          "---------------"
        ],
        "theme/boost/scss/moodle/course.scss||theme/boost/scss/moodle/course.scss": [
          "File: theme/boost/scss/moodle/course.scss -> theme/boost/scss/moodle/course.scss",
          "--- Hunk 1 ---",
          "[Context before]",
          "1139:     opacity: 0.5;",
          "1140: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1142: .course-header-image-wrapper {",
          "1143:     width: 100px;",
          "1144:     height: 100px;",
          "1145:     .course-header-image {",
          "1146:         background-size: cover;",
          "1147:         background-position: center;",
          "1148:     }",
          "1149: }",
          "",
          "---------------"
        ],
        "theme/boost/style/moodle.css||theme/boost/style/moodle.css": [
          "File: theme/boost/style/moodle.css -> theme/boost/style/moodle.css",
          "--- Hunk 1 ---",
          "[Context before]",
          "12342: .course-being-dragged {",
          "12343:   opacity: 0.5; }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12345: .course-header-image-wrapper {",
          "12346:   width: 100px;",
          "12347:   height: 100px; }",
          "12348:   .course-header-image-wrapper .course-header-image {",
          "12349:     background-size: cover;",
          "12350:     background-position: center; }",
          "",
          "---------------"
        ],
        "theme/bootstrapbase/less/moodle/course.less||theme/bootstrapbase/less/moodle/course.less": [
          "File: theme/bootstrapbase/less/moodle/course.less -> theme/bootstrapbase/less/moodle/course.less",
          "--- Hunk 1 ---",
          "[Context before]",
          "1124:     .opacity(50);",
          "1125: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1127: .course-header-image-wrapper {",
          "1128:     width: 100px;",
          "1129:     height: 100px;",
          "1130:     .course-header-image {",
          "1131:         width: 100%;",
          "1132:         height: 100%;",
          "1133:         background-size: cover;",
          "1134:         background-position: center;",
          "1135:     }",
          "1136: }",
          "",
          "---------------"
        ],
        "theme/bootstrapbase/style/moodle.css||theme/bootstrapbase/style/moodle.css": [
          "File: theme/bootstrapbase/style/moodle.css -> theme/bootstrapbase/style/moodle.css",
          "--- Hunk 1 ---",
          "[Context before]",
          "7004:   opacity: 0.5;",
          "7005:   filter: alpha(opacity=50);",
          "7006: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7007: .course-header-image-wrapper {",
          "7008:   width: 100px;",
          "7009:   height: 100px;",
          "7010: }",
          "7011: .course-header-image-wrapper .course-header-image {",
          "7012:   width: 100%;",
          "7013:   height: 100%;",
          "7014:   background-size: cover;",
          "7015:   background-position: center;",
          "7016: }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018102900.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018102900.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "50e48a8f2dd5774600b019e394abb041658b356d",
      "candidate_info": {
        "commit_hash": "50e48a8f2dd5774600b019e394abb041658b356d",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/50e48a8f2dd5774600b019e394abb041658b356d",
        "files": [
          "version.php"
        ],
        "message": "weekly release 3.6dev",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "38: $branch   = '36';                       // This version's branch.",
          "39: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2018053100.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.6dev (Build: 20180531)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2018060700.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "36: $release  = '3.6dev (Build: 20180607)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a63f98245cdbc3b10fb395cb7ebb1ea0b35a7e67",
      "candidate_info": {
        "commit_hash": "a63f98245cdbc3b10fb395cb7ebb1ea0b35a7e67",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/a63f98245cdbc3b10fb395cb7ebb1ea0b35a7e67",
        "files": [
          "lib/db/install.xml",
          "lib/db/upgrade.php",
          "version.php"
        ],
        "message": "MDL-36941 core: added new messaging and notification tables",
        "before_after_code_files": [
          "lib/db/upgrade.php||lib/db/upgrade.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/db/upgrade.php||lib/db/upgrade.php": [
          "File: lib/db/upgrade.php -> lib/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2020:         upgrade_main_savepoint(true, 2018022800.03);",
          "2021:     }",
          "2023:     return true;",
          "2024: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2023:     if ($oldversion < 2018032200.01) {",
          "2025:         $table = new xmldb_table('messages');",
          "2028:         $table->add_field('id', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, XMLDB_SEQUENCE, null);",
          "2029:         $table->add_field('useridfrom', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2030:         $table->add_field('conversationid', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2031:         $table->add_field('subject', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2032:         $table->add_field('fullmessage', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2033:         $table->add_field('fullmessageformat', XMLDB_TYPE_INTEGER, '1', null, XMLDB_NOTNULL, null, 0);",
          "2034:         $table->add_field('fullmessagehtml', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2035:         $table->add_field('smallmessage', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2036:         $table->add_field('timecreated', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2039:         $table->add_key('primary', XMLDB_KEY_PRIMARY, array('id'));",
          "2040:         $table->add_key('useridfrom', XMLDB_KEY_FOREIGN, array('useridfrom'), 'user', array('id'));",
          "2041:         $table->add_key('conversationid', XMLDB_KEY_FOREIGN, array('conversationid'), 'message_conversations', array('id'));",
          "2044:         if (!$dbman->table_exists($table)) {",
          "2045:             $dbman->create_table($table);",
          "2046:         }",
          "2049:         $table = new xmldb_table('message_conversations');",
          "2052:         $table->add_field('id', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, XMLDB_SEQUENCE, null);",
          "2053:         $table->add_field('timecreated', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2056:         $table->add_key('primary', XMLDB_KEY_PRIMARY, array('id'));",
          "2059:         if (!$dbman->table_exists($table)) {",
          "2060:             $dbman->create_table($table);",
          "2061:         }",
          "2064:         $table = new xmldb_table('message_conversation_members');",
          "2067:         $table->add_field('id', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, XMLDB_SEQUENCE, null);",
          "2068:         $table->add_field('conversationid', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2069:         $table->add_field('userid', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2070:         $table->add_field('timecreated', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2073:         $table->add_key('primary', XMLDB_KEY_PRIMARY, array('id'));",
          "2074:         $table->add_key('conversationid', XMLDB_KEY_FOREIGN, array('conversationid'), 'message_conversations', array('id'));",
          "2075:         $table->add_key('userid', XMLDB_KEY_FOREIGN, array('userid'), 'user', array('id'));",
          "2078:         if (!$dbman->table_exists($table)) {",
          "2079:             $dbman->create_table($table);",
          "2080:         }",
          "2083:         $table = new xmldb_table('message_user_actions');",
          "2086:         $table->add_field('id', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, XMLDB_SEQUENCE, null);",
          "2087:         $table->add_field('userid', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2088:         $table->add_field('messageid', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2089:         $table->add_field('action', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2090:         $table->add_field('timecreated', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2093:         $table->add_key('primary', XMLDB_KEY_PRIMARY, array('id'));",
          "2094:         $table->add_key('userid', XMLDB_KEY_FOREIGN, array('userid'), 'user', array('id'));",
          "2095:         $table->add_key('messageid', XMLDB_KEY_FOREIGN, array('messageid'), 'messages', array('id'));",
          "2098:         if (!$dbman->table_exists($table)) {",
          "2099:             $dbman->create_table($table);",
          "2100:         }",
          "2103:         $table = new xmldb_table('notifications');",
          "2106:         $table->add_field('id', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, XMLDB_SEQUENCE, null);",
          "2107:         $table->add_field('useridfrom', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2108:         $table->add_field('useridto', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2109:         $table->add_field('subject', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2110:         $table->add_field('fullmessage', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2111:         $table->add_field('fullmessageformat', XMLDB_TYPE_INTEGER, '1', null, XMLDB_NOTNULL, null, 0);",
          "2112:         $table->add_field('fullmessagehtml', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2113:         $table->add_field('smallmessage', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2114:         $table->add_field('component', XMLDB_TYPE_CHAR, '100', null, null, null, null);",
          "2115:         $table->add_field('eventtype', XMLDB_TYPE_CHAR, '100', null, null, null, null);",
          "2116:         $table->add_field('contexturl', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2117:         $table->add_field('contexturlname', XMLDB_TYPE_TEXT, null, null, null, null, null);",
          "2118:         $table->add_field('timeread', XMLDB_TYPE_INTEGER, '10', null, false, null, null);",
          "2119:         $table->add_field('timecreated', XMLDB_TYPE_INTEGER, '10', null, XMLDB_NOTNULL, null, null);",
          "2122:         $table->add_key('primary', XMLDB_KEY_PRIMARY, array('id'));",
          "2123:         $table->add_key('useridto', XMLDB_KEY_FOREIGN, array('useridto'), 'user', array('id'));",
          "2126:         if (!$dbman->table_exists($table)) {",
          "2127:             $dbman->create_table($table);",
          "2128:         }",
          "2131:         upgrade_main_savepoint(true, 2018032200.01);",
          "2132:     }",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2018032200.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2018032200.01;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "31f8f7567240d8fafc2fa3b2dd6f0e9f622d515c",
      "candidate_info": {
        "commit_hash": "31f8f7567240d8fafc2fa3b2dd6f0e9f622d515c",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/31f8f7567240d8fafc2fa3b2dd6f0e9f622d515c",
        "files": [
          "version.php"
        ],
        "message": "weekly release 3.7.2+",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "38: $branch   = '37';                       // This version's branch.",
          "39: $maturity = MATURITY_STABLE;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2019052002.04;              // 20190520      = branching date YYYYMMDD - do not modify!",
          "36: $release  = '3.7.2+ (Build: 20190920)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2019052002.05;              // 20190520      = branching date YYYYMMDD - do not modify!",
          "36: $release  = '3.7.2+ (Build: 20190927)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7850f76a93bb673a30bdfffe23a3077c83d9749c",
      "candidate_info": {
        "commit_hash": "7850f76a93bb673a30bdfffe23a3077c83d9749c",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/7850f76a93bb673a30bdfffe23a3077c83d9749c",
        "files": [
          "version.php"
        ],
        "message": "weekly release 3.9dev",
        "before_after_code_files": [
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.php||version.php"
          ],
          "candidate": [
            "version.php||version.php"
          ]
        }
      },
      "candidate_diff": {
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "36: $branch   = '39';                       // This version's branch.",
          "37: $maturity = MATURITY_ALPHA;             // This version's maturity level.",
          "",
          "[Removed Lines]",
          "32: $version  = 2019121800.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "35: $release  = '3.9dev (Build: 20191212)'; // Human-friendly version name",
          "",
          "[Added Lines]",
          "32: $version  = 2019122000.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "35: $release  = '3.9dev (Build: 20191220)'; // Human-friendly version name",
          "",
          "---------------"
        ]
      }
    }
  ]
}