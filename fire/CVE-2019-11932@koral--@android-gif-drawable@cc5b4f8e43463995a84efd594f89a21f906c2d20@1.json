{
  "cve_id": "CVE-2019-11932",
  "cve_desc": "A double free vulnerability in the DDGifSlurp function in decoding.c in the android-gif-drawable library before version 1.2.18, as used in WhatsApp for Android before version 2.19.244 and many other Android applications, allows remote attackers to execute arbitrary code or cause a denial of service when the library is used to parse a specially crafted GIF image.",
  "repo": "koral--/android-gif-drawable",
  "patch_hash": "cc5b4f8e43463995a84efd594f89a21f906c2d20",
  "patch_info": {
    "commit_hash": "cc5b4f8e43463995a84efd594f89a21f906c2d20",
    "repo": "koral--/android-gif-drawable",
    "commit_url": "https://github.com/koral--/android-gif-drawable/commit/cc5b4f8e43463995a84efd594f89a21f906c2d20",
    "files": [
      "android-gif-drawable/src/main/c/decoding.c"
    ],
    "message": "Do not realloc array if new raster size is 0.\n\nif realloc() is called with 0 size it may return NULL and this will be incorrectly handled\nas not enough memory and (also) rasterBits will be freed by realloc but we will not update\nit.",
    "before_after_code_files": [
      "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
    ]
  },
  "patch_diff": {
    "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c": [
      "File: android-gif-drawable/src/main/c/decoding.c -> android-gif-drawable/src/main/c/decoding.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "56:     }",
      "58:     if (decode) {",
      "61:      const uint_fast32_t newRasterSize = gifFilePtr->Image.Width * gifFilePtr->Image.Height;",
      "62:      if (newRasterSize > info->rasterSize || widthOverflow > 0 || heightOverflow > 0) {",
      "63:       void *tmpRasterBits = reallocarray(info->rasterBits, newRasterSize, sizeof(GifPixelType));",
      "64:       if (tmpRasterBits == NULL) {",
      "",
      "[Removed Lines]",
      "59:      int_fast32_t widthOverflow = gifFilePtr->Image.Width - info->originalWidth;",
      "60:      int_fast32_t heightOverflow = gifFilePtr->Image.Height - info->originalHeight;",
      "",
      "[Added Lines]",
      "60:      if (newRasterSize == 0) {",
      "61:       free(info->rasterBits);",
      "62:       info->rasterBits = NULL;",
      "63:       info->rasterSize = newRasterSize;",
      "64:       return;",
      "65:      }",
      "66:      const int_fast32_t widthOverflow = gifFilePtr->Image.Width - info->originalWidth;",
      "67:      const int_fast32_t heightOverflow = gifFilePtr->Image.Height - info->originalHeight;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7a505fc5ea3d11215ec36d2b40609e85a735f4a5",
      "candidate_info": {
        "commit_hash": "7a505fc5ea3d11215ec36d2b40609e85a735f4a5",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/7a505fc5ea3d11215ec36d2b40609e85a735f4a5",
        "files": [
          "CHANGELOG.md",
          "android-gif-drawable/build.gradle",
          "build.gradle",
          "gradle/wrapper/gradle-wrapper.properties"
        ],
        "message": "Update Gradle wrapper to 5.6.2 Set explicit NDK version in build.gradle",
        "before_after_code_files": [
          "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle",
          "build.gradle||build.gradle",
          "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/689"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle": [
          "File: android-gif-drawable/build.gradle -> android-gif-drawable/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: group = GROUP",
          "8: android {",
          "9:     compileSdkVersion versions.compileSdk",
          "11:     compileOptions {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9:     ndkVersion '20.0.5594570'",
          "",
          "---------------"
        ],
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:                 androidxAppcompat  : '1.0.2',",
          "8:                 androidxAnnotations: '1.0.0',",
          "9:                 androidxTest       : '1.2.0',",
          "11:                 leakCanary         : '2.0-beta-2',",
          "13:                 intellijAnnotations: '13.0',",
          "14:                 material           : '1.0.0',",
          "15:                 androidXextJunit   : '1.1.0',",
          "",
          "[Removed Lines]",
          "10:                 coroutines         : '1.2.2',",
          "12:                 kotlin             : '1.3.41',",
          "",
          "[Added Lines]",
          "10:                 coroutines         : '1.3.1',",
          "12:                 kotlin             : '1.3.50',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:                 assertj1           : '1.7.1',",
          "23:                 concurrentunit     : '0.4.4',",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "26:                 relinker           : '1.3.1'",
          "27:         ]",
          "28:     }",
          "",
          "[Removed Lines]",
          "25:                 mockwebserver      : '4.1.0',",
          "",
          "[Added Lines]",
          "25:                 mockwebserver      : '4.1.1',",
          "",
          "---------------"
        ],
        "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties": [
          "File: gradle/wrapper/gradle-wrapper.properties -> gradle/wrapper/gradle-wrapper.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: distributionBase=GRADLE_USER_HOME",
          "2: distributionPath=wrapper/dists",
          "4: zipStoreBase=GRADLE_USER_HOME",
          "5: zipStorePath=wrapper/dists",
          "",
          "[Removed Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.6.1-bin.zip",
          "",
          "[Added Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.6.2-bin.zip",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dea87a3819b49b7bd4293b2e6a905c031be0e06e",
      "candidate_info": {
        "commit_hash": "dea87a3819b49b7bd4293b2e6a905c031be0e06e",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/dea87a3819b49b7bd4293b2e6a905c031be0e06e",
        "files": [
          "build.gradle",
          "gradle/wrapper/gradle-wrapper.properties"
        ],
        "message": "Dependency versions bump",
        "before_after_code_files": [
          "build.gradle||build.gradle",
          "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/689"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "9:                 androidxTest       : '1.1.0',",
          "10:                 coroutines         : '1.1.1',",
          "11:                 leakCanary         : '1.6.3',",
          "13:                 intellijAnnotations: '13.0',",
          "14:                 material           : '1.0.0',",
          "15:                 androidXextJunit   : '1.0.0',",
          "16:                 jacocoAndroid      : '0.1.4',",
          "18:                 junit              : '4.12',",
          "20:                 robolectric        : '4.2.1',",
          "21:                 assertj3           : '3.12.1',",
          "22:                 assertj1           : '1.7.1',",
          "23:                 concurrentunit     : '0.4.4',",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "26:         ]",
          "27:     }",
          "28:     repositories {",
          "",
          "[Removed Lines]",
          "12:                 kotlin             : '1.3.21',",
          "17:                 androidGradlePlugin: '3.3.2',",
          "19:                 mockito            : '2.25.1',",
          "25:                 mockwebserver      : '3.12.2',",
          "",
          "[Added Lines]",
          "12:                 kotlin             : '1.3.31',",
          "17:                 androidGradlePlugin: '3.4.0',",
          "19:                 mockito            : '2.27.0',",
          "25:                 mockwebserver      : '3.14.1',",
          "",
          "---------------"
        ],
        "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties": [
          "File: gradle/wrapper/gradle-wrapper.properties -> gradle/wrapper/gradle-wrapper.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: distributionBase=GRADLE_USER_HOME",
          "2: distributionPath=wrapper/dists",
          "4: zipStoreBase=GRADLE_USER_HOME",
          "5: zipStorePath=wrapper/dists",
          "",
          "[Removed Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.3-bin.zip",
          "",
          "[Added Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.4.1-bin.zip",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0f420abb49bfe0bd2fe479fc941237a04aa28323",
      "candidate_info": {
        "commit_hash": "0f420abb49bfe0bd2fe479fc941237a04aa28323",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/0f420abb49bfe0bd2fe479fc941237a04aa28323",
        "files": [
          "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt"
        ],
        "message": "Use kotlin Android extensions in MainActivity",
        "before_after_code_files": [
          "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt||sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/689"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt||sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: import android.os.Bundle",
          "4: import androidx.fragment.app.FragmentActivity",
          "",
          "[Removed Lines]",
          "5: import androidx.viewpager.widget.ViewPager",
          "",
          "[Added Lines]",
          "5: import kotlinx.android.synthetic.main.activity_main.*",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14:  override fun onCreate(savedInstanceState: Bundle?) {",
          "15:   super.onCreate(savedInstanceState)",
          "16:   setContentView(R.layout.activity_main)",
          "18:  }",
          "19: }",
          "",
          "[Removed Lines]",
          "17:   findViewById<ViewPager>(R.id.main_pager).adapter = MainPagerAdapter(this)",
          "",
          "[Added Lines]",
          "17:         mainViewPager.adapter = MainPagerAdapter(this)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "654b6f125b209556c6d3d47c101399cd23a022da",
      "candidate_info": {
        "commit_hash": "654b6f125b209556c6d3d47c101399cd23a022da",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/654b6f125b209556c6d3d47c101399cd23a022da",
        "files": [
          "CHANGELOG.md",
          "android-gif-drawable/build.gradle",
          "build.gradle",
          "gradle/wrapper/gradle-wrapper.properties",
          "gradlew",
          "gradlew.bat",
          "sample/build.gradle",
          "sample/src/main/AndroidManifest.xml",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt"
        ],
        "message": "Dependency versions bump",
        "before_after_code_files": [
          "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle",
          "build.gradle||build.gradle",
          "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties",
          "gradlew.bat||gradlew.bat",
          "sample/build.gradle||sample/build.gradle",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt||sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt",
          "sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/689"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle": [
          "File: android-gif-drawable/build.gradle -> android-gif-drawable/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:     }",
          "20:     defaultConfig {",
          "22:         minSdkVersion versions.minSdk",
          "23:         targetSdkVersion versions.targetSdk",
          "24:         consumerProguardFiles 'consumer-proguard-rules.pro'",
          "",
          "[Removed Lines]",
          "21:         versionName project.version",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:                 androidxAppcompat  : '1.0.2',",
          "8:                 androidxAnnotations: '1.0.0',",
          "9:                 androidxTest       : '1.2.0',",
          "13:                 intellijAnnotations: '13.0',",
          "14:                 material           : '1.0.0',",
          "15:                 androidXextJunit   : '1.1.0',",
          "16:                 jacocoAndroid      : '0.1.4',",
          "18:                 junit              : '4.12',",
          "20:                 robolectric        : '4.3',",
          "22:                 assertj1           : '1.7.1',",
          "23:                 concurrentunit     : '0.4.4',",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "",
          "[Removed Lines]",
          "10:                 coroutines         : '1.2.1',",
          "11:                 leakCanary         : '1.6.3',",
          "12:                 kotlin             : '1.3.31',",
          "17:                 androidGradlePlugin: '3.4.1',",
          "19:                 mockito            : '2.28.2',",
          "21:                 assertj3           : '3.12.2',",
          "",
          "[Added Lines]",
          "10:                 coroutines         : '1.2.2',",
          "11:                 leakCanary         : '2.0-beta-2',",
          "12:                 kotlin             : '1.3.41',",
          "17:                 androidGradlePlugin: '3.4.2',",
          "19:                 mockito            : '3.0.0',",
          "21:                 assertj3           : '3.13.2',",
          "",
          "---------------"
        ],
        "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties": [
          "File: gradle/wrapper/gradle-wrapper.properties -> gradle/wrapper/gradle-wrapper.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: distributionBase=GRADLE_USER_HOME",
          "2: distributionPath=wrapper/dists",
          "4: zipStoreBase=GRADLE_USER_HOME",
          "5: zipStorePath=wrapper/dists",
          "",
          "[Removed Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.4.1-bin.zip",
          "",
          "[Added Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-5.5.1-bin.zip",
          "",
          "---------------"
        ],
        "gradlew.bat||gradlew.bat": [
          "File: gradlew.bat -> gradlew.bat",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: @rem you may not use this file except in compliance with the License.",
          "6: @rem You may obtain a copy of the License at",
          "7: @rem",
          "9: @rem",
          "10: @rem Unless required by applicable law or agreed to in writing, software",
          "11: @rem distributed under the License is distributed on an \"AS IS\" BASIS,",
          "",
          "[Removed Lines]",
          "8: @rem      http://www.apache.org/licenses/LICENSE-2.0",
          "",
          "[Added Lines]",
          "8: @rem      https://www.apache.org/licenses/LICENSE-2.0",
          "",
          "---------------"
        ],
        "sample/build.gradle||sample/build.gradle": [
          "File: sample/build.gradle -> sample/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "40: dependencies {",
          "41:     compileOnly \"org.jetbrains:annotations:$versions.intellijAnnotations\"",
          "42:     debugImplementation \"com.squareup.leakcanary:leakcanary-android:$versions.leakCanary\"",
          "44:     implementation \"com.google.android.material:material:$versions.material\"",
          "45:     implementation \"androidx.appcompat:appcompat:$versions.androidxAppcompat\"",
          "46:     implementation \"org.jetbrains.kotlin:kotlin-stdlib-jdk7:$versions.kotlin\"",
          "",
          "[Removed Lines]",
          "43:     releaseImplementation \"com.squareup.leakcanary:leakcanary-android-no-op:$versions.leakCanary\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/AboutFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "14:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? =",
          "15:    inflater.inflate(R.layout.about, container, false)",
          "16: }",
          "",
          "[Removed Lines]",
          "13: class AboutFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "14: class AboutFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/AnimatedSelectorFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: import android.view.LayoutInflater",
          "9: import android.view.View",
          "10: import android.view.ViewGroup",
          "11: import kotlinx.android.synthetic.main.animated_selector.view.*",
          "12: import pl.droidsonroids.gif.GifDrawable",
          "16:  @Suppress(\"DEPRECATION\")",
          "17:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "",
          "[Removed Lines]",
          "14: class AnimatedSelectorFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "11: import androidx.fragment.app.Fragment",
          "15: class AnimatedSelectorFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/AnimationControlFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "7: import com.google.android.material.snackbar.Snackbar",
          "8: import kotlinx.android.synthetic.main.animation_control.*",
          "9: import pl.droidsonroids.gif.AnimationListener",
          "10: import pl.droidsonroids.gif.GifDrawable",
          "14:  private lateinit var gifDrawable: GifDrawable",
          "",
          "[Removed Lines]",
          "12: class AnimationControlFragment : BaseFragment(), AnimationListener {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "13: class AnimationControlFragment : Fragment(), AnimationListener {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/BaseFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/GifDecoderFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: import android.view.LayoutInflater",
          "6: import android.view.View",
          "7: import android.view.ViewGroup",
          "8: import kotlinx.android.synthetic.main.decoder.*",
          "9: import kotlinx.coroutines.*",
          "10: import pl.droidsonroids.gif.GifDecoder",
          "11: import pl.droidsonroids.gif.InputSource",
          "12: import kotlin.coroutines.CoroutineContext",
          "15:     private val job = Job()",
          "16:     override val coroutineContext: CoroutineContext",
          "17:         get() = Dispatchers.Main + job",
          "",
          "[Removed Lines]",
          "14: class GifDecoderFragment : BaseFragment(), CoroutineScope {",
          "",
          "[Added Lines]",
          "8: import androidx.fragment.app.Fragment",
          "15: class GifDecoderFragment : Fragment(), CoroutineScope {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/GifTexImage2DFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: import android.view.LayoutInflater",
          "6: import android.view.View",
          "7: import android.view.ViewGroup",
          "8: import com.google.android.material.snackbar.Snackbar",
          "9: import pl.droidsonroids.gif.GifOptions",
          "10: import pl.droidsonroids.gif.GifTexImage2D",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: import androidx.fragment.app.Fragment",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "13: import pl.droidsonroids.gif.sample.opengl.GifTexImage2DRenderer",
          "14: import pl.droidsonroids.gif.sample.opengl.isOpenGLES2Supported",
          "18:     private lateinit var gifTexImage2DProgram: GifTexImage2DProgram",
          "",
          "[Removed Lines]",
          "16: class GifTexImage2DFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "17: class GifTexImage2DFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/GifTextViewFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "9:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? =",
          "10:    inflater.inflate(R.layout.compound_drawables, container, false)",
          "11: }",
          "",
          "[Removed Lines]",
          "8: class GifTextViewFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "9: class GifTextViewFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/GifTextureFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "7: import kotlinx.android.synthetic.main.texture.*",
          "11:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? =",
          "12:    inflater.inflate(R.layout.texture, container, false)",
          "",
          "[Removed Lines]",
          "9: class GifTextureFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "10: class GifTextureFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/HttpFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "7: import com.google.android.material.snackbar.Snackbar",
          "8: import pl.droidsonroids.gif.GifTextureView",
          "9: import pl.droidsonroids.gif.InputSource",
          "10: import java.nio.ByteBuffer",
          "14:     private var gifTextureView: GifTextureView? = null",
          "15:     private val gifDownloader = GifDownloader(this)",
          "",
          "[Removed Lines]",
          "12: class HttpFragment : BaseFragment(), View.OnClickListener {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "13: class HttpFragment : Fragment(), View.OnClickListener {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: import android.view.View",
          "9: import android.view.ViewGroup",
          "10: import android.widget.TextView",
          "11: import pl.droidsonroids.gif.GifDrawable",
          "15:  private lateinit var textView: TextView",
          "",
          "[Removed Lines]",
          "13: class ImageSpanFragment : BaseFragment(), Drawable.Callback {",
          "",
          "[Added Lines]",
          "11: import androidx.fragment.app.Fragment",
          "14: class ImageSpanFragment : Fragment(), Drawable.Callback {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/LiveWallpaperFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: import android.view.LayoutInflater",
          "11: import android.view.View",
          "12: import android.view.ViewGroup",
          "13: import com.google.android.material.snackbar.Snackbar",
          "14: import kotlinx.android.synthetic.main.live_wallpaper.*",
          "15: import pl.droidsonroids.gif.sample.wallpaper.GifWallpaperService",
          "19:     override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "20:         return inflater.inflate(R.layout.live_wallpaper, container, false)",
          "",
          "[Removed Lines]",
          "17: class LiveWallpaperFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "13: import androidx.fragment.app.Fragment",
          "18: class LiveWallpaperFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt||sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/MainActivity.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import androidx.fragment.app.FragmentActivity",
          "5: import androidx.viewpager.widget.ViewPager",
          "",
          "[Removed Lines]",
          "7: import com.squareup.leakcanary.LeakCanary",
          "8: import com.squareup.leakcanary.RefWatcher",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "15: class MainActivity : FragmentActivity() {",
          "19:  override fun onCreate(savedInstanceState: Bundle?) {",
          "21:   super.onCreate(savedInstanceState)",
          "22:   setContentView(R.layout.activity_main)",
          "23:   findViewById<ViewPager>(R.id.main_pager).adapter = MainPagerAdapter(this)",
          "24:  }",
          "26: }",
          "",
          "[Removed Lines]",
          "17:  internal lateinit var refWatcher: RefWatcher",
          "20:   refWatcher = LeakCanary.install(application)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/TexturePlaceholderFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: import android.view.LayoutInflater",
          "9: import android.view.View",
          "10: import android.view.ViewGroup",
          "11: import pl.droidsonroids.gif.GifTextureView",
          "12: import pl.droidsonroids.gif.InputSource",
          "13: import java.io.BufferedInputStream",
          "17:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "18:   val view = GifTextureView(inflater.context)",
          "",
          "[Removed Lines]",
          "15: class TexturePlaceholderFragment : BaseFragment(), GifTextureView.PlaceholderDrawListener {",
          "",
          "[Added Lines]",
          "11: import androidx.fragment.app.Fragment",
          "16: class TexturePlaceholderFragment : Fragment(), GifTextureView.PlaceholderDrawListener {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/TextureViewFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: import android.view.animation.Animation",
          "10: import android.view.animation.BounceInterpolator",
          "11: import android.view.animation.ScaleAnimation",
          "12: import pl.droidsonroids.gif.InputSource",
          "16:     override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "17:         val textureView = TextureView(inflater.context)",
          "",
          "[Removed Lines]",
          "14: class TextureViewFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "12: import androidx.fragment.app.Fragment",
          "15: class TextureViewFragment : Fragment() {",
          "",
          "---------------"
        ],
        "sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/sources/GifSourcesFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import android.view.LayoutInflater",
          "5: import android.view.View",
          "6: import android.view.ViewGroup",
          "7: import androidx.recyclerview.widget.LinearLayoutManager",
          "8: import androidx.recyclerview.widget.RecyclerView",
          "16:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "17:   val recyclerView = RecyclerView(inflater.context)",
          "",
          "[Removed Lines]",
          "9: import pl.droidsonroids.gif.sample.BaseFragment",
          "14: class GifSourcesFragment : BaseFragment() {",
          "",
          "[Added Lines]",
          "7: import androidx.fragment.app.Fragment",
          "14: class GifSourcesFragment : Fragment() {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b185973cca1ccda91d97821e49d7dc479d825bc8",
      "candidate_info": {
        "commit_hash": "b185973cca1ccda91d97821e49d7dc479d825bc8",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/b185973cca1ccda91d97821e49d7dc479d825bc8",
        "files": [
          "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt",
          "sample/src/main/res/layout/activity_main.xml",
          "sample/src/main/res/layout/image_span.xml"
        ],
        "message": "Fix view leak in ImageSpanFragment",
        "before_after_code_files": [
          "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/689"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt||sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt": [
          "File: sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt -> sample/src/main/java/pl/droidsonroids/gif/sample/ImageSpanFragment.kt",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: import android.view.LayoutInflater",
          "8: import android.view.View",
          "9: import android.view.ViewGroup",
          "11: import androidx.fragment.app.Fragment",
          "12: import pl.droidsonroids.gif.GifDrawable",
          "14: class ImageSpanFragment : Fragment(), Drawable.Callback {",
          "41: }",
          "",
          "[Removed Lines]",
          "10: import android.widget.TextView",
          "16:  private lateinit var textView: TextView",
          "18:  override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {",
          "19:   textView = TextView(activity)",
          "20:   textView.setLayerType(View.LAYER_TYPE_SOFTWARE, null)",
          "21:   textView.setTextIsSelectable(true)",
          "22:   val gifDrawable = GifDrawable.createFromResource(resources, R.drawable.anim_flag_england)",
          "23:   val ssb = SpannableStringBuilder(\"test\\ufffc\")",
          "24:   gifDrawable!!.setBounds(0, 0, gifDrawable.intrinsicWidth, gifDrawable.intrinsicHeight)",
          "25:   gifDrawable.callback = this",
          "26:   ssb.setSpan(ImageSpan(gifDrawable), ssb.length - 1, ssb.length, 0)",
          "27:   textView.text = ssb",
          "28:   return textView",
          "29:  }",
          "31:  override fun invalidateDrawable(who: Drawable) =",
          "32:    textView.invalidate()",
          "34:  override fun scheduleDrawable(who: Drawable, what: Runnable, `when`: Long) {",
          "35:   textView.postDelayed(what, `when`)",
          "36:  }",
          "38:  override fun unscheduleDrawable(who: Drawable, what: Runnable) {",
          "39:   textView.removeCallbacks(what)",
          "40:  }",
          "",
          "[Added Lines]",
          "11: import kotlinx.android.synthetic.main.image_span.*",
          "16:     override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View =",
          "17:         inflater.inflate(R.layout.image_span, container, false)",
          "19:     override fun onViewCreated(view: View, savedInstanceState: Bundle?) {",
          "20:         imageSpanTextView.setLayerType(View.LAYER_TYPE_SOFTWARE, null)",
          "21:         val gifDrawable = GifDrawable.createFromResource(resources, R.drawable.anim_flag_england)",
          "22:         val stringBuilder = SpannableStringBuilder(\"test\\ufffc\")",
          "23:         gifDrawable!!.setBounds(0, 0, gifDrawable.intrinsicWidth, gifDrawable.intrinsicHeight)",
          "24:         gifDrawable.callback = this",
          "25:         stringBuilder.setSpan(ImageSpan(gifDrawable), stringBuilder.length - 1, stringBuilder.length, 0)",
          "26:         imageSpanTextView.text = stringBuilder",
          "27:     }",
          "29:     override fun invalidateDrawable(who: Drawable) {",
          "30:         imageSpanTextView?.invalidate()",
          "31:     }",
          "33:     override fun scheduleDrawable(who: Drawable, what: Runnable, `when`: Long) {",
          "34:         imageSpanTextView?.postDelayed(what, `when`)",
          "35:     }",
          "37:     override fun unscheduleDrawable(who: Drawable, what: Runnable) {",
          "38:         imageSpanTextView?.removeCallbacks(what)",
          "39:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}