{
  "cve_id": "CVE-2023-0866",
  "cve_desc": "Heap-based Buffer Overflow in GitHub repository gpac/gpac prior to 2.3.0-DEV.",
  "repo": "gpac/gpac",
  "patch_hash": "b964fe4226f1424cf676d5822ef898b6b01f5937",
  "patch_info": {
    "commit_hash": "b964fe4226f1424cf676d5822ef898b6b01f5937",
    "repo": "gpac/gpac",
    "commit_url": "https://github.com/gpac/gpac/commit/b964fe4226f1424cf676d5822ef898b6b01f5937",
    "files": [
      "src/filters/reframe_adts.c"
    ],
    "message": "rfadts: add size guard on dmx (#2400)",
    "before_after_code_files": [
      "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
    ]
  },
  "patch_diff": {
    "src/filters/reframe_adts.c||src/filters/reframe_adts.c": [
      "File: src/filters/reframe_adts.c -> src/filters/reframe_adts.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "824:   }",
      "826:   if (!ctx->in_seek) {",
      "827:    dst_pck = gf_filter_pck_new_alloc(ctx->opid, size, &output);",
      "828:    if (!dst_pck) return GF_OUT_OF_MEM;",
      "829:    if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "828:    if (sync_pos + offset + size > remain) {",
      "829:     GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (\"[ADTSDmx] truncated frame\\n\"));",
      "830:     break;",
      "831:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a9b6718ccd27aee4ebeaf1229bae397988be54e0",
      "candidate_info": {
        "commit_hash": "a9b6718ccd27aee4ebeaf1229bae397988be54e0",
        "repo": "gpac/gpac",
        "commit_url": "https://github.com/gpac/gpac/commit/a9b6718ccd27aee4ebeaf1229bae397988be54e0",
        "files": [
          "src/filters/reframe_adts.c"
        ],
        "message": "check size overflow in adts\n\nossfuzz issue 66518",
        "before_after_code_files": [
          "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
          ],
          "candidate": [
            "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
          ]
        }
      },
      "candidate_diff": {
        "src/filters/reframe_adts.c||src/filters/reframe_adts.c": [
          "File: src/filters/reframe_adts.c -> src/filters/reframe_adts.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "833:   if (!ctx->in_seek) {",
          "836:     GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (\"[ADTSDmx] truncated frame\\n\"));",
          "837:     break;",
          "838:    }",
          "",
          "[Removed Lines]",
          "835:    if (sync_pos + offset + size > remain) {",
          "",
          "[Added Lines]",
          "835:    if (size > GF_UINT_MAX - sync_pos - offset || sync_pos + offset + size > remain) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "518ae69dbbdb46c8443431dac9e9489aa0b78882",
      "candidate_info": {
        "commit_hash": "518ae69dbbdb46c8443431dac9e9489aa0b78882",
        "repo": "gpac/gpac",
        "commit_url": "https://github.com/gpac/gpac/commit/518ae69dbbdb46c8443431dac9e9489aa0b78882",
        "files": [
          "src/filters/reframe_adts.c"
        ],
        "message": "rfadts: add size guard on dmx (#2400)",
        "before_after_code_files": [
          "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
          ],
          "candidate": [
            "src/filters/reframe_adts.c||src/filters/reframe_adts.c"
          ]
        }
      },
      "candidate_diff": {
        "src/filters/reframe_adts.c||src/filters/reframe_adts.c": [
          "File: src/filters/reframe_adts.c -> src/filters/reframe_adts.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "824:   }",
          "826:   if (!ctx->in_seek) {",
          "827:    dst_pck = gf_filter_pck_new_alloc(ctx->opid, size, &output);",
          "828:    if (!dst_pck) return GF_OUT_OF_MEM;",
          "829:    if (ctx->src_pck) gf_filter_pck_merge_properties(ctx->src_pck, dst_pck);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "828:    if (sync_pos + offset + size > remain) {",
          "829:     GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (\"[ADTSDmx] truncated frame\\n\"));",
          "830:     break;",
          "831:    }",
          "",
          "---------------"
        ]
      }
    }
  ]
}