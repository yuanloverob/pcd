{
  "cve_id": "CVE-2019-10061",
  "cve_desc": "utils/find-opencv.js in node-opencv (aka OpenCV bindings for Node.js) prior to 6.1.0 is vulnerable to Command Injection. It does not validate user input allowing attackers to execute arbitrary commands.",
  "repo": "peterbraden/node-opencv",
  "patch_hash": "81a4b8620188e89f7e4fc985f3c89b58d4bcc86b",
  "patch_info": {
    "commit_hash": "81a4b8620188e89f7e4fc985f3c89b58d4bcc86b",
    "repo": "peterbraden/node-opencv",
    "commit_url": "https://github.com/peterbraden/node-opencv/commit/81a4b8620188e89f7e4fc985f3c89b58d4bcc86b",
    "files": [
      "utils/find-opencv.js"
    ],
    "message": "Remove untrusted input to exec",
    "before_after_code_files": [
      "utils/find-opencv.js||utils/find-opencv.js"
    ]
  },
  "patch_diff": {
    "utils/find-opencv.js||utils/find-opencv.js": [
      "File: utils/find-opencv.js -> utils/find-opencv.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3: var exec = require(\"child_process\").exec;",
      "4: var fs = require(\"fs\");",
      "13: function main(){",
      "",
      "[Removed Lines]",
      "5: var flag = process.argv[2] || \"--exists\";",
      "11: var opencv = process.env.PKG_CONFIG_OPENCV3 === \"1\" ? \"opencv3\" : '\"opencv >= 2.3.1\"';",
      "",
      "[Added Lines]",
      "5: var flag = \"--exists\";",
      "11: var opencv = process.env.PKG_CONFIG_OPENCV3 === \"1\" ? \"opencv3\" : ' \"opencv >= 2.3.1\"';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "18:                 fallback();",
      "19:             }",
      "20:             else{",
      "22:             }",
      "23:         }",
      "24:         else{",
      "",
      "[Removed Lines]",
      "21:                 throw new Error(\"ERROR: failed to run: pkg-config\", opencv, flag);",
      "",
      "[Added Lines]",
      "21:               throw new Error(\"ERROR: failed to run: pkg-config\" + opencv + \" \" + flag + \" - Is OpenCV installed?\");",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "aaece6921d7368577511f06c94c99dd4e9653563",
      "candidate_info": {
        "commit_hash": "aaece6921d7368577511f06c94c99dd4e9653563",
        "repo": "peterbraden/node-opencv",
        "commit_url": "https://github.com/peterbraden/node-opencv/commit/aaece6921d7368577511f06c94c99dd4e9653563",
        "files": [
          "README.md",
          "src/FaceRecognizer.h",
          "utils/find-opencv.js"
        ],
        "message": "Fix install script",
        "before_after_code_files": [
          "src/FaceRecognizer.h||src/FaceRecognizer.h",
          "utils/find-opencv.js||utils/find-opencv.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "utils/find-opencv.js||utils/find-opencv.js"
          ],
          "candidate": [
            "utils/find-opencv.js||utils/find-opencv.js"
          ]
        }
      },
      "candidate_diff": {
        "src/FaceRecognizer.h||src/FaceRecognizer.h": [
          "File: src/FaceRecognizer.h -> src/FaceRecognizer.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "8:   using cv::face::FaceRecognizer;",
          "9: }",
          "10: #else",
          "11: #include \"opencv2/contrib/contrib.hpp\"",
          "12: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: #warning using opencv2 contrib",
          "",
          "---------------"
        ],
        "utils/find-opencv.js||utils/find-opencv.js": [
          "File: utils/find-opencv.js -> utils/find-opencv.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: var exec = require(\"child_process\").exec;",
          "4: var fs = require(\"fs\");",
          "",
          "[Removed Lines]",
          "5: var flag = \"--exists\";",
          "",
          "[Added Lines]",
          "6: var flags = {",
          "7:   '--cflags' : '--cflags',",
          "8:   '--libs' : '--libs'",
          "9: }",
          "10: var flag = flags[process.argv[2]] || '--exists'",
          "",
          "---------------"
        ]
      }
    }
  ]
}