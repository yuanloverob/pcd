{
  "cve_id": "CVE-2022-23435",
  "cve_desc": "decoding.c in android-gif-drawable before 1.2.24 does not limit the maximum length of a comment, leading to denial of service.",
  "repo": "koral--/android-gif-drawable",
  "patch_hash": "9f0f0c89e6fa38548163771feeb4bde84b828887",
  "patch_info": {
    "commit_hash": "9f0f0c89e6fa38548163771feeb4bde84b828887",
    "repo": "koral--/android-gif-drawable",
    "commit_url": "https://github.com/koral--/android-gif-drawable/commit/9f0f0c89e6fa38548163771feeb4bde84b828887",
    "files": [
      "android-gif-drawable/src/main/c/decoding.c"
    ],
    "message": "Limit maximum length of comment",
    "before_after_code_files": [
      "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
    ]
  },
  "patch_diff": {
    "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c": [
      "File: android-gif-drawable/src/main/c/decoding.c -> android-gif-drawable/src/main/c/decoding.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #include \"gif.h\"",
      "3: static bool updateGCB(GifInfo *info, uint_fast32_t *lastAllocatedGCBIndex) {",
      "4:  if (*lastAllocatedGCBIndex < info->gifFilePtr->ImageCount) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2: #define COMMENT_LENGTH_MAX 2048",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "177: }",
      "179: static int getComment(GifByteType *Bytes, GifInfo *info) {",
      "181:  size_t offset = info->comment != NULL ? strlen(info->comment) : 0;",
      "183:  if (ret != NULL) {",
      "186:   info->comment = ret;",
      "187:   return GIF_OK;",
      "188:  }",
      "",
      "[Removed Lines]",
      "180:  unsigned int len = (unsigned int) Bytes[0];",
      "182:  char *ret = reallocarray(info->comment, len + offset + 1, sizeof(char));",
      "184:   memcpy(ret + offset, &Bytes[1], len);",
      "185:   ret[len + offset] = 0;",
      "",
      "[Added Lines]",
      "181:  unsigned int length = (unsigned int) Bytes[0];",
      "183:     unsigned int newLength = length + offset + 1;",
      "184:     if (newLength > COMMENT_LENGTH_MAX) {",
      "185:   return GIF_OK;",
      "186:  }",
      "187:     char *ret = reallocarray(info->comment, newLength, sizeof(char));",
      "189:   memcpy(ret + offset, &Bytes[1], length);",
      "190:   ret[length + offset] = 0;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f6be0ed0abeaeb0cc675eb664d14c0951742d20e",
      "candidate_info": {
        "commit_hash": "f6be0ed0abeaeb0cc675eb664d14c0951742d20e",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/f6be0ed0abeaeb0cc675eb664d14c0951742d20e",
        "files": [
          "CHANGELOG.md",
          "README.md",
          "android-gif-drawable/build.gradle",
          "android-gif-drawable/src/main/c/decoding.c",
          "build.gradle",
          "gradle.properties",
          "gradle/shipkit.gradle",
          "gradle/wrapper/gradle-wrapper.jar",
          "gradle/wrapper/gradle-wrapper.properties",
          "gradlew",
          "sample/src/main/AndroidManifest.xml",
          "version.properties"
        ],
        "message": "Limit maximum length of comment (#790)\n\n* Limit maximum length of comment\n\n* Update dependency versions\n\n* Change shipkit to maven publish plugin\n\n* Release 1.2.24",
        "before_after_code_files": [
          "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle",
          "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c",
          "build.gradle||build.gradle",
          "gradle.properties||gradle.properties",
          "gradle/shipkit.gradle||gradle/shipkit.gradle",
          "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties",
          "version.properties||version.properties"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/790"
        ],
        "olp_code_files": {
          "patch": [
            "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
          ],
          "candidate": [
            "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
          ]
        }
      },
      "candidate_diff": {
        "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle": [
          "File: android-gif-drawable/build.gradle -> android-gif-drawable/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: apply plugin: 'com.android.library'",
          "6: group = 'pl.droidsonroids.gif'",
          "7: description = 'Views and Drawable for displaying animated GIFs for Android'",
          "",
          "[Removed Lines]",
          "2: apply plugin: 'org.shipkit.bintray'",
          "3: apply plugin: 'org.shipkit.android-publish'",
          "5: androidPublish.artifactId = 'android-gif-drawable'",
          "",
          "[Added Lines]",
          "2: apply plugin: 'com.vanniktech.maven.publish'",
          "",
          "---------------"
        ],
        "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c": [
          "File: android-gif-drawable/src/main/c/decoding.c -> android-gif-drawable/src/main/c/decoding.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #include \"gif.h\"",
          "3: static bool updateGCB(GifInfo *info, uint_fast32_t *lastAllocatedGCBIndex) {",
          "4:  if (*lastAllocatedGCBIndex < info->gifFilePtr->ImageCount) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: #define COMMENT_LENGTH_MAX 2048",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "177: }",
          "179: static int getComment(GifByteType *Bytes, GifInfo *info) {",
          "181:  size_t offset = info->comment != NULL ? strlen(info->comment) : 0;",
          "183:  if (ret != NULL) {",
          "186:   info->comment = ret;",
          "187:   return GIF_OK;",
          "188:  }",
          "",
          "[Removed Lines]",
          "180:  unsigned int len = (unsigned int) Bytes[0];",
          "182:  char *ret = reallocarray(info->comment, len + offset + 1, sizeof(char));",
          "184:   memcpy(ret + offset, &Bytes[1], len);",
          "185:   ret[len + offset] = 0;",
          "",
          "[Added Lines]",
          "181:  unsigned int length = (unsigned int) Bytes[0];",
          "183:     unsigned int newLength = length + offset + 1;",
          "184:     if (newLength > COMMENT_LENGTH_MAX) {",
          "185:   return GIF_OK;",
          "186:  }",
          "187:     char *ret = reallocarray(info->comment, newLength, sizeof(char));",
          "189:   memcpy(ret + offset, &Bytes[1], length);",
          "190:   ret[length + offset] = 0;",
          "",
          "---------------"
        ],
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: buildscript {",
          "2:     ext {",
          "3:         versions = [",
          "6:                 minSdk             : 17,",
          "8:                 androidxAppcompat  : '1.2.0',",
          "11:                 coroutines         : '1.3.9',",
          "14:                 intellijAnnotations: '13.0',",
          "17:                 androidGradlePlugin: '7.0.3',",
          "19:                 mockito            : '3.5.13',",
          "20:                 robolectric        : '4.4',",
          "21:                 assertj3           : '3.14.0',",
          "",
          "[Removed Lines]",
          "4:                 compileSdk         : 30,",
          "5:                 targetSdk          : 30,",
          "7:                 ndk                : '21.3.6528147',",
          "9:                 androidxAnnotations: '1.1.0',",
          "10:                 androidxTest       : '1.3.0',",
          "12:                 leakCanary         : '2.5',",
          "13:                 kotlin             : '1.5.20',",
          "15:                 material           : '1.2.1',",
          "16:                 androidXextJunit   : '1.1.2',",
          "18:                 junit              : '4.13',",
          "",
          "[Added Lines]",
          "4:                 compileSdk         : 31,",
          "5:                 targetSdk          : 31,",
          "7:                 ndk                : '23.1.7779620',",
          "9:                 androidxAnnotations: '1.3.0',",
          "10:                 androidxTest       : '1.4.0',",
          "12:                 leakCanary         : '2.7',",
          "13:                 kotlin             : '1.6.10',",
          "15:                 material           : '1.5.0',",
          "16:                 androidXextJunit   : '1.1.3',",
          "18:                 junit              : '4.13.2',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "25:                 mockwebserver      : '4.9.0',",
          "26:                 relinker           : '1.4.1',",
          "28:         ]",
          "29:     }",
          "30:     repositories {",
          "31:         google()",
          "32:         mavenCentral()",
          "33:         gradlePluginPortal()",
          "35:     }",
          "36:     dependencies {",
          "37:         classpath \"com.android.tools.build:gradle:$versions.androidGradlePlugin\"",
          "38:         classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin\"",
          "40:     }",
          "41: }",
          "45: subprojects {",
          "46:     tasks.withType(JavaCompile) {",
          "",
          "[Removed Lines]",
          "27:                 shipkit            : '2.3.5',",
          "34:         jcenter()",
          "39:         classpath \"org.shipkit:shipkit:$versions.shipkit\"",
          "43: apply plugin: 'org.shipkit.java'",
          "",
          "[Added Lines]",
          "27:                 mavenPublishPlugin : '0.18.0',",
          "38:         classpath \"com.vanniktech:gradle-maven-publish-plugin:$versions.mavenPublishPlugin\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "49:     repositories {",
          "50:         google()",
          "51:         mavenCentral()",
          "53:     }",
          "54: }",
          "",
          "[Removed Lines]",
          "52:         jcenter()",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "gradle.properties||gradle.properties": [
          "File: gradle.properties -> gradle.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: org.gradle.jvmargs=-Xmx1536M",
          "",
          "[Removed Lines]",
          "2: android.useAndroidX=true",
          "",
          "[Added Lines]",
          "4: GROUP=pl.droidsonroids.gif",
          "5: POM_ARTIFACT_ID=android-gif-drawable",
          "6: VERSION_NAME=1.2.24",
          "8: POM_NAME=android-gif-drawable",
          "9: POM_DESCRIPTION=Views and Drawable for displaying animated GIFs for Android",
          "10: POM_INCEPTION_YEAR=2013",
          "11: POM_URL=https://github.com/koral--/android-gif-drawable",
          "13: POM_LICENSE_NAME=The MIT License",
          "14: POM_LICENSE_URL=https://spdx.org/licenses/MIT.html",
          "15: POM_LICENSE_DIST=repo",
          "17: POM_SCM_URL=https://github.com/koral--/android-gif-drawable",
          "18: POM_SCM_CONNECTION=scm:git:git://github.com/koral--/android-gif-drawable.git",
          "19: POM_SCM_DEV_CONNECTION=scm:git:ssh://git@github.com/koral--/android-gif-drawable.git",
          "21: POM_DEVELOPER_ID=koral",
          "22: POM_DEVELOPER_NAME=Karol Wr\u00f3tniak",
          "23: POM_DEVELOPER_URL=https://github.com/koral--",
          "",
          "---------------"
        ],
        "gradle/shipkit.gradle||gradle/shipkit.gradle": [
          "File: gradle/shipkit.gradle -> gradle/shipkit.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties": [
          "File: gradle/wrapper/gradle-wrapper.properties -> gradle/wrapper/gradle-wrapper.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: distributionBase=GRADLE_USER_HOME",
          "2: distributionPath=wrapper/dists",
          "4: zipStoreBase=GRADLE_USER_HOME",
          "5: zipStorePath=wrapper/dists",
          "",
          "[Removed Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-7.0.2-bin.zip",
          "",
          "[Added Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-7.3.3-bin.zip",
          "",
          "---------------"
        ],
        "version.properties||version.properties": [
          "File: version.properties -> version.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f29048bc3bd24d5baae63e46a4fddc69598151fd",
      "candidate_info": {
        "commit_hash": "f29048bc3bd24d5baae63e46a4fddc69598151fd",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/f29048bc3bd24d5baae63e46a4fddc69598151fd",
        "files": [
          "android-gif-drawable/build.gradle",
          "build.gradle",
          "gradle/wrapper/gradle-wrapper.jar",
          "gradle/wrapper/gradle-wrapper.properties",
          "gradlew",
          "sample/src/main/AndroidManifest.xml"
        ],
        "message": "Update dependency versions",
        "before_after_code_files": [
          "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle",
          "build.gradle||build.gradle",
          "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/790"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle": [
          "File: android-gif-drawable/build.gradle -> android-gif-drawable/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: apply plugin: 'com.android.library'",
          "6: group = 'pl.droidsonroids.gif'",
          "7: description = 'Views and Drawable for displaying animated GIFs for Android'",
          "",
          "[Removed Lines]",
          "2: apply plugin: 'org.shipkit.bintray'",
          "3: apply plugin: 'org.shipkit.android-publish'",
          "5: androidPublish.artifactId = 'android-gif-drawable'",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: buildscript {",
          "2:     ext {",
          "3:         versions = [",
          "6:                 minSdk             : 17,",
          "8:                 androidxAppcompat  : '1.2.0',",
          "11:                 coroutines         : '1.3.9',",
          "14:                 intellijAnnotations: '13.0',",
          "17:                 androidGradlePlugin: '7.0.3',",
          "19:                 mockito            : '3.5.13',",
          "20:                 robolectric        : '4.4',",
          "21:                 assertj3           : '3.14.0',",
          "",
          "[Removed Lines]",
          "4:                 compileSdk         : 30,",
          "5:                 targetSdk          : 30,",
          "7:                 ndk                : '21.3.6528147',",
          "9:                 androidxAnnotations: '1.1.0',",
          "10:                 androidxTest       : '1.3.0',",
          "12:                 leakCanary         : '2.5',",
          "13:                 kotlin             : '1.5.20',",
          "15:                 material           : '1.2.1',",
          "16:                 androidXextJunit   : '1.1.2',",
          "18:                 junit              : '4.13',",
          "",
          "[Added Lines]",
          "4:                 compileSdk         : 31,",
          "5:                 targetSdk          : 31,",
          "7:                 ndk                : '23.1.7779620',",
          "9:                 androidxAnnotations: '1.3.0',",
          "10:                 androidxTest       : '1.4.0',",
          "12:                 leakCanary         : '2.7',",
          "13:                 kotlin             : '1.6.10',",
          "15:                 material           : '1.5.0',",
          "16:                 androidXextJunit   : '1.1.3',",
          "18:                 junit              : '4.13.2',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "25:                 mockwebserver      : '4.9.0',",
          "26:                 relinker           : '1.4.1',",
          "28:         ]",
          "29:     }",
          "30:     repositories {",
          "31:         google()",
          "32:         mavenCentral()",
          "33:         gradlePluginPortal()",
          "35:     }",
          "36:     dependencies {",
          "37:         classpath \"com.android.tools.build:gradle:$versions.androidGradlePlugin\"",
          "38:         classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin\"",
          "40:     }",
          "41: }",
          "45: subprojects {",
          "46:     tasks.withType(JavaCompile) {",
          "",
          "[Removed Lines]",
          "27:                 shipkit            : '2.3.5',",
          "34:         jcenter()",
          "39:         classpath \"org.shipkit:shipkit:$versions.shipkit\"",
          "43: apply plugin: 'org.shipkit.java'",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "49:     repositories {",
          "50:         google()",
          "51:         mavenCentral()",
          "53:     }",
          "54: }",
          "",
          "[Removed Lines]",
          "52:         jcenter()",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "gradle/wrapper/gradle-wrapper.properties||gradle/wrapper/gradle-wrapper.properties": [
          "File: gradle/wrapper/gradle-wrapper.properties -> gradle/wrapper/gradle-wrapper.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: distributionBase=GRADLE_USER_HOME",
          "2: distributionPath=wrapper/dists",
          "4: zipStoreBase=GRADLE_USER_HOME",
          "5: zipStorePath=wrapper/dists",
          "",
          "[Removed Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-7.0.2-bin.zip",
          "",
          "[Added Lines]",
          "3: distributionUrl=https\\://services.gradle.org/distributions/gradle-7.3.3-bin.zip",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3821161829869116424eb76bccdb8e9a333df06c",
      "candidate_info": {
        "commit_hash": "3821161829869116424eb76bccdb8e9a333df06c",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/3821161829869116424eb76bccdb8e9a333df06c",
        "files": [
          "android-gif-drawable/build.gradle",
          "build.gradle",
          "gradle.properties",
          "gradle/shipkit.gradle",
          "version.properties"
        ],
        "message": "Change shipkit to maven publish plugin",
        "before_after_code_files": [
          "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle",
          "build.gradle||build.gradle",
          "gradle.properties||gradle.properties",
          "gradle/shipkit.gradle||gradle/shipkit.gradle",
          "version.properties||version.properties"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/koral--/android-gif-drawable/pull/790"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "android-gif-drawable/build.gradle||android-gif-drawable/build.gradle": [
          "File: android-gif-drawable/build.gradle -> android-gif-drawable/build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: apply plugin: 'com.android.library'",
          "3: group = 'pl.droidsonroids.gif'",
          "4: description = 'Views and Drawable for displaying animated GIFs for Android'",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: apply plugin: 'com.vanniktech.maven.publish'",
          "",
          "---------------"
        ],
        "build.gradle||build.gradle": [
          "File: build.gradle -> build.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "24:                 openglApi          : 'gl1.1-android-2.1_r1',",
          "25:                 mockwebserver      : '4.9.0',",
          "26:                 relinker           : '1.4.1',",
          "27:         ]",
          "28:     }",
          "29:     repositories {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27:                 mavenPublishPlugin : '0.18.0',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "34:     dependencies {",
          "35:         classpath \"com.android.tools.build:gradle:$versions.androidGradlePlugin\"",
          "36:         classpath \"org.jetbrains.kotlin:kotlin-gradle-plugin:$versions.kotlin\"",
          "37:     }",
          "38: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38:         classpath \"com.vanniktech:gradle-maven-publish-plugin:$versions.mavenPublishPlugin\"",
          "",
          "---------------"
        ],
        "gradle.properties||gradle.properties": [
          "File: gradle.properties -> gradle.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: org.gradle.jvmargs=-Xmx1536M",
          "",
          "[Removed Lines]",
          "2: android.useAndroidX=true",
          "",
          "[Added Lines]",
          "4: GROUP=pl.droidsonroids.gif",
          "5: POM_ARTIFACT_ID=android-gif-drawable",
          "6: VERSION_NAME=1.2.24",
          "8: POM_NAME=android-gif-drawable",
          "9: POM_DESCRIPTION=Views and Drawable for displaying animated GIFs for Android",
          "10: POM_INCEPTION_YEAR=2013",
          "11: POM_URL=https://github.com/koral--/android-gif-drawable",
          "13: POM_LICENSE_NAME=The MIT License",
          "14: POM_LICENSE_URL=https://spdx.org/licenses/MIT.html",
          "15: POM_LICENSE_DIST=repo",
          "17: POM_SCM_URL=https://github.com/koral--/android-gif-drawable",
          "18: POM_SCM_CONNECTION=scm:git:git://github.com/koral--/android-gif-drawable.git",
          "19: POM_SCM_DEV_CONNECTION=scm:git:ssh://git@github.com/koral--/android-gif-drawable.git",
          "21: POM_DEVELOPER_ID=koral",
          "22: POM_DEVELOPER_NAME=Karol Wr\u00f3tniak",
          "23: POM_DEVELOPER_URL=https://github.com/koral--",
          "",
          "---------------"
        ],
        "gradle/shipkit.gradle||gradle/shipkit.gradle": [
          "File: gradle/shipkit.gradle -> gradle/shipkit.gradle",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "version.properties||version.properties": [
          "File: version.properties -> version.properties",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9f0f0c89e6fa38548163771feeb4bde84b828887",
      "candidate_info": {
        "commit_hash": "9f0f0c89e6fa38548163771feeb4bde84b828887",
        "repo": "koral--/android-gif-drawable",
        "commit_url": "https://github.com/koral--/android-gif-drawable/commit/9f0f0c89e6fa38548163771feeb4bde84b828887",
        "files": [
          "android-gif-drawable/src/main/c/decoding.c"
        ],
        "message": "Limit maximum length of comment",
        "before_after_code_files": [
          "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
          ],
          "candidate": [
            "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c"
          ]
        }
      },
      "candidate_diff": {
        "android-gif-drawable/src/main/c/decoding.c||android-gif-drawable/src/main/c/decoding.c": [
          "File: android-gif-drawable/src/main/c/decoding.c -> android-gif-drawable/src/main/c/decoding.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #include \"gif.h\"",
          "3: static bool updateGCB(GifInfo *info, uint_fast32_t *lastAllocatedGCBIndex) {",
          "4:  if (*lastAllocatedGCBIndex < info->gifFilePtr->ImageCount) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: #define COMMENT_LENGTH_MAX 2048",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "177: }",
          "179: static int getComment(GifByteType *Bytes, GifInfo *info) {",
          "181:  size_t offset = info->comment != NULL ? strlen(info->comment) : 0;",
          "183:  if (ret != NULL) {",
          "186:   info->comment = ret;",
          "187:   return GIF_OK;",
          "188:  }",
          "",
          "[Removed Lines]",
          "180:  unsigned int len = (unsigned int) Bytes[0];",
          "182:  char *ret = reallocarray(info->comment, len + offset + 1, sizeof(char));",
          "184:   memcpy(ret + offset, &Bytes[1], len);",
          "185:   ret[len + offset] = 0;",
          "",
          "[Added Lines]",
          "181:  unsigned int length = (unsigned int) Bytes[0];",
          "183:     unsigned int newLength = length + offset + 1;",
          "184:     if (newLength > COMMENT_LENGTH_MAX) {",
          "185:   return GIF_OK;",
          "186:  }",
          "187:     char *ret = reallocarray(info->comment, newLength, sizeof(char));",
          "189:   memcpy(ret + offset, &Bytes[1], length);",
          "190:   ret[length + offset] = 0;",
          "",
          "---------------"
        ]
      }
    }
  ]
}