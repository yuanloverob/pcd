{
  "cve_id": "CVE-2023-50255",
  "cve_desc": "Deepin-Compressor is the default archive manager of Deepin Linux OS. Prior to 5.12.21, there's a path traversal vulnerability in deepin-compressor that can be exploited to achieve Remote Command Execution on the target system upon opening crafted archives. Users are advised to update to version 5.12.21 which addresses the issue. There are no known workarounds for this vulnerability.\n",
  "repo": "linuxdeepin/deepin-compressor",
  "patch_hash": "82f668c78c133873f5094cfab6e4eabc0b70e4b6",
  "patch_info": {
    "commit_hash": "82f668c78c133873f5094cfab6e4eabc0b70e4b6",
    "repo": "linuxdeepin/deepin-compressor",
    "commit_url": "https://github.com/linuxdeepin/deepin-compressor/commit/82f668c78c133873f5094cfab6e4eabc0b70e4b6",
    "files": [
      "3rdparty/libzipplugin/libzipplugin.cpp"
    ],
    "message": "fix: Zip Path Traversal\n\nZip Path Traversal\n\nBug: https://pms.uniontech.com/bug-view-232873.html\n\nLog: Zip Path Traversal",
    "before_after_code_files": [
      "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp"
    ]
  },
  "patch_diff": {
    "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp": [
      "File: 3rdparty/libzipplugin/libzipplugin.cpp -> 3rdparty/libzipplugin/libzipplugin.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "761:     }",
      "763:     strFileName = m_common->trans2uft8(statBuffer.name, m_mapFileCode[index]);    // \u89e3\u538b\u6587\u4ef6\u540d\uff08\u538b\u7f29\u5305\u4e2d\uff09",
      "764:     if(strFileName.contains(QLatin1Char('\\\\')))",
      "765:         strFileName = strFileName.replace(QLatin1Char('\\\\'), QDir::separator());",
      "766:     QString strOriginName = strFileName;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "765:     if(strFileName.indexOf(\"../\") != -1) {",
      "766:         qInfo() << \"skipped ../ path component(s) in \" << strFileName;",
      "767:         strFileName = strFileName.replace(\"../\", \"\");",
      "768:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e809e38295fb9367b718fb8fd9b567aafc6f27c9",
      "candidate_info": {
        "commit_hash": "e809e38295fb9367b718fb8fd9b567aafc6f27c9",
        "repo": "linuxdeepin/deepin-compressor",
        "commit_url": "https://github.com/linuxdeepin/deepin-compressor/commit/e809e38295fb9367b718fb8fd9b567aafc6f27c9",
        "files": [
          "3rdparty/libzipplugin/libzipplugin.cpp"
        ],
        "message": "fix: Zip Path Traversal (#181)\n\nZip Path Traversal\n\nBug: https://pms.uniontech.com/bug-view-232873.html\n\nLog: Zip Path Traversal",
        "before_after_code_files": [
          "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp"
          ],
          "candidate": [
            "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp"
          ]
        }
      },
      "candidate_diff": {
        "3rdparty/libzipplugin/libzipplugin.cpp||3rdparty/libzipplugin/libzipplugin.cpp": [
          "File: 3rdparty/libzipplugin/libzipplugin.cpp -> 3rdparty/libzipplugin/libzipplugin.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "761:     }",
          "763:     strFileName = m_common->trans2uft8(statBuffer.name, m_mapFileCode[index]);    // \u89e3\u538b\u6587\u4ef6\u540d\uff08\u538b\u7f29\u5305\u4e2d\uff09",
          "764:     if(strFileName.contains(QLatin1Char('\\\\')))",
          "765:         strFileName = strFileName.replace(QLatin1Char('\\\\'), QDir::separator());",
          "766:     QString strOriginName = strFileName;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "765:     if(strFileName.indexOf(\"../\") != -1) {",
          "766:         qInfo() << \"skipped ../ path component(s) in \" << strFileName;",
          "767:         strFileName = strFileName.replace(\"../\", \"\");",
          "768:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}