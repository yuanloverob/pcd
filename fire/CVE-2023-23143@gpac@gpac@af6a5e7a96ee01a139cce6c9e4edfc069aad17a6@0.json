{
  "cve_id": "CVE-2023-23143",
  "cve_desc": "Buffer overflow vulnerability in function avc_parse_slice in file media_tools/av_parsers.c. GPAC version 2.3-DEV-rev1-g4669ba229-master.",
  "repo": "gpac/gpac",
  "patch_hash": "af6a5e7a96ee01a139cce6c9e4edfc069aad17a6",
  "patch_info": {
    "commit_hash": "af6a5e7a96ee01a139cce6c9e4edfc069aad17a6",
    "repo": "gpac/gpac",
    "commit_url": "https://github.com/gpac/gpac/commit/af6a5e7a96ee01a139cce6c9e4edfc069aad17a6",
    "files": [
      "src/media_tools/av_parsers.c"
    ],
    "message": "fixed #2366",
    "before_after_code_files": [
      "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c"
    ]
  },
  "patch_diff": {
    "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c": [
      "File: src/media_tools/av_parsers.c -> src/media_tools/av_parsers.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5677:  if (si->slice_type > 9) return -1;",
      "5679:  pps_id = gf_bs_read_ue_log(bs, \"pps_id\");",
      "5681:  si->pps = &avc->pps[pps_id];",
      "5682:  if (!si->pps->slice_group_count) return -2;",
      "5684:  si->sps = &avc->sps[si->pps->sps_id];",
      "5685:  if (!si->sps->log2_max_frame_num) return -2;",
      "5686:  avc->sps_active_idx = si->pps->sps_id;",
      "",
      "[Removed Lines]",
      "5680:  if ((pps_id<0) || (pps_id > 255)) return -1;",
      "5683:  if (si->pps->sps_id>=255) return -1;",
      "",
      "[Added Lines]",
      "5680:  if ((pps_id<0) || (pps_id >= 255)) return -1;",
      "5683:  if (si->pps->sps_id>=32) return -1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "5787:  if (si->slice_type > 9) return -1;",
      "5789:  pps_id = gf_bs_read_ue_log(bs, \"pps_id\");",
      "5791:   return -1;",
      "5792:  si->pps = &avc->pps[pps_id];",
      "5793:  si->pps->id = pps_id;",
      "",
      "[Removed Lines]",
      "5790:  if ((pps_id<0) || (pps_id > 255))",
      "",
      "[Added Lines]",
      "5790:  if ((pps_id<0) || (pps_id >= 255))",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a82810c24099140d296ad2bbd92f85247842404b",
      "candidate_info": {
        "commit_hash": "a82810c24099140d296ad2bbd92f85247842404b",
        "repo": "gpac/gpac",
        "commit_url": "https://github.com/gpac/gpac/commit/a82810c24099140d296ad2bbd92f85247842404b",
        "files": [
          "src/media_tools/av_parsers.c"
        ],
        "message": "fixed #2366",
        "before_after_code_files": [
          "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c"
          ],
          "candidate": [
            "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c"
          ]
        }
      },
      "candidate_diff": {
        "src/media_tools/av_parsers.c||src/media_tools/av_parsers.c": [
          "File: src/media_tools/av_parsers.c -> src/media_tools/av_parsers.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5677:  if (si->slice_type > 9) return -1;",
          "5679:  pps_id = gf_bs_read_ue_log(bs, \"pps_id\");",
          "5681:  si->pps = &avc->pps[pps_id];",
          "5682:  if (!si->pps->slice_group_count) return -2;",
          "5684:  si->sps = &avc->sps[si->pps->sps_id];",
          "5685:  if (!si->sps->log2_max_frame_num) return -2;",
          "5686:  avc->sps_active_idx = si->pps->sps_id;",
          "",
          "[Removed Lines]",
          "5680:  if ((pps_id<0) || (pps_id > 255)) return -1;",
          "5683:  if (si->pps->sps_id>=255) return -1;",
          "",
          "[Added Lines]",
          "5680:  if ((pps_id<0) || (pps_id >= 255)) return -1;",
          "5683:  if (si->pps->sps_id>=32) return -1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "5787:  if (si->slice_type > 9) return -1;",
          "5789:  pps_id = gf_bs_read_ue_log(bs, \"pps_id\");",
          "5791:   return -1;",
          "5792:  si->pps = &avc->pps[pps_id];",
          "5793:  si->pps->id = pps_id;",
          "",
          "[Removed Lines]",
          "5790:  if ((pps_id<0) || (pps_id > 255))",
          "",
          "[Added Lines]",
          "5790:  if ((pps_id<0) || (pps_id >= 255))",
          "",
          "---------------"
        ]
      }
    }
  ]
}