{
  "cve_id": "CVE-2023-27596",
  "cve_desc": "OpenSIPS is a Session Initiation Protocol (SIP) server implementation. Prior to versions 3.1.8 and 3.2.5, OpenSIPS crashes when a malformed SDP body is sent multiple times to an OpenSIPS configuration that makes use of the `stream_process` function. This issue was discovered during coverage guided fuzzing of the function `codec_delete_except_re`. By abusing this vulnerability, an attacker is able to crash the server. It affects configurations containing functions that rely on the affected code, such as the function `codec_delete_except_re`. This issue has been fixed in version 3.1.8 and 3.2.5.",
  "repo": "OpenSIPS/opensips",
  "patch_hash": "dd051f8ed5ae3347fb1d556ced3c97822c9d8450",
  "patch_info": {
    "commit_hash": "dd051f8ed5ae3347fb1d556ced3c97822c9d8450",
    "repo": "OpenSIPS/opensips",
    "commit_url": "https://github.com/OpenSIPS/opensips/commit/dd051f8ed5ae3347fb1d556ced3c97822c9d8450",
    "files": [
      "modules/sipmsgops/codecs.c"
    ],
    "message": "[sipmsgops] fix codec_delete_XX() parsing\n\nIssue discovered during OpenSIPS Security Audit 2021/2022,\nby Alfred Farrugia & Sandro Gauci (Enable Security)\n\nhttps://github.com/OpenSIPS/opensips/security/advisories/GHSA-3ghx-j39m-cw4f",
    "before_after_code_files": [
      "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
    ]
  },
  "patch_diff": {
    "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c": [
      "File: modules/sipmsgops/codecs.c -> modules/sipmsgops/codecs.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "560:      if (cur == lmp->u.value + lmp->len) {",
      "561:       tmp = found.s;",
      "563:        found.s--;",
      "564:        found.len++;",
      "565:       }",
      "",
      "[Removed Lines]",
      "562:       while (*(--tmp) == ' ') {",
      "",
      "[Added Lines]",
      "562:       while (tmp>lmp->u.value && *(--tmp) == ' ') {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "81941d1884cfd69a3090420ab4fb93e69d2d7562",
      "candidate_info": {
        "commit_hash": "81941d1884cfd69a3090420ab4fb93e69d2d7562",
        "repo": "OpenSIPS/opensips",
        "commit_url": "https://github.com/OpenSIPS/opensips/commit/81941d1884cfd69a3090420ab4fb93e69d2d7562",
        "files": [
          "modules/sipmsgops/codecs.c"
        ],
        "message": "[sipmsgops] fix codec_delete_XX() parsing\n\nIssue discovered during OpenSIPS Security Audit 2021/2022,\nby Alfred Farrugia & Sandro Gauci (Enable Security)\n\nhttps://github.com/OpenSIPS/opensips/security/advisories/GHSA-3ghx-j39m-cw4f\n(cherry picked from commit dd051f8ed5ae3347fb1d556ced3c97822c9d8450)",
        "before_after_code_files": [
          "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
          ],
          "candidate": [
            "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
          ]
        }
      },
      "candidate_diff": {
        "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c": [
          "File: modules/sipmsgops/codecs.c -> modules/sipmsgops/codecs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "560:      if (cur == lmp->u.value + lmp->len) {",
          "561:       tmp = found.s;",
          "563:        found.s--;",
          "564:        found.len++;",
          "565:       }",
          "",
          "[Removed Lines]",
          "562:       while (*(--tmp) == ' ') {",
          "",
          "[Added Lines]",
          "562:       while (tmp>lmp->u.value && *(--tmp) == ' ') {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1d60e7422aff69ca083fac3f907d7183c2e7f58e",
      "candidate_info": {
        "commit_hash": "1d60e7422aff69ca083fac3f907d7183c2e7f58e",
        "repo": "OpenSIPS/opensips",
        "commit_url": "https://github.com/OpenSIPS/opensips/commit/1d60e7422aff69ca083fac3f907d7183c2e7f58e",
        "files": [
          "modules/sipmsgops/codecs.c"
        ],
        "message": "[sipmsgops] fix codec_delete_XX() parsing\n\nIssue discovered during OpenSIPS Security Audit 2021/2022,\nby Alfred Farrugia & Sandro Gauci (Enable Security)\n\nhttps://github.com/OpenSIPS/opensips/security/advisories/GHSA-3ghx-j39m-cw4f\n(cherry picked from commit dd051f8ed5ae3347fb1d556ced3c97822c9d8450)",
        "before_after_code_files": [
          "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
          ],
          "candidate": [
            "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c"
          ]
        }
      },
      "candidate_diff": {
        "modules/sipmsgops/codecs.c||modules/sipmsgops/codecs.c": [
          "File: modules/sipmsgops/codecs.c -> modules/sipmsgops/codecs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "560:      if (cur == lmp->u.value + lmp->len) {",
          "561:       tmp = found.s;",
          "563:        found.s--;",
          "564:        found.len++;",
          "565:       }",
          "",
          "[Removed Lines]",
          "562:       while (*(--tmp) == ' ') {",
          "",
          "[Added Lines]",
          "562:       while (tmp>lmp->u.value && *(--tmp) == ' ') {",
          "",
          "---------------"
        ]
      }
    }
  ]
}