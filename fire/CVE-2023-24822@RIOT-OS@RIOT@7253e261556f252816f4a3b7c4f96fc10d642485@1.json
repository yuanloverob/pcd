{
  "cve_id": "CVE-2023-24822",
  "cve_desc": "RIOT-OS, an operating system that supports Internet of Things devices, contains a network stack with the ability to process 6LoWPAN frames. Prior to version 2022.10, an attacker can send a crafted frame to the device resulting in a NULL pointer dereference while encoding a 6LoWPAN IPHC header. The NULL pointer dereference causes a hard fault exception, leading to denial of service. Version 2022.10 fixes this issue. As a workaround, apply the patches manually.",
  "repo": "RIOT-OS/RIOT",
  "patch_hash": "7253e261556f252816f4a3b7c4f96fc10d642485",
  "patch_info": {
    "commit_hash": "7253e261556f252816f4a3b7c4f96fc10d642485",
    "repo": "RIOT-OS/RIOT",
    "commit_url": "https://github.com/RIOT-OS/RIOT/commit/7253e261556f252816f4a3b7c4f96fc10d642485",
    "files": [
      "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
    ],
    "message": "gnrc_sixlowpan_iphc: fix null pointer dereference in _iphc_encode()\n\n(cherry picked from commit 639c04325de4ceb9d444955f4927bfae95843a39)",
    "before_after_code_files": [
      "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
    ]
  },
  "patch_diff": {
    "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c": [
      "File: sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c -> sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1650: #ifdef MODULE_GNRC_SIXLOWPAN_IPHC_NHC",
      "1651:     while (_compressible_nh(nh)) {",
      "1652:         ssize_t local_pos = 0;",
      "1653:         switch (nh) {",
      "1654:             case PROTNUM_UDP:",
      "1655:                 local_pos = _nhc_udp_encode_snip(pkt, &iphc_hdr[inline_pos]);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1653:         if (pkt->next->next == NULL) {",
      "1654:             DEBUG(\"6lo iphc: packet next header missing data\");",
      "1655:             gnrc_pktbuf_release(dispatch);",
      "1656:             return NULL;",
      "1657:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0cba82a6347956fab07170882a89ab42d5c59691",
      "candidate_info": {
        "commit_hash": "0cba82a6347956fab07170882a89ab42d5c59691",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/0cba82a6347956fab07170882a89ab42d5c59691",
        "files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ],
        "message": "gnrc_sixlowpan_iphc.c: dereference ipv6_hdr in DEBUG() after assignment\n\n(cherry picked from commit 36a099e1ec52187a21c767b6bcc32eaec5690b75)",
        "before_after_code_files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/RIOT-OS/RIOT/pull/18820"
        ],
        "olp_code_files": {
          "patch": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ],
          "candidate": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ]
        }
      },
      "candidate_diff": {
        "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c": [
          "File: sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c -> sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "843:             payload_len = (uint16_t)(rbuf->super.datagram_size - sizeof(ipv6_hdr_t));",
          "844:         }",
          "845: #ifdef MODULE_GNRC_SIXLOWPAN_FRAG_VRB",
          "849:         ipv6_hdr = ipv6->data;",
          "",
          "[Removed Lines]",
          "846:         DEBUG(\"6lo iphc: VRB present, trying to create entry for dst %s\\n\",",
          "847:               ipv6_addr_to_str(addr_str, &ipv6_hdr->dst, sizeof(addr_str)));",
          "",
          "[Added Lines]",
          "848:         DEBUG(\"6lo iphc: VRB present, trying to create entry for dst %s\\n\",",
          "849:               ipv6_addr_to_str(addr_str, &ipv6_hdr->dst, sizeof(addr_str)));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d052e2ee166e55bbdfe4c455e65dbd7e3479ebe3",
      "candidate_info": {
        "commit_hash": "d052e2ee166e55bbdfe4c455e65dbd7e3479ebe3",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/d052e2ee166e55bbdfe4c455e65dbd7e3479ebe3",
        "files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ],
        "message": "gnrc_sixlowpan_iphc: fix integer underflow in gnrc_sixlowpan_iphc_recv()\n\n(cherry picked from commit 2709fbd827b688fe62df2c77c316914f4a3a6d4a)",
        "before_after_code_files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/RIOT-OS/RIOT/pull/18820"
        ],
        "olp_code_files": {
          "patch": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ],
          "candidate": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ]
        }
      },
      "candidate_diff": {
        "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c": [
          "File: sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c -> sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "760:     iface = gnrc_netif_hdr_get_netif(netif->data);",
          "761:     payload_offset = _iphc_ipv6_decode(iphc_hdr, netif->data, iface,",
          "762:                                        ipv6->data);",
          "765:         _recv_error_release(sixlo, ipv6, rbuf);",
          "766:         return;",
          "767:     }",
          "",
          "[Removed Lines]",
          "763:     if (payload_offset == 0) {",
          "",
          "[Added Lines]",
          "763:     if ((payload_offset == 0) || (payload_offset > sixlo->size)) {",
          "765:         DEBUG(\"6lo iphc: malformed IPHC header\\n\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "781:                                                            &prev_nh_offset,",
          "782:                                                            ipv6,",
          "783:                                                            &uncomp_hdr_len);",
          "785:                         _recv_error_release(sixlo, ipv6, rbuf);",
          "786:                         return;",
          "787:                     }",
          "",
          "[Removed Lines]",
          "784:                     if (payload_offset == 0) {",
          "",
          "[Added Lines]",
          "785:                     if ((payload_offset == 0) || (payload_offset > sixlo->size)) {",
          "787:                         DEBUG(\"6lo iphc: malformed IPHC NHC IPv6 header\\n\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "796:                                                           prev_nh_offset,",
          "797:                                                           ipv6,",
          "798:                                                           &uncomp_hdr_len);",
          "800:                         _recv_error_release(sixlo, ipv6, rbuf);",
          "801:                         return;",
          "802:                     }",
          "",
          "[Removed Lines]",
          "799:                     if (payload_offset == 0) {",
          "",
          "[Added Lines]",
          "802:                     if ((payload_offset == 0) || (payload_offset > sixlo->size)) {",
          "804:                         DEBUG(\"6lo iphc: malformed IPHC NHC IPv6 header\\n\");",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "899:     ipv6_hdr = ipv6->data;",
          "900:     ipv6_hdr->len = byteorder_htons(payload_len);",
          "904:     if (rbuf != NULL) {",
          "905:         rbuf->super.current_size += (uncomp_hdr_len - payload_offset);",
          "906: #ifdef MODULE_GNRC_SIXLOWPAN_FRAG_VRB",
          "",
          "[Removed Lines]",
          "901:     memcpy(((uint8_t *)ipv6->data) + uncomp_hdr_len,",
          "902:            ((uint8_t *)sixlo->data) + payload_offset,",
          "903:            sixlo->size - payload_offset);",
          "",
          "[Added Lines]",
          "906:     if (sixlo->size > payload_offset) {",
          "907:         memcpy(((uint8_t *)ipv6->data) + uncomp_hdr_len,",
          "908:                ((uint8_t *)sixlo->data) + payload_offset,",
          "909:                sixlo->size - payload_offset);",
          "910:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e82cab6a94fa7865162bb7ac3705d5a461b1207d",
      "candidate_info": {
        "commit_hash": "e82cab6a94fa7865162bb7ac3705d5a461b1207d",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/e82cab6a94fa7865162bb7ac3705d5a461b1207d",
        "files": [
          "tests/unittests/tests-ieee802154/tests-ieee802154.c"
        ],
        "message": "tests/unittests: fix get_frame_hdr_len tests for hardened parsing\n\n(cherry picked from commit 3c7c9fefd61a57e25a08d6566ded64ca8c5326ae)",
        "before_after_code_files": [
          "tests/unittests/tests-ieee802154/tests-ieee802154.c||tests/unittests/tests-ieee802154/tests-ieee802154.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/RIOT-OS/RIOT/pull/18820"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/unittests/tests-ieee802154/tests-ieee802154.c||tests/unittests/tests-ieee802154/tests-ieee802154.c": [
          "File: tests/unittests/tests-ieee802154/tests-ieee802154.c -> tests/unittests/tests-ieee802154/tests-ieee802154.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "407: static void test_ieee802154_get_frame_hdr_len_dst0_src0(void)",
          "408: {",
          "413: }",
          "415: static void test_ieee802154_get_frame_hdr_len_dstr(void)",
          "416: {",
          "419:     TEST_ASSERT_EQUAL_INT(0, ieee802154_get_frame_hdr_len(mhr));",
          "420: }",
          "422: static void test_ieee802154_get_frame_hdr_len_srcr(void)",
          "423: {",
          "426:     TEST_ASSERT_EQUAL_INT(0, ieee802154_get_frame_hdr_len(mhr));",
          "427: }",
          "429: static void test_ieee802154_get_frame_hdr_len_dst2_src0(void)",
          "430: {",
          "434:     TEST_ASSERT_EQUAL_INT(7, ieee802154_get_frame_hdr_len(mhr));",
          "435: }",
          "437: static void test_ieee802154_get_frame_hdr_len_dst8_src0(void)",
          "438: {",
          "441:     TEST_ASSERT_EQUAL_INT(13, ieee802154_get_frame_hdr_len(mhr));",
          "442: }",
          "444: static void test_ieee802154_get_frame_hdr_len_dst0_src2(void)",
          "445: {",
          "448:     TEST_ASSERT_EQUAL_INT(7, ieee802154_get_frame_hdr_len(mhr));",
          "449: }",
          "451: static void test_ieee802154_get_frame_hdr_len_dst0_src2_pancomp(void)",
          "452: {",
          "455:     TEST_ASSERT_EQUAL_INT(0, ieee802154_get_frame_hdr_len(mhr));",
          "456: }",
          "458: static void test_ieee802154_get_frame_hdr_len_dst0_src8(void)",
          "459: {",
          "462:     TEST_ASSERT_EQUAL_INT(13, ieee802154_get_frame_hdr_len(mhr));",
          "463: }",
          "465: static void test_ieee802154_get_frame_hdr_len_dst0_src8_pancomp(void)",
          "466: {",
          "469:     TEST_ASSERT_EQUAL_INT(0, ieee802154_get_frame_hdr_len(mhr));",
          "470: }",
          "472: static void test_ieee802154_get_frame_hdr_len_dst2_src2(void)",
          "473: {",
          "477:     TEST_ASSERT_EQUAL_INT(11, ieee802154_get_frame_hdr_len(mhr));",
          "478: }",
          "480: static void test_ieee802154_get_frame_hdr_len_dst8_src2(void)",
          "481: {",
          "485:     TEST_ASSERT_EQUAL_INT(17, ieee802154_get_frame_hdr_len(mhr));",
          "486: }",
          "488: static void test_ieee802154_get_frame_hdr_len_dst8_src8(void)",
          "489: {",
          "493:     TEST_ASSERT_EQUAL_INT(23, ieee802154_get_frame_hdr_len(mhr));",
          "494: }",
          "496: static void test_ieee802154_get_frame_hdr_len_dst2_src2_pancomp(void)",
          "497: {",
          "501:     TEST_ASSERT_EQUAL_INT(9, ieee802154_get_frame_hdr_len(mhr));",
          "502: }",
          "504: static void test_ieee802154_get_frame_hdr_len_dst8_src8_pancomp(void)",
          "505: {",
          "509:     TEST_ASSERT_EQUAL_INT(21, ieee802154_get_frame_hdr_len(mhr));",
          "510: }",
          "",
          "[Removed Lines]",
          "409:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_VOID |",
          "410:                                   IEEE802154_FCF_SRC_ADDR_VOID };",
          "412:     TEST_ASSERT_EQUAL_INT(3, ieee802154_get_frame_hdr_len(mhr));",
          "417:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_RESV };",
          "424:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_RESV };",
          "431:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_SHORT |",
          "432:                                   IEEE802154_FCF_SRC_ADDR_VOID };",
          "439:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_LONG };",
          "446:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_SRC_ADDR_SHORT };",
          "453:     const uint8_t mhr[] = { IEEE802154_FCF_PAN_COMP, IEEE802154_FCF_SRC_ADDR_SHORT };",
          "460:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_SRC_ADDR_LONG };",
          "467:     const uint8_t mhr[] = { IEEE802154_FCF_PAN_COMP, IEEE802154_FCF_SRC_ADDR_LONG };",
          "474:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_SHORT |",
          "475:                                   IEEE802154_FCF_SRC_ADDR_SHORT };",
          "482:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_LONG |",
          "483:                                   IEEE802154_FCF_SRC_ADDR_SHORT };",
          "490:     const uint8_t mhr[] = { 0x00, IEEE802154_FCF_DST_ADDR_LONG |",
          "491:                                   IEEE802154_FCF_SRC_ADDR_LONG };",
          "498:     const uint8_t mhr[] = { IEEE802154_FCF_PAN_COMP, IEEE802154_FCF_DST_ADDR_SHORT |",
          "499:                                                      IEEE802154_FCF_SRC_ADDR_SHORT };",
          "506:     const uint8_t mhr[] = { IEEE802154_FCF_PAN_COMP, IEEE802154_FCF_DST_ADDR_LONG |",
          "507:                                                      IEEE802154_FCF_SRC_ADDR_LONG };",
          "",
          "[Added Lines]",
          "409:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_DST_ADDR_VOID |",
          "410:                                                       IEEE802154_FCF_SRC_ADDR_VOID };",
          "413:     TEST_ASSERT_EQUAL_INT(0, ieee802154_get_frame_hdr_len(mhr));",
          "418:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_DST_ADDR_RESV };",
          "425:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_DST_ADDR_RESV };",
          "432:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_DST_ADDR_SHORT |",
          "433:                                                       IEEE802154_FCF_SRC_ADDR_VOID };",
          "440:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_DST_ADDR_LONG };",
          "447:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_SRC_ADDR_SHORT };",
          "454:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA | IEEE802154_FCF_PAN_COMP,",
          "455:                             IEEE802154_FCF_SRC_ADDR_SHORT };",
          "462:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA, IEEE802154_FCF_SRC_ADDR_LONG };",
          "469:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA | IEEE802154_FCF_PAN_COMP,",
          "470:                             IEEE802154_FCF_SRC_ADDR_LONG };",
          "477:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA,",
          "478:                             IEEE802154_FCF_DST_ADDR_SHORT | IEEE802154_FCF_SRC_ADDR_SHORT };",
          "485:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA,",
          "486:                             IEEE802154_FCF_DST_ADDR_LONG | IEEE802154_FCF_SRC_ADDR_SHORT };",
          "493:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA,",
          "494:                             IEEE802154_FCF_DST_ADDR_LONG | IEEE802154_FCF_SRC_ADDR_LONG };",
          "501:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA | IEEE802154_FCF_PAN_COMP,",
          "502:                             IEEE802154_FCF_DST_ADDR_SHORT | IEEE802154_FCF_SRC_ADDR_SHORT };",
          "509:     const uint8_t mhr[] = { IEEE802154_FCF_TYPE_DATA | IEEE802154_FCF_PAN_COMP,",
          "510:                             IEEE802154_FCF_DST_ADDR_LONG | IEEE802154_FCF_SRC_ADDR_LONG };",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4b23d93868a28edd8ebf2ff4ebe94540f2475008",
      "candidate_info": {
        "commit_hash": "4b23d93868a28edd8ebf2ff4ebe94540f2475008",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/4b23d93868a28edd8ebf2ff4ebe94540f2475008",
        "files": [
          "sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c"
        ],
        "message": "gnrc_netif_ieee802154: Ignore packets without source address\n\n(cherry picked from commit 17c70f7ee0b1445f2941f516f264ed4a096e82b7)",
        "before_after_code_files": [
          "sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c||sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/RIOT-OS/RIOT/pull/18820"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c||sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c": [
          "File: sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c -> sys/net/gnrc/netif/ieee802154/gnrc_netif_ieee802154.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:     dst_len = ieee802154_get_dst(mhr, dst, &_pan_tmp);",
          "56:     src_len = ieee802154_get_src(mhr, src, &_pan_tmp);",
          "58:         DEBUG(\"_make_netif_hdr: unable to get addresses\\n\");",
          "59:         return NULL;",
          "60:     }",
          "",
          "[Removed Lines]",
          "57:     if ((dst_len < 0) || (src_len < 0)) {",
          "",
          "[Added Lines]",
          "57:     if ((dst_len < 0) || (src_len <= 0)) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dafc397fdc3655aeb5c7b9963a43f1604c6a2062",
      "candidate_info": {
        "commit_hash": "dafc397fdc3655aeb5c7b9963a43f1604c6a2062",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/dafc397fdc3655aeb5c7b9963a43f1604c6a2062",
        "files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ],
        "message": "gnrc_sixlowpan_iphc: fix packet type confusion in _iphc_encode()\n\n(cherry picked from commit 4a081f86616cb5c9dd0b5d7b286da03285d1652a)",
        "before_after_code_files": [
          "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/RIOT-OS/RIOT/pull/18820"
        ],
        "olp_code_files": {
          "patch": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ],
          "candidate": [
            "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c"
          ]
        }
      },
      "candidate_diff": {
        "sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c||sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c": [
          "File: sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c -> sys/net/gnrc/network_layer/sixlowpan/iphc/gnrc_sixlowpan_iphc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1613:         else {",
          "1614:             dispatch->next = ptr;",
          "1615:         }",
          "1627:         ptr = ptr->next;",
          "1628:     }",
          "",
          "[Removed Lines]",
          "1616:         if (ptr->type == GNRC_NETTYPE_UNDEF) {",
          "1619:             dispatch_size += sizeof(udp_hdr_t);",
          "1620:             break;  /* nothing special after UDP so quit even if more UNDEF",
          "1622:         }",
          "1623:         else {",
          "1624:             dispatch_size += ptr->size;",
          "1625:         }",
          "",
          "[Added Lines]",
          "1616:         dispatch_size += ptr->size;",
          "",
          "---------------"
        ]
      }
    }
  ]
}