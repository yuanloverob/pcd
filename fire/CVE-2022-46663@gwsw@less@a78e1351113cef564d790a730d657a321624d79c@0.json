{
  "cve_id": "CVE-2022-46663",
  "cve_desc": "In GNU Less before 609, crafted data can result in \"less -R\" not filtering ANSI escape sequences sent to the terminal.",
  "repo": "gwsw/less",
  "patch_hash": "a78e1351113cef564d790a730d657a321624d79c",
  "patch_info": {
    "commit_hash": "a78e1351113cef564d790a730d657a321624d79c",
    "repo": "gwsw/less",
    "commit_url": "https://github.com/gwsw/less/commit/a78e1351113cef564d790a730d657a321624d79c",
    "files": [
      "line.c"
    ],
    "message": "End OSC8 hyperlink on invalid embedded escape sequence.",
    "before_after_code_files": [
      "line.c||line.c"
    ]
  },
  "patch_diff": {
    "line.c||line.c": [
      "File: line.c -> line.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "634:   if (ch == '\\7')",
      "635:    return ANSI_END;",
      "638:   pansi->prev_esc = (ch == ESC);",
      "639:   return ANSI_MID;",
      "640:  }",
      "",
      "[Removed Lines]",
      "636:   if (pansi->prev_esc && ch == '\\\\')",
      "637:    return ANSI_END;",
      "",
      "[Added Lines]",
      "636:   if (pansi->prev_esc)",
      "637:             return (ch == '\\\\') ? ANSI_END : ANSI_ERR;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "375fad2609eda03446661f3b95ae5f31bca65932",
      "candidate_info": {
        "commit_hash": "375fad2609eda03446661f3b95ae5f31bca65932",
        "repo": "gwsw/less",
        "commit_url": "https://github.com/gwsw/less/commit/375fad2609eda03446661f3b95ae5f31bca65932",
        "files": [
          "line.c"
        ],
        "message": "Whitespace.",
        "before_after_code_files": [
          "line.c||line.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "line.c||line.c"
          ],
          "candidate": [
            "line.c||line.c"
          ]
        }
      },
      "candidate_diff": {
        "line.c||line.c": [
          "File: line.c -> line.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "634:   if (ch == '\\7')",
          "635:    return ANSI_END;",
          "636:   if (pansi->prev_esc)",
          "638:   pansi->prev_esc = (ch == ESC);",
          "639:   return ANSI_MID;",
          "640:  }",
          "",
          "[Removed Lines]",
          "637:             return (ch == '\\\\') ? ANSI_END : ANSI_ERR;",
          "",
          "[Added Lines]",
          "637:    return (ch == '\\\\') ? ANSI_END : ANSI_ERR;",
          "",
          "---------------"
        ]
      }
    }
  ]
}