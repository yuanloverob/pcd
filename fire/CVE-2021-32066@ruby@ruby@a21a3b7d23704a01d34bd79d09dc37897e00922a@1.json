{
  "cve_id": "CVE-2021-32066",
  "cve_desc": "An issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through 3.0.1. Net::IMAP does not raise an exception when StartTLS fails with an an unknown response, which might allow man-in-the-middle attackers to bypass the TLS protections by leveraging a network position between the client and the registry to block the StartTLS command, aka a \"StartTLS stripping attack.\"",
  "repo": "ruby/ruby",
  "patch_hash": "a21a3b7d23704a01d34bd79d09dc37897e00922a",
  "patch_info": {
    "commit_hash": "a21a3b7d23704a01d34bd79d09dc37897e00922a",
    "repo": "ruby/ruby",
    "commit_url": "https://github.com/ruby/ruby/commit/a21a3b7d23704a01d34bd79d09dc37897e00922a",
    "files": [
      "lib/net/imap.rb",
      "test/net/imap/test_imap.rb",
      "version.h"
    ],
    "message": "Fix StartTLS stripping vulnerability\n\nReported by Alexandr Savca in https://hackerone.com/reports/1178562\n\nCo-authored-by: Shugo Maeda <shugo@ruby-lang.org>",
    "before_after_code_files": [
      "lib/net/imap.rb||lib/net/imap.rb",
      "test/net/imap/test_imap.rb||test/net/imap/test_imap.rb",
      "version.h||version.h"
    ]
  },
  "patch_diff": {
    "lib/net/imap.rb||lib/net/imap.rb": [
      "File: lib/net/imap.rb -> lib/net/imap.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "1216:       end",
      "1217:       resp = @tagged_responses.delete(tag)",
      "1218:       case resp.name",
      "1219:       when /\\A(?:NO)\\z/ni",
      "1220:         raise NoResponseError, resp",
      "1221:       when /\\A(?:BAD)\\z/ni",
      "1222:         raise BadResponseError, resp",
      "1223:       else",
      "1225:       end",
      "1226:     end",
      "",
      "[Removed Lines]",
      "1224:         return resp",
      "",
      "[Added Lines]",
      "1219:       when /\\A(?:OK)\\z/ni",
      "1220:         return resp",
      "1226:         raise UnknownResponseError, resp",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "3717:     class ByeResponseError < ResponseError",
      "3718:     end",
      "3720:     RESPONSE_ERRORS = Hash.new(ResponseError)",
      "3721:     RESPONSE_ERRORS[\"NO\"] = NoResponseError",
      "3722:     RESPONSE_ERRORS[\"BAD\"] = BadResponseError",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3722:     # Error raised upon an unknown response from the server.",
      "3723:     class UnknownResponseError < ResponseError",
      "3724:     end",
      "",
      "---------------"
    ],
    "test/net/imap/test_imap.rb||test/net/imap/test_imap.rb": [
      "File: test/net/imap/test_imap.rb -> test/net/imap/test_imap.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "127:         imap.disconnect",
      "128:       end",
      "129:     end",
      "130:   end",
      "132:   def start_server",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "131:     def test_starttls_stripping",
      "132:       starttls_stripping_test do |port|",
      "133:         imap = Net::IMAP.new(\"localhost\", :port => port)",
      "134:         assert_raise(Net::IMAP::UnknownResponseError) do",
      "135:           imap.starttls(:ca_file => CA_FILE)",
      "136:         end",
      "137:         imap",
      "138:       end",
      "139:     end",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "784:     end",
      "785:   end",
      "787:   def create_tcp_server",
      "788:     return TCPServer.new(server_addr, 0)",
      "789:   end",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "797:   def starttls_stripping_test",
      "798:     server = create_tcp_server",
      "799:     port = server.addr[1]",
      "800:     start_server do",
      "801:       sock = server.accept",
      "802:       begin",
      "803:         sock.print(\"* OK test server\\r\\n\")",
      "804:         sock.gets",
      "805:         sock.print(\"RUBY0001 BUG unhandled command\\r\\n\")",
      "806:       ensure",
      "807:         sock.close",
      "808:         server.close",
      "809:       end",
      "810:     end",
      "811:     begin",
      "812:       imap = yield(port)",
      "813:     ensure",
      "814:       imap.disconnect if imap && !imap.disconnected?",
      "815:     end",
      "816:   end",
      "",
      "---------------"
    ],
    "version.h||version.h": [
      "File: version.h -> version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
      "3: #define RUBY_VERSION_TEENY 4",
      "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
      "7: #define RUBY_RELEASE_YEAR 2021",
      "8: #define RUBY_RELEASE_MONTH 7",
      "",
      "[Removed Lines]",
      "5: #define RUBY_PATCHLEVEL 190",
      "",
      "[Added Lines]",
      "5: #define RUBY_PATCHLEVEL 191",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "334ca2dc06931ec7da93787635a00ec0f1aad086",
      "candidate_info": {
        "commit_hash": "334ca2dc06931ec7da93787635a00ec0f1aad086",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/334ca2dc06931ec7da93787635a00ec0f1aad086",
        "files": [
          "st.c",
          "test/ruby/test_hash.rb",
          "version.h"
        ],
        "message": "merge revision(s) 496591de96b261b8789332c7f8b2bfbd17658955: [Backport #18578]\n\n    st.c: Do not clear entries_bound when calling Hash#shift for empty\n     hash\n\n    tab->entries_bound is used to check if the bins are full in\n    rebuild_table_if_necessary.\n\n    Hash#shift against an empty hash assigned 0 to tab->entries_bound, but\n    didn't clear the bins. Thus, the table is not rebuilt even when the bins\n    are full. Attempting to add a new element into full-bin hash gets stuck.\n\n    This change stops clearing tab->entries_bound in Hash#shift.\n    [Bug #18578]\n    ---\n     st.c                   |  1 -\n     test/ruby/test_hash.rb | 13 +++++++++++++\n     2 files changed, 13 insertions(+), 1 deletion(-)",
        "before_after_code_files": [
          "st.c||st.c",
          "test/ruby/test_hash.rb||test/ruby/test_hash.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "st.c||st.c": [
          "File: st.c -> st.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1486:  }",
          "1487:     }",
          "1488:     st_assert(tab->num_entries == 0);",
          "1490:     if (value != 0) *value = 0;",
          "1491:     return 0;",
          "1492: }",
          "",
          "[Removed Lines]",
          "1489:     tab->entries_start = tab->entries_bound = 0;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/ruby/test_hash.rb||test/ruby/test_hash.rb": [
          "File: test/ruby/test_hash.rb -> test/ruby/test_hash.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "983:     assert_equal(\"FOO\", h.shift)",
          "984:   end",
          "986:   def test_reject_bang2",
          "987:     assert_equal({1=>2}, @cls[1=>2,3=>4].reject! {|k, v| k + v == 7 })",
          "988:     assert_nil(@cls[1=>2,3=>4].reject! {|k, v| k == 5 })",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "986:   def test_shift_for_empty_hash",
          "987:     # [ruby-dev:51159]",
          "988:     h = @cls[]",
          "989:     100.times{|n|",
          "990:       while h.size < n",
          "991:         k = Random.rand 0..1<<30",
          "992:         h[k] = 1",
          "993:       end",
          "994:       0 while h.shift",
          "995:       assert_equal({}, h)",
          "996:     }",
          "997:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
          "3: #define RUBY_VERSION_TEENY 6",
          "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
          "7: #define RUBY_RELEASE_YEAR 2022",
          "8: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "5: #define RUBY_PATCHLEVEL 217",
          "",
          "[Added Lines]",
          "5: #define RUBY_PATCHLEVEL 218",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b829811131ec7741ce701ff8a8b101604fb0d595",
      "candidate_info": {
        "commit_hash": "b829811131ec7741ce701ff8a8b101604fb0d595",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/b829811131ec7741ce701ff8a8b101604fb0d595",
        "files": [
          "version.h",
          "win32/Makefile.sub"
        ],
        "message": "merge revision(s) 43a3c88187dcd54ba008834a865e50eb28a78de9: [Backport #18372]\n\n\t[win32] get rid of redefinition of reserved macro\n\n\t```\n\twarning C4117: macro name '_INTEGRAL_MAX_BITS' is reserved, '#define' ignored\n\t```\n\t---\n\t win32/Makefile.sub | 2 ++\n\t 1 file changed, 2 insertions(+)",
        "before_after_code_files": [
          "version.h||version.h",
          "win32/Makefile.sub||win32/Makefile.sub"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
          "3: #define RUBY_VERSION_TEENY 6",
          "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
          "7: #define RUBY_RELEASE_YEAR 2021",
          "8: #define RUBY_RELEASE_MONTH 12",
          "",
          "[Removed Lines]",
          "5: #define RUBY_PATCHLEVEL 204",
          "",
          "[Added Lines]",
          "5: #define RUBY_PATCHLEVEL 205",
          "",
          "---------------"
        ],
        "win32/Makefile.sub||win32/Makefile.sub": [
          "File: win32/Makefile.sub -> win32/Makefile.sub",
          "--- Hunk 1 ---",
          "[Context before]",
          "635: #define SIZEOF_LONG_LONG 0",
          "636: !endif",
          "637: #define SIZEOF___INT64 8",
          "638: #define _INTEGRAL_MAX_BITS 64",
          "639: !if $(LARGEFILE_SUPPORT)",
          "640: #define SIZEOF_OFF_T 8",
          "641: !else",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "638: #ifndef _INTEGRAL_MAX_BITS",
          "640: #endif",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "426266af2cbfba8d42a82abcce1bb3ca6c039e87",
      "candidate_info": {
        "commit_hash": "426266af2cbfba8d42a82abcce1bb3ca6c039e87",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/426266af2cbfba8d42a82abcce1bb3ca6c039e87",
        "files": [
          "io.c",
          "test/ruby/test_io.rb",
          "version.h"
        ],
        "message": "merge revision(s) fdf39963490cf2cf95b30d91bb9b35964c2c2350: [Backport #18421]\n\n\tEmpty and return the buffer if zero size is given [Bug #18421]\n\n\tIn `IO#readpartial` and `IO#read_nonblock`, as well as `IO#read`.\n\t---\n\t io.c                 |  8 ++++++--\n\t test/ruby/test_io.rb | 21 +++++++++++++++++++++\n\t 2 files changed, 27 insertions(+), 2 deletions(-)",
        "before_after_code_files": [
          "io.c||io.c",
          "test/ruby/test_io.rb||test/ruby/test_io.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "io.c||io.c": [
          "File: io.c -> io.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2822:     GetOpenFile(io, fptr);",
          "2823:     rb_io_check_byte_readable(fptr);",
          "2826:  return str;",
          "2828:     if (!nonblock)",
          "2829:         READ_CHECK(fptr);",
          "",
          "[Removed Lines]",
          "2825:     if (len == 0)",
          "",
          "[Added Lines]",
          "2825:     if (len == 0) {",
          "2826:  io_set_read_length(str, 0, shrinkable);",
          "2828:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2965:     GetOpenFile(io, fptr);",
          "2966:     rb_io_check_byte_readable(fptr);",
          "2969:  return str;",
          "2971:     n = read_buffered_data(RSTRING_PTR(str), len, fptr);",
          "2972:     if (n <= 0) {",
          "",
          "[Removed Lines]",
          "2968:     if (len == 0)",
          "",
          "[Added Lines]",
          "2970:     if (len == 0) {",
          "2971:  io_set_read_length(str, 0, shrinkable);",
          "2973:     }",
          "",
          "---------------"
        ],
        "test/ruby/test_io.rb||test/ruby/test_io.rb": [
          "File: test/ruby/test_io.rb -> test/ruby/test_io.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "1446:     end)",
          "1447:   end",
          "1449:   def test_readpartial_buffer_error",
          "1450:     with_pipe do |r, w|",
          "1451:       s = \"\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1449:   def test_readpartial_zero_size",
          "1450:     File.open(IO::NULL) do |r|",
          "1451:       assert_empty(r.readpartial(0, s = \"01234567\"))",
          "1452:       assert_empty(s)",
          "1453:     end",
          "1454:   end",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1491:     end)",
          "1492:   end",
          "1494:   def test_read_buffer_error",
          "1495:     with_pipe do |r, w|",
          "1496:       s = \"\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1501:   def test_read_zero_size",
          "1502:     File.open(IO::NULL) do |r|",
          "1503:       assert_empty(r.read(0, s = \"01234567\"))",
          "1504:       assert_empty(s)",
          "1505:     end",
          "1506:   end",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1528:     }",
          "1529:   end",
          "1531:   def test_write_nonblock_simple_no_exceptions",
          "1532:     pipe(proc do |w|",
          "1533:       w.write_nonblock('1', exception: false)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1545:   def test_read_nonblock_zero_size",
          "1546:     File.open(IO::NULL) do |r|",
          "1547:       assert_empty(r.read_nonblock(0, s = \"01234567\"))",
          "1548:       assert_empty(s)",
          "1549:     end",
          "1550:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
          "3: #define RUBY_VERSION_TEENY 6",
          "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
          "7: #define RUBY_RELEASE_YEAR 2021",
          "8: #define RUBY_RELEASE_MONTH 12",
          "",
          "[Removed Lines]",
          "5: #define RUBY_PATCHLEVEL 206",
          "",
          "[Added Lines]",
          "5: #define RUBY_PATCHLEVEL 207",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c24f436c2a4b343f9cb4950260376546f5ff0d06",
      "candidate_info": {
        "commit_hash": "c24f436c2a4b343f9cb4950260376546f5ff0d06",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/c24f436c2a4b343f9cb4950260376546f5ff0d06",
        "files": [
          "mjit_worker.c",
          "version.h"
        ],
        "message": "merge revision(s) 9f8a50723f8a84b3e4755b418570148f422d1b28: [Backport #17836]\n\n\tSpecify -c to emit pch with clang (#4423)\n\n\t[Bug #17836]\n\t---\n\t mjit_worker.c | 1 +\n\t 1 file changed, 1 insertion(+)",
        "before_after_code_files": [
          "mjit_worker.c||mjit_worker.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "mjit_worker.c||mjit_worker.c": [
          "File: mjit_worker.c -> mjit_worker.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "752:     const char *rest_args[] = {",
          "753: # ifdef __clang__",
          "754:         \"-emit-pch\",",
          "755: # endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "755:         \"-c\",",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # define RUBY_VERSION_MAJOR RUBY_API_VERSION_MAJOR",
          "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
          "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
          "7: #define RUBY_RELEASE_YEAR 2021",
          "11: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "3: #define RUBY_VERSION_TEENY 5",
          "5: #define RUBY_PATCHLEVEL 203",
          "8: #define RUBY_RELEASE_MONTH 11",
          "9: #define RUBY_RELEASE_DAY 24",
          "",
          "[Added Lines]",
          "3: #define RUBY_VERSION_TEENY 6",
          "5: #define RUBY_PATCHLEVEL 204",
          "8: #define RUBY_RELEASE_MONTH 12",
          "9: #define RUBY_RELEASE_DAY 31",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d55426f800546cbc3b333ae7ab98c1893f710612",
      "candidate_info": {
        "commit_hash": "d55426f800546cbc3b333ae7ab98c1893f710612",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/d55426f800546cbc3b333ae7ab98c1893f710612",
        "files": [
          "string.c",
          "test/ruby/test_string.rb",
          "version.h"
        ],
        "message": "merge revision(s) 5d815542815fe8b939239750bba7f8f0b79c97d6: [Backport #18154]\n\n\t[Bug #18154] Fix memory leak in String#initialize\n\n\tString#initialize can leak memory when called on a string that is marked\n\twith STR_NOFREE because it does not unset the STR_NOFREE flag.\n\t---\n\t string.c                 |  2 +-\n\t test/ruby/test_string.rb | 10 ++++++++++\n\t 2 files changed, 11 insertions(+), 1 deletion(-)",
        "before_after_code_files": [
          "string.c||string.c",
          "test/ruby/test_string.rb||test/ruby/test_string.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "string.c||string.c": [
          "File: string.c -> string.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1594:                 const size_t osize = RSTRING(str)->as.heap.len + TERM_LEN(str);",
          "1595:                 char *new_ptr = ALLOC_N(char, (size_t)capa + termlen);",
          "1596:                 memcpy(new_ptr, old_ptr, osize < size ? osize : size);",
          "1598:                 RSTRING(str)->as.heap.ptr = new_ptr;",
          "1599:      }",
          "1600:      else if (STR_HEAP_SIZE(str) != (size_t)capa + termlen) {",
          "",
          "[Removed Lines]",
          "1597:                 FL_UNSET_RAW(str, STR_SHARED);",
          "",
          "[Added Lines]",
          "1597:                 FL_UNSET_RAW(str, STR_SHARED|STR_NOFREE);",
          "",
          "---------------"
        ],
        "test/ruby/test_string.rb||test/ruby/test_string.rb": [
          "File: test/ruby/test_string.rb -> test/ruby/test_string.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "107: CODE",
          "108:   end",
          "110:   def test_AREF # '[]'",
          "111:     assert_equal(\"A\",  S(\"AooBar\")[0])",
          "112:     assert_equal(\"B\",  S(\"FooBaB\")[-1])",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "110:   # Bug #18154",
          "111:   def test_initialize_nofree_memory_leak",
          "112:     assert_no_memory_leak([], <<-PREP, <<-CODE, rss: true)",
          "113: code = proc {0.to_s.__send__(:initialize, capacity: 10000)}",
          "114: 1_000.times(&code)",
          "115: PREP",
          "116: 100_000.times(&code)",
          "117: CODE",
          "118:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: # define RUBY_VERSION_MINOR RUBY_API_VERSION_MINOR",
          "3: #define RUBY_VERSION_TEENY 5",
          "4: #define RUBY_RELEASE_DATE RUBY_RELEASE_YEAR_STR\"-\"RUBY_RELEASE_MONTH_STR\"-\"RUBY_RELEASE_DAY_STR",
          "7: #define RUBY_RELEASE_YEAR 2021",
          "8: #define RUBY_RELEASE_MONTH 11",
          "",
          "[Removed Lines]",
          "5: #define RUBY_PATCHLEVEL 196",
          "",
          "[Added Lines]",
          "5: #define RUBY_PATCHLEVEL 197",
          "",
          "---------------"
        ]
      }
    }
  ]
}