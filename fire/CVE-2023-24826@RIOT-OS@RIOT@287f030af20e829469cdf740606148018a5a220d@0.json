{
  "cve_id": "CVE-2023-24826",
  "cve_desc": "RIOT-OS, an operating system for Internet of Things (IoT) devices, contains a network stack with the ability to process 6LoWPAN frames. Prior to version 2023.04, an attacker can send crafted frames to the device to trigger the usage of an uninitialized object leading to denial of service. This issue is fixed in version 2023.04. As a workaround, disable fragment forwarding or SFR.",
  "repo": "RIOT-OS/RIOT",
  "patch_hash": "287f030af20e829469cdf740606148018a5a220d",
  "patch_info": {
    "commit_hash": "287f030af20e829469cdf740606148018a5a220d",
    "repo": "RIOT-OS/RIOT",
    "commit_url": "https://github.com/RIOT-OS/RIOT/commit/287f030af20e829469cdf740606148018a5a220d",
    "files": [
      "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
    ],
    "message": "Merge pull request from GHSA-xfj4-9g7w-f4gh\n\nfixes for CVE-2023-24826",
    "before_after_code_files": [
      "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
    ]
  },
  "patch_diff": {
    "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c": [
      "File: sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c -> sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "310: void gnrc_sixlowpan_frag_sfr_init(void)",
      "311: {",
      "312:     if (gnrc_sixlowpan_frag_sfr_congure_snd_has_inter_frame_gap()) {",
      "313:         for (unsigned i = 0; i < FRAME_QUEUE_POOL_SIZE; i++) {",
      "314:             clist_rpush(&_frame_queue_free, &_frame_queue_pool[i].super);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "313:     if (_arq_timer.callback == NULL) {",
      "314:         evtimer_init_msg(&_arq_timer);",
      "315:     }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "397:           _frag_seq(frag_desc), _frag_size(frag_desc),",
      "398:           frag_desc->offset);",
      "399:     if (_frag_ack_req(frag_desc)) {",
      "404:         _sched_arq_timeout(fbuf, fbuf->sfr.arq_timeout);",
      "405:     }",
      "",
      "[Removed Lines]",
      "401:         if (_arq_timer.callback == NULL) {",
      "402:             evtimer_init_msg(&_arq_timer);",
      "403:         }",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "41e7c28af09505dd9f0d2cdd88013af88bb305ee",
      "candidate_info": {
        "commit_hash": "41e7c28af09505dd9f0d2cdd88013af88bb305ee",
        "repo": "RIOT-OS/RIOT",
        "commit_url": "https://github.com/RIOT-OS/RIOT/commit/41e7c28af09505dd9f0d2cdd88013af88bb305ee",
        "files": [
          "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
        ],
        "message": "Merge pull request from GHSA-xfj4-9g7w-f4gh\n\nfixes for CVE-2023-24826",
        "before_after_code_files": [
          "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
          ],
          "candidate": [
            "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c"
          ]
        }
      },
      "candidate_diff": {
        "sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c||sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c": [
          "File: sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c -> sys/net/gnrc/network_layer/sixlowpan/frag/sfr/gnrc_sixlowpan_frag_sfr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "310: void gnrc_sixlowpan_frag_sfr_init(void)",
          "311: {",
          "312:     if (gnrc_sixlowpan_frag_sfr_congure_snd_has_inter_frame_gap()) {",
          "313:         for (unsigned i = 0; i < FRAME_QUEUE_POOL_SIZE; i++) {",
          "314:             clist_rpush(&_frame_queue_free, &_frame_queue_pool[i].super);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "313:     if (_arq_timer.callback == NULL) {",
          "314:         evtimer_init_msg(&_arq_timer);",
          "315:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "397:           _frag_seq(frag_desc), _frag_size(frag_desc),",
          "398:           frag_desc->offset);",
          "399:     if (_frag_ack_req(frag_desc)) {",
          "404:         _sched_arq_timeout(fbuf, fbuf->sfr.arq_timeout);",
          "405:     }",
          "",
          "[Removed Lines]",
          "401:         if (_arq_timer.callback == NULL) {",
          "402:             evtimer_init_msg(&_arq_timer);",
          "403:         }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}