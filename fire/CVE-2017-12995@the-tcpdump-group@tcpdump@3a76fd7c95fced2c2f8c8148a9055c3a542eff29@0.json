{
  "cve_id": "CVE-2017-12995",
  "cve_desc": "The DNS parser in tcpdump before 4.9.2 could enter an infinite loop due to a bug in print-domain.c:ns_print().",
  "repo": "the-tcpdump-group/tcpdump",
  "patch_hash": "3a76fd7c95fced2c2f8c8148a9055c3a542eff29",
  "patch_info": {
    "commit_hash": "3a76fd7c95fced2c2f8c8148a9055c3a542eff29",
    "repo": "the-tcpdump-group/tcpdump",
    "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/3a76fd7c95fced2c2f8c8148a9055c3a542eff29",
    "files": [
      "print-domain.c",
      "tests/TESTLIST",
      "tests/dns-zlip-1.out",
      "tests/dns-zlip-1.pcap",
      "tests/dns-zlip-2.out",
      "tests/dns-zlip-2.pcap",
      "tests/dns-zlip-3.out",
      "tests/dns-zlip-3.pcap",
      "tests/dns_fwdptr.out",
      "tests/dns_fwdptr.pcap"
    ],
    "message": "CVE-2017-12995/Check for DNS compression pointers that don't point backwards.\n\nThis is what BIND 9.11.0-P2 does; it not only detects pointers that\nloop, as \"point backwards\" means \"point before anything we've processed\nso far, including what we're processing right now\", so the pointer can't\npoint to itself (as that's what we're processing right now).\n\nThis fixes an infinite loop discovered by Forcepoint's security\nresearchers Otto Airamo & Antti Levom\u00e4ki.\n\nAdd a test using the capture file supplied by the reporter(s).\n\nAlso, add some infinite-pointer-loop captures.\n\nMore checks should be done.  We might, for example, want to make sure\nthe upper 2 bits of the label length/pointer byte are 00 or 11, and that\nif we encounter a pointer and jump backwards to what we think is a label\nthe label ends before the beginning of the last label we processed, to\nmake sure the pointer doesn't point backwards into the *middle* of a\nlabel, and also make sure the entire name is <= 255 bytes long.",
    "before_after_code_files": [
      "print-domain.c||print-domain.c"
    ]
  },
  "patch_diff": {
    "print-domain.c||print-domain.c": [
      "File: print-domain.c -> print-domain.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "151:  register u_int i, l;",
      "152:  register const u_char *rp = NULL;",
      "153:  register int compress = 0;",
      "155:  int elt;",
      "158:  if ((l = labellen(ndo, cp)) == (u_int)-1)",
      "159:   return(NULL);",
      "160:  if (!ND_TTEST2(*cp, 1))",
      "161:   return(NULL);",
      "163:  if (((i = *cp++) & INDIR_MASK) != INDIR_MASK) {",
      "164:   compress = 0;",
      "165:   rp = cp + l;",
      "",
      "[Removed Lines]",
      "154:  int chars_processed;",
      "156:  int data_size = ndo->ndo_snapend - bp;",
      "162:  chars_processed = 1;",
      "",
      "[Added Lines]",
      "155:  u_int offset, max_offset;",
      "161:  max_offset = (u_int)(cp - bp);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "174:     }",
      "175:     if (!ND_TTEST2(*cp, 1))",
      "176:      return(NULL);",
      "178:     if ((l = labellen(ndo, cp)) == (u_int)-1)",
      "179:      return(NULL);",
      "180:     if (!ND_TTEST2(*cp, 1))",
      "181:      return(NULL);",
      "182:     i = *cp++;",
      "195:     continue;",
      "196:    }",
      "197:    if ((i & INDIR_MASK) == EDNS0_MASK) {",
      "",
      "[Removed Lines]",
      "177:     cp = bp + (((i << 8) | *cp) & 0x3fff);",
      "183:     chars_processed++;",
      "191:     if (chars_processed >= data_size) {",
      "192:      ND_PRINT((ndo, \"<LOOP>\"));",
      "193:      return (NULL);",
      "194:     }",
      "",
      "[Added Lines]",
      "176:     offset = (((i << 8) | *cp) & 0x3fff);",
      "187:     if (offset >= max_offset) {",
      "188:      ND_PRINT((ndo, \"<BAD PTR>\"));",
      "189:      return(NULL);",
      "190:     }",
      "191:     max_offset = offset;",
      "192:     cp = bp + offset;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "212:    }",
      "214:    cp += l;",
      "216:    ND_PRINT((ndo, \".\"));",
      "217:    if ((l = labellen(ndo, cp)) == (u_int)-1)",
      "218:     return(NULL);",
      "219:    if (!ND_TTEST2(*cp, 1))",
      "220:     return(NULL);",
      "221:    i = *cp++;",
      "223:    if (!compress)",
      "224:     rp += l + 1;",
      "225:   }",
      "",
      "[Removed Lines]",
      "215:    chars_processed += l;",
      "222:    chars_processed++;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f411a05060610bd0a047cbae3f2a01db5628fa6c",
      "candidate_info": {
        "commit_hash": "f411a05060610bd0a047cbae3f2a01db5628fa6c",
        "repo": "the-tcpdump-group/tcpdump",
        "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/f411a05060610bd0a047cbae3f2a01db5628fa6c",
        "files": [
          "print-bgp.c",
          "print-bootp.c",
          "print-cfm.c",
          "print-dhcp6.c",
          "print-domain.c",
          "print-dvmrp.c",
          "print-fr.c",
          "print-geneve.c",
          "print-isoclns.c"
        ],
        "message": "More EXTRACT_8BITS() changes.  Use ND_CHECK_nBITS() more as well.",
        "before_after_code_files": [
          "print-bgp.c||print-bgp.c",
          "print-bootp.c||print-bootp.c",
          "print-cfm.c||print-cfm.c",
          "print-dhcp6.c||print-dhcp6.c",
          "print-domain.c||print-domain.c",
          "print-dvmrp.c||print-dvmrp.c",
          "print-fr.c||print-fr.c",
          "print-geneve.c||print-geneve.c",
          "print-isoclns.c||print-isoclns.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "print-domain.c||print-domain.c"
          ],
          "candidate": [
            "print-domain.c||print-domain.c"
          ]
        }
      },
      "candidate_diff": {
        "print-bgp.c||print-bgp.c": [
          "File: print-bgp.c -> print-bgp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "680:     total_length = 0;",
          "687:     ND_TCHECK2(pptr[0], (addr_length >> 3));",
          "",
          "[Removed Lines]",
          "683:     ND_TCHECK2(pptr[0], 1);",
          "684:     addr_length =  *pptr++;",
          "",
          "[Added Lines]",
          "683:     ND_TCHECK_8BITS(pptr);",
          "684:     addr_length = EXTRACT_8BITS(pptr);",
          "685:     pptr++;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "694:     }",
          "701:     ND_TCHECK2(pptr[0], (addr_length >> 3));",
          "",
          "[Removed Lines]",
          "697:     ND_TCHECK2(pptr[0], 1);",
          "698:     addr_length =  *pptr++;",
          "",
          "[Added Lines]",
          "698:     ND_TCHECK_8BITS(pptr);",
          "699:     addr_length = EXTRACT_8BITS(pptr);",
          "700:     pptr++;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "874:     ND_TCHECK(pptr[0]);",
          "878:  return -1;",
          "879:     pptr++;",
          "",
          "[Removed Lines]",
          "877:     if (*pptr != MDT_VPN_NLRI_LEN * 8)",
          "",
          "[Added Lines]",
          "879:     if (EXTRACT_8BITS(pptr) != MDT_VPN_NLRI_LEN * 8)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "928:         u_int offset;",
          "930:  ND_TCHECK2(pptr[0], 2);",
          "934:         snprintf(buf, buflen, \"Route-Type: %s (%u), length: %u\",",
          "935:                  tok2str(bgp_multicast_vpn_route_type_values,",
          "",
          "[Removed Lines]",
          "931:         route_type = *pptr++;",
          "932:         route_length = *pptr++;",
          "",
          "[Added Lines]",
          "933:         route_type = EXTRACT_8BITS(pptr);",
          "934:         pptr++;",
          "935:         route_length = EXTRACT_8BITS(pptr);",
          "936:         pptr++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1033: {",
          "1034:         int plen,tlen,stringlen,tlv_type,tlv_len,ttlv_len;",
          "1037:         plen=EXTRACT_BE_16BITS(pptr);",
          "1038:         tlen=plen;",
          "1039:         pptr+=2;",
          "",
          "[Removed Lines]",
          "1036:  ND_TCHECK2(pptr[0], 2);",
          "",
          "[Added Lines]",
          "1040:  ND_TCHECK_16BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1073:   if (tlen < 3)",
          "1074:       return -1;",
          "1075:   ND_TCHECK2(pptr[0], 3);",
          "1077:   tlv_len=EXTRACT_BE_16BITS(pptr);",
          "1078:   ttlv_len=tlv_len;",
          "1079:   pptr+=2;",
          "",
          "[Removed Lines]",
          "1076:   tlv_type=*pptr++;",
          "",
          "[Added Lines]",
          "1080:   tlv_type=EXTRACT_8BITS(pptr);",
          "1081:   pptr++;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1090:       while (ttlv_len>0) {",
          "1091:    ND_TCHECK(pptr[0]);",
          "1092:    if (buflen!=0) {",
          "1094:        UPDATE_BUF_BUFLEN(buf, buflen, stringlen);",
          "1095:    }",
          "1096:    ttlv_len--;",
          "",
          "[Removed Lines]",
          "1093:        stringlen=snprintf(buf,buflen, \"%02x\",*pptr++);",
          "",
          "[Added Lines]",
          "1098:        stringlen=snprintf(buf,buflen, \"%02x\",EXTRACT_8BITS(pptr));",
          "1099:        pptr++;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1452:   if (len != 4)",
          "1453:    ND_PRINT((ndo, \"invalid len\"));",
          "1454:   else {",
          "1456:    ND_PRINT((ndo, \"%u\", EXTRACT_BE_32BITS(tptr)));",
          "1457:   }",
          "1458:   break;",
          "",
          "[Removed Lines]",
          "1455:    ND_TCHECK2(tptr[0], 4);",
          "",
          "[Added Lines]",
          "1461:    ND_TCHECK_32BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1498:   }",
          "1499:   while (tlen>0) {",
          "1500:    uint32_t comm;",
          "1502:    comm = EXTRACT_BE_32BITS(tptr);",
          "1503:    switch (comm) {",
          "1504:    case BGP_COMMUNITY_NO_EXPORT:",
          "",
          "[Removed Lines]",
          "1501:    ND_TCHECK2(tptr[0], 4);",
          "",
          "[Added Lines]",
          "1507:    ND_TCHECK_32BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1546:  case BGPTYPE_MP_REACH_NLRI:",
          "1547:   ND_TCHECK2(tptr[0], 3);",
          "1548:   af = EXTRACT_BE_16BITS(tptr);",
          "1551:                 ND_PRINT((ndo, \"\\n\\t    AFI: %s (%u), %sSAFI: %s (%u)\",",
          "1552:                        tok2str(af_values, \"Unknown AFI\", af),",
          "",
          "[Removed Lines]",
          "1549:   safi = tptr[2];",
          "",
          "[Added Lines]",
          "1555:   safi = EXTRACT_8BITS(tptr + 2);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2058:                 while (tlen>0) {",
          "2059:                     uint16_t extd_comm;",
          "2062:                     extd_comm=EXTRACT_BE_16BITS(tptr);",
          "2064:       ND_PRINT((ndo, \"\\n\\t    %s (0x%04x), Flags [%s]\",",
          "",
          "[Removed Lines]",
          "2061:                     ND_TCHECK2(tptr[0], 2);",
          "",
          "[Added Lines]",
          "2067:                     ND_TCHECK_16BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2141:                 uint8_t tunnel_type, flags;",
          "2143:                 ND_TCHECK2(tptr[0], 5);",
          "2146:                 tlen = len;",
          "2148:                 ND_PRINT((ndo, \"\\n\\t    Tunnel-type %s (%u), Flags [%s], MPLS Label %u\",",
          "",
          "[Removed Lines]",
          "2144:                 tunnel_type = *(tptr+1);",
          "2145:                 flags = *tptr;",
          "",
          "[Added Lines]",
          "2150:                 flags = EXTRACT_8BITS(tptr);",
          "2151:                 tunnel_type = EXTRACT_8BITS(tptr+1);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "2206:       ND_TCHECK2(tptr[0], 3);",
          "2209:       length = EXTRACT_BE_16BITS(tptr + 1);",
          "2210:       tptr += 3;",
          "2211:       tlen -= 3;",
          "",
          "[Removed Lines]",
          "2208:       type = *tptr;",
          "",
          "[Added Lines]",
          "2214:       type = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "2244:   break;",
          "2245:  }",
          "2246:         case BGPTYPE_ATTR_SET:",
          "2248:                 if (len < 4)",
          "2249:                  goto trunc;",
          "2250:   ND_PRINT((ndo, \"\\n\\t    Origin AS: %s\",",
          "",
          "[Removed Lines]",
          "2247:                 ND_TCHECK2(tptr[0], 4);",
          "",
          "[Added Lines]",
          "2253:                 ND_TCHECK_32BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "2258:                     ND_TCHECK2(tptr[0], 2);",
          "2259:                     if (len < 2)",
          "2260:                         goto trunc;",
          "2263:                     tptr += 2;",
          "2264:                     len -= 2;",
          "2265:                     alenlen = bgp_attr_lenlen(aflags, tptr);",
          "",
          "[Removed Lines]",
          "2261:                     aflags = *tptr;",
          "2262:                     atype = *(tptr + 1);",
          "",
          "[Added Lines]",
          "2267:                     aflags = EXTRACT_8BITS(tptr);",
          "2268:                     atype = EXTRACT_8BITS(tptr + 1);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "2510:  length -= BGP_SIZE;",
          "2514:  if (length < 2)",
          "2515:   goto trunc;",
          "2516:  withdrawn_routes_len = EXTRACT_BE_16BITS(p);",
          "",
          "[Removed Lines]",
          "2513:  ND_TCHECK2(p[0], 2);",
          "",
          "[Added Lines]",
          "2519:  ND_TCHECK_16BITS(p);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2530:   length -= withdrawn_routes_len;",
          "2531:  }",
          "2534:  if (length < 2)",
          "2535:   goto trunc;",
          "2536:  len = EXTRACT_BE_16BITS(p);",
          "",
          "[Removed Lines]",
          "2533:  ND_TCHECK2(p[0], 2);",
          "",
          "[Added Lines]",
          "2539:  ND_TCHECK_16BITS(p);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2553:        goto trunc;",
          "2554:    if (length < 2)",
          "2555:        goto trunc;",
          "2558:    p += 2;",
          "2559:    len -= 2;",
          "2560:    length -= 2;",
          "",
          "[Removed Lines]",
          "2556:    aflags = *p;",
          "2557:    atype = *(p + 1);",
          "",
          "[Added Lines]",
          "2562:    aflags = EXTRACT_8BITS(p);",
          "2563:    atype = EXTRACT_8BITS(p + 1);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "2710:   bgpn.bgpn_minor == BGP_NOTIFY_MINOR_CEASE_RESET) &&",
          "2711:   length >= BGP_NOTIFICATION_SIZE + 1) {",
          "2712:       tptr = dat + BGP_NOTIFICATION_SIZE;",
          "2715:       remainder_offset = 0;",
          "2717:       if (shutdown_comm_length > BGP_NOTIFY_MINOR_CEASE_ADMIN_SHUTDOWN_LEN ||",
          "",
          "[Removed Lines]",
          "2713:       ND_TCHECK2(*tptr, 1);",
          "2714:       shutdown_comm_length = *(tptr);",
          "",
          "[Added Lines]",
          "2719:       ND_TCHECK_8BITS(tptr);",
          "2720:       shutdown_comm_length = EXTRACT_8BITS(tptr);",
          "",
          "---------------"
        ],
        "print-bootp.c||print-bootp.c": [
          "File: print-bootp.c -> print-bootp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "354:   ND_PRINT((ndo, \"\\n\\t  Client-Ethernet-Address %s\", etheraddr_string(ndo, bp->bp_chaddr)));",
          "355:  }",
          "359:   ND_PRINT((ndo, \"\\n\\t  sname \\\"\"));",
          "360:   if (fn_printztn(ndo, bp->bp_sname, (u_int)sizeof bp->bp_sname,",
          "361:       ndo->ndo_snapend)) {",
          "",
          "[Removed Lines]",
          "358:  if (*bp->bp_sname) {",
          "",
          "[Added Lines]",
          "358:  if (EXTRACT_8BITS(bp->bp_sname)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "365:   }",
          "366:   ND_PRINT((ndo, \"\\\"\"));",
          "367:  }",
          "370:   ND_PRINT((ndo, \"\\n\\t  file \\\"\"));",
          "371:   if (fn_printztn(ndo, bp->bp_file, (u_int)sizeof bp->bp_file,",
          "372:       ndo->ndo_snapend)) {",
          "",
          "[Removed Lines]",
          "369:  if (*bp->bp_file) {",
          "",
          "[Added Lines]",
          "369:  if (EXTRACT_8BITS(bp->bp_file)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "611:  bp += sizeof(int32_t);",
          "616:   if (tag == TAG_PAD && ndo->ndo_vflag < 3)",
          "617:    continue;",
          "618:   if (tag == TAG_END && ndo->ndo_vflag < 3)",
          "619:    return;",
          "620:   if (tag == TAG_EXTENDED_OPTION) {",
          "622:    tag = EXTRACT_BE_16BITS(bp + 1);",
          "",
          "[Removed Lines]",
          "614:  while (ND_TTEST2(*bp, 1)) {",
          "615:   tag = *bp++;",
          "621:    ND_TCHECK2(*(bp + 1), 2);",
          "",
          "[Added Lines]",
          "614:  while (ND_TTEST_8BITS(bp)) {",
          "615:   tag = EXTRACT_8BITS(bp);",
          "616:   bp++;",
          "622:    ND_TCHECK_16BITS(bp + 1);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "633:    len = 0;",
          "634:   else {",
          "638:   }",
          "640:   ND_PRINT((ndo, \"\\n\\t    %s Option %u, length %u%s\", cp, tag, len,",
          "",
          "[Removed Lines]",
          "636:    ND_TCHECK2(*bp, 1);",
          "637:    len = *bp++;",
          "",
          "[Added Lines]",
          "637:    ND_TCHECK_8BITS(bp);",
          "638:    len = EXTRACT_8BITS(bp);",
          "639:    bp++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "643:   if (tag == TAG_PAD && ndo->ndo_vflag > 2) {",
          "644:    u_int ntag = 1;",
          "646:     bp++;",
          "647:     ntag++;",
          "648:    }",
          "",
          "[Removed Lines]",
          "645:    while (ND_TTEST2(*bp, 1) && *bp == TAG_PAD) {",
          "",
          "[Added Lines]",
          "647:    while (ND_TTEST_8BITS(bp) &&",
          "648:        EXTRACT_8BITS(bp) == TAG_PAD) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "656:   }",
          "658:   if (tag == TAG_DHCP_MESSAGE && len == 1) {",
          "660:    ND_PRINT((ndo, \"%s\", tok2str(dhcp_msg_values, \"Unknown (%u)\", uc)));",
          "661:    continue;",
          "662:   }",
          "",
          "[Removed Lines]",
          "659:    uc = *bp++;",
          "",
          "[Added Lines]",
          "662:    uc = EXTRACT_8BITS(bp);",
          "663:    bp++;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "664:   if (tag == TAG_PARM_REQUEST) {",
          "665:    idx = 0;",
          "666:    while (len-- > 0) {",
          "668:     cp = tok2str(tag2str, \"?Option %u\", uc);",
          "669:     if (idx % 4 == 0)",
          "670:      ND_PRINT((ndo, \"\\n\\t      \"));",
          "",
          "[Removed Lines]",
          "667:     uc = *bp++;",
          "",
          "[Added Lines]",
          "671:     uc = EXTRACT_8BITS(bp);",
          "672:     bp++;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "769:   case 'B':",
          "771:    while (len > 0) {",
          "772:     if (!first)",
          "773:      ND_PRINT((ndo, \",\"));",
          "775:     case 0:",
          "776:      ND_PRINT((ndo, \"N\"));",
          "777:      break;",
          "",
          "[Removed Lines]",
          "774:     switch (*bp) {",
          "",
          "[Added Lines]",
          "777:     uint8_t bool_value;",
          "780:     bool_value = EXTRACT_8BITS(bp);",
          "781:     switch (bool_value) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "779:      ND_PRINT((ndo, \"Y\"));",
          "780:      break;",
          "781:     default:",
          "783:      break;",
          "784:     }",
          "785:     ++bp;",
          "",
          "[Removed Lines]",
          "782:      ND_PRINT((ndo, \"%u?\", *bp));",
          "",
          "[Added Lines]",
          "789:      ND_PRINT((ndo, \"%u?\", bool_value));",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "793:   default:",
          "795:    while (len > 0) {",
          "796:     if (!first)",
          "797:      ND_PRINT((ndo, c == 'x' ? \":\" : \".\"));",
          "798:     if (c == 'x')",
          "800:     else",
          "802:     ++bp;",
          "803:     --len;",
          "804:     first = 0;",
          "",
          "[Removed Lines]",
          "799:      ND_PRINT((ndo, \"%02x\", *bp));",
          "801:      ND_PRINT((ndo, \"%u\", *bp));",
          "",
          "[Added Lines]",
          "803:     uint8_t byte_value;",
          "806:     byte_value = EXTRACT_8BITS(bp);",
          "808:      ND_PRINT((ndo, \"%02x\", byte_value));",
          "810:      ND_PRINT((ndo, \"%u\", byte_value));",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "815:      ND_PRINT((ndo, \"ERROR: length < 1 bytes\"));",
          "816:      break;",
          "817:     }",
          "819:     --len;",
          "820:     ND_PRINT((ndo, \"%s\", tok2str(nbo2str, NULL, tag)));",
          "821:     break;",
          "",
          "[Removed Lines]",
          "818:     tag = *bp++;",
          "",
          "[Added Lines]",
          "827:     tag = EXTRACT_8BITS(bp);",
          "828:     ++bp;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "826:      ND_PRINT((ndo, \"ERROR: length < 1 bytes\"));",
          "827:      break;",
          "828:     }",
          "830:     --len;",
          "831:     ND_PRINT((ndo, \"%s\", tok2str(oo2str, NULL, tag)));",
          "832:     break;",
          "",
          "[Removed Lines]",
          "829:     tag = *bp++;",
          "",
          "[Added Lines]",
          "839:     tag = EXTRACT_8BITS(bp);",
          "840:     ++bp;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "839:      len = 0;",
          "840:      break;",
          "841:     }",
          "843:      ND_PRINT((ndo, \"[%s] \", client_fqdn_flags(EXTRACT_8BITS(bp))));",
          "844:     bp++;",
          "847:     bp += 2;",
          "848:     ND_PRINT((ndo, \"\\\"\"));",
          "849:     if (fn_printn(ndo, bp, len - 3, ndo->ndo_snapend)) {",
          "",
          "[Removed Lines]",
          "842:     if (*bp)",
          "845:     if (*bp || *(bp+1))",
          "846:      ND_PRINT((ndo, \"%u/%u \", *bp, *(bp+1)));",
          "",
          "[Added Lines]",
          "853:     if (EXTRACT_8BITS(bp))",
          "856:     if (EXTRACT_8BITS(bp) || EXTRACT_8BITS(bp+1))",
          "857:      ND_PRINT((ndo, \"%u/%u \", EXTRACT_8BITS(bp), EXTRACT_8BITS(bp+1)));",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "864:      ND_PRINT((ndo, \"ERROR: length < 1 bytes\"));",
          "865:      break;",
          "866:     }",
          "868:     len--;",
          "869:     if (type == 0) {",
          "870:      ND_PRINT((ndo, \"\\\"\"));",
          "",
          "[Removed Lines]",
          "867:     type = *bp++;",
          "",
          "[Added Lines]",
          "878:     type = EXTRACT_8BITS(bp);",
          "879:     bp++;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "881:      while (len > 0) {",
          "882:       if (!first)",
          "883:        ND_PRINT((ndo, \":\"));",
          "885:       ++bp;",
          "886:       --len;",
          "887:       first = 0;",
          "",
          "[Removed Lines]",
          "884:       ND_PRINT((ndo, \"%02x\", *bp));",
          "",
          "[Added Lines]",
          "896:       ND_PRINT((ndo, \"%02x\", EXTRACT_8BITS(bp)));",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "893:    case TAG_AGENT_CIRCUIT:",
          "894:     while (len >= 2) {",
          "897:      len -= 2;",
          "898:      if (suboptlen > len) {",
          "899:       ND_PRINT((ndo, \"\\n\\t      %s SubOption %u, length %u: length goes past end of option\",",
          "",
          "[Removed Lines]",
          "895:      subopt = *bp++;",
          "896:      suboptlen = *bp++;",
          "",
          "[Added Lines]",
          "907:      subopt = EXTRACT_8BITS(bp);",
          "908:      suboptlen = EXTRACT_8BITS(bp+1);",
          "909:      bp += 2;",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "941:     while (len > 0) {",
          "942:      if (!first)",
          "943:       ND_PRINT((ndo, \",\"));",
          "945:      len--;",
          "947:      if (mask_width > 32) {",
          "",
          "[Removed Lines]",
          "944:      mask_width = *bp++;",
          "",
          "[Added Lines]",
          "957:      mask_width = EXTRACT_8BITS(bp);",
          "958:      bp++;",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "965:       for (i = 0; i < significant_octets ; i++) {",
          "966:        if (i > 0)",
          "967:         ND_PRINT((ndo, \".\"));",
          "969:       }",
          "970:       for (i = significant_octets ; i < 4 ; i++)",
          "971:        ND_PRINT((ndo, \".0\"));",
          "",
          "[Removed Lines]",
          "968:        ND_PRINT((ndo, \"%d\", *bp++));",
          "",
          "[Added Lines]",
          "982:        ND_PRINT((ndo, \"%d\", EXTRACT_8BITS(bp)));",
          "983:        bp++;",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "992:      break;",
          "993:     }",
          "994:     while (len > 0) {",
          "996:      len--;",
          "997:      ND_PRINT((ndo, \"\\n\\t      \"));",
          "998:      ND_PRINT((ndo, \"instance#%u: \", suboptnumber));",
          "",
          "[Removed Lines]",
          "995:      suboptlen = *bp++;",
          "",
          "[Added Lines]",
          "1010:      suboptlen = EXTRACT_8BITS(bp);",
          "1011:      bp++;",
          "",
          "---------------"
        ],
        "print-cfm.c||print-cfm.c": [
          "File: print-cfm.c -> print-cfm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "232:         return hexdump;",
          "233:     }",
          "236:     ND_PRINT((ndo, \"\\n\\t  Network Address Type %s (%u)\",",
          "237:            tok2str(af_values, \"Unknown\", network_addr_type),",
          "238:            network_addr_type));",
          "",
          "[Removed Lines]",
          "235:     network_addr_type = *tptr;",
          "",
          "[Added Lines]",
          "235:     network_addr_type = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "567:             }",
          "568:             ND_PRINT((ndo, \", Status: %s (%u)\",",
          "569:                    tok2str(cfm_tlv_port_status_values, \"Unknown\", EXTRACT_8BITS(tptr)),",
          "571:             break;",
          "573:         case CFM_TLV_INTERFACE_STATUS:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "570:                    EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "577:             }",
          "578:             ND_PRINT((ndo, \", Status: %s (%u)\",",
          "579:                    tok2str(cfm_tlv_interface_status_values, \"Unknown\", EXTRACT_8BITS(tptr)),",
          "581:             break;",
          "583:         case CFM_TLV_PRIVATE:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "580:                    EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "610:             tptr++;",
          "611:             tlen--;",
          "612:             cfm_tlv_len--;",
          "",
          "[Removed Lines]",
          "609:             chassis_id_length = *tptr;",
          "",
          "[Added Lines]",
          "609:             chassis_id_length = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "621:                     ND_PRINT((ndo, \"\\n\\t  (TLV too short)\"));",
          "622:                     goto next_tlv;",
          "623:                 }",
          "625:                 cfm_tlv_len--;",
          "626:                 ND_PRINT((ndo, \"\\n\\t  Chassis-ID Type %s (%u), Chassis-ID length %u\",",
          "627:                        tok2str(cfm_tlv_senderid_chassisid_values,",
          "",
          "[Removed Lines]",
          "624:                 chassis_id_type = *tptr;",
          "",
          "[Added Lines]",
          "624:                 chassis_id_type = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "680:             }",
          "684:             tptr++;",
          "685:             tlen--;",
          "686:             cfm_tlv_len--;",
          "",
          "[Removed Lines]",
          "683:             mgmt_addr_length = *tptr;",
          "",
          "[Added Lines]",
          "683:             mgmt_addr_length = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "710:                 }",
          "714:                 tptr++;",
          "715:                 tlen--;",
          "716:                 cfm_tlv_len--;",
          "",
          "[Removed Lines]",
          "713:                 mgmt_addr_length = *tptr;",
          "",
          "[Added Lines]",
          "713:                 mgmt_addr_length = EXTRACT_8BITS(tptr);",
          "",
          "---------------"
        ],
        "print-dhcp6.c||print-dhcp6.c": [
          "File: print-dhcp6.c -> print-dhcp6.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "286:  uint16_t opttype;",
          "287:  size_t optlen;",
          "288:  uint8_t auth_proto;",
          "289:  u_int authinfolen, authrealmlen;",
          "292:  uint16_t subopt_code;",
          "293:  uint16_t subopt_len;",
          "295:  if (cp == ep)",
          "296:   return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "289:  uint8_t auth_alg;",
          "290:  uint8_t auth_rdm;",
          "296:  uint8_t dh6_reconf_type;",
          "297:  uint8_t dh6_lq_query_type;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "395:     break;",
          "396:    }",
          "397:    tp = (const u_char *)(dh6o + 1);",
          "399:    break;",
          "400:   case DH6OPT_ELAPSED_TIME:",
          "401:    if (optlen != 2) {",
          "",
          "[Removed Lines]",
          "398:    ND_PRINT((ndo, \" %d)\", *tp));",
          "",
          "[Added Lines]",
          "402:    ND_PRINT((ndo, \" %d)\", EXTRACT_8BITS(tp)));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "417:     break;",
          "418:    }",
          "419:    tp = (const u_char *)(dh6o + 1);",
          "421:    switch (auth_proto) {",
          "422:    case DH6OPT_AUTHPROTO_DELAYED:",
          "423:     ND_PRINT((ndo, \" proto: delayed\"));",
          "",
          "[Removed Lines]",
          "420:    auth_proto = *tp;",
          "",
          "[Added Lines]",
          "424:    auth_proto = EXTRACT_8BITS(tp);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "430:     break;",
          "431:    }",
          "432:    tp++;",
          "434:    case DH6OPT_AUTHALG_HMACMD5:",
          "436:     ND_PRINT((ndo, \", alg: HMAC-MD5\"));",
          "437:     break;",
          "438:    default:",
          "440:     break;",
          "441:    }",
          "442:    tp++;",
          "444:    case DH6OPT_AUTHRDM_MONOCOUNTER:",
          "445:     ND_PRINT((ndo, \", RDM: mono\"));",
          "446:     break;",
          "447:    default:",
          "449:     break;",
          "450:    }",
          "451:    tp++;",
          "",
          "[Removed Lines]",
          "433:    switch (*tp) {",
          "439:     ND_PRINT((ndo, \", alg: %d\", *tp));",
          "443:    switch (*tp) {",
          "448:     ND_PRINT((ndo, \", RDM: %d\", *tp));",
          "",
          "[Added Lines]",
          "437:    auth_alg = EXTRACT_8BITS(tp);",
          "438:    switch (auth_alg) {",
          "444:     ND_PRINT((ndo, \", alg: %d\", auth_alg));",
          "448:    auth_rdm = EXTRACT_8BITS(tp);",
          "449:    switch (auth_rdm) {",
          "454:     ND_PRINT((ndo, \", RDM: %d\", auth_rdm));",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "468:      ND_PRINT((ndo, \", realm: \"));",
          "469:     }",
          "470:     for (i = 0; i < authrealmlen; i++, tp++)",
          "472:     ND_PRINT((ndo, \", key ID: %08x\", EXTRACT_BE_32BITS(tp)));",
          "473:     tp += 4;",
          "474:     ND_PRINT((ndo, \", HMAC-MD5:\"));",
          "",
          "[Removed Lines]",
          "471:      ND_PRINT((ndo, \"%02x\", *tp));",
          "",
          "[Added Lines]",
          "477:      ND_PRINT((ndo, \"%02x\", EXTRACT_8BITS(tp)));",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "480:      ND_PRINT((ndo, \" ??\"));",
          "481:      break;",
          "482:     }",
          "484:     case DH6OPT_AUTHRECONFIG_KEY:",
          "485:      ND_PRINT((ndo, \" reconfig-key\"));",
          "486:      break;",
          "",
          "[Removed Lines]",
          "483:     switch (*tp++) {",
          "",
          "[Added Lines]",
          "489:     switch (EXTRACT_8BITS(tp)) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "491:      ND_PRINT((ndo, \" type: ??\"));",
          "492:      break;",
          "493:     }",
          "494:     ND_PRINT((ndo, \" value:\"));",
          "495:     for (i = 0; i < 4; i++, tp+= 4)",
          "496:      ND_PRINT((ndo, \" %08x\", EXTRACT_BE_32BITS(tp)));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "500:     tp++;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "523:     break;",
          "524:    }",
          "525:    tp = (const u_char *)(dh6o + 1);",
          "527:    case DH6_RENEW:",
          "528:     ND_PRINT((ndo, \" for renew)\"));",
          "529:     break;",
          "",
          "[Removed Lines]",
          "526:    switch (*tp) {",
          "",
          "[Added Lines]",
          "533:    dh6_reconf_type = EXTRACT_8BITS(tp);",
          "534:    switch (dh6_reconf_type) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "531:     ND_PRINT((ndo, \" for inf-req)\"));",
          "532:     break;",
          "533:    default:",
          "535:     break;",
          "536:    }",
          "537:    break;",
          "",
          "[Removed Lines]",
          "534:     ND_PRINT((ndo, \" for ?\\?\\?(%02x))\", *tp));",
          "",
          "[Added Lines]",
          "542:     ND_PRINT((ndo, \" for ?\\?\\?(%02x))\", dh6_reconf_type));",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "648:     break;",
          "649:    }",
          "650:    tp = (const u_char *)(dh6o + 1);",
          "652:    case 1:",
          "653:     ND_PRINT((ndo, \" by-address\"));",
          "654:     break;",
          "",
          "[Removed Lines]",
          "651:    switch (*tp) {",
          "",
          "[Added Lines]",
          "659:    dh6_lq_query_type = EXTRACT_8BITS(tp);",
          "660:    switch (dh6_lq_query_type) {",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "656:     ND_PRINT((ndo, \" by-clientID\"));",
          "657:     break;",
          "658:    default:",
          "660:     break;",
          "661:    }",
          "662:    ND_PRINT((ndo, \" %s\", ip6addr_string(ndo, &tp[1])));",
          "",
          "[Removed Lines]",
          "659:     ND_PRINT((ndo, \" type_%d\", (int)*tp));",
          "",
          "[Added Lines]",
          "668:     ND_PRINT((ndo, \" type_%d\", (int)dh6_lq_query_type));",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "733:    remain_len = optlen;",
          "734:    ND_PRINT((ndo, \" \"));",
          "738:     if (label_len < remain_len - 1) {",
          "739:      (void)fn_printn(ndo, tp, label_len, NULL);",
          "740:      tp += label_len;",
          "741:      remain_len -= (label_len + 1);",
          "743:     } else {",
          "744:      ND_PRINT((ndo, \" ?\"));",
          "745:      break;",
          "",
          "[Removed Lines]",
          "736:    while (remain_len && *tp) {",
          "737:     label_len =  *tp++;",
          "742:      if(*tp) ND_PRINT((ndo, \".\"));",
          "",
          "[Added Lines]",
          "745:    while (remain_len && EXTRACT_8BITS(tp)) {",
          "746:     label_len = EXTRACT_8BITS(tp);",
          "747:     tp++;",
          "752:      if(EXTRACT_8BITS(tp)) ND_PRINT((ndo, \".\"));",
          "",
          "---------------"
        ],
        "print-domain.c||print-domain.c": [
          "File: print-domain.c -> print-domain.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "56: {",
          "57:  register u_char i;",
          "60:   return (NULL);",
          "62:  while (i) {",
          "63:   if ((i & INDIR_MASK) == INDIR_MASK)",
          "64:    return (cp + 1);",
          "",
          "[Removed Lines]",
          "59:  if (!ND_TTEST2(*cp, 1))",
          "61:  i = *cp++;",
          "",
          "[Added Lines]",
          "59:  if (!ND_TTEST_8BITS(cp))",
          "61:  i = EXTRACT_8BITS(cp);",
          "62:  cp++;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "68:    if ((i & ~INDIR_MASK) != EDNS0_ELT_BITLABEL)",
          "71:     return (NULL);",
          "73:     bitlen = 256;",
          "74:    bytelen = (bitlen + 7) / 8;",
          "75:    cp += bytelen;",
          "76:   } else",
          "77:    cp += i;",
          "79:    return (NULL);",
          "81:  }",
          "82:  return (cp);",
          "83: }",
          "",
          "[Removed Lines]",
          "70:    if (!ND_TTEST2(*cp, 1))",
          "72:    if ((bitlen = *cp++) == 0)",
          "78:   if (!ND_TTEST2(*cp, 1))",
          "80:   i = *cp++;",
          "",
          "[Added Lines]",
          "71:    if (!ND_TTEST_8BITS(cp))",
          "73:    if ((bitlen = EXTRACT_8BITS(cp)) == 0)",
          "75:    cp++;",
          "80:   if (!ND_TTEST_8BITS(cp))",
          "82:   i = EXTRACT_8BITS(cp);",
          "83:   cp++;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "91:  const u_char *bitp, *lim;",
          "92:  char tc;",
          "95:   return(NULL);",
          "97:   bitlen = 256;",
          "98:  slen = (bitlen + 3) / 4;",
          "99:  lim = cp + 1 + slen;",
          "",
          "[Removed Lines]",
          "94:  if (!ND_TTEST2(*cp, 1))",
          "96:  if ((bitlen = *cp) == 0)",
          "",
          "[Added Lines]",
          "97:  if (!ND_TTEST_8BITS(cp))",
          "99:  if ((bitlen = EXTRACT_8BITS(cp)) == 0)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "106:  }",
          "107:  if (b > 4) {",
          "108:   ND_TCHECK(*bitp);",
          "110:   ND_PRINT((ndo, \"%02x\", tc & (0xff << (8 - b))));",
          "111:  } else if (b > 0) {",
          "112:   ND_TCHECK(*bitp);",
          "114:   ND_PRINT((ndo, \"%1x\", ((tc >> 4) & 0x0f) & (0x0f << (4 - b))));",
          "115:  }",
          "116:  ND_PRINT((ndo, \"/%d]\", bitlen));",
          "",
          "[Removed Lines]",
          "109:   tc = *bitp++;",
          "113:   tc = *bitp++;",
          "",
          "[Added Lines]",
          "112:   tc = EXTRACT_8BITS(bitp);",
          "113:   bitp++;",
          "117:   tc = EXTRACT_8BITS(bitp);",
          "118:   bitp++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "126: {",
          "127:  register u_int i;",
          "130:   return(-1);",
          "132:  if ((i & INDIR_MASK) == EDNS0_MASK) {",
          "133:   int bitlen, elt;",
          "134:   if ((elt = (i & ~INDIR_MASK)) != EDNS0_ELT_BITLABEL) {",
          "135:    ND_PRINT((ndo, \"<ELT %d>\", elt));",
          "136:    return(-1);",
          "137:   }",
          "139:    return(-1);",
          "141:    bitlen = 256;",
          "142:   return(((bitlen + 7) / 8) + 1);",
          "143:  } else",
          "",
          "[Removed Lines]",
          "129:  if (!ND_TTEST2(*cp, 1))",
          "131:  i = *cp;",
          "138:   if (!ND_TTEST2(*(cp + 1), 1))",
          "140:   if ((bitlen = *(cp + 1)) == 0)",
          "",
          "[Added Lines]",
          "134:  if (!ND_TTEST_8BITS(cp))",
          "136:  i = EXTRACT_8BITS(cp);",
          "143:   if (!ND_TTEST_8BITS(cp + 1))",
          "145:   if ((bitlen = EXTRACT_8BITS(cp + 1)) == 0)",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "157:  if ((l = labellen(ndo, cp)) == (u_int)-1)",
          "158:   return(NULL);",
          "160:   return(NULL);",
          "161:  max_offset = (u_int)(cp - bp);",
          "163:   compress = 0;",
          "164:   rp = cp + l;",
          "165:  }",
          "",
          "[Removed Lines]",
          "159:  if (!ND_TTEST2(*cp, 1))",
          "162:  if (((i = *cp++) & INDIR_MASK) != INDIR_MASK) {",
          "",
          "[Added Lines]",
          "164:  if (!ND_TTEST_8BITS(cp))",
          "167:  i = EXTRACT_8BITS(cp);",
          "168:  cp++;",
          "169:  if ((i & INDIR_MASK) != INDIR_MASK) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "171:      rp = cp + 1;",
          "172:      compress = 1;",
          "173:     }",
          "175:      return(NULL);",
          "",
          "[Removed Lines]",
          "174:     if (!ND_TTEST2(*cp, 1))",
          "176:     offset = (((i << 8) | *cp) & 0x3fff);",
          "",
          "[Added Lines]",
          "181:     if (!ND_TTEST_8BITS(cp))",
          "183:     offset = (((i << 8) | EXTRACT_8BITS(cp)) & 0x3fff);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "192:     cp = bp + offset;",
          "193:     if ((l = labellen(ndo, cp)) == (u_int)-1)",
          "194:      return(NULL);",
          "196:      return(NULL);",
          "198:     continue;",
          "199:    }",
          "200:    if ((i & INDIR_MASK) == EDNS0_MASK) {",
          "",
          "[Removed Lines]",
          "195:     if (!ND_TTEST2(*cp, 1))",
          "197:     i = *cp++;",
          "",
          "[Added Lines]",
          "202:     if (!ND_TTEST_8BITS(cp))",
          "204:     i = EXTRACT_8BITS(cp);",
          "205:     cp++;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "218:    ND_PRINT((ndo, \".\"));",
          "219:    if ((l = labellen(ndo, cp)) == (u_int)-1)",
          "220:     return(NULL);",
          "222:     return(NULL);",
          "224:    if (!compress)",
          "225:     rp += l + 1;",
          "226:   }",
          "",
          "[Removed Lines]",
          "221:    if (!ND_TTEST2(*cp, 1))",
          "223:    i = *cp++;",
          "",
          "[Added Lines]",
          "229:    if (!ND_TTEST_8BITS(cp))",
          "231:    i = EXTRACT_8BITS(cp);",
          "232:    cp++;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "236: {",
          "237:  register u_int i;",
          "240:   return (NULL);",
          "242:  if (fn_printn(ndo, cp, i, ndo->ndo_snapend))",
          "243:   return (NULL);",
          "244:  return (cp + i);",
          "",
          "[Removed Lines]",
          "239:  if (!ND_TTEST2(*cp, 1))",
          "241:  i = *cp++;",
          "",
          "[Added Lines]",
          "248:  if (!ND_TTEST_8BITS(cp))",
          "250:  i = EXTRACT_8BITS(cp);",
          "251:  cp++;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "502:   int pbit, pbyte;",
          "503:   char ntop_buf[INET6_ADDRSTRLEN];",
          "506:    return(NULL);",
          "508:   pbyte = (pbit & ~7) / 8;",
          "509:   if (pbit > 128) {",
          "510:    ND_PRINT((ndo, \" %u(bad plen)\", pbit));",
          "",
          "[Removed Lines]",
          "505:   if (!ND_TTEST2(*cp, 1))",
          "507:   pbit = *cp;",
          "",
          "[Added Lines]",
          "515:   if (!ND_TTEST_8BITS(cp))",
          "517:   pbit = EXTRACT_8BITS(cp);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "548:   if ((cp = ns_nprint(ndo, cp, bp)) == NULL)",
          "549:    return(NULL);",
          "550:   cp += 6;",
          "552:    return(NULL);",
          "553:   ND_PRINT((ndo, \" fudge=%u\", EXTRACT_BE_16BITS(cp)));",
          "554:   cp += 2;",
          "556:    return(NULL);",
          "557:   ND_PRINT((ndo, \" maclen=%u\", EXTRACT_BE_16BITS(cp)));",
          "558:   cp += 2 + EXTRACT_BE_16BITS(cp);",
          "560:    return(NULL);",
          "561:   ND_PRINT((ndo, \" origid=%u\", EXTRACT_BE_16BITS(cp)));",
          "562:   cp += 2;",
          "564:    return(NULL);",
          "565:   ND_PRINT((ndo, \" error=%u\", EXTRACT_BE_16BITS(cp)));",
          "566:   cp += 2;",
          "568:    return(NULL);",
          "569:   ND_PRINT((ndo, \" otherlen=%u\", EXTRACT_BE_16BITS(cp)));",
          "570:   cp += 2;",
          "",
          "[Removed Lines]",
          "551:   if (!ND_TTEST2(*cp, 2))",
          "555:   if (!ND_TTEST2(*cp, 2))",
          "559:   if (!ND_TTEST2(*cp, 2))",
          "563:   if (!ND_TTEST2(*cp, 2))",
          "567:   if (!ND_TTEST2(*cp, 2))",
          "",
          "[Added Lines]",
          "561:   if (!ND_TTEST_16BITS(cp))",
          "565:   if (!ND_TTEST_16BITS(cp))",
          "569:   if (!ND_TTEST_16BITS(cp))",
          "573:   if (!ND_TTEST_16BITS(cp))",
          "577:   if (!ND_TTEST_16BITS(cp))",
          "",
          "---------------"
        ],
        "print-dvmrp.c||print-dvmrp.c": [
          "File: print-dvmrp.c -> print-dvmrp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "197:    }",
          "198:    origin = 0;",
          "199:    for (i = 0; i < width; ++i) {",
          "202:    }",
          "203:    for ( ; i < 4; ++i)",
          "204:     origin <<= 8;",
          "208:    done = metric & 0x80;",
          "209:    metric &= 0x7f;",
          "210:    ND_PRINT((ndo, \"\\n\\t  %s metric %d\", intoa(htonl(origin)),",
          "",
          "[Removed Lines]",
          "200:     ND_TCHECK(*bp);",
          "201:     origin = origin << 8 | *bp++;",
          "206:    ND_TCHECK(*bp);",
          "207:    metric = *bp++;",
          "",
          "[Added Lines]",
          "200:     ND_TCHECK_8BITS(bp);",
          "201:     origin = origin << 8 | EXTRACT_8BITS(bp);",
          "202:     bp++;",
          "207:    ND_TCHECK_8BITS(bp);",
          "208:    metric = EXTRACT_8BITS(bp);",
          "209:    bp++;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "262:   ND_TCHECK2(bp[0], 7);",
          "263:   laddr = bp;",
          "264:   bp += 4;",
          "268:   len -= 7;",
          "269:   while (--ncount >= 0) {",
          "270:    ND_TCHECK2(bp[0], 4);",
          "",
          "[Removed Lines]",
          "265:   metric = *bp++;",
          "266:   thresh = *bp++;",
          "267:   ncount = *bp++;",
          "",
          "[Added Lines]",
          "267:   metric = EXTRACT_8BITS(bp);",
          "268:   bp++;",
          "269:   thresh = EXTRACT_8BITS(bp);",
          "270:   bp++;",
          "271:   ncount = EXTRACT_8BITS(bp);",
          "272:   bp++;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "297:   ND_TCHECK2(bp[0], 8);",
          "298:   laddr = bp;",
          "299:   bp += 4;",
          "304:   len -= 8;",
          "305:   while (--ncount >= 0 && (len >= 4) && (bp + 4) <= ep) {",
          "306:    ND_PRINT((ndo, \" [%s -> \", ipaddr_string(ndo, laddr)));",
          "",
          "[Removed Lines]",
          "300:   metric = *bp++;",
          "301:   thresh = *bp++;",
          "302:   flags = *bp++;",
          "303:   ncount = *bp++;",
          "",
          "[Added Lines]",
          "305:   metric = EXTRACT_8BITS(bp);",
          "306:   bp++;",
          "307:   thresh = EXTRACT_8BITS(bp);",
          "308:   bp++;",
          "309:   flags = EXTRACT_8BITS(bp);",
          "310:   bp++;",
          "311:   ncount = EXTRACT_8BITS(bp);",
          "312:   bp++;",
          "",
          "---------------"
        ],
        "print-fr.c||print-fr.c": [
          "File: print-fr.c -> print-fr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "102:                            const u_char *p, u_int *dlci,",
          "103:                            u_int *addr_len, uint8_t *flags, u_int length)",
          "104: {",
          "106:   return -1;",
          "108:   return 0;",
          "111:   return -1;",
          "118:         flags[3] = 0;",
          "123:  p += 2;",
          "124:  length -= 2;",
          "126:   return -1;",
          "131:   p++;",
          "132:   length--;",
          "133:  }",
          "136:   return -1;",
          "144:  return 1;",
          "145: }",
          "",
          "[Removed Lines]",
          "105:  if (!ND_TTEST(p[0]) || length < 1)",
          "107:  if ((p[0] & FR_EA_BIT))",
          "110:  if (!ND_TTEST(p[1]) || length < 2)",
          "116:         flags[1] = p[1] & 0x0c;",
          "120:  if (p[1] & FR_EA_BIT)",
          "125:  if (!ND_TTEST(p[0]) || length < 1)",
          "128:  if ((p[0] & FR_EA_BIT) == 0) {",
          "135:  if (!ND_TTEST(p[0]) || length < 1)",
          "137:  if ((p[0] & FR_EA_BIT) == 0)",
          "140:         flags[3] = p[0] & 0x02;",
          "",
          "[Added Lines]",
          "105:  if (!ND_TTEST_8BITS(p) || length < 1)",
          "107:  if ((EXTRACT_8BITS(p) & FR_EA_BIT))",
          "110:  if (!ND_TTEST_8BITS(p+1) || length < 2)",
          "116:         flags[1] = EXTRACT_8BITS(p+1) & 0x0c;",
          "120:  if (EXTRACT_8BITS(p+1) & FR_EA_BIT)",
          "125:  if (!ND_TTEST_8BITS(p) || length < 1)",
          "128:  if ((EXTRACT_8BITS(p) & FR_EA_BIT) == 0) {",
          "135:  if (!ND_TTEST_8BITS(p) || length < 1)",
          "137:  if ((EXTRACT_8BITS(p) & FR_EA_BIT) == 0)",
          "140:         flags[3] = EXTRACT_8BITS(p) & 0x02;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "253:   return 0;",
          "254:  }",
          "257:  if (length < addr_len + 1)",
          "258:   goto trunc;",
          "269:                 } else {",
          "270:                         extracted_ethertype = EXTRACT_BE_16BITS(p + addr_len);",
          "",
          "[Removed Lines]",
          "256:  ND_TCHECK(p[addr_len]);",
          "260:  if (p[addr_len] != LLC_UI && dlci != 0) {",
          "266:   if (!ND_TTEST2(p[addr_len], 2) || length < addr_len + 2) {",
          "268:                         ND_PRINT((ndo, \"UI %02x! \", p[addr_len]));",
          "",
          "[Added Lines]",
          "256:  ND_TCHECK_8BITS(p + addr_len);",
          "260:  if (EXTRACT_8BITS(p + addr_len) != LLC_UI && dlci != 0) {",
          "266:   if (!ND_TTEST_16BITS(p + addr_len) || length < addr_len + 2) {",
          "268:                         ND_PRINT((ndo, \"UI %02x! \", EXTRACT_8BITS(p + addr_len)));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "279:                                             ndo->ndo_snapend-p-addr_len-ETHERTYPE_LEN,",
          "280:                                             NULL, NULL) == 0)",
          "283:                         else",
          "284:                                 return addr_len + 2;",
          "285:                 }",
          "286:         }",
          "289:  if (length < addr_len + 2)",
          "290:   goto trunc;",
          "",
          "[Removed Lines]",
          "282:                                 ND_PRINT((ndo, \"UI %02x! \", p[addr_len]));",
          "288:  ND_TCHECK(p[addr_len+1]);",
          "292:  if (p[addr_len + 1] == 0) {",
          "",
          "[Added Lines]",
          "282:                                 ND_PRINT((ndo, \"UI %02x! \", EXTRACT_8BITS(p + addr_len)));",
          "288:  ND_TCHECK_8BITS(p + addr_len + 1);",
          "292:  if (EXTRACT_8BITS(p + addr_len + 1) == 0) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "307:   hdr_len = addr_len + 1 /* UI */ + 1 /* NLPID */;",
          "308:  }",
          "311:  if (length < hdr_len)",
          "312:   goto trunc;",
          "315:  if (ndo->ndo_eflag)",
          "316:   fr_hdr_print(ndo, length, addr_len, dlci, flags, nlpid);",
          "",
          "[Removed Lines]",
          "310:         ND_TCHECK(p[hdr_len - 1]);",
          "313:  nlpid = p[hdr_len - 1];",
          "",
          "[Added Lines]",
          "310:         ND_TCHECK_8BITS(p + hdr_len - 1);",
          "313:  nlpid = EXTRACT_8BITS(p + hdr_len - 1);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "462:         ND_PRINT((ndo, \"FRF.16 Control, Flags [%s], %s, length %u\",",
          "465:                length));",
          "466:         tptr = p + 3;",
          "467:         tlen = length -3;",
          "",
          "[Removed Lines]",
          "461:     if ((p[0] & MFR_BEC_MASK) == MFR_CTRL_FRAME && p[1] == 0) {",
          "463:                bittok2str(frf_flag_values,\"none\",(p[0] & MFR_BEC_MASK)),",
          "464:                tok2str(mfr_ctrl_msg_values,\"Unknown Message (0x%02x)\",p[2]),",
          "",
          "[Added Lines]",
          "461:     if ((EXTRACT_8BITS(p) & MFR_BEC_MASK) == MFR_CTRL_FRAME && EXTRACT_8BITS(p+1) == 0) {",
          "463:                bittok2str(frf_flag_values,\"none\",(EXTRACT_8BITS(p) & MFR_BEC_MASK)),",
          "464:                tok2str(mfr_ctrl_msg_values,\"Unknown Message (0x%02x)\",EXTRACT_8BITS(p+2)),",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "559:         ND_PRINT((ndo, \"FRF.16 Frag, seq %u, Flags [%s], \",",
          "560:                sequence_num,",
          "562:         hdr_len = 2;",
          "563:         fr_print(ndo, p+hdr_len,length-hdr_len);",
          "564:         return hdr_len;",
          "",
          "[Removed Lines]",
          "555:     sequence_num = (p[0]&0x1e)<<7 | p[1];",
          "557:     if ((p[0] & MFR_BEC_MASK) == MFR_FRAG_FRAME ||",
          "558:         (p[0] & MFR_BEC_MASK) == MFR_B_BIT) {",
          "561:                bittok2str(frf_flag_values,\"none\",(p[0] & MFR_BEC_MASK))));",
          "",
          "[Added Lines]",
          "555:     sequence_num = (EXTRACT_8BITS(p)&0x1e)<<7 | EXTRACT_8BITS(p+1);",
          "557:     if ((EXTRACT_8BITS(p) & MFR_BEC_MASK) == MFR_FRAG_FRAME ||",
          "558:         (EXTRACT_8BITS(p) & MFR_BEC_MASK) == MFR_B_BIT) {",
          "561:                bittok2str(frf_flag_values,\"none\",(EXTRACT_8BITS(p) & MFR_BEC_MASK))));",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "568:     ND_PRINT((ndo, \"FRF.16 Frag, seq %u, Flags [%s]\",",
          "569:            sequence_num,",
          "571:     print_unknown_data(ndo, p, \"\\n\\t\", length);",
          "573:     return hdr_len;",
          "",
          "[Removed Lines]",
          "570:            bittok2str(frf_flag_values,\"none\",(p[0] & MFR_BEC_MASK))));",
          "",
          "[Added Lines]",
          "570:            bittok2str(frf_flag_values,\"none\",(EXTRACT_8BITS(p) & MFR_BEC_MASK))));",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "604:         goto trunc;",
          "605:     ND_TCHECK2(*p, 2);",
          "610:     ND_PRINT((ndo, \"FRF.15, seq 0x%03x, Flags [%s],%s Fragmentation, length %u\",",
          "611:            sequence_num,",
          "612:            bittok2str(frf_flag_values,\"none\",flags),",
          "614:            length));",
          "",
          "[Removed Lines]",
          "607:     flags = p[0]&MFR_BEC_MASK;",
          "608:     sequence_num = (p[0]&0x1e)<<7 | p[1];",
          "613:            p[0]&FR_FRF15_FRAGTYPE ? \"Interface\" : \"End-to-End\",",
          "",
          "[Added Lines]",
          "607:     flags = EXTRACT_8BITS(p)&MFR_BEC_MASK;",
          "608:     sequence_num = (EXTRACT_8BITS(p)&0x1e)<<7 | EXTRACT_8BITS(p+1);",
          "613:            EXTRACT_8BITS(p)&FR_FRF15_FRAGTYPE ? \"Interface\" : \"End-to-End\",",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "817:  p++;",
          "818:  length--;",
          "",
          "[Removed Lines]",
          "816:  call_ref_length = (*p) & 0x0f;",
          "",
          "[Added Lines]",
          "816:  call_ref_length = EXTRACT_8BITS(p) & 0x0f;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "827:    ND_PRINT((ndo, \"length %u\", olen));",
          "828:    goto trunc;",
          "829:   }",
          "831:   p++;",
          "832:   length--;",
          "833:  }",
          "",
          "[Removed Lines]",
          "830:   call_ref[i] = *p;",
          "",
          "[Added Lines]",
          "830:   call_ref[i] = EXTRACT_8BITS(p);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "841:   ND_PRINT((ndo, \"length %u\", olen));",
          "842:   goto trunc;",
          "843:  }",
          "845:  p++;",
          "846:  length--;",
          "",
          "[Removed Lines]",
          "844:  msgtype = *p;",
          "",
          "[Added Lines]",
          "844:  msgtype = EXTRACT_8BITS(p);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "857:    ND_PRINT((ndo, \"length %u\", olen));",
          "858:    goto trunc;",
          "859:   }",
          "861:   if (IE_IS_SHIFT(iecode)) {",
          "",
          "[Removed Lines]",
          "860:   iecode = *p;",
          "",
          "[Added Lines]",
          "860:   iecode = EXTRACT_8BITS(p);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "907:  ND_PRINT((ndo, \"%s, codeset %u\", is_ansi ? \"ANSI\" : \"CCITT\", codeset));",
          "909:  if (call_ref_length != 0) {",
          "",
          "[Removed Lines]",
          "910:   ND_TCHECK(p[0]);",
          "911:   if (call_ref_length > 1 || p[0] != 0) {",
          "",
          "[Added Lines]",
          "910:   ND_TCHECK(EXTRACT_8BITS(p));",
          "911:   if (call_ref_length > 1 || EXTRACT_8BITS(p) != 0) {",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "958:    }",
          "959:    goto trunc;",
          "960:   }",
          "962:   p++;",
          "963:   length--;",
          "",
          "[Removed Lines]",
          "961:   iecode = *p;",
          "",
          "[Added Lines]",
          "961:   iecode = EXTRACT_8BITS(p);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1001:     }",
          "1002:     goto trunc;",
          "1003:    }",
          "1005:    p++;",
          "1006:    length--;",
          "",
          "[Removed Lines]",
          "1004:    ielength = *p;",
          "",
          "[Added Lines]",
          "1004:    ielength = EXTRACT_8BITS(p);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1083:             }",
          "1084:             if (ndo->ndo_vflag) {",
          "1085:                 ND_PRINT((ndo, \"%s (%u)\",",
          "1088:      }",
          "1089:             return 1;",
          "",
          "[Removed Lines]",
          "1086:                        tok2str(fr_lmi_report_type_ie_values,\"unknown\",p[0]),",
          "1087:                        p[0]));",
          "",
          "[Added Lines]",
          "1086:                        tok2str(fr_lmi_report_type_ie_values,\"unknown\",EXTRACT_8BITS(p)),",
          "1087:                        EXTRACT_8BITS(p)));",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1098:                 ND_PRINT((ndo, \"Invalid LINK VERIFY IE\"));",
          "1099:                 return 1;",
          "1100:             }",
          "1102:             return 1;",
          "",
          "[Removed Lines]",
          "1101:             ND_PRINT((ndo, \"TX Seq: %3d, RX Seq: %3d\", p[0], p[1]));",
          "",
          "[Added Lines]",
          "1101:             ND_PRINT((ndo, \"TX Seq: %3d, RX Seq: %3d\", EXTRACT_8BITS(p), EXTRACT_8BITS(p+1)));",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1108:      }",
          "1110:             if ((ielength < 3) ||",
          "1116:                 (ielength > 5) ||",
          "1118:                 ND_PRINT((ndo, \"Invalid DLCI in PVC STATUS IE\"));",
          "1119:                 return 1;",
          "1120:      }",
          "1123:             if (ielength == 4) {",
          "1125:      }",
          "1126:             else if (ielength == 5) {",
          "1128:      }",
          "1130:             ND_PRINT((ndo, \"DLCI %u: status %s%s\", dlci,",
          "1133:             return 1;",
          "1134:  }",
          "",
          "[Removed Lines]",
          "1111:                 (p[0] & 0x80) ||",
          "1112:                 ((ielength == 3) && !(p[1] & 0x80)) ||",
          "1113:                 ((ielength == 4) && ((p[1] & 0x80) || !(p[2] & 0x80))) ||",
          "1114:                 ((ielength == 5) && ((p[1] & 0x80) || (p[2] & 0x80) ||",
          "1115:                                    !(p[3] & 0x80))) ||",
          "1117:                 !(p[ielength - 1] & 0x80)) {",
          "1122:             dlci = ((p[0] & 0x3F) << 4) | ((p[1] & 0x78) >> 3);",
          "1124:                 dlci = (dlci << 6) | ((p[2] & 0x7E) >> 1);",
          "1127:                 dlci = (dlci << 13) | (p[2] & 0x7F) | ((p[3] & 0x7E) >> 1);",
          "1131:                     p[ielength - 1] & 0x8 ? \"New, \" : \"\",",
          "1132:                     p[ielength - 1] & 0x2 ? \"Active\" : \"Inactive\"));",
          "",
          "[Added Lines]",
          "1111:                 (EXTRACT_8BITS(p) & 0x80) ||",
          "1112:                 ((ielength == 3) && !(EXTRACT_8BITS(p+1) & 0x80)) ||",
          "1113:                 ((ielength == 4) &&",
          "1114:                   ((EXTRACT_8BITS(p+1) & 0x80) || !(EXTRACT_8BITS(p+2) & 0x80))) ||",
          "1115:                 ((ielength == 5) &&",
          "1116:                   ((EXTRACT_8BITS(p+1) & 0x80) || (EXTRACT_8BITS(p+2) & 0x80) ||",
          "1117:                    !(EXTRACT_8BITS(p+3) & 0x80))) ||",
          "1119:                 !(EXTRACT_8BITS(p + ielength - 1) & 0x80)) {",
          "1124:             dlci = ((EXTRACT_8BITS(p) & 0x3F) << 4) | ((EXTRACT_8BITS(p+1) & 0x78) >> 3);",
          "1126:                 dlci = (dlci << 6) | ((EXTRACT_8BITS(p+2) & 0x7E) >> 1);",
          "1129:                 dlci = (dlci << 13) | (EXTRACT_8BITS(p+2) & 0x7F) | ((EXTRACT_8BITS(p+3) & 0x7E) >> 1);",
          "1133:                     EXTRACT_8BITS(p + ielength - 1) & 0x8 ? \"New, \" : \"\",",
          "1134:                     EXTRACT_8BITS(p + ielength - 1) & 0x2 ? \"Active\" : \"Inactive\"));",
          "",
          "---------------"
        ],
        "print-geneve.c||print-geneve.c": [
          "File: print-geneve.c -> print-geneve.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "158:     ND_TCHECK2(*bp, 8);",
          "161:     bp += 1;",
          "162:     len -= 1;",
          "",
          "[Removed Lines]",
          "160:     ver_opt = *bp;",
          "",
          "[Added Lines]",
          "160:     ver_opt = EXTRACT_8BITS(bp);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167:         return;",
          "168:     }",
          "171:     bp += 1;",
          "172:     len -= 1;",
          "",
          "[Removed Lines]",
          "170:     flags = *bp;",
          "",
          "[Added Lines]",
          "170:     flags = EXTRACT_8BITS(bp);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "179:     bp += 3;",
          "180:     len -= 3;",
          "183:     bp += 1;",
          "184:     len -= 1;",
          "",
          "[Removed Lines]",
          "182:     reserved = *bp;",
          "",
          "[Added Lines]",
          "182:     reserved = EXTRACT_8BITS(bp);",
          "",
          "---------------"
        ],
        "print-isoclns.c||print-isoclns.c": [
          "File: print-isoclns.c -> print-isoclns.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "798:         if (li < sizeof(struct clnp_header_t)) {",
          "799:             ND_PRINT((ndo, \" length indicator %u < min PDU size:\", li));",
          "802:             return (0);",
          "803:         }",
          "",
          "[Removed Lines]",
          "800:             while (pptr < ndo->ndo_snapend)",
          "801:                 ND_PRINT((ndo, \"%02X\", *pptr++));",
          "",
          "[Added Lines]",
          "800:             while (pptr < ndo->ndo_snapend) {",
          "801:                 ND_PRINT((ndo, \"%02X\", EXTRACT_8BITS(pptr)));",
          "802:                 pptr++;",
          "803:             }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "815:             return (0);",
          "816:         }",
          "817:  ND_TCHECK(*pptr);",
          "819:         pptr += 1;",
          "820:         li -= 1;",
          "821:         if (li < dest_address_length) {",
          "",
          "[Removed Lines]",
          "818:         dest_address_length = *pptr;",
          "",
          "[Added Lines]",
          "820:         dest_address_length = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "832:             return (0);",
          "833:         }",
          "834:  ND_TCHECK(*pptr);",
          "836:         pptr += 1;",
          "837:         li -= 1;",
          "838:         if (li < source_address_length) {",
          "",
          "[Removed Lines]",
          "835:         source_address_length = *pptr;",
          "",
          "[Added Lines]",
          "837:         source_address_length = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "901:                 return (0);",
          "902:             }",
          "903:             ND_TCHECK2(*pptr, 2);",
          "906:             li -= 2;",
          "907:             if (opli > li) {",
          "908:                 ND_PRINT((ndo, \", opt (%d) too long\", op));",
          "",
          "[Removed Lines]",
          "904:             op = *pptr++;",
          "905:             opli = *pptr++;",
          "",
          "[Added Lines]",
          "906:             op = EXTRACT_8BITS(pptr);",
          "907:             opli = EXTRACT_8BITS(pptr + 1);",
          "908:             pptr += 2;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "938:                     ND_PRINT((ndo, \"%s %s\",",
          "939:                            tok2str(clnp_option_sr_rr_values,\"Unknown\",EXTRACT_8BITS(tptr)),",
          "940:                            tok2str(clnp_option_sr_rr_string_values, \"Unknown Option %u\", op)));",
          "942:                     if (nsap_offset == 0) {",
          "943:                             ND_PRINT((ndo, \" Bad NSAP offset (0)\"));",
          "944:                             break;",
          "",
          "[Removed Lines]",
          "941:                     nsap_offset=*(tptr+1);",
          "",
          "[Added Lines]",
          "944:                     nsap_offset=EXTRACT_8BITS(tptr+1);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "951:                     tptr+=nsap_offset;",
          "952:                     tlen-=nsap_offset;",
          "953:                     while (tlen > 0) {",
          "955:                             if (tlen < source_address_length+1) {",
          "956:                                     ND_PRINT((ndo, \"\\n\\t    NSAP address goes past end of option\"));",
          "957:                                     break;",
          "",
          "[Removed Lines]",
          "954:                             source_address_length=*tptr;",
          "",
          "[Added Lines]",
          "957:                             source_address_length=EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "972:                             ND_PRINT((ndo, \", bad opt len\"));",
          "973:                             return (0);",
          "974:                     }",
          "976:                     break;",
          "978:             case CLNP_OPTION_QOS_MAINTENANCE:",
          "",
          "[Removed Lines]",
          "975:                     ND_PRINT((ndo, \"0x%1x\", *tptr&0x0f));",
          "",
          "[Added Lines]",
          "978:                     ND_PRINT((ndo, \"0x%1x\", EXTRACT_8BITS(tptr)&0x0f));",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "983:                     ND_PRINT((ndo, \"\\n\\t    Format Code: %s\",",
          "984:                            tok2str(clnp_option_scope_values, \"Reserved\", EXTRACT_8BITS(tptr) & CLNP_OPTION_SCOPE_MASK)));",
          "987:                             ND_PRINT((ndo, \"\\n\\t    QoS Flags [%s]\",",
          "988:                                    bittok2str(clnp_option_qos_global_values,",
          "989:                                               \"none\",",
          "991:                     break;",
          "993:             case CLNP_OPTION_SECURITY:",
          "",
          "[Removed Lines]",
          "986:                     if ((*tptr&CLNP_OPTION_SCOPE_MASK) == CLNP_OPTION_SCOPE_GLOBAL)",
          "",
          "[Added Lines]",
          "989:                     if ((EXTRACT_8BITS(tptr)&CLNP_OPTION_SCOPE_MASK) == CLNP_OPTION_SCOPE_GLOBAL)",
          "993:                                               EXTRACT_8BITS(tptr)&CLNP_OPTION_OPTION_QOS_MASK)));",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "996:                             return (0);",
          "997:                     }",
          "998:                     ND_PRINT((ndo, \"\\n\\t    Format Code: %s, Security-Level %u\",",
          "1001:                     break;",
          "1003:             case CLNP_OPTION_DISCARD_REASON:",
          "",
          "[Removed Lines]",
          "999:                            tok2str(clnp_option_scope_values,\"Reserved\",EXTRACT_8BITS(tptr) & CLNP_OPTION_SCOPE_MASK),",
          "",
          "[Added Lines]",
          "1002:                            tok2str(clnp_option_scope_values,\"Reserved\",EXTRACT_8BITS(tptr)&CLNP_OPTION_SCOPE_MASK),",
          "1003:                            EXTRACT_8BITS(tptr+1)));",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1039:         case  CLNP_PDU_ERP:",
          "1040:             ND_TCHECK(*pptr);",
          "1042:                 ND_PRINT((ndo, \"\\n\\t-----original packet-----\\n\\t\"));",
          "1044:                 clnp_print(ndo, pptr, length - clnp_header->length_indicator);",
          "",
          "[Removed Lines]",
          "1041:             if (*(pptr) == NLPID_CLNP) {",
          "",
          "[Added Lines]",
          "1044:             if (EXTRACT_8BITS(pptr) == NLPID_CLNP) {",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1130:  if (li < sizeof(struct esis_header_t) + 2) {",
          "1131:             ND_PRINT((ndo, \" length indicator %u < min PDU size:\", li));",
          "1134:             return;",
          "1135:  }",
          "",
          "[Removed Lines]",
          "1132:             while (pptr < ndo->ndo_snapend)",
          "1133:                 ND_PRINT((ndo, \"%02X\", *pptr++));",
          "",
          "[Added Lines]",
          "1135:             while (pptr < ndo->ndo_snapend) {",
          "1136:                 ND_PRINT((ndo, \"%02X\", EXTRACT_8BITS(pptr)));",
          "1137:                 pptr++;",
          "1138:             }",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1174:    ND_PRINT((ndo, \", bad redirect/li\"));",
          "1175:    return;",
          "1176:   }",
          "1178:   pptr++;",
          "1179:   li--;",
          "1180:   ND_TCHECK2(*pptr, dstl);",
          "",
          "[Removed Lines]",
          "1177:   dstl = *pptr;",
          "",
          "[Added Lines]",
          "1182:   dstl = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1192:    ND_PRINT((ndo, \", bad redirect/li\"));",
          "1193:    return;",
          "1194:   }",
          "1196:   pptr++;",
          "1197:   li--;",
          "1198:   ND_TCHECK2(*pptr, snpal);",
          "",
          "[Removed Lines]",
          "1195:   snpal = *pptr;",
          "",
          "[Added Lines]",
          "1200:   snpal = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1208:    ND_PRINT((ndo, \", bad redirect/li\"));",
          "1209:    return;",
          "1210:   }",
          "1212:   pptr++;",
          "1213:   ND_TCHECK2(*pptr, netal);",
          "1214:   if (li < netal) {",
          "",
          "[Removed Lines]",
          "1211:   netal = *pptr;",
          "",
          "[Added Lines]",
          "1216:   netal = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1240:                 ND_PRINT((ndo, \", bad esh/li\"));",
          "1241:                 return;",
          "1242:             }",
          "1244:             pptr++;",
          "1245:             li--;",
          "",
          "[Removed Lines]",
          "1243:             source_address_number = *pptr;",
          "",
          "[Added Lines]",
          "1248:             source_address_number = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1252:                     ND_PRINT((ndo, \", bad esh/li\"));",
          "1253:                  return;",
          "1254:              }",
          "1256:                 pptr++;",
          "1257:              li--;",
          "",
          "[Removed Lines]",
          "1255:                 source_address_length = *pptr;",
          "",
          "[Added Lines]",
          "1260:                 source_address_length = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1277:                 ND_PRINT((ndo, \", bad ish/li\"));",
          "1278:                 return;",
          "1279:             }",
          "1281:             pptr++;",
          "1282:             li--;",
          "1283:             ND_TCHECK2(*pptr, source_address_length);",
          "",
          "[Removed Lines]",
          "1280:             source_address_length = *pptr;",
          "",
          "[Added Lines]",
          "1285:             source_address_length = EXTRACT_8BITS(pptr);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1309:                 return;",
          "1310:             }",
          "1311:             ND_TCHECK2(*pptr, 2);",
          "1314:             li -= 2;",
          "1315:             if (opli > li) {",
          "1316:                 ND_PRINT((ndo, \", opt (%d) too long\", op));",
          "",
          "[Removed Lines]",
          "1312:             op = *pptr++;",
          "1313:             opli = *pptr++;",
          "",
          "[Added Lines]",
          "1317:             op = EXTRACT_8BITS(pptr);",
          "1318:             opli = EXTRACT_8BITS(pptr + 1);",
          "1319:             pptr += 2;",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1337:             case ESIS_OPTION_PROTOCOLS:",
          "1338:                 while (opli>0) {",
          "1340:                     ND_PRINT((ndo, \"%s (0x%02x)\",",
          "1341:                            tok2str(nlpid_values,",
          "1342:                                    \"unknown\",",
          "1343:                                    EXTRACT_8BITS(tptr)),",
          "1346:                         ND_PRINT((ndo, \", \"));",
          "1347:                     tptr++;",
          "",
          "[Removed Lines]",
          "1339:                     ND_TCHECK(*tptr);",
          "",
          "[Added Lines]",
          "1345:                     ND_TCHECK_8BITS(tptr);",
          "1350:                            EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1406:   while (len > 2)",
          "1407:   {",
          "1408:     ND_TCHECK2(*tptr, 2);",
          "1413:     ND_PRINT((ndo, \"\\n\\t       %s subTLV #%u, length: %u\",",
          "",
          "[Removed Lines]",
          "1409:     stlv_type = *(tptr++);",
          "1410:     stlv_len  = *(tptr++);",
          "",
          "[Added Lines]",
          "1415:     stlv_type = EXTRACT_8BITS(tptr);",
          "1416:     stlv_len  = EXTRACT_8BITS(tptr + 1);",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1415:                stlv_type,",
          "1416:                stlv_len));",
          "1422:     if (len < stlv_len)",
          "",
          "[Removed Lines]",
          "1419:     len = len -2;",
          "",
          "[Added Lines]",
          "1424:     tptr = tptr + 2;",
          "1426:     len = len - 2;",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1457:           goto trunc;",
          "1459:         ND_PRINT((ndo, \"\\n\\t        RES: %d V: %d A: %d D: %d\",",
          "1463:         tptr++;",
          "",
          "[Removed Lines]",
          "1460:                         (*(tptr) >> 5), (((*tptr)>> 4) & 0x01),",
          "1461:                         ((*(tptr) >> 2) & 0x03), ((*tptr) & 0x03)));",
          "",
          "[Added Lines]",
          "1467:                         (EXTRACT_8BITS(tptr) >> 5),",
          "1468:                         ((EXTRACT_8BITS(tptr) >> 4) & 0x01),",
          "1469:                         ((EXTRACT_8BITS(tptr) >> 2) & 0x03),",
          "1470:                         (EXTRACT_8BITS(tptr) & 0x03)));",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1524:   while (len > 2)",
          "1525:   {",
          "1526:     ND_TCHECK2(*tptr, 2);",
          "1531:     ND_PRINT((ndo, \"\\n\\t      %s subTLV #%u, length: %u\",",
          "",
          "[Removed Lines]",
          "1527:     stlv_type = *(tptr++);",
          "1528:     stlv_len  = *(tptr++);",
          "",
          "[Added Lines]",
          "1536:     stlv_type = EXTRACT_8BITS(tptr);",
          "1537:     stlv_len  = EXTRACT_8BITS(tptr + 1);",
          "1538:     tptr = tptr + 2;",
          "1539:     len = len - 2;",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1533:                stlv_type,",
          "1534:                stlv_len));",
          "1539:     if (len < stlv_len)",
          "1540:       goto trunc;",
          "",
          "[Removed Lines]",
          "1536:     len = len - 2;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1562:           ND_PRINT((ndo, \", SPSource-ID: %d\",",
          "1563:                     (EXTRACT_BE_32BITS(tptr) & 0x000fffff)));",
          "1564:           tptr = tptr+4;",
          "1569:           len = len - ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN;",
          "1570:           stlv_len = stlv_len - ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN;",
          "",
          "[Removed Lines]",
          "1565:           ND_PRINT((ndo, \", No of Trees: %x\", *(tptr)));",
          "1567:           tmp = *(tptr++);",
          "",
          "[Added Lines]",
          "1574:           ND_PRINT((ndo, \", No of Trees: %x\", EXTRACT_8BITS(tptr)));",
          "1576:           tmp = EXTRACT_8BITS(tptr);",
          "1577:           tptr++;",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1575:               goto trunc;",
          "1577:             ND_PRINT((ndo, \"\\n\\t         U:%d, M:%d, A:%d, RES:%d\",",
          "1581:             tptr++;",
          "",
          "[Removed Lines]",
          "1579:                       (*(tptr) >> 5) & 0x01, (*(tptr) & 0x1f)));",
          "",
          "[Added Lines]",
          "1588:                       EXTRACT_8BITS(tptr) >> 7,",
          "1589:                       (EXTRACT_8BITS(tptr) >> 6) & 0x01,",
          "1590:                       (EXTRACT_8BITS(tptr) >> 5) & 0x01,",
          "1591:                       (EXTRACT_8BITS(tptr) & 0x1f)));",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1613:           stlv_len = stlv_len - 8;",
          "1615:           while (stlv_len >= 4) {",
          "1617:             ND_PRINT((ndo, \"\\n\\t        T: %d, R: %d, RES: %d, ISID: %d\",",
          "1618:                     (EXTRACT_BE_32BITS(tptr) >> 31),",
          "1619:                     (EXTRACT_BE_32BITS(tptr) >> 30) & 0x01,",
          "",
          "[Removed Lines]",
          "1616:             ND_TCHECK2(*tptr, 4);",
          "",
          "[Added Lines]",
          "1628:             ND_TCHECK_32BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1868:             ND_PRINT((ndo, \"%sBandwidth Constraints Model ID: %s (%u)\",",
          "1869:                    ident,",
          "1870:                    tok2str(diffserv_te_bc_values, \"unknown\", EXTRACT_8BITS(tptr)),",
          "1872:             tptr++;",
          "1874:             for (te_class = 0; te_class < (subl-1)/4; te_class++) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1883:                    EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1897:             if (subl >= 2) {",
          "1898:               ND_PRINT((ndo, \", %s, Priority %u\",",
          "1899:      bittok2str(gmpls_link_prot_values, \"none\", EXTRACT_8BITS(tptr)),",
          "1901:             }",
          "1902:             break;",
          "1903:         case ISIS_SUBTLV_SPB_METRIC:",
          "1904:             if (subl >= 6) {",
          "1905:               ND_PRINT((ndo, \", LM: %u\", EXTRACT_BE_24BITS(tptr)));",
          "1906:               tptr=tptr+3;",
          "1908:               tptr++;",
          "1909:               ND_PRINT((ndo, \", P-ID: %u\", EXTRACT_BE_16BITS(tptr)));",
          "1910:             }",
          "1911:             break;",
          "1912:         case ISIS_SUBTLV_EXT_IS_REACH_INTF_SW_CAP_DESCR:",
          "1913:             if (subl >= 36) {",
          "1915:               ND_PRINT((ndo, \"%s  Interface Switching Capability:%s\",",
          "1916:                    ident,",
          "1917:                    tok2str(gmpls_switch_cap_values, \"Unknown\", gmpls_switch_cap)));",
          "",
          "[Removed Lines]",
          "1907:               ND_PRINT((ndo, \", P: %u\", *(tptr)));",
          "1914:               gmpls_switch_cap = *tptr;",
          "",
          "[Added Lines]",
          "1912:      EXTRACT_8BITS(tptr+1)));",
          "1919:               ND_PRINT((ndo, \", P: %u\", EXTRACT_8BITS(tptr)));",
          "1926:               gmpls_switch_cap = EXTRACT_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1988:     tptr+=NODE_ID_LEN;",
          "1992:      return(0);",
          "1993:  ND_PRINT((ndo, \", Metric: %d\", EXTRACT_BE_24BITS(tptr)));",
          "1994:  tptr+=3;",
          "1995:     }",
          "1998:         return(0);",
          "2000:     proc_bytes=NODE_ID_LEN+3+1;",
          "2001:     ND_PRINT((ndo, \", %ssub-TLVs present\",subtlv_sum_len ? \"\" : \"no \"));",
          "2002:     if (subtlv_sum_len) {",
          "",
          "[Removed Lines]",
          "1997:     if (!ND_TTEST2(*tptr, 1))",
          "",
          "[Added Lines]",
          "2009:     if (!ND_TTEST_8BITS(tptr))",
          "2012:     tptr++;",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "2004:         while (subtlv_sum_len>0) {",
          "2005:             if (!ND_TTEST2(*tptr,2))",
          "2006:                 return(0);",
          "2010:             snprintf(ident_buffer, sizeof(ident_buffer), \"%s  \",ident);",
          "2011:             if (!isis_print_is_reach_subtlv(ndo, tptr, subtlv_type, subtlv_len, ident_buffer))",
          "",
          "[Removed Lines]",
          "2007:             subtlv_type=*(tptr++);",
          "2008:             subtlv_len=*(tptr++);",
          "",
          "[Added Lines]",
          "2020:             subtlv_type=EXTRACT_8BITS(tptr);",
          "2021:             subtlv_len=EXTRACT_8BITS(tptr+1);",
          "2022:             tptr+=2;",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "2027: isis_print_mtid(netdissect_options *ndo,",
          "2028:                 const uint8_t *tptr, const char *ident)",
          "2029: {",
          "2031:         return(0);",
          "2033:     ND_PRINT((ndo, \"%s%s\",",
          "",
          "[Removed Lines]",
          "2030:     if (!ND_TTEST2(*tptr, 2))",
          "",
          "[Added Lines]",
          "2044:     if (!ND_TTEST_16BITS(tptr))",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "2059:     u_int metric, status_byte, bit_length, byte_length, sublen, processed, subtlvtype, subtlvlen;",
          "2062:         return (0);",
          "2063:     metric = EXTRACT_BE_32BITS(tptr);",
          "2064:     processed=4;",
          "2065:     tptr+=4;",
          "2067:     if (afi == AF_INET) {",
          "2069:             return (0);",
          "2071:         bit_length = status_byte&0x3f;",
          "2072:         if (bit_length > 32) {",
          "2073:             ND_PRINT((ndo, \"%sIPv4 prefix: bad bit length %u\",",
          "",
          "[Removed Lines]",
          "2061:     if (!ND_TTEST2(*tptr, 4))",
          "2070:         status_byte=*(tptr++);",
          "",
          "[Added Lines]",
          "2075:     if (!ND_TTEST_32BITS(tptr))",
          "2084:         status_byte=EXTRACT_8BITS(tptr);",
          "2085:         tptr++;",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "2079:     } else if (afi == AF_INET6) {",
          "2081:             return (0);",
          "2084:         if (bit_length > 128) {",
          "2085:             ND_PRINT((ndo, \"%sIPv6 prefix: bad bit length %u\",",
          "2086:                    ident,",
          "2087:                    bit_length));",
          "2088:             return (0);",
          "2089:         }",
          "2090:         processed+=2;",
          "2091:     } else",
          "",
          "[Removed Lines]",
          "2082:         status_byte=*(tptr++);",
          "2083:         bit_length=*(tptr++);",
          "",
          "[Added Lines]",
          "2097:         status_byte=EXTRACT_8BITS(tptr);",
          "2098:         bit_length=EXTRACT_8BITS(tptr+1);",
          "2105:         tptr+=2;",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "2129:            than one subTLV - therefore the first byte must reflect",
          "2130:            the aggregate bytecount of the subTLVs for this prefix",
          "2133:             return (0);",
          "2135:         processed+=sublen+1;",
          "2138:         while (sublen>0) {",
          "2139:             if (!ND_TTEST2(*tptr,2))",
          "2140:                 return (0);",
          "2144:             snprintf(ident_buffer, sizeof(ident_buffer), \"%s  \",ident);",
          "2145:             if (!isis_print_ip_reach_subtlv(ndo, tptr, subtlvtype, subtlvlen, ident_buffer))",
          "",
          "[Removed Lines]",
          "2132:         if (!ND_TTEST2(*tptr, 1))",
          "2134:         sublen=*(tptr++);",
          "2141:             subtlvtype=*(tptr++);",
          "2142:             subtlvlen=*(tptr++);",
          "",
          "[Added Lines]",
          "2148:         if (!ND_TTEST_8BITS(tptr))",
          "2150:         sublen=EXTRACT_8BITS(tptr);",
          "2151:         tptr++;",
          "2158:             subtlvtype=EXTRACT_8BITS(tptr);",
          "2159:             subtlvlen=EXTRACT_8BITS(tptr+1);",
          "2160:             tptr+=2;",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "2190:     uint8_t pdu_type, max_area, id_length, tlv_type, tlv_len, tmp, alen, lan_alen, prefix_len;",
          "2191:     uint8_t ext_is_len, ext_ip_len, mt_len;",
          "2192:     const uint8_t *optr, *pptr, *tptr;",
          "2193:     u_short packet_len,pdu_len, key_id;",
          "2194:     u_int i,vendor_id;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2210:     uint8_t isis_subtlv_idrp;",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "2545:  ND_TCHECK2(*pptr, 2);",
          "2546:  if (packet_len < 2)",
          "2547:      goto trunc;",
          "2551:         tptr = pptr;",
          "2555:  ND_PRINT((ndo, \"\\n\\t    %s TLV #%u, length: %u\",",
          "",
          "[Removed Lines]",
          "2548:  tlv_type = *pptr++;",
          "2549:  tlv_len = *pptr++;",
          "2552:  packet_len -= 2;",
          "",
          "[Added Lines]",
          "2567:  tlv_type = EXTRACT_8BITS(pptr);",
          "2568:  tlv_len = EXTRACT_8BITS(pptr + 1);",
          "2569:  pptr += 2;",
          "2570:  packet_len -= 2;",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "2569:  switch (tlv_type) {",
          "2570:  case ISIS_TLV_AREA_ADDR:",
          "2573:      while (tmp && alen < tmp) {",
          "2574:          ND_TCHECK2(*tptr, alen);",
          "2575:   ND_PRINT((ndo, \"\\n\\t      Area address (length: %u): %s\",",
          "",
          "[Removed Lines]",
          "2571:      ND_TCHECK2(*tptr, 1);",
          "2572:      alen = *tptr++;",
          "",
          "[Added Lines]",
          "2591:      ND_TCHECK_8BITS(tptr);",
          "2592:      alen = EXTRACT_8BITS(tptr);",
          "2593:      tptr++;",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "2579:   tmp -= alen + 1;",
          "2581:                     break;",
          "2584:      }",
          "2585:      break;",
          "2586:  case ISIS_TLV_ISNEIGH:",
          "",
          "[Removed Lines]",
          "2582:   ND_TCHECK2(*tptr, 1);",
          "2583:   alen = *tptr++;",
          "",
          "[Added Lines]",
          "2603:   ND_TCHECK_8BITS(tptr);",
          "2604:   alen = EXTRACT_8BITS(tptr);",
          "2605:   tptr++;",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "2593:      break;",
          "2595:         case ISIS_TLV_ISNEIGH_VARLEN:",
          "2597:   goto trunctlv;",
          "2599:      if (lan_alen == 0) {",
          "2600:                 ND_PRINT((ndo, \"\\n\\t      LAN address length 0 bytes (invalid)\"));",
          "2601:                 break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2621:      tptr++;",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "2751:      }",
          "2752:      break;",
          "2753:  case ISIS_TLV_AUTH:",
          "2756:             ND_PRINT((ndo, \"\\n\\t      %s: \",",
          "2757:                    tok2str(isis_subtlv_auth_values,",
          "2758:                            \"unknown Authentication type 0x%02x\",",
          "2759:                            EXTRACT_8BITS(tptr))));",
          "2762:      case ISIS_SUBTLV_AUTH_SIMPLE:",
          "2763:   if (fn_printzp(ndo, tptr + 1, tlv_len - 1, ndo->ndo_snapend))",
          "2764:       goto trunctlv;",
          "2765:   break;",
          "2766:      case ISIS_SUBTLV_AUTH_MD5:",
          "2767:   for(i=1;i<tlv_len;i++) {",
          "2770:   }",
          "2771:   if (tlv_len != ISIS_SUBTLV_AUTH_MD5_LEN+1)",
          "2772:                     ND_PRINT((ndo, \", (invalid subTLV) \"));",
          "",
          "[Removed Lines]",
          "2754:      ND_TCHECK2(*tptr, 1);",
          "2761:      switch (*tptr) {",
          "2768:       ND_TCHECK2(*(tptr + i), 1);",
          "2769:       ND_PRINT((ndo, \"%02x\", *(tptr + i)));",
          "",
          "[Added Lines]",
          "2777:      ND_TCHECK_8BITS(tptr);",
          "2784:      switch (EXTRACT_8BITS(tptr)) {",
          "2791:       ND_TCHECK_8BITS(tptr + i);",
          "2792:       ND_PRINT((ndo, \"%02x\", EXTRACT_8BITS(tptr + i)));",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "2779:   break;",
          "2780:             case ISIS_SUBTLV_AUTH_GENERIC:",
          "2783:                 ND_PRINT((ndo, \"%u, password: \", key_id));",
          "2784:                 for(i=1 + sizeof(uint16_t);i<tlv_len;i++) {",
          "2787:                 }",
          "2788:                 break;",
          "2789:      case ISIS_SUBTLV_AUTH_PRIVATE:",
          "",
          "[Removed Lines]",
          "2781:   ND_TCHECK2(*(tptr + 1), 2);",
          "2782:                 key_id = EXTRACT_BE_16BITS((tptr + 1));",
          "2785:                     ND_TCHECK2(*(tptr + i), 1);",
          "2786:                     ND_PRINT((ndo, \"%02x\", *(tptr + i)));",
          "",
          "[Added Lines]",
          "2804:   ND_TCHECK_16BITS(tptr + 1);",
          "2805:                 key_id = EXTRACT_BE_16BITS(tptr + 1);",
          "2808:                     ND_TCHECK_8BITS(tptr + i);",
          "2809:                     ND_PRINT((ndo, \"%02x\", EXTRACT_8BITS(tptr + i)));",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "2797:  case ISIS_TLV_PTP_ADJ:",
          "2798:      tlv_ptp_adj = (const struct isis_tlv_ptp_adj *)tptr;",
          "2799:      if(tmp>=1) {",
          "2801:   ND_PRINT((ndo, \"\\n\\t      Adjacency State: %s (%u)\",",
          "2802:          tok2str(isis_ptp_adjancey_values, \"unknown\", EXTRACT_8BITS(tptr)),",
          "2804:   tmp--;",
          "2805:      }",
          "2806:      if(tmp>sizeof(tlv_ptp_adj->extd_local_circuit_id)) {",
          "",
          "[Removed Lines]",
          "2800:   ND_TCHECK2(*tptr, 1);",
          "",
          "[Added Lines]",
          "2823:   ND_TCHECK_8BITS(tptr);",
          "2826:          EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "2825:  case ISIS_TLV_PROTOCOLS:",
          "2826:      ND_PRINT((ndo, \"\\n\\t      NLPID(s): \"));",
          "2827:      while (tmp>0) {",
          "2829:   ND_PRINT((ndo, \"%s (0x%02x)\",",
          "2830:                        tok2str(nlpid_values,",
          "2831:                                \"unknown\",",
          "2832:                                EXTRACT_8BITS(tptr)),",
          "2835:       ND_PRINT((ndo, \", \"));",
          "2836:                 tptr++;",
          "",
          "[Removed Lines]",
          "2828:   ND_TCHECK2(*(tptr), 1);",
          "",
          "[Added Lines]",
          "2851:   ND_TCHECK_8BITS(tptr);",
          "2856:                        EXTRACT_8BITS(tptr)));",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "2841:     case ISIS_TLV_MT_PORT_CAP:",
          "2842:     {",
          "2845:       ND_PRINT((ndo, \"\\n\\t       RES: %d, MTID(s): %d\",",
          "2846:               (EXTRACT_BE_16BITS(tptr) >> 12),",
          "",
          "[Removed Lines]",
          "2843:       ND_TCHECK2(*(tptr), 2);",
          "",
          "[Added Lines]",
          "2866:       ND_TCHECK_16BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "2858:     case ISIS_TLV_MT_CAPABILITY:",
          "2862:       ND_PRINT((ndo, \"\\n\\t      O: %d, RES: %d, MTID(s): %d\",",
          "2863:                 (EXTRACT_BE_16BITS(tptr) >> 15) & 0x01,",
          "",
          "[Removed Lines]",
          "2860:       ND_TCHECK2(*(tptr), 2);",
          "",
          "[Added Lines]",
          "2883:       ND_TCHECK_16BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "2903:      if (tmp < 1)",
          "2904:          break;",
          "2906:      ND_PRINT((ndo, \", Flags: [%s]\", ISIS_MASK_TLV_SHARED_RISK_GROUP(EXTRACT_8BITS(tptr)) ? \"numbered\" : \"unnumbered\"));",
          "2907:      tptr++;",
          "2908:      tmp--;",
          "",
          "[Removed Lines]",
          "2905:      ND_TCHECK2(*tptr, 1);",
          "",
          "[Added Lines]",
          "2928:      ND_TCHECK_8BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "2922:      tmp-=sizeof(struct in_addr);",
          "2924:      while (tmp>=4) {",
          "2926:                 ND_PRINT((ndo, \"\\n\\t      Link-ID: 0x%08x\", EXTRACT_BE_32BITS(tptr)));",
          "2927:                 tptr+=4;",
          "2928:                 tmp-=4;",
          "",
          "[Removed Lines]",
          "2925:                 ND_TCHECK2(*tptr, 4);",
          "",
          "[Added Lines]",
          "2948:                 ND_TCHECK_32BITS(tptr);",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "3030:                    tok2str(isis_subtlv_idrp_values,",
          "3031:                            \"Unknown (0x%02x)\",",
          "3032:                            EXTRACT_8BITS(tptr))));",
          "3034:             case ISIS_SUBTLV_IDRP_ASN:",
          "3036:                 ND_PRINT((ndo, \"AS Number: %u\", EXTRACT_BE_16BITS(tptr)));",
          "3037:                 break;",
          "3038:             case ISIS_SUBTLV_IDRP_LOCAL:",
          "",
          "[Removed Lines]",
          "3033:             switch (*tptr++) {",
          "",
          "[Added Lines]",
          "3056:             isis_subtlv_idrp = EXTRACT_8BITS(tptr);",
          "3057:             tptr++;",
          "3058:             switch (isis_subtlv_idrp) {",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "3070:             tmp-=sizeof(struct isis_metric_block);",
          "3072:             while(tmp>0) {",
          "3075:                 if (prefix_len < 2) {",
          "3076:                     ND_PRINT((ndo, \"\\n\\t\\tAddress: prefix length %u < 2\", prefix_len));",
          "3077:                     break;",
          "",
          "[Removed Lines]",
          "3073:                 ND_TCHECK2(*tptr, 1);",
          "",
          "[Added Lines]",
          "3098:                 ND_TCHECK_8BITS(tptr);",
          "3100:                 tptr++;",
          "",
          "---------------"
        ]
      }
    }
  ]
}