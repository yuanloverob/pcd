{
  "cve_id": "CVE-2021-35344",
  "cve_desc": "tsMuxer v2.6.16 was discovered to contain a heap-based buffer overflow via the function BitStreamReader::getCurVal in bitStream.h.",
  "repo": "justdan96/tsMuxer",
  "patch_hash": "3a889a37b5b74a45025aca13ebda394b8f706ef3",
  "patch_info": {
    "commit_hash": "3a889a37b5b74a45025aca13ebda394b8f706ef3",
    "repo": "justdan96/tsMuxer",
    "commit_url": "https://github.com/justdan96/tsMuxer/pull/439/commits/3a889a37b5b74a45025aca13ebda394b8f706ef3",
    "files": [
      "tsMuxer/hevc.cpp"
    ],
    "message": "[bug] Buffer overflow when SEI payloadSize > bits left\n\nFixes #433 .",
    "before_after_code_files": [
      "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp"
    ]
  },
  "patch_diff": {
    "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp": [
      "File: tsMuxer/hevc.cpp -> tsMuxer/hevc.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "979:                 nbyte = m_reader.getBits(8);",
      "980:                 payloadSize += nbyte;",
      "981:             }",
      "982:             if (payloadType == 137 && !isHDR10)  // mastering_display_colour_volume",
      "983:             {",
      "984:                 isHDR10 = true;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "982:             if (m_reader.getBitsLeft() < payloadSize * 8)",
      "983:             {",
      "984:                 LTRACE(LT_WARN, 2, \"Bad SEI detected. SEI too short\");",
      "985:                 return 1;",
      "986:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8028fb8449f6f1c702b7f70369c889e8633378a8",
      "candidate_info": {
        "commit_hash": "8028fb8449f6f1c702b7f70369c889e8633378a8",
        "repo": "justdan96/tsMuxer",
        "commit_url": "https://github.com/justdan96/tsMuxer/commit/8028fb8449f6f1c702b7f70369c889e8633378a8",
        "files": [
          "tsMuxer/hevc.cpp"
        ],
        "message": "Buffer overflow when SEI payloadSize > bits left (#439)\n\nFixes #432 .",
        "before_after_code_files": [
          "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/justdan96/tsMuxer/pull/439"
        ],
        "olp_code_files": {
          "patch": [
            "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp"
          ],
          "candidate": [
            "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp"
          ]
        }
      },
      "candidate_diff": {
        "tsMuxer/hevc.cpp||tsMuxer/hevc.cpp": [
          "File: tsMuxer/hevc.cpp -> tsMuxer/hevc.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "980:                 nbyte = m_reader.getBits(8);",
          "981:                 payloadSize += nbyte;",
          "982:             }",
          "983:             if (payloadType == 137 && !isHDR10)  // mastering_display_colour_volume",
          "984:             {",
          "985:                 isHDR10 = true;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "983:             if (m_reader.getBitsLeft() < payloadSize * 8)",
          "984:             {",
          "985:                 LTRACE(LT_WARN, 2, \"Bad SEI detected. SEI too short\");",
          "986:                 return 1;",
          "987:             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}