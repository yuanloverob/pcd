{
  "cve_id": "CVE-2021-33035",
  "cve_desc": "Apache OpenOffice opens dBase/DBF documents and shows the contents as spreadsheets. DBF are database files with data organized in fields. When reading DBF data the size of certain fields is not checked: the data is just copied into local variables. A carefully crafted document could overflow the allocated space, leading to the execution of arbitrary code by altering the contents of the program stack. This issue affects Apache OpenOffice up to and including version 4.1.10",
  "repo": "apache/openoffice",
  "patch_hash": "efddaef0151af3be16078cc4d88c6bae0f911e56",
  "patch_info": {
    "commit_hash": "efddaef0151af3be16078cc4d88c6bae0f911e56",
    "repo": "apache/openoffice",
    "commit_url": "https://github.com/apache/openoffice/commit/efddaef0151af3be16078cc4d88c6bae0f911e56#diff-ea66e734dd358922aba12ad4ba39c96bdc6cbde587d07dbc63d04daa0a30e90f",
    "files": [
      "main/connectivity/source/drivers/dbase/DTable.cxx"
    ],
    "message": "add useful checks",
    "before_after_code_files": [
      "main/connectivity/source/drivers/dbase/DTable.cxx||main/connectivity/source/drivers/dbase/DTable.cxx"
    ]
  },
  "patch_diff": {
    "main/connectivity/source/drivers/dbase/DTable.cxx||main/connectivity/source/drivers/dbase/DTable.cxx": [
      "File: main/connectivity/source/drivers/dbase/DTable.cxx -> main/connectivity/source/drivers/dbase/DTable.cxx",
      "--- Hunk 1 ---",
      "[Context before]",
      "896:         else if ( DataType::TIMESTAMP == nType )",
      "897:         {",
      "898:             sal_Int32 nDate = 0,nTime = 0;",
      "899:    memcpy(&nDate, pData, 4);",
      "900:             memcpy(&nTime, pData+ 4, 4);",
      "901:             if ( !nDate && !nTime )",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "899:             OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "900:             if (nLen != 8) {",
      "901:                 return false;",
      "902:             }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "911:         }",
      "912:         else if ( DataType::INTEGER == nType )",
      "913:         {",
      "914:             sal_Int32 nValue = 0;",
      "915:    memcpy(&nValue, pData, nLen);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "918:             OSL_ENSURE(nLen == 4, \"Invalid length for integer field\");",
      "919:             if (nLen != 4) {",
      "920:                 return false;",
      "921:             }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "918:         else if ( DataType::DOUBLE == nType )",
      "919:         {",
      "920:             double d = 0.0;",
      "921:             if (getBOOL((*aIter)->getPropertyValue(OMetaConnection::getPropMap().getNameByIndex(PROPERTY_ID_ISCURRENCY)))) // Currency wird gesondert behandelt",
      "922:             {",
      "923:                 sal_Int64 nValue = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "929:             OSL_ENSURE(nLen == 8, \"Invalid length for double field\");",
      "930:             if (nLen != 8) {",
      "931:                 return false;",
      "932:             }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "959:    {",
      "960:     case DataType::DATE:",
      "961:     {",
      "962:      if (aStr.Len() != nLen)",
      "963:      {",
      "964:       (_rRow->get())[i]->setNull();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "974:                     OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "975:                     if (nLen != 8) {",
      "976:                         return false;",
      "977:                     }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "978:     break;",
      "979:     case DataType::BIT:",
      "980:     {",
      "981:      sal_Bool b;",
      "982:      switch (* ((const char *)pData))",
      "983:      {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "997:                     OSL_ENSURE(nLen == 1, \"Invalid length for bit field\");",
      "998:                     if (nLen != 1) {",
      "999:                         return false;",
      "1000:                     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "1873:    {",
      "1874:                 case DataType::TIMESTAMP:",
      "1875:                     {",
      "1876:                         sal_Int32 nJulianDate = 0, nJulianTime = 0;",
      "1877:                         lcl_CalcJulDate(nJulianDate,nJulianTime,rRow.get()[nPos]->getValue());",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1896:                         OSL_ENSURE(nLen == 8, \"Invalid length for timestamp field\");",
      "1897:                         if (nLen != 8) {",
      "1898:                             bHadError = true;",
      "1899:                             break;",
      "1900:                         }",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "1882:                     break;",
      "1883:     case DataType::DATE:",
      "1884:     {",
      "1885:      ::com::sun::star::util::Date aDate;",
      "1886:      if(rRow.get()[nPos]->getValue().getTypeKind() == DataType::DOUBLE)",
      "1887:       aDate = ::dbtools::DBTypeConversion::toDate(rRow.get()[nPos]->getValue().getDouble());",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1910:                     OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "1911:                     if (nLen != 8) {",
      "1912:                         bHadError = true;",
      "1913:                         break;",
      "1914:                     }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "1900:     } break;",
      "1901:                 case DataType::INTEGER:",
      "1902:                     {",
      "1903:                         sal_Int32 nValue = rRow.get()[nPos]->getValue();",
      "1904:                         memcpy(pData,&nValue,nLen);",
      "1905:                     }",
      "1906:                     break;",
      "1907:                 case DataType::DOUBLE:",
      "1908:                     {",
      "1909:                         const double d = rRow.get()[nPos]->getValue();",
      "1910:                         m_pColumns->getByIndex(i) >>= xCol;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1933:                         OSL_ENSURE(nLen == 4, \"Invalid length for integer field\");",
      "1934:                         if (nLen != 4) {",
      "1935:                             bHadError = true;",
      "1936:                             break;",
      "1937:                         }",
      "1944:                         OSL_ENSURE(nLen == 8, \"Invalid length for double field\");",
      "1945:                         if (nLen != 8) {",
      "1946:                             bHadError = true;",
      "1947:                             break;",
      "1948:                         }",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "1958:      }",
      "1959:     } break;",
      "1960:     case DataType::BIT:",
      "1962:      break;",
      "1963:                 case DataType::LONGVARBINARY:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2001:                     OSL_ENSURE(nLen == 1, \"Invalid length for bit field\");",
      "2002:                     if (nLen != 1) {",
      "2003:                         bHadError = true;",
      "2004:                         break;",
      "2005:                     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d0962c005fdf2462f2d9f0b584a6e9c6a9d74380",
      "candidate_info": {
        "commit_hash": "d0962c005fdf2462f2d9f0b584a6e9c6a9d74380",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/d0962c005fdf2462f2d9f0b584a6e9c6a9d74380",
        "files": [
          "main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx"
        ],
        "message": "Fix default return value\n\n(cherry picked from commit 6dd4cf0f0e446e28c948431ae6ac9ebfe345063a)",
        "before_after_code_files": [
          "main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx||main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx||main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx": [
          "File: main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx -> main/xmlsecurity/source/xmlsec/mscrypt/securityenvironment_mscryptimpl.cxx",
          "--- Hunk 1 ---",
          "[Context before]",
          "987:     const Sequence< Reference< ::com::sun::star::security::XCertificate > >& seqCerts)",
          "988:     throw( ::com::sun::star::uno::SecurityException, ::com::sun::star::uno::RuntimeException )",
          "989: {",
          "991:  PCCERT_CHAIN_CONTEXT pChainContext = NULL;",
          "992:  PCCERT_CONTEXT pCertContext = NULL;",
          "993:  const X509Certificate_MSCryptImpl* xcert = NULL;",
          "",
          "[Removed Lines]",
          "990:  sal_Int32 validity = 0;",
          "",
          "[Added Lines]",
          "990:  sal_Int32 validity = ::com::sun::star::security::CertificateValidity::INVALID;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0ae430aa50b8527cdb72174129dcb411d17e525e",
      "candidate_info": {
        "commit_hash": "0ae430aa50b8527cdb72174129dcb411d17e525e",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/0ae430aa50b8527cdb72174129dcb411d17e525e",
        "files": [
          "main/external_deps.lst",
          "main/nss/makefile.mk",
          "main/nss/nss.patch",
          "main/nss/nss_bug_1348767.patch",
          "main/nss/nss_bug_1437734.patch",
          "main/nss/nss_bug_1438426.patch",
          "main/nss/nss_freebsd.patch",
          "main/nss/nss_linux.patch",
          "main/nss/nss_macosx.patch",
          "main/nss/nss_win.patch"
        ],
        "message": "Upgrade nss to nss-3.39-with-nspr-4.20\n\n(cherry picked from commit 13effbfbfe1b52a6a38b08a28bfd6972ff86c6ac)",
        "before_after_code_files": [
          "main/external_deps.lst||main/external_deps.lst",
          "main/nss/makefile.mk||main/nss/makefile.mk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/external_deps.lst||main/external_deps.lst": [
          "File: main/external_deps.lst -> main/external_deps.lst",
          "--- Hunk 1 ---",
          "[Context before]",
          "305:     URL2 = $(OOO_EXTRAS)$(MD5)-$(name)",
          "307: if (ENABLE_CATEGORY_B==YES && ENABLE_NSS_MODULE==YES)",
          "311:     URL2 = $(OOO_EXTRAS)$(MD5)-$(name)",
          "313: if (ENABLE_CATEGORY_B==YES && SYSTEM_SAXON!=YES && DISABLE_SAXON!=YES && SOLAR_JAVA==TRUE)",
          "",
          "[Removed Lines]",
          "308:     MD5 = 4ec9a36c0f7c9360b149491c013b8d50",
          "309:     name = nss-3.25-with-nspr-4.12.tar.gz",
          "310:     URL1 = http://ftp.mozilla.org/pub/security/nss/releases/NSS_3_25_RTM/src/$(name)",
          "",
          "[Added Lines]",
          "308:     MD5 = 8ac77166663de5c33bba6cb3d0066929",
          "309:     name = nss-3.39-with-nspr-4.20.tar.gz",
          "310:     URL1 = https://ftp.mozilla.org/pub/security/nss/releases/NSS_3_39_RTM/src/$(name)",
          "",
          "---------------"
        ],
        "main/nss/makefile.mk||main/nss/makefile.mk": [
          "File: main/nss/makefile.mk -> main/nss/makefile.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "40: .ELSE",
          "50: .IF \"$(OS)\"==\"MACOSX\"",
          "51: MACOS_SDK_DIR=$(SDK_PATH)",
          "",
          "[Removed Lines]",
          "42: TARFILE_NAME=nss-3.25-with-nspr-4.12",
          "43: TARFILE_MD5=4ec9a36c0f7c9360b149491c013b8d50",
          "44: TARFILE_ROOTDIR=nss-3.25",
          "45: PATCH_FILES=nss.patch \\",
          "46:  nss_bug_1438426.patch \\",
          "47:  nss_bug_1348767.patch \\",
          "48:  nss_bug_1437734.patch",
          "",
          "[Added Lines]",
          "42: TARFILE_NAME=nss-3.39-with-nspr-4.20",
          "43: TARFILE_MD5=8ac77166663de5c33bba6cb3d0066929",
          "44: TARFILE_ROOTDIR=nss-3.39",
          "45: PATCH_FILES=nss.patch",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "65: .EXPORT : USE_64",
          "66: .ENDIF # \"$(BUILD64)\"==\"1\"",
          "70: BUILD_DIR=nss",
          "71: BUILD_ACTION= $(GNUMAKE) nss_build_all",
          "",
          "[Removed Lines]",
          "68: OUT2LIB=dist$/out$/lib$/*$(DLLPOST)",
          "",
          "[Added Lines]",
          "65: OUT2LIB=dist$/*.OBJ$/lib$/*$(DLLPOST)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "106: BUILD_ACTION= NSS_DISABLE_GTESTS=1 NS_USE_GCC=1 CC=\"$(nss_CC)\" CXX=\"$(nss_CXX)\" OS_LIBS=\"$(nss_LIBS)\" OS_TARGET=WIN95 _WIN32_IE=0x500 PATH=\"$(PATH)\" DEFINES=-D_WIN32_IE=0x500 $(GNUMAKE) nss_build_all",
          "108: OUT2LIB= \\",
          "120: .ELSE   # \"$(COM)\"==\"GCC\"",
          "121: MOZ_MSVCVERSION= 9",
          "122: .EXPORT : MOZ_MSVCVERSION",
          "123: moz_build:=$(shell cygpath -p $(MOZILLABUILD))",
          "125: #Using WINNT will cause at least that nspr4.dll, plc4.dll, plds4.dll",
          "",
          "[Removed Lines]",
          "109:  dist$/out$/lib$/libnspr4.a \\",
          "110:  dist$/out$/lib$/libnss3.a \\",
          "111:  dist$/out$/lib$/libnssdbm3.a \\",
          "112:  dist$/out$/lib$/libnssutil3.a \\",
          "113:  dist$/out$/lib$/libplc4.a \\",
          "114:  dist$/out$/lib$/libplds4.a \\",
          "115:  dist$/out$/lib$/libsmime3.a \\",
          "116:  dist$/out$/lib$/libsoftokn3.a \\",
          "117:  dist$/out$/lib$/libsqlite3.a \\",
          "118:  dist$/out$/lib$/libssl3.a",
          "",
          "[Added Lines]",
          "106:  dist$/*.OBJ$/lib$/libnspr4.a \\",
          "107:  dist$/*.OBJ$/lib$/libnss3.a \\",
          "108:  dist$/*.OBJ$/lib$/libnssdbm3.a \\",
          "109:  dist$/*.OBJ$/lib$/libnssutil3.a \\",
          "110:  dist$/*.OBJ$/lib$/libplc4.a \\",
          "111:  dist$/*.OBJ$/lib$/libplds4.a \\",
          "112:  dist$/*.OBJ$/lib$/libsmime3.a \\",
          "113:  dist$/*.OBJ$/lib$/libsoftokn3.a \\",
          "114:  dist$/*.OBJ$/lib$/libsqlite3.a \\",
          "115:  dist$/*.OBJ$/lib$/libssl3.a",
          "120: PATCH_FILES+=nss_win.patch nss_bug_1437734.patch",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "138:  -c \"cd $(NSS_BUILD_DIR) && make nss_build_all NSS_DISABLE_GTESTS=1\"",
          "140: OUT2LIB= \\",
          "152: .ENDIF   # \"$(COM)\"==\"GCC\"",
          "155: .ENDIF   # \"$(GUI)\"==\"WNT\"",
          "160: # --- Targets ------------------------------------------------------",
          "",
          "[Removed Lines]",
          "141:  dist$/out$/lib$/nspr4.lib \\",
          "142:  dist$/out$/lib$/nss3.lib \\",
          "143:  dist$/out$/lib$/nssdbm3.lib \\",
          "144:  dist$/out$/lib$/nssutil3.lib \\",
          "145:  dist$/out$/lib$/plc4.lib \\",
          "146:  dist$/out$/lib$/plds4.lib \\",
          "147:  dist$/out$/lib$/smime3.lib \\",
          "148:  dist$/out$/lib$/softokn3.lib \\",
          "149:  dist$/out$/lib$/sqlite3.lib \\",
          "150:  dist$/out$/lib$/ssl3.lib",
          "154: OUT2BIN=dist$/out$/lib$/*$(DLLPOST)",
          "158: OUTDIR2INC=dist$/public$/nss dist$/out$/include",
          "",
          "[Added Lines]",
          "139:  dist$/WIN954.0_OPT.OBJ$/lib$/nspr4.lib \\",
          "140:  dist$/WIN954.0_OPT.OBJ$/lib$/nss3.lib \\",
          "141:  dist$/WIN954.0_OPT.OBJ$/lib$/nssdbm3.lib \\",
          "142:  dist$/WIN954.0_OPT.OBJ$/lib$/nssutil3.lib \\",
          "143:  dist$/WIN954.0_OPT.OBJ$/lib$/plc4.lib \\",
          "144:  dist$/WIN954.0_OPT.OBJ$/lib$/plds4.lib \\",
          "145:  dist$/WIN954.0_OPT.OBJ$/lib$/smime3.lib \\",
          "146:  dist$/WIN954.0_OPT.OBJ$/lib$/softokn3.lib \\",
          "147:  dist$/WIN954.0_OPT.OBJ$/lib$/sqlite3.lib \\",
          "148:  dist$/WIN954.0_OPT.OBJ$/lib$/ssl3.lib",
          "152: OUT2BIN=dist$/WIN954.0_OPT.OBJ$/lib$/*$(DLLPOST)",
          "156: OUTDIR2INC=dist$/public$/nss dist$/*.OBJ$/include",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "80e6d0057ca6e6053ebcc4f0770d1c5e73ca3db5",
      "candidate_info": {
        "commit_hash": "80e6d0057ca6e6053ebcc4f0770d1c5e73ca3db5",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/80e6d0057ca6e6053ebcc4f0770d1c5e73ca3db5",
        "files": [
          "extras/l10n/source/fi/localize.sdf",
          "extras/l10n/source/pl/localize.sdf"
        ],
        "message": "Corrected strings in SDF",
        "before_after_code_files": [
          "extras/l10n/source/fi/localize.sdf||extras/l10n/source/fi/localize.sdf",
          "extras/l10n/source/pl/localize.sdf||extras/l10n/source/pl/localize.sdf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "extras/l10n/source/fi/localize.sdf||extras/l10n/source/fi/localize.sdf": [
          "File: extras/l10n/source/fi/localize.sdf -> extras/l10n/source/fi/localize.sdf",
          "--- Hunk 1 ---",
          "[Context before]",
          "3654: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.EmptyPanel Title   0 fi Tyhj\u00e4    20130618 17:22:18",
          "3655: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.AlignmentPropertyPanel Title   0 fi Tasaus    20130618 17:22:18",
          "3656: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.CellAppearancePropertyPanel Title   0 fi Solun ulkoasu    20130618 17:22:18",
          "3658: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.ParaPropertyPanel Title   0 fi Kappale    20130618 17:22:18",
          "3659: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.WrapPropertyPanel Title   0 fi Rivit\u00e4    20130618 17:22:18",
          "3660: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.SwNavigatorPanel Title   0 fi Rakenneselain    20130618 17:22:18",
          "",
          "[Removed Lines]",
          "3657: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.NumberFormatPropertyPanel Title   0 fi Lukumuoto...    20130618 17:22:18",
          "",
          "[Added Lines]",
          "3657: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.NumberFormatPropertyPanel Title   0 fi Lukumuoto    20130618 17:22:18",
          "",
          "---------------"
        ],
        "extras/l10n/source/pl/localize.sdf||extras/l10n/source/pl/localize.sdf": [
          "File: extras/l10n/source/pl/localize.sdf -> extras/l10n/source/pl/localize.sdf",
          "--- Hunk 1 ---",
          "[Context before]",
          "3633: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.ImpressAnimationEffects Title   0 pl Animacja niestandardowa    20130618 17:22:18",
          "3634: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.SlideTransitionDeck Title   0 pl Przej\u015bcie slajdu    20130618 17:22:18",
          "3635: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.NavigatorDeck Title   0 pl Nawigator    20130618 17:22:18",
          "3637: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.FunctionsDeck Title   0 pl Funkcje    20130618 17:22:18",
          "3638: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.TextPropertyPanel Title   0 pl Tekst    20130618 17:22:18",
          "3639: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.PanelList.ContextPanel Title   0 pl Bie\u017c\u0105cy kontekst (tylko do debugowania)    20130618 17:22:18",
          "",
          "[Removed Lines]",
          "3636: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.StyleListDeck Title   0 pl St~yle i formatowanie    20130618 17:22:18",
          "",
          "[Added Lines]",
          "3636: officecfg registry\\data\\org\\openoffice\\Office\\UI\\Sidebar.xcu 0 value ..Sidebar.Content.DeckList.StyleListDeck Title   0 pl Style i formatowanie    20130618 17:22:18",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2a312b7aa5f2792a87ddd03f5755fe9f9ea9ebdc",
      "candidate_info": {
        "commit_hash": "2a312b7aa5f2792a87ddd03f5755fe9f9ea9ebdc",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/2a312b7aa5f2792a87ddd03f5755fe9f9ea9ebdc",
        "files": [
          "test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java"
        ],
        "message": "updated to enable macro execution.",
        "before_after_code_files": [
          "test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java||test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java||test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java": [
          "File: test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java -> test/testuno/source/fvt/uno/sc/formula/TestFormulaDocs.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "36: import testlib.uno.SCUtil;",
          "37: import static testlib.uno.TestUtil.*;",
          "39: import com.sun.star.lang.XComponent;",
          "40: import com.sun.star.sheet.XSpreadsheet;",
          "41: import com.sun.star.sheet.XSpreadsheetDocument;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39: import com.sun.star.beans.PropertyValue;",
          "40: import com.sun.star.document.MacroExecMode;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "83:  public void testOneDoc( String filename) throws Exception {",
          "85:   String sample = Testspace.prepareData( filename);",
          "87:   XSpreadsheet xSheet = SCUtil.getCurrentSheet( scDoc);",
          "",
          "[Removed Lines]",
          "86:   XSpreadsheetDocument scDoc = SCUtil.openFile( sample, unoApp);",
          "",
          "[Added Lines]",
          "89:   PropertyValue prop = new PropertyValue();",
          "90:   prop.Name = \"MacroExecutionMode\";",
          "91:   prop.Value = MacroExecMode.ALWAYS_EXECUTE_NO_WARN;",
          "92:   XSpreadsheetDocument scDoc = (XSpreadsheetDocument) UnoRuntime.queryInterface(",
          "93:     XSpreadsheetDocument.class, unoApp.loadDocument(sample, prop));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d7e3b64d31330b2db760458b716be70f8f1057d4",
      "candidate_info": {
        "commit_hash": "d7e3b64d31330b2db760458b716be70f8f1057d4",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/d7e3b64d31330b2db760458b716be70f8f1057d4",
        "files": [
          "main/solenv/bin/modules/installer/download.pm"
        ],
        "message": "Added Esperanto as language for NSIS installer\n\n(cherry picked from commit dc294fc16815fb3974b63d1facef0dbdd670666c)",
        "before_after_code_files": [
          "main/solenv/bin/modules/installer/download.pm||main/solenv/bin/modules/installer/download.pm"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/solenv/bin/modules/installer/download.pm||main/solenv/bin/modules/installer/download.pm": [
          "File: main/solenv/bin/modules/installer/download.pm -> main/solenv/bin/modules/installer/download.pm",
          "--- Hunk 1 ---",
          "[Context before]",
          "1211:  elsif ( $language eq \"da\" ) { $nsislanguage = \"Danish\"; }",
          "1212:  elsif ( $language eq \"nl\" ) { $nsislanguage = \"Dutch\"; }",
          "1213:  elsif ( $language eq \"en-GB\" ) { $nsislanguage = \"English\"; }",
          "1214:  elsif ( $language eq \"et\" ) { $nsislanguage = \"Estonian\"; }",
          "1215:  elsif ( $language eq \"fa\" ) { $nsislanguage = \"Farsi\"; }",
          "1216:  elsif ( $language eq \"fi\" ) { $nsislanguage = \"Finnish\"; }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1214:  elsif ( $language eq \"eo\" ) { $nsislanguage = \"Esperanto\"; }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1245:  elsif ( $language eq \"sr-SP\" ) { $nsislanguage = \"Serbian\"; }",
          "1246:  elsif ( $language eq \"sh\" ) { $nsislanguage = \"SerbianLatin\"; }",
          "1247:  elsif ( $language eq \"zh-CN\" ) { $nsislanguage = \"SimpChinese\"; }",
          "1249:  elsif ( $language eq \"sk\" ) { $nsislanguage = \"Slovak\"; }",
          "1250:  elsif ( $language eq \"es\" ) { $nsislanguage = \"Spanish\"; }",
          "1251:  elsif ( $language eq \"sv\" ) { $nsislanguage = \"Swedish\"; }",
          "1252:  elsif ( $language eq \"th\" ) { $nsislanguage = \"Thai\"; }",
          "",
          "[Removed Lines]",
          "1248:  elsif ( $language eq \"sl\" ) { $nsislanguage = \"Slovenian\"; }",
          "",
          "[Added Lines]",
          "1250:  elsif ( $language eq \"sl\" ) { $nsislanguage = \"Slovenian\"; }",
          "",
          "---------------"
        ]
      }
    }
  ]
}