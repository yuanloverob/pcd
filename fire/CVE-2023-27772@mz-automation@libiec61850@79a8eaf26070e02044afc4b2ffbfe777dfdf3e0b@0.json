{
  "cve_id": "CVE-2023-27772",
  "cve_desc": "libiec61850 v1.5.1 was discovered to contain a segmentation violation via the function ControlObjectClient_setOrigin() at /client/client_control.c.",
  "repo": "mz-automation/libiec61850",
  "patch_hash": "79a8eaf26070e02044afc4b2ffbfe777dfdf3e0b",
  "patch_info": {
    "commit_hash": "79a8eaf26070e02044afc4b2ffbfe777dfdf3e0b",
    "repo": "mz-automation/libiec61850",
    "commit_url": "https://github.com/mz-automation/libiec61850/commit/79a8eaf26070e02044afc4b2ffbfe777dfdf3e0b",
    "files": [
      "examples/iec61850_client_example_control/client_example_control.c"
    ],
    "message": "- added missing checks in iec61850_client_example_control (#442)",
    "before_after_code_files": [
      "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c"
    ]
  },
  "patch_diff": {
    "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c": [
      "File: examples/iec61850_client_example_control/client_example_control.c -> examples/iec61850_client_example_control/client_example_control.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "46:     IedConnection_connect(con, &error, hostname, tcpPort);",
      "",
      "[Removed Lines]",
      "48:     if (error == IED_ERROR_OK) {",
      "",
      "[Added Lines]",
      "48:     if (error == IED_ERROR_OK)",
      "49:     {",
      "50:         MmsValue* ctlVal = NULL;",
      "51:         MmsValue* stVal = NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "55:         ControlObjectClient control",
      "56:             = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO1\", con);",
      "82:         }",
      "83:         else {",
      "85:         }",
      "92:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO2\", con);",
      "100:             }",
      "101:             else {",
      "103:             }",
      "106:         }",
      "107:         else {",
      "109:         }",
      "118:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO3\", con);",
      "148:         }",
      "149:         else {",
      "151:         }",
      "",
      "[Removed Lines]",
      "58:         MmsValue* ctlVal = MmsValue_newBoolean(true);",
      "60:         ControlObjectClient_setOrigin(control, NULL, 3);",
      "62:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "63:             printf(\"simpleIOGenericIO/GGIO1.SPCSO1 operated successfully\\n\");",
      "64:         }",
      "65:         else {",
      "66:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO1\\n\");",
      "67:         }",
      "69:         MmsValue_delete(ctlVal);",
      "71:         ControlObjectClient_destroy(control);",
      "75:         MmsValue* stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO1.stVal\", IEC61850_FC_ST);",
      "77:         if (error == IED_ERROR_OK) {",
      "78:             bool state = MmsValue_getBoolean(stVal);",
      "79:             MmsValue_delete(stVal);",
      "81:             printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO1.stVal: %i\\n\", state);",
      "84:             printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO1 failed!\\n\");",
      "94:         if (ControlObjectClient_select(control)) {",
      "96:             ctlVal = MmsValue_newBoolean(true);",
      "98:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "99:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO2 operated successfully\\n\");",
      "102:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
      "105:             MmsValue_delete(ctlVal);",
      "108:             printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
      "111:         ControlObjectClient_destroy(control);",
      "120:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "122:         ctlVal = MmsValue_newBoolean(true);",
      "124:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "125:             printf(\"simpleIOGenericIO/GGIO1.SPCSO3 operated successfully\\n\");",
      "126:         }",
      "127:         else {",
      "128:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO3\\n\");",
      "129:         }",
      "131:         MmsValue_delete(ctlVal);",
      "134:         Thread_sleep(1000);",
      "136:         ControlObjectClient_destroy(control);",
      "140:        stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO3.stVal\", IEC61850_FC_ST);",
      "142:         if (error == IED_ERROR_OK) {",
      "143:             bool state = MmsValue_getBoolean(stVal);",
      "145:             printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO3.stVal: %i\\n\", state);",
      "147:             MmsValue_delete(stVal);",
      "150:             printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO3 failed!\\n\");",
      "",
      "[Added Lines]",
      "60:         if (control)",
      "61:         {",
      "62:             ctlVal = MmsValue_newBoolean(true);",
      "64:             ControlObjectClient_setOrigin(control, NULL, 3);",
      "66:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "67:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO1 operated successfully\\n\");",
      "68:             }",
      "69:             else {",
      "70:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO1\\n\");",
      "71:             }",
      "73:             MmsValue_delete(ctlVal);",
      "75:             ControlObjectClient_destroy(control);",
      "79:             stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO1.stVal\", IEC61850_FC_ST);",
      "81:             if (error == IED_ERROR_OK) {",
      "82:                 bool state = MmsValue_getBoolean(stVal);",
      "83:                 MmsValue_delete(stVal);",
      "85:                 printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO1.stVal: %i\\n\", state);",
      "86:             }",
      "87:             else {",
      "88:                 printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO1 failed!\\n\");",
      "89:             }",
      "93:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO1 not found in server\\n\");",
      "102:         if (control)",
      "103:         {",
      "104:             if (ControlObjectClient_select(control)) {",
      "106:                 ctlVal = MmsValue_newBoolean(true);",
      "108:                 if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "109:                     printf(\"simpleIOGenericIO/GGIO1.SPCSO2 operated successfully\\n\");",
      "110:                 }",
      "111:                 else {",
      "112:                     printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
      "113:                 }",
      "115:                 MmsValue_delete(ctlVal);",
      "118:                 printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
      "121:             ControlObjectClient_destroy(control);",
      "124:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO2 not found in server\\n\");",
      "133:         if (control)",
      "134:         {",
      "135:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "137:             ctlVal = MmsValue_newBoolean(true);",
      "139:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "140:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO3 operated successfully\\n\");",
      "141:             }",
      "142:             else {",
      "143:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO3\\n\");",
      "144:             }",
      "146:             MmsValue_delete(ctlVal);",
      "149:             Thread_sleep(1000);",
      "151:             ControlObjectClient_destroy(control);",
      "155:             stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO3.stVal\", IEC61850_FC_ST);",
      "157:             if (error == IED_ERROR_OK) {",
      "158:                 bool state = MmsValue_getBoolean(stVal);",
      "160:                 printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO3.stVal: %i\\n\", state);",
      "162:                 MmsValue_delete(stVal);",
      "163:             }",
      "164:             else {",
      "165:                 printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO3 failed!\\n\");",
      "166:             }",
      "169:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO3 not found in server\\n\");",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "157:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO4\", con);",
      "167:             }",
      "168:             else {",
      "170:             }",
      "172:         }",
      "173:         else {",
      "175:         }",
      "189:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO9\", con);",
      "210:         IedConnection_close(con);",
      "211:     }",
      "",
      "[Removed Lines]",
      "159:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "161:         ctlVal = MmsValue_newBoolean(true);",
      "163:         if (ControlObjectClient_selectWithValue(control, ctlVal)) {",
      "165:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "166:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO4 operated successfully\\n\");",
      "169:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
      "174:             printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
      "177:         MmsValue_delete(ctlVal);",
      "180:         Thread_sleep(1000);",
      "182:         ControlObjectClient_destroy(control);",
      "191:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "193:         ctlVal = MmsValue_newBoolean(true);",
      "195:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "196:             printf(\"simpleIOGenericIO/GGIO1.SPCSO9 operated successfully\\n\");",
      "197:         }",
      "198:         else {",
      "199:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO9\\n\");",
      "200:         }",
      "202:         MmsValue_delete(ctlVal);",
      "205:         Thread_sleep(1000);",
      "207:         ControlObjectClient_destroy(control);",
      "",
      "[Added Lines]",
      "178:         if (control)",
      "179:         {",
      "180:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "182:             ctlVal = MmsValue_newBoolean(true);",
      "184:             if (ControlObjectClient_selectWithValue(control, ctlVal)) {",
      "186:                 if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "187:                     printf(\"simpleIOGenericIO/GGIO1.SPCSO4 operated successfully\\n\");",
      "188:                 }",
      "189:                 else {",
      "190:                     printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
      "191:                 }",
      "195:                 printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
      "198:             MmsValue_delete(ctlVal);",
      "201:             Thread_sleep(1000);",
      "203:             ControlObjectClient_destroy(control);",
      "206:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO4 not found in server\\n\");",
      "215:         if (control)",
      "216:         {",
      "217:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
      "219:             ctlVal = MmsValue_newBoolean(true);",
      "221:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
      "222:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO9 operated successfully\\n\");",
      "223:             }",
      "224:             else {",
      "225:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO9\\n\");",
      "226:             }",
      "228:             MmsValue_delete(ctlVal);",
      "231:             Thread_sleep(1000);",
      "233:             ControlObjectClient_destroy(control);",
      "234:         }",
      "235:         else {",
      "236:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO9 not found in server\\n\");",
      "237:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "cb87b8d9ff88e52343b34e93e9502908c2c00804",
      "candidate_info": {
        "commit_hash": "cb87b8d9ff88e52343b34e93e9502908c2c00804",
        "repo": "mz-automation/libiec61850",
        "commit_url": "https://github.com/mz-automation/libiec61850/commit/cb87b8d9ff88e52343b34e93e9502908c2c00804",
        "files": [
          "examples/iec61850_client_example_control/client_example_control.c"
        ],
        "message": "- added missing checks in iec61850_client_example_control (#442)",
        "before_after_code_files": [
          "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c"
          ],
          "candidate": [
            "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c"
          ]
        }
      },
      "candidate_diff": {
        "examples/iec61850_client_example_control/client_example_control.c||examples/iec61850_client_example_control/client_example_control.c": [
          "File: examples/iec61850_client_example_control/client_example_control.c -> examples/iec61850_client_example_control/client_example_control.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:     IedConnection_connect(con, &error, hostname, tcpPort);",
          "",
          "[Removed Lines]",
          "48:     if (error == IED_ERROR_OK) {",
          "",
          "[Added Lines]",
          "48:     if (error == IED_ERROR_OK)",
          "49:     {",
          "50:         MmsValue* ctlVal = NULL;",
          "51:         MmsValue* stVal = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "55:         ControlObjectClient control",
          "56:             = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO1\", con);",
          "82:         }",
          "83:         else {",
          "85:         }",
          "92:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO2\", con);",
          "100:             }",
          "101:             else {",
          "103:             }",
          "106:         }",
          "107:         else {",
          "109:         }",
          "118:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO3\", con);",
          "148:         }",
          "149:         else {",
          "151:         }",
          "",
          "[Removed Lines]",
          "58:         MmsValue* ctlVal = MmsValue_newBoolean(true);",
          "60:         ControlObjectClient_setOrigin(control, NULL, 3);",
          "62:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "63:             printf(\"simpleIOGenericIO/GGIO1.SPCSO1 operated successfully\\n\");",
          "64:         }",
          "65:         else {",
          "66:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO1\\n\");",
          "67:         }",
          "69:         MmsValue_delete(ctlVal);",
          "71:         ControlObjectClient_destroy(control);",
          "75:         MmsValue* stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO1.stVal\", IEC61850_FC_ST);",
          "77:         if (error == IED_ERROR_OK) {",
          "78:             bool state = MmsValue_getBoolean(stVal);",
          "79:             MmsValue_delete(stVal);",
          "81:             printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO1.stVal: %i\\n\", state);",
          "84:             printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO1 failed!\\n\");",
          "94:         if (ControlObjectClient_select(control)) {",
          "96:             ctlVal = MmsValue_newBoolean(true);",
          "98:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "99:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO2 operated successfully\\n\");",
          "102:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
          "105:             MmsValue_delete(ctlVal);",
          "108:             printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
          "111:         ControlObjectClient_destroy(control);",
          "120:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "122:         ctlVal = MmsValue_newBoolean(true);",
          "124:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "125:             printf(\"simpleIOGenericIO/GGIO1.SPCSO3 operated successfully\\n\");",
          "126:         }",
          "127:         else {",
          "128:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO3\\n\");",
          "129:         }",
          "131:         MmsValue_delete(ctlVal);",
          "134:         Thread_sleep(1000);",
          "136:         ControlObjectClient_destroy(control);",
          "140:        stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO3.stVal\", IEC61850_FC_ST);",
          "142:         if (error == IED_ERROR_OK) {",
          "143:             bool state = MmsValue_getBoolean(stVal);",
          "145:             printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO3.stVal: %i\\n\", state);",
          "147:             MmsValue_delete(stVal);",
          "150:             printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO3 failed!\\n\");",
          "",
          "[Added Lines]",
          "60:         if (control)",
          "61:         {",
          "62:             ctlVal = MmsValue_newBoolean(true);",
          "64:             ControlObjectClient_setOrigin(control, NULL, 3);",
          "66:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "67:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO1 operated successfully\\n\");",
          "68:             }",
          "69:             else {",
          "70:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO1\\n\");",
          "71:             }",
          "73:             MmsValue_delete(ctlVal);",
          "75:             ControlObjectClient_destroy(control);",
          "79:             stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO1.stVal\", IEC61850_FC_ST);",
          "81:             if (error == IED_ERROR_OK) {",
          "82:                 bool state = MmsValue_getBoolean(stVal);",
          "83:                 MmsValue_delete(stVal);",
          "85:                 printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO1.stVal: %i\\n\", state);",
          "86:             }",
          "87:             else {",
          "88:                 printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO1 failed!\\n\");",
          "89:             }",
          "93:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO1 not found in server\\n\");",
          "102:         if (control)",
          "103:         {",
          "104:             if (ControlObjectClient_select(control)) {",
          "106:                 ctlVal = MmsValue_newBoolean(true);",
          "108:                 if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "109:                     printf(\"simpleIOGenericIO/GGIO1.SPCSO2 operated successfully\\n\");",
          "110:                 }",
          "111:                 else {",
          "112:                     printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
          "113:                 }",
          "115:                 MmsValue_delete(ctlVal);",
          "118:                 printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO2!\\n\");",
          "121:             ControlObjectClient_destroy(control);",
          "124:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO2 not found in server\\n\");",
          "133:         if (control)",
          "134:         {",
          "135:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "137:             ctlVal = MmsValue_newBoolean(true);",
          "139:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "140:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO3 operated successfully\\n\");",
          "141:             }",
          "142:             else {",
          "143:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO3\\n\");",
          "144:             }",
          "146:             MmsValue_delete(ctlVal);",
          "149:             Thread_sleep(1000);",
          "151:             ControlObjectClient_destroy(control);",
          "155:             stVal = IedConnection_readObject(con, &error, \"simpleIOGenericIO/GGIO1.SPCSO3.stVal\", IEC61850_FC_ST);",
          "157:             if (error == IED_ERROR_OK) {",
          "158:                 bool state = MmsValue_getBoolean(stVal);",
          "160:                 printf(\"New status of simpleIOGenericIO/GGIO1.SPCSO3.stVal: %i\\n\", state);",
          "162:                 MmsValue_delete(stVal);",
          "163:             }",
          "164:             else {",
          "165:                 printf(\"Reading status for simpleIOGenericIO/GGIO1.SPCSO3 failed!\\n\");",
          "166:             }",
          "169:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO3 not found in server\\n\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "157:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO4\", con);",
          "167:             }",
          "168:             else {",
          "170:             }",
          "172:         }",
          "173:         else {",
          "175:         }",
          "189:         control = ControlObjectClient_create(\"simpleIOGenericIO/GGIO1.SPCSO9\", con);",
          "210:         IedConnection_close(con);",
          "211:     }",
          "",
          "[Removed Lines]",
          "159:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "161:         ctlVal = MmsValue_newBoolean(true);",
          "163:         if (ControlObjectClient_selectWithValue(control, ctlVal)) {",
          "165:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "166:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO4 operated successfully\\n\");",
          "169:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
          "174:             printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
          "177:         MmsValue_delete(ctlVal);",
          "180:         Thread_sleep(1000);",
          "182:         ControlObjectClient_destroy(control);",
          "191:         ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "193:         ctlVal = MmsValue_newBoolean(true);",
          "195:         if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "196:             printf(\"simpleIOGenericIO/GGIO1.SPCSO9 operated successfully\\n\");",
          "197:         }",
          "198:         else {",
          "199:             printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO9\\n\");",
          "200:         }",
          "202:         MmsValue_delete(ctlVal);",
          "205:         Thread_sleep(1000);",
          "207:         ControlObjectClient_destroy(control);",
          "",
          "[Added Lines]",
          "178:         if (control)",
          "179:         {",
          "180:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "182:             ctlVal = MmsValue_newBoolean(true);",
          "184:             if (ControlObjectClient_selectWithValue(control, ctlVal)) {",
          "186:                 if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "187:                     printf(\"simpleIOGenericIO/GGIO1.SPCSO4 operated successfully\\n\");",
          "188:                 }",
          "189:                 else {",
          "190:                     printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
          "191:                 }",
          "195:                 printf(\"failed to select simpleIOGenericIO/GGIO1.SPCSO4!\\n\");",
          "198:             MmsValue_delete(ctlVal);",
          "201:             Thread_sleep(1000);",
          "203:             ControlObjectClient_destroy(control);",
          "206:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO4 not found in server\\n\");",
          "215:         if (control)",
          "216:         {",
          "217:             ControlObjectClient_setCommandTerminationHandler(control, commandTerminationHandler, NULL);",
          "219:             ctlVal = MmsValue_newBoolean(true);",
          "221:             if (ControlObjectClient_operate(control, ctlVal, 0 /* operate now */)) {",
          "222:                 printf(\"simpleIOGenericIO/GGIO1.SPCSO9 operated successfully\\n\");",
          "223:             }",
          "224:             else {",
          "225:                 printf(\"failed to operate simpleIOGenericIO/GGIO1.SPCSO9\\n\");",
          "226:             }",
          "228:             MmsValue_delete(ctlVal);",
          "231:             Thread_sleep(1000);",
          "233:             ControlObjectClient_destroy(control);",
          "234:         }",
          "235:         else {",
          "236:             printf(\"Control object simpleIOGenericIO/GGIO1.SPCSO9 not found in server\\n\");",
          "237:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}