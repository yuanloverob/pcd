{
  "cve_id": "CVE-2024-1433",
  "cve_desc": "A vulnerability, which was classified as problematic, was found in KDE Plasma Workspace up to 5.93.0. This affects the function EventPluginsManager::enabledPlugins of the file components/calendar/eventpluginsmanager.cpp of the component Theme File Handler. The manipulation of the argument pluginId leads to path traversal. It is possible to initiate the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The patch is named 6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-253407. NOTE: This requires write access to user's home or the installation of third party global themes.",
  "repo": "KDE/plasma-workspace",
  "patch_hash": "6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01",
  "patch_info": {
    "commit_hash": "6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01",
    "repo": "KDE/plasma-workspace",
    "commit_url": "https://github.com/KDE/plasma-workspace/commit/6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01",
    "files": [
      "components/calendar/eventpluginsmanager.cpp"
    ],
    "message": "plasmacalendarintegration: Fix directory traversal vulnerability in events plugins\n\ndigital-calendar plasma applet is vulnerable to directory traversal attack which allows an arbitrary .so library file to be leaded as a plasma calendar plugin.\n\nThis vulnerability can be triggered via theme files that provide a config for the digital-clock applet which includes `enabledCalendarPlugins` that uses directory traversal to load arbitrary .so from the filesystem.\n\nThis requires write access to user's home or the installation of third party global themes so is not directly exploitable by anything which did not have access already, however it should be fixed regardless.",
    "before_after_code_files": [
      "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
    ]
  },
  "patch_diff": {
    "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp": [
      "File: components/calendar/eventpluginsmanager.cpp -> components/calendar/eventpluginsmanager.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "202: void EventPluginsManager::loadPlugin(const QString &pluginId)",
      "203: {",
      "206:     if (!loader.load()) {",
      "207:         qWarning() << \"Could not create Plasma Calendar Plugin: \" << pluginId;",
      "",
      "[Removed Lines]",
      "204:     QPluginLoader loader(\"plasmacalendarplugins/\" + pluginId);",
      "",
      "[Added Lines]",
      "204:     QPluginLoader loader(\"plasmacalendarplugins/\" + QDir::cleanPath(pluginId));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5377fe60c566593825acee09a38c29dc3053c660",
      "candidate_info": {
        "commit_hash": "5377fe60c566593825acee09a38c29dc3053c660",
        "repo": "KDE/plasma-workspace",
        "commit_url": "https://github.com/KDE/plasma-workspace/commit/5377fe60c566593825acee09a38c29dc3053c660",
        "files": [
          "components/calendar/eventpluginsmanager.cpp"
        ],
        "message": "plasmacalendarintegration: Fix directory traversal vulnerability in events plugins\n\ndigital-calendar plasma applet is vulnerable to directory traversal attack which allows an arbitrary .so library file to be leaded as a plasma calendar plugin.\n\nThis vulnerability can be triggered via theme files that provide a config for the digital-clock applet which includes `enabledCalendarPlugins` that uses directory traversal to load arbitrary .so from the filesystem.\n\nThis requires write access to user's home or the installation of third party global themes so is not directly exploitable by anything which did not have access already, however it should be fixed regardless.\n\n\n(cherry picked from commit 6cdf42916369ebf4ad5bd876c4dfa0170d7b2f01)",
        "before_after_code_files": [
          "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
          ],
          "candidate": [
            "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
          ]
        }
      },
      "candidate_diff": {
        "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp": [
          "File: components/calendar/eventpluginsmanager.cpp -> components/calendar/eventpluginsmanager.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "202: void EventPluginsManager::loadPlugin(const QString &pluginId)",
          "203: {",
          "206:     if (!loader.load()) {",
          "207:         qWarning() << \"Could not create Plasma Calendar Plugin: \" << pluginId;",
          "",
          "[Removed Lines]",
          "204:     QPluginLoader loader(\"plasmacalendarplugins/\" + pluginId);",
          "",
          "[Added Lines]",
          "204:     QPluginLoader loader(\"plasmacalendarplugins/\" + QDir::cleanPath(pluginId));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5358c2b52bfe0fcaa9b08df024db6100c4c3ee54",
      "candidate_info": {
        "commit_hash": "5358c2b52bfe0fcaa9b08df024db6100c4c3ee54",
        "repo": "KDE/plasma-workspace",
        "commit_url": "https://github.com/KDE/plasma-workspace/commit/5358c2b52bfe0fcaa9b08df024db6100c4c3ee54",
        "files": [
          "components/calendar/eventpluginsmanager.cpp"
        ],
        "message": "components/calendar: reduce string allocation\n\nRequired to enable modern KDE_COMPILERSETTINGS_LEVEL",
        "before_after_code_files": [
          "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
          ],
          "candidate": [
            "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp"
          ]
        }
      },
      "candidate_diff": {
        "components/calendar/eventpluginsmanager.cpp||components/calendar/eventpluginsmanager.cpp": [
          "File: components/calendar/eventpluginsmanager.cpp -> components/calendar/eventpluginsmanager.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: #include <KPluginMetaData>",
          "18: class EventPluginsManagerPrivate",
          "19: {",
          "20: public:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18: using namespace Qt::StringLiterals;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "204: void EventPluginsManager::loadPlugin(const QString &pluginId)",
          "205: {",
          "208:     if (!loader.load()) {",
          "209:         qWarning() << \"Could not create Plasma Calendar Plugin: \" << pluginId;",
          "",
          "[Removed Lines]",
          "206:     QPluginLoader loader(\"plasmacalendarplugins/\" + QDir::cleanPath(pluginId));",
          "",
          "[Added Lines]",
          "208:     QPluginLoader loader(\"plasmacalendarplugins/\"_L1 + QDir::cleanPath(pluginId));",
          "",
          "---------------"
        ]
      }
    }
  ]
}