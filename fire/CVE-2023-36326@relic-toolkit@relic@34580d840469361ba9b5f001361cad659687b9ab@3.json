{
  "cve_id": "CVE-2023-36326",
  "cve_desc": "Integer Overflow vulnerability in RELIC before commit 34580d840469361ba9b5f001361cad659687b9ab, allows attackers to execute arbitrary code, cause a denial of service, and escalate privileges when calling realloc function in bn_grow function.",
  "repo": "relic-toolkit/relic",
  "patch_hash": "34580d840469361ba9b5f001361cad659687b9ab",
  "patch_info": {
    "commit_hash": "34580d840469361ba9b5f001361cad659687b9ab",
    "repo": "relic-toolkit/relic",
    "commit_url": "https://github.com/relic-toolkit/relic/commit/34580d840469361ba9b5f001361cad659687b9ab",
    "files": [
      "bench/bench_bn.c",
      "bench/bench_cp.c",
      "bench/bench_epx.c",
      "include/relic_bn.h",
      "include/relic_cp.h",
      "include/relic_eb.h",
      "include/relic_ed.h",
      "include/relic_ep.h",
      "include/relic_epx.h",
      "include/relic_fb.h",
      "include/relic_fp.h",
      "include/relic_fpx.h",
      "include/relic_md.h",
      "include/relic_rand.h",
      "include/relic_util.h",
      "src/bn/relic_bn_gcd.c",
      "src/bn/relic_bn_mem.c",
      "src/bn/relic_bn_mxp.c",
      "src/bn/relic_bn_prime.c",
      "src/bn/relic_bn_rec.c",
      "src/bn/relic_bn_shift.c",
      "src/bn/relic_bn_smb.c",
      "src/bn/relic_bn_srt.c",
      "src/bn/relic_bn_util.c",
      "src/cp/relic_cp_bls.c",
      "src/cp/relic_cp_cmlhs.c",
      "src/cp/relic_cp_pbpsi.c",
      "src/cp/relic_cp_rsa.c",
      "src/cp/relic_cp_sokaka.c",
      "src/cp/relic_cp_vbnn.c",
      "src/eb/relic_eb_map.c",
      "src/eb/relic_eb_mul.c",
      "src/eb/relic_eb_mul_sim.c",
      "src/eb/relic_eb_util.c",
      "src/ed/relic_ed_map.c",
      "src/ed/relic_ed_mul.c",
      "src/ed/relic_ed_mul_fix.c",
      "src/ed/relic_ed_mul_sim.c",
      "src/ed/relic_ed_util.c",
      "src/ep/relic_ep_map.c",
      "src/ep/relic_ep_mul.c",
      "src/ep/relic_ep_mul_fix.c",
      "src/ep/relic_ep_mul_sim.c",
      "src/ep/relic_ep_util.c",
      "src/epx/relic_ep2_map.c",
      "src/epx/relic_ep2_mul.c",
      "src/epx/relic_ep2_mul_fix.c",
      "src/epx/relic_ep2_mul_sim.c",
      "src/epx/relic_ep2_util.c",
      "src/epx/relic_ep4_map.c",
      "src/epx/relic_ep4_mul.c",
      "src/epx/relic_ep4_mul_fix.c",
      "src/epx/relic_ep4_mul_sim.c",
      "src/epx/relic_ep4_util.c",
      "src/fb/relic_fb_exp.c",
      "src/fb/relic_fb_util.c",
      "src/fp/relic_fp_exp.c",
      "src/fp/relic_fp_prime.c",
      "src/fp/relic_fp_util.c",
      "src/fpx/relic_fpx_cyc.c",
      "src/fpx/relic_fpx_exp.c",
      "src/fpx/relic_fpx_util.c",
      "src/md/relic_md_blake2s.c",
      "src/md/relic_md_hmac.c",
      "src/md/relic_md_kdf.c",
      "src/md/relic_md_mgf.c",
      "src/md/relic_md_sha224.c",
      "src/md/relic_md_sha256.c",
      "src/md/relic_md_sha384.c",
      "src/md/relic_md_sha512.c",
      "src/pp/relic_pp_map_k12.c",
      "src/pp/relic_pp_map_k24.c",
      "src/pp/relic_pp_map_k48.c",
      "src/pp/relic_pp_map_k54.c",
      "src/pp/relic_pp_map_k8.c",
      "src/rand/relic_rand_core.c",
      "src/rand/relic_rand_hashd.c",
      "src/relic_util.c",
      "test/test_bn.c",
      "test/test_core.c",
      "test/test_pc.c",
      "test/test_rand.c"
    ],
    "message": "Huge commit improving the API to use size_t instead of int.",
    "before_after_code_files": [
      "bench/bench_bn.c||bench/bench_bn.c",
      "bench/bench_cp.c||bench/bench_cp.c",
      "bench/bench_epx.c||bench/bench_epx.c",
      "include/relic_bn.h||include/relic_bn.h",
      "include/relic_cp.h||include/relic_cp.h",
      "include/relic_eb.h||include/relic_eb.h",
      "include/relic_ed.h||include/relic_ed.h",
      "include/relic_ep.h||include/relic_ep.h",
      "include/relic_epx.h||include/relic_epx.h",
      "include/relic_fb.h||include/relic_fb.h",
      "include/relic_fp.h||include/relic_fp.h",
      "include/relic_fpx.h||include/relic_fpx.h",
      "include/relic_md.h||include/relic_md.h",
      "include/relic_rand.h||include/relic_rand.h",
      "include/relic_util.h||include/relic_util.h",
      "src/bn/relic_bn_gcd.c||src/bn/relic_bn_gcd.c",
      "src/bn/relic_bn_mem.c||src/bn/relic_bn_mem.c",
      "src/bn/relic_bn_mxp.c||src/bn/relic_bn_mxp.c",
      "src/bn/relic_bn_prime.c||src/bn/relic_bn_prime.c",
      "src/bn/relic_bn_rec.c||src/bn/relic_bn_rec.c",
      "src/bn/relic_bn_shift.c||src/bn/relic_bn_shift.c",
      "src/bn/relic_bn_smb.c||src/bn/relic_bn_smb.c",
      "src/bn/relic_bn_srt.c||src/bn/relic_bn_srt.c",
      "src/bn/relic_bn_util.c||src/bn/relic_bn_util.c",
      "src/cp/relic_cp_bls.c||src/cp/relic_cp_bls.c",
      "src/cp/relic_cp_cmlhs.c||src/cp/relic_cp_cmlhs.c",
      "src/cp/relic_cp_pbpsi.c||src/cp/relic_cp_pbpsi.c",
      "src/cp/relic_cp_rsa.c||src/cp/relic_cp_rsa.c",
      "src/cp/relic_cp_sokaka.c||src/cp/relic_cp_sokaka.c",
      "src/cp/relic_cp_vbnn.c||src/cp/relic_cp_vbnn.c",
      "src/eb/relic_eb_map.c||src/eb/relic_eb_map.c",
      "src/eb/relic_eb_mul.c||src/eb/relic_eb_mul.c",
      "src/eb/relic_eb_mul_sim.c||src/eb/relic_eb_mul_sim.c",
      "src/eb/relic_eb_util.c||src/eb/relic_eb_util.c",
      "src/ed/relic_ed_map.c||src/ed/relic_ed_map.c",
      "src/ed/relic_ed_mul.c||src/ed/relic_ed_mul.c",
      "src/ed/relic_ed_mul_fix.c||src/ed/relic_ed_mul_fix.c",
      "src/ed/relic_ed_mul_sim.c||src/ed/relic_ed_mul_sim.c",
      "src/ed/relic_ed_util.c||src/ed/relic_ed_util.c",
      "src/ep/relic_ep_map.c||src/ep/relic_ep_map.c",
      "src/ep/relic_ep_mul.c||src/ep/relic_ep_mul.c",
      "src/ep/relic_ep_mul_fix.c||src/ep/relic_ep_mul_fix.c",
      "src/ep/relic_ep_mul_sim.c||src/ep/relic_ep_mul_sim.c",
      "src/ep/relic_ep_util.c||src/ep/relic_ep_util.c",
      "src/epx/relic_ep2_map.c||src/epx/relic_ep2_map.c",
      "src/epx/relic_ep2_mul.c||src/epx/relic_ep2_mul.c",
      "src/epx/relic_ep2_mul_fix.c||src/epx/relic_ep2_mul_fix.c",
      "src/epx/relic_ep2_mul_sim.c||src/epx/relic_ep2_mul_sim.c",
      "src/epx/relic_ep2_util.c||src/epx/relic_ep2_util.c",
      "src/epx/relic_ep4_map.c||src/epx/relic_ep4_map.c",
      "src/epx/relic_ep4_mul.c||src/epx/relic_ep4_mul.c",
      "src/epx/relic_ep4_mul_fix.c||src/epx/relic_ep4_mul_fix.c",
      "src/epx/relic_ep4_mul_sim.c||src/epx/relic_ep4_mul_sim.c",
      "src/epx/relic_ep4_util.c||src/epx/relic_ep4_util.c",
      "src/fb/relic_fb_exp.c||src/fb/relic_fb_exp.c",
      "src/fb/relic_fb_util.c||src/fb/relic_fb_util.c",
      "src/fp/relic_fp_exp.c||src/fp/relic_fp_exp.c",
      "src/fp/relic_fp_prime.c||src/fp/relic_fp_prime.c",
      "src/fp/relic_fp_util.c||src/fp/relic_fp_util.c",
      "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c",
      "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c",
      "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c",
      "src/md/relic_md_blake2s.c||src/md/relic_md_blake2s.c",
      "src/md/relic_md_hmac.c||src/md/relic_md_hmac.c",
      "src/md/relic_md_kdf.c||src/md/relic_md_kdf.c",
      "src/md/relic_md_mgf.c||src/md/relic_md_mgf.c",
      "src/md/relic_md_sha224.c||src/md/relic_md_sha224.c",
      "src/md/relic_md_sha256.c||src/md/relic_md_sha256.c",
      "src/md/relic_md_sha384.c||src/md/relic_md_sha384.c",
      "src/md/relic_md_sha512.c||src/md/relic_md_sha512.c",
      "src/pp/relic_pp_map_k12.c||src/pp/relic_pp_map_k12.c",
      "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c",
      "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c",
      "src/pp/relic_pp_map_k54.c||src/pp/relic_pp_map_k54.c",
      "src/pp/relic_pp_map_k8.c||src/pp/relic_pp_map_k8.c",
      "src/rand/relic_rand_core.c||src/rand/relic_rand_core.c",
      "src/rand/relic_rand_hashd.c||src/rand/relic_rand_hashd.c",
      "src/relic_util.c||src/relic_util.c",
      "test/test_bn.c||test/test_bn.c",
      "test/test_core.c||test/test_core.c",
      "test/test_pc.c||test/test_pc.c",
      "test/test_rand.c||test/test_rand.c"
    ]
  },
  "patch_diff": {
    "bench/bench_bn.c||bench/bench_bn.c": [
      "File: bench/bench_bn.c -> bench/bench_bn.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "284:  bn_t a, b, c, d[3], e[3];",
      "285:  crt_t crt;",
      "286:  dig_t f;",
      "289:  bn_null(a);",
      "290:  bn_null(b);",
      "",
      "[Removed Lines]",
      "287:  int len;",
      "",
      "[Added Lines]",
      "287:  size_t len;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "892:  BENCH_RUN(\"bn_rec_naf\") {",
      "893:   int8_t naf[RLC_BN_BITS + 1];",
      "895:   bn_rand(a, RLC_POS, RLC_BN_BITS);",
      "896:   BENCH_ADD((len = RLC_BN_BITS + 1, bn_rec_naf(naf, &len, a, 4)));",
      "897:  }",
      "",
      "[Removed Lines]",
      "894:   int len;",
      "",
      "[Added Lines]",
      "894:   size_t len;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "901:  if (eb_param_set_any_kbltz() == RLC_OK) {",
      "902:   BENCH_RUN(\"bn_rec_tnaf\") {",
      "903:    int8_t tnaf[RLC_FB_BITS + 8];",
      "905:    eb_curve_get_ord(b);",
      "906:    bn_rand_mod(a, b);",
      "907:    if (eb_curve_opt_a() == RLC_ZERO) {",
      "",
      "[Removed Lines]",
      "904:    int len = RLC_BN_BITS + 1;",
      "",
      "[Added Lines]",
      "904:    size_t len = RLC_BN_BITS + 1;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "929:  BENCH_RUN(\"bn_rec_reg\") {",
      "930:   int8_t naf[RLC_BN_BITS + 1];",
      "932:   bn_rand(a, RLC_POS, RLC_BN_BITS);",
      "933:   BENCH_ADD((len = RLC_BN_BITS + 1, bn_rec_reg(naf, &len, a, RLC_BN_BITS, 4)));",
      "934:  }",
      "",
      "[Removed Lines]",
      "931:   int len = RLC_BN_BITS + 1;",
      "",
      "[Added Lines]",
      "931:   size_t len = RLC_BN_BITS + 1;",
      "",
      "---------------"
    ],
    "bench/bench_cp.c||bench/bench_cp.c": [
      "File: bench/bench_cp.c -> bench/bench_cp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "141:  dig_t in, new;",
      "142:  uint8_t out[RLC_BN_BITS / 8 + 1];",
      "143:  size_t out_len;",
      "145:  bdpe_null(pub);",
      "146:  bdpe_null(prv);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "144:  dig_t prime = 0xFB;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "148:  bdpe_new(pub);",
      "149:  bdpe_new(prv);",
      "154:  BENCH_RUN(\"cp_bdpe_enc\") {",
      "155:   out_len = RLC_BN_BITS / 8 + 1;",
      "156:   rand_bytes(out, 1);",
      "158:   BENCH_ADD(cp_bdpe_enc(out, &out_len, in, pub));",
      "159:   cp_bdpe_dec(&new, out, out_len, prv);",
      "160:  } BENCH_END;",
      "",
      "[Removed Lines]",
      "151:  BENCH_ONE(\"cp_bdpe_gen\", cp_bdpe_gen(pub, prv, bn_get_prime(47),",
      "152:   RLC_BN_BITS), 1);",
      "157:   in = out[0] % bn_get_prime(47);",
      "",
      "[Added Lines]",
      "152:  BENCH_ONE(\"cp_bdpe_gen\", cp_bdpe_gen(pub, prv, prime, RLC_BN_BITS), 1);",
      "157:   in = out[0] % prime;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "162:  BENCH_RUN(\"cp_bdpe_dec\") {",
      "163:   out_len = RLC_BN_BITS / 8 + 1;",
      "164:   rand_bytes(out, 1);",
      "166:   cp_bdpe_enc(out, &out_len, in, pub);",
      "167:   BENCH_ADD(cp_bdpe_dec(&new, out, out_len, prv));",
      "168:  } BENCH_END;",
      "",
      "[Removed Lines]",
      "165:   in = out[0] % bn_get_prime(47);",
      "",
      "[Added Lines]",
      "165:   in = out[0] % prime;",
      "",
      "---------------"
    ],
    "bench/bench_epx.c||bench/bench_epx.c": [
      "File: bench/bench_epx.c -> bench/bench_epx.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "37: static void memory2(void) {",
      "38:  ep2_t a[BENCH];",
      "43:  for (int i = 0; i < BENCH; i++) {",
      "44:   ep2_free(a[i]);",
      "45:  }",
      "",
      "[Removed Lines]",
      "40:  BENCH_FEW(\"ep2_null\", ep4_null(a[i]), 1);",
      "42:  BENCH_FEW(\"ep2_new\", ep4_new(a[i]), 1);",
      "",
      "[Added Lines]",
      "40:  BENCH_FEW(\"ep2_null\", ep2_null(a[i]), 1);",
      "42:  BENCH_FEW(\"ep2_new\", ep2_new(a[i]), 1);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "47:  for (int i = 0; i < BENCH; i++) {",
      "48:   ep2_new(a[i]);",
      "49:  }",
      "52:  (void)a;",
      "53: }",
      "",
      "[Removed Lines]",
      "50:  BENCH_FEW(\"ep2_free\", ep4_free(a[i]), 1);",
      "",
      "[Added Lines]",
      "50:  BENCH_FEW(\"ep2_free\", ep2_free(a[i]), 1);",
      "",
      "---------------"
    ],
    "include/relic_bn.h||include/relic_bn.h": [
      "File: include/relic_bn.h -> include/relic_bn.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "66: #if BN_MAGNI == DOUBLE",
      "68: #elif BN_MAGNI == CARRY",
      "70: #elif BN_MAGNI == SINGLE",
      "72: #endif",
      "",
      "[Removed Lines]",
      "56: #define RLC_BN_BITS  ((int)BN_PRECI)",
      "61: #define RLC_BN_DIGS  ((int)RLC_CEIL(BN_PRECI, RLC_DIG))",
      "67: #define RLC_BN_SIZE  ((int)(2 * RLC_BN_DIGS + 2))",
      "69: #define RLC_BN_SIZE  ((int)(RLC_BN_DIGS + 1))",
      "71: #define RLC_BN_SIZE  ((int)RLC_BN_DIGS)",
      "",
      "[Added Lines]",
      "56: #define RLC_BN_BITS  ((size_t)BN_PRECI)",
      "61: #define RLC_BN_DIGS  ((size_t)RLC_CEIL(BN_PRECI, RLC_DIG))",
      "67: #define RLC_BN_SIZE  ((size_t)(2 * RLC_BN_DIGS + 2))",
      "69: #define RLC_BN_SIZE  ((size_t)(RLC_BN_DIGS + 1))",
      "71: #define RLC_BN_SIZE  ((size_t)RLC_BN_DIGS)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "95: typedef struct {",
      "101:  int sign;",
      "102: #if ALLOC == DYNAMIC",
      "",
      "[Removed Lines]",
      "97:  int alloc;",
      "99:  int used;",
      "",
      "[Added Lines]",
      "97:  size_t alloc;",
      "99:  size_t used;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "460: void bn_make(bn_t a, int digits);",
      "",
      "[Added Lines]",
      "460: void bn_make(bn_t a, size_t digits);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "479: void bn_grow(bn_t a, int digits);",
      "",
      "[Added Lines]",
      "479: void bn_grow(bn_t a, size_t digits);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "549: int bn_bits(const bn_t a);",
      "",
      "[Added Lines]",
      "549: size_t bn_bits(const bn_t a);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "558: int bn_get_bit(const bn_t a, int bit);",
      "",
      "[Added Lines]",
      "558: int bn_get_bit(const bn_t a, size_t bit);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "567: void bn_set_bit(bn_t a, int bit, int value);",
      "",
      "[Added Lines]",
      "567: void bn_set_bit(bn_t a, size_t bit, int value);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "575: int bn_ham(const bn_t a);",
      "",
      "[Added Lines]",
      "575: size_t bn_ham(const bn_t a);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "602: void bn_set_2b(bn_t a, int b);",
      "",
      "[Added Lines]",
      "602: void bn_set_2b(bn_t a, size_t b);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "611: void bn_rand(bn_t a, int sign, int bits);",
      "",
      "[Added Lines]",
      "611: void bn_rand(bn_t a, int sign, size_t bits);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "638: int bn_size_str(const bn_t a, int radix);",
      "",
      "[Added Lines]",
      "638: size_t bn_size_str(const bn_t a, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "650: void bn_read_str(bn_t a, const char *str, int len, int radix);",
      "",
      "[Added Lines]",
      "650: void bn_read_str(bn_t a, const char *str, size_t len, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "663: void bn_write_str(char *str, int len, const bn_t a, int radix);",
      "",
      "[Added Lines]",
      "663: void bn_write_str(char *str, size_t len, const bn_t a, unsigned radix);",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "671: int bn_size_bin(const bn_t a);",
      "",
      "[Added Lines]",
      "671: size_t bn_size_bin(const bn_t a);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "681: void bn_read_bin(bn_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "681: void bn_read_bin(bn_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "692: void bn_write_bin(uint8_t *bin, int len, const bn_t a);",
      "",
      "[Added Lines]",
      "692: void bn_write_bin(uint8_t *bin, size_t len, const bn_t a);",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "700: int bn_size_raw(const bn_t a);",
      "",
      "[Added Lines]",
      "700: size_t bn_size_raw(const bn_t a);",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "709: void bn_read_raw(bn_t a, const dig_t *raw, int len);",
      "",
      "[Added Lines]",
      "709: void bn_read_raw(bn_t a, const dig_t *raw, size_t len);",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "719: void bn_write_raw(dig_t *raw, int len, const bn_t a);",
      "",
      "[Added Lines]",
      "719: void bn_write_raw(dig_t *raw, size_t len, const bn_t a);",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "873: void bn_lsh(bn_t c, const bn_t a, int bits);",
      "",
      "[Added Lines]",
      "873: void bn_lsh(bn_t c, const bn_t a, unsigned int bits);",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "883: void bn_rsh(bn_t c, const bn_t a, int bits);",
      "",
      "[Added Lines]",
      "883: void bn_rsh(bn_t c, const bn_t a, unsigned int bits);",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1313: void bn_gen_prime_basic(bn_t a, int bits);",
      "",
      "[Added Lines]",
      "1313: void bn_gen_prime_basic(bn_t a, size_t bits);",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1321: void bn_gen_prime_safep(bn_t a, int bits);",
      "",
      "[Added Lines]",
      "1321: void bn_gen_prime_safep(bn_t a, size_t bits);",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1330: void bn_gen_prime_stron(bn_t a, int bits);",
      "",
      "[Added Lines]",
      "1330: void bn_gen_prime_stron(bn_t a, size_t bits);",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1341: int bn_gen_prime_factor(bn_t a, bn_t b, int abits, int bbits);",
      "",
      "[Added Lines]",
      "1341: int bn_gen_prime_factor(bn_t a, bn_t b, size_t abits, size_t bbits);",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1373: void bn_rec_win(uint8_t *win, int *len, const bn_t k, int w);",
      "",
      "[Added Lines]",
      "1373: void bn_rec_win(uint8_t *win, size_t *len, const bn_t k, size_t w);",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1385: void bn_rec_slw(uint8_t *win, int *len, const bn_t k, int w);",
      "",
      "[Added Lines]",
      "1385: void bn_rec_slw(uint8_t *win, size_t *len, const bn_t k, size_t w);",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1397: void bn_rec_naf(int8_t *naf, int *len, const bn_t k, int w);",
      "",
      "[Added Lines]",
      "1397: void bn_rec_naf(int8_t *naf, size_t *len, const bn_t k, size_t w);",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1411: void bn_rec_tnaf(int8_t *tnaf, int *len, const bn_t k, int8_t u, int m, int w);",
      "",
      "[Added Lines]",
      "1411: void bn_rec_tnaf(int8_t *tnaf, size_t *len, const bn_t k, int8_t u, size_t m,",
      "1412:   size_t w);",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1425: void bn_rec_rtnaf(int8_t *tnaf, int *len, const bn_t k, int8_t u, int m, int w);",
      "",
      "[Added Lines]",
      "1426: void bn_rec_rtnaf(int8_t *tnaf, size_t *len, const bn_t k, int8_t u, size_t m,",
      "1427:   size_t w);",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1437: void bn_rec_tnaf_get(uint8_t *t, int8_t *beta, int8_t *gama, int8_t u, int w);",
      "",
      "[Added Lines]",
      "1439: void bn_rec_tnaf_get(uint8_t *t, int8_t *beta, int8_t *gama, int8_t u,",
      "1440:   size_t w);",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1449: void bn_rec_tnaf_mod(bn_t r0, bn_t r1, const bn_t k, int u, int m);",
      "",
      "[Added Lines]",
      "1452: void bn_rec_tnaf_mod(bn_t r0, bn_t r1, const bn_t k, int u, size_t m);",
      "",
      "---------------",
      "--- Hunk 33 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1462: void bn_rec_reg(int8_t *naf, int *len, const bn_t k, int n, int w);",
      "",
      "[Added Lines]",
      "1465: void bn_rec_reg(int8_t *naf, size_t *len, const bn_t k, size_t n, size_t w);",
      "",
      "---------------",
      "--- Hunk 34 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1474: void bn_rec_jsf(int8_t *jsf, int *len, const bn_t k, const bn_t l);",
      "",
      "[Added Lines]",
      "1477: void bn_rec_jsf(int8_t *jsf, size_t *len, const bn_t k, const bn_t l);",
      "",
      "---------------"
    ],
    "include/relic_cp.h||include/relic_cp.h": [
      "File: include/relic_cp.h -> include/relic_cp.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "743: int cp_rsa_gen(rsa_t pub, rsa_t prv, int bits);",
      "",
      "[Added Lines]",
      "743: int cp_rsa_gen(rsa_t pub, rsa_t prv, size_t bits);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1543: int cp_bls_sig(g1_t s, const uint8_t *msg, int len, const bn_t d);",
      "",
      "[Added Lines]",
      "1543: int cp_bls_sig(g1_t s, const uint8_t *msg, size_t len, const bn_t d);",
      "",
      "---------------"
    ],
    "include/relic_eb.h||include/relic_eb.h": [
      "File: include/relic_eb.h -> include/relic_eb.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "563: void eb_read_bin(eb_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "563: void eb_read_bin(eb_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "575: void eb_write_bin(uint8_t *bin, int len, const eb_t a, int pack);",
      "",
      "[Added Lines]",
      "575: void eb_write_bin(uint8_t *bin, size_t len, const eb_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "931: void eb_map(eb_t p, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "931: void eb_map(eb_t p, const uint8_t *msg, size_t len);",
      "",
      "---------------"
    ],
    "include/relic_ed.h||include/relic_ed.h": [
      "File: include/relic_ed.h -> include/relic_ed.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "485: void ed_map(ed_t p, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "485: void ed_map(ed_t p, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "497: void ed_map_dst(ed_t p, const uint8_t *msg, int len, const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "497: void ed_map_dst(ed_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "498:   size_t dst_len);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "843: void ed_read_bin(ed_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "844: void ed_read_bin(ed_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "855: void ed_write_bin(uint8_t *bin, int len, const ed_t a, int pack);",
      "",
      "[Added Lines]",
      "856: void ed_write_bin(uint8_t *bin, size_t len, const ed_t a, int pack);",
      "",
      "---------------"
    ],
    "include/relic_ep.h||include/relic_ep.h": [
      "File: include/relic_ep.h -> include/relic_ep.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "814: void ep_read_bin(ep_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "814: void ep_read_bin(ep_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "826: void ep_write_bin(uint8_t *bin, int len, const ep_t a, int pack);",
      "",
      "[Added Lines]",
      "826: void ep_write_bin(uint8_t *bin, size_t len, const ep_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1218: void ep_map_from_field(ep_t p, const uint8_t *uniform_bytes, int len);",
      "",
      "[Added Lines]",
      "1218: void ep_map_from_field(ep_t p, const uint8_t *uniform_bytes, size_t len);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1227: void ep_map(ep_t p, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "1227: void ep_map(ep_t p, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1239: void ep_map_dst(ep_t p, const uint8_t *msg, int len, const uint8_t *dst,",
      "1240:   int dst_len);",
      "",
      "[Added Lines]",
      "1239: void ep_map_dst(ep_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "1240:   size_t dst_len);",
      "",
      "---------------"
    ],
    "include/relic_epx.h||include/relic_epx.h": [
      "File: include/relic_epx.h -> include/relic_epx.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "748: void ep2_read_bin(ep2_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "748: void ep2_read_bin(ep2_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "760: void ep2_write_bin(uint8_t *bin, int len, const ep2_t a, int pack);",
      "",
      "[Added Lines]",
      "760: void ep2_write_bin(uint8_t *bin, size_t len, const ep2_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1063: void ep2_mul_sim_inter(ep2_t r, const ep2_t p, const bn_t k, const ep2_t q, const bn_t m);",
      "",
      "[Added Lines]",
      "1063: void ep2_mul_sim_inter(ep2_t r, const ep2_t p, const bn_t k, const ep2_t q,",
      "1064:    const bn_t m);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1075: void ep2_mul_sim_joint(ep2_t r, const ep2_t p, const bn_t k, const ep2_t q, const bn_t m);",
      "",
      "[Added Lines]",
      "1076: void ep2_mul_sim_joint(ep2_t r, const ep2_t p, const bn_t k, const ep2_t q,",
      "1077:    const bn_t m);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1086: void ep2_mul_sim_lot(ep2_t r, const ep2_t p[], const bn_t k[], int n);",
      "",
      "[Added Lines]",
      "1088: void ep2_mul_sim_lot(ep2_t r, const ep2_t p[], const bn_t k[], size_t n);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1108: void ep2_mul_sim_dig(ep2_t r, const ep2_t p[], const dig_t k[], int len);",
      "",
      "[Added Lines]",
      "1110: void ep2_mul_sim_dig(ep2_t r, const ep2_t p[], const dig_t k[], size_t len);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1137: void ep2_map_from_field(ep2_t p, const uint8_t *uniform_bytes, int len);",
      "",
      "[Added Lines]",
      "1139: void ep2_map_from_field(ep2_t p, const uint8_t *uniform_bytes, size_t len);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1146: void ep2_map(ep2_t p, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "1148: void ep2_map(ep2_t p, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1158: void ep2_map_dst(ep2_t p, const uint8_t *msg, int len, const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "1160: void ep2_map_dst(ep2_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "1161:   size_t dst_len);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1388: void ep4_read_bin(ep4_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "1391: void ep4_read_bin(ep4_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1400: void ep4_write_bin(uint8_t *bin, int len, const ep4_t a, int pack);",
      "",
      "[Added Lines]",
      "1403: void ep4_write_bin(uint8_t *bin, size_t len, const ep4_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1726: void ep4_mul_sim_lot(ep4_t r, const ep4_t p[], const bn_t k[], int n);",
      "",
      "[Added Lines]",
      "1729: void ep4_mul_sim_lot(ep4_t r, const ep4_t p[], const bn_t k[], size_t n);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1748: void ep4_mul_sim_dig(ep4_t r, const ep4_t p[], const dig_t k[], int len);",
      "",
      "[Added Lines]",
      "1751: void ep4_mul_sim_dig(ep4_t r, const ep4_t p[], const dig_t k[], size_t len);",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1774: void ep4_map(ep4_t p, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "1777: void ep4_map(ep4_t p, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1786: void ep4_map_dst(ep4_t p, const uint8_t *msg, int len, const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "1789: void ep4_map_dst(ep4_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "1790:   size_t dst_len);",
      "",
      "---------------"
    ],
    "include/relic_fb.h||include/relic_fb.h": [
      "File: include/relic_fb.h -> include/relic_fb.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "51: #define RLC_FB_BITS  ((int)FB_POLYN)",
      "56: #define RLC_FB_DIGS  ((int)RLC_CEIL(RLC_FB_BITS, RLC_DIG))",
      "61: #define RLC_FB_BYTES  ((int)RLC_CEIL(RLC_FB_BITS, 8))",
      "",
      "[Added Lines]",
      "51: #define RLC_FB_BITS  ((size_t)FB_POLYN)",
      "56: #define RLC_FB_DIGS  ((size_t)RLC_CEIL(RLC_FB_BITS, RLC_DIG))",
      "61: #define RLC_FB_BYTES  ((size_t)RLC_CEIL(RLC_FB_BITS, 8))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "541: int fb_get_bit(const fb_t a, int bit);",
      "",
      "[Added Lines]",
      "541: int fb_get_bit(const fb_t a, size_t bit);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "550: void fb_set_bit(fb_t a, int bit, int value);",
      "",
      "[Added Lines]",
      "550: void fb_set_bit(fb_t a, size_t bit, int value);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "568: int fb_bits(const fb_t a);",
      "",
      "[Added Lines]",
      "568: size_t fb_bits(const fb_t a);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "593: int fb_size_str(const fb_t a, int radix);",
      "",
      "[Added Lines]",
      "593: size_t fb_size_str(const fb_t a, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "606: void fb_read_str(fb_t a, const char *str, int len, int radix);",
      "",
      "[Added Lines]",
      "606: void fb_read_str(fb_t a, const char *str, size_t len, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "619: void fb_write_str(char *str, int len, const fb_t a, int radix);",
      "629: void fb_read_bin(fb_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "619: void fb_write_str(char *str, size_t len, const fb_t a, unsigned int radix);",
      "629: void fb_read_bin(fb_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "639: void fb_write_bin(uint8_t *bin, int len, const fb_t a);",
      "",
      "[Added Lines]",
      "639: void fb_write_bin(uint8_t *bin, size_t len, const fb_t a);",
      "",
      "---------------"
    ],
    "include/relic_fp.h||include/relic_fp.h": [
      "File: include/relic_fp.h -> include/relic_fp.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "51: #define RLC_FP_BITS  ((int)FP_PRIME)",
      "56: #define RLC_FP_DIGS  ((int)RLC_CEIL(RLC_FP_BITS, RLC_DIG))",
      "61: #define RLC_FP_BYTES  ((int)RLC_CEIL(RLC_FP_BITS, 8))",
      "",
      "[Added Lines]",
      "51: #define RLC_FP_BITS  ((size_t)FP_PRIME)",
      "56: #define RLC_FP_DIGS  ((size_t)RLC_CEIL(RLC_FP_BITS, RLC_DIG))",
      "61: #define RLC_FP_BYTES  ((size_t)RLC_CEIL(RLC_FP_BITS, 8))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "510: void fp_prime_set_pairf(const bn_t x, int pairf);",
      "",
      "[Removed Lines]",
      "504: void fp_prime_set_pmers(const int *spars, int len);",
      "",
      "[Added Lines]",
      "504: void fp_prime_set_pmers(const int *spars, size_t len);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "656: int fp_get_bit(const fp_t a, int bit);",
      "",
      "[Added Lines]",
      "656: int fp_get_bit(const fp_t a, size_t bit);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "665: void fp_set_bit(fp_t a, int bit, int value);",
      "",
      "[Added Lines]",
      "665: void fp_set_bit(fp_t a, size_t bit, int value);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "684: int fp_bits(const fp_t a);",
      "",
      "[Added Lines]",
      "684: size_t fp_bits(const fp_t a);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "709: int fp_size_str(const fp_t a, int radix);",
      "",
      "[Added Lines]",
      "709: size_t fp_size_str(const fp_t a, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "721: void fp_read_str(fp_t a, const char *str, int len, int radix);",
      "",
      "[Added Lines]",
      "721: void fp_read_str(fp_t a, const char *str, size_t len, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "734: void fp_write_str(char *str, int len, const fp_t a, int radix);",
      "",
      "[Added Lines]",
      "734: void fp_write_str(char *str, size_t len, const fp_t a, unsigned int radix);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "744: void fp_read_bin(fp_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "744: void fp_read_bin(fp_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "754: void fp_write_bin(uint8_t *bin, int len, const fp_t a);",
      "",
      "[Added Lines]",
      "754: void fp_write_bin(uint8_t *bin, size_t len, const fp_t a);",
      "",
      "---------------"
    ],
    "include/relic_fpx.h||include/relic_fpx.h": [
      "File: include/relic_fpx.h -> include/relic_fpx.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1335: void fp2_read_bin(fp2_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "1335: void fp2_read_bin(fp2_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1347: void fp2_write_bin(uint8_t *bin, int len, const fp2_t a, int pack);",
      "",
      "[Added Lines]",
      "1347: void fp2_write_bin(uint8_t *bin, size_t len, const fp2_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1693: void fp3_read_bin(fp3_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "1693: void fp3_read_bin(fp3_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1704: void fp3_write_bin(uint8_t *bin, int len, const fp3_t a);",
      "",
      "[Added Lines]",
      "1704: void fp3_write_bin(uint8_t *bin, size_t len, const fp3_t a);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1959: void fp4_read_bin(fp4_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "1959: void fp4_read_bin(fp4_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1970: void fp4_write_bin(uint8_t *bin, int len, const fp4_t a);",
      "",
      "[Added Lines]",
      "1970: void fp4_write_bin(uint8_t *bin, size_t len, const fp4_t a);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2229: void fp6_read_bin(fp6_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "2229: void fp6_read_bin(fp6_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2240: void fp6_write_bin(uint8_t *bin, int len, const fp6_t a);",
      "",
      "[Added Lines]",
      "2240: void fp6_write_bin(uint8_t *bin, size_t len, const fp6_t a);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2459: void fp8_read_bin(fp8_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "2459: void fp8_read_bin(fp8_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2470: void fp8_write_bin(uint8_t *bin, int len, const fp8_t a);",
      "",
      "[Added Lines]",
      "2470: void fp8_write_bin(uint8_t *bin, size_t len, const fp8_t a);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2742: void fp9_read_bin(fp9_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "2742: void fp9_read_bin(fp9_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2753: void fp9_write_bin(uint8_t *bin, int len, const fp9_t a);",
      "",
      "[Added Lines]",
      "2753: void fp9_write_bin(uint8_t *bin, size_t len, const fp9_t a);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2981: void fp12_read_bin(fp12_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "2981: void fp12_read_bin(fp12_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "2993: void fp12_write_bin(uint8_t *bin, int len, const fp12_t a, int pack);",
      "",
      "[Added Lines]",
      "2993: void fp12_write_bin(uint8_t *bin, size_t len, const fp12_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3285: void fp2_exp_cyc_sim(fp2_t e, const fp2_t a, const bn_t b, const fp2_t c, const bn_t d);",
      "",
      "[Added Lines]",
      "3285: void fp2_exp_cyc_sim(fp2_t e, const fp2_t a, const bn_t b, const fp2_t c,",
      "3286:   const bn_t d);",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3296: void fp12_exp_cyc_sim(fp12_t e, const fp12_t a, const bn_t b, const fp12_t c, const bn_t d);",
      "",
      "[Added Lines]",
      "3297: void fp12_exp_cyc_sim(fp12_t e, const fp12_t a, const bn_t b, const fp12_t c,",
      "3298:   const bn_t d);",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3307: void fp12_exp_cyc_sps(fp12_t c, const fp12_t a, const int *b, int l, int s);",
      "",
      "[Added Lines]",
      "3309: void fp12_exp_cyc_sps(fp12_t c, const fp12_t a, const int *b, size_t l, int s);",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3398: void fp18_read_bin(fp18_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "3400: void fp18_read_bin(fp18_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3409: void fp18_write_bin(uint8_t *bin, int len, const fp18_t a);",
      "",
      "[Added Lines]",
      "3411: void fp18_write_bin(uint8_t *bin, size_t len, const fp18_t a);",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3660: void fp24_read_bin(fp24_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "3662: void fp24_read_bin(fp24_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3672: void fp24_write_bin(uint8_t *bin, int len, const fp24_t a, int pack);",
      "",
      "[Added Lines]",
      "3674: void fp24_write_bin(uint8_t *bin, size_t len, const fp24_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "3964: void fp24_exp_cyc_sps(fp24_t c, const fp24_t a, const int *b, int l, int s);",
      "",
      "[Added Lines]",
      "3966: void fp24_exp_cyc_sps(fp24_t c, const fp24_t a, const int *b, size_t l, int s);",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4039: void fp48_read_bin(fp48_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "4041: void fp48_read_bin(fp48_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4051: void fp48_write_bin(uint8_t *bin, int len, const fp48_t a, int pack);",
      "",
      "[Added Lines]",
      "4053: void fp48_write_bin(uint8_t *bin, size_t len, const fp48_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4315: void fp48_exp_cyc_sps(fp48_t c, const fp48_t a, const int *b, int l, int s);",
      "",
      "[Added Lines]",
      "4317: void fp48_exp_cyc_sps(fp48_t c, const fp48_t a, const int *b, size_t l, int s);",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4390: void fp54_read_bin(fp54_t a, const uint8_t *bin, int len);",
      "",
      "[Added Lines]",
      "4392: void fp54_read_bin(fp54_t a, const uint8_t *bin, size_t len);",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4402: void fp54_write_bin(uint8_t *bin, int len, const fp54_t a, int pack);",
      "",
      "[Added Lines]",
      "4404: void fp54_write_bin(uint8_t *bin, size_t len, const fp54_t a, int pack);",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "4666: void fp54_exp_cyc_sps(fp54_t c, const fp54_t a, const int *b, int l, int s);",
      "",
      "[Added Lines]",
      "4668: void fp54_exp_cyc_sps(fp54_t c, const fp54_t a, const int *b, size_t l, int s);",
      "",
      "---------------"
    ],
    "include/relic_md.h||include/relic_md.h": [
      "File: include/relic_md.h -> include/relic_md.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "137: void md_map_sh224(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "137: void md_map_sh224(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "146: void md_map_sh256(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "146: void md_map_sh256(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "155: void md_map_sh384(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "155: void md_map_sh384(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "164: void md_map_sh512(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "164: void md_map_sh512(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "173: void md_map_b2s160(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "173: void md_map_b2s160(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "182: void md_map_b2s256(uint8_t *hash, const uint8_t *msg, int len);",
      "",
      "[Added Lines]",
      "182: void md_map_b2s256(uint8_t *hash, const uint8_t *msg, size_t len);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "193: void md_kdf(uint8_t *key, int key_len, const uint8_t *in, int in_len);",
      "",
      "[Added Lines]",
      "193: void md_kdf(uint8_t *key, size_t key_len, const uint8_t *in, size_t in_len);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "204: void md_mgf(uint8_t *mask, int mask_len, const uint8_t *in, int in_len);",
      "",
      "[Added Lines]",
      "204: void md_mgf(uint8_t *mask, size_t mask_len, const uint8_t *in, size_t in_len);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "215: void md_hmac(uint8_t *mac, const uint8_t *in, int in_len, const uint8_t *key,",
      "216:   int key_len);",
      "",
      "[Added Lines]",
      "215: void md_hmac(uint8_t *mac, const uint8_t *in, size_t in_len, const uint8_t *key,",
      "216:   size_t key_len);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "229: void md_xmd_sh224(uint8_t *buf, int buf_len, const uint8_t *in, int in_len,",
      "230:   const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "229: void md_xmd_sh224(uint8_t *buf, size_t buf_len, const uint8_t *in,",
      "230:   size_t in_len, const uint8_t *dst, size_t dst_len);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "243: void md_xmd_sh256(uint8_t *buf, int buf_len, const uint8_t *in, int in_len,",
      "244:   const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "243: void md_xmd_sh256(uint8_t *buf, size_t buf_len, const uint8_t *in,",
      "244:   size_t in_len, const uint8_t *dst, size_t dst_len);",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "257: void md_xmd_sh384(uint8_t *buf, int buf_len, const uint8_t *in, int in_len,",
      "258:   const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "257: void md_xmd_sh384(uint8_t *buf, size_t buf_len, const uint8_t *in,",
      "258:   size_t in_len, const uint8_t *dst, size_t dst_len);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "271: void md_xmd_sh512(uint8_t *buf, int buf_len, const uint8_t *in, int in_len,",
      "272:   const uint8_t *dst, int dst_len);",
      "",
      "[Added Lines]",
      "271: void md_xmd_sh512(uint8_t *buf, size_t buf_len, const uint8_t *in,",
      "272:   size_t in_len, const uint8_t *dst, size_t dst_len);",
      "",
      "---------------"
    ],
    "include/relic_rand.h||include/relic_rand.h": [
      "File: include/relic_rand.h -> include/relic_rand.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "94: #else",
      "",
      "[Removed Lines]",
      "92: void rand_seed(uint8_t *buf, int size);",
      "",
      "[Added Lines]",
      "92: void rand_seed(uint8_t *buf, size_t size);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "105: #endif",
      "",
      "[Removed Lines]",
      "103: void rand_seed(void (*callback)(uint8_t *, int, void *), void *arg);",
      "",
      "[Added Lines]",
      "103: void rand_seed(void (*callback)(uint8_t *, size_t, void *), void *arg);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "115: int rand_check(uint8_t *buf, int size);",
      "",
      "[Added Lines]",
      "115: int rand_check(uint8_t *buf, size_t size);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "126: void rand_bytes(uint8_t *buf, int size);",
      "",
      "[Added Lines]",
      "126: void rand_bytes(uint8_t *buf, size_t size);",
      "",
      "---------------"
    ],
    "include/relic_util.h||include/relic_util.h": [
      "File: include/relic_util.h -> include/relic_util.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "288: int util_bits_dig(dig_t a);",
      "",
      "[Added Lines]",
      "288: size_t util_bits_dig(dig_t a);",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_gcd.c||src/bn/relic_bn_gcd.c": [
      "File: src/bn/relic_bn_gcd.c -> src/bn/relic_bn_gcd.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "202:    bn_abs(y, a);",
      "203:   }",
      "204:   while (y->used > 1) {",
      "206:    _x = u->dp[0];",
      "208:    _y = v->dp[0];",
      "209:    _a = _d = 1;",
      "210:    _b = _c = 0;",
      "",
      "[Removed Lines]",
      "205:    bn_rsh(u, x, bn_bits(x) - RLC_DIG);",
      "207:    bn_rsh(v, y, bn_bits(x) - RLC_DIG);",
      "",
      "[Added Lines]",
      "205:    if (bn_bits(x) > RLC_DIG) {",
      "206:     bn_rsh(u, x, bn_bits(x) - RLC_DIG);",
      "207:     bn_rsh(v, y, bn_bits(x) - RLC_DIG);",
      "208:    } else {",
      "209:     bn_copy(u, x);",
      "210:     bn_copy(v, y);",
      "211:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "237:     bn_copy(x, y);",
      "238:     bn_copy(y, t0);",
      "239:    } else {",
      "242:     if (_a < 0) {",
      "243:      bn_mul_dig(t0, u, -_a);",
      "244:      bn_neg(t0, t0);",
      "",
      "[Removed Lines]",
      "240:     bn_rsh(u, x, bn_bits(x) - 2 * RLC_DIG);",
      "241:     bn_rsh(v, y, bn_bits(x) - 2 * RLC_DIG);",
      "",
      "[Added Lines]",
      "245:     if (bn_bits(x) > 2 * RLC_DIG) {",
      "246:      bn_rsh(u, x, bn_bits(x) - 2 * RLC_DIG);",
      "247:      bn_rsh(v, y, bn_bits(x) - 2 * RLC_DIG);",
      "248:     } else {",
      "249:      bn_copy(u, x);",
      "250:      bn_copy(v, y);",
      "251:     }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "265:     }",
      "266:     bn_add(u, t0, t1);",
      "267:     bn_add(v, t2, t3);",
      "269:     _x = t0->dp[0];",
      "271:     _y = t1->dp[0];",
      "272:     t = 0;",
      "273:     if (_y != 0) {",
      "",
      "[Removed Lines]",
      "268:     bn_rsh(t0, u, bn_bits(u) - RLC_DIG);",
      "270:     bn_rsh(t1, v, bn_bits(u) - RLC_DIG);",
      "",
      "[Added Lines]",
      "278:     if (bn_bits(u) > RLC_DIG) {",
      "279:      bn_rsh(t0, u, bn_bits(u) - RLC_DIG);",
      "280:      bn_rsh(t1, v, bn_bits(u) - RLC_DIG);",
      "281:     } else {",
      "282:      bn_copy(t0, u);",
      "283:      bn_copy(t1, v);",
      "284:     }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "400:   bn_set_dig(d, 1);",
      "402:   while (y->used > 1) {",
      "404:    _x = u->dp[0];",
      "406:    _y = v->dp[0];",
      "407:    _a = _d = 1;",
      "408:    _b = _c = 0;",
      "",
      "[Removed Lines]",
      "403:    bn_rsh(u, x, bn_bits(x) - RLC_DIG);",
      "405:    bn_rsh(v, y, bn_bits(x) - RLC_DIG);",
      "",
      "[Added Lines]",
      "418:    if (bn_bits(x) > RLC_DIG) {",
      "419:     bn_rsh(u, x, bn_bits(x) - RLC_DIG);",
      "420:     bn_rsh(v, y, bn_bits(x) - RLC_DIG);",
      "421:    } else {",
      "422:     bn_copy(u, x);",
      "423:     bn_copy(v, y);",
      "424:    }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "439:     bn_copy(t4, d);",
      "440:     bn_copy(d, t1);",
      "441:    } else {",
      "444:     if (_a < 0) {",
      "445:      bn_mul_dig(t0, u, -_a);",
      "446:      bn_neg(t0, t0);",
      "",
      "[Removed Lines]",
      "442:     bn_rsh(u, x, bn_bits(x) - 2 * RLC_DIG);",
      "443:     bn_rsh(v, y, bn_bits(x) - 2 * RLC_DIG);",
      "",
      "[Added Lines]",
      "462:     if (bn_bits(x) > 2 * RLC_DIG) {",
      "463:      bn_rsh(u, x, bn_bits(x) - 2 * RLC_DIG);",
      "464:      bn_rsh(v, y, bn_bits(x) - 2 * RLC_DIG);",
      "465:     } else {",
      "466:      bn_copy(u, x);",
      "467:      bn_copy(v, y);",
      "468:     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "467:     }",
      "468:     bn_add(u, t0, t1);",
      "469:     bn_add(v, t2, t3);",
      "471:     _x = t0->dp[0];",
      "473:     _y = t1->dp[0];",
      "474:     t = 0;",
      "475:     if (_y != 0) {",
      "",
      "[Removed Lines]",
      "470:     bn_rsh(t0, u, bn_bits(u) - RLC_DIG);",
      "472:     bn_rsh(t1, v, bn_bits(u) - RLC_DIG);",
      "",
      "[Added Lines]",
      "495:     if (bn_bits(u) > RLC_DIG) {",
      "496:      bn_rsh(t0, u, bn_bits(u) - RLC_DIG);",
      "497:      bn_rsh(t1, v, bn_bits(u) - RLC_DIG);",
      "498:     } else {",
      "499:      bn_copy(t0, u);",
      "500:      bn_copy(t1, v);",
      "501:     }",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_mem.c||src/bn/relic_bn_mem.c": [
      "File: src/bn/relic_bn_mem.c -> src/bn/relic_bn_mem.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:  if (digits < 0) {",
      "46:   RLC_THROW(ERR_NO_VALID);",
      "47:  }",
      "",
      "[Removed Lines]",
      "44: void bn_make(bn_t a, int digits) {",
      "",
      "[Added Lines]",
      "44: void bn_make(bn_t a, size_t digits) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "112:  }",
      "113: }",
      "116: #if ALLOC == DYNAMIC",
      "117:  dig_t *t;",
      "",
      "[Removed Lines]",
      "115: void bn_grow(bn_t a, int digits) {",
      "",
      "[Added Lines]",
      "115: void bn_grow(bn_t a, size_t digits) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "143:    --(a->used);",
      "144:   }",
      "147:    a->used = 1;",
      "148:    a->dp[0] = 0;",
      "149:    a->sign = RLC_POS;",
      "",
      "[Removed Lines]",
      "146:   if (a->used <= 0) {",
      "",
      "[Added Lines]",
      "146:   if (a->used == 0) {",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_mxp.c||src/bn/relic_bn_mxp.c": [
      "File: src/bn/relic_bn_mxp.c -> src/bn/relic_bn_mxp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "117: void bn_mxp_slide(bn_t c, const bn_t a, const bn_t b, const bn_t m) {",
      "118:  bn_t tab[RLC_TABLE_SIZE], t, u, r;",
      "120:  uint8_t *win = RLC_ALLOCA(uint8_t, bn_bits(b));",
      "122:  if (win == NULL) {",
      "",
      "[Removed Lines]",
      "119:  int i, j, l, w = 1;",
      "",
      "[Added Lines]",
      "119:  size_t l, w = 1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "140:  bn_null(u);",
      "141:  bn_null(r);",
      "144:   bn_null(tab[i]);",
      "145:  }",
      "150:   w = 2;",
      "152:   w = 3;",
      "154:   w = 4;",
      "156:   w = 5;",
      "158:   w = 6;",
      "159:  } else {",
      "160:   w = 7;",
      "161:  }",
      "163:  RLC_TRY {",
      "165:    bn_new(tab[i]);",
      "166:   }",
      "",
      "[Removed Lines]",
      "143:  for (i = 0; i < RLC_TABLE_SIZE; i++) {",
      "148:  i = bn_bits(b);",
      "149:  if (i <= 21) {",
      "151:  } else if (i <= 32) {",
      "153:  } else if (i <= 128) {",
      "155:  } else if (i <= 256) {",
      "157:  } else if (i <= 512) {",
      "164:   for (i = 0; i < (1 << (w - 1)); i++) {",
      "",
      "[Added Lines]",
      "143:  for (size_t i = 0; i < RLC_TABLE_SIZE; i++) {",
      "148:  l = bn_bits(b);",
      "149:  if (l <= 21) {",
      "151:  } else if (l <= 32) {",
      "153:  } else if (l <= 128) {",
      "155:  } else if (l <= 256) {",
      "157:  } else if (l <= 512) {",
      "164:   for (size_t i = 0; i < (1 << (w - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "183:   bn_sqr(t, tab[0]);",
      "184:   bn_mod(t, t, m, u);",
      "187:    bn_mul(tab[i], tab[i - 1], t);",
      "188:    bn_mod(tab[i], tab[i], m, u);",
      "189:   }",
      "192:   bn_rec_slw(win, &l, b, w);",
      "194:    if (win[i] == 0) {",
      "195:     bn_sqr(r, r);",
      "196:     bn_mod(r, r, m, u);",
      "197:    } else {",
      "199:      bn_sqr(r, r);",
      "200:      bn_mod(r, r, m, u);",
      "201:     }",
      "",
      "[Removed Lines]",
      "186:   for (i = 1; i < 1 << (w - 1); i++) {",
      "191:   l = bn_bits(b);",
      "193:   for (i = 0; i < l; i++) {",
      "198:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "186:   for (size_t i = 1; i < 1 << (w - 1); i++) {",
      "192:   for (size_t i = 0; i < l; i++) {",
      "197:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "218:   RLC_THROW(ERR_CAUGHT);",
      "219:  }",
      "220:  RLC_FINALLY {",
      "222:    bn_free(tab[i]);",
      "223:   }",
      "224:   bn_free(u);",
      "",
      "[Removed Lines]",
      "221:   for (i = 0; i < (1 << (w - 1)); i++) {",
      "",
      "[Added Lines]",
      "220:   for (size_t i = 0; i < (1 << (w - 1)); i++) {",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_prime.c||src/bn/relic_bn_prime.c": [
      "File: src/bn/relic_bn_prime.c -> src/bn/relic_bn_prime.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "276:   bn_sub_dig(n1, a, 1);",
      "277:   bn_copy(r, n1);",
      "278:   s = 0;",
      "280:    s++;",
      "281:    bn_rsh(r, r, 1);",
      "282:   }",
      "",
      "[Removed Lines]",
      "279:   while (bn_is_even(r)) {",
      "",
      "[Added Lines]",
      "279:   while (!bn_is_zero(r) && bn_is_even(r)) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "402: #if BN_GEN == BASIC || !defined(STRIP)",
      "405:  while (1) {",
      "406:   do {",
      "407:    bn_rand(a, RLC_POS, bits);",
      "",
      "[Removed Lines]",
      "404: void bn_gen_prime_basic(bn_t a, int bits) {",
      "",
      "[Added Lines]",
      "404: void bn_gen_prime_basic(bn_t a, size_t bits) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "417: #if BN_GEN == SAFEP || !defined(STRIP)",
      "420:  while (1) {",
      "421:   do {",
      "422:    bn_rand(a, RLC_POS, bits);",
      "",
      "[Removed Lines]",
      "419: void bn_gen_prime_safep(bn_t a, int bits) {",
      "",
      "[Added Lines]",
      "419: void bn_gen_prime_safep(bn_t a, size_t bits) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "441: #if BN_GEN == STRON || !defined(STRIP)",
      "444:  dig_t i, j;",
      "445:  int found, k;",
      "446:  bn_t r, s, t;",
      "",
      "[Removed Lines]",
      "443: void bn_gen_prime_stron(bn_t a, int bits) {",
      "",
      "[Added Lines]",
      "443: void bn_gen_prime_stron(bn_t a, size_t bits) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "520: #endif",
      "523:  bn_t t;",
      "524:  int result = RLC_OK;",
      "",
      "[Removed Lines]",
      "522: int bn_gen_prime_factor(bn_t a, bn_t b, int abits, int bbits) {",
      "",
      "[Added Lines]",
      "522: int bn_gen_prime_factor(bn_t a, bn_t b, size_t abits, size_t bbits) {",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_rec.c||src/bn/relic_bn_rec.c": [
      "File: src/bn/relic_bn_rec.c -> src/bn/relic_bn_rec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "47:  int f, t;",
      "48:  dig_t mf, mt;",
      "",
      "[Removed Lines]",
      "46: static char get_bits(const bn_t a, int from, int to) {",
      "",
      "[Added Lines]",
      "46: static char get_bits(const bn_t a, size_t from, size_t to) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "95:  int i, j, l;",
      "97:  l = bn_bits(k);",
      "",
      "[Removed Lines]",
      "94: void bn_rec_win(uint8_t *win, int *len, const bn_t k, int w) {",
      "",
      "[Added Lines]",
      "94: void bn_rec_win(uint8_t *win, size_t *len, const bn_t k, size_t w) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "113: }",
      "116:  int i, j, l, s;",
      "118:  l = bn_bits(k);",
      "",
      "[Removed Lines]",
      "115: void bn_rec_slw(uint8_t *win, int *len, const bn_t k, int w) {",
      "",
      "[Added Lines]",
      "115: void bn_rec_slw(uint8_t *win, size_t *len, const bn_t k, size_t w) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "144: }",
      "147:  int i, l;",
      "148:  bn_t t;",
      "149:  dig_t t0, mask;",
      "",
      "[Removed Lines]",
      "146: void bn_rec_naf(int8_t *naf, int *len, const bn_t k, int w) {",
      "",
      "[Added Lines]",
      "146: void bn_rec_naf(int8_t *naf, size_t *len, const bn_t k, size_t w) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "217:  }",
      "218: }",
      "221:  if (u == -1) {",
      "222:   switch (w) {",
      "223:    case 2:",
      "",
      "[Removed Lines]",
      "220: void bn_rec_tnaf_get(uint8_t *t, int8_t *beta, int8_t *gama, int8_t u, int w) {",
      "",
      "[Added Lines]",
      "220: void bn_rec_tnaf_get(uint8_t *t, int8_t *beta, int8_t *gama, int8_t u,",
      "221:   size_t w) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "349:  }",
      "350: }",
      "353:  bn_t t, t0, t1, t2, t3;",
      "355:  bn_null(t);",
      "",
      "[Removed Lines]",
      "352: void bn_rec_tnaf_mod(bn_t r0, bn_t r1, const bn_t k, int u, int m) {",
      "",
      "[Added Lines]",
      "353: void bn_rec_tnaf_mod(bn_t r0, bn_t r1, const bn_t k, int u, size_t m) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "421:  }",
      "422: }",
      "425:  int i, l;",
      "426:  bn_t tmp, r0, r1;",
      "427:  int8_t beta[64], gama[64];",
      "",
      "[Removed Lines]",
      "424: void bn_rec_tnaf(int8_t *tnaf, int *len, const bn_t k, int8_t u, int m, int w) {",
      "",
      "[Added Lines]",
      "425: void bn_rec_tnaf(int8_t *tnaf, size_t *len, const bn_t k, int8_t u, size_t m,",
      "426:   size_t w) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "551:  }",
      "552: }",
      "555:  int i, l;",
      "556:  bn_t tmp, r0, r1;",
      "557:  int8_t beta[64], gama[64];",
      "",
      "[Removed Lines]",
      "554: void bn_rec_rtnaf(int8_t *tnaf, int *len, const bn_t k, int8_t u, int m, int w) {",
      "",
      "[Added Lines]",
      "556: void bn_rec_rtnaf(int8_t *tnaf, size_t *len, const bn_t k, int8_t u, size_t m,",
      "557:   size_t w) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "693:  }",
      "694: }",
      "697:  int i, l;",
      "698:  bn_t t;",
      "699:  dig_t t0, mask;",
      "",
      "[Removed Lines]",
      "696: void bn_rec_reg(int8_t *naf, int *len, const bn_t k, int n, int w) {",
      "",
      "[Added Lines]",
      "699: void bn_rec_reg(int8_t *naf, size_t *len, const bn_t k, size_t n, size_t w) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "746:  }",
      "747: }",
      "750:  bn_t n0, n1;",
      "751:  dig_t l0, l1;",
      "752:  int8_t u0, u1, d0, d1;",
      "",
      "[Removed Lines]",
      "749: void bn_rec_jsf(int8_t *jsf, int *len, const bn_t k, const bn_t l) {",
      "",
      "[Added Lines]",
      "752: void bn_rec_jsf(int8_t *jsf, size_t *len, const bn_t k, const bn_t l) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "828: void bn_rec_glv(bn_t k0, bn_t k1, const bn_t k, const bn_t n, const bn_t *v1,",
      "829:   const bn_t *v2) {",
      "830:  bn_t t, b1, b2;",
      "833:  bn_null(b1);",
      "834:  bn_null(b2);",
      "",
      "[Removed Lines]",
      "831:  int r1, r2, bits;",
      "",
      "[Added Lines]",
      "834:  int r1, r2;",
      "835:  size_t bits;",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_shift.c||src/bn/relic_bn_shift.c": [
      "File: src/bn/relic_bn_shift.c -> src/bn/relic_bn_shift.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "63:  bn_trim(c);",
      "64: }",
      "67:  int digits;",
      "68:  dig_t carry;",
      "70:  bn_copy(c, a);",
      "76:  RLC_RIP(bits, digits, bits);",
      "78:  RLC_TRY {",
      "",
      "[Removed Lines]",
      "66: void bn_lsh(bn_t c, const bn_t a, int bits) {",
      "72:  if (bits <= 0) {",
      "73:   return;",
      "74:  }",
      "",
      "[Added Lines]",
      "66: void bn_lsh(bn_t c, const bn_t a, unsigned int bits) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "101:  }",
      "102: }",
      "105:  int digits = 0;",
      "107:  bn_copy(c, a);",
      "113:  RLC_RIP(bits, digits, bits);",
      "115:  if (digits > 0) {",
      "116:   dv_rshd(c->dp, a->dp, a->used, digits);",
      "117:  }",
      "119:  c->sign = a->sign;",
      "121:  if (c->used > 0 && bits > 0) {",
      "",
      "[Removed Lines]",
      "104: void bn_rsh(bn_t c, const bn_t a, int bits) {",
      "109:  if (bits <= 0) {",
      "110:   return;",
      "111:  }",
      "118:  c->used = a->used - digits;",
      "",
      "[Added Lines]",
      "100: void bn_rsh(bn_t c, const bn_t a, unsigned int bits) {",
      "111:  if (a->used > digits) {",
      "112:   c->used = a->used - digits;",
      "113:  } else {",
      "114:   c->used = 0;",
      "115:  }",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_smb.c||src/bn/relic_bn_smb.c": [
      "File: src/bn/relic_bn_smb.c -> src/bn/relic_bn_smb.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "121:    }",
      "123:    h = 0;",
      "125:     h++;",
      "126:     bn_rsh(t0, t0, 1);",
      "127:    }",
      "",
      "[Removed Lines]",
      "124:    while (bn_is_even(t0)) {",
      "",
      "[Added Lines]",
      "124:    while (bn_is_even(t0) && !bn_is_zero(t0)) {",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_srt.c||src/bn/relic_bn_srt.c": [
      "File: src/bn/relic_bn_srt.c -> src/bn/relic_bn_srt.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "39: void bn_srt(bn_t c, bn_t a) {",
      "40:  bn_t h, l, m, t;",
      "43:  if (bn_sign(a) == RLC_NEG) {",
      "44:   RLC_THROW(ERR_NO_VALID);",
      "",
      "[Removed Lines]",
      "41:  int bits, cmp;",
      "",
      "[Added Lines]",
      "41:  size_t bits;",
      "42:  int cmp;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "58:   bn_new(m);",
      "59:   bn_new(t);",
      "61:   bn_set_2b(h, bits >> 1);",
      "65:   do {",
      "",
      "[Removed Lines]",
      "62:   bn_set_2b(l, (bits >> 1) - 1);",
      "",
      "[Added Lines]",
      "62:   bn_zero(l);",
      "64:   if (bits >= 2) {",
      "65:    bn_set_2b(l, (bits >> 1) - 1);",
      "66:   }",
      "",
      "---------------"
    ],
    "src/bn/relic_bn_util.c||src/bn/relic_bn_util.c": [
      "File: src/bn/relic_bn_util.c -> src/bn/relic_bn_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "105:  return 0;",
      "106: }",
      "109:  int bits;",
      "111:  if (bn_is_zero(a)) {",
      "",
      "[Removed Lines]",
      "108: int bn_bits(const bn_t a) {",
      "",
      "[Added Lines]",
      "108: size_t bn_bits(const bn_t a) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "118:  return bits + util_bits_dig(a->dp[a->used - 1]);",
      "119: }",
      "122:  int d;",
      "124:  if (bit < 0) {",
      "",
      "[Removed Lines]",
      "121: int bn_get_bit(const bn_t a, int bit) {",
      "",
      "[Added Lines]",
      "121: int bn_get_bit(const bn_t a, size_t bit) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "139:  }",
      "140: }",
      "143:  int d;",
      "145:  if (bit < 0) {",
      "",
      "[Removed Lines]",
      "142: void bn_set_bit(bn_t a, int bit, int value) {",
      "",
      "[Added Lines]",
      "142: void bn_set_bit(bn_t a, size_t bit, int value) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "162:  }",
      "163: }",
      "166:  int c = 0;",
      "168:  for (int i = 0; i < bn_bits(a); i++) {",
      "",
      "[Removed Lines]",
      "165: int bn_ham(const bn_t a) {",
      "",
      "[Added Lines]",
      "165: size_t bn_ham(const bn_t a) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "183:  a->sign = RLC_POS;",
      "184: }",
      "187:  int i, d;",
      "191:  } else {",
      "192:   RLC_RIP(b, d, b);",
      "",
      "[Removed Lines]",
      "186: void bn_set_2b(bn_t a, int b) {",
      "189:  if (b < 0) {",
      "190:   bn_zero(a);",
      "",
      "[Added Lines]",
      "186: void bn_set_2b(bn_t a, size_t b) {",
      "189:  if (b >= RLC_BN_SIZE * RLC_DIG) {",
      "190:   RLC_THROW(ERR_NO_VALID);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "201:  }",
      "202: }",
      "205:  int digits;",
      "207:  RLC_RIP(bits, digits, bits);",
      "",
      "[Removed Lines]",
      "204: void bn_rand(bn_t a, int sign, int bits) {",
      "",
      "[Added Lines]",
      "204: void bn_rand(bn_t a, int sign, size_t bits) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "264:  }",
      "265: }",
      "268:  int digits = 0;",
      "269:  bn_t t;",
      "",
      "[Removed Lines]",
      "267: int bn_size_str(const bn_t a, int radix) {",
      "",
      "[Added Lines]",
      "267: size_t bn_size_str(const bn_t a, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "308:  return digits + 1;",
      "309: }",
      "312:  int sign, i, j;",
      "313:  char c;",
      "",
      "[Removed Lines]",
      "311: void bn_read_str(bn_t a, const char *str, int len, int radix) {",
      "",
      "[Added Lines]",
      "311: void bn_read_str(bn_t a, const char *str, size_t len, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "357:  }",
      "358: }",
      "361:  bn_t t;",
      "362:  dig_t d;",
      "363:  int digits, l, i, j;",
      "",
      "[Removed Lines]",
      "360: void bn_write_str(char *str, int len, const bn_t a, int radix) {",
      "",
      "[Added Lines]",
      "360: void bn_write_str(char *str, size_t len, const bn_t a, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "426:  }",
      "427: }",
      "430:  dig_t d;",
      "431:  int digits;",
      "",
      "[Removed Lines]",
      "429: int bn_size_bin(const bn_t a) {",
      "",
      "[Added Lines]",
      "429: size_t bn_size_bin(const bn_t a) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "440:  return digits;",
      "441: }",
      "444:  int i, j;",
      "445:  dig_t d = (RLC_DIG / 8);",
      "446:  int digs = (len % d == 0 ? len / d : len / d + 1);",
      "",
      "[Removed Lines]",
      "443: void bn_read_bin(bn_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "443: void bn_read_bin(bn_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "470:  bn_trim(a);",
      "471: }",
      "474:  int size, k;",
      "475:  dig_t d;",
      "",
      "[Removed Lines]",
      "473: void bn_write_bin(uint8_t *bin, int len, const bn_t a) {",
      "",
      "[Added Lines]",
      "473: void bn_write_bin(uint8_t *bin, size_t len, const bn_t a) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "501:  }",
      "502: }",
      "505:  return a->used;",
      "506: }",
      "509:  RLC_TRY {",
      "510:   bn_grow(a, len);",
      "511:   a->used = len;",
      "",
      "[Removed Lines]",
      "504: int bn_size_raw(const bn_t a) {",
      "508: void bn_read_raw(bn_t a, const dig_t *raw, int len) {",
      "",
      "[Added Lines]",
      "504: size_t bn_size_raw(const bn_t a) {",
      "508: void bn_read_raw(bn_t a, const dig_t *raw, size_t len) {",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "517:  }",
      "518: }",
      "521:  int i, size;",
      "523:  size = a->used;",
      "",
      "[Removed Lines]",
      "520: void bn_write_raw(dig_t *raw, int len, const bn_t a) {",
      "",
      "[Added Lines]",
      "520: void bn_write_raw(dig_t *raw, size_t len, const bn_t a) {",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_bls.c||src/cp/relic_cp_bls.c": [
      "File: src/cp/relic_cp_bls.c -> src/cp/relic_cp_bls.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "57:  return result;",
      "58: }",
      "61:  g1_t p;",
      "62:  int result = RLC_OK;",
      "",
      "[Removed Lines]",
      "60: int cp_bls_sig(g1_t s, const uint8_t *msg, int len, const bn_t d) {",
      "",
      "[Added Lines]",
      "60: int cp_bls_sig(g1_t s, const uint8_t *msg, size_t len, const bn_t d) {",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_cmlhs.c||src/cp/relic_cp_cmlhs.c": [
      "File: src/cp/relic_cp_cmlhs.c -> src/cp/relic_cp_cmlhs.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "65:   pc_map(gt, g1, g2);",
      "67:   rand_bytes(prf, plen);",
      "77:   for (int i = 0; i < len; i++) {",
      "",
      "[Removed Lines]",
      "68:   if (bls) {",
      "69:    cp_bls_gen(sk, pk);",
      "70:   } else {",
      "71:    cp_ecdsa_gen(sk, g1);",
      "72:    fp_copy(pk->x[0], g1->x);",
      "73:    fp_copy(pk->y[0], g1->y);",
      "74:   }",
      "",
      "[Added Lines]",
      "69:   bn_rand_mod(d, n);",
      "70:   g2_mul_gen(y, d);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "79:    gt_exp(hs[i], gt, x[i]);",
      "80:   }",
      "84:  }",
      "85:  RLC_CATCH_ANY {",
      "86:   result = RLC_ERR;",
      "",
      "[Removed Lines]",
      "82:   bn_rand_mod(d, n);",
      "83:   g2_mul_gen(y, d);",
      "",
      "[Added Lines]",
      "78:   if (bls) {",
      "79:    result = cp_bls_gen(sk, pk);",
      "80:   } else {",
      "81:    if (cp_ecdsa_gen(sk, g1) == RLC_OK) {",
      "82:     fp_copy(pk->x[0], g1->x);",
      "83:     fp_copy(pk->y[0], g1->y);",
      "84:    } else {",
      "85:     result = RLC_ERR;",
      "86:    }",
      "87:   }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "101:  bn_t k, m, n;",
      "102:  g1_t t;",
      "103:  uint8_t mac[RLC_MD_LEN];",
      "105:  uint8_t *buf = RLC_ALLOCA(uint8_t, 1 + 8 * RLC_PC_BYTES + dlen);",
      "107:  bn_null(k);",
      "108:  bn_null(m);",
      "",
      "[Removed Lines]",
      "104:  int len, dlen = strlen(data), result = RLC_OK;",
      "",
      "[Added Lines]",
      "108:  size_t len, dlen = strlen(data);",
      "110:  int result = RLC_OK;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "211:  g2_t g2;",
      "212:  gt_t e, u, v;",
      "213:  bn_t k, n;",
      "215:  uint8_t *buf = RLC_ALLOCA(uint8_t, 1 + 8 * RLC_PC_BYTES + dlen);",
      "217:  g1_null(g1);",
      "218:  g2_null(g2);",
      "",
      "[Removed Lines]",
      "214:  int len, dlen = strlen(data), result = 1;",
      "",
      "[Added Lines]",
      "219:  size_t len, dlen = strlen(data);",
      "221:  int result = 1;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "331:  g2_t g2;",
      "332:  gt_t e, u, v;",
      "333:  bn_t k, n;",
      "335:  uint8_t *buf = RLC_ALLOCA(uint8_t, 1 + 8 * RLC_FP_BYTES + dlen);",
      "337:  g1_null(g1);",
      "338:  g2_null(g2);",
      "",
      "[Removed Lines]",
      "334:  int len, dlen = strlen(data), result = 1;",
      "",
      "[Added Lines]",
      "340:  size_t len, dlen = strlen(data);",
      "342:  int result = 1;",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_pbpsi.c||src/cp/relic_cp_pbpsi.c": [
      "File: src/cp/relic_cp_pbpsi.c -> src/cp/relic_cp_pbpsi.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "114:    bn_free(_x[i]);",
      "115:   }",
      "116:   RLC_FREE(p);",
      "117:  }",
      "118:  return result;",
      "119: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "117:   RLC_FREE(_x);",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_rsa.c||src/cp/relic_cp_rsa.c": [
      "File: src/cp/relic_cp_rsa.c -> src/cp/relic_cp_rsa.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "248:  uint8_t *id, pad = 0;",
      "250:  bn_t t;",
      "252:  bn_null(t);",
      "",
      "[Removed Lines]",
      "247: static int pad_pkcs1(bn_t m, int *p_len, int m_len, int k_len, int operation) {",
      "249:  int len, result = RLC_ERR;",
      "",
      "[Added Lines]",
      "247: static int pad_pkcs1(bn_t m, int *p_len, size_t m_len, size_t k_len, int op) {",
      "249:  size_t len;",
      "250:  int result = RLC_ERR;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "254:  RLC_TRY {",
      "255:   bn_new(t);",
      "258:    case RSA_ENC:",
      "260:     bn_zero(m);",
      "",
      "[Removed Lines]",
      "257:   switch (operation) {",
      "",
      "[Added Lines]",
      "258:   switch (op) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "423:  uint8_t pad, h1[RLC_MD_LEN], h2[RLC_MD_LEN];",
      "424:  uint8_t *mask = RLC_ALLOCA(uint8_t, k_len);",
      "425:  int result = RLC_ERR;",
      "",
      "[Removed Lines]",
      "422: static int pad_pkcs2(bn_t m, int *p_len, int m_len, int k_len, int operation) {",
      "",
      "[Added Lines]",
      "423: static int pad_pkcs2(bn_t m, int *p_len, size_t m_len, size_t k_len, int op) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "430:  RLC_TRY {",
      "431:   bn_new(t);",
      "434:    case RSA_ENC:",
      "436:     md_map(h1, NULL, 0);",
      "",
      "[Removed Lines]",
      "433:   switch (operation) {",
      "",
      "[Added Lines]",
      "434:   switch (op) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "582:  bn_t t, r;",
      "583:  int result = RLC_OK;",
      "",
      "[Removed Lines]",
      "581: int cp_rsa_gen(rsa_t pub, rsa_t prv, int bits) {",
      "",
      "[Added Lines]",
      "582: int cp_rsa_gen(rsa_t pub, rsa_t prv, size_t bits) {",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_sokaka.c||src/cp/relic_cp_sokaka.c": [
      "File: src/cp/relic_cp_sokaka.c -> src/cp/relic_cp_sokaka.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "73: int cp_sokaka_key(uint8_t *key, size_t key_len, const char *id1,",
      "74:   const sokaka_t k, const char *id2) {",
      "77:  uint8_t *buf;",
      "78:  g1_t p;",
      "79:  g2_t q;",
      "",
      "[Removed Lines]",
      "75:  int len1 = strlen(id1), len2 = strlen(id2);",
      "76:  int size, first = 0, result = RLC_OK;",
      "",
      "[Added Lines]",
      "75:  size_t size, len1 = strlen(id1), len2 = strlen(id2);",
      "76:  int first = 0, result = RLC_OK;",
      "",
      "---------------"
    ],
    "src/cp/relic_cp_vbnn.c||src/cp/relic_cp_vbnn.c": [
      "File: src/cp/relic_cp_vbnn.c -> src/cp/relic_cp_vbnn.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "73: int cp_vbnn_gen_prv(bn_t sk, ec_t pk, const bn_t msk, const uint8_t *id,",
      "74:   size_t id_len) {",
      "75:  uint8_t hash[RLC_MD_LEN];",
      "77:  uint8_t *buf = NULL;",
      "78:  bn_t n, r;",
      "81:  bn_null(n);",
      "",
      "[Removed Lines]",
      "76:  int len, result = RLC_OK;",
      "",
      "[Added Lines]",
      "76:  size_t len;",
      "79:  int result = RLC_OK;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "126: int cp_vbnn_sig(ec_t r, bn_t z, bn_t h, const uint8_t *id, size_t id_len,",
      "127:   const uint8_t *msg, int msg_len, const bn_t sk, const ec_t pk) {",
      "129:  uint8_t *buf = NULL, *buf_i, hash[RLC_MD_LEN];",
      "130:  bn_t n, y;",
      "131:  ec_t t;",
      "134:  bn_null(n);",
      "",
      "[Removed Lines]",
      "128:  int len, result = RLC_OK;",
      "",
      "[Added Lines]",
      "129:  size_t len;",
      "133:  int result = RLC_OK;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "190: int cp_vbnn_ver(const ec_t r, const bn_t z, const bn_t h, const uint8_t *id,",
      "191:   size_t id_len, const uint8_t *msg, int msg_len, const ec_t mpk) {",
      "193:  uint8_t *buf = NULL, *buf_i, hash[RLC_MD_LEN];",
      "194:  bn_t n, c, _h;",
      "199:  bn_null(n);",
      "",
      "[Removed Lines]",
      "192:  int len, result = 0;",
      "195:  ec_t Z;",
      "196:  ec_t t;",
      "",
      "[Added Lines]",
      "194:  size_t len;",
      "197:  ec_t Z, t;",
      "198:  int result = 0;",
      "",
      "---------------"
    ],
    "src/eb/relic_eb_map.c||src/eb/relic_eb_map.c": [
      "File: src/eb/relic_eb_map.c -> src/eb/relic_eb_map.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41:  bn_t k;",
      "42:  fb_t t0, t1;",
      "43:  int i;",
      "",
      "[Removed Lines]",
      "40: void eb_map(eb_t p, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "40: void eb_map(eb_t p, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/eb/relic_eb_mul.c||src/eb/relic_eb_mul.c": [
      "File: src/eb/relic_eb_mul.c -> src/eb/relic_eb_mul.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "51: static void eb_mul_ltnaf_imp(eb_t r, const eb_t p, const bn_t k) {",
      "53:  int8_t tnaf[RLC_FB_BITS + 8], u;",
      "54:  eb_t t[1 << (EB_WIDTH - 2)];",
      "56:  if (eb_curve_opt_a() == RLC_ZERO) {",
      "57:   u = -1;",
      "",
      "[Removed Lines]",
      "52:  int i, l, n;",
      "",
      "[Added Lines]",
      "52:  int i, n;",
      "55:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "122: static void eb_mul_lnaf_imp(eb_t r, const eb_t p, const bn_t k) {",
      "124:  int8_t naf[RLC_FB_BITS + 1];",
      "125:  eb_t t[1 << (EB_WIDTH - 2)];",
      "127:  RLC_TRY {",
      "",
      "[Removed Lines]",
      "123:  int i, l, n;",
      "",
      "[Added Lines]",
      "124:  int i, n;",
      "127:  size_t l;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "192: static void eb_mul_rtnaf_imp(eb_t r, const eb_t p, const bn_t k) {",
      "194:  int8_t tnaf[RLC_FB_BITS + 8], u;",
      "195:  eb_t t[1 << (EB_WIDTH - 2)];",
      "197:  if (eb_curve_opt_a() == RLC_ZERO) {",
      "198:   u = -1;",
      "",
      "[Removed Lines]",
      "193:  int i, l, n;",
      "",
      "[Added Lines]",
      "195:  int i, n;",
      "198:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "491: static void eb_mul_rnaf_imp(eb_t r, const eb_t p, const bn_t k) {",
      "493:  int8_t naf[RLC_FB_BITS + 1];",
      "494:  eb_t t[1 << (EB_WIDTH - 2)];",
      "496:  RLC_TRY {",
      "",
      "[Removed Lines]",
      "492:  int i, l, n;",
      "",
      "[Added Lines]",
      "495:  int i, n;",
      "498:  size_t l;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "650: #if EB_MUL == LODAH || !defined(STRIP)",
      "652: void eb_mul_lodah(eb_t r, const eb_t p, const bn_t k) {",
      "654:  dv_t x1, z1, x2, z2, r1, r2, r3, r4, r5;",
      "655:  const dig_t *b;",
      "656:  bn_t t, n;",
      "658:  if (bn_is_zero(k)) {",
      "659:   eb_set_infty(r);",
      "",
      "[Removed Lines]",
      "653:  int bits, i, j;",
      "",
      "[Added Lines]",
      "660:  size_t bits;",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "721:   fb_mul(z2, z2, r1);",
      "722:   fb_mul(x2, x2, r1);",
      "726:    fb_mul(r1, x1, z2);",
      "727:    fb_mul(r2, x2, z1);",
      "728:    fb_add(r3, r1, r2);",
      "",
      "[Removed Lines]",
      "724:   for (i = bits - 1; i >= 0; i--) {",
      "725:    j = bn_get_bit(t, i);",
      "",
      "[Added Lines]",
      "728:   for (int i = bits - 1; i >= 0; i--) {",
      "729:    int j = bn_get_bit(t, i);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "889: #if EB_MUL == HALVE || !defined(STRIP)",
      "891: void eb_mul_halve(eb_t r, const eb_t p, const bn_t k) {",
      "893:  int8_t naf[RLC_FB_BITS + 1], *_k;",
      "894:  eb_t q, s, t[1 << (EB_WIDTH - 2)];",
      "895:  bn_t n, m;",
      "896:  fb_t u, v, w, z;",
      "898:  if (bn_is_zero(k) || eb_is_infty(p)) {",
      "899:   eb_set_infty(r);",
      "",
      "[Removed Lines]",
      "892:  int i, j, l, trc, cof;",
      "",
      "[Added Lines]",
      "896:  int i, j, trc, cof;",
      "901:  size_t l;",
      "",
      "---------------"
    ],
    "src/eb/relic_eb_mul_sim.c||src/eb/relic_eb_mul_sim.c": [
      "File: src/eb/relic_eb_mul_sim.c -> src/eb/relic_eb_mul_sim.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55: static void eb_mul_sim_kbltz(eb_t r, const eb_t p, const bn_t k, const eb_t q,",
      "56:   const bn_t m, const eb_t *t) {",
      "58:  int8_t u, tnaf0[RLC_FB_BITS + 8], tnaf1[RLC_FB_BITS + 8], *_k, *_m;",
      "59:  eb_t t0[1 << (EB_WIDTH - 2)];",
      "60:  eb_t t1[1 << (EB_WIDTH - 2)];",
      "62:  for (i =  0; i < (1 << (EB_WIDTH - 2)); i++) {",
      "63:   eb_null(t0[i]);",
      "",
      "[Removed Lines]",
      "57:  int i, l, l0, l1, n0, n1, w, g;",
      "",
      "[Added Lines]",
      "57:  int i, n0, n1, w, g;",
      "61:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "184: static void eb_mul_sim_plain(eb_t r, const eb_t p, const bn_t k, const eb_t q,",
      "185:   const bn_t m, const eb_t *t) {",
      "187:  int8_t naf0[RLC_FB_BITS + 1], naf1[RLC_FB_BITS + 1], *_k, *_m;",
      "188:  eb_t t0[1 << (EB_WIDTH - 2)];",
      "189:  eb_t t1[1 << (EB_WIDTH - 2)];",
      "191:  for (i =  0; i < (1 << (EB_WIDTH - 2)); i++) {",
      "192:   eb_null(t0[i]);",
      "",
      "[Removed Lines]",
      "186:  int i, l, l0, l1, n0, n1, w, g;",
      "",
      "[Added Lines]",
      "187:  int i, n0, n1, w, g;",
      "191:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "310: void eb_mul_sim_trick(eb_t r, const eb_t p, const bn_t k, const eb_t q,",
      "311:   const bn_t m) {",
      "312:  eb_t t0[1 << (EB_WIDTH / 2)], t1[1 << (EB_WIDTH / 2)], t[1 << EB_WIDTH];",
      "314:  uint8_t w0[RLC_FB_BITS], w1[RLC_FB_BITS];",
      "315:  bn_t n;",
      "",
      "[Removed Lines]",
      "313:  int l0, l1, w = EB_WIDTH / 2;",
      "",
      "[Added Lines]",
      "315:  size_t l0, l1, w = EB_WIDTH / 2;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "436: void eb_mul_sim_joint(eb_t r, const eb_t p, const bn_t k, const eb_t q,",
      "437:   const bn_t m) {",
      "438:  eb_t t[5];",
      "440:  int8_t jsf[2 * (RLC_FB_BITS + 1)];",
      "442:  if (bn_is_zero(k) || eb_is_infty(p)) {",
      "443:   eb_mul(r, q, m);",
      "",
      "[Removed Lines]",
      "439:  int i, u_i, len, offset;",
      "",
      "[Added Lines]",
      "441:  int i, u_i, offset;",
      "443:  size_t len;",
      "",
      "---------------"
    ],
    "src/eb/relic_eb_util.c||src/eb/relic_eb_util.c": [
      "File: src/eb/relic_eb_util.c -> src/eb/relic_eb_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "500:  return size;",
      "501: }",
      "504:  if (len == 1) {",
      "505:   if (bin[0] == 0) {",
      "506:    eb_set_infty(a);",
      "",
      "[Removed Lines]",
      "503: void eb_read_bin(eb_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "503: void eb_read_bin(eb_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "550:  }",
      "551: }",
      "554:  eb_t t;",
      "556:  eb_null(t);",
      "",
      "[Removed Lines]",
      "553: void eb_write_bin(uint8_t *bin, int len, const eb_t a, int pack) {",
      "",
      "[Added Lines]",
      "553: void eb_write_bin(uint8_t *bin, size_t len, const eb_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/ed/relic_ed_map.c||src/ed/relic_ed_map.c": [
      "File: src/ed/relic_ed_map.c -> src/ed/relic_ed_map.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:  bn_t k;",
      "192:  fp_t t;",
      "193:  ed_t q;",
      "",
      "[Removed Lines]",
      "190: void ed_map_dst(ed_t p, const uint8_t *msg, int len, const uint8_t *dst, int dst_len) {",
      "",
      "[Added Lines]",
      "190: void ed_map_dst(ed_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "191:   size_t dst_len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "254:  }",
      "255: }",
      "258:  ed_map_dst(p, msg, len, (const uint8_t *)\"RELIC\", 5);",
      "259: }",
      "",
      "[Removed Lines]",
      "257: void ed_map(ed_t p, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "258: void ed_map(ed_t p, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/ed/relic_ed_mul.c||src/ed/relic_ed_mul.c": [
      "File: src/ed/relic_ed_mul.c -> src/ed/relic_ed_mul.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "39: #if ED_MUL == LWNAF || !defined(STRIP)",
      "41: static void ed_mul_naf_imp(ed_t r, const ed_t p, const bn_t k) {",
      "43:  int8_t naf[RLC_FP_BITS + 1];",
      "44:  ed_t t[1 << (ED_WIDTH - 2)];",
      "46:  if (bn_is_zero(k)) {",
      "47:   ed_set_infty(r);",
      "",
      "[Removed Lines]",
      "42:  int l, i, n;",
      "",
      "[Added Lines]",
      "42:  int i, n;",
      "45:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "111: static void ed_mul_reg_imp(ed_t r, const ed_t p, const bn_t k) {",
      "112:  bn_t _k;",
      "114:  int8_t s, reg[RLC_CEIL(RLC_FP_BITS + 1, ED_WIDTH - 1)];",
      "115:  ed_t t[1 << (ED_WIDTH - 2)], u, v;",
      "117:  bn_null(_k);",
      "118:  if (bn_is_zero(k)) {",
      "",
      "[Removed Lines]",
      "113:  int i, j, l, n;",
      "",
      "[Added Lines]",
      "114:  int i, j, n;",
      "117:  size_t l;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "234: void ed_mul_slide(ed_t r, const ed_t p, const bn_t k) {",
      "235:  ed_t t[1 << (EP_WIDTH - 1)], q;",
      "237:  uint8_t win[RLC_FP_BITS + 1];",
      "239:  ed_null(q);",
      "",
      "[Removed Lines]",
      "236:  int i, j, l;",
      "",
      "[Added Lines]",
      "239:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "244:  }",
      "246:  RLC_TRY {",
      "248:    ed_null(t[i]);",
      "249:    ed_new(t[i]);",
      "250:   }",
      "",
      "[Removed Lines]",
      "247:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "249:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "259: #endif",
      "263:    ed_add(t[i], t[i - 1], q);",
      "264:   }",
      "",
      "[Removed Lines]",
      "262:   for (i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "264:   for (size_t i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "270:   ed_set_infty(q);",
      "271:   l = RLC_FP_BITS + 1;",
      "272:   bn_rec_slw(win, &l, k, EP_WIDTH);",
      "274:    if (win[i] == 0) {",
      "275:     ed_dbl(q, q);",
      "276:    } else {",
      "278:      ed_dbl(q, q);",
      "279:     }",
      "280:     ed_add(q, q, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "273:   for (i = 0; i < l; i++) {",
      "277:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "275:   for (size_t i = 0; i < l; i++) {",
      "279:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "290:   RLC_THROW(ERR_CAUGHT);",
      "291:  }",
      "292:  RLC_FINALLY {",
      "294:    ed_free(t[i]);",
      "295:   }",
      "296:   ed_free(q);",
      "",
      "[Removed Lines]",
      "293:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "295:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "409:  ed_t t;",
      "410:  bn_t _k;",
      "411:  int8_t u, naf[RLC_DIG + 1];",
      "414:  ed_null(t);",
      "415:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "412:  int l;",
      "",
      "[Added Lines]",
      "414:  size_t l;",
      "",
      "---------------"
    ],
    "src/ed/relic_ed_mul_fix.c||src/ed/relic_ed_mul_fix.c": [
      "File: src/ed/relic_ed_mul_fix.c -> src/ed/relic_ed_mul_fix.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "49: static void ed_mul_fix_plain(ed_t r, const ed_t * t, const bn_t k) {",
      "51:  int8_t naf[RLC_FP_BITS + 1], *_k;",
      "54:  l = RLC_FP_BITS + 1;",
      "",
      "[Removed Lines]",
      "50:  int l, i, n;",
      "",
      "[Added Lines]",
      "50:  int i, n;",
      "52:  size_t l;",
      "",
      "---------------"
    ],
    "src/ed/relic_ed_mul_sim.c||src/ed/relic_ed_mul_sim.c": [
      "File: src/ed/relic_ed_mul_sim.c -> src/ed/relic_ed_mul_sim.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "54: static void ed_mul_sim_plain(ed_t r, const ed_t p, const bn_t k, const ed_t q,",
      "55:   const bn_t m, const ed_t *t) {",
      "57:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *_k, *_m;",
      "58:  ed_t t0[1 << (ED_WIDTH - 2)];",
      "59:  ed_t t1[1 << (ED_WIDTH - 2)];",
      "61:  RLC_TRY {",
      "62:   gen = (t == NULL ? 0 : 1);",
      "",
      "[Removed Lines]",
      "56:  int i, l, l0, l1, n0, n1, w, gen;",
      "",
      "[Added Lines]",
      "56:  int i, n0, n1, w, gen;",
      "60:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "176:   const bn_t m) {",
      "177:  ed_t t0[1 << (ED_WIDTH / 2)], t1[1 << (ED_WIDTH / 2)], t[1 << ED_WIDTH];",
      "178:  bn_t n;",
      "180:  uint8_t w0[RLC_FP_BITS + 1], w1[RLC_FP_BITS + 1];",
      "182:  bn_null(n);",
      "",
      "[Removed Lines]",
      "179:  int l0, l1, w = ED_WIDTH / 2;",
      "",
      "[Added Lines]",
      "180:  size_t l0, l1, w = ED_WIDTH / 2;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "293: void ed_mul_sim_joint(ed_t r, const ed_t p, const bn_t k, const ed_t q,",
      "294:   const bn_t m) {",
      "295:  ed_t t[5];",
      "297:  int8_t jsf[2 * (RLC_FP_BITS + 1)];",
      "299:  if (bn_is_zero(k) || ed_is_infty(p)) {",
      "300:   ed_mul(r, q, m);",
      "",
      "[Removed Lines]",
      "296:  int i, l, u_i, offset;",
      "",
      "[Added Lines]",
      "297:  int i, u_i, offset;",
      "299:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "398: }",
      "400: void ed_mul_sim_lot(ed_t r, const ed_t p[], const bn_t k[], int n) {",
      "403:  int8_t *naf = NULL;",
      "405:  RLC_TRY {",
      "406:   l = 0;",
      "",
      "[Removed Lines]",
      "401:  int i, j, l, *_l = RLC_ALLOCA(int, n);",
      "402:  ed_t *_p = RLC_ALLOCA(ed_t, n);",
      "",
      "[Added Lines]",
      "403:  int i, j;",
      "405:  ed_t *_p = RLC_ALLOCA(ed_t, n);",
      "406:  size_t l, *_l = RLC_ALLOCA(size_t, n);",
      "",
      "---------------"
    ],
    "src/ed/relic_ed_util.c||src/ed/relic_ed_util.c": [
      "File: src/ed/relic_ed_util.c -> src/ed/relic_ed_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "242:  return size;",
      "243: }",
      "246:  if (len == 1) {",
      "247:   if (bin[0] == 0) {",
      "248:    ed_set_infty(a);",
      "",
      "[Removed Lines]",
      "245: void ed_read_bin(ed_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "245: void ed_read_bin(ed_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "297:  }",
      "298: }",
      "301:  ed_t t;",
      "303:  ed_null(t);",
      "",
      "[Removed Lines]",
      "300: void ed_write_bin(uint8_t *bin, int len, const ed_t a, int pack) {",
      "",
      "[Added Lines]",
      "300: void ed_write_bin(uint8_t *bin, size_t len, const ed_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/ep/relic_ep_map.c||src/ep/relic_ep_map.c": [
      "File: src/ep/relic_ep_map.c -> src/ep/relic_ep_map.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "68: #undef EP_MAP_COPY_COND",
      "70: static inline int fp_sgn0(const fp_t t, bn_t k) {",
      "71:  fp_prime_back(k, t);",
      "72:  return bn_get_bit(k, 0);",
      "",
      "[Removed Lines]",
      "51: TMPL_MAP_HORNER(fp, fp_st)",
      "55:   TMPL_MAP_ISOGENY_MAP(ep, fp, iso)",
      "61: #define EP_MAP_COPY_COND(O, I, C) dv_copy_cond(O, I, RLC_FP_DIGS, C)",
      "62:   TMPL_MAP_SSWU(ep, fp, dig_t, EP_MAP_COPY_COND)",
      "67: TMPL_MAP_SVDW(ep, fp, dig_t, EP_MAP_COPY_COND)",
      "",
      "[Added Lines]",
      "51: TMPL_MAP_HORNER(fp, fp_st);",
      "56: TMPL_MAP_ISOGENY_MAP(ep, fp, iso);",
      "60: #define EP_MAP_COPY_COND(O, I, C) dv_copy_cond(O, I, RLC_FP_DIGS, C)",
      "65: TMPL_MAP_SSWU(ep, fp, dig_t, EP_MAP_COPY_COND);",
      "71: TMPL_MAP_SVDW(ep, fp, dig_t, EP_MAP_COPY_COND);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "80:  bn_t k;",
      "81:  fp_t t;",
      "82:  ep_t q;",
      "",
      "[Removed Lines]",
      "79: void ep_map_from_field(ep_t p, const uint8_t *uniform_bytes, int len) {",
      "",
      "[Added Lines]",
      "85: void ep_map_from_field(ep_t p, const uint8_t *uniform_bytes, size_t len) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "101:   const int abNeq0 = (ep_curve_opt_a() != RLC_ZERO) &&",
      "102:     (ep_curve_opt_b() != RLC_ZERO);",
      "104:     abNeq0) ? ep_map_sswu : ep_map_svdw;",
      "125:   EP_MAP_CONVERT_BYTES(0);",
      "",
      "[Removed Lines]",
      "103:   void (*const map_fn)(ep_t, fp_t) =(ep_curve_is_ctmap() ||",
      "106: #define EP_MAP_CONVERT_BYTES(IDX)                                       \\",
      "107:     do {                                                                \\",
      "108:       bn_read_bin(k, uniform_bytes + IDX * len_per_elm, len_per_elm);   \\",
      "109:       fp_prime_conv(t, k);                                              \\",
      "110:     } while (0)",
      "112: #define EP_MAP_APPLY_MAP(PT)                                    \\",
      "113:     do {                                                        \\",
      "115:       neg = fp_sgn0(t, k);                                      \\",
      "117:       map_fn(PT, t);                                            \\",
      "119:       neg = neg != fp_sgn0(PT->y, k);                             \\",
      "120:       fp_neg(t, PT->y);                                          \\",
      "121:       dv_copy_cond(PT->y, t, RLC_FP_DIGS, neg);                  \\",
      "122:     } while (0)",
      "",
      "[Added Lines]",
      "109:   void (*const map_fn)(ep_t, fp_t) = (ep_curve_is_ctmap() ||",
      "112: #define EP_MAP_CONVERT_BYTES(IDX)           \\",
      "113:   do {                \\",
      "114:    bn_read_bin(k, uniform_bytes + IDX * len_per_elm, len_per_elm); \\",
      "115:    fp_prime_conv(t, k);           \\",
      "116:   } while (0)",
      "118: #define EP_MAP_APPLY_MAP(PT)            \\",
      "119:   do {                \\",
      "121:    neg = fp_sgn0(t, k);           \\",
      "123:    map_fn(PT, t);             \\",
      "125:    neg = neg != fp_sgn0(PT->y, k);         \\",
      "126:    fp_neg(t, PT->y);            \\",
      "127:    dv_copy_cond(PT->y, t, RLC_FP_DIGS, neg);      \\",
      "128:   } while (0)",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "179:  }",
      "180: }",
      "186:  const int len_per_elm = (FP_PRIME + ep_param_level() + 7) / 8;",
      "",
      "[Removed Lines]",
      "182: void ep_map_dst(ep_t p, const uint8_t *msg, int len, const uint8_t *dst,",
      "183:   int dst_len) {",
      "",
      "[Added Lines]",
      "188: void ep_map_dst(ep_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "189:   size_t dst_len) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "202:  }",
      "203: }",
      "206:  ep_map_dst(p, msg, len, (const uint8_t *)\"RELIC\", 5);",
      "207: }",
      "",
      "[Removed Lines]",
      "205: void ep_map(ep_t p, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "211: void ep_map(ep_t p, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/ep/relic_ep_mul.c||src/ep/relic_ep_mul.c": [
      "File: src/ep/relic_ep_mul.c -> src/ep/relic_ep_mul.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "40: #if defined(EP_ENDOM)",
      "42: static void ep_mul_glv_imp(ep_t r, const ep_t p, const bn_t k) {",
      "44:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *t0, *t1;",
      "45:  bn_t n, _k, k0, k1, v1[3], v2[3];",
      "46:  ep_t q, t[1 << (EP_WIDTH - 2)];",
      "48:  bn_null(n);",
      "49:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "43:  int l, l0, l1, i, n0, n1, s0, s1;",
      "",
      "[Added Lines]",
      "43:  int i, n0, n1, s0, s1;",
      "47:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "153: #if defined(EP_PLAIN) || defined(EP_SUPER)",
      "155: static void ep_mul_naf_imp(ep_t r, const ep_t p, const bn_t k) {",
      "158:  int8_t u, naf[RLC_FP_BITS + 2];",
      "159:  ep_t t[1 << (EP_WIDTH - 2)];",
      "160:  bn_t _k, n;",
      "162:  bn_null(n);",
      "163:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "156:  int i, l;",
      "",
      "[Added Lines]",
      "161:  size_t l;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "166:   bn_new(n);",
      "167:   bn_new(_k);",
      "170:    ep_null(t[i]);",
      "171:    ep_new(t[i]);",
      "172:   }",
      "",
      "[Removed Lines]",
      "169:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "170:   for (int i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "182:   bn_rec_naf(naf, &l, _k, EP_WIDTH);",
      "184:   ep_set_infty(r);",
      "186:    ep_dbl(r, r);",
      "188:    u = naf[i];",
      "",
      "[Removed Lines]",
      "185:   for (i = l - 1; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "186:   for (int i = l - 1; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "205:   bn_free(n);",
      "206:   bn_free(_k);",
      "209:    ep_free(t[i]);",
      "210:   }",
      "211:  }",
      "",
      "[Removed Lines]",
      "208:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "209:   for (int i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "219: #if defined(EP_ENDOM)",
      "221: static void ep_mul_reg_glv(ep_t r, const ep_t p, const bn_t k) {",
      "223:  int8_t _s0, _s1, reg0[RLC_FP_BITS + 1], reg1[RLC_FP_BITS + 1];",
      "224:  bn_t n, _k, k0, k1, v1[3], v2[3];",
      "225:  ep_t q, t[1 << (EP_WIDTH - 2)], u, v, w;",
      "227:  bn_null(n);",
      "228:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "222:  int i, j, l, n0, n1, s0, s1, b0, b1;",
      "",
      "[Added Lines]",
      "223:  int i, j, n0, n1, s0, s1, b0, b1;",
      "227:  size_t l;",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "372: static void ep_mul_reg_imp(ep_t r, const ep_t p, const bn_t k) {",
      "373:  bn_t _k;",
      "375:  int8_t s, reg[1 + RLC_CEIL(RLC_FP_BITS + 1, EP_WIDTH - 1)];",
      "376:  ep_t t[1 << (EP_WIDTH - 2)], u, v;",
      "378:  if (bn_is_zero(k)) {",
      "379:   ep_set_infty(r);",
      "",
      "[Removed Lines]",
      "374:  int i, j, l, n;",
      "",
      "[Added Lines]",
      "376:  int i, j, n;",
      "379:  size_t l;",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "502: void ep_mul_slide(ep_t r, const ep_t p, const bn_t k) {",
      "503:  bn_t _k, n;",
      "504:  ep_t t[1 << (EP_WIDTH - 1)], q;",
      "506:  uint8_t win[RLC_FP_BITS + 1];",
      "508:  if (bn_is_zero(k) || ep_is_infty(p)) {",
      "509:   ep_set_infty(r);",
      "",
      "[Removed Lines]",
      "505:  int i, j, l;",
      "",
      "[Added Lines]",
      "509:  size_t l;",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "517:  RLC_TRY {",
      "518:   bn_new(n);",
      "519:   bn_new(_k);",
      "521:    ep_null(t[i]);",
      "522:    ep_new(t[i]);",
      "523:   }",
      "",
      "[Removed Lines]",
      "520:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "523:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "534:   bn_mod(_k, k, n);",
      "538:    ep_add(t[i], t[i - 1], q);",
      "539:   }",
      "",
      "[Removed Lines]",
      "537:   for (i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "540:   for (size_t i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "545:   ep_set_infty(q);",
      "546:   l = RLC_FP_BITS + 1;",
      "547:   bn_rec_slw(win, &l, _k, EP_WIDTH);",
      "549:    if (win[i] == 0) {",
      "550:     ep_dbl(q, q);",
      "551:    } else {",
      "553:      ep_dbl(q, q);",
      "554:     }",
      "555:     ep_add(q, q, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "548:   for (i = 0; i < l; i++) {",
      "552:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "551:   for (size_t i = 0; i < l; i++) {",
      "555:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "567:  RLC_FINALLY {",
      "568:   bn_free(n);",
      "569:   bn_free(_k);",
      "571:    ep_free(t[i]);",
      "572:   }",
      "573:   ep_free(q);",
      "",
      "[Removed Lines]",
      "570:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "573:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "579: #if EP_MUL == MONTY || !defined(STRIP)",
      "581: void ep_mul_monty(ep_t r, const ep_t p, const bn_t k) {",
      "583:  ep_t t[2];",
      "584:  bn_t n, l, _k;",
      "586:  bn_null(n);",
      "587:  bn_null(l);",
      "",
      "[Removed Lines]",
      "582:  int i, j, bits;",
      "",
      "[Added Lines]",
      "587:  size_t bits;",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "619:   ep_blind(t[0], t[0]);",
      "620:   ep_blind(t[1], t[1]);",
      "624:    dv_swap_cond(t[0]->x, t[1]->x, RLC_FP_DIGS, j ^ 1);",
      "625:    dv_swap_cond(t[0]->y, t[1]->y, RLC_FP_DIGS, j ^ 1);",
      "626:    dv_swap_cond(t[0]->z, t[1]->z, RLC_FP_DIGS, j ^ 1);",
      "",
      "[Removed Lines]",
      "622:   for (i = bits - 1; i >= 0; i--) {",
      "623:    j = bn_get_bit(l, i);",
      "",
      "[Added Lines]",
      "625:   for (int i = bits - 1; i >= 0; i--) {",
      "626:    int j = bn_get_bit(l, i);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "723:  ep_t t;",
      "724:  bn_t _k;",
      "725:  int8_t u, naf[RLC_DIG + 1];",
      "728:  ep_null(t);",
      "729:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "726:  int l;",
      "",
      "[Added Lines]",
      "729:  size_t l;",
      "",
      "---------------"
    ],
    "src/ep/relic_ep_mul_fix.c||src/ep/relic_ep_mul_fix.c": [
      "File: src/ep/relic_ep_mul_fix.c -> src/ep/relic_ep_mul_fix.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "48: static void ep_mul_fix_plain(ep_t r, const ep_t *t, const bn_t k) {",
      "50:  int8_t naf[RLC_FP_BITS + 1];",
      "53:  l = RLC_FP_BITS + 1;",
      "",
      "[Removed Lines]",
      "49:  int l, i, n;",
      "",
      "[Added Lines]",
      "49:  int i, n;",
      "51:  size_t l;",
      "",
      "---------------"
    ],
    "src/ep/relic_ep_mul_sim.c||src/ep/relic_ep_mul_sim.c": [
      "File: src/ep/relic_ep_mul_sim.c -> src/ep/relic_ep_mul_sim.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55: static void ep_mul_sim_endom(ep_t r, const ep_t p, const bn_t k, const ep_t q,",
      "56:   const bn_t m, const ep_t *t) {",
      "58:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *t0, *t1, u;",
      "59:  int8_t naf2[RLC_FP_BITS + 1], naf3[RLC_FP_BITS + 1], *t2, *t3;",
      "60:  bn_t n, k0, k1, m0, m1;",
      "",
      "[Removed Lines]",
      "57:  int i, l, l0, l1, l2, l3, sk0, sk1, sl0, sl1, w, g = 0;",
      "",
      "[Added Lines]",
      "57:  int i, sk0, sk1, sl0, sl1, w, g = 0;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "62:  ep_t v;",
      "63:  ep_t tab0[1 << (EP_WIDTH - 2)];",
      "64:  ep_t tab1[1 << (EP_WIDTH - 2)];",
      "66:  bn_null(n);",
      "67:  bn_null(k0);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "65:  size_t l, l0, l1, l2, l3;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "265: void ep_mul_sim_lot_endom(ep_t r, const ep_t p[], const bn_t k[], int n) {",
      "266:  const int len = RLC_FP_BITS + 1;",
      "268:  bn_t _k[2], q, v1[3], v2[3];",
      "269:  int8_t ptr, *naf = RLC_ALLOCA(int8_t, 2 * n * len);",
      "271:  bn_null(q);",
      "",
      "[Removed Lines]",
      "267:  int i, j, m, l, _l[2], sk;",
      "",
      "[Added Lines]",
      "268:  int i, j, m, sk;",
      "271:  size_t l, _l[2];",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "487: static void ep_mul_sim_plain(ep_t r, const ep_t p, const bn_t k, const ep_t q,",
      "488:   const bn_t m, const ep_t *t) {",
      "490:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], n0, n1, *u, *v;",
      "491:  ep_t t0[1 << (EP_WIDTH - 2)];",
      "492:  ep_t t1[1 << (EP_WIDTH - 2)];",
      "494:  RLC_TRY {",
      "495:   gen = (t == NULL ? 0 : 1);",
      "",
      "[Removed Lines]",
      "489:  int i, l, l0, l1, w, gen;",
      "",
      "[Added Lines]",
      "491:  int i, w, gen;",
      "495:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "585: void ep_mul_sim_lot_plain(ep_t r, const ep_t p[], const bn_t k[], int n) {",
      "588:  int8_t *naf = NULL;",
      "590:  RLC_TRY {",
      "591:   l = 0;",
      "",
      "[Removed Lines]",
      "586:  int i, j, l, *_l = RLC_ALLOCA(int, n);",
      "587:  ep_t *_p = RLC_ALLOCA(ep_t, n);",
      "",
      "[Added Lines]",
      "589:  int i, j;",
      "591:  ep_t *_p = RLC_ALLOCA(ep_t, n);",
      "592:  size_t l, *_l = RLC_ALLOCA(size_t, n);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "677:   const bn_t m) {",
      "678:  ep_t t0[1 << (EP_WIDTH / 2)], t1[1 << (EP_WIDTH / 2)], t[1 << EP_WIDTH];",
      "679:  bn_t n, _k, _m;",
      "681:  uint8_t w0[RLC_FP_BITS + 1], w1[RLC_FP_BITS + 1];",
      "683:  if (bn_is_zero(k) || ep_is_infty(p)) {",
      "",
      "[Removed Lines]",
      "680:  int l0, l1, w = EP_WIDTH / 2;",
      "",
      "[Added Lines]",
      "684:  size_t l0, l1, w = EP_WIDTH / 2;",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "838:   const bn_t m) {",
      "839:  bn_t n, _k, _m;",
      "840:  ep_t t[5];",
      "842:  int8_t jsf[2 * (RLC_FP_BITS + 1)];",
      "844:  if (bn_is_zero(k) || ep_is_infty(p)) {",
      "845:   ep_mul(r, q, m);",
      "",
      "[Removed Lines]",
      "841:  int i, l, u_i, offset;",
      "",
      "[Added Lines]",
      "845:  int i, u_i, offset;",
      "847:  size_t l;",
      "",
      "---------------"
    ],
    "src/ep/relic_ep_util.c||src/ep/relic_ep_util.c": [
      "File: src/ep/relic_ep_util.c -> src/ep/relic_ep_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "234:  return size;",
      "235: }",
      "238:  if (len == 1) {",
      "239:   if (bin[0] == 0) {",
      "240:    ep_set_infty(a);",
      "",
      "[Removed Lines]",
      "237: void ep_read_bin(ep_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "237: void ep_read_bin(ep_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "284:  }",
      "285: }",
      "288:  ep_t t;",
      "290:  ep_null(t);",
      "",
      "[Removed Lines]",
      "287: void ep_write_bin(uint8_t *bin, int len, const ep_t a, int pack) {",
      "",
      "[Added Lines]",
      "287: void ep_write_bin(uint8_t *bin, size_t len, const ep_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep2_map.c||src/epx/relic_ep2_map.c": [
      "File: src/epx/relic_ep2_map.c -> src/epx/relic_ep2_map.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "50: TMPL_MAP_HORNER(fp2, fp2_t)",
      "55: TMPL_MAP_ISOGENY_MAP(ep2, fp2, iso2)",
      "65:  } while (0)",
      "66: TMPL_MAP_SSWU(ep2, fp2, fp_t, EP2_MAP_COPY_COND)",
      "71: TMPL_MAP_SVDW(ep2, fp2, fp_t, EP2_MAP_COPY_COND)",
      "72: #undef EP2_MAP_COPY_COND",
      "75: static inline int fp2_sgn0(const fp2_t t, bn_t k) {",
      "76:  const int t_0_zero = fp_is_zero(t[0]);",
      "",
      "[Removed Lines]",
      "61: #define EP2_MAP_COPY_COND(O, I, C)                                                       \\",
      "62:  do {                                                                                 \\",
      "63:   dv_copy_cond(O[0], I[0], RLC_FP_DIGS, C);                                        \\",
      "64:   dv_copy_cond(O[1], I[1], RLC_FP_DIGS, C);                                        \\",
      "",
      "[Added Lines]",
      "59: #define EP2_MAP_COPY_COND(O, I, C)           \\",
      "60:  do {                 \\",
      "61:   dv_copy_cond(O[0], I[0], RLC_FP_DIGS, C);       \\",
      "62:   dv_copy_cond(O[1], I[1], RLC_FP_DIGS, C);       \\",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "151: #undef EP2_MAP_CONVERT_BYTES",
      "152: #undef EP2_MAP_APPLY_MAP",
      "167: }",
      "189: }",
      "192:  ep2_map_dst(p, msg, len, (const uint8_t *)\"RELIC\", 5);",
      "193: }",
      "",
      "[Removed Lines]",
      "92: void ep2_map_from_field(ep2_t p, const uint8_t *uniform_bytes, int len) {",
      "93:         bn_t k;",
      "94:         fp2_t t;",
      "95:         ep2_t q;",
      "96:         int neg;",
      "98:         const int len_per_elm = (FP_PRIME + ep_param_level() + 7) / 8;",
      "100:         bn_null(k);",
      "101:         fp2_null(t);",
      "102:         ep2_null(q);",
      "104:         RLC_TRY {",
      "105:                 if (len != 2* len_per_elm) {",
      "106:                   RLC_THROW(ERR_NO_VALID);",
      "107:                 }",
      "109:                 bn_new(k);",
      "110:                 fp2_new(t);",
      "111:                 ep2_new(q);",
      "114:                 const int abNeq0 = (ep2_curve_opt_a() != RLC_ZERO) && (ep2_curve_opt_b() != RLC_ZERO);",
      "115:                 void (*const map_fn)(ep2_t, fp2_t) = (ep2_curve_is_ctmap() || abNeq0) ? ep2_map_sswu : ep2_map_svdw;",
      "117: #define EP2_MAP_CONVERT_BYTES(IDX)                                                       \\",
      "118:         do {                                                                                 \\",
      "119:                 bn_read_bin(k, uniform_bytes + 2 * IDX * len_per_elm, len_per_elm);        \\",
      "120:                 fp_prime_conv(t[0], k);                                                          \\",
      "121:                 bn_read_bin(k, uniform_bytes + (2 * IDX + 1) * len_per_elm, len_per_elm);  \\",
      "122:                 fp_prime_conv(t[1], k);                                                          \\",
      "123:         } while (0)",
      "125: #define EP2_MAP_APPLY_MAP(PT)                                                            \\",
      "126:         do {                                                                                 \\",
      "128:                 neg = fp2_sgn0(t, k);                                                            \\",
      "130:                 map_fn(PT, t);                                                                   \\",
      "132:                 neg = neg != fp2_sgn0(PT->y, k);                                                 \\",
      "133:                 fp2_neg(t, PT->y);                                                               \\",
      "134:                 dv_copy_cond(PT->y[0], t[0], RLC_FP_DIGS, neg);                                  \\",
      "135:                 dv_copy_cond(PT->y[1], t[1], RLC_FP_DIGS, neg);                                  \\",
      "136:         } while (0)",
      "139:                 EP2_MAP_CONVERT_BYTES(0);",
      "140:                 EP2_MAP_APPLY_MAP(p);",
      "141:                 TMPL_MAP_CALL_ISOMAP(ep2, p);",
      "144:                 EP2_MAP_CONVERT_BYTES(1);",
      "145:                 EP2_MAP_APPLY_MAP(q);",
      "146:                 TMPL_MAP_CALL_ISOMAP(ep2, q);",
      "155:                 ep2_add(p, p, q);",
      "156:                 ep2_norm(p, p);",
      "157:                 ep2_mul_cof(p, p);",
      "158:         }",
      "159:         RLC_CATCH_ANY {",
      "160:                 RLC_THROW(ERR_CAUGHT);",
      "161:         }",
      "162:         RLC_FINALLY {",
      "163:                 bn_free(k);",
      "164:                 fp2_free(t);",
      "165:                 ep2_free(q);",
      "166:         }",
      "170: void ep2_map_dst(ep2_t p, const uint8_t *msg, int len, const uint8_t *dst, int dst_len) {",
      "173:         const int len_per_elm = (FP_PRIME + ep_param_level() + 7) / 8;",
      "174:         uint8_t *pseudo_random_bytes = RLC_ALLOCA(uint8_t, 4 * len_per_elm);",
      "176:         RLC_TRY {",
      "180:                 md_xmd(pseudo_random_bytes, 4 * len_per_elm, msg, len, dst, dst_len);",
      "181:                 ep2_map_from_field(p, pseudo_random_bytes, 2 * len_per_elm);",
      "182:         }",
      "183:         RLC_CATCH_ANY {",
      "184:                 RLC_THROW(ERR_CAUGHT);",
      "185:         }",
      "186:         RLC_FINALLY {",
      "187:                 RLC_FREE(pseudo_random_bytes);",
      "188:         }",
      "191: void ep2_map(ep2_t p, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "88: void ep2_map_from_field(ep2_t p, const uint8_t *uniform_bytes, size_t len) {",
      "89:  bn_t k;",
      "90:  fp2_t t;",
      "91:  ep2_t q;",
      "92:  int neg;",
      "94:  const int lpe = (FP_PRIME + ep_param_level() + 7) / 8;",
      "96:  bn_null(k);",
      "97:  fp2_null(t);",
      "98:  ep2_null(q);",
      "100:  RLC_TRY {",
      "101:   if (len != 2 * lpe) {",
      "102:    RLC_THROW(ERR_NO_VALID);",
      "103:   }",
      "105:   bn_new(k);",
      "106:   fp2_new(t);",
      "107:   ep2_new(q);",
      "110:   const int abNeq0 = (ep2_curve_opt_a() != RLC_ZERO) &&",
      "111:     (ep2_curve_opt_b() != RLC_ZERO);",
      "112:   void (*const map_fn)(ep2_t, fp2_t) = (ep2_curve_is_ctmap() ||",
      "113:     abNeq0) ? ep2_map_sswu : ep2_map_svdw;",
      "115: #define EP2_MAP_CONVERT_BYTES(IDX)           \\",
      "116:   do {                \\",
      "117:    bn_read_bin(k, uniform_bytes + 2 * IDX * lpe, lpe);    \\",
      "118:    fp_prime_conv(t[0], k);           \\",
      "119:    bn_read_bin(k, uniform_bytes + (2 * IDX + 1) * lpe, lpe);  \\",
      "120:    fp_prime_conv(t[1], k);           \\",
      "121:      } while (0)",
      "123: #define EP2_MAP_APPLY_MAP(PT)            \\",
      "124:   do {                \\",
      "126:             neg = fp2_sgn0(t, k);           \\",
      "128:             map_fn(PT, t);             \\",
      "130:             neg = neg != fp2_sgn0(PT->y, k);        \\",
      "131:             fp2_neg(t, PT->y);            \\",
      "132:             dv_copy_cond(PT->y[0], t[0], RLC_FP_DIGS, neg);     \\",
      "133:             dv_copy_cond(PT->y[1], t[1], RLC_FP_DIGS, neg);     \\",
      "134:   } while (0)",
      "137:   EP2_MAP_CONVERT_BYTES(0);",
      "138:   EP2_MAP_APPLY_MAP(p);",
      "139:   TMPL_MAP_CALL_ISOMAP(ep2, p);",
      "142:   EP2_MAP_CONVERT_BYTES(1);",
      "143:   EP2_MAP_APPLY_MAP(q);",
      "144:   TMPL_MAP_CALL_ISOMAP(ep2, q);",
      "153:   ep2_add(p, p, q);",
      "154:   ep2_norm(p, p);",
      "155:   ep2_mul_cof(p, p);",
      "156:  }",
      "157:  RLC_CATCH_ANY {",
      "158:   RLC_THROW(ERR_CAUGHT);",
      "159:  }",
      "160:  RLC_FINALLY {",
      "161:   bn_free(k);",
      "162:   fp2_free(t);",
      "163:   ep2_free(q);",
      "164:  }",
      "168: void ep2_map_dst(ep2_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
      "169:   size_t dst_len) {",
      "171:  const int lpe = (FP_PRIME + ep_param_level() + 7) / 8;",
      "172:  uint8_t *pseudo_random_bytes = RLC_ALLOCA(uint8_t, 4 * lpe);",
      "174:  RLC_TRY {",
      "177:   md_xmd(pseudo_random_bytes, 4 * lpe, msg, len, dst, dst_len);",
      "178:   ep2_map_from_field(p, pseudo_random_bytes, 2 * lpe);",
      "179:  }",
      "180:  RLC_CATCH_ANY {",
      "181:   RLC_THROW(ERR_CAUGHT);",
      "182:  }",
      "183:  RLC_FINALLY {",
      "184:   RLC_FREE(pseudo_random_bytes);",
      "185:  }",
      "188: void ep2_map(ep2_t p, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep2_mul.c||src/epx/relic_ep2_mul.c": [
      "File: src/epx/relic_ep2_mul.c -> src/epx/relic_ep2_mul.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if defined(EP_ENDOM)",
      "43: static void ep2_mul_glv_imp(ep2_t r, const ep2_t p, const bn_t k) {",
      "45:  bn_t n, _k[4], u;",
      "46:  int8_t naf[4][RLC_FP_BITS + 1];",
      "47:  ep2_t q[4];",
      "",
      "[Removed Lines]",
      "44:  int i, j, l, _l[4];",
      "",
      "[Added Lines]",
      "44:  size_t l, _l[4];",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "52:  RLC_TRY {",
      "53:   bn_new(n);",
      "54:   bn_new(u);",
      "56:    bn_null(_k[i]);",
      "57:    ep2_null(q[i]);",
      "58:    bn_new(_k[i]);",
      "",
      "[Removed Lines]",
      "55:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "55:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "70:   ep2_frb(q[3], q[2], 1);",
      "72:   l = 0;",
      "74:    if (bn_sign(_k[i]) == RLC_NEG) {",
      "75:     ep2_neg(q[i], q[i]);",
      "76:    }",
      "",
      "[Removed Lines]",
      "73:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "73:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "80:   }",
      "82:   ep2_set_infty(r);",
      "84:    ep2_dbl(r, r);",
      "87:     if (naf[i][j] > 0) {",
      "88:      ep2_add(r, r, q[i]);",
      "89:     }",
      "",
      "[Removed Lines]",
      "83:   for (j = l - 1; j >= 0; j--) {",
      "86:    for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "83:   for (int j = l - 1; j >= 0; j--) {",
      "86:    for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "102:  RLC_FINALLY {",
      "103:   bn_free(n);",
      "104:   bn_free(u);",
      "106:    bn_free(_k[i]);",
      "107:    ep2_free(q[i]);",
      "108:   }",
      "",
      "[Removed Lines]",
      "105:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "105:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "115: static void ep2_mul_naf_imp(ep2_t r, const ep2_t p, const bn_t k) {",
      "117:  int8_t naf[RLC_FP_BITS + 1];",
      "118:  ep2_t t[1 << (EP_WIDTH - 2)];",
      "120:  RLC_TRY {",
      "123:    ep2_null(t[i]);",
      "124:    ep2_new(t[i]);",
      "125:   }",
      "",
      "[Removed Lines]",
      "116:  int l, i, n;",
      "122:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "116:  size_t l, n;",
      "122:   for (int i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "131:   bn_rec_naf(naf, &l, k, EP_WIDTH);",
      "133:   ep2_set_infty(r);",
      "135:    ep2_dbl(r, r);",
      "137:    n = naf[i];",
      "",
      "[Removed Lines]",
      "134:   for (i = l - 1; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "134:   for (int i = l - 1; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "153:  }",
      "154:  RLC_FINALLY {",
      "157:    ep2_free(t[i]);",
      "158:   }",
      "159:  }",
      "",
      "[Removed Lines]",
      "156:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "156:   for (int i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "168: void ep2_mul_basic(ep2_t r, const ep2_t p, const bn_t k) {",
      "170:  ep2_t t;",
      "172:  ep2_null(t);",
      "",
      "[Removed Lines]",
      "169:  int i, l;",
      "",
      "[Added Lines]",
      "169:  size_t l;",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "186:    ep2_set_infty(t);",
      "187:   }",
      "190:    ep2_dbl(t, t);",
      "191:    if (bn_get_bit(k, i)) {",
      "192:     ep2_add(t, t, p);",
      "",
      "[Removed Lines]",
      "189:   for (i = l - 2; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "189:   for (int i = l - 2; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "212: void ep2_mul_slide(ep2_t r, const ep2_t p, const bn_t k) {",
      "213:  ep2_t t[1 << (EP_WIDTH - 1)], q;",
      "215:  uint8_t win[RLC_FP_BITS + 1];",
      "217:  ep2_null(q);",
      "",
      "[Removed Lines]",
      "214:  int i, j, l;",
      "",
      "[Added Lines]",
      "215:  size_t l;",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "222:  }",
      "224:  RLC_TRY {",
      "226:    ep2_null(t[i]);",
      "227:    ep2_new(t[i]);",
      "228:   }",
      "",
      "[Removed Lines]",
      "225:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "225:   for (int i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "237: #endif",
      "241:    ep2_add(t[i], t[i - 1], q);",
      "242:   }",
      "",
      "[Removed Lines]",
      "240:   for (i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "240:   for (size_t i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "248:   ep2_set_infty(q);",
      "249:   l = RLC_FP_BITS + 1;",
      "250:   bn_rec_slw(win, &l, k, EP_WIDTH);",
      "252:    if (win[i] == 0) {",
      "253:     ep2_dbl(q, q);",
      "254:    } else {",
      "256:      ep2_dbl(q, q);",
      "257:     }",
      "258:     ep2_add(q, q, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "251:   for (i = 0; i < l; i++) {",
      "255:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "251:   for (size_t i = 0; i < l; i++) {",
      "255:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "268:   RLC_THROW(ERR_CAUGHT);",
      "269:  }",
      "270:  RLC_FINALLY {",
      "272:    ep2_free(t[i]);",
      "273:   }",
      "274:   ep2_free(q);",
      "",
      "[Removed Lines]",
      "271:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "271:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "387:  ep2_t t;",
      "388:  bn_t _k;",
      "389:  int8_t u, naf[RLC_DIG + 1];",
      "392:  ep2_null(t);",
      "393:  bn_null(_k);",
      "",
      "[Removed Lines]",
      "390:  int l;",
      "",
      "[Added Lines]",
      "390:  size_t l;",
      "",
      "---------------"
    ],
    "src/epx/relic_ep2_mul_fix.c||src/epx/relic_ep2_mul_fix.c": [
      "File: src/epx/relic_ep2_mul_fix.c -> src/epx/relic_ep2_mul_fix.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "49: static void ep2_mul_fix_plain(ep2_t r, const ep2_t *table, const bn_t k) {",
      "51:  int8_t naf[2 * RLC_FP_BITS + 1], *t;",
      "53:  if (bn_is_zero(k)) {",
      "54:   ep2_set_infty(r);",
      "",
      "[Removed Lines]",
      "50:  int len, i, n;",
      "",
      "[Added Lines]",
      "51:  size_t len;",
      "52:  int n;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "62:  t = naf + len - 1;",
      "63:  ep2_set_infty(r);",
      "65:   ep2_dbl(r, r);",
      "67:   n = *t;",
      "",
      "[Removed Lines]",
      "64:  for (i = len - 1; i >= 0; i--, t--) {",
      "",
      "[Added Lines]",
      "65:  for (int i = len - 1; i >= 0; i--, t--) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep2_mul_sim.c||src/epx/relic_ep2_mul_sim.c": [
      "File: src/epx/relic_ep2_mul_sim.c -> src/epx/relic_ep2_mul_sim.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55: static void ep2_mul_sim_endom(ep2_t r, const ep2_t p, const bn_t k, ep2_t q,",
      "56:   const bn_t m) {",
      "58:  bn_t _k[4], _m[4], n, u;",
      "59:  int8_t naf0[4][RLC_FP_BITS + 1];",
      "60:  int8_t naf1[4][RLC_FP_BITS + 1];",
      "",
      "[Removed Lines]",
      "57:  int i, j, l, _l[4];",
      "",
      "[Added Lines]",
      "57:  size_t l, _l[4];",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "66:  RLC_TRY {",
      "67:   bn_new(n);",
      "68:   bn_new(u);",
      "70:    bn_null(_k[i]);",
      "71:    bn_new(_k[i]);",
      "72:    bn_null(_m[i]);",
      "",
      "[Removed Lines]",
      "69:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "69:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "94:   bn_rec_frb(_m, 4, _m[0], u, n, ep_curve_is_pairf() == EP_BN);",
      "96:   l = 0;",
      "98:    _l[i] = RLC_FP_BITS + 1;",
      "99:    bn_rec_naf(naf0[i], &_l[i], _k[i], 2);",
      "100:    if (bn_sign(_k[i]) == RLC_NEG) {",
      "",
      "[Removed Lines]",
      "97:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "97:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "110:   }",
      "112:   ep2_set_infty(r);",
      "114:    ep2_dbl(r, r);",
      "116:     if (naf0[j][i] > 0) {",
      "117:      ep2_add(r, r, _p[j]);",
      "118:     }",
      "",
      "[Removed Lines]",
      "113:   for (i = l - 1; i >= 0; i--) {",
      "115:    for (j = 0; j < 4; j++) {",
      "",
      "[Added Lines]",
      "113:   for (int i = l - 1; i >= 0; i--) {",
      "115:    for (int j = 0; j < 4; j++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "135:  } RLC_FINALLY {",
      "136:   bn_free(n);",
      "137:   bn_free(u);",
      "139:    bn_free(_k[i]);",
      "140:    bn_free(_m[i]);",
      "141:    ep2_free(_p[i]);",
      "",
      "[Removed Lines]",
      "138:   for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "138:   for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "163: static void ep2_mul_sim_plain(ep2_t r, const ep2_t p, const bn_t k,",
      "164:   const ep2_t q, const bn_t m, const ep2_t *t) {",
      "166:  int8_t naf0[2 * RLC_FP_BITS + 1], naf1[2 * RLC_FP_BITS + 1], *_k, *_m;",
      "167:  ep2_t t0[1 << (EP_WIDTH - 2)];",
      "168:  ep2_t t1[1 << (EP_WIDTH - 2)];",
      "170:  RLC_TRY {",
      "171:   gen = (t == NULL ? 0 : 1);",
      "",
      "[Removed Lines]",
      "165:  int i, l, l0, l1, n0, n1, w, gen;",
      "",
      "[Added Lines]",
      "165:  int i, n0, n1, w, gen;",
      "169:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "289:  ep2_t t1[1 << (EP_WIDTH / 2)];",
      "290:  ep2_t t[1 << EP_WIDTH];",
      "291:  bn_t n, _k, _m;",
      "293:  uint8_t w0[2 * RLC_FP_BITS], w1[2 * RLC_FP_BITS];",
      "295:  bn_null(n);",
      "",
      "[Removed Lines]",
      "292:  int l0, l1, w = EP_WIDTH / 2;",
      "",
      "[Added Lines]",
      "293:  size_t l0, l1, w = EP_WIDTH / 2;",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "451:   const bn_t m) {",
      "452:  bn_t n, _k, _m;",
      "453:  ep2_t t[5];",
      "455:  int8_t jsf[2 * (RLC_FP_BITS + 1)];",
      "457:  if (bn_is_zero(k) || ep2_is_infty(p)) {",
      "458:   ep2_mul(r, q, m);",
      "",
      "[Removed Lines]",
      "454:  int i, l, u_i, offset;",
      "",
      "[Added Lines]",
      "455:  int i, u_i, offset;",
      "457:  size_t l;",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "601:  }",
      "602: }",
      "605:  ep2_t t;",
      "606:  int max;",
      "",
      "[Removed Lines]",
      "604: void ep2_mul_sim_dig(ep2_t r, const ep2_t p[], const dig_t k[], int len) {",
      "",
      "[Added Lines]",
      "606: void ep2_mul_sim_dig(ep2_t r, const ep2_t p[], const dig_t k[], size_t len) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "635:  }",
      "636: }",
      "641:  bn_t _k[4], q, x;",
      "642:  int8_t ptr, *naf = RLC_ALLOCA(int8_t, 4 * n * len);",
      "644:  if (n == 0) {",
      "645:   ep2_set_infty(r);",
      "",
      "[Removed Lines]",
      "638: void ep2_mul_sim_lot(ep2_t r, const ep2_t p[], const bn_t k[], int n) {",
      "639:  const int len = RLC_FP_BITS + 1;",
      "640:  int i, j, m, l, _l[4];",
      "",
      "[Added Lines]",
      "640: void ep2_mul_sim_lot(ep2_t r, const ep2_t p[], const bn_t k[], size_t n) {",
      "641:  const size_t len = RLC_FP_BITS + 1;",
      "642:  int i, j, m;",
      "645:  size_t l, _l[4];",
      "",
      "---------------"
    ],
    "src/epx/relic_ep2_util.c||src/epx/relic_ep2_util.c": [
      "File: src/epx/relic_ep2_util.c -> src/epx/relic_ep2_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "243:  return size;",
      "244: }",
      "247:  if (len == 1) {",
      "248:   if (bin[0] == 0) {",
      "249:    ep2_set_infty(a);",
      "",
      "[Removed Lines]",
      "246: void ep2_read_bin(ep2_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "246: void ep2_read_bin(ep2_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "293:  }",
      "294: }",
      "297:  ep2_t t;",
      "299:  ep2_null(t);",
      "",
      "[Removed Lines]",
      "296: void ep2_write_bin(uint8_t *bin, int len, const ep2_t a, int pack) {",
      "",
      "[Added Lines]",
      "296: void ep2_write_bin(uint8_t *bin, size_t len, const ep2_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep4_map.c||src/epx/relic_ep4_map.c": [
      "File: src/epx/relic_ep4_map.c -> src/epx/relic_ep4_map.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41:  bn_t x;",
      "42:  fp4_t t0;",
      "43:  uint8_t digest[RLC_MD_LEN];",
      "",
      "[Removed Lines]",
      "40: void ep4_map(ep4_t p, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "40: void ep4_map(ep4_t p, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep4_mul.c||src/epx/relic_ep4_mul.c": [
      "File: src/epx/relic_ep4_mul.c -> src/epx/relic_ep4_mul.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if defined(EP_ENDOM)",
      "43: static void ep4_mul_glv_imp(ep4_t r, const ep4_t p, const bn_t k) {",
      "45:  bn_t n, _k[8], u, v;",
      "46:  int8_t naf[8][RLC_FP_BITS + 1];",
      "47:  ep4_t q[8];",
      "49:  bn_null(n);",
      "50:  bn_null(u);",
      "",
      "[Removed Lines]",
      "44:  int sign, i, j, l, _l[8];",
      "",
      "[Added Lines]",
      "44:  int sign, i, j;",
      "48:  size_t l, _l[8];",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "133: static void ep4_mul_naf_imp(ep4_t r, const ep4_t p, const bn_t k) {",
      "135:  int8_t naf[RLC_FP_BITS + 1];",
      "136:  ep4_t t[1 << (EP_WIDTH - 2)];",
      "138:  RLC_TRY {",
      "",
      "[Removed Lines]",
      "134:  int l, i, n;",
      "",
      "[Added Lines]",
      "135:  int i, n;",
      "138:  size_t l;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "230: void ep4_mul_slide(ep4_t r, const ep4_t p, const bn_t k) {",
      "231:  ep4_t t[1 << (EP_WIDTH - 1)], q;",
      "233:  uint8_t win[RLC_FP_BITS + 1];",
      "235:  ep4_null(q);",
      "",
      "[Removed Lines]",
      "232:  int i, j, l;",
      "",
      "[Added Lines]",
      "235:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "240:  }",
      "242:  RLC_TRY {",
      "244:    ep4_null(t[i]);",
      "245:    ep4_new(t[i]);",
      "246:   }",
      "",
      "[Removed Lines]",
      "243:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "245:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "255: #endif",
      "259:    ep4_add(t[i], t[i - 1], q);",
      "260:   }",
      "",
      "[Removed Lines]",
      "258:   for (i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "260:   for (size_t i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "266:   ep4_set_infty(q);",
      "267:   l = RLC_FP_BITS + 1;",
      "268:   bn_rec_slw(win, &l, k, EP_WIDTH);",
      "270:    if (win[i] == 0) {",
      "271:     ep4_dbl(q, q);",
      "272:    } else {",
      "274:      ep4_dbl(q, q);",
      "275:     }",
      "276:     ep4_add(q, q, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "269:   for (i = 0; i < l; i++) {",
      "273:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "271:   for (size_t i = 0; i < l; i++) {",
      "275:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "286:   RLC_THROW(ERR_CAUGHT);",
      "287:  }",
      "288:  RLC_FINALLY {",
      "290:    ep4_free(t[i]);",
      "291:   }",
      "292:   ep4_free(q);",
      "",
      "[Removed Lines]",
      "289:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "291:   for (size_t i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep4_mul_fix.c||src/epx/relic_ep4_mul_fix.c": [
      "File: src/epx/relic_ep4_mul_fix.c -> src/epx/relic_ep4_mul_fix.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "47: static void ep4_mul_pre_ordin(ep4_t *t, const ep4_t p) {",
      "50:  ep4_dbl(t[0], p);",
      "51: #if defined(EP_MIXED)",
      "52:  ep4_norm(t[0], t[0]);",
      "",
      "[Removed Lines]",
      "48:  int i;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "55: #if EP_DEPTH > 2",
      "56:  ep4_add(t[1], t[0], p);",
      "58:   ep4_add(t[i], t[i - 1], t[0]);",
      "59:  }",
      "61: #if defined(EP_MIXED)",
      "63:   ep4_norm(t[i], t[i]);",
      "64:  }",
      "65: #endif",
      "",
      "[Removed Lines]",
      "57:  for (i = 2; i < (1 << (EP_DEPTH - 2)); i++) {",
      "62:  for (i = 1; i < (1 << (EP_DEPTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "55:  for (int i = 2; i < (1 << (EP_DEPTH - 2)); i++) {",
      "60:  for (int i = 1; i < (1 << (EP_DEPTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "79: static void ep4_mul_fix_ordin(ep4_t r, const ep4_t *table, const bn_t k) {",
      "81:  int8_t naf[2 * RLC_FP_BITS + 1], *t;",
      "83:  if (bn_is_zero(k)) {",
      "84:   ep4_set_infty(r);",
      "",
      "[Removed Lines]",
      "80:  int len, i, n;",
      "",
      "[Added Lines]",
      "79:  size_t len;",
      "80:  int n;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "92:  t = naf + len - 1;",
      "93:  ep4_set_infty(r);",
      "95:   ep4_dbl(r, r);",
      "97:   n = *t;",
      "",
      "[Removed Lines]",
      "94:  for (i = len - 1; i >= 0; i--, t--) {",
      "",
      "[Added Lines]",
      "93:  for (int i = len - 1; i >= 0; i--, t--) {",
      "",
      "---------------"
    ],
    "src/epx/relic_ep4_mul_sim.c||src/epx/relic_ep4_mul_sim.c": [
      "File: src/epx/relic_ep4_mul_sim.c -> src/epx/relic_ep4_mul_sim.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53: static void ep4_mul_sim_plain(ep4_t r, const ep4_t p, const bn_t k,",
      "54:   const ep4_t q, const bn_t m, ep4_t *t) {",
      "56:  int8_t naf0[2 * RLC_FP_BITS + 1], naf1[2 * RLC_FP_BITS + 1], *_k, *_m;",
      "57:  ep4_t t0[1 << (EP_WIDTH - 2)];",
      "58:  ep4_t t1[1 << (EP_WIDTH - 2)];",
      "60:  RLC_TRY {",
      "61:   gen = (t == NULL ? 0 : 1);",
      "",
      "[Removed Lines]",
      "55:  int i, l, l0, l1, n0, n1, w, gen;",
      "",
      "[Added Lines]",
      "55:  int i, n0, n1, w, gen;",
      "59:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "177:  ep4_t t1[1 << (EP_WIDTH / 2)];",
      "178:  ep4_t t[1 << EP_WIDTH];",
      "179:  bn_t n;",
      "181:  uint8_t w0[2 * RLC_FP_BITS], w1[2 * RLC_FP_BITS];",
      "183:  bn_null(n);",
      "",
      "[Removed Lines]",
      "180:  int l0, l1, w = EP_WIDTH / 2;",
      "",
      "[Added Lines]",
      "181:  size_t l0, l1, w = EP_WIDTH / 2;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "293: void ep4_mul_sim_joint(ep4_t r, const ep4_t p, const bn_t k, const ep4_t q,",
      "294:   const bn_t m) {",
      "295:  ep4_t t[5];",
      "297:  int8_t jsf[4 * (RLC_FP_BITS + 1)];",
      "299:  if (bn_is_zero(k) || ep4_is_infty(p)) {",
      "300:   ep4_mul(r, q, m);",
      "",
      "[Removed Lines]",
      "296:  int i, l, u_i, offset;",
      "",
      "[Added Lines]",
      "297:  int i, u_i, offset;",
      "299:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "396:  }",
      "397: }",
      "400:  ep4_t t;",
      "401:  int max;",
      "",
      "[Removed Lines]",
      "399: void ep4_mul_sim_dig(ep4_t r, const ep4_t p[], const dig_t k[], int len) {",
      "",
      "[Added Lines]",
      "401: void ep4_mul_sim_dig(ep4_t r, const ep4_t p[], const dig_t k[], size_t len) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "430:  }",
      "431: }",
      "436:  bn_t _k[8], q, x;",
      "437:  int8_t *naf = RLC_ALLOCA(int8_t, 8 * n * len);",
      "439:  bn_null(q);",
      "440:  bn_null(x);",
      "",
      "[Removed Lines]",
      "433: void ep4_mul_sim_lot(ep4_t r, const ep4_t p[], const bn_t k[], int n) {",
      "434:  const int len = RLC_FP_BITS + 1;",
      "435:  int i, j, m, l, *_l = RLC_ALLOCA(int, 8 * n);",
      "",
      "[Added Lines]",
      "435: void ep4_mul_sim_lot(ep4_t r, const ep4_t p[], const bn_t k[], size_t n) {",
      "436:  const size_t len = RLC_FP_BITS + 1;",
      "437:  int i, j, m;",
      "440:  size_t l, *_l = RLC_ALLOCA(size_t, 8 * n);",
      "",
      "---------------"
    ],
    "src/epx/relic_ep4_util.c||src/epx/relic_ep4_util.c": [
      "File: src/epx/relic_ep4_util.c -> src/epx/relic_ep4_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "254:  return size;",
      "255: }",
      "258:  if (len == 1) {",
      "259:   if (bin[0] == 0) {",
      "260:    ep4_set_infty(a);",
      "",
      "[Removed Lines]",
      "257: void ep4_read_bin(ep4_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "257: void ep4_read_bin(ep4_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "288:  }",
      "289: }",
      "292:  ep4_t t;",
      "294:  ep4_null(t);",
      "",
      "[Removed Lines]",
      "291: void ep4_write_bin(uint8_t *bin, int len, const ep4_t a, int pack) {",
      "",
      "[Added Lines]",
      "291: void ep4_write_bin(uint8_t *bin, size_t len, const ep4_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/fb/relic_fb_exp.c||src/fb/relic_fb_exp.c": [
      "File: src/fb/relic_fb_exp.c -> src/fb/relic_fb_exp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "44: #if FB_EXP == BASIC || !defined(STRIP)",
      "46: void fb_exp_basic(fb_t c, const fb_t a, const bn_t b) {",
      "48:  fb_t r;",
      "50:  if (bn_is_zero(b)) {",
      "",
      "[Removed Lines]",
      "47:  int i, l;",
      "",
      "[Added Lines]",
      "47:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "62:   fb_copy(r, a);",
      "65:    fb_sqr(r, r);",
      "66:    if (bn_get_bit(b, i)) {",
      "67:     fb_mul(r, r, a);",
      "",
      "[Removed Lines]",
      "64:   for (i = l - 2; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "64:   for (int i = l - 2; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "89: void fb_exp_slide(fb_t c, const fb_t a, const bn_t b) {",
      "90:  fb_t t[1 << (FB_WIDTH - 1)], r;",
      "92:  uint8_t win[RLC_FB_BITS + 1];",
      "94:  fb_null(r);",
      "",
      "[Removed Lines]",
      "91:  int i, j, l;",
      "",
      "[Added Lines]",
      "92:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "104:   fb_null(t[i]);",
      "105:  }",
      "107:  RLC_TRY {",
      "109:    fb_new(t[i]);",
      "110:   }",
      "111:   fb_new(r);",
      "",
      "[Removed Lines]",
      "103:  for (i = 0; i < (1 << (FB_WIDTH - 1)); i++) {",
      "108:   for (i = 0; i < (1 << (FB_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "103:  for (size_t i = 0; i < (1 << (FB_WIDTH - 1)); i++) {",
      "108:   for (size_t i = 0; i < (1 << (FB_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "114:   fb_sqr(r, a);",
      "118:    fb_mul(t[i], t[i - 1], r);",
      "119:   }",
      "121:   fb_set_dig(r, 1);",
      "122:   l = RLC_FB_BITS + 1;",
      "123:   bn_rec_slw(win, &l, b, FB_WIDTH);",
      "125:    if (win[i] == 0) {",
      "126:     fb_sqr(r, r);",
      "127:    } else {",
      "129:      fb_sqr(r, r);",
      "130:     }",
      "131:     fb_mul(r, r, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "117:   for (i = 1; i < 1 << (FB_WIDTH - 1); i++) {",
      "124:   for (i = 0; i < l; i++) {",
      "128:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "117:   for (size_t i = 1; i < 1 << (FB_WIDTH - 1); i++) {",
      "124:   for (size_t i = 0; i < l; i++) {",
      "128:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "142:   RLC_THROW(ERR_CAUGHT);",
      "143:  }",
      "144:  RLC_FINALLY {",
      "146:    fb_free(t[i]);",
      "147:   }",
      "148:   fb_free(r);",
      "",
      "[Removed Lines]",
      "145:   for (i = 0; i < (1 << (FB_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "145:   for (size_t i = 0; i < (1 << (FB_WIDTH - 1)); i++) {",
      "",
      "---------------"
    ],
    "src/fb/relic_fb_util.c||src/fb/relic_fb_util.c": [
      "File: src/fb/relic_fb_util.c -> src/fb/relic_fb_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "49:  while (radix > 0) {",
      "50:   if (radix != 1 && radix % 2 == 1)",
      "51:    return 0;",
      "",
      "[Removed Lines]",
      "48: static int valid_radix(int radix) {",
      "",
      "[Added Lines]",
      "48: static int valid_radix(unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "64:  int l = 0;",
      "66:  while (radix > 0) {",
      "",
      "[Removed Lines]",
      "63: static int log_radix(int radix) {",
      "",
      "[Added Lines]",
      "63: static int log_radix(unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "93:  return !t;",
      "94: }",
      "97:  int d;",
      "99:  RLC_RIP(bit, d, bit);",
      "",
      "[Removed Lines]",
      "96: int fb_get_bit(const fb_t a, int bit) {",
      "",
      "[Added Lines]",
      "96: int fb_get_bit(const fb_t a, size_t bit) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "101:  return (a[d] >> bit) & 1;",
      "102: }",
      "105:  int d;",
      "106:  dig_t mask;",
      "",
      "[Removed Lines]",
      "104: void fb_set_bit(fb_t a, int bit, int value) {",
      "",
      "[Added Lines]",
      "104: void fb_set_bit(fb_t a, size_t bit, int value) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "116:  }",
      "117: }",
      "120:  int i = RLC_FB_DIGS - 1;",
      "122:  while (i >= 0 && a[i] == 0) {",
      "",
      "[Removed Lines]",
      "119: int fb_bits(const fb_t a) {",
      "",
      "[Added Lines]",
      "119: size_t fb_bits(const fb_t a) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "136: }",
      "138: void fb_rand(fb_t a) {",
      "141:  rand_bytes((uint8_t *)a, RLC_FB_DIGS * sizeof(dig_t));",
      "",
      "[Removed Lines]",
      "139:  int bits, digits;",
      "",
      "[Added Lines]",
      "139:  size_t bits, digits;",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "148: }",
      "150: void fb_print(const fb_t a) {",
      "154:  (void)a;",
      "156:   util_print_dig(a[i], 1);",
      "157:   util_print(\" \");",
      "158:  }",
      "",
      "[Removed Lines]",
      "151:  int i;",
      "155:  for (i = RLC_FB_DIGS - 1; i > 0; i--) {",
      "",
      "[Added Lines]",
      "153:  for (int i = RLC_FB_DIGS - 1; i > 0; i--) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "160:  util_print(\"\\n\");",
      "161: }",
      "164:  bn_t t;",
      "167:  bn_null(t);",
      "",
      "[Removed Lines]",
      "163: int fb_size_str(const fb_t a, int radix) {",
      "165:  int digits = 0;",
      "",
      "[Added Lines]",
      "161: size_t fb_size_str(const fb_t a, unsigned int radix) {",
      "163:  size_t digits = 0;",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "188:  return digits;",
      "189: }",
      "192:  bn_t t;",
      "194:  bn_null(t);",
      "",
      "[Removed Lines]",
      "191: void fb_read_str(fb_t a, const char *str, int len, int radix) {",
      "",
      "[Added Lines]",
      "189: void fb_read_str(fb_t a, const char *str, size_t len, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "217:  }",
      "218: }",
      "221:  fb_t t;",
      "222:  int d, l, i, j;",
      "223:  char c;",
      "",
      "[Removed Lines]",
      "220: void fb_write_str(char *str, int len, const fb_t a, int radix) {",
      "",
      "[Added Lines]",
      "218: void fb_write_str(char *str, size_t len, const fb_t a, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "276:  }",
      "277: }",
      "280:  bn_t t;",
      "282:  bn_null(t);",
      "",
      "[Removed Lines]",
      "279: void fb_read_bin(fb_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "277: void fb_read_bin(fb_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "301:  }",
      "302: }",
      "305:  bn_t t;",
      "307:  bn_null(t);",
      "",
      "[Removed Lines]",
      "304: void fb_write_bin(uint8_t *bin, int len, const fb_t a) {",
      "",
      "[Added Lines]",
      "302: void fb_write_bin(uint8_t *bin, size_t len, const fb_t a) {",
      "",
      "---------------"
    ],
    "src/fp/relic_fp_exp.c||src/fp/relic_fp_exp.c": [
      "File: src/fp/relic_fp_exp.c -> src/fp/relic_fp_exp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "39: #if FP_EXP == BASIC || !defined(STRIP)",
      "41: void fp_exp_basic(fp_t c, const fp_t a, const bn_t b) {",
      "43:  fp_t r;",
      "45:  fp_null(r);",
      "",
      "[Removed Lines]",
      "42:  int i, l;",
      "",
      "[Added Lines]",
      "42:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "57:   fp_copy(r, a);",
      "60:    fp_sqr(r, r);",
      "61:    if (bn_get_bit(b, i)) {",
      "62:     fp_mul(r, r, a);",
      "",
      "[Removed Lines]",
      "59:   for (i = l - 2; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "59:   for (int i = l - 2; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "84: void fp_exp_slide(fp_t c, const fp_t a, const bn_t b) {",
      "85:  fp_t t[1 << (FP_WIDTH - 1)], r;",
      "87:  uint8_t win[RLC_FP_BITS + 1];",
      "89:  fp_null(r);",
      "",
      "[Removed Lines]",
      "86:  int i, j, l;",
      "",
      "[Added Lines]",
      "87:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "99:   fp_null(t[i]);",
      "100:  }",
      "102:  RLC_TRY {",
      "104:    fp_new(t[i]);",
      "105:   }",
      "106:   fp_new(r);",
      "",
      "[Removed Lines]",
      "98:  for (i = 0; i < (1 << (FP_WIDTH - 1)); i++) {",
      "103:   for (i = 0; i < (1 << (FP_WIDTH - 1)); i ++) {",
      "",
      "[Added Lines]",
      "98:  for (size_t i = 0; i < (1 << (FP_WIDTH - 1)); i++) {",
      "103:   for (size_t i = 0; i < (1 << (FP_WIDTH - 1)); i ++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "109:   fp_sqr(r, a);",
      "113:    fp_mul(t[i], t[i - 1], r);",
      "114:   }",
      "116:   fp_set_dig(r, 1);",
      "117:   l = RLC_FP_BITS + 1;",
      "118:   bn_rec_slw(win, &l, b, FP_WIDTH);",
      "120:    if (win[i] == 0) {",
      "121:     fp_sqr(r, r);",
      "122:    } else {",
      "124:      fp_sqr(r, r);",
      "125:     }",
      "126:     fp_mul(r, r, t[win[i] >> 1]);",
      "",
      "[Removed Lines]",
      "112:   for (i = 1; i < 1 << (FP_WIDTH - 1); i++) {",
      "119:   for (i = 0; i < l; i++) {",
      "123:     for (j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "[Added Lines]",
      "112:   for (size_t i = 1; i < 1 << (FP_WIDTH - 1); i++) {",
      "119:   for (size_t i = 0; i < l; i++) {",
      "123:     for (size_t j = 0; j < util_bits_dig(win[i]); j++) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "137:   RLC_THROW(ERR_CAUGHT);",
      "138:  }",
      "139:  RLC_FINALLY {",
      "141:    fp_free(t[i]);",
      "142:   }",
      "143:   fp_free(r);",
      "",
      "[Removed Lines]",
      "140:   for (i = 0; i < (1 << (FP_WIDTH - 1)); i++) {",
      "",
      "[Added Lines]",
      "140:   for (size_t i = 0; i < (1 << (FP_WIDTH - 1)); i++) {",
      "",
      "---------------"
    ],
    "src/fp/relic_fp_prime.c||src/fp/relic_fp_prime.c": [
      "File: src/fp/relic_fp_prime.c -> src/fp/relic_fp_prime.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "296: void fp_prime_set_pairf(const bn_t x, int pairf) {",
      "297:  bn_t p, t0, t1;",
      "298:  ctx_t *ctx = core_get();",
      "300:  int8_t s[RLC_FP_BITS + 1];",
      "302:  bn_null(p);",
      "",
      "[Removed Lines]",
      "299:  int len = bn_bits(x) + 1;",
      "",
      "[Added Lines]",
      "299:  size_t len = bn_bits(x) + 1;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "459:  }",
      "460: }",
      "463:  bn_t p, t;",
      "465:  bn_null(p);",
      "",
      "[Removed Lines]",
      "462: void fp_prime_set_pmers(const int *f, int len) {",
      "",
      "[Added Lines]",
      "462: void fp_prime_set_pmers(const int *f, size_t len) {",
      "",
      "---------------"
    ],
    "src/fp/relic_fp_util.c||src/fp/relic_fp_util.c": [
      "File: src/fp/relic_fp_util.c -> src/fp/relic_fp_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "62:  return 0;",
      "63: }",
      "66:  int d;",
      "68:  RLC_RIP(bit, d, bit);",
      "",
      "[Removed Lines]",
      "65: int fp_get_bit(const fp_t a, int bit) {",
      "",
      "[Added Lines]",
      "65: int fp_get_bit(const fp_t a, size_t bit) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "70:  return (a[d] >> bit) & 1;",
      "71: }",
      "74:  int d;",
      "75:  dig_t mask;",
      "",
      "[Removed Lines]",
      "73: void fp_set_bit(fp_t a, int bit, int value) {",
      "",
      "[Added Lines]",
      "73: void fp_set_bit(fp_t a, size_t bit, int value) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "85:  }",
      "86: }",
      "89:  int i = RLC_FP_DIGS - 1;",
      "91:  while (i >= 0 && a[i] == 0) {",
      "",
      "[Removed Lines]",
      "88: int fp_bits(const fp_t a) {",
      "",
      "[Added Lines]",
      "88: size_t fp_bits(const fp_t a) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "157:  }",
      "158: }",
      "161:  bn_t t;",
      "164:  bn_null(t);",
      "",
      "[Removed Lines]",
      "160: int fp_size_str(const fp_t a, int radix) {",
      "162:  int digits = 0;",
      "",
      "[Added Lines]",
      "160: size_t fp_size_str(const fp_t a, unsigned int radix) {",
      "162:  size_t digits = 0;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "179:  return digits;",
      "180: }",
      "183:  bn_t t;",
      "185:  bn_null(t);",
      "",
      "[Removed Lines]",
      "182: void fp_read_str(fp_t a, const char *str, int len, int radix) {",
      "",
      "[Added Lines]",
      "182: void fp_read_str(fp_t a, const char *str, size_t len, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "208:  }",
      "209: }",
      "212:  bn_t t;",
      "214:  bn_null(t);",
      "",
      "[Removed Lines]",
      "211: void fp_write_str(char *str, int len, const fp_t a, int radix) {",
      "",
      "[Added Lines]",
      "211: void fp_write_str(char *str, size_t len, const fp_t a, unsigned int radix) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "227:  }",
      "228: }",
      "231:  bn_t t;",
      "233:  bn_null(t);",
      "",
      "[Removed Lines]",
      "230: void fp_read_bin(fp_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "230: void fp_read_bin(fp_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "253:     } else {",
      "254:      fp_prime_conv(a, t);",
      "255:     }",
      "257:   }",
      "258:  }",
      "259:  RLC_CATCH_ANY {",
      "",
      "[Removed Lines]",
      "256:    }",
      "",
      "[Added Lines]",
      "256:    }",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "264:  }",
      "265: }",
      "268:  bn_t t;",
      "270:  bn_null(t);",
      "",
      "[Removed Lines]",
      "267: void fp_write_bin(uint8_t *bin, int len, const fp_t a) {",
      "",
      "[Added Lines]",
      "267: void fp_write_bin(uint8_t *bin, size_t len, const fp_t a) {",
      "",
      "---------------"
    ],
    "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c": [
      "File: src/fpx/relic_fpx_cyc.c -> src/fpx/relic_fpx_cyc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "84: void fp2_exp_cyc(fp2_t c, const fp2_t a, const bn_t b) {",
      "85:  fp2_t r, s, t[1 << (FP_WIDTH - 2)];",
      "87:  int8_t naf[RLC_FP_BITS + 1], *k;",
      "89:  if (bn_is_zero(b)) {",
      "90:   return fp2_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "86:  int i, l;",
      "",
      "[Added Lines]",
      "87:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "96:  RLC_TRY {",
      "97:   fp2_new(r);",
      "98:   fp2_new(s);",
      "100:    fp2_null(t[i]);",
      "101:    fp2_new(t[i]);",
      "102:   }",
      "",
      "[Removed Lines]",
      "99:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "[Added Lines]",
      "99:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "117:   k = naf + l - 1;",
      "120:    fp2_sqr(r, r);",
      "122:    if (*k > 0) {",
      "",
      "[Removed Lines]",
      "119:   for (i = l - 1; i >= 0; i--, k--) {",
      "",
      "[Added Lines]",
      "119:   for (int i = l - 1; i >= 0; i--, k--) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "140:  RLC_FINALLY {",
      "141:   fp2_free(r);",
      "142:   fp2_free(s);",
      "144:    fp2_free(t[i]);",
      "145:   }",
      "146:  }",
      "",
      "[Removed Lines]",
      "143:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "143:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "194: void fp8_exp_cyc(fp8_t c, const fp8_t a, const bn_t b) {",
      "195:  fp8_t r, s, t[1 << (FP_WIDTH - 2)];",
      "197:  int8_t naf[RLC_FP_BITS + 1], *k;",
      "199:  if (bn_is_zero(b)) {",
      "200:   return fp8_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "196:  int i, l;",
      "",
      "[Added Lines]",
      "197:  size_t l;",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "206:  RLC_TRY {",
      "207:   fp8_new(r);",
      "208:   fp8_new(s);",
      "210:    fp8_null(t[i]);",
      "211:    fp8_new(t[i]);",
      "212:   }",
      "",
      "[Removed Lines]",
      "209:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "[Added Lines]",
      "209:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "227:   k = naf + l - 1;",
      "230:    fp8_sqr_cyc(r, r);",
      "232:    if (*k > 0) {",
      "",
      "[Removed Lines]",
      "229:   for (i = l - 1; i >= 0; i--, k--) {",
      "",
      "[Added Lines]",
      "229:   for (int i = l - 1; i >= 0; i--, k--) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "250:  RLC_FINALLY {",
      "251:   fp8_free(r);",
      "252:   fp8_free(s);",
      "254:    fp8_free(t[i]);",
      "255:   }",
      "256:  }",
      "",
      "[Removed Lines]",
      "253:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "253:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "470: }",
      "472: void fp12_exp_cyc(fp12_t c, const fp12_t a, const bn_t b) {",
      "475:  if (bn_is_zero(b)) {",
      "476:   return fp12_set_dig(c, 1);",
      "477:  }",
      "479:  if ((bn_bits(b) > RLC_DIG) && ((w << 3) > bn_bits(b))) {",
      "481:   int8_t naf[4][RLC_FP_BITS + 1];",
      "482:   fp12_t t[4];",
      "483:   bn_t _b[4], n, u;",
      "",
      "[Removed Lines]",
      "473:  int i, j, k, l, w = bn_ham(b);",
      "480:   int _l[4];",
      "",
      "[Added Lines]",
      "473:  size_t j, k, l, w = bn_ham(b);",
      "480:   size_t _l[4];",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "488:   RLC_TRY {",
      "489:    bn_new(n);",
      "490:    bn_new(u);",
      "492:     bn_null(_b[i]);",
      "493:     bn_new(_b[i]);",
      "494:     fp12_null(t[i]);",
      "",
      "[Removed Lines]",
      "491:    for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "491:    for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "506:     fp12_frb(t[3], t[2], 1);",
      "508:     l = 0;",
      "510:      if (bn_sign(_b[i]) == RLC_NEG) {",
      "511:       fp12_inv_cyc(t[i], t[i]);",
      "512:      }",
      "",
      "[Removed Lines]",
      "509:     for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "509:     for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "516:     }",
      "518:     fp12_set_dig(c, 1);",
      "520:      fp12_sqr_cyc(c, c);",
      "522:       if (naf[j][i] > 0) {",
      "523:        fp12_mul(c, c, t[j]);",
      "524:       }",
      "",
      "[Removed Lines]",
      "519:     for (i = l - 1; i >= 0; i--) {",
      "521:      for (j = 0; j < 4; j++) {",
      "",
      "[Added Lines]",
      "519:     for (int i = l - 1; i >= 0; i--) {",
      "521:      for (int j = 0; j < 4; j++) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "532:    } else {",
      "533:     fp12_copy(t[0], a);",
      "536:      fp12_sqr_cyc(t[0], t[0]);",
      "537:      if (bn_get_bit(b, i)) {",
      "538:       fp12_mul(t[0], t[0], a);",
      "",
      "[Removed Lines]",
      "535:     for (i = bn_bits(b) - 2; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "535:     for (int i = bn_bits(b) - 2; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "551:   RLC_FINALLY {",
      "552:    bn_free(n);",
      "553:    bn_free(u);",
      "555:     bn_free(_b[i]);",
      "556:     fp12_free(t[i]);",
      "557:    }",
      "",
      "[Removed Lines]",
      "554:    for (i = 0; i < 4; i++) {",
      "",
      "[Added Lines]",
      "554:    for (int i = 0; i < 4; i++) {",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "565:    if (u == NULL) {",
      "566:     RLC_THROW(ERR_NO_MEMORY);",
      "567:    }",
      "569:     fp12_null(u[i]);",
      "570:     fp12_new(u[i]);",
      "571:    }",
      "",
      "[Removed Lines]",
      "568:    for (i = 0; i < w; i++) {",
      "",
      "[Added Lines]",
      "568:    for (int i = 0; i < w; i++) {",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "574:    j = 0;",
      "575:    fp12_copy(t, a);",
      "577:     fp12_sqr_pck(t, t);",
      "578:     if (bn_get_bit(b, i)) {",
      "579:      fp12_copy(u[j++], t);",
      "",
      "[Removed Lines]",
      "576:    for (i = 1; i < bn_bits(b); i++) {",
      "",
      "[Added Lines]",
      "576:    for (size_t i = 1; i < bn_bits(b); i++) {",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "596:     fp12_copy(c, u[0]);",
      "597:    }",
      "600:     fp12_mul(c, c, u[i]);",
      "601:    }",
      "",
      "[Removed Lines]",
      "599:    for (i = j; i < k; i++) {",
      "",
      "[Added Lines]",
      "599:    for (size_t i = j; i < k; i++) {",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "608:    RLC_THROW(ERR_CAUGHT);",
      "609:   }",
      "610:   RLC_FINALLY {",
      "612:     fp12_free(u[i]);",
      "613:    }",
      "614:    fp12_free(t);",
      "",
      "[Removed Lines]",
      "611:    for (i = 0; i < w; i++) {",
      "",
      "[Added Lines]",
      "611:    for (size_t i = 0; i < w; i++) {",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "618: }",
      "620: void fp2_exp_cyc_sim(fp2_t e, const fp2_t a, const bn_t b, const fp2_t c, const bn_t d) {",
      "622:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *_k, *_m;",
      "623:  fp2_t r, t0[1 << (EP_WIDTH - 2)];",
      "624:  fp2_t s, t1[1 << (EP_WIDTH - 2)];",
      "626:  if (bn_is_zero(b)) {",
      "627:   return fp2_exp_cyc(e, c, d);",
      "",
      "[Removed Lines]",
      "621:  int i, l, n0, n1, l0, l1;",
      "",
      "[Added Lines]",
      "621:  int n0, n1;",
      "625:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "637:  RLC_TRY {",
      "638:   fp2_new(r);",
      "639:   fp2_new(s);",
      "641:    fp2_null(t0[i]);",
      "642:    fp2_null(t1[i]);",
      "643:    fp2_new(t0[i]);",
      "",
      "[Removed Lines]",
      "640:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "[Added Lines]",
      "641:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "667:   l = RLC_MAX(l0, l1);",
      "668:   if (bn_sign(b) == RLC_NEG) {",
      "670:     naf0[i] = -naf0[i];",
      "671:    }",
      "672:   }",
      "673:   if (bn_sign(d) == RLC_NEG) {",
      "675:     naf1[i] = -naf1[i];",
      "676:    }",
      "677:   }",
      "",
      "[Removed Lines]",
      "669:    for (i = 0; i < l0; i++) {",
      "674:    for (i = 0; i < l1; i++) {",
      "",
      "[Added Lines]",
      "670:    for (size_t i = 0; i < l0; i++) {",
      "675:    for (size_t i = 0; i < l1; i++) {",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "680:   _m = naf1 + l - 1;",
      "682:   fp2_set_dig(r, 1);",
      "684:    fp2_sqr(r, r);",
      "686:    n0 = *_k;",
      "",
      "[Removed Lines]",
      "683:   for (i = l - 1; i >= 0; i--, _k--, _m--) {",
      "",
      "[Added Lines]",
      "684:   for (int i = l - 1; i >= 0; i--, _k--, _m--) {",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "710:  RLC_FINALLY {",
      "711:   fp2_free(r);",
      "712:   fp2_free(s);",
      "714:    fp2_free(t0[i]);",
      "715:    fp2_free(t1[i]);",
      "716:   }",
      "",
      "[Removed Lines]",
      "713:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "[Added Lines]",
      "714:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "820:  }",
      "821: }",
      "825:     fp12_t t, *u = RLC_ALLOCA(fp12_t, w);",
      "827:  if (len == 0) {",
      "",
      "[Removed Lines]",
      "823: void fp12_exp_cyc_sps(fp12_t c, const fp12_t a, const int *b, int len, int sign) {",
      "824:  int i, j, k, w = len;",
      "",
      "[Added Lines]",
      "824: void fp12_exp_cyc_sps(fp12_t c, const fp12_t a, const int *b, size_t len,",
      "825:   int sign) {",
      "826:  size_t i, j, k, w = len;",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1097: }",
      "1099: void fp24_exp_cyc(fp24_t c, const fp24_t a, const bn_t b) {",
      "1102:  if (bn_is_zero(b)) {",
      "1103:   fp24_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "1100:  int i, j, k, w = bn_ham(b);",
      "",
      "[Added Lines]",
      "1102:  size_t j, k, w = bn_ham(b);",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "1105:  }",
      "1107:  if ((bn_bits(b) > RLC_DIG) && ((w << 3) > bn_bits(b))) {",
      "1109:   int8_t naf[8][RLC_FP_BITS + 1];",
      "1110:   fp24_t t[8];",
      "1111:   bn_t _b[8], n, x;",
      "",
      "[Removed Lines]",
      "1108:   int l, _l[8];",
      "",
      "[Added Lines]",
      "1110:   size_t l, _l[8];",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "1116:   RLC_TRY {",
      "1117:    bn_new(n);",
      "1118:    bn_new(x);",
      "1120:     bn_null(_b[i]);",
      "1121:     bn_new(_b[i]);",
      "1122:     fp24_null(t[i]);",
      "",
      "[Removed Lines]",
      "1119:    for (i = 0; i < 8; i++) {",
      "",
      "[Added Lines]",
      "1121:    for (int i = 0; i < 8; i++) {",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "1131:     l = 0;",
      "1133:     fp24_copy(t[0], a);",
      "1135:      _l[i] = RLC_FP_BITS + 1;",
      "1136:      bn_rec_naf(naf[i], &_l[i], _b[i], 2);",
      "1137:      l = RLC_MAX(l, _l[i]);",
      "",
      "[Removed Lines]",
      "1134:     for (i = 0; i < 8; i++) {",
      "",
      "[Added Lines]",
      "1136:     for (int i = 0; i < 8; i++) {",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "1140:      }",
      "1141:     }",
      "1144:      if (bn_sign(_b[i]) == RLC_NEG) {",
      "1145:       fp24_inv_cyc(t[i], t[i]);",
      "1146:      }",
      "1147:     }",
      "1149:     fp24_set_dig(c, 1);",
      "1151:      fp24_sqr_cyc(c, c);",
      "1153:       if (naf[j][i] > 0) {",
      "1154:        fp24_mul(c, c, t[j]);",
      "1155:       }",
      "",
      "[Removed Lines]",
      "1143:     for (i = 0; i < 8; i++) {",
      "1150:     for (i = l - 1; i >= 0; i--) {",
      "1152:      for (j = 0; j < 8; j++) {",
      "",
      "[Added Lines]",
      "1145:     for (int i = 0; i < 8; i++) {",
      "1152:     for (int i = l - 1; i >= 0; i--) {",
      "1154:      for (int j = 0; j < 8; j++) {",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "1163:    } else {",
      "1164:     fp24_copy(t[0], a);",
      "1167:      fp24_sqr_cyc(t[0], t[0]);",
      "1168:      if (bn_get_bit(b, i)) {",
      "1169:       fp24_mul(t[0], t[0], a);",
      "",
      "[Removed Lines]",
      "1166:     for (i = bn_bits(b) - 2; i >= 0; i--) {",
      "",
      "[Added Lines]",
      "1168:     for (int i = bn_bits(b) - 2; i >= 0; i--) {",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "1182:   RLC_FINALLY {",
      "1183:    bn_free(n);",
      "1184:    bn_free(x);",
      "1186:     bn_free(_b[i]);",
      "1187:     fp24_free(t[i]);",
      "1188:    }",
      "",
      "[Removed Lines]",
      "1185:    for (i = 0; i < 8; i++) {",
      "",
      "[Added Lines]",
      "1187:    for (int i = 0; i < 8; i++) {",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "1196:    if (u == NULL) {",
      "1197:     RLC_THROW(ERR_NO_MEMORY);",
      "1198:    }",
      "1200:     fp24_null(u[i]);",
      "1201:     fp24_new(u[i]);",
      "1202:    }",
      "",
      "[Removed Lines]",
      "1199:    for (i = 0; i < w; i++) {",
      "",
      "[Added Lines]",
      "1201:    for (size_t i = 0; i < w; i++) {",
      "",
      "---------------",
      "--- Hunk 33 ---",
      "[Context before]",
      "1205:    j = 0;",
      "1206:    fp24_copy(t, a);",
      "1208:     fp24_sqr_pck(t, t);",
      "1209:     if (bn_get_bit(b, i)) {",
      "1210:      fp24_copy(u[j++], t);",
      "",
      "[Removed Lines]",
      "1207:    for (i = 1; i < bn_bits(b); i++) {",
      "",
      "[Added Lines]",
      "1209:    for (size_t i = 1; i < bn_bits(b); i++) {",
      "",
      "---------------",
      "--- Hunk 34 ---",
      "[Context before]",
      "1227:     fp24_copy(c, u[0]);",
      "1228:    }",
      "1231:     fp24_mul(c, c, u[i]);",
      "1232:    }",
      "",
      "[Removed Lines]",
      "1230:    for (i = j; i < k; i++) {",
      "",
      "[Added Lines]",
      "1232:    for (size_t i = j; i < k; i++) {",
      "",
      "---------------",
      "--- Hunk 35 ---",
      "[Context before]",
      "1239:    RLC_THROW(ERR_CAUGHT);",
      "1240:   }",
      "1241:   RLC_FINALLY {",
      "1243:     fp24_free(u[i]);",
      "1244:    }",
      "1245:    fp24_free(t);",
      "",
      "[Removed Lines]",
      "1242:    for (i = 0; i < w; i++) {",
      "",
      "[Added Lines]",
      "1244:    for (size_t i = 0; i < w; i++) {",
      "",
      "---------------",
      "--- Hunk 36 ---",
      "[Context before]",
      "1249: }",
      "1251: void fp24_exp_cyc_sim(fp24_t e, const fp24_t a, const bn_t b, const fp24_t c, const bn_t d) {",
      "1253:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *_k, *_m;",
      "1254:  fp24_t r, t0[1 << (EP_WIDTH - 2)];",
      "1255:  fp24_t s, t1[1 << (EP_WIDTH - 2)];",
      "1257:  if (bn_is_zero(b)) {",
      "1258:   return fp24_exp_cyc(e, c, d);",
      "",
      "[Removed Lines]",
      "1252:  int i, l, n0, n1, l0, l1;",
      "",
      "[Added Lines]",
      "1254:  int n0, n1;",
      "1258:  size_t l, l0, l1;",
      "",
      "---------------",
      "--- Hunk 37 ---",
      "[Context before]",
      "1268:  RLC_TRY {",
      "1269:   fp24_new(r);",
      "1270:   fp24_new(s);",
      "1272:    fp24_null(t0[i]);",
      "1273:    fp24_null(t1[i]);",
      "1274:    fp24_new(t0[i]);",
      "",
      "[Removed Lines]",
      "1271:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "[Added Lines]",
      "1274:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
      "",
      "---------------",
      "--- Hunk 38 ---",
      "[Context before]",
      "1298:   l = RLC_MAX(l0, l1);",
      "1299:   if (bn_sign(b) == RLC_NEG) {",
      "1301:     naf0[i] = -naf0[i];",
      "1302:    }",
      "1303:   }",
      "1304:   if (bn_sign(d) == RLC_NEG) {",
      "1306:     naf1[i] = -naf1[i];",
      "1307:    }",
      "1308:   }",
      "",
      "[Removed Lines]",
      "1300:    for (i = 0; i < l0; i++) {",
      "1305:    for (i = 0; i < l1; i++) {",
      "",
      "[Added Lines]",
      "1303:    for (size_t i = 0; i < l0; i++) {",
      "1308:    for (size_t i = 0; i < l1; i++) {",
      "",
      "---------------",
      "--- Hunk 39 ---",
      "[Context before]",
      "1311:   _m = naf1 + l - 1;",
      "1313:   fp24_set_dig(r, 1);",
      "1315:    fp24_sqr(r, r);",
      "1317:    n0 = *_k;",
      "",
      "[Removed Lines]",
      "1314:   for (i = l - 1; i >= 0; i--, _k--, _m--) {",
      "",
      "[Added Lines]",
      "1317:   for (int i = l - 1; i >= 0; i--, _k--, _m--) {",
      "",
      "---------------",
      "--- Hunk 40 ---",
      "[Context before]",
      "1341:  RLC_FINALLY {",
      "1342:   fp24_free(r);",
      "1343:   fp24_free(s);",
      "1345:    fp24_free(t0[i]);",
      "1346:    fp24_free(t1[i]);",
      "1347:   }",
      "1348:  }",
      "1349: }",
      "1353:     fp24_t t, *u = RLC_ALLOCA(fp24_t, w);",
      "1355:  if (len == 0) {",
      "",
      "[Removed Lines]",
      "1344:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "1351: void fp24_exp_cyc_sps(fp24_t c, const fp24_t a, const int *b, int len, int sign) {",
      "1352:  int i, j, k, w = len;",
      "",
      "[Added Lines]",
      "1347:   for (int i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
      "1354: void fp24_exp_cyc_sps(fp24_t c, const fp24_t a, const int *b, size_t len,",
      "1355:   int sign) {",
      "1356:  size_t i, j, k, w = len;",
      "",
      "---------------",
      "--- Hunk 41 ---",
      "[Context before]",
      "1719:  }",
      "1720: }",
      "1724:     fp48_t t, *u = RLC_ALLOCA(fp48_t, w);",
      "1726:  if (len == 0) {",
      "",
      "[Removed Lines]",
      "1722: void fp48_exp_cyc_sps(fp48_t c, const fp48_t a, const int *b, int len, int sign) {",
      "1723:  int i, j, k, w = len;",
      "",
      "[Added Lines]",
      "1726: void fp48_exp_cyc_sps(fp48_t c, const fp48_t a, const int *b, size_t len,",
      "1727:   int sign) {",
      "1728:  size_t i, j, k, w = len;",
      "",
      "---------------",
      "--- Hunk 42 ---",
      "[Context before]",
      "2090:  }",
      "2091: }",
      "2095:     fp54_t t, *u = RLC_ALLOCA(fp54_t, w);",
      "2097:  if (len == 0) {",
      "",
      "[Removed Lines]",
      "2093: void fp54_exp_cyc_sps(fp54_t c, const fp54_t a, const int *b, int len, int sign) {",
      "2094:  int i, j, k, w = len;",
      "",
      "[Added Lines]",
      "2098: void fp54_exp_cyc_sps(fp54_t c, const fp54_t a, const int *b, size_t len,",
      "2099:   int sign) {",
      "2100:  size_t i, j, k, w = len;",
      "",
      "---------------"
    ],
    "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c": [
      "File: src/fpx/relic_fpx_exp.c -> src/fpx/relic_fpx_exp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "329:  bn_t _b;",
      "330:  fp12_t t, v;",
      "331:  int8_t u, naf[RLC_DIG + 1];",
      "334:  if (b == 0) {",
      "335:   fp12_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "332:  int l;",
      "",
      "[Added Lines]",
      "332:  size_t l;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "461:  bn_t _b;",
      "462:  fp24_t t, v;",
      "463:  int8_t u, naf[RLC_DIG + 1];",
      "466:  if (b == 0) {",
      "467:   fp24_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "464:  int l;",
      "",
      "[Added Lines]",
      "464:  size_t l;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "561:  bn_t _b;",
      "562:  fp48_t t, v;",
      "563:  int8_t u, naf[RLC_DIG + 1];",
      "566:  if (b == 0) {",
      "567:   fp48_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "564:  int l;",
      "",
      "[Added Lines]",
      "564:  size_t l;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "657:  bn_t _b;",
      "658:  fp54_t t, v;",
      "659:  int8_t u, naf[RLC_DIG + 1];",
      "662:  if (b == 0) {",
      "663:   fp54_set_dig(c, 1);",
      "",
      "[Removed Lines]",
      "660:  int l;",
      "",
      "[Added Lines]",
      "660:  size_t l;",
      "",
      "---------------"
    ],
    "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c": [
      "File: src/fpx/relic_fpx_util.c -> src/fpx/relic_fpx_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "72:  }",
      "73: }",
      "76:  if (len != RLC_FP_BYTES + 1 && len != 2 * RLC_FP_BYTES) {",
      "77:   RLC_THROW(ERR_NO_BUFFER);",
      "78:   return;",
      "",
      "[Removed Lines]",
      "75: void fp2_read_bin(fp2_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "75: void fp2_read_bin(fp2_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "89:  }",
      "90: }",
      "93:  fp2_t t;",
      "95:  fp2_null(t);",
      "",
      "[Removed Lines]",
      "92: void fp2_write_bin(uint8_t *bin, int len, const fp2_t a, int pack) {",
      "",
      "[Added Lines]",
      "92: void fp2_write_bin(uint8_t *bin, size_t len, const fp2_t a, int pack) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "160:  return 3 * RLC_FP_BYTES;",
      "161: }",
      "164:  if (len != 3 * RLC_FP_BYTES) {",
      "165:   RLC_THROW(ERR_NO_BUFFER);",
      "166:   return;",
      "",
      "[Removed Lines]",
      "163: void fp3_read_bin(fp3_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "163: void fp3_read_bin(fp3_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "170:  fp_read_bin(a[2], bin + 2 * RLC_FP_BYTES, RLC_FP_BYTES);",
      "171: }",
      "174:  if (len != 3 * RLC_FP_BYTES) {",
      "175:   RLC_THROW(ERR_NO_BUFFER);",
      "176:   return;",
      "",
      "[Removed Lines]",
      "173: void fp3_write_bin(uint8_t *bin, int len, const fp3_t a) {",
      "",
      "[Added Lines]",
      "173: void fp3_write_bin(uint8_t *bin, size_t len, const fp3_t a) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "214:  return 4 * RLC_FP_BYTES;",
      "215: }",
      "218:  if (len != 4 * RLC_FP_BYTES) {",
      "219:   RLC_THROW(ERR_NO_BUFFER);",
      "220:   return;",
      "",
      "[Removed Lines]",
      "217: void fp4_read_bin(fp4_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "217: void fp4_read_bin(fp4_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "223:  fp2_read_bin(a[1], bin + 2 * RLC_FP_BYTES, 2 * RLC_FP_BYTES);",
      "224: }",
      "227:  if (len != 4 * RLC_FP_BYTES) {",
      "228:   RLC_THROW(ERR_NO_BUFFER);",
      "229:   return;",
      "",
      "[Removed Lines]",
      "226: void fp4_write_bin(uint8_t *bin, int len, const fp4_t a) {",
      "",
      "[Added Lines]",
      "226: void fp4_write_bin(uint8_t *bin, size_t len, const fp4_t a) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "269:  return 6 * RLC_FP_BYTES;",
      "270: }",
      "273:  if (len != 6 * RLC_FP_BYTES) {",
      "274:   RLC_THROW(ERR_NO_BUFFER);",
      "275:   return;",
      "",
      "[Removed Lines]",
      "272: void fp6_read_bin(fp6_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "272: void fp6_read_bin(fp6_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "279:  fp2_read_bin(a[2], bin + 4 * RLC_FP_BYTES, 2 * RLC_FP_BYTES);",
      "280: }",
      "283:  if (len != 6 * RLC_FP_BYTES) {",
      "284:   RLC_THROW(ERR_NO_BUFFER);",
      "285:   return;",
      "",
      "[Removed Lines]",
      "282: void fp6_write_bin(uint8_t *bin, int len, const fp6_t a) {",
      "",
      "[Added Lines]",
      "282: void fp6_write_bin(uint8_t *bin, size_t len, const fp6_t a) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "331:  }",
      "332: }",
      "335:  if (len != 8 * RLC_FP_BYTES) {",
      "336:   RLC_THROW(ERR_NO_BUFFER);",
      "337:   return;",
      "",
      "[Removed Lines]",
      "334: void fp8_read_bin(fp8_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "334: void fp8_read_bin(fp8_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "340:  fp4_read_bin(a[1], bin + 4 * RLC_FP_BYTES, 4 * RLC_FP_BYTES);",
      "341: }",
      "344:  if (len != 8 * RLC_FP_BYTES) {",
      "345:   RLC_THROW(ERR_NO_BUFFER);",
      "346:   return;",
      "",
      "[Removed Lines]",
      "343: void fp8_write_bin(uint8_t *bin, int len, const fp8_t a) {",
      "",
      "[Added Lines]",
      "343: void fp8_write_bin(uint8_t *bin, size_t len, const fp8_t a) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "386:  return 9 * RLC_FP_BYTES;",
      "387: }",
      "390:  if (len != 9 * RLC_FP_BYTES) {",
      "391:   RLC_THROW(ERR_NO_BUFFER);",
      "392:   return;",
      "",
      "[Removed Lines]",
      "389: void fp9_read_bin(fp9_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "389: void fp9_read_bin(fp9_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "396:  fp3_read_bin(a[2], bin + 6 * RLC_FP_BYTES, 3 * RLC_FP_BYTES);",
      "397: }",
      "400:  if (len != 9 * RLC_FP_BYTES) {",
      "401:   RLC_THROW(ERR_NO_BUFFER);",
      "402:   return;",
      "",
      "[Removed Lines]",
      "399: void fp9_write_bin(uint8_t *bin, int len, const fp9_t a) {",
      "",
      "[Added Lines]",
      "399: void fp9_write_bin(uint8_t *bin, size_t len, const fp9_t a) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "448:  }",
      "449: }",
      "452:  if (len != 8 * RLC_FP_BYTES && len != 12 * RLC_FP_BYTES) {",
      "453:   RLC_THROW(ERR_NO_BUFFER);",
      "454:   return;",
      "",
      "[Removed Lines]",
      "451: void fp12_read_bin(fp12_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "451: void fp12_read_bin(fp12_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "468:  }",
      "469: }",
      "472:  fp12_t t;",
      "474:  fp12_null(t);",
      "",
      "[Removed Lines]",
      "471: void fp12_write_bin(uint8_t *bin, int len, const fp12_t a, int pack) {",
      "",
      "[Added Lines]",
      "471: void fp12_write_bin(uint8_t *bin, size_t len, const fp12_t a, int pack) {",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "532:  return 18 * RLC_FP_BYTES;",
      "533: }",
      "536:  if (len != 18 * RLC_FP_BYTES) {",
      "537:   RLC_THROW(ERR_NO_BUFFER);",
      "538:   return;",
      "",
      "[Removed Lines]",
      "535: void fp18_read_bin(fp18_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "535: void fp18_read_bin(fp18_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "541:  fp9_read_bin(a[1], bin + 9 * RLC_FP_BYTES, 9 * RLC_FP_BYTES);",
      "542: }",
      "545:  if (len != 18 * RLC_FP_BYTES) {",
      "546:   RLC_THROW(ERR_NO_BUFFER);",
      "547:   return;",
      "",
      "[Removed Lines]",
      "544: void fp18_write_bin(uint8_t *bin, int len, const fp18_t a) {",
      "",
      "[Added Lines]",
      "544: void fp18_write_bin(uint8_t *bin, size_t len, const fp18_t a) {",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "595:  }",
      "596: }",
      "599:  if (len != 16 * RLC_FP_BYTES && len != 24 * RLC_FP_BYTES) {",
      "600:   RLC_THROW(ERR_NO_BUFFER);",
      "601:   return;",
      "",
      "[Removed Lines]",
      "598: void fp24_read_bin(fp24_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "598: void fp24_read_bin(fp24_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "616:  }",
      "617: }",
      "620:  fp24_t t;",
      "622:  fp24_null(t);",
      "",
      "[Removed Lines]",
      "619: void fp24_write_bin(uint8_t *bin, int len, const fp24_t a, int pack) {",
      "",
      "[Added Lines]",
      "619: void fp24_write_bin(uint8_t *bin, size_t len, const fp24_t a, int pack) {",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "690:  }",
      "691: }",
      "694:  if (len != 32 * RLC_FP_BYTES && len != 48 * RLC_FP_BYTES) {",
      "695:   RLC_THROW(ERR_NO_BUFFER);",
      "696:   return;",
      "",
      "[Removed Lines]",
      "693: void fp48_read_bin(fp48_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "693: void fp48_read_bin(fp48_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "710:  }",
      "711: }",
      "714:  fp48_t t;",
      "716:  fp48_null(t);",
      "",
      "[Removed Lines]",
      "713: void fp48_write_bin(uint8_t *bin, int len, const fp48_t a, int pack) {",
      "",
      "[Added Lines]",
      "713: void fp48_write_bin(uint8_t *bin, size_t len, const fp48_t a, int pack) {",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "786:  }",
      "787: }",
      "790:  if (len != 36 * RLC_FP_BYTES && len != 54 * RLC_FP_BYTES) {",
      "791:   RLC_THROW(ERR_NO_BUFFER);",
      "792:   return;",
      "",
      "[Removed Lines]",
      "789: void fp54_read_bin(fp54_t a, const uint8_t *bin, int len) {",
      "",
      "[Added Lines]",
      "789: void fp54_read_bin(fp54_t a, const uint8_t *bin, size_t len) {",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "807:  }",
      "808: }",
      "811:  fp54_t t;",
      "813:  fp54_null(t);",
      "",
      "[Removed Lines]",
      "810: void fp54_write_bin(uint8_t *bin, int len, const fp54_t a, int pack) {",
      "",
      "[Added Lines]",
      "810: void fp54_write_bin(uint8_t *bin, size_t len, const fp54_t a, int pack) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_blake2s.c||src/md/relic_md_blake2s.c": [
      "File: src/md/relic_md_blake2s.c -> src/md/relic_md_blake2s.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "44: #if MD_MAP == B2S160 || !defined(STRIP)",
      "47:  memset(hash, 0, RLC_MD_LEN_B2S160);",
      "48:  blake2s(hash, RLC_MD_LEN_B2S160, msg, len, NULL, 0);",
      "49: }",
      "",
      "[Removed Lines]",
      "46: void md_map_b2s160(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "46: void md_map_b2s160(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "53: #if MD_MAP == B2S256 || !defined(STRIP)",
      "56:  memset(hash, 0, RLC_MD_LEN_B2S256);",
      "57:  blake2s(hash, RLC_MD_LEN_B2S256, msg, len, NULL, 0);",
      "58: }",
      "",
      "[Removed Lines]",
      "55: void md_map_b2s256(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "55: void md_map_b2s256(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_hmac.c||src/md/relic_md_hmac.c": [
      "File: src/md/relic_md_hmac.c -> src/md/relic_md_hmac.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45: #if MD_MAP == SH224 || MD_MAP == SH256 || MD_MAP == B2S160 || MD_MAP == B2S256",
      "46:   #define block_size 64",
      "47: #elif MD_MAP == SH384 || MD_MAP == SH512",
      "",
      "[Removed Lines]",
      "43: void md_hmac(uint8_t *mac, const uint8_t *in, int in_len, const uint8_t *key,",
      "44:     int key_len) {",
      "",
      "[Added Lines]",
      "43: void md_hmac(uint8_t *mac, const uint8_t *in, size_t in_len, const uint8_t *key,",
      "44:     size_t key_len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_kdf.c||src/md/relic_md_kdf.c": [
      "File: src/md/relic_md_kdf.c -> src/md/relic_md_kdf.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:  uint32_t i, j, d;",
      "46:  uint8_t* buffer = RLC_ALLOCA(uint8_t, in_len + sizeof(uint32_t));",
      "47:  uint8_t* t = RLC_ALLOCA(uint8_t, key_len + RLC_MD_LEN);",
      "",
      "[Removed Lines]",
      "43: void md_kdf(uint8_t *key, int key_len, const uint8_t *in,",
      "44:   int in_len) {",
      "",
      "[Added Lines]",
      "43: void md_kdf(uint8_t *key, size_t key_len, const uint8_t *in, size_t in_len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_mgf.c||src/md/relic_md_mgf.c": [
      "File: src/md/relic_md_mgf.c -> src/md/relic_md_mgf.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:  uint32_t i, j, d;",
      "46:  uint8_t *buffer = RLC_ALLOCA(uint8_t, in_len + sizeof(uint32_t));",
      "47:  uint8_t *t = RLC_ALLOCA(uint8_t, key_len + RLC_MD_LEN);",
      "",
      "[Removed Lines]",
      "43: void md_mgf(uint8_t *key, int key_len, const uint8_t *in,",
      "44:   int in_len) {",
      "",
      "[Added Lines]",
      "43: void md_mgf(uint8_t *key, size_t key_len, const uint8_t *in, size_t in_len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_sha224.c||src/md/relic_md_sha224.c": [
      "File: src/md/relic_md_sha224.c -> src/md/relic_md_sha224.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if MD_MAP == SH224 || !defined(STRIP)",
      "44:  SHA224Context ctx;",
      "46:  if (SHA224Reset(&ctx) != shaSuccess) {",
      "",
      "[Removed Lines]",
      "43: void md_map_sh224(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "43: void md_map_sh224(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_sha256.c||src/md/relic_md_sha256.c": [
      "File: src/md/relic_md_sha256.c -> src/md/relic_md_sha256.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if MD_MAP == SH256 || !defined(STRIP)",
      "44:  SHA256Context ctx;",
      "46:  if (SHA256Reset(&ctx) != shaSuccess) {",
      "",
      "[Removed Lines]",
      "43: void md_map_sh256(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "43: void md_map_sh256(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_sha384.c||src/md/relic_md_sha384.c": [
      "File: src/md/relic_md_sha384.c -> src/md/relic_md_sha384.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if MD_MAP == SH384 || !defined(STRIP)",
      "44:  SHA384Context ctx;",
      "46:  if (SHA384Reset(&ctx) != shaSuccess) {",
      "",
      "[Removed Lines]",
      "43: void md_map_sh384(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "43: void md_map_sh384(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/md/relic_md_sha512.c||src/md/relic_md_sha512.c": [
      "File: src/md/relic_md_sha512.c -> src/md/relic_md_sha512.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: #if MD_MAP == SH512 || !defined(STRIP)",
      "44:  SHA512Context ctx;",
      "46:  if (SHA512Reset(&ctx) != shaSuccess) {",
      "",
      "[Removed Lines]",
      "43: void md_map_sh512(uint8_t *hash, const uint8_t *msg, int len) {",
      "",
      "[Added Lines]",
      "43: void md_map_sh512(uint8_t *hash, const uint8_t *msg, size_t len) {",
      "",
      "---------------"
    ],
    "src/pp/relic_pp_map_k12.c||src/pp/relic_pp_map_k12.c": [
      "File: src/pp/relic_pp_map_k12.c -> src/pp/relic_pp_map_k12.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "52:  fp12_t l;",
      "53:  ep_t *_p = RLC_ALLOCA(ep_t, m);",
      "54:  ep2_t *_q = RLC_ALLOCA(ep2_t, m);",
      "56:  int8_t s[RLC_FP_BITS + 1];",
      "58:  if (m == 0) {",
      "",
      "[Removed Lines]",
      "55:  int i, j, len = bn_bits(a) + 1;",
      "",
      "[Added Lines]",
      "55:  size_t len = bn_bits(a) + 1;",
      "56:  int i, j;",
      "",
      "---------------"
    ],
    "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c": [
      "File: src/pp/relic_pp_map_k24.c -> src/pp/relic_pp_map_k24.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "52:  fp24_t l;",
      "53:  ep_t *_p = RLC_ALLOCA(ep_t, m);",
      "54:  ep4_t *_q = RLC_ALLOCA(ep4_t, m);",
      "56:  int8_t s[RLC_FP_BITS + 1];",
      "58:  if (m == 0) {",
      "",
      "[Removed Lines]",
      "55:  int i, j, len = bn_bits(a) + 1;",
      "",
      "[Added Lines]",
      "55:  size_t len = bn_bits(a) + 1;",
      "56:  int i, j;",
      "",
      "---------------"
    ],
    "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c": [
      "File: src/pp/relic_pp_map_k48.c -> src/pp/relic_pp_map_k48.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "42:  fp48_t l;",
      "43:  ep_t _p;",
      "44:  fp8_t rx, ry, rz, qn;",
      "46:  int8_t s[RLC_FP_BITS + 1];",
      "48:  fp48_null(l);",
      "",
      "[Removed Lines]",
      "45:  int i, len = bn_bits(a) + 1;",
      "",
      "[Added Lines]",
      "45:  size_t len = bn_bits(a) + 1;",
      "46:  int i;",
      "",
      "---------------"
    ],
    "src/pp/relic_pp_map_k54.c||src/pp/relic_pp_map_k54.c": [
      "File: src/pp/relic_pp_map_k54.c -> src/pp/relic_pp_map_k54.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "42:  fp54_t l;",
      "43:  ep_t _p;",
      "44:  fp9_t rx, ry, rz, sx, sy, sz, qn;",
      "46:  int8_t s[RLC_FP_BITS + 1];",
      "48:  fp54_null(l);",
      "",
      "[Removed Lines]",
      "45:  int i, len = bn_bits(a) + 1;",
      "",
      "[Added Lines]",
      "45:  size_t len = bn_bits(a) + 1;",
      "46:  int i;",
      "",
      "---------------"
    ],
    "src/pp/relic_pp_map_k8.c||src/pp/relic_pp_map_k8.c": [
      "File: src/pp/relic_pp_map_k8.c -> src/pp/relic_pp_map_k8.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  fp8_t l;",
      "54:  ep_t *_p = RLC_ALLOCA(ep_t, m);",
      "55:  ep2_t *_q = RLC_ALLOCA(ep2_t, m);",
      "57:  int8_t s[RLC_FP_BITS + 1];",
      "59:  if (m == 0) {",
      "",
      "[Removed Lines]",
      "56:  int i, j, len = bn_bits(a) + 1;",
      "",
      "[Added Lines]",
      "56:  size_t len = bn_bits(a) + 1;",
      "57:  int i, j;",
      "",
      "---------------"
    ],
    "src/rand/relic_rand_core.c||src/rand/relic_rand_core.c": [
      "File: src/rand/relic_rand_core.c -> src/rand/relic_rand_core.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "183: #endif",
      "184: }",
      "187:  int count = 0;",
      "189:  for (int i = 1; i < size; i++) {",
      "",
      "[Removed Lines]",
      "186: int rand_check(uint8_t *buf, int size) {",
      "",
      "[Added Lines]",
      "186: int rand_check(uint8_t *buf, size_t size) {",
      "",
      "---------------"
    ],
    "src/rand/relic_rand_hashd.c||src/rand/relic_rand_hashd.c": [
      "File: src/rand/relic_rand_hashd.c -> src/rand/relic_rand_hashd.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "57:  uint32_t j = util_conv_big(8 * out_len);",
      "59:  uint8_t* buf = RLC_ALLOCA(uint8_t, 1 + sizeof(uint32_t) + in_len);",
      "60:  uint8_t hash[RLC_MD_LEN];",
      "",
      "[Removed Lines]",
      "56: static void rand_hash(uint8_t *out, int out_len, uint8_t *in, int in_len) {",
      "58:  int len = RLC_CEIL(out_len, RLC_MD_LEN);",
      "",
      "[Added Lines]",
      "56: static void rand_hash(uint8_t *out, size_t out_len, uint8_t *in,",
      "57:   size_t in_len) {",
      "59:  size_t len = RLC_CEIL(out_len, RLC_MD_LEN);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "92:  int carry = digit;",
      "93:  for (int i = size - 1; i >= 0; i--) {",
      "94:   int16_t s;",
      "",
      "[Removed Lines]",
      "91: static int rand_inc(uint8_t *data, int size, int digit) {",
      "",
      "[Added Lines]",
      "92: static int rand_inc(uint8_t *data, size_t size, int digit) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "109:  int carry = 0;",
      "110:  for (int i = size - 1; i >= 0; i--) {",
      "",
      "[Removed Lines]",
      "108: static int rand_add(uint8_t *state, uint8_t *hash, int size) {",
      "",
      "[Added Lines]",
      "109: static int rand_add(uint8_t *state, uint8_t *hash, size_t size) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "127:  int m = RLC_CEIL(out_len, RLC_MD_LEN);",
      "128:  uint8_t hash[RLC_MD_LEN], data[(RLC_RAND_SIZE - 1)/2];",
      "129:  ctx_t *ctx = core_get();",
      "",
      "[Removed Lines]",
      "126: static void rand_gen(uint8_t *out, int out_len) {",
      "",
      "[Added Lines]",
      "127: static void rand_gen(uint8_t *out, size_t out_len) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "151: #if RAND == HASHD",
      "154:  uint8_t hash[RLC_MD_LEN];",
      "155:  int carry, len  = (RLC_RAND_SIZE - 1)/2;",
      "156:  ctx_t *ctx = core_get();",
      "",
      "[Removed Lines]",
      "153: void rand_bytes(uint8_t *buf, int size) {",
      "",
      "[Added Lines]",
      "154: void rand_bytes(uint8_t *buf, size_t size) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "173:  ctx->counter = ctx->counter + 1;",
      "174: }",
      "177:  ctx_t *ctx = core_get();",
      "180:  if (size <= 0) {",
      "181:   RLC_THROW(ERR_NO_VALID);",
      "",
      "[Removed Lines]",
      "176: void rand_seed(uint8_t *buf, int size) {",
      "178:  int len = (RLC_RAND_SIZE - 1) / 2;",
      "",
      "[Added Lines]",
      "177: void rand_seed(uint8_t *buf, size_t size) {",
      "179:  size_t len = (RLC_RAND_SIZE - 1) / 2;",
      "",
      "---------------"
    ],
    "src/relic_util.c||src/relic_util.c": [
      "File: src/relic_util.c -> src/relic_util.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "134: #endif",
      "135: }",
      "138:     return RLC_DIG - arch_lzcnt(a);",
      "139: }",
      "",
      "[Removed Lines]",
      "137: int util_bits_dig(dig_t a) {",
      "",
      "[Added Lines]",
      "137: size_t util_bits_dig(dig_t a) {",
      "",
      "---------------"
    ],
    "test/test_bn.c||test/test_bn.c": [
      "File: test/test_bn.c -> test/test_bn.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "234:   } TEST_END;",
      "236:   TEST_CASE(\"reading and writing a positive number are consistent\") {",
      "238:    bn_rand(a, RLC_POS, RLC_BN_BITS);",
      "239:    for (int j = 2; j <= 64; j++) {",
      "240:     bits = bn_size_str(a, j);",
      "",
      "[Removed Lines]",
      "237:    int len = RLC_CEIL(RLC_BN_BITS, 8);",
      "",
      "[Added Lines]",
      "237:    size_t len = RLC_CEIL(RLC_BN_BITS, 8);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "262:   TEST_END;",
      "264:   TEST_CASE(\"reading and writing a negative number are consistent\") {",
      "266:    bn_rand(a, RLC_NEG, RLC_BN_BITS);",
      "267:    for (int j = 2; j <= 64; j++) {",
      "268:     bits = bn_size_str(a, j);",
      "",
      "[Removed Lines]",
      "265:    int len = RLC_CEIL(RLC_BN_BITS, 8);",
      "",
      "[Added Lines]",
      "265:    size_t len = RLC_CEIL(RLC_BN_BITS, 8);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1139: }",
      "1141: static int square_root(void) {",
      "1143:  bn_t a, b, c;",
      "1145:  bn_null(a);",
      "1146:  bn_null(b);",
      "",
      "[Removed Lines]",
      "1142:  int bits, code = RLC_ERR;",
      "",
      "[Added Lines]",
      "1142:  size_t bits;",
      "1144:  int code = RLC_ERR;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1938: static int recoding(void) {",
      "1939:  int code = RLC_ERR;",
      "1940:  bn_t a, b, c, v1[3], v2[3];",
      "1942:  uint8_t d[RLC_BN_BITS + 1];",
      "1943:  int8_t e[2 * (RLC_BN_BITS + 1)];",
      "1945:  bn_null(a);",
      "1946:  bn_null(b);",
      "",
      "[Removed Lines]",
      "1941:  int w, k, l;",
      "",
      "[Added Lines]",
      "1942:  int w, k;",
      "1945:  size_t l;",
      "",
      "---------------"
    ],
    "test/test_core.c||test/test_core.c": [
      "File: test/test_core.c -> test/test_core.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "123:   }",
      "124:   TEST_ASSERT(code == RLC_OK, end);",
      "126:   core_init();",
      "127: #pragma omp parallel copyin(core_ctx) shared(code)",
      "128:   {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "126:   core_clean();",
      "",
      "---------------"
    ],
    "test/test_pc.c||test/test_pc.c": [
      "File: test/test_pc.c -> test/test_pc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1245: }",
      "1247: int util(void) {",
      "1249:  gt_t a, b, c;",
      "1250:  uint8_t bin[24 * RLC_PC_BYTES];",
      "",
      "[Removed Lines]",
      "1248:  int l, code = RLC_ERR;",
      "",
      "[Added Lines]",
      "1248:  int code = RLC_ERR;",
      "",
      "---------------"
    ],
    "test/test_rand.c||test/test_rand.c": [
      "File: test/test_rand.c -> test/test_rand.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "364: static int test(void) {",
      "365:  uint8_t out[64];",
      "368:  TEST_ONCE(\"rdrand hardware generator is non-trivial\") {",
      "369:   memset(out, 0, 2 * len);",
      "",
      "[Removed Lines]",
      "366:  int len = sizeof(out) / 2, code = RLC_ERR;",
      "",
      "[Added Lines]",
      "366:  size_t len = sizeof(out) / 2, code = RLC_ERR;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "86c30d131fa3a66f2c68de2a23477937e56264b9",
      "candidate_info": {
        "commit_hash": "86c30d131fa3a66f2c68de2a23477937e56264b9",
        "repo": "relic-toolkit/relic",
        "commit_url": "https://github.com/relic-toolkit/relic/commit/86c30d131fa3a66f2c68de2a23477937e56264b9",
        "files": [
          "include/relic_fpx.h",
          "src/epx/relic_ep3_mul.c",
          "src/epx/relic_ep3_mul_fix.c",
          "src/epx/relic_ep3_mul_sim.c",
          "src/fpx/relic_fpx_cyc.c",
          "src/fpx/relic_fpx_exp.c",
          "src/fpx/relic_fpx_util.c"
        ],
        "message": "Minor adjustments after merge.",
        "before_after_code_files": [
          "include/relic_fpx.h||include/relic_fpx.h",
          "src/epx/relic_ep3_mul.c||src/epx/relic_ep3_mul.c",
          "src/epx/relic_ep3_mul_fix.c||src/epx/relic_ep3_mul_fix.c",
          "src/epx/relic_ep3_mul_sim.c||src/epx/relic_ep3_mul_sim.c",
          "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c",
          "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c",
          "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "include/relic_fpx.h||include/relic_fpx.h",
            "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c",
            "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c",
            "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c"
          ],
          "candidate": [
            "include/relic_fpx.h||include/relic_fpx.h",
            "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c",
            "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c",
            "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c"
          ]
        }
      },
      "candidate_diff": {
        "include/relic_fpx.h||include/relic_fpx.h": [
          "File: include/relic_fpx.h -> include/relic_fpx.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "3447: void fp18_write_bin(uint8_t *bin, size_t len, const fp18_t a);",
          "",
          "[Added Lines]",
          "3447: void fp18_write_bin(uint8_t *bin, size_t len, const fp18_t a, int pack);",
          "",
          "---------------"
        ],
        "src/epx/relic_ep3_mul.c||src/epx/relic_ep3_mul.c": [
          "File: src/epx/relic_ep3_mul.c -> src/epx/relic_ep3_mul.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "143: static void ep3_mul_naf_imp(ep3_t r, const ep3_t p, const bn_t k) {",
          "144:  int l, i, n;",
          "145:  int8_t naf[RLC_FP_BITS + 1];",
          "148:  RLC_TRY {",
          "151:    ep3_null(t[i]);",
          "152:    ep3_new(t[i]);",
          "153:   }",
          "158:   l = sizeof(naf);",
          "161:   ep3_set_infty(r);",
          "162:   for (i = l - 1; i >= 0; i--) {",
          "",
          "[Removed Lines]",
          "146:  ep3_t t[1 << (EP_WIDTH - 2)];",
          "150:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "155:   ep3_tab(t, p, EP_WIDTH);",
          "159:   bn_rec_naf(naf, &l, k, EP_WIDTH);",
          "",
          "[Added Lines]",
          "146:  ep3_t t[1 << (RLC_WIDTH - 2)];",
          "150:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "155:   ep3_tab(t, p, RLC_WIDTH);",
          "159:   bn_rec_naf(naf, &l, k, RLC_WIDTH);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "181:  }",
          "182:  RLC_FINALLY {",
          "185:    ep3_free(t[i]);",
          "186:   }",
          "187:  }",
          "",
          "[Removed Lines]",
          "184:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "",
          "[Added Lines]",
          "184:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "239: #if EP_MUL == SLIDE || !defined(STRIP)",
          "241: void ep3_mul_slide(ep3_t r, const ep3_t p, const bn_t k) {",
          "243:  int i, j, l;",
          "244:  uint8_t win[RLC_FP_BITS + 1];",
          "",
          "[Removed Lines]",
          "242:  ep3_t t[1 << (EP_WIDTH - 1)], q;",
          "",
          "[Added Lines]",
          "242:  ep3_t t[1 << (RLC_WIDTH - 1)], q;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "251:  }",
          "253:  RLC_TRY {",
          "255:    ep3_null(t[i]);",
          "256:    ep3_new(t[i]);",
          "257:   }",
          "",
          "[Removed Lines]",
          "254:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i ++) {",
          "",
          "[Added Lines]",
          "254:   for (i = 0; i < (1 << (RLC_WIDTH - 1)); i ++) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "266: #endif",
          "270:    ep3_add(t[i], t[i - 1], q);",
          "271:   }",
          "273: #if defined(EP_MIXED)",
          "275: #endif",
          "277:   ep3_set_infty(q);",
          "278:   l = RLC_FP_BITS + 1;",
          "280:   for (i = 0; i < l; i++) {",
          "281:    if (win[i] == 0) {",
          "282:     ep3_dbl(q, q);",
          "",
          "[Removed Lines]",
          "269:   for (i = 1; i < (1 << (EP_WIDTH - 1)); i++) {",
          "274:   ep3_norm_sim(t + 1, t + 1, (1 << (EP_WIDTH - 1)) - 1);",
          "279:   bn_rec_slw(win, &l, k, EP_WIDTH);",
          "",
          "[Added Lines]",
          "269:   for (i = 1; i < (1 << (RLC_WIDTH - 1)); i++) {",
          "274:   ep3_norm_sim(t + 1, t + 1, (1 << (RLC_WIDTH - 1)) - 1);",
          "279:   bn_rec_slw(win, &l, k, RLC_WIDTH);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "297:   RLC_THROW(ERR_CAUGHT);",
          "298:  }",
          "299:  RLC_FINALLY {",
          "301:    ep3_free(t[i]);",
          "302:   }",
          "303:   ep3_free(q);",
          "",
          "[Removed Lines]",
          "300:   for (i = 0; i < (1 << (EP_WIDTH - 1)); i++) {",
          "",
          "[Added Lines]",
          "300:   for (i = 0; i < (1 << (RLC_WIDTH - 1)); i++) {",
          "",
          "---------------"
        ],
        "src/epx/relic_ep3_mul_fix.c||src/epx/relic_ep3_mul_fix.c": [
          "File: src/epx/relic_ep3_mul_fix.c -> src/epx/relic_ep3_mul_fix.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "59:  len = 2 * RLC_FP_BITS + 1;",
          "62:  t = naf + len - 1;",
          "63:  ep3_set_infty(r);",
          "",
          "[Removed Lines]",
          "60:  bn_rec_naf(naf, &len, k, EP_DEPTH);",
          "",
          "[Added Lines]",
          "60:  bn_rec_naf(naf, &len, k, RLC_DEPTH);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "162:   ep3_curve_get_ord(n);",
          "163:   l = bn_bits(n);",
          "166:   ep3_set_infty(t[0]);",
          "168:   ep3_copy(t[1], p);",
          "170:    ep3_dbl(t[1 << j], t[1 << (j - 1)]);",
          "171:    for (i = 1; i < l; i++) {",
          "172:     ep3_dbl(t[1 << j], t[1 << j]);",
          "",
          "[Removed Lines]",
          "164:   l = ((l % EP_DEPTH) == 0 ? (l / EP_DEPTH) : (l / EP_DEPTH) + 1);",
          "169:   for (j = 1; j < EP_DEPTH; j++) {",
          "",
          "[Added Lines]",
          "164:   l = ((l % RLC_DEPTH) == 0 ? (l / RLC_DEPTH) : (l / RLC_DEPTH) + 1);",
          "169:   for (j = 1; j < RLC_DEPTH; j++) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "211:   ep3_curve_get_ord(n);",
          "212:   l = bn_bits(n);",
          "215:   bn_mod(_k, k, n);",
          "216:   n0 = bn_bits(_k);",
          "220:   w = 0;",
          "221:   p1 = p0--;",
          "223:    w = w << 1;",
          "224:    if (p1 < n0 && bn_get_bit(_k, p1)) {",
          "225:     w = w | 1;",
          "",
          "[Removed Lines]",
          "213:   l = ((l % EP_DEPTH) == 0 ? (l / EP_DEPTH) : (l / EP_DEPTH) + 1);",
          "218:   p0 = (EP_DEPTH) * l - 1;",
          "222:   for (j = EP_DEPTH - 1; j >= 0; j--, p1 -= l) {",
          "",
          "[Added Lines]",
          "213:   l = ((l % RLC_DEPTH) == 0 ? (l / RLC_DEPTH) : (l / RLC_DEPTH) + 1);",
          "218:   p0 = (RLC_DEPTH) * l - 1;",
          "222:   for (j = RLC_DEPTH - 1; j >= 0; j--, p1 -= l) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "233:    w = 0;",
          "234:    p1 = p0--;",
          "236:     w = w << 1;",
          "237:     if (p1 < n0 && bn_get_bit(_k, p1)) {",
          "238:      w = w | 1;",
          "",
          "[Removed Lines]",
          "235:    for (j = EP_DEPTH - 1; j >= 0; j--, p1 -= l) {",
          "",
          "[Added Lines]",
          "235:    for (j = RLC_DEPTH - 1; j >= 0; j--, p1 -= l) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "272:   ep3_curve_get_ord(n);",
          "273:   d = bn_bits(n);",
          "275:   e = (d % 2 == 0 ? (d / 2) : (d / 2) + 1);",
          "277:   ep3_set_infty(t[0]);",
          "278:   ep3_copy(t[1], p);",
          "280:    ep3_dbl(t[1 << j], t[1 << (j - 1)]);",
          "281:    for (i = 1; i < d; i++) {",
          "282:     ep3_dbl(t[1 << j], t[1 << j]);",
          "",
          "[Removed Lines]",
          "274:   d = ((d % EP_DEPTH) == 0 ? (d / EP_DEPTH) : (d / EP_DEPTH) + 1);",
          "279:   for (j = 1; j < EP_DEPTH; j++) {",
          "",
          "[Added Lines]",
          "274:   d = ((d % RLC_DEPTH) == 0 ? (d / RLC_DEPTH) : (d / RLC_DEPTH) + 1);",
          "279:   for (j = 1; j < RLC_DEPTH; j++) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "288:     ep3_add(t[(1 << j) + i], t[i], t[1 << j]);",
          "289:    }",
          "290:   }",
          "294:    for (i = 1; i < e; i++) {",
          "296:    }",
          "297:   }",
          "298: #if defined(EP_MIXED)",
          "",
          "[Removed Lines]",
          "291:   ep3_set_infty(t[1 << EP_DEPTH]);",
          "292:   for (j = 1; j < (1 << EP_DEPTH); j++) {",
          "293:    ep3_dbl(t[(1 << EP_DEPTH) + j], t[j]);",
          "295:     ep3_dbl(t[(1 << EP_DEPTH) + j], t[(1 << EP_DEPTH) + j]);",
          "",
          "[Added Lines]",
          "291:   ep3_set_infty(t[1 << RLC_DEPTH]);",
          "292:   for (j = 1; j < (1 << RLC_DEPTH); j++) {",
          "293:    ep3_dbl(t[(1 << RLC_DEPTH) + j], t[j]);",
          "295:     ep3_dbl(t[(1 << RLC_DEPTH) + j], t[(1 << RLC_DEPTH) + j]);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "328:   ep3_curve_get_ord(n);",
          "329:   d = bn_bits(n);",
          "331:   e = (d % 2 == 0 ? (d / 2) : (d / 2) + 1);",
          "333:   ep3_set_infty(r);",
          "334:   bn_mod(_k, k, n);",
          "335:   n0 = bn_bits(_k);",
          "338:   for (i = e - 1; i >= 0; i--) {",
          "339:    ep3_dbl(r, r);",
          "341:    w0 = 0;",
          "342:    p0 = p1;",
          "344:     w0 = w0 << 1;",
          "345:     if (p0 < n0 && bn_get_bit(_k, p0)) {",
          "346:      w0 = w0 | 1;",
          "",
          "[Removed Lines]",
          "330:   d = ((d % EP_DEPTH) == 0 ? (d / EP_DEPTH) : (d / EP_DEPTH) + 1);",
          "337:   p1 = (e - 1) + (EP_DEPTH - 1) * d;",
          "343:    for (j = EP_DEPTH - 1; j >= 0; j--, p0 -= d) {",
          "",
          "[Added Lines]",
          "330:   d = ((d % RLC_DEPTH) == 0 ? (d / RLC_DEPTH) : (d / RLC_DEPTH) + 1);",
          "337:   p1 = (e - 1) + (RLC_DEPTH - 1) * d;",
          "343:    for (j = RLC_DEPTH - 1; j >= 0; j--, p0 -= d) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "350:    w1 = 0;",
          "351:    p0 = p1-- + e;",
          "353:     w1 = w1 << 1;",
          "354:     if (i + e < d && p0 < n0 && bn_get_bit(_k, p0)) {",
          "355:      w1 = w1 | 1;",
          "",
          "[Removed Lines]",
          "352:    for (j = EP_DEPTH - 1; j >= 0; j--, p0 -= d) {",
          "",
          "[Added Lines]",
          "352:    for (j = RLC_DEPTH - 1; j >= 0; j--, p0 -= d) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "357:    }",
          "359:    ep3_add(r, r, t[w0]);",
          "361:   }",
          "362:   ep3_norm(r, r);",
          "363:   if (bn_sign(_k) == RLC_NEG) {",
          "",
          "[Removed Lines]",
          "360:    ep3_add(r, r, t[(1 << EP_DEPTH) + w1]);",
          "",
          "[Added Lines]",
          "360:    ep3_add(r, r, t[(1 << RLC_DEPTH) + w1]);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "378: #if EP_FIX == LWNAF || !defined(STRIP)",
          "380: void ep3_mul_pre_lwnaf(ep3_t *t, const ep3_t p) {",
          "382: }",
          "384: void ep3_mul_fix_lwnaf(ep3_t r, const ep3_t *t, const bn_t k) {",
          "",
          "[Removed Lines]",
          "381:  ep3_tab(t, p, EP_DEPTH);",
          "",
          "[Added Lines]",
          "381:  ep3_tab(t, p, RLC_DEPTH);",
          "",
          "---------------"
        ],
        "src/epx/relic_ep3_mul_sim.c||src/epx/relic_ep3_mul_sim.c": [
          "File: src/epx/relic_ep3_mul_sim.c -> src/epx/relic_ep3_mul_sim.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: static void ep3_mul_sim_plain(ep3_t r, const ep3_t p, const bn_t k,",
          "54:   const ep3_t q, const bn_t m, ep3_t *t) {",
          "56:  int8_t naf0[2 * RLC_FP_BITS + 1], naf1[2 * RLC_FP_BITS + 1], *_k, *_m;",
          "60:  RLC_TRY {",
          "61:   gen = (t == NULL ? 0 : 1);",
          "62:   if (!gen) {",
          "64:     ep3_null(t0[i]);",
          "65:     ep3_new(t0[i]);",
          "66:    }",
          "68:    t = (ep3_t *)t0;",
          "69:   }",
          "73:    ep3_null(t1[i]);",
          "74:    ep3_new(t1[i]);",
          "75:   }",
          "80:   if (gen) {",
          "82:   } else {",
          "84:   }",
          "85:   l0 = l1 = 2 * RLC_FP_BITS + 1;",
          "86:   bn_rec_naf(naf0, &l0, k, w);",
          "89:   l = RLC_MAX(l0, l1);",
          "90:   _k = naf0 + l - 1;",
          "",
          "[Removed Lines]",
          "55:  int i, l, l0, l1, n0, n1, w, gen;",
          "57:  ep3_t t0[1 << (EP_WIDTH - 2)];",
          "58:  ep3_t t1[1 << (EP_WIDTH - 2)];",
          "63:    for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "67:    ep3_tab(t0, p, EP_WIDTH);",
          "72:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "77:   ep3_tab(t1, q, EP_WIDTH);",
          "81:    w = EP_DEPTH;",
          "83:    w = EP_WIDTH;",
          "87:   bn_rec_naf(naf1, &l1, m, EP_WIDTH);",
          "",
          "[Added Lines]",
          "55:  int i, n0, n1, w, gen;",
          "56:  size_t l, l0, l1;",
          "58:  ep3_t t0[1 << (RLC_WIDTH - 2)];",
          "59:  ep3_t t1[1 << (RLC_WIDTH - 2)];",
          "64:    for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "68:    ep3_tab(t0, p, RLC_WIDTH);",
          "73:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "78:   ep3_tab(t1, q, RLC_WIDTH);",
          "82:    w = RLC_DEPTH;",
          "84:    w = RLC_WIDTH;",
          "88:   bn_rec_naf(naf1, &l1, m, RLC_WIDTH);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "128:  RLC_FINALLY {",
          "130:   if (!gen) {",
          "132:     ep3_free(t0[i]);",
          "133:    }",
          "134:   }",
          "136:    ep3_free(t1[i]);",
          "137:   }",
          "138:  }",
          "",
          "[Removed Lines]",
          "131:    for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "135:   for (i = 0; i < (1 << (EP_WIDTH - 2)); i++) {",
          "",
          "[Added Lines]",
          "132:    for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "136:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "174: void ep3_mul_sim_trick(ep3_t r, const ep3_t p, const bn_t k, const ep3_t q,",
          "175:   const bn_t m) {",
          "178:  bn_t n;",
          "180:  uint8_t w0[2 * RLC_FP_BITS], w1[2 * RLC_FP_BITS];",
          "182:  bn_null(n);",
          "",
          "[Removed Lines]",
          "176:  ep3_t t0[1 << (EP_WIDTH / 2)], t1[1 << (EP_WIDTH / 2)];",
          "177:  ep3_t t[1 << (EP_WIDTH - EP_WIDTH % 2)];",
          "179:  int l0, l1, w = EP_WIDTH / 2;",
          "",
          "[Added Lines]",
          "177:  ep3_t t0[1 << (RLC_WIDTH / 2)], t1[1 << (RLC_WIDTH / 2)];",
          "178:  ep3_t t[1 << (RLC_WIDTH - RLC_WIDTH % 2)];",
          "180:  size_t l0, l1, w = RLC_WIDTH / 2;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "201:    ep3_new(t0[i]);",
          "202:    ep3_new(t1[i]);",
          "203:   }",
          "205:    ep3_null(t[i]);",
          "206:    ep3_new(t[i]);",
          "207:   }",
          "",
          "[Removed Lines]",
          "204:   for (int i = 0; i < (1 << (EP_WIDTH - EP_WIDTH % 2)); i++) {",
          "",
          "[Added Lines]",
          "205:   for (int i = 0; i < (1 << (RLC_WIDTH - RLC_WIDTH % 2)); i++) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "231:   }",
          "233: #if defined(EP_MIXED)",
          "235: #endif",
          "237:   l0 = l1 = RLC_CEIL(2 * RLC_FP_BITS, w);",
          "",
          "[Removed Lines]",
          "234:   ep3_norm_sim(t + 1, t + 1, (1 << (EP_WIDTH - EP_WIDTH % 2)) - 1);",
          "",
          "[Added Lines]",
          "235:   ep3_norm_sim(t + 1, t + 1, (1 << (RLC_WIDTH - RLC_WIDTH % 2)) - 1);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "255:    ep3_free(t0[i]);",
          "256:    ep3_free(t1[i]);",
          "257:   }",
          "259:    ep3_free(t[i]);",
          "260:   }",
          "261:  }",
          "",
          "[Removed Lines]",
          "258:   for (int i = 0; i < (1 << (EP_WIDTH - EP_WIDTH % 2)); i++) {",
          "",
          "[Added Lines]",
          "259:   for (int i = 0; i < (1 << (RLC_WIDTH - RLC_WIDTH % 2)); i++) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "285: void ep3_mul_sim_joint(ep3_t r, const ep3_t p, const bn_t k, const ep3_t q,",
          "286:   const bn_t m) {",
          "287:  ep3_t t[5];",
          "289:  int8_t jsf[4 * (RLC_FP_BITS + 1)];",
          "291:  if (bn_is_zero(k) || ep3_is_infty(p)) {",
          "292:   ep3_mul(r, q, m);",
          "",
          "[Removed Lines]",
          "288:  int i, l, u_i, offset;",
          "",
          "[Added Lines]",
          "289:  int i, u_i, offset;",
          "291:  size_t l;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "425: void ep3_mul_sim_lot(ep3_t r, const ep3_t p[], const bn_t k[], int n) {",
          "426:  const int len = RLC_FP_BITS + 1;",
          "428:  bn_t _k[8], q, x;",
          "429:  int8_t *naf = RLC_ALLOCA(int8_t, 8 * n * len);",
          "",
          "[Removed Lines]",
          "427:  int i, j, m, l, *_l = RLC_ALLOCA(int, 8 * n);",
          "",
          "[Added Lines]",
          "429:  int i, j, m;",
          "430:  size_t l, *_l = RLC_ALLOCA(size_t, 8 * n);",
          "",
          "---------------"
        ],
        "src/fpx/relic_fpx_cyc.c||src/fpx/relic_fpx_cyc.c": [
          "File: src/fpx/relic_fpx_cyc.c -> src/fpx/relic_fpx_cyc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1141:  }",
          "1143:  if ((bn_bits(b) > RLC_DIG) && ((w << 3) > bn_bits(b))) {",
          "1145:   int8_t naf[6][RLC_FP_BITS + 1];",
          "1146:   fp18_t t[6];",
          "1147:   bn_t _b[6], n, x;",
          "",
          "[Removed Lines]",
          "1144:   int l, _l[6];",
          "",
          "[Added Lines]",
          "1144:   size_t l, _l[6];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1280: }",
          "1282: void fp18_exp_cyc_sim(fp18_t e, const fp18_t a, const bn_t b, const fp18_t c, const bn_t d) {",
          "1284:  int8_t naf0[RLC_FP_BITS + 1], naf1[RLC_FP_BITS + 1], *_k, *_m;",
          "1288:  if (bn_is_zero(b)) {",
          "1289:   return fp18_exp_cyc(e, c, d);",
          "",
          "[Removed Lines]",
          "1283:  int i, l, n0, n1, l0, l1;",
          "1285:  fp18_t r, t0[1 << (EP_WIDTH - 2)];",
          "1286:  fp18_t s, t1[1 << (EP_WIDTH - 2)];",
          "",
          "[Added Lines]",
          "1283:  int i, n0, n1;",
          "1284:  size_t l, l0, l1;",
          "1286:  fp18_t r, t0[1 << (RLC_WIDTH - 2)];",
          "1287:  fp18_t s, t1[1 << (RLC_WIDTH - 2)];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1299:  RLC_TRY {",
          "1300:   fp18_new(r);",
          "1301:   fp18_new(s);",
          "1303:    fp18_null(t0[i]);",
          "1304:    fp18_null(t1[i]);",
          "1305:    fp18_new(t0[i]);",
          "1306:    fp18_new(t1[i]);",
          "1307:   }",
          "1310:   fp18_sqr(t0[0], a);",
          "1311:   fp18_mul(t0[1], t0[0], a);",
          "1313:    fp18_mul(t0[i], t0[i - 1], t0[0]);",
          "1314:   }",
          "1316:   fp18_sqr(t1[0], c);",
          "1317:   fp18_mul(t1[1], t1[0], c);",
          "1319:    fp18_mul(t1[i], t1[i - 1], t1[0]);",
          "1320:   }",
          "1321: #endif",
          "",
          "[Removed Lines]",
          "1302:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i ++) {",
          "1309: #if FP_WIDTH > 2",
          "1312:   for (int i = 2; i < (1 << (FP_WIDTH - 2)); i++) {",
          "1318:   for (int i = 2; i < (1 << (FP_WIDTH - 2)); i++) {",
          "",
          "[Added Lines]",
          "1303:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i ++) {",
          "1310: #if RLC_WIDTH > 2",
          "1313:   for (int i = 2; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "1319:   for (int i = 2; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1323:   fp18_copy(t1[0], c);",
          "1325:   l0 = l1 = RLC_FP_BITS + 1;",
          "1329:   l = RLC_MAX(l0, l1);",
          "1330:   if (bn_sign(b) == RLC_NEG) {",
          "",
          "[Removed Lines]",
          "1326:   bn_rec_naf(naf0, &l0, b, FP_WIDTH);",
          "1327:   bn_rec_naf(naf1, &l1, d, FP_WIDTH);",
          "",
          "[Added Lines]",
          "1327:   bn_rec_naf(naf0, &l0, b, RLC_WIDTH);",
          "1328:   bn_rec_naf(naf1, &l1, d, RLC_WIDTH);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1372:  RLC_FINALLY {",
          "1373:   fp18_free(r);",
          "1374:   fp18_free(s);",
          "1376:    fp18_free(t0[i]);",
          "1377:    fp18_free(t1[i]);",
          "1378:   }",
          "",
          "[Removed Lines]",
          "1375:   for (i = 0; i < (1 << (FP_WIDTH - 2)); i++) {",
          "",
          "[Added Lines]",
          "1376:   for (i = 0; i < (1 << (RLC_WIDTH - 2)); i++) {",
          "",
          "---------------"
        ],
        "src/fpx/relic_fpx_exp.c||src/fpx/relic_fpx_exp.c": [
          "File: src/fpx/relic_fpx_exp.c -> src/fpx/relic_fpx_exp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "425:  bn_t _b;",
          "426:  fp18_t t, v;",
          "427:  int8_t u, naf[RLC_DIG + 1];",
          "430:  if (b == 0) {",
          "431:   fp18_set_dig(c, 1);",
          "",
          "[Removed Lines]",
          "428:  int l;",
          "",
          "[Added Lines]",
          "428:  size_t l;",
          "",
          "---------------"
        ],
        "src/fpx/relic_fpx_util.c||src/fpx/relic_fpx_util.c": [
          "File: src/fpx/relic_fpx_util.c -> src/fpx/relic_fpx_util.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "541: }",
          "543: void fp18_read_bin(fp18_t a, const uint8_t *bin, size_t len) {",
          "545:   RLC_THROW(ERR_NO_BUFFER);",
          "546:   return;",
          "547:  }",
          "",
          "[Removed Lines]",
          "544:  if (len != 18 * RLC_FP_BYTES) {",
          "",
          "[Added Lines]",
          "544:  if (len != 12 * RLC_FP_BYTES && len != 18 * RLC_FP_BYTES) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "560:  }",
          "561: }",
          "564:  fp18_t t;",
          "566:  fp18_null(t);",
          "",
          "[Removed Lines]",
          "563: void fp18_write_bin(uint8_t *bin, int len, const fp18_t a, int pack) {",
          "",
          "[Added Lines]",
          "563: void fp18_write_bin(uint8_t *bin, size_t len, const fp18_t a, int pack) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "abe670406f121f66ac514f51b6d4210724a1e121",
      "candidate_info": {
        "commit_hash": "abe670406f121f66ac514f51b6d4210724a1e121",
        "repo": "relic-toolkit/relic",
        "commit_url": "https://github.com/relic-toolkit/relic/commit/abe670406f121f66ac514f51b6d4210724a1e121",
        "files": [
          "bench/bench_epx.c",
          "include/relic_ep.h",
          "include/relic_epx.h",
          "test/test_epx.c"
        ],
        "message": "Prototypes, tests and benchmarks for the new functions.",
        "before_after_code_files": [
          "bench/bench_epx.c||bench/bench_epx.c",
          "include/relic_ep.h||include/relic_ep.h",
          "include/relic_epx.h||include/relic_epx.h",
          "test/test_epx.c||test/test_epx.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "bench/bench_epx.c||bench/bench_epx.c",
            "include/relic_ep.h||include/relic_ep.h",
            "include/relic_epx.h||include/relic_epx.h"
          ],
          "candidate": [
            "bench/bench_epx.c||bench/bench_epx.c",
            "include/relic_ep.h||include/relic_ep.h",
            "include/relic_epx.h||include/relic_epx.h"
          ]
        }
      },
      "candidate_diff": {
        "bench/bench_epx.c||bench/bench_epx.c": [
          "File: bench/bench_epx.c -> bench/bench_epx.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "549:   BENCH_ADD(ep2_map(p, msg, 5));",
          "550:  } BENCH_END;",
          "552:  BENCH_RUN(\"ep2_pck\") {",
          "553:   ep2_rand(p);",
          "554:   BENCH_ADD(ep2_pck(q, p));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "552:  BENCH_RUN(\"ep2_map_basic\") {",
          "553:   uint8_t msg[5];",
          "554:   rand_bytes(msg, 5);",
          "555:   BENCH_ADD(ep2_map_basic(p, msg, 5));",
          "556:  } BENCH_END;",
          "558:  BENCH_RUN(\"ep2_map_sswum\") {",
          "559:   uint8_t msg[5];",
          "560:   rand_bytes(msg, 5);",
          "561:   BENCH_ADD(ep2_map_sswum(p, msg, 5));",
          "562:  } BENCH_END;",
          "564:  BENCH_RUN(\"ep2_map_swift\") {",
          "565:   uint8_t msg[5];",
          "566:   rand_bytes(msg, 5);",
          "567:   BENCH_ADD(ep2_map_swift(p, msg, 5));",
          "568:  } BENCH_END;",
          "",
          "---------------"
        ],
        "include/relic_ep.h||include/relic_ep.h": [
          "File: include/relic_ep.h -> include/relic_ep.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1270: void ep_map_swift(ep_t p, const uint8_t *msg, size_t len);",
          "",
          "[Removed Lines]",
          "1282: void ep_map_dst(ep_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
          "1283:   size_t dst_len);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "include/relic_epx.h||include/relic_epx.h": [
          "File: include/relic_epx.h -> include/relic_epx.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "470: #define ep2_mul_sim(R, P, K, Q, M) ep2_mul_sim_joint(R, P, K, Q, M)",
          "471: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "481: #if EP_MAP == BASIC",
          "482: #define ep2_map(R, S, L)   ep2_map_basic(R, S, L)",
          "483: #elif EP_MAP == SSWUM",
          "484: #define ep2_map(R, S, L)   ep2_map_sswum(R, S, L)",
          "485: #elif EP_MAP == SWIFT",
          "486: #define ep2_map(R, S, L)   ep2_map_swift(R, S, L)",
          "487: #endif",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1289: void ep2_norm_sim(ep2_t *r, const ep2_t *t, int n);",
          "",
          "[Removed Lines]",
          "1301: void ep2_map_from_field(ep2_t p, const uint8_t *uniform_bytes, size_t len);",
          "1310: void ep2_map(ep2_t p, const uint8_t *msg, size_t len);",
          "1322: void ep2_map_dst(ep2_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
          "1323:   size_t dst_len);",
          "",
          "[Added Lines]",
          "1314: void ep2_map_basic(ep2_t p, const uint8_t *msg, size_t len);",
          "1324: void ep2_map_sswum(ep2_t p, const uint8_t *msg, size_t len);",
          "1334: void ep2_map_swift(ep2_t p, const uint8_t *msg, size_t len);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2555: void ep4_map(ep4_t p, const uint8_t *msg, size_t len);",
          "",
          "[Removed Lines]",
          "2567: void ep4_map_dst(ep4_t p, const uint8_t *msg, size_t len, const uint8_t *dst,",
          "2568:   size_t dst_len);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/test_epx.c||test/test_epx.c": [
          "File: test/test_epx.c -> test/test_epx.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1096: static int hashing2(void) {",
          "1097:  int code = RLC_ERR;",
          "1098:  bn_t n;",
          "1101:  uint8_t msg[5];",
          "1103:  bn_null(n);",
          "1104:  ep2_null(p);",
          "1107:  RLC_TRY {",
          "1108:   bn_new(n);",
          "1109:   ep2_new(p);",
          "1112:   ep2_curve_get_ord(n);",
          "1114:   TEST_CASE(\"point hashing is correct\") {",
          "1115:    rand_bytes(msg, sizeof(msg));",
          "1122:   }",
          "1123:   TEST_END;",
          "1124:  }",
          "1125:  RLC_CATCH_ANY {",
          "1126:   util_print(\"FATAL ERROR!\\n\");",
          "",
          "[Removed Lines]",
          "1099:  ep2_t p;",
          "1100:  ep2_t q;",
          "1105:  ep2_null(q);",
          "1110:   ep2_new(q);",
          "1116:    ep2_map(p, msg, sizeof(msg));",
          "1117:    TEST_ASSERT(ep2_on_curve(p) == 1, end);",
          "1118:    ep2_map_dst(q, msg, sizeof(msg), (const uint8_t *)\"RELIC\", 5);",
          "1119:    TEST_ASSERT(ep2_cmp(p, q) == RLC_EQ, end);",
          "1120:    ep2_mul(p, p, n);",
          "1121:    TEST_ASSERT(ep2_is_infty(p) == 1, end);",
          "",
          "[Added Lines]",
          "1099:  ep2_t a;",
          "1113:    ep2_map(a, msg, sizeof(msg));",
          "1114:    TEST_ASSERT(ep2_on_curve(a) == 1, end);",
          "1115:    ep2_mul(a, a, n);",
          "1116:    TEST_ASSERT(ep2_is_infty(a) == 1, end);",
          "1117:   }",
          "1118:   TEST_END;",
          "1120: #if EP_MAP == BASIC || !defined(STRIP)",
          "1121:   TEST_CASE(\"basic point hashing is correct\") {",
          "1122:    rand_bytes(msg, sizeof(msg));",
          "1123:    ep2_map_basic(a, msg, sizeof(msg));",
          "1124:    TEST_ASSERT(ep2_is_infty(a) == 0, end);",
          "1125:    ep2_mul(a, a, n);",
          "1126:    TEST_ASSERT(ep2_is_infty(a) == 1, end);",
          "1127:   }",
          "1128:   TEST_END;",
          "1129: #endif",
          "1131: #if EP_MAP == SSWUM || !defined(STRIP)",
          "1132:   TEST_CASE(\"simplified SWU point hashing is correct\") {",
          "1133:    rand_bytes(msg, sizeof(msg));",
          "1134:    ep2_map_sswum(a, msg, sizeof(msg));",
          "1135:    TEST_ASSERT(ep2_is_infty(a) == 0, end);",
          "1136:    ep2_mul(a, a, n);",
          "1137:    TEST_ASSERT(ep2_is_infty(a) == 1, end);",
          "1140: #endif",
          "1142:   if (ep_curve_is_pairf()) {",
          "1143:    #if EP_MAP == SWIFT || !defined(STRIP)",
          "1144:      TEST_CASE(\"swift point hashing is correct\") {",
          "1145:       rand_bytes(msg, sizeof(msg));",
          "1146:       ep2_map_swift(a, msg, sizeof(msg));",
          "1147:       TEST_ASSERT(ep_is_infty(a) == 0, end);",
          "1148:       ep2_mul(a, a, n);",
          "1149:       TEST_ASSERT(ep2_is_infty(a) == 1, end);",
          "1150:      }",
          "1151:      TEST_END;",
          "1152:    #endif",
          "1153:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1129:  code = RLC_OK;",
          "1130:   end:",
          "1131:  bn_free(n);",
          "1134:  return code;",
          "1135: }",
          "",
          "[Removed Lines]",
          "1132:  ep2_free(p);",
          "1133:  ep2_free(q);",
          "",
          "[Added Lines]",
          "1162:  ep2_free(a);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d60460fee94ce1f9ec400c9ebd95758cf9fc45ba",
      "candidate_info": {
        "commit_hash": "d60460fee94ce1f9ec400c9ebd95758cf9fc45ba",
        "repo": "relic-toolkit/relic",
        "commit_url": "https://github.com/relic-toolkit/relic/commit/d60460fee94ce1f9ec400c9ebd95758cf9fc45ba",
        "files": [
          "bench/bench_pp.c",
          "include/relic_pc.h",
          "include/relic_pp.h",
          "src/pp/relic_pp_add_k48.c",
          "src/pp/relic_pp_dbl_k48.c",
          "src/pp/relic_pp_map_k24.c",
          "src/pp/relic_pp_map_k48.c",
          "src/pp/relic_pp_norm.c",
          "test/test_pp.c"
        ],
        "message": "Make BLS48 a first class citizen.",
        "before_after_code_files": [
          "bench/bench_pp.c||bench/bench_pp.c",
          "include/relic_pc.h||include/relic_pc.h",
          "include/relic_pp.h||include/relic_pp.h",
          "src/pp/relic_pp_add_k48.c||src/pp/relic_pp_add_k48.c",
          "src/pp/relic_pp_dbl_k48.c||src/pp/relic_pp_dbl_k48.c",
          "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c",
          "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c",
          "src/pp/relic_pp_norm.c||src/pp/relic_pp_norm.c",
          "test/test_pp.c||test/test_pp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c",
            "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c"
          ],
          "candidate": [
            "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c",
            "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c"
          ]
        }
      },
      "candidate_diff": {
        "bench/bench_pp.c||bench/bench_pp.c": [
          "File: bench/bench_pp.c -> bench/bench_pp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "550:  }",
          "551: }",
          "553: static void pairing48(void) {",
          "556:  fp48_t e;",
          "562:  fp48_null(e);",
          "568:  fp48_new(e);",
          "570:  BENCH_RUN(\"pp_add_k48\") {",
          "576:  }",
          "577:  BENCH_END;",
          "579: #if EP_ADD == BASIC || !defined(STRIP)",
          "580:  BENCH_RUN(\"pp_add_k48_basic\") {",
          "586:  }",
          "587:  BENCH_END;",
          "588: #endif",
          "590: #if EP_ADD == PROJC || !defined(STRIP)",
          "591:  BENCH_RUN(\"pp_add_k48_projc\") {",
          "597:  }",
          "598:  BENCH_END;",
          "599: #endif",
          "601:  BENCH_RUN(\"pp_dbl_k48\") {",
          "607:  }",
          "608:  BENCH_END;",
          "631:  BENCH_RUN(\"pp_exp_k48\") {",
          "632:   fp48_rand(e);",
          "",
          "[Removed Lines]",
          "554:  ep_t p;",
          "555:  fp8_t qx, qy, qz;",
          "558:  ep_null(p);",
          "559:  fp8_null(qx);",
          "560:  fp8_null(qy);",
          "561:  fp8_null(qz);",
          "564:  ep_new(p);",
          "565:  fp8_new(qx);",
          "566:  fp8_new(qy);",
          "567:  fp8_new(qz);",
          "571:   fp8_rand(qx);",
          "572:   fp8_rand(qy);",
          "573:   fp8_rand(qz);",
          "574:   ep_rand(p);",
          "575:   BENCH_ADD(pp_add_k48(e, qx, qy, qz, qy, qx, p));",
          "581:   fp8_rand(qx);",
          "582:   fp8_rand(qy);",
          "583:   fp8_rand(qz);",
          "584:   ep_rand(p);",
          "585:   BENCH_ADD(pp_add_k48_basic(e, qx, qy, qy, qx, p));",
          "592:   fp8_rand(qx);",
          "593:   fp8_rand(qy);",
          "594:   fp8_rand(qz);",
          "595:   ep_rand(p);",
          "596:   BENCH_ADD(pp_add_k48_projc(e, qx, qy, qz, qx, qy, p));",
          "602:   fp8_rand(qx);",
          "603:   fp8_rand(qy);",
          "604:   fp8_rand(qz);",
          "605:   ep_rand(p);",
          "606:   BENCH_ADD(pp_dbl_k48(e, qx, qy, qz, p));",
          "610:  #if EP_ADD == BASIC || !defined(STRIP)",
          "611:   BENCH_RUN(\"pp_dbl_k48_basic\") {",
          "612:    fp8_rand(qx);",
          "613:    fp8_rand(qy);",
          "614:    ep_rand(p);",
          "615:    BENCH_ADD(pp_dbl_k48_basic(e, qx, qy, p));",
          "616:   }",
          "617:   BENCH_END;",
          "618:  #endif",
          "620:  #if EP_ADD == PROJC || !defined(STRIP)",
          "621:   BENCH_RUN(\"pp_dbl_k48_projc\") {",
          "622:    fp8_rand(qx);",
          "623:    fp8_rand(qy);",
          "624:    fp8_rand(qz);",
          "625:    ep_rand(p);",
          "626:    BENCH_ADD(pp_dbl_k48_projc(e, qx, qy, qz, p));",
          "627:   }",
          "628:   BENCH_END;",
          "629:  #endif",
          "",
          "[Added Lines]",
          "553: static void pairing24(void) {",
          "554:  bn_t k, n, l;",
          "555:  ep4_t p[2], r;",
          "556:  ep_t q[2];",
          "557:  fp24_t e;",
          "558:  int j;",
          "560:  bn_null(k);",
          "561:  bn_null(n);",
          "562:  bn_null(l);",
          "563:  ep4_null(r);",
          "564:  fp24_null(e);",
          "566:  bn_new(k);",
          "567:  bn_new(n);",
          "568:  bn_new(l);",
          "569:  ep4_new(r);",
          "570:  fp24_new(e);",
          "572:  for (j = 0; j < 2; j++) {",
          "573:   ep4_null(p[j]);",
          "574:   ep_null(q[j]);",
          "575:   ep4_new(p[j]);",
          "576:   ep_new(q[j]);",
          "577:  }",
          "579:  ep4_curve_get_ord(n);",
          "581:  BENCH_RUN(\"pp_add_k24\") {",
          "582:   ep4_rand(p[0]);",
          "583:   ep4_dbl(r, p[0]);",
          "584:   ep4_norm(r, r);",
          "585:   ep_rand(q[0]);",
          "586:   BENCH_ADD(pp_add_k24(e, r, p[0], q[0]));",
          "587:  }",
          "588:  BENCH_END;",
          "590: #if EP_ADD == BASIC || !defined(STRIP)",
          "591:  BENCH_RUN(\"pp_add_k24_basic\") {",
          "592:   ep4_rand(p[0]);",
          "593:   ep4_dbl(r, p[0]);",
          "594:   ep4_norm(r, r);",
          "595:   ep_rand(q[0]);",
          "596:   BENCH_ADD(pp_add_k24_basic(e, r, p[0], q[0]));",
          "597:  }",
          "598:  BENCH_END;",
          "599: #endif",
          "601: #if EP_ADD == PROJC || !defined(STRIP)",
          "603:  BENCH_RUN(\"pp_add_k24_projc\") {",
          "604:   ep4_rand(p[0]);",
          "605:   ep4_dbl(r, p[0]);",
          "606:   ep4_norm(r, r);",
          "607:   ep_rand(q[0]);",
          "608:   BENCH_ADD(pp_add_k24_projc(e, r, p[0], q[0]));",
          "609:  }",
          "610:  BENCH_END;",
          "612: #endif",
          "614:  BENCH_RUN(\"pp_dbl_k24\") {",
          "615:   ep4_rand(p[0]);",
          "616:   ep_rand(q[0]);",
          "617:   BENCH_ADD(pp_dbl_k24(e, p[0], p[0], q[0]));",
          "618:  }",
          "619:  BENCH_END;",
          "621: #if EP_ADD == BASIC || !defined(STRIP)",
          "622:  BENCH_RUN(\"pp_dbl_k24_basic\") {",
          "623:   ep4_rand(p[0]);",
          "624:   ep_rand(q[0]);",
          "625:   BENCH_ADD(pp_dbl_k24_basic(e, p[0], p[0], q[0]));",
          "626:  }",
          "627:  BENCH_END;",
          "628: #endif",
          "630: #if EP_ADD == PROJC || !defined(STRIP)",
          "632:  BENCH_RUN(\"pp_dbl_k24_projc\") {",
          "633:   ep4_rand(p[0]);",
          "634:   ep_rand(q[0]);",
          "635:   BENCH_ADD(pp_dbl_k24_projc(e, p[0], p[0], q[0]));",
          "636:  }",
          "637:  BENCH_END;",
          "639: #endif",
          "641:  BENCH_RUN(\"pp_exp_k24\") {",
          "642:   fp24_rand(e);",
          "643:   BENCH_ADD(pp_exp_k24(e, e));",
          "644:  }",
          "645:  BENCH_END;",
          "647:  BENCH_RUN(\"pp_map_k24\") {",
          "648:   ep4_rand(p[0]);",
          "649:   ep_rand(q[0]);",
          "650:   BENCH_ADD(pp_map_k24(e, q[0], p[0]));",
          "651:  }",
          "652:  BENCH_END;",
          "654:  BENCH_RUN(\"pp_map_sim_k24 (2)\") {",
          "655:   ep4_rand(p[0]);",
          "656:   ep_rand(q[0]);",
          "657:   ep4_rand(p[1]);",
          "658:   ep_rand(q[1]);",
          "659:   BENCH_ADD(pp_map_sim_k24(e, q, p, 2));",
          "660:  }",
          "661:  BENCH_END;",
          "663:  bn_free(k);",
          "664:  bn_free(n);",
          "665:  bn_free(l);",
          "666:  fp24_free(e);",
          "667:  ep4_free(r);",
          "668:  for (j = 0; j < 2; j++) {",
          "669:   ep4_free(p[j]);",
          "670:   ep_free(q[j]);",
          "671:  }",
          "672: }",
          "675:  bn_t k, n, l;",
          "676:  ep8_t p[2], r;",
          "677:  ep_t q[2];",
          "679:  int j;",
          "681:  bn_null(k);",
          "682:  bn_null(n);",
          "683:  bn_null(l);",
          "684:  ep8_null(r);",
          "687:  bn_new(k);",
          "688:  bn_new(n);",
          "689:  bn_new(l);",
          "690:  ep8_new(r);",
          "693:  for (j = 0; j < 2; j++) {",
          "694:   ep8_null(p[j]);",
          "695:   ep_null(q[j]);",
          "696:   ep8_new(p[j]);",
          "697:   ep_new(q[j]);",
          "698:  }",
          "700:  ep8_curve_get_ord(n);",
          "703:   ep8_rand(p[0]);",
          "704:   ep8_dbl(r, p[0]);",
          "705:   ep8_norm(r, r);",
          "706:   ep_rand(q[0]);",
          "707:   BENCH_ADD(pp_add_k48(e, r, p[0], q[0]));",
          "713:   ep8_rand(p[0]);",
          "714:   ep8_dbl(r, p[0]);",
          "715:   ep8_norm(r, r);",
          "716:   ep_rand(q[0]);",
          "717:   BENCH_ADD(pp_add_k48_basic(e, r, p[0], q[0]));",
          "725:   ep8_rand(p[0]);",
          "726:   ep8_dbl(r, p[0]);",
          "727:   ep8_norm(r, r);",
          "728:   ep_rand(q[0]);",
          "729:   BENCH_ADD(pp_add_k48_projc(e, r, p[0], q[0]));",
          "736:   ep8_rand(p[0]);",
          "737:   ep_rand(q[0]);",
          "738:   BENCH_ADD(pp_dbl_k48(e, p[0], p[0], q[0]));",
          "742: #if EP_ADD == BASIC || !defined(STRIP)",
          "743:  BENCH_RUN(\"pp_dbl_k48_basic\") {",
          "744:   ep8_rand(p[0]);",
          "745:   ep_rand(q[0]);",
          "746:   BENCH_ADD(pp_dbl_k48_basic(e, p[0], p[0], q[0]));",
          "747:  }",
          "748:  BENCH_END;",
          "749: #endif",
          "751: #if EP_ADD == PROJC || !defined(STRIP)",
          "753:  BENCH_RUN(\"pp_dbl_k48_projc\") {",
          "754:   ep8_rand(p[0]);",
          "755:   ep_rand(q[0]);",
          "756:   BENCH_ADD(pp_dbl_k48_projc(e, p[0], p[0], q[0]));",
          "757:  }",
          "758:  BENCH_END;",
          "760: #endif",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "635:  BENCH_END;",
          "637:  BENCH_RUN(\"pp_map_k48\") {",
          "643:  }",
          "644:  BENCH_END;",
          "650:  fp48_free(e);",
          "651: }",
          "653: static void pairing54(void) {",
          "",
          "[Removed Lines]",
          "638:   fp8_rand(qx);",
          "639:   fp8_rand(qy);",
          "640:   fp8_rand(qz);",
          "641:   ep_rand(p);",
          "642:   BENCH_ADD(pp_map_k48(e, p, qx, qy));",
          "646:  ep_free(p);",
          "647:  fp8_free(qx);",
          "648:  fp8_free(qy);",
          "649:  fp8_free(qz);",
          "",
          "[Added Lines]",
          "769:   ep8_rand(p[0]);",
          "770:   ep_rand(q[0]);",
          "771:   BENCH_ADD(pp_map_k48(e, q[0], p[0]));",
          "775:  BENCH_RUN(\"pp_map_sim_k48 (2)\") {",
          "776:   ep8_rand(p[0]);",
          "777:   ep_rand(q[0]);",
          "778:   ep8_rand(p[1]);",
          "779:   ep_rand(q[1]);",
          "780:   BENCH_ADD(pp_map_sim_k48(e, q, p, 2));",
          "781:  }",
          "782:  BENCH_END;",
          "784:  bn_free(k);",
          "785:  bn_free(n);",
          "786:  bn_free(l);",
          "788:  ep8_free(r);",
          "789:  for (j = 0; j < 2; j++) {",
          "790:   ep8_free(p[j]);",
          "791:   ep_free(q[j]);",
          "792:  }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "781:   pairing12();",
          "782:  }",
          "784:  if (ep_param_embed() == 48) {",
          "785:   pairing48();",
          "786:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "926:  if (ep_param_embed() == 48) {",
          "927:   pairing24();",
          "928:  }",
          "",
          "---------------"
        ],
        "include/relic_pc.h||include/relic_pc.h": [
          "File: include/relic_pc.h -> include/relic_pc.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "883: #if FP_PRIME < 1536",
          "885: #if FP_PRIME == 575",
          "887: #elif FP_PRIME == 315 || FP_PRIME == 317 || FP_PRIME == 509",
          "888: #define pc_map(R, P, Q);  RLC_CAT(RLC_PC_LOWER, map_k24)(R, P, Q)",
          "889: #elif FP_PRIME == 638 && !defined(FP_QNRES)",
          "",
          "[Removed Lines]",
          "886: #define pc_map(R, P, Q);  RLC_CAT(RLC_PC_LOWER, map_k48)(R, P, Q->x, Q->y)",
          "",
          "[Added Lines]",
          "886: #define pc_map(R, P, Q);  RLC_CAT(RLC_PC_LOWER, map_k48)(R, P, Q)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "910: #if FP_PRIME < 1536",
          "913: #define pc_map_sim(R, P, Q, M); RLC_CAT(RLC_PC_LOWER, map_sim_k24)(R, P, Q, M)",
          "914: #elif FP_PRIME == 638 && !defined(FP_QNRES)",
          "915: #define pc_map_sim(R, P, Q, M); RLC_CAT(RLC_PC_LOWER, map_sim_k18)(R, P, Q, M)",
          "",
          "[Removed Lines]",
          "912: #if FP_PRIME == 315 || FP_PRIME == 317 || FP_PRIME == 509",
          "",
          "[Added Lines]",
          "912: #if FP_PRIME == 575",
          "913: #define pc_map_sim(R, P, Q, M); RLC_CAT(RLC_PC_LOWER, map_sim_k48)(R, P, Q, M)",
          "914: #elif FP_PRIME == 315 || FP_PRIME == 317 || FP_PRIME == 509",
          "",
          "---------------"
        ],
        "include/relic_pp.h||include/relic_pp.h": [
          "File: include/relic_pp.h -> include/relic_pp.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "196: #if EP_ADD == BASIC",
          "198: #else",
          "200: #endif",
          "",
          "[Removed Lines]",
          "197: #define pp_add_k48(L, RX, RY, RZ, QX, QY, P) pp_add_k48_basic(L, RX, RY, QX, QY, P)",
          "199: #define pp_add_k48(L, RX, RY, RZ, QX, QY, P) pp_add_k48_projc(L, RX, RY, RZ, QX, QY, P)",
          "",
          "[Added Lines]",
          "197: #define pp_add_k48(L, R, Q, P) pp_add_k48_basic(L, R, Q, P)",
          "199: #define pp_add_k48(L, R, Q, P) pp_add_k48_projc(L, R, Q, P)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "365: #if EP_ADD == BASIC",
          "367: #else",
          "369: #endif",
          "",
          "[Removed Lines]",
          "366: #define pp_dbl_k48(L, RX, RY, RZ, P) pp_dbl_k48_basic(L, RX, RY, P)",
          "368: #define pp_dbl_k48(L, RX, RY, RZ, P) pp_dbl_k48_projc(L, RX, RY, RZ, P)",
          "",
          "[Added Lines]",
          "366: #define pp_dbl_k48(L, R, Q, P)   pp_dbl_k48_basic(L, R, Q, P)",
          "368: #define pp_dbl_k48(L, R, Q, P)   pp_dbl_k48_projc(L, R, Q, P)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "694: void pp_add_k48_basic(fp48_t l, fp8_t rx, fp8_t ry, fp8_t qx, fp8_t qy,",
          "695:         const ep_t p);",
          "",
          "[Added Lines]",
          "694: void pp_add_k48_basic(fp48_t l, ep8_t r, const ep8_t q, const ep_t p);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "707: void pp_add_k48_projc(fp48_t l, fp8_t rx, fp8_t ry, fp8_t rz, const fp8_t qx,",
          "708:         const fp8_t qy, const ep_t p);",
          "",
          "[Added Lines]",
          "706: void pp_add_k48_projc(fp48_t l, ep8_t r, const ep8_t q, const ep_t p);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "913: void pp_dbl_k48_basic(fp48_t l, fp8_t rx, fp8_t ry, const ep_t p);",
          "",
          "[Added Lines]",
          "911: void pp_dbl_k48_basic(fp48_t l, ep8_t r, const ep8_t q, const ep_t p);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "925: void pp_dbl_k48_projc(fp48_t l, fp8_t rx, fp8_t ry, fp8_t rz, const ep_t p);",
          "",
          "[Added Lines]",
          "923: void pp_dbl_k48_projc(fp48_t l, ep8_t r, const ep8_t q, const ep_t p);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1081: void pp_norm_k24(ep4_t c, const ep4_t a);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1088: void pp_norm_k48(ep8_t c, const ep8_t a);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1290: void pp_map_k48(fp48_t r, const ep_t p, const fp8_t qx, const fp8_t qy);",
          "",
          "[Added Lines]",
          "1297: void pp_map_k48(fp48_t r, const ep_t p, const ep8_t q);",
          "1308: void pp_map_sim_k48(fp48_t r, const ep_t *p, const ep8_t *q, int m);",
          "",
          "---------------"
        ],
        "src/pp/relic_pp_add_k48.c||src/pp/relic_pp_add_k48.c": [
          "File: src/pp/relic_pp_add_k48.c -> src/pp/relic_pp_add_k48.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #include \"relic_pp.h\"",
          "34: #include \"relic_util.h\"",
          "106: #if EP_ADD == BASIC || !defined(STRIP)",
          "111:  fp8_null(s);",
          "115:  RLC_TRY {",
          "116:   fp8_new(s);",
          "124:   fp48_zero(l);",
          "125:   fp_mul(l[0][1][0][0][0], p->x, s[0][0][0]);",
          "",
          "[Removed Lines]",
          "40: static void _ep8_add_basic(fp8_t s, fp8_t rx, fp8_t ry, const fp8_t qx,",
          "41:   const fp8_t qy) {",
          "42:  fp8_t t0, t1, t2;",
          "44:  fp8_null(t0);",
          "45:  fp8_null(t1);",
          "46:  fp8_null(t2);",
          "48:  RLC_TRY {",
          "49:   fp8_new(t0);",
          "50:   fp8_new(t1);",
          "51:   fp8_new(t2);",
          "54:   fp8_sub(t0, qx, rx);",
          "56:   fp8_sub(t1, qy, ry);",
          "59:   if (fp8_is_zero(t0)) {",
          "60:    if (fp8_is_zero(t1)) {",
          "63:     RLC_THROW(ERR_NO_VALID);",
          "64:    } else {",
          "66:     fp8_zero(rx);",
          "67:     fp8_zero(ry);",
          "68:    }",
          "69:   } else {",
          "71:    fp8_inv(t2, t0);",
          "73:    fp8_mul(t2, t1, t2);",
          "76:    fp8_sqr(t1, t2);",
          "77:    fp8_sub(t0, t1, rx);",
          "78:    fp8_sub(t0, t0, qx);",
          "81:    fp8_sub(t1, rx, t0);",
          "82:    fp8_mul(t1, t2, t1);",
          "83:    fp8_sub(ry, t1, ry);",
          "85:    fp8_copy(rx, t0);",
          "87:    if (s != NULL) {",
          "88:     fp8_copy(s, t2);",
          "89:    }",
          "90:   }",
          "91:  }",
          "92:  RLC_CATCH_ANY {",
          "93:   RLC_THROW(ERR_CAUGHT);",
          "94:  }",
          "95:  RLC_FINALLY {",
          "96:   fp8_free(t0);",
          "97:   fp8_free(t1);",
          "98:   fp8_free(t2);",
          "99:  }",
          "100: }",
          "108: void pp_add_k48_basic(fp48_t l, fp8_t rx, fp8_t ry, fp8_t qx, fp8_t qy, const ep_t p) {",
          "109:  fp8_t s, tx, ty;",
          "112:  fp8_null(tx);",
          "113:  fp8_null(ty);",
          "117:   fp8_new(tx);",
          "118:   fp8_new(ty);",
          "120:   fp8_copy(tx, rx);",
          "121:   fp8_copy(ty, ry);",
          "122:   _ep8_add_basic(s, rx, ry, qx, qy);",
          "",
          "[Added Lines]",
          "42: void pp_add_k48_basic(fp48_t l, ep8_t r, const ep8_t q, const ep_t p) {",
          "43:  fp8_t s;",
          "44:  ep8_t t;",
          "47:  ep8_null(t);",
          "51:   ep8_new(t);",
          "53:   ep8_copy(t, r);",
          "54:   ep8_add_slp_basic(r, s, r, q);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "131:   fp_mul(l[0][1][1][1][0], p->x, s[1][1][0]);",
          "132:   fp_mul(l[0][1][1][1][1], p->x, s[1][1][1]);",
          "137:   fp_neg(l[1][1][0][0][0], p->y);",
          "138:  }",
          "",
          "[Removed Lines]",
          "134:   fp8_mul(l[0][0], s, tx);",
          "135:   fp8_sub(l[0][0], ty, l[0][0]);",
          "",
          "[Added Lines]",
          "66:   fp8_mul(l[0][0], s, t->x);",
          "67:   fp8_sub(l[0][0], t->y, l[0][0]);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "141:  }",
          "142:  RLC_FINALLY {",
          "143:   fp8_free(s);",
          "146:  }",
          "147: }",
          "",
          "[Removed Lines]",
          "144:   fp8_free(tx);",
          "145:   fp8_free(ty);",
          "",
          "[Added Lines]",
          "76:   ep8_free(t);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "151: #if EP_ADD == PROJC || !defined(STRIP)",
          "155:  fp8_t t0, t1, t2, t3, t4;",
          "157:  fp8_null(t0);",
          "",
          "[Removed Lines]",
          "153: void pp_add_k48_projc(fp48_t l, fp8_t rx, fp8_t ry, fp8_t rz, const fp8_t qx,",
          "154:   const fp8_t qy, const ep_t p) {",
          "",
          "[Added Lines]",
          "84: void pp_add_k48_projc(fp48_t l, ep8_t r, const ep8_t q, const ep_t p) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "168:   fp8_new(t4);",
          "178:   fp8_sqr(t2, t0);",
          "182:   fp8_mul(t2, t2, t0);",
          "184:   fp8_sqr(t3, t1);",
          "187:   fp8_add(t3, t2, t3);",
          "",
          "[Removed Lines]",
          "171:   fp8_mul(t0, rz, qx);",
          "172:   fp8_sub(t0, rx, t0);",
          "174:   fp8_mul(t1, rz, qy);",
          "175:   fp8_sub(t1, ry, t1);",
          "180:   fp8_mul(rx, rx, t2);",
          "186:   fp8_mul(t3, t3, rz);",
          "",
          "[Added Lines]",
          "101:   fp8_mul(t0, r->z, q->x);",
          "102:   fp8_sub(t0, r->x, t0);",
          "104:   fp8_mul(t1, r->z, q->y);",
          "105:   fp8_sub(t1, r->y, t1);",
          "110:   fp8_mul(r->x, r->x, t2);",
          "116:   fp8_mul(t3, t3, r->z);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "198:   fp_mul(l[0][1][1][1][1], t1[1][1][1], t4[0][0][0]);",
          "218:   fp8_sub(l[0][0], t4, t2);",
          "",
          "[Removed Lines]",
          "201:   fp8_mul(t4, qx, t1);",
          "204:   fp8_sub(t3, t3, rx);",
          "205:   fp8_sub(t3, t3, rx);",
          "207:   fp8_sub(rx, rx, t3);",
          "208:   fp8_mul(t1, t1, rx);",
          "209:   fp8_mul(ry, t2, ry);",
          "210:   fp8_sub(ry, t1, ry);",
          "212:   fp8_mul(rx, t0, t3);",
          "214:   fp8_mul(rz, rz, t2);",
          "217:   fp8_mul(t2, qy, t0);",
          "",
          "[Added Lines]",
          "131:   fp8_mul(t4, q->x, t1);",
          "134:   fp8_sub(t3, t3, r->x);",
          "135:   fp8_sub(t3, t3, r->x);",
          "137:   fp8_sub(r->x, r->x, t3);",
          "138:   fp8_mul(t1, t1, r->x);",
          "139:   fp8_mul(r->y, t2, r->y);",
          "140:   fp8_sub(r->y, t1, r->y);",
          "142:   fp8_mul(r->x, t0, t3);",
          "144:   fp8_mul(r->z, r->z, t2);",
          "147:   fp8_mul(t2, q->y, t0);",
          "",
          "---------------"
        ],
        "src/pp/relic_pp_dbl_k48.c||src/pp/relic_pp_dbl_k48.c": [
          "File: src/pp/relic_pp_dbl_k48.c -> src/pp/relic_pp_dbl_k48.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #include \"relic_pp.h\"",
          "34: #include \"relic_util.h\"",
          "99: #if EP_ADD == BASIC || !defined(STRIP)",
          "104:  fp8_null(s);",
          "108:  RLC_TRY {",
          "109:   fp8_new(s);",
          "116:   fp48_zero(l);",
          "118:   fp_mul(l[0][1][0][0][0], p->x, s[0][0][0]);",
          "",
          "[Removed Lines]",
          "40: static void _ep8_dbl_basic(fp8_t s, fp8_t rx, fp8_t ry) {",
          "41:  fp8_t t0, t1, t2;",
          "43:  fp8_null(t0);",
          "44:  fp8_null(t1);",
          "45:  fp8_null(t2);",
          "47:  RLC_TRY {",
          "48:   fp8_new(t0);",
          "49:   fp8_new(t1);",
          "50:   fp8_new(t2);",
          "53:   fp8_dbl(t0, ry);",
          "54:   fp8_inv(t0, t0);",
          "57:   fp8_sqr(t1, rx);",
          "58:   fp8_copy(t2, t1);",
          "59:   fp8_dbl(t1, t1);",
          "60:   fp8_add(t1, t1, t2);",
          "64:   fp8_mul(t1, t1, t0);",
          "66:   if (s != NULL) {",
          "67:    fp8_copy(s, t1);",
          "68:   }",
          "71:   fp8_sqr(t2, t1);",
          "74:   fp8_dbl(t0, rx);",
          "75:   fp8_sub(t0, t2, t0);",
          "78:   fp8_sub(t2, rx, t0);",
          "79:   fp8_mul(t1, t1, t2);",
          "81:   fp8_sub(ry, t1, ry);",
          "83:   fp8_copy(rx, t0);",
          "84:  }",
          "85:  RLC_CATCH_ANY {",
          "86:   RLC_THROW(ERR_CAUGHT);",
          "87:  }",
          "88:  RLC_FINALLY {",
          "89:   fp8_free(t0);",
          "90:   fp8_free(t1);",
          "91:   fp8_free(t2);",
          "92:  }",
          "93: }",
          "101: void pp_dbl_k48_basic(fp48_t l, fp8_t rx, fp8_t ry, const ep_t p) {",
          "102:  fp8_t s, tx, ty;",
          "105:  fp8_null(tx);",
          "106:  fp8_null(ty);",
          "110:   fp8_new(tx);",
          "111:   fp8_new(ty);",
          "113:   fp8_copy(tx, rx);",
          "114:   fp8_copy(ty, ry);",
          "115:   _ep8_dbl_basic(s, rx, ry);",
          "",
          "[Added Lines]",
          "42: void pp_dbl_k48_basic(fp48_t l, ep8_t r, const ep8_t q, const ep_t p) {",
          "43:  fp8_t s;",
          "44:  ep8_t t;",
          "47:  ep8_null(t);",
          "51:   ep8_new(t);",
          "53:   ep8_copy(t, q);",
          "54:   ep8_dbl_slp_basic(r, s, q);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "124:   fp_mul(l[0][1][1][1][0], p->x, s[1][1][0]);",
          "125:   fp_mul(l[0][1][1][1][1], p->x, s[1][1][1]);",
          "130:   fp_copy(l[1][1][0][0][0], p->y);",
          "131:  } RLC_CATCH_ANY {",
          "",
          "[Removed Lines]",
          "127:   fp8_mul(l[0][0], s, tx);",
          "128:   fp8_sub(l[0][0], ty, l[0][0]);",
          "",
          "[Added Lines]",
          "66:   fp8_mul(l[0][0], s, t->x);",
          "67:   fp8_sub(l[0][0], t->y, l[0][0]);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "133:  }",
          "134:  RLC_FINALLY {",
          "135:   fp8_free(s);",
          "138:  }",
          "139: }",
          "",
          "[Removed Lines]",
          "136:   fp8_free(tx);",
          "137:   fp8_free(ty);",
          "",
          "[Added Lines]",
          "75:   ep8_free(t);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "143: #if EP_ADD == PROJC || !defined(STRIP)",
          "146:  fp8_t t0, t1, t2, t3, t4, t5, t6;",
          "148:  fp8_null(t0);",
          "",
          "[Removed Lines]",
          "145: void pp_dbl_k48_projc(fp48_t l, fp8_t rx, fp8_t ry, fp8_t rz, const ep_t p) {",
          "",
          "[Added Lines]",
          "83: void pp_dbl_k48_projc(fp48_t l, ep8_t r, const ep8_t q, const ep_t p) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "163:   fp8_new(t6);",
          "172:   fp8_dbl(t3, t2);",
          "173:   fp8_add(t3, t3, t2);",
          "177:   fp8_mul(t3, t3, t4);",
          "180:   fp8_sqr(t4, t4);",
          "181:   fp8_sub(t4, t4, t0);",
          "182:   fp8_sub(t4, t4, t1);",
          "186:   fp8_sqr(t5, t5);",
          "187:   fp8_sub(t5, t5, t1);",
          "188:   fp8_sub(t5, t5, t2);",
          "",
          "[Removed Lines]",
          "166:   fp8_sqr(t0, rx);",
          "168:   fp8_sqr(t1, ry);",
          "170:   fp8_sqr(t2, rz);",
          "174:   fp8_zero(t4);",
          "175:   fp_copy(t4[1][0][0], ep_curve_get_b());",
          "179:   fp8_add(t4, rx, ry);",
          "185:   fp8_add(t5, ry, rz);",
          "",
          "[Added Lines]",
          "104:   fp8_sqr(t0, q->x);",
          "106:   fp8_sqr(t1, q->y);",
          "108:   fp8_sqr(t2, q->z);",
          "112:   ep8_curve_get_b(t4);",
          "116:   fp8_add(t4, q->x, q->y);",
          "122:   fp8_add(t5, q->y, q->z);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "192:   fp8_add(t6, t6, t3);",
          "199:   fp8_add(t6, t6, t1);",
          "200:   fp8_sqr(t6, t6);",
          "201:   fp8_sqr(t2, t3);",
          "214:   fp8_sub(l[0][0], t3, t1);",
          "",
          "[Removed Lines]",
          "195:   fp8_sub(rx, t1, t6);",
          "196:   fp8_mul(rx, rx, t4);",
          "202:   fp8_dbl(ry, t2);",
          "203:   fp8_dbl(t2, ry);",
          "204:   fp8_dbl(ry, t2);",
          "205:   fp8_add(ry, ry, t2);",
          "206:   fp8_sub(ry, t6, ry);",
          "209:   fp8_dbl(rz, t1);",
          "210:   fp8_dbl(rz, rz);",
          "211:   fp8_mul(rz, rz, t5);",
          "",
          "[Added Lines]",
          "132:   fp8_sub(r->x, t1, t6);",
          "133:   fp8_mul(r->x, r->x, t4);",
          "139:   fp8_dbl(r->y, t2);",
          "140:   fp8_dbl(t2, r->y);",
          "141:   fp8_dbl(r->y, t2);",
          "142:   fp8_add(r->y, r->y, t2);",
          "143:   fp8_sub(r->y, t6, r->y);",
          "146:   fp8_dbl(r->z, t1);",
          "147:   fp8_dbl(r->z, r->z);",
          "148:   fp8_mul(r->z, r->z, t5);",
          "",
          "---------------"
        ],
        "src/pp/relic_pp_map_k24.c||src/pp/relic_pp_map_k24.c": [
          "File: src/pp/relic_pp_map_k24.c -> src/pp/relic_pp_map_k24.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "168:      pp_mil_k24(r, t, _q, _p, 1, a);",
          "169:      if (bn_sign(a) == RLC_NEG) {",
          "170:       fp24_inv_cyc(r, r);",
          "172:      }",
          "173:      pp_exp_k24(r, r);",
          "174:      break;",
          "",
          "[Removed Lines]",
          "171:       ep4_neg(t[0], t[0]);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/pp/relic_pp_map_k48.c||src/pp/relic_pp_map_k48.c": [
          "File: src/pp/relic_pp_map_k48.c -> src/pp/relic_pp_map_k48.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:  fp48_t l;",
          "45:  size_t len = bn_bits(a) + 1;",
          "47:  int8_t s[RLC_FP_BITS + 1];",
          "49:  fp48_null(l);",
          "56:  RLC_TRY {",
          "57:   fp48_new(l);",
          "68: #if EP_ADD == BASIC",
          "70: #else",
          "74: #endif",
          "77:   bn_rec_naf(s, &len, a, 2);",
          "81:    fp48_mul_dxs(r, r, l);",
          "84:     fp48_mul_dxs(r, r, l);",
          "85:    }",
          "88:     fp48_mul_dxs(r, r, l);",
          "89:    }",
          "90:   }",
          "91:  }",
          "",
          "[Removed Lines]",
          "40: static void pp_mil_k48(fp48_t r, const fp8_t qx, const fp8_t qy, const ep_t p,",
          "41:   const bn_t a) {",
          "43:  ep_t _p;",
          "44:  fp8_t rx, ry, rz, qn;",
          "46:  int i;",
          "50:  ep_null(_p);",
          "51:  fp8_null(rx);",
          "52:  fp8_null(ry);",
          "53:  fp8_null(rz);",
          "54:  fp8_null(qn);",
          "58:   ep_new(_p);",
          "59:   fp8_new(rx);",
          "60:   fp8_new(ry);",
          "61:   fp8_new(rz);",
          "62:   fp8_new(qn);",
          "64:   fp48_zero(l);",
          "65:   fp8_copy(rx, qx);",
          "66:   fp8_copy(ry, qy);",
          "67:   fp8_set_dig(rz, 1);",
          "69:   ep_neg(_p, p);",
          "71:   fp_add(_p->x, p->x, p->x);",
          "72:   fp_add(_p->x, _p->x, p->x);",
          "73:   fp_neg(_p->y, p->y);",
          "75:   fp8_neg(qn, qy);",
          "78:   for (i = len - 2; i >= 0; i--) {",
          "79:    fp48_sqr(r, r);",
          "80:    pp_dbl_k48(l, rx, ry, rz, _p);",
          "82:    if (s[i] > 0) {",
          "83:     pp_add_k48(l, rx, ry, rz, qx, qy, p);",
          "86:    if (s[i] < 0) {",
          "87:     pp_add_k48(l, rx, ry, rz, qx, qn, p);",
          "",
          "[Added Lines]",
          "51: static void pp_mil_k48(fp48_t r, ep8_t *t, ep8_t *q, ep_t *p, int m, bn_t a) {",
          "53:  ep_t *_p = RLC_ALLOCA(ep_t, m);",
          "54:  ep8_t *_q = RLC_ALLOCA(ep8_t, m);",
          "56:  int i, j;",
          "59:  if (m == 0) {",
          "60:   return;",
          "61:  }",
          "67:   if (_p == NULL || _q == NULL) {",
          "68:    RLC_THROW(ERR_NO_MEMORY);",
          "69:   }",
          "70:   for (j = 0; j < m; j++) {",
          "71:    ep_null(_p[j]);",
          "72:    ep8_null(_q[j]);",
          "73:    ep_new(_p[j]);",
          "74:    ep8_new(_q[j]);",
          "75:    ep8_copy(t[j], q[j]);",
          "76:    ep8_neg(_q[j], q[j]);",
          "78:    ep_neg(_p[j], p[j]);",
          "80:    fp_add(_p[j]->x, p[j]->x, p[j]->x);",
          "81:    fp_add(_p[j]->x, _p[j]->x, p[j]->x);",
          "82:    fp_neg(_p[j]->y, p[j]->y);",
          "84:   }",
          "86:   fp48_zero(l);",
          "88:   pp_dbl_k48(r, t[0], t[0], _p[0]);",
          "89:   for (j = 1; j < m; j++) {",
          "90:    pp_dbl_k48(l, t[j], t[j], _p[j]);",
          "92:   }",
          "93:   if (s[len - 2] > 0) {",
          "94:    for (j = 0; j < m; j++) {",
          "95:     pp_add_k48(l, t[j], q[j], p[j]);",
          "96:     fp48_mul_dxs(r, r, l);",
          "97:    }",
          "98:   }",
          "99:   if (s[len - 2] < 0) {",
          "100:    for (j = 0; j < m; j++) {",
          "101:     pp_add_k48(l, t[j], _q[j], p[j]);",
          "104:   }",
          "106:   for (i = len - 3; i >= 0; i--) {",
          "107:    fp48_sqr(r, r);",
          "108:    for (j = 0; j < m; j++) {",
          "109:     pp_dbl_k48(l, t[j], t[j], _p[j]);",
          "111:     if (s[i] > 0) {",
          "112:      pp_add_k48(l, t[j], q[j], p[j]);",
          "113:      fp48_mul_dxs(r, r, l);",
          "114:     }",
          "115:     if (s[i] < 0) {",
          "116:      pp_add_k48(l, t[j], _q[j], p[j]);",
          "117:      fp48_mul_dxs(r, r, l);",
          "118:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "94:  }",
          "95:  RLC_FINALLY {",
          "96:   fp48_free(l);",
          "102:  }",
          "103: }",
          "",
          "[Removed Lines]",
          "97:   ep_free(_p);",
          "98:   fp8_free(rx);",
          "99:   fp8_free(ry);",
          "100:   fp8_free(rz);",
          "101:   fp8_free(qn);",
          "",
          "[Added Lines]",
          "127:   for (j = 0; j < m; j++) {",
          "128:    ep_free(_p[j]);",
          "129:    ep8_free(_q[j]);",
          "130:   }",
          "131:   RLC_FREE(_p);",
          "132:   RLC_FREE(_q);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "110:  bn_t a;",
          "112:  bn_null(a);",
          "114:  RLC_TRY {",
          "115:   bn_new(a);",
          "117:   fp_prime_get_par(a);",
          "118:   fp48_set_dig(r, 1);",
          "121:    switch (ep_curve_is_pairf()) {",
          "122:     case EP_B48:",
          "125:      if (bn_sign(a) == RLC_NEG) {",
          "126:       fp48_inv_cyc(r, r);",
          "127:      }",
          "",
          "[Removed Lines]",
          "109: void pp_map_k48(fp48_t r, const ep_t p, const fp8_t qx, const fp8_t qy) {",
          "120:   if (!ep_is_infty(p) && !(fp8_is_zero(qx) && fp8_is_zero(qy))) {",
          "124:      pp_mil_k48(r, qx, qy, p, a);",
          "",
          "[Added Lines]",
          "140: #if PP_MAP == OATEP || !defined(STRIP)",
          "142: void pp_map_k48(fp48_t r, const ep_t p, const ep8_t q) {",
          "143:  ep_t _p[1];",
          "144:  ep8_t t[1], _q[1];",
          "147:  ep_null(_p[0]);",
          "148:  ep8_null(_q[0]);",
          "149:  ep8_null(t[0]);",
          "153:   ep_new(_p[0]);",
          "154:   ep8_new(_q[0]);",
          "155:   ep8_new(t[0]);",
          "156:   bn_new(a);",
          "158:   fp_prime_get_par(a);",
          "159:   fp48_set_dig(r, 1);",
          "161:   ep_norm(_p[0], p);",
          "162:   ep8_norm(_q[0], q);",
          "164:   if (!ep_is_infty(_p[0]) && !ep8_is_infty(_q[0])) {",
          "165:    switch (ep_curve_is_pairf()) {",
          "166:     case EP_B48:",
          "168:      pp_mil_k48(r, t, _q, _p, 1, a);",
          "169:      if (bn_sign(a) == RLC_NEG) {",
          "170:       fp48_inv_cyc(r, r);",
          "171:      }",
          "172:      pp_exp_k48(r, r);",
          "173:      break;",
          "174:    }",
          "175:   }",
          "176:  }",
          "177:  RLC_CATCH_ANY {",
          "178:   RLC_THROW(ERR_CAUGHT);",
          "179:  }",
          "180:  RLC_FINALLY {",
          "181:   ep_free(_p[0]);",
          "182:   ep8_free(_q[0]);",
          "183:   ep8_free(t[0]);",
          "184:   bn_free(a);",
          "185:  }",
          "186: }",
          "188: void pp_map_sim_k48(fp48_t r, const ep_t *p, const ep8_t *q, int m) {",
          "189:  ep_t *_p = RLC_ALLOCA(ep_t, m);",
          "190:  ep8_t *t = RLC_ALLOCA(ep8_t, m), *_q = RLC_ALLOCA(ep8_t, m);",
          "191:  bn_t a;",
          "192:  int i, j;",
          "194:  RLC_TRY {",
          "195:   bn_null(a);",
          "197:   if (_p == NULL || _q == NULL || t == NULL) {",
          "198:    RLC_THROW(ERR_NO_MEMORY);",
          "199:   }",
          "200:   for (i = 0; i < m; i++) {",
          "201:    ep_null(_p[i]);",
          "202:    ep8_null(_q[i]);",
          "203:    ep8_null(t[i]);",
          "204:    ep_new(_p[i]);",
          "205:    ep8_new(_q[i]);",
          "206:    ep8_new(t[i]);",
          "207:   }",
          "209:   j = 0;",
          "210:   for (i = 0; i < m; i++) {",
          "211:    if (!ep_is_infty(p[i]) && !ep8_is_infty(q[i])) {",
          "212:     ep_norm(_p[j], p[i]);",
          "213:     ep8_norm(_q[j++], q[i]);",
          "214:    }",
          "215:   }",
          "220:   if (j > 0) {",
          "224:      pp_mil_k48(r, t, _q, _p, j, a);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "135:  }",
          "136:  RLC_FINALLY {",
          "137:   bn_free(a);",
          "138:  }",
          "139: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "238:   for (i = 0; i < m; i++) {",
          "239:    ep_free(_p[i]);",
          "240:    ep8_free(_q[i]);",
          "241:    ep8_free(t[i]);",
          "242:   }",
          "243:   RLC_FREE(_p);",
          "244:   RLC_FREE(_q);",
          "245:   RLC_FREE(t);",
          "249: #endif",
          "",
          "---------------"
        ],
        "src/pp/relic_pp_norm.c||src/pp/relic_pp_norm.c": [
          "File: src/pp/relic_pp_norm.c -> src/pp/relic_pp_norm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:  r->coord = BASIC;",
          "120: #endif",
          "121: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "123: void pp_norm_k48(ep8_t r, const ep8_t p) {",
          "124:  if (ep8_is_infty(p)) {",
          "125:   ep8_set_infty(r);",
          "126:   return;",
          "127:  }",
          "129:  if (p->coord == BASIC) {",
          "131:   ep8_copy(r, p);",
          "132:  }",
          "133: #if EP_ADD == PROJC || !defined(STRIP)",
          "134:  fp8_inv(r->z, p->z);",
          "135:  fp8_mul(r->x, p->x, r->z);",
          "136:  fp8_mul(r->y, p->y, r->z);",
          "137:  fp8_set_dig(r->z, 1);",
          "138:  r->coord = BASIC;",
          "139: #endif",
          "140: }",
          "",
          "---------------"
        ],
        "test/test_pp.c||test/test_pp.c": [
          "File: test/test_pp.c -> test/test_pp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "327:   } TEST_END;",
          "329:         TEST_CASE(\"multi-pairing is correct\") {",
          "353:         } TEST_END;",
          "355: #if PP_MAP == TATEP || PP_MAP == OATEP || !defined(STRIP)",
          "",
          "[Removed Lines]",
          "330:                 ep_rand(p[i % 2]);",
          "331:                 ep_rand(q[i % 2]);",
          "332:                 pp_map_k2(e1, p[i % 2], q[i % 2]);",
          "333:                 ep_rand(p[1 - (i % 2)]);",
          "334:                 ep_set_infty(q[1 - (i % 2)]);",
          "335:                 pp_map_sim_k2(e2, p, q, 2);",
          "336:                 TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "337:                 ep_set_infty(p[1 - (i % 2)]);",
          "338:                 ep_rand(q[1 - (i % 2)]);",
          "339:                 pp_map_sim_k2(e2, p, q, 2);",
          "340:                 TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "341:                 ep_set_infty(q[i % 2]);",
          "342:                 pp_map_sim_k2(e2, p, q, 2);",
          "343:                 TEST_ASSERT(fp2_cmp_dig(e2, 1) == RLC_EQ, end);",
          "344:                 ep_rand(p[0]);",
          "345:                 ep_rand(q[0]);",
          "346:                 pp_map_k2(e1, p[0], q[0]);",
          "347:                 ep_rand(p[1]);",
          "348:                 ep_rand(q[1]);",
          "349:                 pp_map_k2(e2, p[1], q[1]);",
          "350:                 fp2_mul(e1, e1, e2);",
          "351:                 pp_map_sim_k2(e2, p, q, 2);",
          "352:                 TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "",
          "[Added Lines]",
          "330:             ep_rand(p[i % 2]);",
          "331:             ep_rand(q[i % 2]);",
          "332:             pp_map_k2(e1, p[i % 2], q[i % 2]);",
          "333:             ep_rand(p[1 - (i % 2)]);",
          "334:             ep_set_infty(q[1 - (i % 2)]);",
          "335:             pp_map_sim_k2(e2, p, q, 2);",
          "336:             TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "337:             ep_set_infty(p[1 - (i % 2)]);",
          "338:             ep_rand(q[1 - (i % 2)]);",
          "339:             pp_map_sim_k2(e2, p, q, 2);",
          "340:             TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "341:             ep_set_infty(q[i % 2]);",
          "342:             pp_map_sim_k2(e2, p, q, 2);",
          "343:             TEST_ASSERT(fp2_cmp_dig(e2, 1) == RLC_EQ, end);",
          "344:             ep_rand(p[0]);",
          "345:             ep_rand(q[0]);",
          "346:             pp_map_k2(e1, p[0], q[0]);",
          "347:             ep_rand(p[1]);",
          "348:             ep_rand(q[1]);",
          "349:             pp_map_k2(e2, p[1], q[1]);",
          "350:             fp2_mul(e1, e1, e2);",
          "351:             pp_map_sim_k2(e2, p, q, 2);",
          "352:             TEST_ASSERT(fp2_cmp(e1, e2) == RLC_EQ, end);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2223:  return code;",
          "2224: }",
          "2245: static int doubling48(void) {",
          "2246:  int code = RLC_ERR;",
          "2247:  bn_t k, n;",
          "2248:  ep_t p;",
          "2250:  fp48_t e1, e2;",
          "2252:  bn_null(k);",
          "2253:  bn_null(n);",
          "2254:  ep_null(p);",
          "2261:  fp48_null(e1);",
          "2262:  fp48_null(e2);",
          "",
          "[Removed Lines]",
          "2227: #define QX000 \"266A6ACAA4B8DDCFBF97F09DFBEB01999BFBFF872276FA7700114F761E8971C6C25A53CC77E96BCC9579F63D8A39D641B8070B07EF40E93C301A5B49CE87110CC30E044BEE5A2D43\"",
          "2228: #define QX001 \"5009EEB2A67C52B79D0727B408A193FFCE76B4F80C8DCF4D61ECEE5471601CD7A94341F697CE9D375DB5470EA055B73C256CCC0AC12F52EAD276C26E001DDCE02DE634BEFCB9CC7C\"",
          "2229: #define QX010 \"11A8DDB59724C01696BE52862B5AC2C7E1C0C42EFCAF456A80F6C6D9F95F89649D5575DE3BA8D28D1012E14308DE1D8F15CE1617611F961032B0B5DFA27EF3E3670B9B537ACC66B9\"",
          "2230: #define QX011 \"4E8BDED03587581A173AD008DFF600EB24054E4CDDCA8D7BFABA2898822DB5ED701BF59BD3F108AD7C714B6A6C7ECB11A1BC5DEEC1D49AE7FCA597C43943A66441B03164975D9BE0\"",
          "2231: #define QX100 \"29E2751CAC7D0FBA8E12CC818BDE6F2A7173D3C2ED74EC1991B936071DEB1AED1E07CDF71EA3501BEB4645C86BDC8A575898303FF6A058C7062F079F594E5B865626D0C031CF7E44\"",
          "2232: #define QX101 \"2F3A1BE54DFFB814DA4AE6311B9B1EEE6198CDB9F36CE92084272416462F4D0AC9ACAC025FDA6D3D0D1C239FE8CE4B7F22A1D0F65582DDA36EEB328843FDE5C0BDA02E871796CC8E\"",
          "2233: #define QX110 \"2FEE7B15EB22B05476A462374860140DCC9F00910E0555918D6357F6E32E623B88B893647AD07B615F364093D6F6D2A7B7614590A8833385B5A833563C0DD6C89AF89D06428E8AFE\"",
          "2234: #define QX111 \"005082322BB5E610DC0E61E3D01B8BFF23D195117F58B1FA68EC04A6769FEB754A58742C7F729E2A684386C40EFB871CB3D32A040966155649DC45C49E6FB5DEE58DB1586CBFD33E\"",
          "2236: #define QY000 \"3B603A4C408A402FB885B607C4A661BF92354D22F46945F222C6F51CCDEBF4006640346AE6BFD60F7E22240D4BF83EFDA1B575267A89597D7BC54FA4899BFBAAC4138E30C8DA55C0\"",
          "2237: #define QY001 \"35D3ECCC1F3C69A921E57CCDEA6C794A5ED01A53E19208854EA3B10D519CCCE64A30007CD7A57673567F2FFA070E5CE01C4E5C8BF1C61225DAC36A93C6524F4D0350C6358C67F85B\"",
          "2238: #define QY010 \"4228DA69A29E14E2CF00EC8FDD877CA9049DA161778A6ACE8DC275D4CE94C90AD9176280703AD9C6714A4865EF6160ED2FA7A5FC601025CF096AB6CF21B8FAA41421C7913DECF3B5\"",
          "2239: #define QY011 \"5273C1679E18D316C6988820E06335094FCCCD5E8FD870492EB96FCBC5B5494B2B9D0869C18309FF2D49CD80CF6E6FE1A660027A6E924831F8D5A070645A7B794BA7AE72507809AE\"",
          "2240: #define QY100 \"0ABD2F582F0D4C3C89770C13F02FF17CDEA5B22CDD661B6F82905ADCDC44E59900C5D09F8CAC90760CCC57D1987DE4BA21F34455E5B7394B68A7883E3F8D918AF308F0C3E6F98F4B\"",
          "2241: #define QY101 \"36FAE1DE9DD31FFE238526F618C14E5CB61EEA8E8E6D82235E43E45E306C5E60B4E5499BF4663516CE1202EF6CDE3B2E098E406B3186937483FC104A173707C6419F460A23ADF628\"",
          "2242: #define QY110 \"09E1BB455FCB47E98C5263B5098E2D148EC2EDEE5634B8F94F10AF9221D09BD60D28920342C11B1987A24B7F56AC4F5E290E7EA483727ED16FFC88C0F5EAD00892FDA66BA68FACE4\"",
          "2243: #define QY111 \"4F781C32F5CAFD446F299BE6BC600BF3482DF6ECAF4ABE3D410A7255B18A88DB77CC539CAC4A0D30A00690CCA8CC7661BCE042D0AC40FF8DC9171847A8E42696E4EF9DD8A5907A3D\"",
          "2249:  fp8_t qx, qy, qz, rx, ry, rz;",
          "2255:  fp8_null(qx);",
          "2256:  fp8_null(qy);",
          "2257:  fp8_null(qz);",
          "2258:  fp8_null(rx);",
          "2259:  fp8_null(ry);",
          "2260:  fp8_null(rz);",
          "",
          "[Added Lines]",
          "2230:  ep8_t q, r, s;",
          "2236:  ep8_null(q);",
          "2237:  ep8_null(r);",
          "2238:  ep8_null(s);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2265:   bn_new(n);",
          "2266:   bn_new(k);",
          "2267:   ep_new(p);",
          "2274:   fp48_new(e1);",
          "2275:   fp48_new(e2);",
          "2297:   ep_curve_get_ord(n);",
          "2299:   TEST_CASE(\"miller doubling is correct\") {",
          "2300:    ep_rand(p);",
          "2310:   } TEST_END;",
          "2312: #if EP_ADD == BASIC || !defined(STRIP)",
          "2313:   TEST_CASE(\"miller doubling in affine coordinates is correct\") {",
          "2314:    ep_rand(p);",
          "2318:    fp48_zero(e1);",
          "2319:    fp48_zero(e2);",
          "2320:    fp_neg(p->y, p->y);",
          "2322:    pp_exp_k48(e2, e2);",
          "2323: #if EP_ADD == PROJC",
          "2325:    fp_dbl(p->z, p->x);",
          "2326:    fp_add(p->x, p->z, p->x);",
          "2327: #endif",
          "2332:    pp_exp_k48(e1, e1);",
          "2333:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2334:   } TEST_END;",
          "",
          "[Removed Lines]",
          "2268:   fp8_new(qx);",
          "2269:   fp8_new(qy);",
          "2270:   fp8_new(qz);",
          "2271:   fp8_new(rx);",
          "2272:   fp8_new(ry);",
          "2273:   fp8_new(rz);",
          "2277:   fp_read_str(qx[0][0][0], QX000, strlen(QX000), 16);",
          "2278:   fp_read_str(qx[0][0][1], QX001, strlen(QX001), 16);",
          "2279:   fp_read_str(qx[0][1][0], QX010, strlen(QX010), 16);",
          "2280:   fp_read_str(qx[0][1][1], QX011, strlen(QX011), 16);",
          "2281:   fp_read_str(qx[1][0][0], QX100, strlen(QX100), 16);",
          "2282:   fp_read_str(qx[1][0][1], QX101, strlen(QX101), 16);",
          "2283:   fp_read_str(qx[1][1][0], QX110, strlen(QX110), 16);",
          "2284:   fp_read_str(qx[1][1][1], QX111, strlen(QX111), 16);",
          "2286:   fp_read_str(qy[0][0][0], QY000, strlen(QY000), 16);",
          "2287:   fp_read_str(qy[0][0][1], QY001, strlen(QY001), 16);",
          "2288:   fp_read_str(qy[0][1][0], QY010, strlen(QY010), 16);",
          "2289:   fp_read_str(qy[0][1][1], QY011, strlen(QY011), 16);",
          "2290:   fp_read_str(qy[1][0][0], QY100, strlen(QY100), 16);",
          "2291:   fp_read_str(qy[1][0][1], QY101, strlen(QY101), 16);",
          "2292:   fp_read_str(qy[1][1][0], QY110, strlen(QY110), 16);",
          "2293:   fp_read_str(qy[1][1][1], QY111, strlen(QY111), 16);",
          "2295:   fp8_set_dig(qz, 1);",
          "2301:    fp8_copy(rx, qx);",
          "2302:    fp8_copy(ry, qy);",
          "2303:    fp8_copy(rz, qz);",
          "2304:    pp_dbl_k48_projc(e1, rx, ry, rz, p);",
          "2305:    fp8_inv(rz, rz);",
          "2306:    fp8_mul(rx, rx, rz);",
          "2307:    fp8_mul(ry, ry, rz);",
          "2308:    pp_dbl_k48_basic(e2, qx, qy, p);",
          "2309:    TEST_ASSERT(fp8_cmp(rx, qx) == RLC_EQ && fp8_cmp(ry, qy) == RLC_EQ, end);",
          "2315:    fp8_copy(rx, qx);",
          "2316:    fp8_copy(ry, qy);",
          "2317:    fp8_copy(rz, qz);",
          "2321:    pp_dbl_k48_basic(e2, rx, ry, p);",
          "2328:    fp8_copy(rx, qx);",
          "2329:    fp8_copy(ry, qy);",
          "2330:    fp8_copy(rz, qz);",
          "2331:    pp_dbl_k48(e1, rx, ry, rz, p);",
          "",
          "[Added Lines]",
          "2246:   ep8_new(q);",
          "2247:   ep8_new(r);",
          "2248:   ep8_new(s);",
          "2256:    ep8_rand(q);",
          "2257:    ep8_rand(r);",
          "2258:    pp_dbl_k48(e1, r, q, p);",
          "2259:    pp_norm_k48(r, r);",
          "2260:    ep8_dbl(s, q);",
          "2261:    ep8_norm(s, s);",
          "2262:    TEST_ASSERT(ep8_cmp(r, s) == RLC_EQ, end);",
          "2268:    ep8_rand(q);",
          "2272:    pp_dbl_k48_basic(e2, r, q, p);",
          "2279:    pp_dbl_k48(e1, r, q, p);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2337: #if EP_ADD == PROJC || EP_ADD == JACOB || !defined(STRIP)",
          "2338:   TEST_CASE(\"miller doubling in projective coordinates is correct\") {",
          "2339:    ep_rand(p);",
          "2343:    fp48_zero(e1);",
          "2344:    fp48_zero(e2);",
          "2346:    fp_neg(p->y, p->y);",
          "2347:    fp_dbl(p->z, p->x);",
          "2348:    fp_add(p->x, p->z, p->x);",
          "2350:    pp_exp_k48(e2, e2);",
          "2351: #if EP_ADD == BASIC",
          "2353:    fp_hlv(p->x, p->z);",
          "2354: #endif",
          "2359:    pp_exp_k48(e1, e1);",
          "2360:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2361:   } TEST_END;",
          "",
          "[Removed Lines]",
          "2340:    fp8_copy(rx, qx);",
          "2341:    fp8_copy(ry, qy);",
          "2342:    fp8_copy(rz, qz);",
          "2349:    pp_dbl_k48_projc(e2, rx, ry, rz, p);",
          "2355:    fp8_copy(rx, qx);",
          "2356:    fp8_copy(ry, qy);",
          "2357:    fp8_copy(rz, qz);",
          "2358:    pp_dbl_k48(e1, rx, ry, rz, p);",
          "",
          "[Added Lines]",
          "2288:    ep8_rand(q);",
          "2295:    pp_dbl_k48_projc(e2, r, q, p);",
          "2301:    pp_dbl_k48(e1, r, q, p);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2370:  bn_free(n);",
          "2371:  bn_free(k);",
          "2372:  ep_free(p);",
          "2379:  fp48_free(e1);",
          "2380:  fp48_free(e2);",
          "2381:  return code;",
          "",
          "[Removed Lines]",
          "2373:  fp8_free(qx);",
          "2374:  fp8_free(qy);",
          "2375:  fp8_free(qz);",
          "2376:  fp8_free(rx);",
          "2377:  fp8_free(ry);",
          "2378:  fp8_free(rz);",
          "",
          "[Added Lines]",
          "2316:  ep8_free(q);",
          "2317:  ep8_free(r);",
          "2318:  ep8_free(s);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2385:  int code = RLC_ERR;",
          "2386:  bn_t k, n;",
          "2387:  ep_t p;",
          "2389:  fp48_t e1, e2;",
          "2391:  bn_null(k);",
          "2392:  bn_null(n);",
          "2393:  ep_null(p);",
          "2400:  fp48_null(e1);",
          "2401:  fp48_null(e2);",
          "",
          "[Removed Lines]",
          "2388:  fp8_t qx, qy, qz, rx, ry, rz;",
          "2394:  fp8_null(qx);",
          "2395:  fp8_null(qy);",
          "2396:  fp8_null(qz);",
          "2397:  fp8_null(rx);",
          "2398:  fp8_null(ry);",
          "2399:  fp8_null(rz);",
          "",
          "[Added Lines]",
          "2328:  ep8_t q, r, s;",
          "2334:  ep8_null(q);",
          "2335:  ep8_null(r);",
          "2336:  ep8_null(s);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2404:   bn_new(n);",
          "2405:   bn_new(k);",
          "2406:   ep_new(p);",
          "2413:   fp48_new(e1);",
          "2414:   fp48_new(e2);",
          "2436:   ep_curve_get_ord(n);",
          "2438:   TEST_CASE(\"miller addition is correct\") {",
          "2439:    ep_rand(p);",
          "2461:   } TEST_END;",
          "2463: #if EP_ADD == BASIC || !defined(STRIP)",
          "2464:   TEST_CASE(\"miller addition in affine coordinates is correct\") {",
          "2465:    ep_rand(p);",
          "2469:    fp48_zero(e1);",
          "2470:    fp48_zero(e2);",
          "2473:    pp_exp_k48(e1, e1);",
          "2484:    pp_exp_k48(e2, e2);",
          "2485:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2486:   } TEST_END;",
          "2487: #endif",
          "2490:   TEST_CASE(\"miller addition in projective coordinates is correct\") {",
          "2491:    ep_rand(p);",
          "2495:    fp48_zero(e1);",
          "2496:    fp48_zero(e2);",
          "2499:    pp_exp_k48(e1, e1);",
          "2505:    pp_exp_k48(e2, e2);",
          "2506:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2507:   } TEST_END;",
          "",
          "[Removed Lines]",
          "2407:   fp8_new(qx);",
          "2408:   fp8_new(qy);",
          "2409:   fp8_new(qz);",
          "2410:   fp8_new(rx);",
          "2411:   fp8_new(ry);",
          "2412:   fp8_new(rz);",
          "2416:   fp_read_str(qx[0][0][0], QX000, strlen(QX000), 16);",
          "2417:   fp_read_str(qx[0][0][1], QX001, strlen(QX001), 16);",
          "2418:   fp_read_str(qx[0][1][0], QX010, strlen(QX010), 16);",
          "2419:   fp_read_str(qx[0][1][1], QX011, strlen(QX011), 16);",
          "2420:   fp_read_str(qx[1][0][0], QX100, strlen(QX100), 16);",
          "2421:   fp_read_str(qx[1][0][1], QX101, strlen(QX101), 16);",
          "2422:   fp_read_str(qx[1][1][0], QX110, strlen(QX110), 16);",
          "2423:   fp_read_str(qx[1][1][1], QX111, strlen(QX111), 16);",
          "2425:   fp_read_str(qy[0][0][0], QY000, strlen(QY000), 16);",
          "2426:   fp_read_str(qy[0][0][1], QY001, strlen(QY001), 16);",
          "2427:   fp_read_str(qy[0][1][0], QY010, strlen(QY010), 16);",
          "2428:   fp_read_str(qy[0][1][1], QY011, strlen(QY011), 16);",
          "2429:   fp_read_str(qy[1][0][0], QY100, strlen(QY100), 16);",
          "2430:   fp_read_str(qy[1][0][1], QY101, strlen(QY101), 16);",
          "2431:   fp_read_str(qy[1][1][0], QY110, strlen(QY110), 16);",
          "2432:   fp_read_str(qy[1][1][1], QY111, strlen(QY111), 16);",
          "2434:   fp8_set_dig(qz, 1);",
          "2440:    fp8_copy(rx, qx);",
          "2441:    fp8_copy(ry, qy);",
          "2442:    fp8_copy(rz, qz);",
          "2443:    pp_dbl_k48(e1, rx, ry, rz, p);",
          "2444:    pp_add_k48_projc(e1, rx, ry, rz, qx, qy, p);",
          "2445:    fp8_inv(rz, rz);",
          "2446:    fp8_mul(rx, rx, rz);",
          "2447:    fp8_mul(ry, ry, rz);",
          "2448:    fp8_copy(e1[0][0], rx);",
          "2449:    fp8_copy(e1[0][1], ry);",
          "2450:    fp8_copy(rx, qx);",
          "2451:    fp8_copy(ry, qy);",
          "2452:    fp8_copy(rz, qz);",
          "2453:    pp_dbl_k48(e2, rx, ry, rz, p);",
          "2454: #if EP_ADD == PROJC",
          "2455:    fp8_inv(rz, rz);",
          "2456:    fp8_mul(rx, rx, rz);",
          "2457:    fp8_mul(ry, ry, rz);",
          "2458: #endif",
          "2459:    pp_add_k48_basic(e2, rx, ry, qx, qy, p);",
          "2460:    TEST_ASSERT(fp8_cmp(rx, e1[0][0]) == RLC_EQ && fp8_cmp(ry, e1[0][1]) == RLC_EQ, end);",
          "2466:    fp8_copy(rx, qx);",
          "2467:    fp8_copy(ry, qy);",
          "2468:    fp8_copy(rz, qz);",
          "2471:    pp_dbl_k48(e1, rx, ry, rz, p);",
          "2472:    pp_add_k48(e1, rx, ry, rz, qx, qy, p);",
          "2474:    fp8_copy(rx, qx);",
          "2475:    fp8_copy(ry, qy);",
          "2476:    fp8_copy(rz, qz);",
          "2477:    pp_dbl_k48(e2, rx, ry, rz, p);",
          "2478: #if EP_ADD == PROJC",
          "2479:    fp8_inv(rz, rz);",
          "2480:    fp8_mul(rx, rx, rz);",
          "2481:    fp8_mul(ry, ry, rz);",
          "2482: #endif",
          "2483:    pp_add_k48_basic(e2, rx, ry, qx, qy, p);",
          "2489: #if EP_ADD == BASIC || !defined(STRIP)",
          "2492:    fp8_copy(rx, qx);",
          "2493:    fp8_copy(ry, qy);",
          "2494:    fp8_copy(rz, qz);",
          "2497:    pp_dbl_k48(e1, rx, ry, rz, p);",
          "2498:    pp_add_k48(e1, rx, ry, rz, qx, qy, p);",
          "2500:    fp8_copy(rx, qx);",
          "2501:    fp8_copy(ry, qy);",
          "2502:    fp8_copy(rz, qz);",
          "2503:    pp_dbl_k48(e2, rx, ry, rz, p);",
          "2504:    pp_add_k48_projc(e2, rx, ry, rz, qx, qy, p);",
          "",
          "[Added Lines]",
          "2344:   ep8_new(q);",
          "2345:   ep8_new(r);",
          "2346:   ep8_new(s);",
          "2354:    ep8_rand(q);",
          "2355:    ep8_rand(r);",
          "2356:    ep8_copy(s, r);",
          "2357:    pp_add_k48(e1, r, q, p);",
          "2358:    pp_norm_k48(r, r);",
          "2359:    ep8_add(s, s, q);",
          "2360:    ep8_norm(s, s);",
          "2361:    TEST_ASSERT(ep8_cmp(r, s) == RLC_EQ, end);",
          "2367:    ep8_rand(q);",
          "2368:    ep8_rand(r);",
          "2369:    ep8_copy(s, r);",
          "2372:    pp_add_k48(e1, r, q, p);",
          "2374:    pp_add_k48_basic(e2, s, q, p);",
          "2380: #if EP_ADD == PROJC || EP_ADD == JACOB || !defined(STRIP)",
          "2383:    ep8_rand(q);",
          "2384:    ep8_rand(r);",
          "2385:    ep8_copy(s, r);",
          "2388:    pp_add_k48(e1, r, q, p);",
          "2390:    pp_add_k48_projc(e2, s, q, p);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2516:  bn_free(n);",
          "2517:  bn_free(k);",
          "2518:  ep_free(p);",
          "2525:  fp48_free(e1);",
          "2526:  fp48_free(e2);",
          "2527:  return code;",
          "2528: }",
          "2530: static int pairing48(void) {",
          "2532:  bn_t k, n;",
          "2535:  fp48_t e1, e2;",
          "2537:  bn_null(k);",
          "2538:  bn_null(n);",
          "2543:  fp48_null(e1);",
          "2544:  fp48_null(e2);",
          "2546:  RLC_TRY {",
          "2547:   bn_new(n);",
          "2548:   bn_new(k);",
          "2553:   fp48_new(e1);",
          "2554:   fp48_new(e2);",
          "2576:   TEST_CASE(\"pairing non-degeneracy is correct\") {",
          "2579:    TEST_ASSERT(fp48_cmp_dig(e1, 1) != RLC_EQ, end);",
          "2580:   } TEST_END;",
          "2582:   TEST_CASE(\"pairing is bilinear\") {",
          "2584:    bn_rand_mod(k, n);",
          "2589:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2597:    fp48_sqr(e1, e1);",
          "2598:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2599:   } TEST_END;",
          "2600:  }",
          "2601:  RLC_CATCH_ANY {",
          "2602:   util_print(\"FATAL ERROR!\\n\");",
          "",
          "[Removed Lines]",
          "2519:  fp8_free(qx);",
          "2520:  fp8_free(qy);",
          "2521:  fp8_free(qz);",
          "2522:  fp8_free(rx);",
          "2523:  fp8_free(ry);",
          "2524:  fp8_free(rz);",
          "2531:  int code = RLC_ERR;",
          "2533:  ep_t p;",
          "2534:  fp8_t qx, qy, qz;",
          "2539:  ep_null(p);",
          "2540:  fp8_null(qx);",
          "2541:  fp8_null(qy);",
          "2542:  fp8_null(qz);",
          "2549:   ep_new(p);",
          "2550:   fp8_new(qx);",
          "2551:   fp8_new(qy);",
          "2552:   fp8_new(qz);",
          "2556:   ep_curve_get_ord(n);",
          "2558:   fp_read_str(qx[0][0][0], QX000, strlen(QX000), 16);",
          "2559:   fp_read_str(qx[0][0][1], QX001, strlen(QX001), 16);",
          "2560:   fp_read_str(qx[0][1][0], QX010, strlen(QX010), 16);",
          "2561:   fp_read_str(qx[0][1][1], QX011, strlen(QX011), 16);",
          "2562:   fp_read_str(qx[1][0][0], QX100, strlen(QX100), 16);",
          "2563:   fp_read_str(qx[1][0][1], QX101, strlen(QX101), 16);",
          "2564:   fp_read_str(qx[1][1][0], QX110, strlen(QX110), 16);",
          "2565:   fp_read_str(qx[1][1][1], QX111, strlen(QX111), 16);",
          "2567:   fp_read_str(qy[0][0][0], QY000, strlen(QY000), 16);",
          "2568:   fp_read_str(qy[0][0][1], QY001, strlen(QY001), 16);",
          "2569:   fp_read_str(qy[0][1][0], QY010, strlen(QY010), 16);",
          "2570:   fp_read_str(qy[0][1][1], QY011, strlen(QY011), 16);",
          "2571:   fp_read_str(qy[1][0][0], QY100, strlen(QY100), 16);",
          "2572:   fp_read_str(qy[1][0][1], QY101, strlen(QY101), 16);",
          "2573:   fp_read_str(qy[1][1][0], QY110, strlen(QY110), 16);",
          "2574:   fp_read_str(qy[1][1][1], QY111, strlen(QY111), 16);",
          "2577:    ep_rand(p);",
          "2578:    pp_map_k48(e1, p, qx, qy);",
          "2583:    ep_rand(p);",
          "2585:    pp_map_k48(e1, p, qx, qy);",
          "2586:    ep_mul(p, p, k);",
          "2587:    pp_map_k48(e2, p, qx, qy);",
          "2588:    fp48_exp(e1, e1, k);",
          "2590:    fp8_set_dig(qz, 1);",
          "2591:    pp_dbl_k48(e2, qx, qy, qz, p);",
          "2592:    fp8_inv(qz, qz);",
          "2593:    fp8_mul(qx, qx, qz);",
          "2594:    fp8_mul(qy, qy, qz);",
          "2595:    fp8_set_dig(qz, 1);",
          "2596:    pp_map_k48(e2, p, qx, qy);",
          "",
          "[Added Lines]",
          "2405:  ep8_free(q);",
          "2406:  ep8_free(r);",
          "2407:  ep8_free(s);",
          "2414:  int j, code = RLC_ERR;",
          "2416:  ep_t p[2];",
          "2417:  ep8_t q[2], r;",
          "2424:  ep8_null(r);",
          "2431:   ep8_new(r);",
          "2433:   for (j = 0; j < 2; j++) {",
          "2434:    ep_null(p[j]);",
          "2435:    ep8_null(q[j]);",
          "2436:    ep_new(p[j]);",
          "2437:    ep8_new(q[j]);",
          "2438:   }",
          "2440:   ep_curve_get_ord(n);",
          "2443:    ep_rand(p[0]);",
          "2444:    ep8_rand(q[0]);",
          "2445:    pp_map_k48(e1, p[0], q[0]);",
          "2447:    ep_set_infty(p[0]);",
          "2448:    pp_map_k48(e1, p[0], q[0]);",
          "2449:    TEST_ASSERT(fp48_cmp_dig(e1, 1) == RLC_EQ, end);",
          "2450:    ep_rand(p[0]);",
          "2451:    ep8_set_infty(q[0]);",
          "2452:    pp_map_k48(e1, p[0], q[0]);",
          "2453:    TEST_ASSERT(fp48_cmp_dig(e1, 1) == RLC_EQ, end);",
          "2457:    ep_rand(p[0]);",
          "2458:    ep8_rand(q[0]);",
          "2460:    ep8_mul(r, q[0], k);",
          "2461:    pp_map_k48(e1, p[0], r);",
          "2462:    pp_map_k48(e2, p[0], q[0]);",
          "2463:    fp48_exp(e2, e2, k);",
          "2464:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2465:    ep_mul(p[0], p[0], k);",
          "2466:    pp_map_k48(e2, p[0], q[0]);",
          "2467:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2468:    ep_dbl(p[0], p[0]);",
          "2469:    pp_map_k48(e2, p[0], q[0]);",
          "2470:    fp48_sqr(e1, e1);",
          "2472:    ep8_dbl(q[0], q[0]);",
          "2473:    pp_map_k48(e2, p[0], q[0]);",
          "2478:   TEST_CASE(\"multi-pairing is correct\") {",
          "2479:    ep_rand(p[i % 2]);",
          "2480:    ep8_rand(q[i % 2]);",
          "2481:    pp_map_k48(e1, p[i % 2], q[i % 2]);",
          "2482:    ep_rand(p[1 - (i % 2)]);",
          "2483:    ep8_set_infty(q[1 - (i % 2)]);",
          "2484:    pp_map_sim_k48(e2, p, q, 2);",
          "2485:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2486:    ep_set_infty(p[1 - (i % 2)]);",
          "2487:    ep8_rand(q[1 - (i % 2)]);",
          "2488:    pp_map_sim_k48(e2, p, q, 2);",
          "2489:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2490:    ep8_set_infty(q[i % 2]);",
          "2491:    pp_map_sim_k48(e2, p, q, 2);",
          "2492:    TEST_ASSERT(fp48_cmp_dig(e2, 1) == RLC_EQ, end);",
          "2493:    ep_rand(p[0]);",
          "2494:    ep8_rand(q[0]);",
          "2495:    pp_map_k48(e1, p[0], q[0]);",
          "2496:    ep_rand(p[1]);",
          "2497:    ep8_rand(q[1]);",
          "2498:    pp_map_k48(e2, p[1], q[1]);",
          "2499:    fp48_mul(e1, e1, e2);",
          "2500:    pp_map_sim_k48(e2, p, q, 2);",
          "2501:    TEST_ASSERT(fp48_cmp(e1, e2) == RLC_EQ, end);",
          "2502:    ep_neg(p[1], p[0]);",
          "2503:    ep8_copy(q[1], q[0]);",
          "2504:    pp_map_sim_k48(e1, p, q, 2);",
          "2505:    TEST_ASSERT(fp48_cmp_dig(e1, 1) == RLC_EQ, end);",
          "2506:   } TEST_END;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2606:   end:",
          "2607:  bn_free(n);",
          "2608:  bn_free(k);",
          "2613:  fp48_free(e1);",
          "2614:  fp48_free(e2);",
          "2615:  return code;",
          "2616: }",
          "",
          "[Removed Lines]",
          "2609:  ep_free(p);",
          "2610:  fp8_free(qx);",
          "2611:  fp8_free(qy);",
          "2612:  fp8_free(qz);",
          "",
          "[Added Lines]",
          "2518:  ep8_free(r);",
          "2520:  for (j = 0; j < 2; j++) {",
          "2521:   ep_free(p[j]);",
          "2522:   ep8_free(q[j]);",
          "2523:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}