{
  "cve_id": "CVE-2019-17266",
  "cve_desc": "libsoup from versions 2.65.1 until 2.68.1 have a heap-based buffer over-read because soup_ntlm_parse_challenge() in soup-auth-ntlm.c does not properly check an NTLM message's length before proceeding with a memcpy.",
  "repo": "GNOME/libsoup",
  "patch_hash": "f8a54ac85eec2008c85393f331cdd251af8266ad",
  "patch_info": {
    "commit_hash": "f8a54ac85eec2008c85393f331cdd251af8266ad",
    "repo": "GNOME/libsoup",
    "commit_url": "https://gitlab.gnome.org/GNOME/libsoup/commit/f8a54ac85eec2008c85393f331cdd251af8266ad",
    "files": [
      "libsoup/soup-auth-ntlm.c"
    ],
    "message": "NTLM: Avoid a potential heap buffer overflow in v2 authentication\n\nCheck the length of the decoded v2 challenge before attempting to\nparse it, to avoid reading past it.\n\nFixes #173",
    "before_after_code_files": [
      "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c"
    ]
  },
  "patch_diff": {
    "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c": [
      "File: libsoup/soup-auth-ntlm.c -> libsoup/soup-auth-ntlm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "735:  if (default_domain) {",
      "736:   memcpy (&domain, chall + NTLM_CHALLENGE_DOMAIN_STRING_OFFSET, sizeof (domain));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "734:         if (*negotiate_target) {",
      "735:             if (clen < NTLM_CHALLENGE_TARGET_INFORMATION_OFFSET + sizeof (target)) {",
      "736:                 g_free (chall);",
      "737:                 return FALSE;",
      "738:             }",
      "739:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "060aa98c0810ed0c3860bda00293a97ae9d86cfe",
      "candidate_info": {
        "commit_hash": "060aa98c0810ed0c3860bda00293a97ae9d86cfe",
        "repo": "GNOME/libsoup",
        "commit_url": "https://github.com/GNOME/libsoup/commit/060aa98c0810ed0c3860bda00293a97ae9d86cfe",
        "files": [
          "libsoup/soup-auth-ntlm.c"
        ],
        "message": "NTLM: Avoid a potential heap buffer overflow in v2 authentication\n\nCheck the length of the decoded v2 challenge before attempting to\nparse it, to avoid reading past it.\n\nFixes #173",
        "before_after_code_files": [
          "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c"
          ],
          "candidate": [
            "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c"
          ]
        }
      },
      "candidate_diff": {
        "libsoup/soup-auth-ntlm.c||libsoup/soup-auth-ntlm.c": [
          "File: libsoup/soup-auth-ntlm.c -> libsoup/soup-auth-ntlm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "734:  if (default_domain) {",
          "735:   memcpy (&domain, chall + NTLM_CHALLENGE_DOMAIN_STRING_OFFSET, sizeof (domain));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "733:         if (*negotiate_target) {",
          "734:             if (clen < NTLM_CHALLENGE_TARGET_INFORMATION_OFFSET + sizeof (target)) {",
          "735:                 g_free (chall);",
          "736:                 return FALSE;",
          "737:             }",
          "738:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}