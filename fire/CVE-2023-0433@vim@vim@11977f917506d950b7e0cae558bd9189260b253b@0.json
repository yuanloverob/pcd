{
  "cve_id": "CVE-2023-0433",
  "cve_desc": "Heap-based Buffer Overflow in GitHub repository vim/vim prior to 9.0.1225.",
  "repo": "vim/vim",
  "patch_hash": "11977f917506d950b7e0cae558bd9189260b253b",
  "patch_info": {
    "commit_hash": "11977f917506d950b7e0cae558bd9189260b253b",
    "repo": "vim/vim",
    "commit_url": "https://github.com/vim/vim/commit/11977f917506d950b7e0cae558bd9189260b253b",
    "files": [
      "src/textformat.c",
      "src/version.c"
    ],
    "message": "patch 9.0.1225: reading past the end of a line when formatting text\n\nProblem:    Reading past the end of a line when formatting text.\nSolution:   Check for not going over the end of the line.",
    "before_after_code_files": [
      "src/textformat.c||src/textformat.c",
      "src/version.c||src/version.c"
    ]
  },
  "patch_diff": {
    "src/textformat.c||src/textformat.c": [
      "File: src/textformat.c -> src/textformat.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "540:     if (leader1_len == 0)",
      "541:  return (leader2_len == 0);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "543:     char_u  *lnum_line = NULL;",
      "544:     int     line_len = 0;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "555:   return FALSE;",
      "556:      if (*p == COM_START)",
      "557:      {",
      "559:       return FALSE;",
      "560:   if (leader2_flags == NULL || leader2_len == 0)",
      "561:       return FALSE;",
      "",
      "[Removed Lines]",
      "558:   if (*(ml_get(lnum) + leader1_len) == NUL)",
      "",
      "[Added Lines]",
      "561:   if (lnum_line == NULL)",
      "562:   {",
      "563:       lnum_line = ml_get(lnum);",
      "564:       line_len = (int)STRLEN(lnum_line);",
      "565:   }",
      "566:   if (line_len <= leader1_len)",
      "",
      "---------------"
    ],
    "src/version.c||src/version.c": [
      "File: src/version.c -> src/version.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "696: static int included_patches[] =",
      "699:     1224,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "699:     1225,",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9cbf791995514e72476399fe06e055a707ec0158",
      "candidate_info": {
        "commit_hash": "9cbf791995514e72476399fe06e055a707ec0158",
        "repo": "vim/vim",
        "commit_url": "https://github.com/vim/vim/commit/9cbf791995514e72476399fe06e055a707ec0158",
        "files": [
          "src/textformat.c",
          "src/version.c"
        ],
        "message": "patch 9.0.1236: code in same_leader() can be simplified\n\nProblem:    Code in same_leader() can be simplified.\nSolution:   Simplify code that is executed only once. (closes #11867)",
        "before_after_code_files": [
          "src/textformat.c||src/textformat.c",
          "src/version.c||src/version.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/textformat.c||src/textformat.c",
            "src/version.c||src/version.c"
          ],
          "candidate": [
            "src/textformat.c||src/textformat.c",
            "src/version.c||src/version.c"
          ]
        }
      },
      "candidate_diff": {
        "src/textformat.c||src/textformat.c": [
          "File: src/textformat.c -> src/textformat.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "540:     if (leader1_len == 0)",
          "541:  return (leader2_len == 0);",
          "",
          "[Removed Lines]",
          "543:     char_u  *lnum_line = NULL;",
          "544:     int     line_len = 0;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "558:   return FALSE;",
          "559:      if (*p == COM_START)",
          "560:      {",
          "566:   if (line_len <= leader1_len)",
          "567:       return FALSE;",
          "568:   if (leader2_flags == NULL || leader2_len == 0)",
          "",
          "[Removed Lines]",
          "561:   if (lnum_line == NULL)",
          "562:   {",
          "563:       lnum_line = ml_get(lnum);",
          "564:       line_len = (int)STRLEN(lnum_line);",
          "565:   }",
          "",
          "[Added Lines]",
          "558:   int line_len = (int)STRLEN(ml_get(lnum));",
          "",
          "---------------"
        ],
        "src/version.c||src/version.c": [
          "File: src/version.c -> src/version.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "696: static int included_patches[] =",
          "699:     1235,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "699:     1236,",
          "",
          "---------------"
        ]
      }
    }
  ]
}