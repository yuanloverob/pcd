{
  "cve_id": "CVE-2023-28101",
  "cve_desc": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. In versions prior to 1.10.8, 1.12.8, 1.14.4, and 1.15.4, if an attacker publishes a Flatpak app with elevated permissions, they can hide those permissions from users of the `flatpak(1)` command-line interface by setting other permissions to crafted values that contain non-printable control characters such as `ESC`. A fix is available in versions 1.10.8, 1.12.8, 1.14.4, and 1.15.4. As a workaround, use a GUI like GNOME Software rather than the command-line interface, or only install apps whose maintainers you trust.",
  "repo": "flatpak/flatpak",
  "patch_hash": "409e34187de2b2b2c4ef34c79f417be698830f6c",
  "patch_info": {
    "commit_hash": "409e34187de2b2b2c4ef34c79f417be698830f6c",
    "repo": "flatpak/flatpak",
    "commit_url": "https://github.com/flatpak/flatpak/commit/409e34187de2b2b2c4ef34c79f417be698830f6c",
    "files": [
      "app/flatpak-cli-transaction.c"
    ],
    "message": "cli-transaction: Escape any special characters in the EOL reason\n\nCVE-2023-28101, GHSA-h43h-fwqx-mpp8\n\nSigned-off-by: Simon McVittie <smcv@collabora.com>",
    "before_after_code_files": [
      "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c"
    ]
  },
  "patch_diff": {
    "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c": [
      "File: app/flatpak-cli-transaction.c -> app/flatpak-cli-transaction.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "755:     }",
      "756:   else if (reason)",
      "757:     {",
      "758:       if (is_pinned)",
      "759:         {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "758:       g_autofree char *escaped_reason = flatpak_escape_string (reason,",
      "759:                                                                FLATPAK_ESCAPE_ALLOW_NEWLINES |",
      "760:                                                                FLATPAK_ESCAPE_DO_NOT_QUOTE);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "770:             g_print (_(\"\\nInfo: app %s%s%s branch %s%s%s is end-of-life, with reason:\\n\"),",
      "771:                      on, ref_name, off, on, ref_branch, off);",
      "772:         }",
      "774:     }",
      "775: }",
      "",
      "[Removed Lines]",
      "773:       g_print (\"   %s\\n\", reason);",
      "",
      "[Added Lines]",
      "776:       g_print (\"   %s\\n\", escaped_reason);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "583cb3a16fa0e5b8a444a578f0b972c35cde7fd0",
      "candidate_info": {
        "commit_hash": "583cb3a16fa0e5b8a444a578f0b972c35cde7fd0",
        "repo": "flatpak/flatpak",
        "commit_url": "https://github.com/flatpak/flatpak/commit/583cb3a16fa0e5b8a444a578f0b972c35cde7fd0",
        "files": [
          "app/flatpak-cli-transaction.c"
        ],
        "message": "cli-transaction: Escape any special characters in the EOL reason\n\nCVE-2023-28101, GHSA-h43h-fwqx-mpp8\n\nSigned-off-by: Simon McVittie <smcv@collabora.com>",
        "before_after_code_files": [
          "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c"
          ],
          "candidate": [
            "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c"
          ]
        }
      },
      "candidate_diff": {
        "app/flatpak-cli-transaction.c||app/flatpak-cli-transaction.c": [
          "File: app/flatpak-cli-transaction.c -> app/flatpak-cli-transaction.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "755:     }",
          "756:   else if (reason)",
          "757:     {",
          "758:       if (is_pinned)",
          "759:         {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "758:       g_autofree char *escaped_reason = flatpak_escape_string (reason,",
          "759:                                                                FLATPAK_ESCAPE_ALLOW_NEWLINES |",
          "760:                                                                FLATPAK_ESCAPE_DO_NOT_QUOTE);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "770:             g_print (_(\"\\nInfo: app %s%s%s branch %s%s%s is end-of-life, with reason:\\n\"),",
          "771:                      on, ref_name, off, on, ref_branch, off);",
          "772:         }",
          "774:     }",
          "775: }",
          "",
          "[Removed Lines]",
          "773:       g_print (\"   %s\\n\", reason);",
          "",
          "[Added Lines]",
          "776:       g_print (\"   %s\\n\", escaped_reason);",
          "",
          "---------------"
        ]
      }
    }
  ]
}