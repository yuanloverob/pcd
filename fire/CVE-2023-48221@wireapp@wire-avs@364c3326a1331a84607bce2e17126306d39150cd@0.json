{
  "cve_id": "CVE-2023-48221",
  "cve_desc": "wire-avs provides Audio, Visual, and Signaling (AVS) functionality sure the secure messaging software Wire. Prior to versions 9.2.22 and 9.3.5, a remote format string vulnerability could potentially allow an attacker to cause a denial of service or possibly execute arbitrary code. The issue has been fixed in wire-avs 9.2.22 & 9.3.5 and is already included on all Wire products. No known workarounds are available.",
  "repo": "wireapp/wire-avs",
  "patch_hash": "364c3326a1331a84607bce2e17126306d39150cd",
  "patch_info": {
    "commit_hash": "364c3326a1331a84607bce2e17126306d39150cd",
    "repo": "wireapp/wire-avs",
    "commit_url": "https://github.com/wireapp/wire-avs/commit/364c3326a1331a84607bce2e17126306d39150cd",
    "files": [
      "src/sdp/bundle.c"
    ],
    "message": "Merge branch 'release-9.2' into release-9.3",
    "before_after_code_files": [
      "src/sdp/bundle.c||src/sdp/bundle.c"
    ]
  },
  "patch_diff": {
    "src/sdp/bundle.c||src/sdp/bundle.c": [
      "File: src/sdp/bundle.c -> src/sdp/bundle.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "203:  bundle.mid = 0;",
      "204:  bundle.mb = mbuf_alloc(128);",
      "207:  list_flush((struct list *)sdp_session_medial(sess, true));",
      "",
      "[Removed Lines]",
      "205:  mbuf_printf(bundle.mb, sdp_session_rattr(sess, \"group\"));",
      "",
      "[Added Lines]",
      "205:  mbuf_printf(bundle.mb, \"%s\", sdp_session_rattr(sess, \"group\"));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5e82d5636466ca1b02ba8fa411f854b6a1299d4c",
      "candidate_info": {
        "commit_hash": "5e82d5636466ca1b02ba8fa411f854b6a1299d4c",
        "repo": "wireapp/wire-avs",
        "commit_url": "https://github.com/wireapp/wire-avs/commit/5e82d5636466ca1b02ba8fa411f854b6a1299d4c",
        "files": [
          "contrib/openssl",
          "src/sdp/bundle.c"
        ],
        "message": "string fix",
        "before_after_code_files": [
          "src/sdp/bundle.c||src/sdp/bundle.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ],
          "candidate": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ]
        }
      },
      "candidate_diff": {
        "src/sdp/bundle.c||src/sdp/bundle.c": [
          "File: src/sdp/bundle.c -> src/sdp/bundle.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "203:  bundle.mid = 0;",
          "204:  bundle.mb = mbuf_alloc(128);",
          "207:  list_flush((struct list *)sdp_session_medial(sess, true));",
          "",
          "[Removed Lines]",
          "205:  mbuf_printf(bundle.mb, sdp_session_rattr(sess, \"group\"));",
          "",
          "[Added Lines]",
          "205:  mbuf_printf(bundle.mb, \"%s\", sdp_session_rattr(sess, \"group\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e7f393ad5aad2e320e7be5bc1da9321260261baa",
      "candidate_info": {
        "commit_hash": "e7f393ad5aad2e320e7be5bc1da9321260261baa",
        "repo": "wireapp/wire-avs",
        "commit_url": "https://github.com/wireapp/wire-avs/commit/e7f393ad5aad2e320e7be5bc1da9321260261baa",
        "files": [
          "src/sdp/bundle.c"
        ],
        "message": "fix: string issue",
        "before_after_code_files": [
          "src/sdp/bundle.c||src/sdp/bundle.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ],
          "candidate": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ]
        }
      },
      "candidate_diff": {
        "src/sdp/bundle.c||src/sdp/bundle.c": [
          "File: src/sdp/bundle.c -> src/sdp/bundle.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "203:  bundle.mid = 0;",
          "204:  bundle.mb = mbuf_alloc(128);",
          "207:  list_flush((struct list *)sdp_session_medial(sess, true));",
          "",
          "[Removed Lines]",
          "205:  mbuf_printf(bundle.mb, sdp_session_rattr(sess, \"group\"));",
          "",
          "[Added Lines]",
          "205:  mbuf_printf(bundle.mb, \"%s\", sdp_session_rattr(sess, \"group\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "918ee882fc7950aaf19fec501b6e65478c5e8e96",
      "candidate_info": {
        "commit_hash": "918ee882fc7950aaf19fec501b6e65478c5e8e96",
        "repo": "wireapp/wire-avs",
        "commit_url": "https://github.com/wireapp/wire-avs/commit/918ee882fc7950aaf19fec501b6e65478c5e8e96",
        "files": [
          "src/sdp/bundle.c"
        ],
        "message": "string fix",
        "before_after_code_files": [
          "src/sdp/bundle.c||src/sdp/bundle.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ],
          "candidate": [
            "src/sdp/bundle.c||src/sdp/bundle.c"
          ]
        }
      },
      "candidate_diff": {
        "src/sdp/bundle.c||src/sdp/bundle.c": [
          "File: src/sdp/bundle.c -> src/sdp/bundle.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "203:  bundle.mid = 0;",
          "204:  bundle.mb = mbuf_alloc(128);",
          "207:  list_flush((struct list *)sdp_session_medial(sess, true));",
          "",
          "[Removed Lines]",
          "205:  mbuf_printf(bundle.mb, sdp_session_rattr(sess, \"group\"));",
          "",
          "[Added Lines]",
          "205:  mbuf_printf(bundle.mb, \"%s\", sdp_session_rattr(sess, \"group\"));",
          "",
          "---------------"
        ]
      }
    }
  ]
}