{
  "cve_id": "CVE-2015-3138",
  "cve_desc": "print-wb.c in tcpdump before 4.7.4 allows remote attackers to cause a denial of service (segmentation fault and process crash).",
  "repo": "the-tcpdump-group/tcpdump",
  "patch_hash": "3ed82f4ed0095768529afc22b923c8f7171fff70",
  "patch_info": {
    "commit_hash": "3ed82f4ed0095768529afc22b923c8f7171fff70",
    "repo": "the-tcpdump-group/tcpdump",
    "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/3ed82f4ed0095768529afc22b923c8f7171fff70",
    "files": [
      "print-wb.c"
    ],
    "message": "whiteboard: fixup a few reversed tests (GH #446)\n\nThis is a follow-up to commit 3a3ec26.",
    "before_after_code_files": [
      "print-wb.c||print-wb.c"
    ]
  },
  "patch_diff": {
    "print-wb.c||print-wb.c": [
      "File: print-wb.c -> print-wb.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "201:  len -= sizeof(*io) * nid;",
      "202:  io = (struct id_off *)(id + 1);",
      "203:  cp = (char *)(io + nid);",
      "205:   ND_PRINT((ndo, \"\\\"\"));",
      "206:   fn_print(ndo, (u_char *)cp, (u_char *)cp + len);",
      "207:   ND_PRINT((ndo, \"\\\"\"));",
      "",
      "[Removed Lines]",
      "204:  if (!ND_TTEST2(cp, len)) {",
      "",
      "[Added Lines]",
      "204:  if (ND_TTEST2(cp, len)) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "266:  }",
      "267:  n = EXTRACT_32BITS(&prep->pp_n);",
      "268:  ps = (const struct pgstate *)(prep + 1);",
      "270:   const struct id_off *io, *ie;",
      "271:   char c = '<';",
      "",
      "[Removed Lines]",
      "269:  while (--n >= 0 && !ND_TTEST(*ps)) {",
      "",
      "[Added Lines]",
      "269:  while (--n >= 0 && ND_TTEST(*ps)) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "275:       ipaddr_string(ndo, &ps->page.p_sid),",
      "276:       EXTRACT_32BITS(&ps->page.p_uid)));",
      "277:   io = (struct id_off *)(ps + 1);",
      "279:    ND_PRINT((ndo, \"%c%s:%u\", c, ipaddr_string(ndo, &io->id),",
      "280:        EXTRACT_32BITS(&io->off)));",
      "281:    c = ',';",
      "",
      "[Removed Lines]",
      "278:   for (ie = io + ps->nid; io < ie && !ND_TTEST(*io); ++io) {",
      "",
      "[Added Lines]",
      "278:   for (ie = io + ps->nid; io < ie && ND_TTEST(*io); ++io) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8aa5edea1b8846740514dee4158b6c707d38fc13",
      "candidate_info": {
        "commit_hash": "8aa5edea1b8846740514dee4158b6c707d38fc13",
        "repo": "the-tcpdump-group/tcpdump",
        "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/8aa5edea1b8846740514dee4158b6c707d38fc13",
        "files": [
          "print-wb.c"
        ],
        "message": "whiteboard: fixup a few reversed tests (GH #446)\n\nThis is a follow-up to commit 3a3ec26.",
        "before_after_code_files": [
          "print-wb.c||print-wb.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "print-wb.c||print-wb.c"
          ],
          "candidate": [
            "print-wb.c||print-wb.c"
          ]
        }
      },
      "candidate_diff": {
        "print-wb.c||print-wb.c": [
          "File: print-wb.c -> print-wb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "202:  len -= sizeof(*io) * nid;",
          "203:  io = (struct id_off *)(id + 1);",
          "204:  cp = (char *)(io + nid);",
          "206:   ND_PRINT((ndo, \"\\\"\"));",
          "207:   fn_print(ndo, (u_char *)cp, (u_char *)cp + len);",
          "208:   ND_PRINT((ndo, \"\\\"\"));",
          "",
          "[Removed Lines]",
          "205:  if (!ND_TTEST2(cp, len)) {",
          "",
          "[Added Lines]",
          "205:  if (ND_TTEST2(cp, len)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "267:  }",
          "268:  n = EXTRACT_32BITS(&prep->pp_n);",
          "269:  ps = (const struct pgstate *)(prep + 1);",
          "271:   const struct id_off *io, *ie;",
          "272:   char c = '<';",
          "",
          "[Removed Lines]",
          "270:  while (--n >= 0 && !ND_TTEST(*ps)) {",
          "",
          "[Added Lines]",
          "270:  while (--n >= 0 && ND_TTEST(*ps)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "276:       ipaddr_string(ndo, &ps->page.p_sid),",
          "277:       EXTRACT_32BITS(&ps->page.p_uid)));",
          "278:   io = (struct id_off *)(ps + 1);",
          "280:    ND_PRINT((ndo, \"%c%s:%u\", c, ipaddr_string(ndo, &io->id),",
          "281:        EXTRACT_32BITS(&io->off)));",
          "282:    c = ',';",
          "",
          "[Removed Lines]",
          "279:   for (ie = io + ps->nid; io < ie && !ND_TTEST(*io); ++io) {",
          "",
          "[Added Lines]",
          "279:   for (ie = io + ps->nid; io < ie && ND_TTEST(*io); ++io) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}