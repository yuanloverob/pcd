{
  "cve_id": "CVE-2020-9359",
  "cve_desc": "KDE Okular before 1.10.0 allows code execution via an action link in a PDF document.",
  "repo": "kde/okular",
  "patch_hash": "6a93a033b4f9248b3cd4d04689b8391df754e244",
  "patch_info": {
    "commit_hash": "6a93a033b4f9248b3cd4d04689b8391df754e244",
    "repo": "kde/okular",
    "commit_url": "https://invent.kde.org/kde/okular/-/commit/6a93a033b4f9248b3cd4d04689b8391df754e244",
    "files": [
      "core/document.cpp"
    ],
    "message": "Document::processAction: If the url points to a binary, don't run it",
    "before_after_code_files": [
      "core/document.cpp||core/document.cpp"
    ]
  },
  "patch_diff": {
    "core/document.cpp||core/document.cpp": [
      "File: core/document.cpp -> core/document.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "4388:                 {",
      "4389:                     const QUrl realUrl = KIO::upUrl(d->m_url).resolved(url);",
      "4392:                 }",
      "4393:             }",
      "4394:             } break;",
      "",
      "[Removed Lines]",
      "4391:                     new KRun( realUrl, d->m_widget );",
      "",
      "[Added Lines]",
      "4391:                     KRun *r = new KRun( realUrl, d->m_widget );",
      "4392:                     r->setRunExecutables(false);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "50e8c4f33334828cf3cf3b887e39601a097d29af",
      "candidate_info": {
        "commit_hash": "50e8c4f33334828cf3cf3b887e39601a097d29af",
        "repo": "kde/okular",
        "commit_url": "https://github.com/kde/okular/commit/50e8c4f33334828cf3cf3b887e39601a097d29af",
        "files": [
          "core/document.cpp"
        ],
        "message": "Port an occurence of KMimeTypeTrader\n\nIt is about to be deprecated\n\nSee https://phabricator.kde.org/T12177",
        "before_after_code_files": [
          "core/document.cpp||core/document.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "core/document.cpp||core/document.cpp"
          ],
          "candidate": [
            "core/document.cpp||core/document.cpp"
          ]
        }
      },
      "candidate_diff": {
        "core/document.cpp||core/document.cpp": [
          "File: core/document.cpp -> core/document.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "58: #include <KLocalizedString>",
          "59: #include <KMacroExpander>",
          "60: #include <KMessageBox>",
          "62: #include <KPluginMetaData>",
          "63: #include <KProcess>",
          "64: #include <KRun>",
          "",
          "[Removed Lines]",
          "61: #include <KMimeTypeTrader>",
          "",
          "[Added Lines]",
          "61: #include <KApplicationTrader>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3902:             }",
          "3903:         }",
          "3906:         if (ptr) {",
          "3907:             QList<QUrl> lst;",
          "3908:             lst.append(url);",
          "",
          "[Removed Lines]",
          "3905:         KService::Ptr ptr = KMimeTypeTrader::self()->preferredService(mime.name(), QStringLiteral(\"Application\"));",
          "",
          "[Added Lines]",
          "3905:         KService::Ptr ptr = KApplicationTrader::preferredService(mime.name());",
          "",
          "---------------"
        ]
      }
    }
  ]
}