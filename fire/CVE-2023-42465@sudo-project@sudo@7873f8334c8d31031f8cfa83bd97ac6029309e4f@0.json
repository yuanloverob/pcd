{
  "cve_id": "CVE-2023-42465",
  "cve_desc": "Sudo before 1.9.15 might allow row hammer attacks (for authentication bypass or privilege escalation) because application logic sometimes is based on not equaling an error value (instead of equaling a success value), and because the values do not resist flips of a single bit.",
  "repo": "sudo-project/sudo",
  "patch_hash": "7873f8334c8d31031f8cfa83bd97ac6029309e4f",
  "patch_info": {
    "commit_hash": "7873f8334c8d31031f8cfa83bd97ac6029309e4f",
    "repo": "sudo-project/sudo",
    "commit_url": "https://github.com/sudo-project/sudo/commit/7873f8334c8d31031f8cfa83bd97ac6029309e4f",
    "files": [
      "plugins/sudoers/auth/passwd.c",
      "plugins/sudoers/auth/sudo_auth.c",
      "plugins/sudoers/auth/sudo_auth.h",
      "plugins/sudoers/lookup.c",
      "plugins/sudoers/match.c",
      "plugins/sudoers/parse.h"
    ],
    "message": "Try to make sudo less vulnerable to ROWHAMMER attacks.\n\nWe now use ROWHAMMER-resistent values for ALLOW, DENY, AUTH_SUCCESS,\nAUTH_FAILURE, AUTH_ERROR and AUTH_NONINTERACTIVE.  In addition, we\nexplicitly test for expected values instead of using a negated test\nagainst an error value.  In the parser match functions this means\nexplicitly checking for ALLOW or DENY instead of accepting anything\nthat is not set to UNSPEC.\n\nThanks to Andrew J. Adiletta, M. Caner Tol, Yarkin Doroz, and Berk\nSunar, all affiliated with the Vernam Applied Cryptography and\nCybersecurity Lab at Worcester Polytechnic Institute, for the report.\nPaper preprint: https://arxiv.org/abs/2309.02545",
    "before_after_code_files": [
      "plugins/sudoers/auth/passwd.c||plugins/sudoers/auth/passwd.c",
      "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c",
      "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h",
      "plugins/sudoers/lookup.c||plugins/sudoers/lookup.c",
      "plugins/sudoers/match.c||plugins/sudoers/match.c",
      "plugins/sudoers/parse.h||plugins/sudoers/parse.h"
    ]
  },
  "patch_diff": {
    "plugins/sudoers/auth/passwd.c||plugins/sudoers/auth/passwd.c": [
      "File: plugins/sudoers/auth/passwd.c -> plugins/sudoers/auth/passwd.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "68:     char des_pass[9], *epass;",
      "69:     char *pw_epasswd = auth->data;",
      "70:     size_t pw_len;",
      "72:     debug_decl(sudo_passwd_verify, SUDOERS_DEBUG_AUTH);",
      "",
      "[Removed Lines]",
      "71:     int matched = 0;",
      "",
      "[Added Lines]",
      "71:     int ret;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "81:     pw_len = strlen(pw_epasswd);",
      "82:     if (pw_len == DESLEN || HAS_AGEINFO(pw_epasswd, pw_len)) {",
      "84:  pass = des_pass;",
      "85:     }",
      "",
      "[Removed Lines]",
      "83:  strlcpy(des_pass, pass, sizeof(des_pass));",
      "",
      "[Added Lines]",
      "83:  (void)strlcpy(des_pass, pass, sizeof(des_pass));",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "92:     epass = (char *) crypt(pass, pw_epasswd);",
      "93:     if (epass != NULL) {",
      "98:     }",
      "100:     explicit_bzero(des_pass, sizeof(des_pass));",
      "103: }",
      "104: #else",
      "105: int",
      "",
      "[Removed Lines]",
      "94:  if (HAS_AGEINFO(pw_epasswd, pw_len) && strlen(epass) == DESLEN)",
      "95:      matched = !strncmp(pw_epasswd, epass, DESLEN);",
      "96:  else",
      "97:      matched = !strcmp(pw_epasswd, epass);",
      "102:     debug_return_int(matched ? AUTH_SUCCESS : AUTH_FAILURE);",
      "",
      "[Added Lines]",
      "93:     ret = AUTH_FAILURE;",
      "95:  if (HAS_AGEINFO(pw_epasswd, pw_len) && strlen(epass) == DESLEN) {",
      "96:      if (strncmp(pw_epasswd, epass, DESLEN) == 0)",
      "97:   ret = AUTH_SUCCESS;",
      "98:  } else {",
      "99:      if (strcmp(pw_epasswd, epass) == 0)",
      "100:   ret = AUTH_SUCCESS;",
      "101:  }",
      "106:     debug_return_int(ret);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "107:     const char *pass, sudo_auth *auth, struct sudo_conv_callback *callback)",
      "108: {",
      "109:     char *pw_passwd = auth->data;",
      "111:     debug_decl(sudo_passwd_verify, SUDOERS_DEBUG_AUTH);",
      "117: }",
      "118: #endif",
      "",
      "[Removed Lines]",
      "110:     int matched;",
      "114:     matched = !strcmp(pass, pw_passwd);",
      "116:     debug_return_int(matched ? AUTH_SUCCESS : AUTH_FAILURE);",
      "",
      "[Added Lines]",
      "114:     int ret;",
      "118:     if (strcmp(pass, pw_passwd) == 0)",
      "119:  ret = AUTH_SUCCESS;",
      "120:     else",
      "121:  ret = AUTH_FAILURE;",
      "123:     debug_return_int(ret);",
      "",
      "---------------"
    ],
    "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c": [
      "File: plugins/sudoers/auth/sudo_auth.c -> plugins/sudoers/auth/sudo_auth.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "116:  if (auth->init && !IS_DISABLED(auth)) {",
      "118:      status = (auth->init)(ctx, pw, auth);",
      "120:   SET(auth->flags, FLAG_DISABLED);",
      "123:  }",
      "124:     }",
      "",
      "[Removed Lines]",
      "119:      if (status == AUTH_FAILURE)",
      "121:      else if (status == AUTH_ERROR)",
      "",
      "[Added Lines]",
      "119:      switch (status) {",
      "120:      case AUTH_SUCCESS:",
      "121:   break;",
      "122:      case AUTH_FAILURE:",
      "124:   break;",
      "125:      default:",
      "127:   debug_return_int(-1);",
      "128:      }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "166:  }",
      "167:     }",
      "170: }",
      "",
      "[Removed Lines]",
      "169:     debug_return_int(status == AUTH_ERROR ? -1 : 0);",
      "",
      "[Added Lines]",
      "175:     debug_return_int(0);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "209:     for (auth = auth_switch; auth->name; auth++) {",
      "210:  if (auth->cleanup && !IS_DISABLED(auth)) {",
      "211:      int status = (auth->cleanup)(ctx, pw, auth, force);",
      "214:   debug_return_int(-1);",
      "215:      }",
      "",
      "[Removed Lines]",
      "212:      if (status == AUTH_ERROR) {",
      "",
      "[Added Lines]",
      "218:      if (status != AUTH_SUCCESS) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "306:       SET(auth->flags, FLAG_DISABLED);",
      "307:   else if (status == AUTH_NONINTERACTIVE)",
      "308:       goto done;",
      "311:      }",
      "312:  }",
      "",
      "[Removed Lines]",
      "309:   else if (status == AUTH_ERROR || user_interrupted())",
      "",
      "[Added Lines]",
      "315:   else if (status != AUTH_SUCCESS || user_interrupted())",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "365:  case AUTH_NONINTERACTIVE:",
      "366:      SET(validated, FLAG_NO_USER_INPUT);",
      "367:      FALLTHROUGH;",
      "369:  default:",
      "370:      log_auth_failure(ctx, validated, 0);",
      "371:      ret = -1;",
      "",
      "[Removed Lines]",
      "368:  case AUTH_ERROR:",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "382: int",
      "383: sudo_auth_begin_session(const struct sudoers_context *ctx, struct passwd *pw,",
      "384:     char **user_env[])",
      "385: {",
      "386:     sudo_auth *auth;",
      "387:     debug_decl(sudo_auth_begin_session, SUDOERS_DEBUG_AUTH);",
      "389:     for (auth = auth_switch; auth->name; auth++) {",
      "390:  if (auth->begin_session && !IS_DISABLED(auth)) {",
      "391:      int status = (auth->begin_session)(ctx, pw, user_env, auth);",
      "395:      }",
      "396:  }",
      "397:     }",
      "399: }",
      "401: bool",
      "",
      "[Removed Lines]",
      "392:      if (status != AUTH_SUCCESS) {",
      "394:   debug_return_int(-1);",
      "398:     debug_return_int(1);",
      "",
      "[Added Lines]",
      "392:     int ret = true;",
      "398:      switch (status) {",
      "399:      case AUTH_SUCCESS:",
      "400:   break;",
      "401:      case AUTH_FAILURE:",
      "402:   ret = false;",
      "403:   break;",
      "404:      default:",
      "406:   ret = -1;",
      "407:   break;",
      "411:     debug_return_int(ret);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "421: int",
      "422: sudo_auth_end_session(void)",
      "423: {",
      "424:     sudo_auth *auth;",
      "425:     int status;",
      "426:     debug_decl(sudo_auth_end_session, SUDOERS_DEBUG_AUTH);",
      "428:     for (auth = auth_switch; auth->name; auth++) {",
      "429:  if (auth->end_session && !IS_DISABLED(auth)) {",
      "430:      status = (auth->end_session)(auth);",
      "434:      }",
      "435:  }",
      "436:     }",
      "438: }",
      "",
      "[Removed Lines]",
      "431:      if (status == AUTH_ERROR) {",
      "433:   debug_return_int(-1);",
      "437:     debug_return_int(1);",
      "",
      "[Added Lines]",
      "438:     int ret = true;",
      "445:      switch (status) {",
      "446:      case AUTH_SUCCESS:",
      "447:   break;",
      "448:      case AUTH_FAILURE:",
      "449:   ret = false;",
      "450:   break;",
      "451:      default:",
      "453:   ret = -1;",
      "454:   break;",
      "458:     debug_return_int(ret);",
      "",
      "---------------"
    ],
    "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h": [
      "File: plugins/sudoers/auth/sudo_auth.h -> plugins/sudoers/auth/sudo_auth.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: #ifndef SUDO_AUTH_H",
      "20: #define SUDO_AUTH_H",
      "29: typedef struct sudo_auth {",
      "",
      "[Removed Lines]",
      "23: #define AUTH_SUCCESS  0",
      "24: #define AUTH_FAILURE  1",
      "25: #define AUTH_INTR  2",
      "26: #define AUTH_ERROR  3",
      "27: #define AUTH_NONINTERACTIVE 4",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "plugins/sudoers/lookup.c||plugins/sudoers/lookup.c": [
      "File: plugins/sudoers/lookup.c -> plugins/sudoers/lookup.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "100:      int user_match = userlist_matches(nss->parse_tree, ctx->user.pw,",
      "101:   &us->users);",
      "102:      if (user_match != ALLOW) {",
      "104:       callback(nss->parse_tree, us, user_match, NULL, UNSPEC,",
      "105:    NULL, UNSPEC, UNSPEC, UNSPEC, cb_data);",
      "106:   }",
      "",
      "[Removed Lines]",
      "103:   if (callback != NULL && user_match != UNSPEC) {",
      "",
      "[Added Lines]",
      "103:   if (callback != NULL && user_match == DENY) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "189:        host_match, cs, date_match, runas_match,",
      "190:        cmnd_match, cb_data);",
      "191:       }",
      "",
      "[Removed Lines]",
      "192:       if (cmnd_match != UNSPEC) {",
      "",
      "[Added Lines]",
      "192:       if (SPECIFIED(cmnd_match)) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "245:     TAILQ_FOREACH_REVERSE(us, &nss->parse_tree->userspecs, userspec_list, entries) {",
      "246:  int user_match = userlist_matches(nss->parse_tree, ctx->user.pw, &us->users);",
      "247:  if (user_match != ALLOW) {",
      "249:   callback(nss->parse_tree, us, user_match, NULL, UNSPEC, NULL,",
      "250:       UNSPEC, UNSPEC, UNSPEC, cb_data);",
      "251:      }",
      "",
      "[Removed Lines]",
      "248:      if (callback != NULL && user_match != UNSPEC) {",
      "",
      "[Added Lines]",
      "248:      if (callback != NULL && user_match == DENY) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "290:    cs, date_match, runas_match, cmnd_match, cb_data);",
      "291:   }",
      "",
      "[Removed Lines]",
      "293:   if (cmnd_match != UNSPEC) {",
      "",
      "[Added Lines]",
      "293:   if (SPECIFIED(cmnd_match)) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "543:  m = sudoers_lookup_check(nss, ctx, &validated, &info, now, callback,",
      "544:      cb_data, &cs, &defs);",
      "546:      match = m;",
      "547:      parse_tree = nss->parse_tree;",
      "548:  }",
      "",
      "[Removed Lines]",
      "545:  if (m != UNSPEC) {",
      "",
      "[Added Lines]",
      "545:  if (SPECIFIED(m)) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "550:  if (!sudo_nss_can_continue(nss, m))",
      "551:      break;",
      "552:     }",
      "554:  if (info.cmnd_path != NULL) {",
      "556:      free(ctx->user.cmnd);",
      "",
      "[Removed Lines]",
      "553:     if (match != UNSPEC) {",
      "",
      "[Added Lines]",
      "553:     if (SPECIFIED(match)) {",
      "",
      "---------------"
    ],
    "plugins/sudoers/match.c||plugins/sudoers/match.c": [
      "File: plugins/sudoers/match.c -> plugins/sudoers/match.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "91:      if ((a = alias_get(parse_tree, m->name, USERALIAS)) != NULL) {",
      "93:   const int rc = userlist_matches(parse_tree, pw, &a->members);",
      "95:       if (m->negated) {",
      "96:    matched = rc == ALLOW ? DENY : ALLOW;",
      "97:       } else {",
      "",
      "[Removed Lines]",
      "94:   if (rc != UNSPEC) {",
      "",
      "[Added Lines]",
      "94:   if (SPECIFIED(rc)) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "123:     debug_decl(userlist_matches, SUDOERS_DEBUG_MATCH);",
      "125:     TAILQ_FOREACH_REVERSE(m, list, member_list, entries) {",
      "127:      break;",
      "128:     }",
      "129:     debug_return_int(matched);",
      "",
      "[Removed Lines]",
      "126:  if ((matched = user_matches(parse_tree, pw, m)) != UNSPEC)",
      "",
      "[Added Lines]",
      "126:  matched = user_matches(parse_tree, pw, m);",
      "127:  if (SPECIFIED(matched))",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "184:   if (a != NULL) {",
      "185:       const int rc = runas_userlist_matches(parse_tree,",
      "186:    &a->members, matching_user);",
      "188:    if (m->negated) {",
      "189:        user_matched = rc == ALLOW ? DENY : ALLOW;",
      "190:    } else {",
      "",
      "[Removed Lines]",
      "187:       if (rc != UNSPEC) {",
      "",
      "[Added Lines]",
      "188:       if (SPECIFIED(rc)) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "211:       user_matched = m->negated ? DENY : ALLOW;",
      "212:   break;",
      "213:  }",
      "215:      if (matching_user != NULL && m->type != ALIAS)",
      "217:      break;",
      "",
      "[Removed Lines]",
      "214:  if (user_matched != UNSPEC) {",
      "",
      "[Added Lines]",
      "215:  if (SPECIFIED(user_matched)) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "246:       if (a != NULL) {",
      "247:    const int rc = runas_grouplist_matches(parse_tree,",
      "248:        &a->members, matching_group);",
      "250:        if (m->negated) {",
      "251:     group_matched = rc == ALLOW ? DENY : ALLOW;",
      "252:        } else {",
      "",
      "[Removed Lines]",
      "249:    if (rc != UNSPEC) {",
      "",
      "[Added Lines]",
      "250:    if (SPECIFIED(rc)) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "262:    group_matched = m->negated ? DENY : ALLOW;",
      "263:       break;",
      "264:      }",
      "266:   if (matching_group != NULL && m->type != ALIAS)",
      "268:   break;",
      "269:      }",
      "270:  }",
      "271:     }",
      "273:  struct gid_list *runas_groups;",
      "",
      "[Removed Lines]",
      "265:      if (group_matched != UNSPEC) {",
      "272:     if (group_matched == UNSPEC) {",
      "",
      "[Added Lines]",
      "266:      if (SPECIFIED(group_matched)) {",
      "273:     if (!SPECIFIED(group_matched)) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "350:     TAILQ_FOREACH_REVERSE(m, list, member_list, entries) {",
      "351:  matched = host_matches(parse_tree, pw, lhost, shost, m);",
      "353:      break;",
      "354:     }",
      "355:     debug_return_int(matched);",
      "",
      "[Removed Lines]",
      "352:  if (matched != UNSPEC)",
      "",
      "[Added Lines]",
      "353:  if (SPECIFIED(matched))",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "403:   const int rc = hostlist_matches_int(parse_tree, pw, lhost,",
      "404:       shost, &a->members);",
      "406:       if (m->negated) {",
      "407:    matched = rc == ALLOW ? DENY : ALLOW;",
      "408:       } else {",
      "",
      "[Removed Lines]",
      "405:   if (rc != UNSPEC) {",
      "",
      "[Added Lines]",
      "406:   if (SPECIFIED(rc)) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "441:     TAILQ_FOREACH_REVERSE(m, list, member_list, entries) {",
      "442:  matched = cmnd_matches(parse_tree, m, runchroot, info);",
      "444:      break;",
      "445:     }",
      "446:     debug_return_int(matched);",
      "",
      "[Removed Lines]",
      "443:  if (matched != UNSPEC)",
      "",
      "[Added Lines]",
      "444:  if (SPECIFIED(matched))",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "471:      a = alias_get(parse_tree, m->name, CMNDALIAS);",
      "472:      if (a != NULL) {",
      "473:   rc = cmndlist_matches(parse_tree, &a->members, runchroot, info);",
      "475:       if (m->negated) {",
      "476:    matched = rc == ALLOW ? DENY : ALLOW;",
      "477:       } else {",
      "",
      "[Removed Lines]",
      "474:   if (rc != UNSPEC) {",
      "",
      "[Added Lines]",
      "475:   if (SPECIFIED(rc)) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "511:      if (a != NULL) {",
      "512:   TAILQ_FOREACH_REVERSE(m, &a->members, member_list, entries) {",
      "513:       matched = cmnd_matches_all(parse_tree, m, runchroot, info);",
      "515:    if (negated)",
      "516:        matched = matched == ALLOW ? DENY : ALLOW;",
      "517:    break;",
      "",
      "[Removed Lines]",
      "514:       if (matched != UNSPEC) {",
      "",
      "[Added Lines]",
      "515:       if (SPECIFIED(matched)) {",
      "",
      "---------------"
    ],
    "plugins/sudoers/parse.h||plugins/sudoers/parse.h": [
      "File: plugins/sudoers/parse.h -> plugins/sudoers/parse.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "36: # define SUDOERS_NAME_MATCH",
      "37: #endif",
      "39: #undef UNSPEC",
      "40: #define UNSPEC -1",
      "45: #undef IMPLIED",
      "46: #define IMPLIED  2",
      "",
      "[Removed Lines]",
      "41: #undef DENY",
      "42: #define DENY  0",
      "43: #undef ALLOW",
      "44: #define ALLOW  1",
      "",
      "[Added Lines]",
      "40: #undef ALLOW",
      "44: #undef DENY",
      "59: #define SPECIFIED(_v) ((_v) == ALLOW || (_v) == DENY)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "96: #define TAG_SET(tt) \\",
      "",
      "[Removed Lines]",
      "97:     ((tt) != UNSPEC && (tt) != IMPLIED)",
      "",
      "[Added Lines]",
      "110:     ((tt) == true || (tt) == false)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0495afac57f5bd783dd90bfaa25733f802b0f66f",
      "candidate_info": {
        "commit_hash": "0495afac57f5bd783dd90bfaa25733f802b0f66f",
        "repo": "sudo-project/sudo",
        "commit_url": "https://github.com/sudo-project/sudo/commit/0495afac57f5bd783dd90bfaa25733f802b0f66f",
        "files": [
          "plugins/sudoers/Makefile.in",
          "plugins/sudoers/auth/sudo_auth.c",
          "plugins/sudoers/auth/sudo_auth.h",
          "plugins/sudoers/check.c",
          "plugins/sudoers/timestamp.h"
        ],
        "message": "Make most sudo_auth functions return AUTH_{SUCCESS,FAILURE,FATAL}.",
        "before_after_code_files": [
          "plugins/sudoers/Makefile.in||plugins/sudoers/Makefile.in",
          "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c",
          "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h",
          "plugins/sudoers/check.c||plugins/sudoers/check.c",
          "plugins/sudoers/timestamp.h||plugins/sudoers/timestamp.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c",
            "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h"
          ],
          "candidate": [
            "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c",
            "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h"
          ]
        }
      },
      "candidate_diff": {
        "plugins/sudoers/Makefile.in||plugins/sudoers/Makefile.in": [
          "File: plugins/sudoers/Makefile.in -> plugins/sudoers/Makefile.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "719:         $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "720:         $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "721:         $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "726:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(authdir)/afs.c",
          "727: afs.i: $(authdir)/afs.c $(authdir)/sudo_auth.h $(devdir)/def_data.h \\",
          "728:         $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "729:         $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "730:         $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "731:         $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "736:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "737: afs.plog: afs.i",
          "738:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(authdir)/afs.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "722:         $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "723:         $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "724:         $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "725:         $(top_builddir)/pathnames.h",
          "732:         $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "733:         $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "734:         $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "735:         $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "722:         $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "723:         $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "724:         $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "725:         $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "732:         $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "733:         $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "734:         $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "735:         $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "929:               $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "930:               $(incdir)/sudo_iolog.h $(incdir)/sudo_plugin.h \\",
          "931:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "936:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/callbacks.c",
          "937: callbacks.i: $(srcdir)/callbacks.c $(devdir)/def_data.h \\",
          "938:               $(incdir)/compat/getaddrinfo.h $(incdir)/compat/stdbool.h \\",
          "",
          "[Removed Lines]",
          "932:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "933:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "934:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "935:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "932:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "933:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "934:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "935:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "936:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "941:               $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "942:               $(incdir)/sudo_iolog.h $(incdir)/sudo_plugin.h \\",
          "943:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "948:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "949: callbacks.plog: callbacks.i",
          "950:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(srcdir)/callbacks.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "944:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "945:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "946:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "947:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "945:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "946:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "947:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "948:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "949:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "976:           $(incdir)/sudo_compat.h $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h \\",
          "977:           $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "978:           $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "982:           $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "983:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/check.c",
          "984: check.i: $(srcdir)/check.c $(devdir)/def_data.h $(incdir)/compat/stdbool.h \\",
          "985:           $(incdir)/sudo_compat.h $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h \\",
          "986:           $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "987:           $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "991:           $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "992:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "993: check.plog: check.i",
          "",
          "[Removed Lines]",
          "979:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "980:           $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "981:           $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "988:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "989:           $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "990:           $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "",
          "[Added Lines]",
          "981:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "982:           $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "983:           $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "984:           $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "991:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "992:           $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "993:           $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "994:           $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1227: check_starttime.o: $(srcdir)/regress/starttime/check_starttime.c \\",
          "1228:                    $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "1229:                    $(incdir)/sudo_fatal.h $(incdir)/sudo_plugin.h \\",
          "1232:  $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/regress/starttime/check_starttime.c",
          "1233: check_starttime.i: $(srcdir)/regress/starttime/check_starttime.c \\",
          "1234:                    $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "1235:                    $(incdir)/sudo_fatal.h $(incdir)/sudo_plugin.h \\",
          "1238:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "1239: check_starttime.plog: check_starttime.i",
          "1240:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(srcdir)/regress/starttime/check_starttime.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "1230:                    $(incdir)/sudo_util.h $(srcdir)/timestamp.h \\",
          "1231:                    $(top_builddir)/config.h",
          "1236:                    $(incdir)/sudo_util.h $(srcdir)/timestamp.h \\",
          "1237:                    $(top_builddir)/config.h",
          "",
          "[Added Lines]",
          "1234:                    $(incdir)/sudo_util.h $(srcdir)/auth/sudo_auth.h \\",
          "1235:                    $(srcdir)/timestamp.h $(top_builddir)/config.h",
          "1240:                    $(incdir)/sudo_util.h $(srcdir)/auth/sudo_auth.h \\",
          "1241:                    $(srcdir)/timestamp.h $(top_builddir)/config.h",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1473:         $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "1474:         $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "1475:         $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "1480:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(authdir)/dce.c",
          "1481: dce.i: $(authdir)/dce.c $(authdir)/sudo_auth.h $(devdir)/def_data.h \\",
          "1482:         $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "1483:         $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "1484:         $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "1485:         $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "1490:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "1491: dce.plog: dce.i",
          "1492:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(authdir)/dce.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "1476:         $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "1477:         $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "1478:         $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "1479:         $(top_builddir)/pathnames.h",
          "1486:         $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "1487:         $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "1488:         $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "1489:         $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "1480:         $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "1481:         $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "1482:         $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "1483:         $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "1490:         $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "1491:         $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "1492:         $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "1493:         $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1796:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "1797:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "1798:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "1801:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "1802:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "1803:  $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/regress/fuzz/fuzz_stubs.c",
          "",
          "[Removed Lines]",
          "1799:               $(srcdir)/defaults.h $(srcdir)/interfaces.h $(srcdir)/logging.h \\",
          "1800:               $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "",
          "[Added Lines]",
          "1803:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "1804:               $(srcdir)/interfaces.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "1805:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1807:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "1808:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "1809:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "1812:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "1813:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "1814:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "",
          "[Removed Lines]",
          "1810:               $(srcdir)/defaults.h $(srcdir)/interfaces.h $(srcdir)/logging.h \\",
          "1811:               $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "",
          "[Added Lines]",
          "1815:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "1816:               $(srcdir)/interfaces.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "1817:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2754:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "2755:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "2756:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "2761:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/set_perms.c",
          "2762: set_perms.i: $(srcdir)/set_perms.c $(devdir)/def_data.h \\",
          "2763:               $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "",
          "[Removed Lines]",
          "2757:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "2758:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "2759:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "2760:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "2763:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "2764:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "2765:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "2766:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "2767:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "2765:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "2766:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "2767:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "2772:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "2773: set_perms.plog: set_perms.i",
          "2774:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(srcdir)/set_perms.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "2768:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "2769:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "2770:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "2771:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "2775:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "2776:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "2777:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "2778:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "2779:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2866:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "2867:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "2868:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "2873:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/starttime.c",
          "2874: starttime.i: $(srcdir)/starttime.c $(devdir)/def_data.h \\",
          "2875:               $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "",
          "[Removed Lines]",
          "2869:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "2870:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "2871:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "2872:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "2877:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "2878:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "2879:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "2880:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "2881:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2877:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "2878:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "2879:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "2884:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "2885: starttime.plog: starttime.i",
          "2886:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(srcdir)/starttime.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "2880:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "2881:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "2882:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "2883:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "2889:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "2890:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "2891:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "2892:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "2893:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "2972:               $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "2973:               $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "2974:               $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h \\",
          "2976:               $(srcdir)/ins_2001.h $(srcdir)/ins_classic.h \\",
          "2977:               $(srcdir)/ins_csops.h $(srcdir)/ins_goons.h \\",
          "2978:               $(srcdir)/ins_python.h $(srcdir)/insults.h $(srcdir)/logging.h \\",
          "",
          "[Removed Lines]",
          "2975:               $(incdir)/sudo_rand.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "",
          "[Added Lines]",
          "2985:               $(incdir)/sudo_rand.h $(incdir)/sudo_util.h \\",
          "2986:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "2986:               $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "2987:               $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "2988:               $(incdir)/sudo_plugin.h $(incdir)/sudo_queue.h \\",
          "2990:               $(srcdir)/ins_2001.h $(srcdir)/ins_classic.h \\",
          "2991:               $(srcdir)/ins_csops.h $(srcdir)/ins_goons.h \\",
          "2992:               $(srcdir)/ins_python.h $(srcdir)/insults.h $(srcdir)/logging.h \\",
          "",
          "[Removed Lines]",
          "2989:               $(incdir)/sudo_rand.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "",
          "[Added Lines]",
          "3000:               $(incdir)/sudo_rand.h $(incdir)/sudo_util.h \\",
          "3001:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3036:             $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "3037:             $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "3038:             $(incdir)/sudo_iolog.h $(incdir)/sudo_plugin.h \\",
          "3040:             $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3041:             $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "3042:             $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "",
          "[Removed Lines]",
          "3039:             $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "",
          "[Added Lines]",
          "3051:             $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3052:             $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3048:             $(incdir)/sudo_debug.h $(incdir)/sudo_eventlog.h \\",
          "3049:             $(incdir)/sudo_fatal.h $(incdir)/sudo_gettext.h \\",
          "3050:             $(incdir)/sudo_iolog.h $(incdir)/sudo_plugin.h \\",
          "3052:             $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3053:             $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "3054:             $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "",
          "[Removed Lines]",
          "3051:             $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "",
          "[Added Lines]",
          "3064:             $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3065:             $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3224:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "3225:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "3226:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3231:  $(LIBTOOL) $(LTFLAGS) --mode=compile $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/timestamp.c",
          "3232: timestamp.i: $(srcdir)/timestamp.c $(devdir)/def_data.h \\",
          "3233:               $(incdir)/compat/stdbool.h $(incdir)/sudo_compat.h \\",
          "",
          "[Removed Lines]",
          "3227:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "3228:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "3229:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "3230:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "3241:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "3242:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3243:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "3244:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "3245:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3235:               $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "3236:               $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "3237:               $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3242:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "3243: timestamp.plog: timestamp.i",
          "3244:  rm -f $@; pvs-studio --cfg $(PVS_CFG) --sourcetree-root $(top_srcdir) --skip-cl-exe yes --source-file $(srcdir)/timestamp.c --i-file $< --output-file $@",
          "",
          "[Removed Lines]",
          "3238:               $(srcdir)/defaults.h $(srcdir)/logging.h $(srcdir)/parse.h \\",
          "3239:               $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "3240:               $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "3241:               $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "",
          "[Added Lines]",
          "3253:               $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h \\",
          "3254:               $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3255:               $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h \\",
          "3256:               $(srcdir)/timestamp.h $(top_builddir)/config.h \\",
          "3257:               $(top_builddir)/pathnames.h",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "3314:           $(incdir)/sudo_compat.h $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h \\",
          "3315:           $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "3316:           $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "3320:           $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "3321:  $(CC) -c $(CPPFLAGS) $(CFLAGS) $(ASAN_CFLAGS) $(PIE_CFLAGS) $(HARDENING_CFLAGS) $(srcdir)/tsdump.c",
          "3322: tsdump.i: $(srcdir)/tsdump.c $(devdir)/def_data.h $(incdir)/compat/stdbool.h \\",
          "3323:           $(incdir)/sudo_compat.h $(incdir)/sudo_conf.h $(incdir)/sudo_debug.h \\",
          "3324:           $(incdir)/sudo_eventlog.h $(incdir)/sudo_fatal.h \\",
          "3325:           $(incdir)/sudo_gettext.h $(incdir)/sudo_plugin.h \\",
          "3329:           $(top_builddir)/config.h $(top_builddir)/pathnames.h",
          "3330:  $(CC) -E -o $@ $(CPPFLAGS) $<",
          "3331: tsdump.plog: tsdump.i",
          "",
          "[Removed Lines]",
          "3317:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "3318:           $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3319:           $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "3326:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h $(srcdir)/defaults.h \\",
          "3327:           $(srcdir)/logging.h $(srcdir)/parse.h $(srcdir)/sudo_nss.h \\",
          "3328:           $(srcdir)/sudoers.h $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "",
          "[Added Lines]",
          "3333:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3334:           $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "3335:           $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "3336:           $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "3343:           $(incdir)/sudo_queue.h $(incdir)/sudo_util.h \\",
          "3344:           $(srcdir)/auth/sudo_auth.h $(srcdir)/defaults.h $(srcdir)/logging.h \\",
          "3345:           $(srcdir)/parse.h $(srcdir)/sudo_nss.h $(srcdir)/sudoers.h \\",
          "3346:           $(srcdir)/sudoers_debug.h $(srcdir)/timestamp.h \\",
          "",
          "---------------"
        ],
        "plugins/sudoers/auth/sudo_auth.c||plugins/sudoers/auth/sudo_auth.c": [
          "File: plugins/sudoers/auth/sudo_auth.c -> plugins/sudoers/auth/sudo_auth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "101: int",
          "102: sudo_auth_init(const struct sudoers_context *ctx, struct passwd *pw,",
          "103:     unsigned int mode)",
          "104: {",
          "105:     sudo_auth *auth;",
          "107:     debug_decl(sudo_auth_init, SUDOERS_DEBUG_AUTH);",
          "109:     if (auth_switch[0].name == NULL)",
          "113:     for (auth = auth_switch; auth->name; auth++) {",
          "",
          "[Removed Lines]",
          "106:     int status = AUTH_SUCCESS;",
          "110:  debug_return_int(0);",
          "",
          "[Added Lines]",
          "109:  debug_return_int(AUTH_SUCCESS);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "115:      SET(auth->flags, FLAG_NONINTERACTIVE);",
          "116:  if (auth->init && !IS_DISABLED(auth)) {",
          "120:      case AUTH_SUCCESS:",
          "121:   break;",
          "122:      case AUTH_FAILURE:",
          "",
          "[Removed Lines]",
          "118:      status = (auth->init)(ctx, pw, auth);",
          "119:      switch (status) {",
          "",
          "[Added Lines]",
          "117:      switch ((auth->init)(ctx, pw, auth)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124:   break;",
          "125:      default:",
          "128:      }",
          "129:  }",
          "130:     }",
          "",
          "[Removed Lines]",
          "127:   debug_return_int(-1);",
          "",
          "[Added Lines]",
          "125:   debug_return_int(AUTH_ERROR);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "144:   log_warningx(ctx, SLOG_SEND_MAIL,",
          "145:       N_(\"Invalid authentication methods compiled into sudo!  \"",
          "146:       \"You may not mix standalone and non-standalone authentication.\"));",
          "148:      }",
          "149:      if (!found) {",
          "",
          "[Removed Lines]",
          "147:   debug_return_int(-1);",
          "",
          "[Added Lines]",
          "145:   debug_return_int(AUTH_ERROR);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "172:  }",
          "173:     }",
          "176: }",
          "182: int",
          "183: sudo_auth_approval(const struct sudoers_context *ctx, struct passwd *pw,",
          "184:     unsigned int validated, bool exempt)",
          "185: {",
          "186:     sudo_auth *auth;",
          "187:     debug_decl(sudo_auth_approval, SUDOERS_DEBUG_AUTH);",
          "190:     for (auth = auth_switch; auth->name; auth++) {",
          "191:  if (auth->approval && !IS_DISABLED(auth)) {",
          "195:   log_auth_failure(ctx, validated, 0);",
          "197:      }",
          "198:  }",
          "199:     }",
          "201: }",
          "207: int",
          "208: sudo_auth_cleanup(const struct sudoers_context *ctx, struct passwd *pw,",
          "",
          "[Removed Lines]",
          "175:     debug_return_int(0);",
          "192:      int status = (auth->approval)(ctx, pw, auth, exempt);",
          "193:      if (status != AUTH_SUCCESS) {",
          "196:   debug_return_int(status == AUTH_FAILURE ? false : -1);",
          "200:     debug_return_int(true);",
          "",
          "[Added Lines]",
          "173:     debug_return_int(AUTH_SUCCESS);",
          "184:     int ret = AUTH_SUCCESS;",
          "191:      ret = (auth->approval)(ctx, pw, auth, exempt);",
          "192:      if (ret != AUTH_SUCCESS) {",
          "195:   break;",
          "199:     debug_return_int(ret);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "217:      int status = (auth->cleanup)(ctx, pw, auth, force);",
          "218:      if (status != AUTH_SUCCESS) {",
          "221:      }",
          "222:  }",
          "223:     }",
          "225: }",
          "227: static void",
          "",
          "[Removed Lines]",
          "220:   debug_return_int(-1);",
          "224:     debug_return_int(0);",
          "",
          "[Added Lines]",
          "219:   debug_return_int(AUTH_ERROR);",
          "223:     debug_return_int(AUTH_SUCCESS);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "255: int",
          "256: verify_user(const struct sudoers_context *ctx, struct passwd *pw, char *prompt,",
          "257:     unsigned int validated, struct sudo_conv_callback *callback)",
          "258: {",
          "259:     unsigned int ntries;",
          "262:     sigset_t mask, omask;",
          "264:     debug_decl(verify_user, SUDOERS_DEBUG_AUTH);",
          "",
          "[Removed Lines]",
          "260:     int ret, status, success = AUTH_FAILURE;",
          "261:     sudo_auth *auth;",
          "263:     struct sigaction sa, saved_sigtstp;",
          "",
          "[Added Lines]",
          "258:     struct sigaction sa, saved_sigtstp;",
          "259:     int ret = AUTH_FAILURE;",
          "262:     sudo_auth *auth;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "270:      N_(\"There are no authentication methods compiled into sudo!  \"",
          "271:      \"If you want to turn off authentication, use the \"",
          "272:      \"--disable-authentication configure option.\"));",
          "274:     }",
          "",
          "[Removed Lines]",
          "273:  debug_return_int(-1);",
          "",
          "[Added Lines]",
          "272:  debug_return_int(AUTH_ERROR);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "307:   continue;",
          "308:      num_methods++;",
          "309:      if (auth->setup != NULL) {",
          "312:       SET(auth->flags, FLAG_DISABLED);",
          "314:       goto done;",
          "317:      }",
          "318:  }",
          "319:  if (num_methods == 0) {",
          "",
          "[Removed Lines]",
          "310:   status = (auth->setup)(ctx, pw, &prompt, auth);",
          "311:   if (status == AUTH_FAILURE)",
          "313:   else if (status == AUTH_NONINTERACTIVE)",
          "315:   else if (status != AUTH_SUCCESS || user_interrupted())",
          "",
          "[Added Lines]",
          "309:   switch ((auth->setup)(ctx, pw, &prompt, auth)) {",
          "310:   case AUTH_SUCCESS:",
          "311:       if (user_interrupted())",
          "313:       break;",
          "314:   case AUTH_FAILURE:",
          "316:       break;",
          "317:   case AUTH_NONINTERACTIVE:",
          "319:       goto done;",
          "320:   default:",
          "321:       ret = AUTH_ERROR;",
          "323:   }",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "321:   N_(\"no authentication methods\"));",
          "322:      log_warningx(ctx, SLOG_SEND_MAIL,",
          "323:   N_(\"Unable to initialize authentication methods.\"));",
          "325:  }",
          "328:  if (!standalone) {",
          "329:      if (IS_NONINTERACTIVE(&auth_switch[0])) {",
          "331:   goto done;",
          "332:      }",
          "333:      pass = auth_getpass(prompt, SUDO_CONV_PROMPT_ECHO_OFF, callback);",
          "",
          "[Removed Lines]",
          "324:      debug_return_int(-1);",
          "330:   success = AUTH_NONINTERACTIVE;",
          "",
          "[Added Lines]",
          "331:      debug_return_int(AUTH_ERROR);",
          "337:   ret = AUTH_NONINTERACTIVE;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "340:      if (IS_DISABLED(auth))",
          "341:   continue;",
          "344:   standalone ? prompt : pass, auth, callback);",
          "346:   break;",
          "347:  }",
          "348:  if (pass != NULL)",
          "349:      freezero(pass, strlen(pass));",
          "352:      goto done;",
          "353:     }",
          "",
          "[Removed Lines]",
          "343:      success = auth->status = (auth->verify)(ctx, pw,",
          "345:      if (success != AUTH_FAILURE)",
          "351:  if (success != AUTH_FAILURE)",
          "",
          "[Added Lines]",
          "350:      ret = auth->status = (auth->verify)(ctx, pw,",
          "352:      if (ret != AUTH_FAILURE)",
          "358:  if (ret != AUTH_FAILURE)",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "357:     (void) sigaction(SIGTSTP, &saved_sigtstp, NULL);",
          "358:     (void) sigprocmask(SIG_SETMASK, &omask, NULL);",
          "361:  case AUTH_SUCCESS:",
          "363:      break;",
          "364:  case AUTH_INTR:",
          "365:  case AUTH_FAILURE:",
          "366:      if (ntries != 0)",
          "367:   SET(validated, FLAG_BAD_PASSWORD);",
          "368:      log_auth_failure(ctx, validated, ntries);",
          "370:      break;",
          "371:  case AUTH_NONINTERACTIVE:",
          "372:      SET(validated, FLAG_NO_USER_INPUT);",
          "373:      FALLTHROUGH;",
          "374:  default:",
          "375:      log_auth_failure(ctx, validated, 0);",
          "377:      break;",
          "378:     }",
          "",
          "[Removed Lines]",
          "360:     switch (success) {",
          "362:      ret = true;",
          "369:      ret = false;",
          "376:      ret = -1;",
          "",
          "[Added Lines]",
          "367:     switch (ret) {",
          "371:      ret = AUTH_FAILURE;",
          "372:      FALLTHROUGH;",
          "383:      ret = AUTH_ERROR;",
          "",
          "---------------"
        ],
        "plugins/sudoers/auth/sudo_auth.h||plugins/sudoers/auth/sudo_auth.h": [
          "File: plugins/sudoers/auth/sudo_auth.h -> plugins/sudoers/auth/sudo_auth.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: typedef struct sudo_auth {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: struct sudoers_context;",
          "",
          "---------------"
        ],
        "plugins/sudoers/check.c||plugins/sudoers/check.c": [
          "File: plugins/sudoers/check.c -> plugins/sudoers/check.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "91: {",
          "92:     const struct sudoers_context *ctx = closure->ctx;",
          "93:     struct sudo_conv_callback callback;",
          "95:     char *prompt;",
          "96:     debug_decl(check_user_interactive, SUDOERS_DEBUG_AUTH);",
          "",
          "[Removed Lines]",
          "94:     int ret = -1;",
          "",
          "[Added Lines]",
          "94:     int ret = AUTH_ERROR;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "122:     case TS_CURRENT:",
          "124:  if (!ISSET(validated, FLAG_CHECK_USER)) {",
          "126:      break;",
          "127:  }",
          "128:  sudo_debug_printf(SUDO_DEBUG_INFO,",
          "",
          "[Removed Lines]",
          "125:      ret = true;",
          "",
          "[Added Lines]",
          "125:      ret = AUTH_SUCCESS;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "144:      goto done;",
          "146:  ret = verify_user(ctx, closure->auth_pw, prompt, validated, &callback);",
          "149:  free(prompt);",
          "150:  break;",
          "",
          "[Removed Lines]",
          "147:  if (ret == true && closure->lectured)",
          "",
          "[Added Lines]",
          "147:  if (ret == AUTH_SUCCESS && closure->lectured)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "163:     unsigned int mode)",
          "164: {",
          "165:     struct getpass_closure closure = { TS_ERROR };",
          "167:     bool exempt = false;",
          "168:     debug_decl(check_user, SUDOERS_DEBUG_AUTH);",
          "",
          "[Removed Lines]",
          "166:     int ret = -1;",
          "",
          "[Added Lines]",
          "166:     int ret = AUTH_ERROR;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "184:     if ((closure.auth_pw = get_authpw(ctx, mode)) == NULL)",
          "185:  goto done;",
          "187:  goto done;",
          "188:     closure.ctx = ctx;",
          "",
          "[Removed Lines]",
          "186:     if (sudo_auth_init(ctx, closure.auth_pw, mode) == -1)",
          "",
          "[Added Lines]",
          "186:     if (sudo_auth_init(ctx, closure.auth_pw, mode) != AUTH_SUCCESS)",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "196:      !def_authenticate ? \"authentication disabled\" :",
          "197:      \"user exempt from authentication\");",
          "198:  exempt = true;",
          "200:  goto done;",
          "201:     }",
          "202:     if (ctx->user.uid == 0 || (ctx->user.uid == ctx->runas.pw->pw_uid &&",
          "",
          "[Removed Lines]",
          "199:  ret = true;",
          "",
          "[Added Lines]",
          "199:  ret = AUTH_SUCCESS;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "214:  {",
          "215:      sudo_debug_printf(SUDO_DEBUG_INFO,",
          "216:   \"%s: user running command as self\", __func__);",
          "218:      goto done;",
          "219:  }",
          "220:     }",
          "",
          "[Removed Lines]",
          "217:      ret = true;",
          "",
          "[Added Lines]",
          "217:      ret = AUTH_SUCCESS;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "222:     ret = check_user_interactive(validated, mode, &closure);",
          "224: done:",
          "227:  ret = sudo_auth_approval(ctx, closure.auth_pw, validated, exempt);",
          "",
          "[Removed Lines]",
          "225:     if (ret == true) {",
          "",
          "[Added Lines]",
          "225:     if (ret == AUTH_SUCCESS) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "234:      if (ISSET(mode, MODE_UPDATE_TICKET) && closure.tstat != TS_ERROR)",
          "235:   (void)timestamp_update(closure.cookie, closure.auth_pw);",
          "236:  }",
          "",
          "[Removed Lines]",
          "233:  if (ret == true && ISSET(validated, VALIDATE_SUCCESS)) {",
          "",
          "[Added Lines]",
          "233:  if (ret == AUTH_SUCCESS && ISSET(validated, VALIDATE_SUCCESS)) {",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "240:     if (closure.auth_pw != NULL)",
          "241:  sudo_pw_delref(closure.auth_pw);",
          "244: }",
          "",
          "[Removed Lines]",
          "243:     debug_return_int(ret);",
          "",
          "[Added Lines]",
          "243:     switch (ret) {",
          "244:     case AUTH_SUCCESS:",
          "245:  debug_return_int(true);",
          "246:     case AUTH_FAILURE:",
          "247:  debug_return_int(false);",
          "248:     default:",
          "249:  debug_return_int(-1);",
          "250:     }",
          "",
          "---------------"
        ],
        "plugins/sudoers/timestamp.h||plugins/sudoers/timestamp.h": [
          "File: plugins/sudoers/timestamp.h -> plugins/sudoers/timestamp.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: #ifndef SUDOERS_TIMESTAMP_H",
          "25: #define SUDOERS_TIMESTAMP_H",
          "28: #define TS_CURRENT  0",
          "29: #define TS_OLD   1",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27: #include \"auth/sudo_auth.h\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}