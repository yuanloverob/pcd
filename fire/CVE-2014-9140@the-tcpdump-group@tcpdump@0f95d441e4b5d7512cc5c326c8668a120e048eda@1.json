{
  "cve_id": "CVE-2014-9140",
  "cve_desc": "Buffer overflow in the ppp_hdlc function in print-ppp.c in tcpdump 4.6.2 and earlier allows remote attackers to cause a denial of service (crash) cia a crafted PPP packet.",
  "repo": "the-tcpdump-group/tcpdump",
  "patch_hash": "0f95d441e4b5d7512cc5c326c8668a120e048eda",
  "patch_info": {
    "commit_hash": "0f95d441e4b5d7512cc5c326c8668a120e048eda",
    "repo": "the-tcpdump-group/tcpdump",
    "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/0f95d441e4b5d7512cc5c326c8668a120e048eda",
    "files": [
      "print-ppp.c"
    ],
    "message": "Do bounds checking when unescaping PPP.\n\nClean up a const issue while we're at it.",
    "before_after_code_files": [
      "print-ppp.c||print-ppp.c"
    ]
  },
  "patch_diff": {
    "print-ppp.c||print-ppp.c": [
      "File: print-ppp.c -> print-ppp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1351: ppp_hdlc(netdissect_options *ndo,",
      "1352:          const u_char *p, int length)",
      "1353: {",
      "1355:  int i, proto;",
      "1356:  const void *se;",
      "1358:         if (length <= 0)",
      "1359:                 return;",
      "1362:  if (b == NULL)",
      "1363:   return;",
      "",
      "[Removed Lines]",
      "1354:  u_char *b, *s, *t, c;",
      "1361:  b = (uint8_t *)malloc(length);",
      "",
      "[Added Lines]",
      "1354:  u_char *b, *t, c;",
      "1355:  const u_char *s;",
      "1362:  b = (u_char *)malloc(length);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1371:   c = *s++;",
      "1372:   if (c == 0x7d) {",
      "1378:   }",
      "1380:  }",
      "",
      "[Removed Lines]",
      "1370:  for (s = (u_char *)p, t = b, i = length; i > 0; i--) {",
      "1373:    if (i > 1) {",
      "1374:     i--;",
      "1375:     c = *s++ ^ 0x20;",
      "1376:    } else",
      "1377:     continue;",
      "",
      "[Added Lines]",
      "1371:  for (s = p, t = b, i = length; i > 0 && ND_TTEST(*s); i--) {",
      "1374:    if (i <= 1 || !ND_TTEST(*s))",
      "1375:     break;",
      "1376:    i--;",
      "1377:    c = *s++ ^ 0x20;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3be38aded84754cf52130733e725a736a0554c98",
      "candidate_info": {
        "commit_hash": "3be38aded84754cf52130733e725a736a0554c98",
        "repo": "the-tcpdump-group/tcpdump",
        "commit_url": "https://github.com/the-tcpdump-group/tcpdump/commit/3be38aded84754cf52130733e725a736a0554c98",
        "files": [
          "print-ppp.c"
        ],
        "message": "Do bounds checking when unescaping PPP.\n\nClean up a const issue while we're at it.",
        "before_after_code_files": [
          "print-ppp.c||print-ppp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "print-ppp.c||print-ppp.c"
          ],
          "candidate": [
            "print-ppp.c||print-ppp.c"
          ]
        }
      },
      "candidate_diff": {
        "print-ppp.c||print-ppp.c": [
          "File: print-ppp.c -> print-ppp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1266: static void",
          "1267: ppp_hdlc(const u_char *p, int length)",
          "1268: {",
          "1270:  int i, proto;",
          "1271:  const void *se;",
          "1274:  if (b == NULL)",
          "1275:   return;",
          "",
          "[Removed Lines]",
          "1269:  u_char *b, *s, *t, c;",
          "1273:  b = (u_int8_t *)malloc(length);",
          "",
          "[Added Lines]",
          "1269:  u_char *b, *t, c;",
          "1270:  const u_char *s;",
          "1274:         if (length <= 0)",
          "1275:                 return;",
          "1277:  b = (u_char *)malloc(length);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1283:   c = *s++;",
          "1284:   if (c == 0x7d) {",
          "1290:   }",
          "1292:  }",
          "",
          "[Removed Lines]",
          "1282:  for (s = (u_char *)p, t = b, i = length; i > 0; i--) {",
          "1285:    if (i > 1) {",
          "1286:     i--;",
          "1287:     c = *s++ ^ 0x20;",
          "1288:    } else",
          "1289:     continue;",
          "",
          "[Added Lines]",
          "1286:  for (s = p, t = b, i = length; i > 0 && TTEST(*s); i--) {",
          "1289:    if (i <= 1 || !TTEST(*s))",
          "1290:     break;",
          "1291:    i--;",
          "1292:    c = *s++ ^ 0x20;",
          "",
          "---------------"
        ]
      }
    }
  ]
}