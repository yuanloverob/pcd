{
  "cve_id": "CVE-2023-3745",
  "cve_desc": "A heap-based buffer overflow issue was found in ImageMagick's PushCharPixel() function in quantum-private.h. This issue may allow a local attacker to trick the user into opening a specially crafted file, triggering an out-of-bounds read error and allowing an application to crash, resulting in a denial of service.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "651672f19c75161a6159d9b6838fd3095b6c5304",
  "patch_info": {
    "commit_hash": "651672f19c75161a6159d9b6838fd3095b6c5304",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/651672f19c75161a6159d9b6838fd3095b6c5304",
    "files": [
      "coders/tiff.c"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/issues/1857",
    "before_after_code_files": [
      "coders/tiff.c||coders/tiff.c"
    ]
  },
  "patch_diff": {
    "coders/tiff.c||coders/tiff.c": [
      "File: coders/tiff.c -> coders/tiff.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1818:         method=ReadStripMethod;",
      "1819:         if (rows_per_strip > (uint32) image->rows)",
      "1820:           rows_per_strip=(uint32) image->rows;",
      "1822:     if (TIFFIsTiled(tiff) != MagickFalse)",
      "1823:       method=ReadTileMethod;",
      "1824:     if (image->compression == JPEGCompression)",
      "",
      "[Removed Lines]",
      "1821:       }",
      "",
      "[Added Lines]",
      "1821:       }",
      "1822:     if (TIFFIsTiled(tiff) != MagickFalse)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1941:           strip_size;",
      "1943:         unsigned char",
      "1947:           Convert stripped TIFF image.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9152a39c44a1aa3d2c5bab3327a7b2999e022391",
      "candidate_info": {
        "commit_hash": "9152a39c44a1aa3d2c5bab3327a7b2999e022391",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/9152a39c44a1aa3d2c5bab3327a7b2999e022391",
        "files": [
          "coders/tiff.c"
        ],
        "message": "better support for TIFF YCbCr photometric",
        "before_after_code_files": [
          "coders/tiff.c||coders/tiff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/tiff.c||coders/tiff.c"
          ],
          "candidate": [
            "coders/tiff.c||coders/tiff.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tiff.c||coders/tiff.c": [
          "File: coders/tiff.c -> coders/tiff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1554:         image->endian=MSBEndian;",
          "1555:       }",
          "1556: #endif",
          "1558:         (photometric == PHOTOMETRIC_MINISWHITE))",
          "1559:       image->colorspace=GRAYColorspace;",
          "1560:     if (photometric == PHOTOMETRIC_SEPARATED)",
          "",
          "[Removed Lines]",
          "1557:     if ((photometric == PHOTOMETRIC_MINISBLACK) ||",
          "",
          "[Added Lines]",
          "1557:     if ((photometric == PHOTOMETRIC_MINISBLACK) ||",
          "1558:         (photometric == PHOTOMETRIC_MINISWHITE))",
          "1559:       image->colorspace=GRAYColorspace;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1830:         method=ReadStripMethod;",
          "1831:         if (rows_per_strip > (uint32) image->rows)",
          "1832:           rows_per_strip=(uint32) image->rows;",
          "1835:       method=ReadTileMethod;",
          "1836:     if (image->compression == JPEGCompression)",
          "1837:       method=GetJPEGMethod(image,tiff,photometric,bits_per_sample,",
          "",
          "[Removed Lines]",
          "1833:       }",
          "1834:     if (TIFFIsTiled(tiff) != MagickFalse)",
          "",
          "[Added Lines]",
          "1835:       }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "54cdc146bbe50018526770be201b56643ad58ba7",
      "candidate_info": {
        "commit_hash": "54cdc146bbe50018526770be201b56643ad58ba7",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/54cdc146bbe50018526770be201b56643ad58ba7",
        "files": [
          "ChangeLog",
          "coders/tiff.c"
        ],
        "message": "https://github.com/ImageMagick/ImageMagick/issues/1857",
        "before_after_code_files": [
          "coders/tiff.c||coders/tiff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/tiff.c||coders/tiff.c"
          ],
          "candidate": [
            "coders/tiff.c||coders/tiff.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tiff.c||coders/tiff.c": [
          "File: coders/tiff.c -> coders/tiff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1941:           strip_size;",
          "1943:         unsigned char",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}