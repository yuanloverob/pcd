{
  "cve_id": "CVE-2021-33035",
  "cve_desc": "Apache OpenOffice opens dBase/DBF documents and shows the contents as spreadsheets. DBF are database files with data organized in fields. When reading DBF data the size of certain fields is not checked: the data is just copied into local variables. A carefully crafted document could overflow the allocated space, leading to the execution of arbitrary code by altering the contents of the program stack. This issue affects Apache OpenOffice up to and including version 4.1.10",
  "repo": "apache/openoffice",
  "patch_hash": "efddaef0151af3be16078cc4d88c6bae0f911e56",
  "patch_info": {
    "commit_hash": "efddaef0151af3be16078cc4d88c6bae0f911e56",
    "repo": "apache/openoffice",
    "commit_url": "https://github.com/apache/openoffice/commit/efddaef0151af3be16078cc4d88c6bae0f911e56#diff-ea66e734dd358922aba12ad4ba39c96bdc6cbde587d07dbc63d04daa0a30e90f",
    "files": [
      "main/connectivity/source/drivers/dbase/DTable.cxx"
    ],
    "message": "add useful checks",
    "before_after_code_files": [
      "main/connectivity/source/drivers/dbase/DTable.cxx||main/connectivity/source/drivers/dbase/DTable.cxx"
    ]
  },
  "patch_diff": {
    "main/connectivity/source/drivers/dbase/DTable.cxx||main/connectivity/source/drivers/dbase/DTable.cxx": [
      "File: main/connectivity/source/drivers/dbase/DTable.cxx -> main/connectivity/source/drivers/dbase/DTable.cxx",
      "--- Hunk 1 ---",
      "[Context before]",
      "896:         else if ( DataType::TIMESTAMP == nType )",
      "897:         {",
      "898:             sal_Int32 nDate = 0,nTime = 0;",
      "899:    memcpy(&nDate, pData, 4);",
      "900:             memcpy(&nTime, pData+ 4, 4);",
      "901:             if ( !nDate && !nTime )",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "899:             OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "900:             if (nLen != 8) {",
      "901:                 return false;",
      "902:             }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "911:         }",
      "912:         else if ( DataType::INTEGER == nType )",
      "913:         {",
      "914:             sal_Int32 nValue = 0;",
      "915:    memcpy(&nValue, pData, nLen);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "918:             OSL_ENSURE(nLen == 4, \"Invalid length for integer field\");",
      "919:             if (nLen != 4) {",
      "920:                 return false;",
      "921:             }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "918:         else if ( DataType::DOUBLE == nType )",
      "919:         {",
      "920:             double d = 0.0;",
      "921:             if (getBOOL((*aIter)->getPropertyValue(OMetaConnection::getPropMap().getNameByIndex(PROPERTY_ID_ISCURRENCY)))) // Currency wird gesondert behandelt",
      "922:             {",
      "923:                 sal_Int64 nValue = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "929:             OSL_ENSURE(nLen == 8, \"Invalid length for double field\");",
      "930:             if (nLen != 8) {",
      "931:                 return false;",
      "932:             }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "959:    {",
      "960:     case DataType::DATE:",
      "961:     {",
      "962:      if (aStr.Len() != nLen)",
      "963:      {",
      "964:       (_rRow->get())[i]->setNull();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "974:                     OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "975:                     if (nLen != 8) {",
      "976:                         return false;",
      "977:                     }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "978:     break;",
      "979:     case DataType::BIT:",
      "980:     {",
      "981:      sal_Bool b;",
      "982:      switch (* ((const char *)pData))",
      "983:      {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "997:                     OSL_ENSURE(nLen == 1, \"Invalid length for bit field\");",
      "998:                     if (nLen != 1) {",
      "999:                         return false;",
      "1000:                     }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "1873:    {",
      "1874:                 case DataType::TIMESTAMP:",
      "1875:                     {",
      "1876:                         sal_Int32 nJulianDate = 0, nJulianTime = 0;",
      "1877:                         lcl_CalcJulDate(nJulianDate,nJulianTime,rRow.get()[nPos]->getValue());",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1896:                         OSL_ENSURE(nLen == 8, \"Invalid length for timestamp field\");",
      "1897:                         if (nLen != 8) {",
      "1898:                             bHadError = true;",
      "1899:                             break;",
      "1900:                         }",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "1882:                     break;",
      "1883:     case DataType::DATE:",
      "1884:     {",
      "1885:      ::com::sun::star::util::Date aDate;",
      "1886:      if(rRow.get()[nPos]->getValue().getTypeKind() == DataType::DOUBLE)",
      "1887:       aDate = ::dbtools::DBTypeConversion::toDate(rRow.get()[nPos]->getValue().getDouble());",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1910:                     OSL_ENSURE(nLen == 8, \"Invalid length for date field\");",
      "1911:                     if (nLen != 8) {",
      "1912:                         bHadError = true;",
      "1913:                         break;",
      "1914:                     }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "1900:     } break;",
      "1901:                 case DataType::INTEGER:",
      "1902:                     {",
      "1903:                         sal_Int32 nValue = rRow.get()[nPos]->getValue();",
      "1904:                         memcpy(pData,&nValue,nLen);",
      "1905:                     }",
      "1906:                     break;",
      "1907:                 case DataType::DOUBLE:",
      "1908:                     {",
      "1909:                         const double d = rRow.get()[nPos]->getValue();",
      "1910:                         m_pColumns->getByIndex(i) >>= xCol;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1933:                         OSL_ENSURE(nLen == 4, \"Invalid length for integer field\");",
      "1934:                         if (nLen != 4) {",
      "1935:                             bHadError = true;",
      "1936:                             break;",
      "1937:                         }",
      "1944:                         OSL_ENSURE(nLen == 8, \"Invalid length for double field\");",
      "1945:                         if (nLen != 8) {",
      "1946:                             bHadError = true;",
      "1947:                             break;",
      "1948:                         }",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "1958:      }",
      "1959:     } break;",
      "1960:     case DataType::BIT:",
      "1962:      break;",
      "1963:                 case DataType::LONGVARBINARY:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2001:                     OSL_ENSURE(nLen == 1, \"Invalid length for bit field\");",
      "2002:                     if (nLen != 1) {",
      "2003:                         bHadError = true;",
      "2004:                         break;",
      "2005:                     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d84e293dde9f2d2b8faed8e814b7897ce85e1591",
      "candidate_info": {
        "commit_hash": "d84e293dde9f2d2b8faed8e814b7897ce85e1591",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/d84e293dde9f2d2b8faed8e814b7897ce85e1591",
        "files": [
          "main/extensions.lst"
        ],
        "message": "Updated English dictionary",
        "before_after_code_files": [
          "main/extensions.lst||main/extensions.lst"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/extensions.lst||main/extensions.lst": [
          "File: main/extensions.lst -> main/extensions.lst",
          "--- Hunk 1 ---",
          "[Context before]",
          "40: # English dictionary",
          "41: [ language=en.* || language=de || language=it ]",
          "44: # English (USA, en_US) dictionary",
          "45: [ language==nl || language==ru ]",
          "",
          "[Removed Lines]",
          "42:     3730ea9696aab7900606d650e8000562 https://sourceforge.net/projects/aoo-extensions/files/17102/69/dict-en-20210901.oxt/download \"dict-en.oxt\"",
          "",
          "[Added Lines]",
          "42:     78c9565bcb6bb867426081231b3b7ee2 https://sourceforge.net/projects/aoo-extensions/files/17102/70/dict-en-20211001.oxt/download \"dict-en.oxt\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "42b15598fd3a1a59436ab812a1f868cec9590587",
      "candidate_info": {
        "commit_hash": "42b15598fd3a1a59436ab812a1f868cec9590587",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/42b15598fd3a1a59436ab812a1f868cec9590587",
        "files": [
          "main/extensions.lst"
        ],
        "message": "Updated English dictionary",
        "before_after_code_files": [
          "main/extensions.lst||main/extensions.lst"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/extensions.lst||main/extensions.lst": [
          "File: main/extensions.lst -> main/extensions.lst",
          "--- Hunk 1 ---",
          "[Context before]",
          "40: # English dictionary",
          "41: [ language=en.* || language=de || language=it ]",
          "44: # English (USA, en_US) dictionary",
          "45: [ language==nl || language==ru ]",
          "",
          "[Removed Lines]",
          "42:     39c24194dbf83e2aecc34bdd6c31eb67 https://sourceforge.net/projects/aoo-extensions/files/17102/74/dict-en-20220201_aoo.oxt/download \"dict-en.oxt\"",
          "",
          "[Added Lines]",
          "42:     346f11fc7fa2468b639851dbeedbfed3 https://sourceforge.net/projects/aoo-extensions/files/17102/75/dict-en-20220301_aoo.oxt/download \"dict-en.oxt\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a997bb206304f4d0a2229c16b61fc190c58f6512",
      "candidate_info": {
        "commit_hash": "a997bb206304f4d0a2229c16b61fc190c58f6512",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/a997bb206304f4d0a2229c16b61fc190c58f6512",
        "files": [
          "main/cppu/inc/com/sun/star/uno/Any.hxx"
        ],
        "message": "restore orig test overwritten by cherry pick",
        "before_after_code_files": [
          "main/cppu/inc/com/sun/star/uno/Any.hxx||main/cppu/inc/com/sun/star/uno/Any.hxx"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/cppu/inc/com/sun/star/uno/Any.hxx||main/cppu/inc/com/sun/star/uno/Any.hxx": [
          "File: main/cppu/inc/com/sun/star/uno/Any.hxx -> main/cppu/inc/com/sun/star/uno/Any.hxx",
          "--- Hunk 1 ---",
          "[Context before]",
          "250:  if (rAny.pType->eTypeClass == typelib_TypeClass_BOOLEAN)",
          "251:  {",
          "252:   value = *reinterpret_cast< sal_Bool const * >(",
          "254:   return sal_True;",
          "255:  }",
          "256:  return sal_False;",
          "",
          "[Removed Lines]",
          "253:    rAny.pData ) != sal_False;",
          "",
          "[Added Lines]",
          "253:    &rAny.pReserved ) != sal_False;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aa35365212f5f12cc5a56063f7340e9a2aa39f4c",
      "candidate_info": {
        "commit_hash": "aa35365212f5f12cc5a56063f7340e9a2aa39f4c",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/aa35365212f5f12cc5a56063f7340e9a2aa39f4c",
        "files": [
          "main/instsetoo_native/util/openoffice.lst",
          "main/odk/util/makefile.pmk",
          "main/setup_native/source/win32/nsis/downloadtemplate.nsi",
          "main/solenv/bin/srcrelease.xml",
          "main/solenv/inc/minor.mk",
          "main/sysui/desktop/productversion.mk"
        ],
        "message": "Bump rev to 4.1.12",
        "before_after_code_files": [
          "main/instsetoo_native/util/openoffice.lst||main/instsetoo_native/util/openoffice.lst",
          "main/odk/util/makefile.pmk||main/odk/util/makefile.pmk",
          "main/setup_native/source/win32/nsis/downloadtemplate.nsi||main/setup_native/source/win32/nsis/downloadtemplate.nsi",
          "main/solenv/inc/minor.mk||main/solenv/inc/minor.mk",
          "main/sysui/desktop/productversion.mk||main/sysui/desktop/productversion.mk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/instsetoo_native/util/openoffice.lst||main/instsetoo_native/util/openoffice.lst": [
          "File: main/instsetoo_native/util/openoffice.lst -> main/instsetoo_native/util/openoffice.lst",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:         {",
          "7:             APACHEPROJECTNAME Apache OpenOffice",
          "8:             OOOBASEVERSION 4.1",
          "11:             URELAYERVERSION 1",
          "12:             BASISROOTNAME OpenOffice",
          "13:             UNIXBASISROOTNAME openoffice",
          "",
          "[Removed Lines]",
          "9:             OOOPACKAGEVERSION 4.1.11",
          "10:             UREPACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "9:             OOOPACKAGEVERSION 4.1.12",
          "10:             UREPACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "59:         {",
          "60:             FULLPRODUCTNAME Apache OpenOffice",
          "61:             PRODUCTNAME OpenOffice",
          "64:             PRODUCTEXTENSION",
          "65:             LONG_PRODUCTEXTENSION",
          "66:             SHORT_PRODUCTEXTENSION",
          "",
          "[Removed Lines]",
          "62:             PRODUCTVERSION 4.1.11",
          "63:             PREVIOUS_VERSION 4.1.10",
          "",
          "[Added Lines]",
          "62:             PRODUCTVERSION 4.1.12",
          "63:             PREVIOUS_VERSION 4.1.11",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "68:             POSTVERSIONEXTENSIONUNIX",
          "69:             BRANDPACKAGEVERSION 4",
          "70:             USERDIRPRODUCTVERSION 4",
          "72:             BASEPRODUCTVERSION 4.1",
          "73:             PCPFILENAME openoffice.pcp",
          "75:             ADD_INCLUDE_FILES cliureversion.mk,clioootypesversion.mk,userland.txt,version.lst",
          "76:             REMOVE_UPGRADE_CODE_FILE upgradecode_remove_ooo.txt",
          "77:             ADDSYSTEMINTEGRATION 1",
          "78:             EVAL",
          "80:             PACKAGEREVISION {milestone}",
          "81:             LICENSENAME ALv2",
          "82:             GLOBALFILEGID gid_File_Lib_Vcl",
          "",
          "[Removed Lines]",
          "71:             ABOUTBOXPRODUCTVERSION 4.1.11",
          "74:             UPDATEURL https://ooo-updates.apache.org/aoo4111/check.Update",
          "79:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "71:             ABOUTBOXPRODUCTVERSION 4.1.12",
          "74:             UPDATEURL https://ooo-updates.apache.org/aoo4112/check.Update",
          "79:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "120:         {",
          "121:             FULLPRODUCTNAME Apache OpenOffice",
          "122:             PRODUCTNAME OpenOffice",
          "124:             PRODUCTEXTENSION",
          "125:             LONG_PRODUCTEXTENSION",
          "126:             SHORT_PRODUCTEXTENSION",
          "",
          "[Removed Lines]",
          "123:             PRODUCTVERSION 4.1.11",
          "",
          "[Added Lines]",
          "123:             PRODUCTVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "128:             POSTVERSIONEXTENSIONUNIX",
          "129:             BRANDPACKAGEVERSION 4",
          "130:             USERDIRPRODUCTVERSION 4",
          "132:             BASEPRODUCTVERSION 4.1",
          "134:             ADD_INCLUDE_FILES cliureversion.mk,clioootypesversion.mk,javaversion2.dat,userland.txt,version.lst",
          "135:             REMOVE_UPGRADE_CODE_FILE upgradecode_remove_ooo.txt",
          "136:             ADDSYSTEMINTEGRATION 1",
          "137:             EVAL",
          "139:             PACKAGEREVISION {milestone}",
          "140:             LICENSENAME ALv2",
          "141:             WITHJREPRODUCT 1",
          "",
          "[Removed Lines]",
          "131:             ABOUTBOXPRODUCTVERSION 4.1.11",
          "133:             UPDATEURL https://ooo-updates.apache.org/aoo4111/check.Update",
          "138:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "131:             ABOUTBOXPRODUCTVERSION 4.1.12",
          "133:             UPDATEURL https://ooo-updates.apache.org/aoo4112/check.Update",
          "138:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "180:         {",
          "181:             FULLPRODUCTNAME AOO-Developer-Build",
          "182:             PRODUCTNAME AOO-Developer-Build",
          "184:             PRODUCTEXTENSION",
          "185:             LONG_PRODUCTEXTENSION",
          "186:             SHORT_PRODUCTEXTENSION",
          "",
          "[Removed Lines]",
          "183:             PRODUCTVERSION 4.1.11",
          "",
          "[Added Lines]",
          "183:             PRODUCTVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "190:             POSTVERSIONEXTENSIONUNIX",
          "191:             BRANDPACKAGEVERSION 4",
          "192:             USERDIRPRODUCTVERSION 4",
          "194:             BASEPRODUCTVERSION 4.1",
          "195:             DEVELOPMENTPRODUCT 1",
          "196:             BASISPACKAGEPREFIX aoodev",
          "197:             UREPACKAGEPREFIX aoodev",
          "198:             SOLSUREPACKAGEPREFIX aoodev",
          "199:             REGISTRYLAYERNAME LayerDev",
          "201:             ADD_INCLUDE_FILES cliureversion.mk,clioootypesversion.mk,javaversion2.dat,userland.txt,version.lst",
          "202:             EVAL",
          "204:             PACKAGEREVISION {milestone}",
          "205:             LICENSENAME ALv2",
          "206:             GLOBALFILEGID gid_File_Lib_Vcl",
          "",
          "[Removed Lines]",
          "193:             ABOUTBOXPRODUCTVERSION 4.1.11",
          "200:             UPDATEURL https://ooo-updates.apache.org/aoo4111/check.Update",
          "203:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "193:             ABOUTBOXPRODUCTVERSION 4.1.12",
          "200:             UPDATEURL https://ooo-updates.apache.org/aoo4112/check.Update",
          "203:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "251:             FULLPRODUCTNAME Apache OpenOffice",
          "252:             PRODUCTNAME OpenOffice",
          "253:    PRODUCTDIRNAME OpenOffice_SDK",
          "255:             PRODUCTEXTENSION",
          "256:             LONG_PRODUCTEXTENSION",
          "257:             SHORT_PRODUCTEXTENSION",
          "258:             POSTVERSIONEXTENSION SDK",
          "259:             POSTVERSIONEXTENSIONUNIX sdk",
          "260:             BRANDPACKAGEVERSION 4",
          "262:             PACKAGEREVISION {milestone}",
          "263:             PACK_INSTALLED 1",
          "264:             POOLPRODUCT 0",
          "",
          "[Removed Lines]",
          "254:             PRODUCTVERSION 4.1.11",
          "261:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "254:             PRODUCTVERSION 4.1.12",
          "261:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "299:             FULLPRODUCTNAME Apache OpenOffice Beta",
          "300:             PRODUCTNAME OpenOffice Beta",
          "301:             PRODUCTDIRNAME OpenOffice_SDK_Beta",
          "303:             PRODUCTEXTENSION",
          "304:             SHORT_PRODUCTEXTENSION",
          "305:             POSTVERSIONEXTENSION SDK",
          "306:             POSTVERSIONEXTENSIONUNIX sdk",
          "307:             BRANDPACKAGEVERSION 4",
          "309:             PACKAGEREVISION {milestone}",
          "310:             PACK_INSTALLED 1",
          "311:             POOLPRODUCT 0",
          "",
          "[Removed Lines]",
          "302:             PRODUCTVERSION 4.1.11",
          "308:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "302:             PRODUCTVERSION 4.1.12",
          "308:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "345:         {",
          "346:             FULLPRODUCTNAME AOO-Developer-Build",
          "347:             PRODUCTNAME AOO-Developer-Build",
          "349:             PRODUCTEXTENSION",
          "350:             LONG_PRODUCTEXTENSION",
          "351:             SHORT_PRODUCTEXTENSION",
          "",
          "[Removed Lines]",
          "348:             PRODUCTVERSION 4.1.11",
          "",
          "[Added Lines]",
          "348:             PRODUCTVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "354:             POSTVERSIONEXTENSION SDK",
          "355:             POSTVERSIONEXTENSIONUNIX sdk",
          "356:             BRANDPACKAGEVERSION 4",
          "358:             PACKAGEREVISION {milestone}",
          "359:             BASISPACKAGEPREFIX aoodev",
          "360:             UREPACKAGEPREFIX aoodev",
          "",
          "[Removed Lines]",
          "357:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "357:             PACKAGEVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "398:         {",
          "399:             FULLPRODUCTNAME Apache OpenOffice Beta",
          "400:             PRODUCTNAME OpenOffice Beta",
          "402:             PRODUCTEXTENSION",
          "403:             SHORT_PRODUCTEXTENSION",
          "404:             BASISROOTNAME AOOBeta",
          "",
          "[Removed Lines]",
          "401:             PRODUCTVERSION 4.1.11",
          "",
          "[Added Lines]",
          "401:             PRODUCTVERSION 4.1.12",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "408:             POSTVERSIONEXTENSION",
          "409:             BRANDPACKAGEVERSION 4",
          "410:             USERDIRPRODUCTVERSION 4",
          "412:             BASEPRODUCTVERSION 4.1",
          "414:             ADD_INCLUDE_FILES cliureversion.mk,clioootypesversion.mk,userland.txt,version.lst",
          "415:             REMOVE_UPGRADE_CODE_FILE upgradecode_remove_ooo.txt",
          "416:             ADDSYSTEMINTEGRATION 0",
          "417:             EVAL",
          "419:             PACKAGEREVISION {milestone}",
          "420:             LICENSENAME ALv2",
          "421:             GLOBALFILEGID gid_File_Lib_Vcl",
          "",
          "[Removed Lines]",
          "411:             ABOUTBOXPRODUCTVERSION 4.1.11",
          "413:             UPDATEURL https://ooo-updates.apache.org/aoo4111/check.Update",
          "418:             PACKAGEVERSION 4.1.11",
          "",
          "[Added Lines]",
          "411:             ABOUTBOXPRODUCTVERSION 4.1.12",
          "413:             UPDATEURL https://ooo-updates.apache.org/aoo4112/check.Update",
          "418:             PACKAGEVERSION 4.1.12",
          "",
          "---------------"
        ],
        "main/odk/util/makefile.pmk||main/odk/util/makefile.pmk": [
          "File: main/odk/util/makefile.pmk -> main/odk/util/makefile.pmk",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: # used for sdk common files",
          "26: OFFICENAME=OpenOffice",
          "27: .IF \"$(GUI)\"==\"WNT\"",
          "28: SDKDIRNAME=OpenOffice_$(PRODUCT_RELEASE)_SDK",
          "",
          "[Removed Lines]",
          "25: PRODUCT_RELEASE=4.1.11",
          "",
          "[Added Lines]",
          "25: PRODUCT_RELEASE=4.1.12",
          "",
          "---------------"
        ],
        "main/setup_native/source/win32/nsis/downloadtemplate.nsi||main/setup_native/source/win32/nsis/downloadtemplate.nsi": [
          "File: main/setup_native/source/win32/nsis/downloadtemplate.nsi -> main/setup_native/source/win32/nsis/downloadtemplate.nsi",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: VIAddVersionKey LegalCopyright \"(c) 2012-2021 The Apache Software Foundation\"",
          "10: VIAddVersionKey FileDescription \"Apache PRODUCTNAMEPLACEHOLDER Installer\"",
          "11: VIAddVersionKey ProductVersion \"PRODUCTVERSIONPLACEHOLDER\"",
          "14: ; Enable Unicode",
          "15: Unicode true",
          "",
          "[Removed Lines]",
          "12: VIProductVersion \"4.1.9808.500\"",
          "",
          "[Added Lines]",
          "12: VIProductVersion \"4.1.9809.500\"",
          "",
          "---------------"
        ],
        "main/solenv/inc/minor.mk||main/solenv/inc/minor.mk": [
          "File: main/solenv/inc/minor.mk -> main/solenv/inc/minor.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: #  under the License.",
          "19: #",
          "20: # *************************************************************",
          "24: LAST_MINOR=m1",
          "",
          "[Removed Lines]",
          "21: RSCVERSION=4111",
          "22: RSCREVISION=4111m1(Build:9808)",
          "23: BUILD=9808",
          "25: SOURCEVERSION=AOO4111",
          "",
          "[Added Lines]",
          "21: RSCVERSION=4112",
          "22: RSCREVISION=4112m1(Build:9809)",
          "23: BUILD=9809",
          "25: SOURCEVERSION=AOO4112",
          "",
          "---------------"
        ],
        "main/sysui/desktop/productversion.mk||main/sysui/desktop/productversion.mk": [
          "File: main/sysui/desktop/productversion.mk -> main/sysui/desktop/productversion.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: # default values to minimize maintenance effort",
          "50: # CAUTION! $(OOOBASEVERSION) from openoffice.lst NOT available (!)",
          "53: # CAUTION! $(BRANDPACKAGEVERSION) from openoffice.lst NOT available (!)",
          "54: PRODUCTVERSIONSHORT = 4",
          "",
          "[Removed Lines]",
          "51: PRODUCTVERSION = 4.1.11",
          "",
          "[Added Lines]",
          "51: PRODUCTVERSION = 4.1.12",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a05b8263c927faf963e27d4ddd65d5bd4842d41e",
      "candidate_info": {
        "commit_hash": "a05b8263c927faf963e27d4ddd65d5bd4842d41e",
        "repo": "apache/openoffice",
        "commit_url": "https://github.com/apache/openoffice/commit/a05b8263c927faf963e27d4ddd65d5bd4842d41e",
        "files": [
          "main/expat/expat-2.2.11.patch",
          "main/expat/makefile.mk"
        ],
        "message": "Backport changes from libexpat 2.4.0 into ours\n\nBackport by Carl Marcum\n\n(cherry picked from commit e5a05897583ca40ab4ebf72fff86d6d81f34eef8)",
        "before_after_code_files": [
          "main/expat/makefile.mk||main/expat/makefile.mk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/apache/openoffice/pull/366"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "main/expat/makefile.mk||main/expat/makefile.mk": [
          "File: main/expat/makefile.mk -> main/expat/makefile.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: TARFILE_NAME=expat-2.2.10",
          "42: TARFILE_MD5=9d60de01cc0126dfd11121b04838e154",
          "43: ADDITIONAL_FILES=lib$/makefile.mk",
          "46: CONFIGURE_DIR=",
          "47: .IF \"$(OS)\"==\"WNT\"",
          "",
          "[Removed Lines]",
          "44: PATCH_FILES=$(TARFILE_NAME).patch",
          "",
          "[Added Lines]",
          "44: PATCH_FILES=$(TARFILE_NAME).patch expat-2.2.11.patch",
          "",
          "---------------"
        ]
      }
    }
  ]
}