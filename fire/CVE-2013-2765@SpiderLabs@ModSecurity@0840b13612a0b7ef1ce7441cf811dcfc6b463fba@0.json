{
  "cve_id": "CVE-2013-2765",
  "cve_desc": "The ModSecurity module before 2.7.4 for the Apache HTTP Server allows remote attackers to cause a denial of service (NULL pointer dereference, process crash, and disk consumption) via a POST request with a large body and a crafted Content-Type header.",
  "repo": "SpiderLabs/ModSecurity",
  "patch_hash": "0840b13612a0b7ef1ce7441cf811dcfc6b463fba",
  "patch_info": {
    "commit_hash": "0840b13612a0b7ef1ce7441cf811dcfc6b463fba",
    "repo": "SpiderLabs/ModSecurity",
    "commit_url": "https://github.com/SpiderLabs/ModSecurity/commit/0840b13612a0b7ef1ce7441cf811dcfc6b463fba",
    "files": [
      "apache2/msc_reqbody.c"
    ],
    "message": "Fixed: chuck null pointer when unknown CT is sent and over in-memory limit",
    "before_after_code_files": [
      "apache2/msc_reqbody.c||apache2/msc_reqbody.c"
    ]
  },
  "patch_diff": {
    "apache2/msc_reqbody.c||apache2/msc_reqbody.c": [
      "File: apache2/msc_reqbody.c -> apache2/msc_reqbody.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "172:     if ((msr->msc_reqbody_spilltodisk)",
      "173:         && (msr->msc_reqbody_length + length > (apr_size_t)msr->txcfg->reqbody_inmemory_limit))",
      "174:     {",
      "175:         msc_data_chunk **chunks;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "173:         && (msr->txcfg->reqbody_buffering != REQUEST_BODY_FORCEBUF_ON)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d8262fc6cfa9a8e814794ba8dd0a2915e7a24a52",
      "candidate_info": {
        "commit_hash": "d8262fc6cfa9a8e814794ba8dd0a2915e7a24a52",
        "repo": "SpiderLabs/ModSecurity",
        "commit_url": "https://github.com/SpiderLabs/ModSecurity/commit/d8262fc6cfa9a8e814794ba8dd0a2915e7a24a52",
        "files": [
          "standalone/Makefile.am"
        ],
        "message": "Fixed: standalone Makefile.am",
        "before_after_code_files": [
          "standalone/Makefile.am||standalone/Makefile.am"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/owasp-modsecurity/ModSecurity/pull/58"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "standalone/Makefile.am||standalone/Makefile.am": [
          "File: standalone/Makefile.am -> standalone/Makefile.am",
          "--- Hunk 1 ---",
          "[Context before]",
          "83:  echo \"CORE_MODULES=\\\"\\$$CORE_MODULES ngx_pool_context_module\\\"\" >> ../nginx/modsecurity/config; \\",
          "84:  echo \"HTTP_AUX_FILTER_MODULES=\\\"ngx_http_modsecurity \\$$HTTP_AUX_FILTER_MODULES\\\"\" >> ../nginx/modsecurity/config; \\",
          "85:  echo \"NGX_ADDON_SRCS=\\\"\\$$NGX_ADDON_SRCS \\$$ngx_addon_dir/ngx_http_modsecurity.c \\$$ngx_addon_dir/apr_bucket_nginx.c \\$$ngx_addon_dir/ngx_pool_context.c\\\"\" >> ../nginx/modsecurity/config;\\",
          "87:  echo \"CORE_LIBS=\\\"\\$$CORE_LIBS \\$$ngx_addon_dir/../../standalone/.libs/standalone.a $(standalone_LIBS) \\\"\" >> ../nginx/modsecurity/config; \\",
          "88:  echo \"CORE_INCS=\\\"\\$$CORE_INCS \\$$ngx_addon_dir \\$$ngx_addon_dir/../../standalone \\$$ngx_addon_dir/../../apache2 $(standalone_INCS)\\\"\" >> ../nginx/modsecurity/config; \\",
          "89:  echo \"Removing unused static libraries...\"; \\",
          "",
          "[Removed Lines]",
          "86:  echo \"NGX_ADDON_DEPS=\\\"\\$$NGX_ADDON_DEPS \\$$ngx_addon_dir/apr_bucket_nginx.h \\$$ngx_addon_dir/ngx_pool_context.h\\\"\" >> ../nginx/modsecurity/config; \\",
          "",
          "[Added Lines]",
          "86:  echo \"NGX_ADDON_DEPS=\\\"\\$$NGX_ADDON_DEPS \\$$ngx_addon_dir/apr_bucket_nginx.h \\$$ngx_addon_dir/ngx_pool_context.h \\$$ngx_addon_dir/ngx_http_modsecurity.c \\$$ngx_addon_dir/apr_bucket_nginx.c \\$$ngx_addon_dir/ngx_pool_context.c\\\"\" >> ../nginx/modsecurity/config; \\",
          "",
          "---------------"
        ]
      }
    }
  ]
}